nohup: ignoring input
2025-01-20 12:21:48,522 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-20 12:21:48,522 [trainer.py] => model_name: asp
2025-01-20 12:21:48,522 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-20 12:21:48,522 [trainer.py] => device: ['cuda']
2025-01-20 12:21:48,522 [trainer.py] => seed: 2024
2025-01-20 12:21:48,522 [trainer.py] => dataset: cifar224
2025-01-20 12:21:48,522 [trainer.py] => init_cls: 5
2025-01-20 12:21:48,522 [trainer.py] => increment: 5
2025-01-20 12:21:48,522 [trainer.py] => kshot: 5
2025-01-20 12:21:48,522 [trainer.py] => generator_model: CIFAR_GEN
2025-01-20 12:21:48,522 [trainer.py] => z_dim: 1000
2025-01-20 12:21:48,523 [trainer.py] => conv_dim: 64
2025-01-20 12:21:48,523 [trainer.py] => img_size: 224
2025-01-20 12:21:48,523 [trainer.py] => generator_lr: 0.005
2025-01-20 12:21:48,523 [trainer.py] => pi: 100
2025-01-20 12:21:48,523 [trainer.py] => w_bn: 50.0
2025-01-20 12:21:48,523 [trainer.py] => w_noise: 0.001
2025-01-20 12:21:48,523 [trainer.py] => server_ss: 32
2025-01-20 12:21:48,523 [trainer.py] => bn_loss: 1
2025-01-20 12:21:48,523 [trainer.py] => noise: 1
2025-01-20 12:21:48,523 [trainer.py] => ie_loss: 1
2025-01-20 12:21:48,523 [trainer.py] => act_loss: 0
2025-01-20 12:21:48,523 [trainer.py] => w_ie: 1.0
2025-01-20 12:21:48,523 [trainer.py] => w_act: 0.1
2025-01-20 12:21:48,523 [trainer.py] => syn_size: 32
2025-01-20 12:21:48,523 [trainer.py] => need_syn_imgs: false
2025-01-20 12:21:48,523 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-20 12:21:48,523 [trainer.py] => g_local_train_steps: 5
2025-01-20 12:21:48,523 [trainer.py] => dataset_syn: cifar100
2025-01-20 12:21:48,523 [trainer.py] => com_round_gen: 20
2025-01-20 12:21:48,523 [trainer.py] => g_sigma: 0
2025-01-20 12:21:48,523 [trainer.py] => save_cls_embeds: False
2025-01-20 12:21:48,523 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_bs5
2025-01-20 12:21:48,523 [trainer.py] => save_dir: outputs
2025-01-20 12:21:48,523 [trainer.py] => n_iter: 5
2025-01-20 12:21:48,523 [trainer.py] => num_users: 1
2025-01-20 12:21:48,523 [trainer.py] => cur_size: 5
2025-01-20 12:21:48,523 [trainer.py] => g_local_bs: 5
2025-01-20 12:21:48,523 [trainer.py] => local_bs0: 5
2025-01-20 12:21:48,523 [trainer.py] => local_bs1: 5
2025-01-20 12:21:48,523 [trainer.py] => pre_size: 48
2025-01-20 12:21:48,523 [trainer.py] => w_ce_pre: 0.5
2025-01-20 12:21:48,523 [trainer.py] => vpt_type: Deep
2025-01-20 12:21:48,524 [trainer.py] => prompt_token_num: 6
2025-01-20 12:21:48,524 [trainer.py] => avg_alpha: 0.8
2025-01-20 12:21:48,524 [trainer.py] => perturb_var: 1
2025-01-20 12:21:48,524 [trainer.py] => EMA_beta: 0.99
2025-01-20 12:21:48,524 [trainer.py] => anchor_lambda: 0.1
2025-01-20 12:21:48,524 [trainer.py] => kl_weight: 0.001
2025-01-20 12:21:48,524 [trainer.py] => TIP_init: zero
2025-01-20 12:21:48,524 [trainer.py] => tuned_epoch: 10
2025-01-20 12:21:48,524 [trainer.py] => fs_epoch: 0
2025-01-20 12:21:48,524 [trainer.py] => init_lr: 0.01
2025-01-20 12:21:48,524 [trainer.py] => fs_lr: 0.001
2025-01-20 12:21:48,524 [trainer.py] => batch_size: 48
2025-01-20 12:21:48,524 [trainer.py] => fs_batch_size: 16
2025-01-20 12:21:48,524 [trainer.py] => weight_decay: 0.0005
2025-01-20 12:21:48,524 [trainer.py] => min_lr: 0
2025-01-20 12:21:48,524 [trainer.py] => optimizer: sgd
2025-01-20 12:21:48,524 [trainer.py] => memory_size: 0
2025-01-20 12:21:48,524 [trainer.py] => memory_per_class: 0
2025-01-20 12:21:48,524 [trainer.py] => fixed_memory: False
2025-01-20 12:21:48,524 [trainer.py] => shuffle: False
2025-01-20 12:21:48,524 [trainer.py] => top_k: 5
2025-01-20 12:21:48,524 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-20 12:21:48,524 [trainer.py] => prefix: asp
2025-01-20 12:21:48,524 [trainer.py] => model_prefix: asp
Files already downloaded and verified
Files already downloaded and verified
2025-01-20 12:21:50,233 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
/mnt/share/yinjunhui/anaconda3/envs/cl/lib/python3.9/site-packages/fairscale/experimental/nn/offload.py:19: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  return torch.cuda.amp.custom_fwd(orig_func)  # type: ignore
/mnt/share/yinjunhui/anaconda3/envs/cl/lib/python3.9/site-packages/fairscale/experimental/nn/offload.py:30: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  return torch.cuda.amp.custom_bwd(orig_func)  # type: ignore
/mnt/share/yinjunhui/anaconda3/envs/cl/lib/python3.9/site-packages/pytorch_lightning/metrics/__init__.py:43: LightningDeprecationWarning: `pytorch_lightning.metrics.*` module has been renamed to `torchmetrics.*` and split off to its own package (https://github.com/PyTorchLightning/metrics) since v1.3 and will be removed in v1.5
  rank_zero_deprecation(
2025-01-20 12:21:52.402857: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-01-20 12:21:52.417186: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-01-20 12:21:52.421395: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-01-20 12:21:52.433493: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-01-20 12:21:53.224627: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
This is for the BaseNet initialization.
modelname, pretrained_vit_b16_224_vpt basicmodelname vit_base_patch16_224
Using VPT model
Using Deep Prompt
After BaseNet initialization.
2025-01-20 12:22:00,258 [trainer.py] => All params: 173596160
2025-01-20 12:22:00,259 [trainer.py] => Trainable params: 1998848
/mnt/share/yinjunhui/cl/FSCIL-Diff/ldm/models/diffusion/ddpm.py:197: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sd = torch.load(path, map_location="cpu")
/mnt/share/yinjunhui/cl/FSCIL-Diff/models/asp.py:522: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(self.args['ldm_ckpt'], map_location="cpu")["state_dict"],
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 12:22:17,166 [asp.py] => Learning on 0-5
2025-01-20 12:22:17,172 [asp.py] => training set size: 2500, fc construct set size: 2500
Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:34<02:19, 34.77s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:11<01:47, 35.69s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:48<01:12, 36.48s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:26<00:37, 37.17s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:05<00:00, 37.72s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:05<00:00, 37.09s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:36, 39.14s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.20s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.37s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:40, 40.15s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.72s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.65s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:35, 38.78s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.59s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:16, 38.39s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.24s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.12s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.26s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:31, 37.95s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:53, 37.87s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:15, 37.90s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:31<00:37, 37.97s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:09<00:00, 37.99s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:09<00:00, 37.96s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:32, 38.02s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:54, 38.21s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:54<01:16, 38.32s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.31s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.25s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.25s/it]
2025-01-20 12:38:17,061 [asp.py] => total parameters: 173600001
2025-01-20 12:38:17,062 [asp.py] => trainable parameters: 2002689
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 3840
fc.sigma 1
anchor samples found
2025-01-20 12:39:20,715 [asp.py] => Task 0, Epoch 1 => Loss 1.215, Train_accy 83.72, Test_curr_accy 98.60, Test_accy 98.60
anchor samples found
2025-01-20 12:40:22,984 [asp.py] => Task 0, Epoch 2 => Loss 0.507, Train_accy 91.49, Test_curr_accy 99.00, Test_accy 99.00
anchor samples found
2025-01-20 12:41:24,345 [asp.py] => Task 0, Epoch 3 => Loss 0.421, Train_accy 92.59, Test_curr_accy 98.80, Test_accy 98.80
anchor samples found
2025-01-20 12:42:26,507 [asp.py] => Task 0, Epoch 4 => Loss 0.361, Train_accy 92.36, Test_curr_accy 99.40, Test_accy 99.40
anchor samples found
2025-01-20 12:43:27,451 [asp.py] => Task 0, Epoch 5 => Loss 0.335, Train_accy 93.74, Test_curr_accy 99.80, Test_accy 99.80
anchor samples found
2025-01-20 12:44:29,327 [asp.py] => Task 0, Epoch 6 => Loss 0.326, Train_accy 93.23, Test_curr_accy 99.40, Test_accy 99.40
anchor samples found
2025-01-20 12:45:30,727 [asp.py] => Task 0, Epoch 7 => Loss 0.281, Train_accy 93.86, Test_curr_accy 99.80, Test_accy 99.80
anchor samples found
2025-01-20 12:46:32,026 [asp.py] => Task 0, Epoch 8 => Loss 0.259, Train_accy 94.14, Test_curr_accy 99.60, Test_accy 99.60
anchor samples found
2025-01-20 12:47:33,623 [asp.py] => Task 0, Epoch 9 => Loss 0.247, Train_accy 94.53, Test_curr_accy 99.20, Test_accy 99.20
anchor samples found
2025-01-20 12:48:34,596 [asp.py] => Task 0, Epoch 10 => Loss 0.221, Train_accy 95.29, Test_curr_accy 99.60, Test_accy 99.60
2025-01-20 12:48:59,752 [trainer.py] => Top1 curve: [99.6]
2025-01-20 12:48:59,752 [trainer.py] => Average Accuracy (Top1): 99.6   (Harmonic Accuracy): None (Old Acc): 99.6 (New Acc): [] 

2025-01-20 12:48:59,753 [trainer.py] => All params: 173600001
2025-01-20 12:48:59,754 [trainer.py] => Trainable params: 2002689
Class Inversion:   0%|          | 0/20 [26:48<?, ?it/s]
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 12:49:22,844 [asp.py] => Learning on 5-10
2025-01-20 12:49:22,876 [asp.py] => training set size: 25, fc construct set size: 25
Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:35<02:22, 35.58s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:12<01:48, 36.10s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:49<01:13, 36.52s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:26<00:36, 36.81s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:03<00:00, 37.05s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:03<00:00, 36.76s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:31, 37.77s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:54, 38.02s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:54<01:16, 38.40s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.66s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.83s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.60s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:36, 39.14s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.16s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.21s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:36<00:39, 39.21s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:15<00:00, 39.21s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:15<00:00, 39.20s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.45s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.36s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.38s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.39s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.37s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.38s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.41s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.37s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.39s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.33s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.35s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.36s/it]
2025-01-20 13:05:34,399 [asp.py] => total parameters: 173603841
2025-01-20 13:05:34,400 [asp.py] => trainable parameters: 2006529
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 7680
fc.sigma 1
2025-01-20 13:05:41,429 [trainer.py] => Top1 curve: [99.6, 97.7]
2025-01-20 13:05:41,430 [trainer.py] => Average Accuracy (Top1): 98.65   (Harmonic Accuracy): 97.67697031729786 (Old Acc): 99.2 (New Acc): 96.2 

2025-01-20 13:05:41,430 [trainer.py] => All params: 173603841
2025-01-20 13:05:41,431 [trainer.py] => Trainable params: 2006529
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 13:06:01,792 [asp.py] => Learning on 10-15
2025-01-20 13:06:01,800 [asp.py] => training set size: 25, fc construct set size: 25

Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:28, 37.23s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:52, 37.63s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:16, 38.01s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.40s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.69s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.36s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.32s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.24s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.28s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.33s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.33s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.32s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.62s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.49s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.47s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.47s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.59s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.55s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.95s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.69s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.65s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.61s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.56s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.62s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.44s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.42s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.42s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.38s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.42s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.41s/it]
2025-01-20 13:22:28,382 [asp.py] => total parameters: 173607681
2025-01-20 13:22:28,383 [asp.py] => trainable parameters: 2010369
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 11520
fc.sigma 1
2025-01-20 13:22:37,576 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47]
2025-01-20 13:22:37,576 [trainer.py] => Average Accuracy (Top1): 96.25666666666666   (Harmonic Accuracy): 92.80752283718431 (Old Acc): 97.8 (New Acc): 88.3 

2025-01-20 13:22:37,577 [trainer.py] => All params: 173607681
2025-01-20 13:22:37,577 [trainer.py] => Trainable params: 2010369
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 13:22:58,027 [asp.py] => Learning on 15-20
2025-01-20 13:22:58,038 [asp.py] => training set size: 25, fc construct set size: 25


Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A[AClass Inversion:   0%|          | 0/20 [33:34<?, ?it/s]
Class Inversion:   0%|          | 0/20 [16:56<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:29, 37.26s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:52, 37.61s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:16, 38.14s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.49s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.77s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.43s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.34s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.31s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.28s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.29s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.31s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.30s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.35s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.29s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.31s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.34s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.36s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.35s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.52s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.45s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.45s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.43s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.42s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.43s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.52s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.44s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.43s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.99s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.30s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.00s/it]
2025-01-20 13:39:26,391 [asp.py] => total parameters: 173611521
2025-01-20 13:39:26,392 [asp.py] => trainable parameters: 2014209
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 15360
fc.sigma 1
2025-01-20 13:39:38,069 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45]
2025-01-20 13:39:38,069 [trainer.py] => Average Accuracy (Top1): 94.55499999999999   (Harmonic Accuracy): 91.89736176364293 (Old Acc): 97.8 (New Acc): 86.66666666666667 

2025-01-20 13:39:38,070 [trainer.py] => All params: 173611521
2025-01-20 13:39:38,070 [trainer.py] => Trainable params: 2014209
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 13:39:57,488 [asp.py] => Learning on 20-25
2025-01-20 13:39:57,499 [asp.py] => training set size: 25, fc construct set size: 25
Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:36<02:27, 36.99s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:14<01:52, 37.36s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:52<01:15, 37.68s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:31<00:37, 37.95s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:09<00:00, 38.20s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:09<00:00, 37.94s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:33, 38.35s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:54, 38.22s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:54<01:16, 38.13s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.03s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.08s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.11s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:33, 38.49s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:55, 38.43s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:16, 38.31s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.18s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.08s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.19s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:31, 37.91s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:53, 37.82s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:15, 37.85s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:31<00:37, 37.76s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:08<00:00, 37.70s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:08<00:00, 37.75s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:30, 37.59s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:53, 37.74s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:15, 37.74s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:30<00:37, 37.76s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:08<00:00, 37.75s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:08<00:00, 37.74s/it]
2025-01-20 13:55:51,936 [asp.py] => total parameters: 173615361
2025-01-20 13:55:51,937 [asp.py] => trainable parameters: 2018049
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 19200
fc.sigma 1
2025-01-20 13:56:05,629 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88]
2025-01-20 13:56:05,629 [trainer.py] => Average Accuracy (Top1): 93.41999999999999   (Harmonic Accuracy): 91.64481914604296 (Old Acc): 97.0 (New Acc): 86.85 

2025-01-20 13:56:05,630 [trainer.py] => All params: 173615361
2025-01-20 13:56:05,631 [trainer.py] => Trainable params: 2018049
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 13:56:29,367 [asp.py] => Learning on 25-30
2025-01-20 13:56:29,382 [asp.py] => training set size: 25, fc construct set size: 25

Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:35<02:22, 35.75s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:12<01:48, 36.28s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:49<01:13, 36.63s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:26<00:36, 36.89s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:04<00:00, 37.18s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:04<00:00, 36.89s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:32, 38.20s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:54, 38.33s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.52s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.85s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.88s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.73s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:36, 39.25s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.27s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.26s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.29s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.29s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.28s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.36s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.34s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:00<01:20, 40.37s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:41<00:40, 40.75s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:21<00:00, 40.57s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:21<00:00, 40.37s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.81s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.62s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.58s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.47s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.40s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.48s/it]
2025-01-20 14:12:48,844 [asp.py] => total parameters: 173619201
2025-01-20 14:12:48,846 [asp.py] => trainable parameters: 2021889
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 23040
fc.sigma 1
2025-01-20 14:13:05,074 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77]
2025-01-20 14:13:05,075 [trainer.py] => Average Accuracy (Top1): 92.145   (Harmonic Accuracy): 89.69403415391439 (Old Acc): 96.8 (New Acc): 83.55999999999999 

2025-01-20 14:13:05,076 [trainer.py] => All params: 173619201
2025-01-20 14:13:05,076 [trainer.py] => Trainable params: 2021889
Class Inversion:   0%|          | 0/20 [50:16<?, ?it/s]
Class Inversion:   0%|          | 0/20 [33:16<?, ?it/s]
Class Inversion:   0%|          | 0/20 [16:44<?, ?it/s]
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 14:13:25,349 [asp.py] => Learning on 30-35
2025-01-20 14:13:25,362 [asp.py] => training set size: 25, fc construct set size: 25
Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:29, 37.41s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:53, 37.87s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:54<01:16, 38.26s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.54s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.74s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.48s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.33s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.29s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.63s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:40<00:40, 40.55s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:21<00:00, 40.55s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:21<00:00, 40.23s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.79s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.59s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.49s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.46s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.40s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.46s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.60s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.45s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.84s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:41<00:40, 40.81s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:21<00:00, 40.66s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:21<00:00, 40.39s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.85s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.65s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.56s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.54s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.52s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.56s/it]
2025-01-20 14:30:01,809 [asp.py] => total parameters: 173623041
2025-01-20 14:30:01,811 [asp.py] => trainable parameters: 2025729
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 26880
fc.sigma 1
2025-01-20 14:30:20,440 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4]
2025-01-20 14:30:20,441 [trainer.py] => Average Accuracy (Top1): 91.03857142857143   (Harmonic Accuracy): 88.85190156599552 (Old Acc): 96.4 (New Acc): 82.39999999999999 

2025-01-20 14:30:20,442 [trainer.py] => All params: 173623041
2025-01-20 14:30:20,442 [trainer.py] => Trainable params: 2025729
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 14:30:41,111 [asp.py] => Learning on 35-40
2025-01-20 14:30:41,127 [asp.py] => training set size: 25, fc construct set size: 25

Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:28, 37.14s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:52, 37.59s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:16, 38.09s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.44s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.65s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.35s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.34s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.30s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.38s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.37s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.34s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.35s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.53s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.52s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.51s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.45s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.44s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.46s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.46s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.36s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.28s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.23s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.24s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.27s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:36, 39.06s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:56, 38.96s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:56<01:17, 38.90s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:35<00:38, 38.89s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:14<00:00, 38.90s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:14<00:00, 38.92s/it]
2025-01-20 14:47:03,695 [asp.py] => total parameters: 173626881
2025-01-20 14:47:03,696 [asp.py] => trainable parameters: 2029569
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 30720
fc.sigma 1
2025-01-20 14:47:24,740 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82]
2025-01-20 14:47:24,740 [trainer.py] => Average Accuracy (Top1): 90.01124999999999   (Harmonic Accuracy): 87.89753185997742 (Old Acc): 96.2 (New Acc): 80.91428571428571 

2025-01-20 14:47:24,741 [trainer.py] => All params: 173626881
2025-01-20 14:47:24,742 [trainer.py] => Trainable params: 2029569
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 14:47:44,746 [asp.py] => Learning on 40-45
2025-01-20 14:47:44,764 [asp.py] => training set size: 25, fc construct set size: 25


Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A[A


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:28, 37.17s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:52, 37.62s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:15, 37.98s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.23s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.44s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.19s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.31s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.32s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.32s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.32s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 40.48s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.96s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:36, 39.18s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.26s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.40s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.40s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.45s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.40s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.29s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.15s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.13s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:36<00:39, 39.12s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:15<00:00, 39.11s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:15<00:00, 39.13s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:36, 39.07s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.06s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.95s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:40<00:40, 40.32s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.94s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.85s/it]
2025-01-20 15:04:13,860 [asp.py] => total parameters: 173630721
2025-01-20 15:04:13,862 [asp.py] => trainable parameters: 2033409
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 34560
fc.sigma 1
2025-01-20 15:04:37,498 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13]
2025-01-20 15:04:37,498 [trainer.py] => Average Accuracy (Top1): 89.13555555555554   (Harmonic Accuracy): 87.51020408163265 (Old Acc): 96.0 (New Acc): 80.4 

2025-01-20 15:04:37,499 [trainer.py] => All params: 173630721
2025-01-20 15:04:37,500 [trainer.py] => Trainable params: 2033409
Class Inversion:   0%|          | 0/20 [51:17<?, ?it/s]
Class Inversion:   0%|          | 0/20 [34:02<?, ?it/s]
Class Inversion:   0%|          | 0/20 [16:58<?, ?it/s]
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 15:04:57,868 [asp.py] => Learning on 45-50
2025-01-20 15:04:57,886 [asp.py] => training set size: 25, fc construct set size: 25
Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:28, 37.12s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:52, 37.58s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:16, 38.07s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.42s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.67s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.35s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.37s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.41s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.36s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.38s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.40s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.39s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.09s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:21<02:03, 41.11s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:02<01:21, 40.93s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:42<00:40, 40.57s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:22<00:00, 40.26s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:22<00:00, 40.47s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:41, 40.46s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.20s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:00<01:19, 39.94s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.78s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.70s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.84s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.63s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.52s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.46s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.42s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.43s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.45s/it]
2025-01-20 15:21:31,835 [asp.py] => total parameters: 173634561
2025-01-20 15:21:31,836 [asp.py] => trainable parameters: 2037249
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 38400
fc.sigma 1
2025-01-20 15:21:57,530 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26]
2025-01-20 15:21:57,530 [trainer.py] => Average Accuracy (Top1): 88.24799999999999   (Harmonic Accuracy): 86.37921813319751 (Old Acc): 96.0 (New Acc): 78.51111111111112 

2025-01-20 15:21:57,531 [trainer.py] => All params: 173634561
2025-01-20 15:21:57,531 [trainer.py] => Trainable params: 2037249
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 15:22:16,975 [asp.py] => Learning on 50-55
2025-01-20 15:22:16,994 [asp.py] => training set size: 25, fc construct set size: 25

Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:28, 37.23s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:53, 37.68s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:16, 38.03s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.40s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.66s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.35s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:36, 39.24s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.29s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.30s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.30s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.29s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.29s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.51s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.43s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.43s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.44s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 40.10s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.81s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:41<02:45, 41.28s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:21<02:02, 40.81s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:01<01:20, 40.48s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:41<00:40, 40.17s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:21<00:00, 39.95s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:21<00:00, 40.22s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.71s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.61s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:20, 40.08s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.84s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.67s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.75s/it]
2025-01-20 15:38:50,712 [asp.py] => total parameters: 173638401
2025-01-20 15:38:50,713 [asp.py] => trainable parameters: 2041089
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 42240
fc.sigma 1
2025-01-20 15:39:19,067 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87]
2025-01-20 15:39:19,067 [trainer.py] => Average Accuracy (Top1): 87.48636363636363   (Harmonic Accuracy): 86.08947671075329 (Old Acc): 95.6 (New Acc): 78.29999999999998 

2025-01-20 15:39:19,068 [trainer.py] => All params: 173638401
2025-01-20 15:39:19,069 [trainer.py] => Trainable params: 2041089
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 15:39:39,295 [asp.py] => Learning on 55-60
2025-01-20 15:39:39,316 [asp.py] => training set size: 25, fc construct set size: 25


Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A[AClass Inversion:   0%|          | 0/20 [34:41<?, ?it/s]
Class Inversion:   0%|          | 0/20 [17:22<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:28, 37.21s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:53, 37.85s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:54<01:16, 38.28s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.56s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.76s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.48s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.33s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:22<02:04, 41.34s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:01<01:20, 40.32s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:40<00:39, 39.92s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.72s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.97s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:41, 40.40s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.79s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.61s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.64s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.60s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.68s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.60s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.64s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.64s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.62s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.62s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.62s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.64s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.54s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 40.00s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:41<00:40, 40.63s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.16s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.12s/it]
2025-01-20 15:56:15,434 [asp.py] => total parameters: 173642241
2025-01-20 15:56:15,436 [asp.py] => trainable parameters: 2044929
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 46080
fc.sigma 1
2025-01-20 15:56:45,964 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88]
2025-01-20 15:56:45,965 [trainer.py] => Average Accuracy (Top1): 86.76916666666666   (Harmonic Accuracy): 85.38215527230591 (Old Acc): 95.2 (New Acc): 77.39999999999999 

2025-01-20 15:56:45,965 [trainer.py] => All params: 173642241
2025-01-20 15:56:45,966 [trainer.py] => Trainable params: 2044929
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 15:57:06,345 [asp.py] => Learning on 60-65
2025-01-20 15:57:06,370 [asp.py] => training set size: 25, fc construct set size: 25
Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:29, 37.26s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:52, 37.66s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:16, 38.02s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.28s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.49s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.24s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:36, 39.17s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:02, 40.71s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.89s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.55s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.35s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.58s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.44s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:22<02:04, 41.39s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:02<01:22, 41.08s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:42<00:40, 40.35s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 39.76s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.17s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.70s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:56, 38.72s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:56<01:17, 38.69s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.66s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.58s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.63s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.54s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:55, 38.40s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:16, 38.33s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.29s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.25s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.30s/it]
2025-01-20 16:13:28,143 [asp.py] => total parameters: 173646081
2025-01-20 16:13:28,144 [asp.py] => trainable parameters: 2048769
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 49920
fc.sigma 1
2025-01-20 16:14:01,159 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22]
2025-01-20 16:14:01,160 [trainer.py] => Average Accuracy (Top1): 86.03461538461539   (Harmonic Accuracy): 84.34784982935155 (Old Acc): 95.2 (New Acc): 75.71666666666668 

2025-01-20 16:14:01,162 [trainer.py] => All params: 173646081
2025-01-20 16:14:01,162 [trainer.py] => Trainable params: 2048769
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 16:14:21,936 [asp.py] => Learning on 65-70
2025-01-20 16:14:21,959 [asp.py] => training set size: 25, fc construct set size: 25

Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:36<02:25, 36.28s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:12<01:49, 36.54s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:50<01:14, 37.00s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:28<00:37, 37.31s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:06<00:00, 37.53s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:06<00:00, 37.25s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:32, 38.10s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:54, 38.07s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:54<01:16, 38.12s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.16s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.18s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.15s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:33, 38.37s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:55, 38.35s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:54<01:16, 38.32s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.33s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.36s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.35s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.66s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.55s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.61s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.64s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.71s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.67s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.55s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:55, 38.44s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:16, 38.37s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.32s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.29s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.34s/it]
2025-01-20 16:30:25,419 [asp.py] => total parameters: 173649921
2025-01-20 16:30:25,420 [asp.py] => trainable parameters: 2052609
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 53760
fc.sigma 1
2025-01-20 16:31:13,844 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57]
2025-01-20 16:31:13,844 [trainer.py] => Average Accuracy (Top1): 85.35857142857142   (Harmonic Accuracy): 83.9878612716763 (Old Acc): 95.2 (New Acc): 75.13846153846153 

2025-01-20 16:31:13,845 [trainer.py] => All params: 173649921
2025-01-20 16:31:13,847 [trainer.py] => Trainable params: 2052609
Class Inversion:   0%|          | 0/20 [51:45<?, ?it/s]
Class Inversion:   0%|          | 0/20 [34:18<?, ?it/s]
Class Inversion:   0%|          | 0/20 [17:02<?, ?it/s]
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 16:31:58,808 [asp.py] => Learning on 70-75
2025-01-20 16:31:58,858 [asp.py] => training set size: 25, fc construct set size: 25
Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:35<02:22, 35.66s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:12<01:48, 36.33s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:49<01:13, 36.79s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:27<00:37, 37.24s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:06<00:00, 37.66s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:06<00:00, 37.22s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.55s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.62s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.58s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.57s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.51s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.54s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:33, 38.45s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:55, 38.43s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:16, 38.45s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.45s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.44s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.44s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.55s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.53s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.54s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.60s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.65s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.61s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:35, 38.76s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.63s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:56<01:17, 38.97s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.58s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.36s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.52s/it]
2025-01-20 16:48:07,049 [asp.py] => total parameters: 173653761
2025-01-20 16:48:07,050 [asp.py] => trainable parameters: 2056449
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 57600
fc.sigma 1
2025-01-20 16:48:44,369 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72]
2025-01-20 16:48:44,370 [trainer.py] => Average Accuracy (Top1): 84.64933333333333   (Harmonic Accuracy): 82.46415963161934 (Old Acc): 94.2 (New Acc): 73.32857142857142 

2025-01-20 16:48:44,371 [trainer.py] => All params: 173653761
2025-01-20 16:48:44,372 [trainer.py] => Trainable params: 2056449
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 16:49:06,541 [asp.py] => Learning on 75-80
2025-01-20 16:49:06,566 [asp.py] => training set size: 25, fc construct set size: 25

Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:36<02:25, 36.33s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:13<01:49, 36.66s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:50<01:14, 37.11s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:28<00:37, 37.44s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:06<00:00, 37.69s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:06<00:00, 37.39s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:33, 38.28s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:54, 38.28s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:54<01:16, 38.29s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.28s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.32s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.30s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:33, 38.48s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:55, 38.41s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:16, 38.37s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.40s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.44s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.42s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:33, 38.44s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:55, 38.43s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.57s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.78s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.84s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.73s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:36, 39.04s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.14s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:17, 38.97s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:35<00:38, 38.92s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:14<00:00, 38.89s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:14<00:00, 38.94s/it]
2025-01-20 17:05:15,569 [asp.py] => total parameters: 173657601
2025-01-20 17:05:15,571 [asp.py] => trainable parameters: 2060289
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 61440
fc.sigma 1
2025-01-20 17:06:02,980 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72, 74.91]
2025-01-20 17:06:02,981 [trainer.py] => Average Accuracy (Top1): 84.040625   (Harmonic Accuracy): 82.65232382616986 (Old Acc): 94.2 (New Acc): 73.62666666666668 

2025-01-20 17:06:02,983 [trainer.py] => All params: 173657601
2025-01-20 17:06:02,984 [trainer.py] => Trainable params: 2060289
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 17:06:31,919 [asp.py] => Learning on 80-85
2025-01-20 17:06:31,985 [asp.py] => training set size: 25, fc construct set size: 25


Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A[AClass Inversion:   0%|          | 0/20 [34:32<?, ?it/s]
Class Inversion:   0%|          | 0/20 [17:27<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:29, 37.28s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:53, 37.70s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:15, 37.97s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.23s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.35s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.15s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.72s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.62s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.61s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.63s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.63s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.63s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:35, 38.85s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:56, 38.88s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:56<01:17, 38.85s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:35<00:38, 38.78s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.71s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.77s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.72s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.61s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.62s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.61s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.60s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.62s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.72s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.61s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.62s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.60s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.59s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.61s/it]
2025-01-20 17:22:46,667 [asp.py] => total parameters: 173661441
2025-01-20 17:22:46,668 [asp.py] => trainable parameters: 2064129
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 65280
fc.sigma 1
2025-01-20 17:23:29,960 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72, 74.91, 74.98]
2025-01-20 17:23:29,960 [trainer.py] => Average Accuracy (Top1): 83.50764705882354   (Harmonic Accuracy): 82.7457062062807 (Old Acc): 94.2 (New Acc): 73.77499999999999 

2025-01-20 17:23:29,961 [trainer.py] => All params: 173661441
2025-01-20 17:23:29,962 [trainer.py] => Trainable params: 2064129
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 17:23:51,456 [asp.py] => Learning on 85-90
2025-01-20 17:23:51,485 [asp.py] => training set size: 25, fc construct set size: 25
Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:28, 37.16s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:53, 37.67s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:54<01:16, 38.20s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.41s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.52s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.29s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.65s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.60s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.68s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.66s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.56s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.60s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:33, 38.41s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:55, 38.39s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:16, 38.35s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:33<00:38, 38.34s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.42s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.39s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.72s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.65s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.59s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.57s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.55s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.58s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.65s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.62s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.61s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.60s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.60s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.60s/it]
2025-01-20 17:40:03,527 [asp.py] => total parameters: 173665281
2025-01-20 17:40:03,528 [asp.py] => trainable parameters: 2067969
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 69120
fc.sigma 1
2025-01-20 17:40:48,676 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72, 74.91, 74.98, 75.38]
2025-01-20 17:40:48,677 [trainer.py] => Average Accuracy (Top1): 83.05611111111112   (Harmonic Accuracy): 83.05650837988827 (Old Acc): 94.2 (New Acc): 74.27058823529411 

2025-01-20 17:40:48,678 [trainer.py] => All params: 173665281
2025-01-20 17:40:48,679 [trainer.py] => Trainable params: 2067969
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 17:41:10,939 [asp.py] => Learning on 90-95
2025-01-20 17:41:10,985 [asp.py] => training set size: 25, fc construct set size: 25

Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:28, 37.21s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:53, 37.83s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:53<01:16, 38.03s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.12s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.19s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:10<00:00, 38.06s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:33, 38.39s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:16<01:55, 38.51s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.53s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.58s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.59s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.56s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.66s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.63s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.65s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.61s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.60s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.62s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.64s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.56s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.53s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.53s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.53s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.54s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.66s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.60s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.57s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.61s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.59s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.60s/it]
2025-01-20 17:57:22,118 [asp.py] => total parameters: 173669121
2025-01-20 17:57:22,119 [asp.py] => trainable parameters: 2071809
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 72960
fc.sigma 1
2025-01-20 17:58:09,255 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72, 74.91, 74.98, 75.38, 74.19]
2025-01-20 17:58:09,256 [trainer.py] => Average Accuracy (Top1): 82.58947368421055   (Harmonic Accuracy): 82.3053337761541 (Old Acc): 94.2 (New Acc): 73.07777777777777 

2025-01-20 17:58:09,257 [trainer.py] => All params: 173669121
2025-01-20 17:58:09,258 [trainer.py] => Trainable params: 2071809
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-20 17:58:29,707 [asp.py] => Learning on 95-100
2025-01-20 17:58:29,742 [asp.py] => training set size: 25, fc construct set size: 25



Class Inversion:   0%|          | 0/20 [00:00<?, ?it/s][A[A[AClass Inversion:   0%|          | 0/20 [51:56<?, ?it/s]
Class Inversion:   0%|          | 0/20 [34:38<?, ?it/s]
Class Inversion:   0%|          | 0/20 [17:19<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:37<02:28, 37.22s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:15<01:53, 37.85s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:54<01:16, 38.15s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:32<00:38, 38.30s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.39s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:11<00:00, 38.22s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.70s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.66s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:17, 38.66s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.64s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.63s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.64s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.71s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:55, 38.63s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:55<01:16, 38.49s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.46s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.52s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:12<00:00, 38.53s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:38<02:34, 38.68s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:17<01:56, 38.75s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:56<01:17, 38.85s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:34<00:38, 38.71s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.77s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:13<00:00, 38.76s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:36, 39.22s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.22s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.18s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:36<00:39, 39.15s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:15<00:00, 39.10s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:15<00:00, 39.14s/it]
2025-01-20 18:14:46,536 [asp.py] => total parameters: 173672961
2025-01-20 18:14:46,544 [asp.py] => trainable parameters: 2075649
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 76800
fc.sigma 1
2025-01-20 18:15:44,465 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72, 74.91, 74.98, 75.38, 74.19, 73.1]
2025-01-20 18:15:44,466 [trainer.py] => Average Accuracy (Top1): 82.11500000000001   (Harmonic Accuracy): 81.61056498606537 (Old Acc): 94.2 (New Acc): 71.98947368421052 

2025-01-20 18:15:44,467 [trainer.py] => 

Class Inversion:   0%|          | 0/20 [17:14<?, ?it/s]
