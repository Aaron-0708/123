2025-01-05 19:17:31,124 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:17:31,125 [trainer.py] => model_name: asp
2025-01-05 19:17:31,125 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:17:31,125 [trainer.py] => device: ['cuda']
2025-01-05 19:17:31,125 [trainer.py] => seed: 2024
2025-01-05 19:17:31,125 [trainer.py] => dataset: cifar224
2025-01-05 19:17:31,125 [trainer.py] => init_cls: 1
2025-01-05 19:17:31,125 [trainer.py] => increment: 5
2025-01-05 19:17:31,125 [trainer.py] => kshot: 5
2025-01-05 19:17:31,125 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:17:31,125 [trainer.py] => z_dim: 1000
2025-01-05 19:17:31,125 [trainer.py] => conv_dim: 64
2025-01-05 19:17:31,125 [trainer.py] => img_size: 224
2025-01-05 19:17:31,125 [trainer.py] => generator_lr: 0.005
2025-01-05 19:17:31,125 [trainer.py] => pi: 100
2025-01-05 19:17:31,125 [trainer.py] => w_bn: 50.0
2025-01-05 19:17:31,125 [trainer.py] => w_noise: 0.001
2025-01-05 19:17:31,125 [trainer.py] => server_ss: 32
2025-01-05 19:17:31,125 [trainer.py] => bn_loss: 1
2025-01-05 19:17:31,125 [trainer.py] => noise: 1
2025-01-05 19:17:31,125 [trainer.py] => ie_loss: 1
2025-01-05 19:17:31,125 [trainer.py] => act_loss: 0
2025-01-05 19:17:31,125 [trainer.py] => w_ie: 1.0
2025-01-05 19:17:31,125 [trainer.py] => w_act: 0.1
2025-01-05 19:17:31,125 [trainer.py] => syn_size: 32
2025-01-05 19:17:31,125 [trainer.py] => need_syn_imgs: True
2025-01-05 19:17:31,125 [trainer.py] => g_local_bs: 5
2025-01-05 19:17:31,125 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:17:31,125 [trainer.py] => g_local_train_steps: 1
2025-01-05 19:17:31,125 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:17:31,125 [trainer.py] => com_round_gen: 10
2025-01-05 19:17:31,126 [trainer.py] => g_sigma: 0
2025-01-05 19:17:31,126 [trainer.py] => save_cls_embeds: False
2025-01-05 19:17:31,126 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 19:17:31,126 [trainer.py] => save_dir: outputs
2025-01-05 19:17:31,126 [trainer.py] => n_iter: 5
2025-01-05 19:17:31,126 [trainer.py] => num_users: 1
2025-01-05 19:17:31,126 [trainer.py] => cur_size: 50
2025-01-05 19:17:31,126 [trainer.py] => vpt_type: Deep
2025-01-05 19:17:31,126 [trainer.py] => prompt_token_num: 6
2025-01-05 19:17:31,126 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:17:31,126 [trainer.py] => perturb_var: 1
2025-01-05 19:17:31,126 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:17:31,126 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:17:31,126 [trainer.py] => kl_weight: 0.001
2025-01-05 19:17:31,126 [trainer.py] => TIP_init: zero
2025-01-05 19:17:31,126 [trainer.py] => tuned_epoch: 10
2025-01-05 19:17:31,126 [trainer.py] => fs_epoch: 0
2025-01-05 19:17:31,126 [trainer.py] => init_lr: 0.01
2025-01-05 19:17:31,126 [trainer.py] => fs_lr: 0.001
2025-01-05 19:17:31,126 [trainer.py] => batch_size: 48
2025-01-05 19:17:31,126 [trainer.py] => fs_batch_size: 16
2025-01-05 19:17:31,126 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:17:31,126 [trainer.py] => min_lr: 0
2025-01-05 19:17:31,126 [trainer.py] => optimizer: sgd
2025-01-05 19:17:31,126 [trainer.py] => memory_size: 0
2025-01-05 19:17:31,126 [trainer.py] => memory_per_class: 0
2025-01-05 19:17:31,126 [trainer.py] => fixed_memory: False
2025-01-05 19:17:31,126 [trainer.py] => shuffle: False
2025-01-05 19:17:31,126 [trainer.py] => top_k: 5
2025-01-05 19:17:31,126 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:17:31,126 [trainer.py] => prefix: asp
2025-01-05 19:17:31,126 [trainer.py] => model_prefix: asp
2025-01-05 19:17:32,924 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:18:08,025 [trainer.py] => All params: 173596160
2025-01-05 19:18:08,027 [trainer.py] => Trainable params: 1998848
2025-01-05 19:18:08,028 [asp.py] => Learning on 0-1
2025-01-05 19:18:08,037 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 19:19:40,819 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:19:40,819 [trainer.py] => model_name: asp
2025-01-05 19:19:40,819 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:19:40,819 [trainer.py] => device: ['cuda']
2025-01-05 19:19:40,819 [trainer.py] => seed: 2024
2025-01-05 19:19:40,819 [trainer.py] => dataset: cifar224
2025-01-05 19:19:40,819 [trainer.py] => init_cls: 1
2025-01-05 19:19:40,819 [trainer.py] => increment: 5
2025-01-05 19:19:40,819 [trainer.py] => kshot: 5
2025-01-05 19:19:40,819 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:19:40,820 [trainer.py] => z_dim: 1000
2025-01-05 19:19:40,820 [trainer.py] => conv_dim: 64
2025-01-05 19:19:40,821 [trainer.py] => img_size: 224
2025-01-05 19:19:40,821 [trainer.py] => generator_lr: 0.005
2025-01-05 19:19:40,821 [trainer.py] => pi: 100
2025-01-05 19:19:40,821 [trainer.py] => w_bn: 50.0
2025-01-05 19:19:40,821 [trainer.py] => w_noise: 0.001
2025-01-05 19:19:40,821 [trainer.py] => server_ss: 32
2025-01-05 19:19:40,821 [trainer.py] => bn_loss: 1
2025-01-05 19:19:40,821 [trainer.py] => noise: 1
2025-01-05 19:19:40,821 [trainer.py] => ie_loss: 1
2025-01-05 19:19:40,821 [trainer.py] => act_loss: 0
2025-01-05 19:19:40,821 [trainer.py] => w_ie: 1.0
2025-01-05 19:19:40,821 [trainer.py] => w_act: 0.1
2025-01-05 19:19:40,821 [trainer.py] => syn_size: 32
2025-01-05 19:19:40,821 [trainer.py] => need_syn_imgs: True
2025-01-05 19:19:40,821 [trainer.py] => g_local_bs: 5
2025-01-05 19:19:40,821 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:19:40,821 [trainer.py] => g_local_train_steps: 1
2025-01-05 19:19:40,821 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:19:40,821 [trainer.py] => com_round_gen: 10
2025-01-05 19:19:40,821 [trainer.py] => g_sigma: 0
2025-01-05 19:19:40,821 [trainer.py] => save_cls_embeds: False
2025-01-05 19:19:40,821 [trainer.py] => syn_image_path: None
2025-01-05 19:19:40,821 [trainer.py] => save_dir: outputs
2025-01-05 19:19:40,821 [trainer.py] => n_iter: 5
2025-01-05 19:19:40,822 [trainer.py] => num_users: 1
2025-01-05 19:19:40,822 [trainer.py] => cur_size: 50
2025-01-05 19:19:40,822 [trainer.py] => vpt_type: Deep
2025-01-05 19:19:40,822 [trainer.py] => prompt_token_num: 6
2025-01-05 19:19:40,822 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:19:40,822 [trainer.py] => perturb_var: 1
2025-01-05 19:19:40,822 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:19:40,822 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:19:40,822 [trainer.py] => kl_weight: 0.001
2025-01-05 19:19:40,822 [trainer.py] => TIP_init: zero
2025-01-05 19:19:40,822 [trainer.py] => tuned_epoch: 10
2025-01-05 19:19:40,822 [trainer.py] => fs_epoch: 0
2025-01-05 19:19:40,822 [trainer.py] => init_lr: 0.01
2025-01-05 19:19:40,822 [trainer.py] => fs_lr: 0.001
2025-01-05 19:19:40,822 [trainer.py] => batch_size: 48
2025-01-05 19:19:40,822 [trainer.py] => fs_batch_size: 16
2025-01-05 19:19:40,822 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:19:40,822 [trainer.py] => min_lr: 0
2025-01-05 19:19:40,822 [trainer.py] => optimizer: sgd
2025-01-05 19:19:40,822 [trainer.py] => memory_size: 0
2025-01-05 19:19:40,822 [trainer.py] => memory_per_class: 0
2025-01-05 19:19:40,822 [trainer.py] => fixed_memory: False
2025-01-05 19:19:40,822 [trainer.py] => shuffle: False
2025-01-05 19:19:40,822 [trainer.py] => top_k: 5
2025-01-05 19:19:40,822 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:19:40,822 [trainer.py] => prefix: asp
2025-01-05 19:19:40,822 [trainer.py] => model_prefix: asp
2025-01-05 19:19:42,834 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:20:26,673 [trainer.py] => All params: 173596160
2025-01-05 19:20:26,674 [trainer.py] => Trainable params: 1998848
2025-01-05 19:20:26,675 [asp.py] => Learning on 0-1
2025-01-05 19:20:26,718 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 19:23:53,910 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:23:53,910 [trainer.py] => model_name: asp
2025-01-05 19:23:53,910 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:23:53,910 [trainer.py] => device: ['cuda']
2025-01-05 19:23:53,910 [trainer.py] => seed: 2024
2025-01-05 19:23:53,910 [trainer.py] => dataset: cifar224
2025-01-05 19:23:53,910 [trainer.py] => init_cls: 1
2025-01-05 19:23:53,910 [trainer.py] => increment: 5
2025-01-05 19:23:53,910 [trainer.py] => kshot: 5
2025-01-05 19:23:53,910 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:23:53,910 [trainer.py] => z_dim: 1000
2025-01-05 19:23:53,910 [trainer.py] => conv_dim: 64
2025-01-05 19:23:53,910 [trainer.py] => img_size: 224
2025-01-05 19:23:53,910 [trainer.py] => generator_lr: 0.005
2025-01-05 19:23:53,911 [trainer.py] => pi: 100
2025-01-05 19:23:53,911 [trainer.py] => w_bn: 50.0
2025-01-05 19:23:53,911 [trainer.py] => w_noise: 0.001
2025-01-05 19:23:53,911 [trainer.py] => server_ss: 32
2025-01-05 19:23:53,911 [trainer.py] => bn_loss: 1
2025-01-05 19:23:53,911 [trainer.py] => noise: 1
2025-01-05 19:23:53,911 [trainer.py] => ie_loss: 1
2025-01-05 19:23:53,911 [trainer.py] => act_loss: 0
2025-01-05 19:23:53,911 [trainer.py] => w_ie: 1.0
2025-01-05 19:23:53,911 [trainer.py] => w_act: 0.1
2025-01-05 19:23:53,911 [trainer.py] => syn_size: 32
2025-01-05 19:23:53,911 [trainer.py] => need_syn_imgs: True
2025-01-05 19:23:53,911 [trainer.py] => g_local_bs: 5
2025-01-05 19:23:53,911 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:23:53,911 [trainer.py] => g_local_train_steps: 1
2025-01-05 19:23:53,911 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:23:53,911 [trainer.py] => com_round_gen: 10
2025-01-05 19:23:53,911 [trainer.py] => g_sigma: 0
2025-01-05 19:23:53,911 [trainer.py] => save_cls_embeds: False
2025-01-05 19:23:53,911 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 19:23:53,911 [trainer.py] => save_dir: outputs
2025-01-05 19:23:53,911 [trainer.py] => n_iter: 5
2025-01-05 19:23:53,911 [trainer.py] => num_users: 1
2025-01-05 19:23:53,911 [trainer.py] => cur_size: 50
2025-01-05 19:23:53,911 [trainer.py] => vpt_type: Deep
2025-01-05 19:23:53,911 [trainer.py] => prompt_token_num: 6
2025-01-05 19:23:53,911 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:23:53,911 [trainer.py] => perturb_var: 1
2025-01-05 19:23:53,911 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:23:53,911 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:23:53,911 [trainer.py] => kl_weight: 0.001
2025-01-05 19:23:53,911 [trainer.py] => TIP_init: zero
2025-01-05 19:23:53,911 [trainer.py] => tuned_epoch: 10
2025-01-05 19:23:53,911 [trainer.py] => fs_epoch: 0
2025-01-05 19:23:53,911 [trainer.py] => init_lr: 0.01
2025-01-05 19:23:53,912 [trainer.py] => fs_lr: 0.001
2025-01-05 19:23:53,912 [trainer.py] => batch_size: 48
2025-01-05 19:23:53,912 [trainer.py] => fs_batch_size: 16
2025-01-05 19:23:53,912 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:23:53,912 [trainer.py] => min_lr: 0
2025-01-05 19:23:53,912 [trainer.py] => optimizer: sgd
2025-01-05 19:23:53,912 [trainer.py] => memory_size: 0
2025-01-05 19:23:53,912 [trainer.py] => memory_per_class: 0
2025-01-05 19:23:53,912 [trainer.py] => fixed_memory: False
2025-01-05 19:23:53,912 [trainer.py] => shuffle: False
2025-01-05 19:23:53,912 [trainer.py] => top_k: 5
2025-01-05 19:23:53,912 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:23:53,912 [trainer.py] => prefix: asp
2025-01-05 19:23:53,912 [trainer.py] => model_prefix: asp
2025-01-05 19:23:55,739 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:24:28,131 [trainer.py] => All params: 173596160
2025-01-05 19:24:28,132 [trainer.py] => Trainable params: 1998848
2025-01-05 19:24:28,132 [asp.py] => Learning on 0-1
2025-01-05 19:24:28,134 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 19:28:21,639 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:28:21,639 [trainer.py] => model_name: asp
2025-01-05 19:28:21,639 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:28:21,639 [trainer.py] => device: ['cuda']
2025-01-05 19:28:21,639 [trainer.py] => seed: 2024
2025-01-05 19:28:21,639 [trainer.py] => dataset: cifar224
2025-01-05 19:28:21,639 [trainer.py] => init_cls: 1
2025-01-05 19:28:21,639 [trainer.py] => increment: 5
2025-01-05 19:28:21,639 [trainer.py] => kshot: 5
2025-01-05 19:28:21,639 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:28:21,639 [trainer.py] => z_dim: 1000
2025-01-05 19:28:21,639 [trainer.py] => conv_dim: 64
2025-01-05 19:28:21,639 [trainer.py] => img_size: 224
2025-01-05 19:28:21,639 [trainer.py] => generator_lr: 0.005
2025-01-05 19:28:21,639 [trainer.py] => pi: 100
2025-01-05 19:28:21,639 [trainer.py] => w_bn: 50.0
2025-01-05 19:28:21,639 [trainer.py] => w_noise: 0.001
2025-01-05 19:28:21,639 [trainer.py] => server_ss: 32
2025-01-05 19:28:21,639 [trainer.py] => bn_loss: 1
2025-01-05 19:28:21,639 [trainer.py] => noise: 1
2025-01-05 19:28:21,639 [trainer.py] => ie_loss: 1
2025-01-05 19:28:21,640 [trainer.py] => act_loss: 0
2025-01-05 19:28:21,640 [trainer.py] => w_ie: 1.0
2025-01-05 19:28:21,640 [trainer.py] => w_act: 0.1
2025-01-05 19:28:21,640 [trainer.py] => syn_size: 32
2025-01-05 19:28:21,640 [trainer.py] => need_syn_imgs: True
2025-01-05 19:28:21,640 [trainer.py] => g_local_bs: 5
2025-01-05 19:28:21,640 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:28:21,640 [trainer.py] => g_local_train_steps: 1
2025-01-05 19:28:21,640 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:28:21,640 [trainer.py] => com_round_gen: 10
2025-01-05 19:28:21,640 [trainer.py] => g_sigma: 0
2025-01-05 19:28:21,640 [trainer.py] => save_cls_embeds: False
2025-01-05 19:28:21,640 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 19:28:21,640 [trainer.py] => save_dir: outputs
2025-01-05 19:28:21,640 [trainer.py] => n_iter: 5
2025-01-05 19:28:21,640 [trainer.py] => num_users: 1
2025-01-05 19:28:21,640 [trainer.py] => cur_size: 50
2025-01-05 19:28:21,640 [trainer.py] => local_bs: 128
2025-01-05 19:28:21,640 [trainer.py] => vpt_type: Deep
2025-01-05 19:28:21,640 [trainer.py] => prompt_token_num: 6
2025-01-05 19:28:21,640 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:28:21,640 [trainer.py] => perturb_var: 1
2025-01-05 19:28:21,640 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:28:21,640 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:28:21,640 [trainer.py] => kl_weight: 0.001
2025-01-05 19:28:21,640 [trainer.py] => TIP_init: zero
2025-01-05 19:28:21,640 [trainer.py] => tuned_epoch: 10
2025-01-05 19:28:21,640 [trainer.py] => fs_epoch: 0
2025-01-05 19:28:21,640 [trainer.py] => init_lr: 0.01
2025-01-05 19:28:21,640 [trainer.py] => fs_lr: 0.001
2025-01-05 19:28:21,640 [trainer.py] => batch_size: 48
2025-01-05 19:28:21,640 [trainer.py] => fs_batch_size: 16
2025-01-05 19:28:21,640 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:28:21,640 [trainer.py] => min_lr: 0
2025-01-05 19:28:21,640 [trainer.py] => optimizer: sgd
2025-01-05 19:28:21,640 [trainer.py] => memory_size: 0
2025-01-05 19:28:21,640 [trainer.py] => memory_per_class: 0
2025-01-05 19:28:21,641 [trainer.py] => fixed_memory: False
2025-01-05 19:28:21,641 [trainer.py] => shuffle: False
2025-01-05 19:28:21,641 [trainer.py] => top_k: 5
2025-01-05 19:28:21,641 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:28:21,641 [trainer.py] => prefix: asp
2025-01-05 19:28:21,641 [trainer.py] => model_prefix: asp
2025-01-05 19:28:23,572 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:28:57,577 [trainer.py] => All params: 173596160
2025-01-05 19:28:57,578 [trainer.py] => Trainable params: 1998848
2025-01-05 19:28:57,578 [asp.py] => Learning on 0-1
2025-01-05 19:28:57,614 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 19:29:09,850 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:29:09,850 [trainer.py] => model_name: asp
2025-01-05 19:29:09,850 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:29:09,850 [trainer.py] => device: ['cuda']
2025-01-05 19:29:09,850 [trainer.py] => seed: 2024
2025-01-05 19:29:09,850 [trainer.py] => dataset: cifar224
2025-01-05 19:29:09,850 [trainer.py] => init_cls: 1
2025-01-05 19:29:09,850 [trainer.py] => increment: 5
2025-01-05 19:29:09,850 [trainer.py] => kshot: 5
2025-01-05 19:29:09,850 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:29:09,850 [trainer.py] => z_dim: 1000
2025-01-05 19:29:09,850 [trainer.py] => conv_dim: 64
2025-01-05 19:29:09,850 [trainer.py] => img_size: 224
2025-01-05 19:29:09,850 [trainer.py] => generator_lr: 0.005
2025-01-05 19:29:09,850 [trainer.py] => pi: 100
2025-01-05 19:29:09,850 [trainer.py] => w_bn: 50.0
2025-01-05 19:29:09,850 [trainer.py] => w_noise: 0.001
2025-01-05 19:29:09,850 [trainer.py] => server_ss: 32
2025-01-05 19:29:09,850 [trainer.py] => bn_loss: 1
2025-01-05 19:29:09,850 [trainer.py] => noise: 1
2025-01-05 19:29:09,851 [trainer.py] => ie_loss: 1
2025-01-05 19:29:09,851 [trainer.py] => act_loss: 0
2025-01-05 19:29:09,851 [trainer.py] => w_ie: 1.0
2025-01-05 19:29:09,851 [trainer.py] => w_act: 0.1
2025-01-05 19:29:09,851 [trainer.py] => syn_size: 32
2025-01-05 19:29:09,851 [trainer.py] => need_syn_imgs: True
2025-01-05 19:29:09,851 [trainer.py] => g_local_bs: 5
2025-01-05 19:29:09,851 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:29:09,851 [trainer.py] => g_local_train_steps: 1
2025-01-05 19:29:09,851 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:29:09,851 [trainer.py] => com_round_gen: 10
2025-01-05 19:29:09,851 [trainer.py] => g_sigma: 0
2025-01-05 19:29:09,851 [trainer.py] => save_cls_embeds: False
2025-01-05 19:29:09,851 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 19:29:09,851 [trainer.py] => save_dir: outputs
2025-01-05 19:29:09,851 [trainer.py] => n_iter: 5
2025-01-05 19:29:09,851 [trainer.py] => num_users: 1
2025-01-05 19:29:09,851 [trainer.py] => cur_size: 50
2025-01-05 19:29:09,851 [trainer.py] => local_bs: 128
2025-01-05 19:29:09,851 [trainer.py] => vpt_type: Deep
2025-01-05 19:29:09,851 [trainer.py] => prompt_token_num: 6
2025-01-05 19:29:09,851 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:29:09,851 [trainer.py] => perturb_var: 1
2025-01-05 19:29:09,851 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:29:09,851 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:29:09,851 [trainer.py] => kl_weight: 0.001
2025-01-05 19:29:09,851 [trainer.py] => TIP_init: zero
2025-01-05 19:29:09,851 [trainer.py] => tuned_epoch: 10
2025-01-05 19:29:09,851 [trainer.py] => fs_epoch: 0
2025-01-05 19:29:09,852 [trainer.py] => init_lr: 0.01
2025-01-05 19:29:09,852 [trainer.py] => fs_lr: 0.001
2025-01-05 19:29:09,852 [trainer.py] => batch_size: 48
2025-01-05 19:29:09,852 [trainer.py] => fs_batch_size: 16
2025-01-05 19:29:09,852 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:29:09,852 [trainer.py] => min_lr: 0
2025-01-05 19:29:09,852 [trainer.py] => optimizer: sgd
2025-01-05 19:29:09,852 [trainer.py] => memory_size: 0
2025-01-05 19:29:09,852 [trainer.py] => memory_per_class: 0
2025-01-05 19:29:09,852 [trainer.py] => fixed_memory: False
2025-01-05 19:29:09,852 [trainer.py] => shuffle: False
2025-01-05 19:29:09,852 [trainer.py] => top_k: 5
2025-01-05 19:29:09,852 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:29:09,852 [trainer.py] => prefix: asp
2025-01-05 19:29:09,852 [trainer.py] => model_prefix: asp
2025-01-05 19:29:11,986 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:29:52,484 [trainer.py] => All params: 173596160
2025-01-05 19:29:52,486 [trainer.py] => Trainable params: 1998848
2025-01-05 19:29:52,486 [asp.py] => Learning on 0-1
2025-01-05 19:29:52,494 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 19:32:08,470 [asp.py] => total parameters: 173596929
2025-01-05 19:32:08,471 [asp.py] => trainable parameters: 1999617
2025-01-05 19:32:24,705 [asp.py] => Task 0, Epoch 1 => Loss 9.717, Train_accy 100.00, Test_curr_accy 100.00, Test_accy 100.00
2025-01-05 19:32:39,686 [asp.py] => Task 0, Epoch 2 => Loss 4.383, Train_accy 100.00, Test_curr_accy 100.00, Test_accy 100.00
2025-01-05 19:32:54,591 [asp.py] => Task 0, Epoch 3 => Loss 1.065, Train_accy 100.00, Test_curr_accy 100.00, Test_accy 100.00
2025-01-05 19:32:58,661 [asp.py] => total parameters: 173596929
2025-01-05 19:32:58,662 [asp.py] => trainable parameters: 1999617
2025-01-05 20:47:09,666 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 20:47:09,667 [trainer.py] => model_name: asp
2025-01-05 20:47:09,667 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 20:47:09,667 [trainer.py] => device: ['cuda']
2025-01-05 20:47:09,667 [trainer.py] => seed: 2024
2025-01-05 20:47:09,667 [trainer.py] => dataset: cifar224
2025-01-05 20:47:09,667 [trainer.py] => init_cls: 1
2025-01-05 20:47:09,667 [trainer.py] => increment: 5
2025-01-05 20:47:09,667 [trainer.py] => kshot: 5
2025-01-05 20:47:09,667 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 20:47:09,667 [trainer.py] => z_dim: 1000
2025-01-05 20:47:09,667 [trainer.py] => conv_dim: 64
2025-01-05 20:47:09,667 [trainer.py] => img_size: 224
2025-01-05 20:47:09,667 [trainer.py] => generator_lr: 0.005
2025-01-05 20:47:09,667 [trainer.py] => pi: 100
2025-01-05 20:47:09,667 [trainer.py] => w_bn: 50.0
2025-01-05 20:47:09,667 [trainer.py] => w_noise: 0.001
2025-01-05 20:47:09,667 [trainer.py] => server_ss: 32
2025-01-05 20:47:09,667 [trainer.py] => bn_loss: 1
2025-01-05 20:47:09,667 [trainer.py] => noise: 1
2025-01-05 20:47:09,667 [trainer.py] => ie_loss: 1
2025-01-05 20:47:09,667 [trainer.py] => act_loss: 0
2025-01-05 20:47:09,667 [trainer.py] => w_ie: 1.0
2025-01-05 20:47:09,667 [trainer.py] => w_act: 0.1
2025-01-05 20:47:09,667 [trainer.py] => syn_size: 32
2025-01-05 20:47:09,668 [trainer.py] => need_syn_imgs: True
2025-01-05 20:47:09,668 [trainer.py] => g_local_bs: 5
2025-01-05 20:47:09,668 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 20:47:09,668 [trainer.py] => g_local_train_steps: 10
2025-01-05 20:47:09,668 [trainer.py] => dataset_syn: cifar100
2025-01-05 20:47:09,668 [trainer.py] => com_round_gen: 10
2025-01-05 20:47:09,668 [trainer.py] => g_sigma: 0
2025-01-05 20:47:09,668 [trainer.py] => save_cls_embeds: False
2025-01-05 20:47:09,668 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 20:47:09,668 [trainer.py] => save_dir: outputs
2025-01-05 20:47:09,668 [trainer.py] => n_iter: 5
2025-01-05 20:47:09,668 [trainer.py] => num_users: 1
2025-01-05 20:47:09,668 [trainer.py] => cur_size: 50
2025-01-05 20:47:09,668 [trainer.py] => local_bs: 128
2025-01-05 20:47:09,668 [trainer.py] => vpt_type: Deep
2025-01-05 20:47:09,668 [trainer.py] => prompt_token_num: 6
2025-01-05 20:47:09,668 [trainer.py] => avg_alpha: 0.8
2025-01-05 20:47:09,668 [trainer.py] => perturb_var: 1
2025-01-05 20:47:09,668 [trainer.py] => EMA_beta: 0.99
2025-01-05 20:47:09,668 [trainer.py] => anchor_lambda: 0.1
2025-01-05 20:47:09,668 [trainer.py] => kl_weight: 0.001
2025-01-05 20:47:09,668 [trainer.py] => TIP_init: zero
2025-01-05 20:47:09,668 [trainer.py] => tuned_epoch: 10
2025-01-05 20:47:09,669 [trainer.py] => fs_epoch: 0
2025-01-05 20:47:09,669 [trainer.py] => init_lr: 0.01
2025-01-05 20:47:09,669 [trainer.py] => fs_lr: 0.001
2025-01-05 20:47:09,669 [trainer.py] => batch_size: 48
2025-01-05 20:47:09,669 [trainer.py] => fs_batch_size: 16
2025-01-05 20:47:09,669 [trainer.py] => weight_decay: 0.0005
2025-01-05 20:47:09,669 [trainer.py] => min_lr: 0
2025-01-05 20:47:09,669 [trainer.py] => optimizer: sgd
2025-01-05 20:47:09,670 [trainer.py] => memory_size: 0
2025-01-05 20:47:09,670 [trainer.py] => memory_per_class: 0
2025-01-05 20:47:09,670 [trainer.py] => fixed_memory: False
2025-01-05 20:47:09,670 [trainer.py] => shuffle: False
2025-01-05 20:47:09,670 [trainer.py] => top_k: 5
2025-01-05 20:47:09,670 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 20:47:09,670 [trainer.py] => prefix: asp
2025-01-05 20:47:09,670 [trainer.py] => model_prefix: asp
2025-01-05 20:47:11,569 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 20:47:52,847 [trainer.py] => All params: 173596160
2025-01-05 20:47:52,849 [trainer.py] => Trainable params: 1998848
2025-01-05 20:47:52,850 [asp.py] => Learning on 0-1
2025-01-05 20:47:52,855 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 20:51:02,957 [asp.py] => total parameters: 173596929
2025-01-05 20:51:02,958 [asp.py] => trainable parameters: 1999617
2025-01-05 20:53:50,775 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 20:53:50,775 [trainer.py] => model_name: asp
2025-01-05 20:53:50,775 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 20:53:50,775 [trainer.py] => device: ['cuda']
2025-01-05 20:53:50,775 [trainer.py] => seed: 2024
2025-01-05 20:53:50,775 [trainer.py] => dataset: cifar224
2025-01-05 20:53:50,775 [trainer.py] => init_cls: 1
2025-01-05 20:53:50,775 [trainer.py] => increment: 5
2025-01-05 20:53:50,775 [trainer.py] => kshot: 5
2025-01-05 20:53:50,775 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 20:53:50,775 [trainer.py] => z_dim: 1000
2025-01-05 20:53:50,775 [trainer.py] => conv_dim: 64
2025-01-05 20:53:50,775 [trainer.py] => img_size: 224
2025-01-05 20:53:50,775 [trainer.py] => generator_lr: 0.005
2025-01-05 20:53:50,775 [trainer.py] => pi: 100
2025-01-05 20:53:50,775 [trainer.py] => w_bn: 50.0
2025-01-05 20:53:50,775 [trainer.py] => w_noise: 0.001
2025-01-05 20:53:50,775 [trainer.py] => server_ss: 32
2025-01-05 20:53:50,775 [trainer.py] => bn_loss: 1
2025-01-05 20:53:50,775 [trainer.py] => noise: 1
2025-01-05 20:53:50,776 [trainer.py] => ie_loss: 1
2025-01-05 20:53:50,776 [trainer.py] => act_loss: 0
2025-01-05 20:53:50,776 [trainer.py] => w_ie: 1.0
2025-01-05 20:53:50,776 [trainer.py] => w_act: 0.1
2025-01-05 20:53:50,776 [trainer.py] => syn_size: 32
2025-01-05 20:53:50,776 [trainer.py] => need_syn_imgs: True
2025-01-05 20:53:50,776 [trainer.py] => g_local_bs: 5
2025-01-05 20:53:50,776 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 20:53:50,776 [trainer.py] => g_local_train_steps: 10
2025-01-05 20:53:50,776 [trainer.py] => dataset_syn: cifar100
2025-01-05 20:53:50,776 [trainer.py] => com_round_gen: 10
2025-01-05 20:53:50,776 [trainer.py] => g_sigma: 0
2025-01-05 20:53:50,776 [trainer.py] => save_cls_embeds: False
2025-01-05 20:53:50,776 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 20:53:50,776 [trainer.py] => save_dir: outputs
2025-01-05 20:53:50,776 [trainer.py] => n_iter: 5
2025-01-05 20:53:50,776 [trainer.py] => num_users: 1
2025-01-05 20:53:50,776 [trainer.py] => cur_size: 50
2025-01-05 20:53:50,776 [trainer.py] => local_bs: 128
2025-01-05 20:53:50,776 [trainer.py] => vpt_type: Deep
2025-01-05 20:53:50,776 [trainer.py] => prompt_token_num: 6
2025-01-05 20:53:50,776 [trainer.py] => avg_alpha: 0.8
2025-01-05 20:53:50,776 [trainer.py] => perturb_var: 1
2025-01-05 20:53:50,776 [trainer.py] => EMA_beta: 0.99
2025-01-05 20:53:50,776 [trainer.py] => anchor_lambda: 0.1
2025-01-05 20:53:50,776 [trainer.py] => kl_weight: 0.001
2025-01-05 20:53:50,776 [trainer.py] => TIP_init: zero
2025-01-05 20:53:50,776 [trainer.py] => tuned_epoch: 10
2025-01-05 20:53:50,776 [trainer.py] => fs_epoch: 0
2025-01-05 20:53:50,776 [trainer.py] => init_lr: 0.01
2025-01-05 20:53:50,776 [trainer.py] => fs_lr: 0.001
2025-01-05 20:53:50,776 [trainer.py] => batch_size: 48
2025-01-05 20:53:50,776 [trainer.py] => fs_batch_size: 16
2025-01-05 20:53:50,776 [trainer.py] => weight_decay: 0.0005
2025-01-05 20:53:50,776 [trainer.py] => min_lr: 0
2025-01-05 20:53:50,776 [trainer.py] => optimizer: sgd
2025-01-05 20:53:50,777 [trainer.py] => memory_size: 0
2025-01-05 20:53:50,777 [trainer.py] => memory_per_class: 0
2025-01-05 20:53:50,777 [trainer.py] => fixed_memory: False
2025-01-05 20:53:50,777 [trainer.py] => shuffle: False
2025-01-05 20:53:50,777 [trainer.py] => top_k: 5
2025-01-05 20:53:50,777 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 20:53:50,777 [trainer.py] => prefix: asp
2025-01-05 20:53:50,777 [trainer.py] => model_prefix: asp
2025-01-05 20:53:52,636 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 20:54:40,917 [trainer.py] => All params: 173596160
2025-01-05 20:54:40,918 [trainer.py] => Trainable params: 1998848
2025-01-05 20:54:40,919 [asp.py] => Learning on 0-1
2025-01-05 20:54:40,923 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 20:57:49,577 [asp.py] => total parameters: 173596929
2025-01-05 20:57:49,578 [asp.py] => trainable parameters: 1999617
2025-01-05 21:04:40,229 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 21:04:40,229 [trainer.py] => model_name: asp
2025-01-05 21:04:40,229 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 21:04:40,229 [trainer.py] => device: ['cuda']
2025-01-05 21:04:40,229 [trainer.py] => seed: 2024
2025-01-05 21:04:40,229 [trainer.py] => dataset: cifar224
2025-01-05 21:04:40,229 [trainer.py] => init_cls: 1
2025-01-05 21:04:40,230 [trainer.py] => increment: 5
2025-01-05 21:04:40,230 [trainer.py] => kshot: 5
2025-01-05 21:04:40,230 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 21:04:40,230 [trainer.py] => z_dim: 1000
2025-01-05 21:04:40,230 [trainer.py] => conv_dim: 64
2025-01-05 21:04:40,230 [trainer.py] => img_size: 224
2025-01-05 21:04:40,230 [trainer.py] => generator_lr: 0.005
2025-01-05 21:04:40,230 [trainer.py] => pi: 100
2025-01-05 21:04:40,230 [trainer.py] => w_bn: 50.0
2025-01-05 21:04:40,230 [trainer.py] => w_noise: 0.001
2025-01-05 21:04:40,230 [trainer.py] => server_ss: 32
2025-01-05 21:04:40,230 [trainer.py] => bn_loss: 1
2025-01-05 21:04:40,230 [trainer.py] => noise: 1
2025-01-05 21:04:40,230 [trainer.py] => ie_loss: 1
2025-01-05 21:04:40,230 [trainer.py] => act_loss: 0
2025-01-05 21:04:40,230 [trainer.py] => w_ie: 1.0
2025-01-05 21:04:40,230 [trainer.py] => w_act: 0.1
2025-01-05 21:04:40,230 [trainer.py] => syn_size: 32
2025-01-05 21:04:40,230 [trainer.py] => need_syn_imgs: True
2025-01-05 21:04:40,230 [trainer.py] => g_local_bs: 5
2025-01-05 21:04:40,230 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 21:04:40,230 [trainer.py] => g_local_train_steps: 10
2025-01-05 21:04:40,230 [trainer.py] => dataset_syn: cifar100
2025-01-05 21:04:40,230 [trainer.py] => com_round_gen: 10
2025-01-05 21:04:40,230 [trainer.py] => g_sigma: 0
2025-01-05 21:04:40,230 [trainer.py] => save_cls_embeds: False
2025-01-05 21:04:40,230 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 21:04:40,230 [trainer.py] => save_dir: outputs
2025-01-05 21:04:40,230 [trainer.py] => n_iter: 5
2025-01-05 21:04:40,230 [trainer.py] => num_users: 1
2025-01-05 21:04:40,230 [trainer.py] => cur_size: 50
2025-01-05 21:04:40,230 [trainer.py] => local_bs: 128
2025-01-05 21:04:40,230 [trainer.py] => vpt_type: Deep
2025-01-05 21:04:40,230 [trainer.py] => prompt_token_num: 6
2025-01-05 21:04:40,230 [trainer.py] => avg_alpha: 0.8
2025-01-05 21:04:40,231 [trainer.py] => perturb_var: 1
2025-01-05 21:04:40,231 [trainer.py] => EMA_beta: 0.99
2025-01-05 21:04:40,231 [trainer.py] => anchor_lambda: 0.1
2025-01-05 21:04:40,231 [trainer.py] => kl_weight: 0.001
2025-01-05 21:04:40,231 [trainer.py] => TIP_init: zero
2025-01-05 21:04:40,231 [trainer.py] => tuned_epoch: 10
2025-01-05 21:04:40,231 [trainer.py] => fs_epoch: 0
2025-01-05 21:04:40,231 [trainer.py] => init_lr: 0.01
2025-01-05 21:04:40,231 [trainer.py] => fs_lr: 0.001
2025-01-05 21:04:40,231 [trainer.py] => batch_size: 48
2025-01-05 21:04:40,231 [trainer.py] => fs_batch_size: 16
2025-01-05 21:04:40,231 [trainer.py] => weight_decay: 0.0005
2025-01-05 21:04:40,231 [trainer.py] => min_lr: 0
2025-01-05 21:04:40,231 [trainer.py] => optimizer: sgd
2025-01-05 21:04:40,231 [trainer.py] => memory_size: 0
2025-01-05 21:04:40,231 [trainer.py] => memory_per_class: 0
2025-01-05 21:04:40,231 [trainer.py] => fixed_memory: False
2025-01-05 21:04:40,231 [trainer.py] => shuffle: False
2025-01-05 21:04:40,231 [trainer.py] => top_k: 5
2025-01-05 21:04:40,231 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 21:04:40,231 [trainer.py] => prefix: asp
2025-01-05 21:04:40,231 [trainer.py] => model_prefix: asp
2025-01-05 21:04:42,086 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 21:05:17,669 [trainer.py] => All params: 173596160
2025-01-05 21:05:17,671 [trainer.py] => Trainable params: 1998848
2025-01-05 21:05:17,673 [asp.py] => Learning on 0-1
2025-01-05 21:05:17,682 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 21:08:26,726 [asp.py] => total parameters: 173596929
2025-01-05 21:08:26,727 [asp.py] => trainable parameters: 1999617
2025-01-05 21:11:34,247 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 21:11:34,247 [trainer.py] => model_name: asp
2025-01-05 21:11:34,247 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 21:11:34,247 [trainer.py] => device: ['cuda']
2025-01-05 21:11:34,247 [trainer.py] => seed: 2024
2025-01-05 21:11:34,247 [trainer.py] => dataset: cifar224
2025-01-05 21:11:34,247 [trainer.py] => init_cls: 1
2025-01-05 21:11:34,247 [trainer.py] => increment: 5
2025-01-05 21:11:34,247 [trainer.py] => kshot: 5
2025-01-05 21:11:34,247 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 21:11:34,247 [trainer.py] => z_dim: 1000
2025-01-05 21:11:34,247 [trainer.py] => conv_dim: 64
2025-01-05 21:11:34,247 [trainer.py] => img_size: 224
2025-01-05 21:11:34,247 [trainer.py] => generator_lr: 0.005
2025-01-05 21:11:34,247 [trainer.py] => pi: 100
2025-01-05 21:11:34,247 [trainer.py] => w_bn: 50.0
2025-01-05 21:11:34,247 [trainer.py] => w_noise: 0.001
2025-01-05 21:11:34,247 [trainer.py] => server_ss: 32
2025-01-05 21:11:34,247 [trainer.py] => bn_loss: 1
2025-01-05 21:11:34,247 [trainer.py] => noise: 1
2025-01-05 21:11:34,247 [trainer.py] => ie_loss: 1
2025-01-05 21:11:34,248 [trainer.py] => act_loss: 0
2025-01-05 21:11:34,248 [trainer.py] => w_ie: 1.0
2025-01-05 21:11:34,248 [trainer.py] => w_act: 0.1
2025-01-05 21:11:34,248 [trainer.py] => syn_size: 32
2025-01-05 21:11:34,248 [trainer.py] => need_syn_imgs: True
2025-01-05 21:11:34,248 [trainer.py] => g_local_bs: 5
2025-01-05 21:11:34,248 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 21:11:34,248 [trainer.py] => g_local_train_steps: 10
2025-01-05 21:11:34,248 [trainer.py] => dataset_syn: cifar100
2025-01-05 21:11:34,248 [trainer.py] => com_round_gen: 10
2025-01-05 21:11:34,248 [trainer.py] => g_sigma: 0
2025-01-05 21:11:34,248 [trainer.py] => save_cls_embeds: False
2025-01-05 21:11:34,248 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 21:11:34,248 [trainer.py] => save_dir: outputs
2025-01-05 21:11:34,248 [trainer.py] => n_iter: 5
2025-01-05 21:11:34,248 [trainer.py] => num_users: 1
2025-01-05 21:11:34,248 [trainer.py] => cur_size: 50
2025-01-05 21:11:34,248 [trainer.py] => local_bs: 128
2025-01-05 21:11:34,248 [trainer.py] => vpt_type: Deep
2025-01-05 21:11:34,248 [trainer.py] => prompt_token_num: 6
2025-01-05 21:11:34,248 [trainer.py] => avg_alpha: 0.8
2025-01-05 21:11:34,248 [trainer.py] => perturb_var: 1
2025-01-05 21:11:34,249 [trainer.py] => EMA_beta: 0.99
2025-01-05 21:11:34,249 [trainer.py] => anchor_lambda: 0.1
2025-01-05 21:11:34,249 [trainer.py] => kl_weight: 0.001
2025-01-05 21:11:34,249 [trainer.py] => TIP_init: zero
2025-01-05 21:11:34,249 [trainer.py] => tuned_epoch: 10
2025-01-05 21:11:34,249 [trainer.py] => fs_epoch: 0
2025-01-05 21:11:34,249 [trainer.py] => init_lr: 0.01
2025-01-05 21:11:34,249 [trainer.py] => fs_lr: 0.001
2025-01-05 21:11:34,249 [trainer.py] => batch_size: 48
2025-01-05 21:11:34,249 [trainer.py] => fs_batch_size: 16
2025-01-05 21:11:34,250 [trainer.py] => weight_decay: 0.0005
2025-01-05 21:11:34,250 [trainer.py] => min_lr: 0
2025-01-05 21:11:34,250 [trainer.py] => optimizer: sgd
2025-01-05 21:11:34,250 [trainer.py] => memory_size: 0
2025-01-05 21:11:34,250 [trainer.py] => memory_per_class: 0
2025-01-05 21:11:34,250 [trainer.py] => fixed_memory: False
2025-01-05 21:11:34,250 [trainer.py] => shuffle: False
2025-01-05 21:11:34,251 [trainer.py] => top_k: 5
2025-01-05 21:11:34,251 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 21:11:34,251 [trainer.py] => prefix: asp
2025-01-05 21:11:34,251 [trainer.py] => model_prefix: asp
2025-01-05 21:11:36,178 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 21:12:14,795 [trainer.py] => All params: 173596160
2025-01-05 21:12:14,797 [trainer.py] => Trainable params: 1998848
2025-01-05 21:12:14,798 [asp.py] => Learning on 0-1
2025-01-05 21:12:14,800 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 21:15:22,446 [asp.py] => total parameters: 173596929
2025-01-05 21:15:22,447 [asp.py] => trainable parameters: 1999617
2025-01-05 21:16:30,282 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 21:16:30,282 [trainer.py] => model_name: asp
2025-01-05 21:16:30,282 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 21:16:30,282 [trainer.py] => device: ['cuda']
2025-01-05 21:16:30,282 [trainer.py] => seed: 2024
2025-01-05 21:16:30,282 [trainer.py] => dataset: cifar224
2025-01-05 21:16:30,282 [trainer.py] => init_cls: 1
2025-01-05 21:16:30,282 [trainer.py] => increment: 5
2025-01-05 21:16:30,282 [trainer.py] => kshot: 5
2025-01-05 21:16:30,282 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 21:16:30,282 [trainer.py] => z_dim: 1000
2025-01-05 21:16:30,282 [trainer.py] => conv_dim: 64
2025-01-05 21:16:30,282 [trainer.py] => img_size: 224
2025-01-05 21:16:30,282 [trainer.py] => generator_lr: 0.005
2025-01-05 21:16:30,282 [trainer.py] => pi: 100
2025-01-05 21:16:30,282 [trainer.py] => w_bn: 50.0
2025-01-05 21:16:30,282 [trainer.py] => w_noise: 0.001
2025-01-05 21:16:30,282 [trainer.py] => server_ss: 32
2025-01-05 21:16:30,282 [trainer.py] => bn_loss: 1
2025-01-05 21:16:30,282 [trainer.py] => noise: 1
2025-01-05 21:16:30,283 [trainer.py] => ie_loss: 1
2025-01-05 21:16:30,283 [trainer.py] => act_loss: 0
2025-01-05 21:16:30,283 [trainer.py] => w_ie: 1.0
2025-01-05 21:16:30,283 [trainer.py] => w_act: 0.1
2025-01-05 21:16:30,283 [trainer.py] => syn_size: 32
2025-01-05 21:16:30,283 [trainer.py] => need_syn_imgs: True
2025-01-05 21:16:30,283 [trainer.py] => g_local_bs: 5
2025-01-05 21:16:30,283 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 21:16:30,283 [trainer.py] => g_local_train_steps: 10
2025-01-05 21:16:30,283 [trainer.py] => dataset_syn: cifar100
2025-01-05 21:16:30,283 [trainer.py] => com_round_gen: 10
2025-01-05 21:16:30,283 [trainer.py] => g_sigma: 0
2025-01-05 21:16:30,283 [trainer.py] => save_cls_embeds: False
2025-01-05 21:16:30,283 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 21:16:30,283 [trainer.py] => save_dir: outputs
2025-01-05 21:16:30,283 [trainer.py] => n_iter: 5
2025-01-05 21:16:30,283 [trainer.py] => num_users: 1
2025-01-05 21:16:30,283 [trainer.py] => cur_size: 50
2025-01-05 21:16:30,283 [trainer.py] => local_bs: 128
2025-01-05 21:16:30,283 [trainer.py] => vpt_type: Deep
2025-01-05 21:16:30,283 [trainer.py] => prompt_token_num: 6
2025-01-05 21:16:30,283 [trainer.py] => avg_alpha: 0.8
2025-01-05 21:16:30,283 [trainer.py] => perturb_var: 1
2025-01-05 21:16:30,283 [trainer.py] => EMA_beta: 0.99
2025-01-05 21:16:30,283 [trainer.py] => anchor_lambda: 0.1
2025-01-05 21:16:30,283 [trainer.py] => kl_weight: 0.001
2025-01-05 21:16:30,283 [trainer.py] => TIP_init: zero
2025-01-05 21:16:30,283 [trainer.py] => tuned_epoch: 10
2025-01-05 21:16:30,283 [trainer.py] => fs_epoch: 0
2025-01-05 21:16:30,283 [trainer.py] => init_lr: 0.01
2025-01-05 21:16:30,283 [trainer.py] => fs_lr: 0.001
2025-01-05 21:16:30,283 [trainer.py] => batch_size: 48
2025-01-05 21:16:30,283 [trainer.py] => fs_batch_size: 16
2025-01-05 21:16:30,283 [trainer.py] => weight_decay: 0.0005
2025-01-05 21:16:30,283 [trainer.py] => min_lr: 0
2025-01-05 21:16:30,283 [trainer.py] => optimizer: sgd
2025-01-05 21:16:30,284 [trainer.py] => memory_size: 0
2025-01-05 21:16:30,284 [trainer.py] => memory_per_class: 0
2025-01-05 21:16:30,284 [trainer.py] => fixed_memory: False
2025-01-05 21:16:30,284 [trainer.py] => shuffle: False
2025-01-05 21:16:30,284 [trainer.py] => top_k: 5
2025-01-05 21:16:30,284 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 21:16:30,284 [trainer.py] => prefix: asp
2025-01-05 21:16:30,284 [trainer.py] => model_prefix: asp
2025-01-05 21:16:32,086 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 21:17:10,634 [trainer.py] => All params: 173596160
2025-01-05 21:17:10,640 [trainer.py] => Trainable params: 1998848
2025-01-05 21:17:10,641 [asp.py] => Learning on 0-1
2025-01-05 21:17:10,646 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 21:20:21,442 [asp.py] => total parameters: 173596929
2025-01-05 21:20:21,443 [asp.py] => trainable parameters: 1999617
2025-01-05 21:21:39,773 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 21:21:39,773 [trainer.py] => model_name: asp
2025-01-05 21:21:39,773 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 21:21:39,773 [trainer.py] => device: ['cuda']
2025-01-05 21:21:39,773 [trainer.py] => seed: 2024
2025-01-05 21:21:39,773 [trainer.py] => dataset: cifar224
2025-01-05 21:21:39,773 [trainer.py] => init_cls: 1
2025-01-05 21:21:39,773 [trainer.py] => increment: 5
2025-01-05 21:21:39,774 [trainer.py] => kshot: 5
2025-01-05 21:21:39,774 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 21:21:39,774 [trainer.py] => z_dim: 1000
2025-01-05 21:21:39,774 [trainer.py] => conv_dim: 64
2025-01-05 21:21:39,774 [trainer.py] => img_size: 224
2025-01-05 21:21:39,774 [trainer.py] => generator_lr: 0.005
2025-01-05 21:21:39,774 [trainer.py] => pi: 100
2025-01-05 21:21:39,774 [trainer.py] => w_bn: 50.0
2025-01-05 21:21:39,774 [trainer.py] => w_noise: 0.001
2025-01-05 21:21:39,774 [trainer.py] => server_ss: 32
2025-01-05 21:21:39,774 [trainer.py] => bn_loss: 1
2025-01-05 21:21:39,774 [trainer.py] => noise: 1
2025-01-05 21:21:39,774 [trainer.py] => ie_loss: 1
2025-01-05 21:21:39,774 [trainer.py] => act_loss: 0
2025-01-05 21:21:39,774 [trainer.py] => w_ie: 1.0
2025-01-05 21:21:39,774 [trainer.py] => w_act: 0.1
2025-01-05 21:21:39,774 [trainer.py] => syn_size: 32
2025-01-05 21:21:39,774 [trainer.py] => need_syn_imgs: True
2025-01-05 21:21:39,774 [trainer.py] => g_local_bs: 5
2025-01-05 21:21:39,774 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 21:21:39,774 [trainer.py] => g_local_train_steps: 10
2025-01-05 21:21:39,774 [trainer.py] => dataset_syn: cifar100
2025-01-05 21:21:39,774 [trainer.py] => com_round_gen: 10
2025-01-05 21:21:39,774 [trainer.py] => g_sigma: 0
2025-01-05 21:21:39,774 [trainer.py] => save_cls_embeds: False
2025-01-05 21:21:39,774 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 21:21:39,774 [trainer.py] => save_dir: outputs
2025-01-05 21:21:39,774 [trainer.py] => n_iter: 5
2025-01-05 21:21:39,774 [trainer.py] => num_users: 1
2025-01-05 21:21:39,775 [trainer.py] => cur_size: 50
2025-01-05 21:21:39,775 [trainer.py] => local_bs: 128
2025-01-05 21:21:39,775 [trainer.py] => vpt_type: Deep
2025-01-05 21:21:39,775 [trainer.py] => prompt_token_num: 6
2025-01-05 21:21:39,775 [trainer.py] => avg_alpha: 0.8
2025-01-05 21:21:39,775 [trainer.py] => perturb_var: 1
2025-01-05 21:21:39,775 [trainer.py] => EMA_beta: 0.99
2025-01-05 21:21:39,775 [trainer.py] => anchor_lambda: 0.1
2025-01-05 21:21:39,775 [trainer.py] => kl_weight: 0.001
2025-01-05 21:21:39,775 [trainer.py] => TIP_init: zero
2025-01-05 21:21:39,775 [trainer.py] => tuned_epoch: 10
2025-01-05 21:21:39,775 [trainer.py] => fs_epoch: 0
2025-01-05 21:21:39,775 [trainer.py] => init_lr: 0.01
2025-01-05 21:21:39,775 [trainer.py] => fs_lr: 0.001
2025-01-05 21:21:39,775 [trainer.py] => batch_size: 48
2025-01-05 21:21:39,775 [trainer.py] => fs_batch_size: 16
2025-01-05 21:21:39,775 [trainer.py] => weight_decay: 0.0005
2025-01-05 21:21:39,775 [trainer.py] => min_lr: 0
2025-01-05 21:21:39,775 [trainer.py] => optimizer: sgd
2025-01-05 21:21:39,775 [trainer.py] => memory_size: 0
2025-01-05 21:21:39,775 [trainer.py] => memory_per_class: 0
2025-01-05 21:21:39,775 [trainer.py] => fixed_memory: False
2025-01-05 21:21:39,775 [trainer.py] => shuffle: False
2025-01-05 21:21:39,775 [trainer.py] => top_k: 5
2025-01-05 21:21:39,775 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 21:21:39,775 [trainer.py] => prefix: asp
2025-01-05 21:21:39,775 [trainer.py] => model_prefix: asp
2025-01-05 21:21:41,525 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 21:22:18,224 [trainer.py] => All params: 173596160
2025-01-05 21:22:18,225 [trainer.py] => Trainable params: 1998848
2025-01-05 21:22:18,226 [asp.py] => Learning on 0-1
2025-01-05 21:22:18,229 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 21:25:28,846 [asp.py] => total parameters: 173596929
2025-01-05 21:25:28,847 [asp.py] => trainable parameters: 1999617
2025-01-05 21:26:38,337 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 21:26:38,337 [trainer.py] => model_name: asp
2025-01-05 21:26:38,337 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 21:26:38,337 [trainer.py] => device: ['cuda']
2025-01-05 21:26:38,337 [trainer.py] => seed: 2024
2025-01-05 21:26:38,337 [trainer.py] => dataset: cifar224
2025-01-05 21:26:38,337 [trainer.py] => init_cls: 1
2025-01-05 21:26:38,338 [trainer.py] => increment: 5
2025-01-05 21:26:38,338 [trainer.py] => kshot: 5
2025-01-05 21:26:38,338 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 21:26:38,338 [trainer.py] => z_dim: 1000
2025-01-05 21:26:38,338 [trainer.py] => conv_dim: 64
2025-01-05 21:26:38,338 [trainer.py] => img_size: 224
2025-01-05 21:26:38,338 [trainer.py] => generator_lr: 0.005
2025-01-05 21:26:38,338 [trainer.py] => pi: 100
2025-01-05 21:26:38,338 [trainer.py] => w_bn: 50.0
2025-01-05 21:26:38,338 [trainer.py] => w_noise: 0.001
2025-01-05 21:26:38,338 [trainer.py] => server_ss: 32
2025-01-05 21:26:38,338 [trainer.py] => bn_loss: 1
2025-01-05 21:26:38,338 [trainer.py] => noise: 1
2025-01-05 21:26:38,338 [trainer.py] => ie_loss: 1
2025-01-05 21:26:38,338 [trainer.py] => act_loss: 0
2025-01-05 21:26:38,338 [trainer.py] => w_ie: 1.0
2025-01-05 21:26:38,338 [trainer.py] => w_act: 0.1
2025-01-05 21:26:38,338 [trainer.py] => syn_size: 32
2025-01-05 21:26:38,338 [trainer.py] => need_syn_imgs: True
2025-01-05 21:26:38,338 [trainer.py] => g_local_bs: 5
2025-01-05 21:26:38,338 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 21:26:38,338 [trainer.py] => g_local_train_steps: 10
2025-01-05 21:26:38,338 [trainer.py] => dataset_syn: cifar100
2025-01-05 21:26:38,338 [trainer.py] => com_round_gen: 10
2025-01-05 21:26:38,338 [trainer.py] => g_sigma: 0
2025-01-05 21:26:38,338 [trainer.py] => save_cls_embeds: False
2025-01-05 21:26:38,338 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 21:26:38,338 [trainer.py] => save_dir: outputs
2025-01-05 21:26:38,338 [trainer.py] => n_iter: 5
2025-01-05 21:26:38,338 [trainer.py] => num_users: 1
2025-01-05 21:26:38,338 [trainer.py] => cur_size: 50
2025-01-05 21:26:38,338 [trainer.py] => local_bs: 128
2025-01-05 21:26:38,338 [trainer.py] => vpt_type: Deep
2025-01-05 21:26:38,338 [trainer.py] => prompt_token_num: 6
2025-01-05 21:26:38,338 [trainer.py] => avg_alpha: 0.8
2025-01-05 21:26:38,339 [trainer.py] => perturb_var: 1
2025-01-05 21:26:38,339 [trainer.py] => EMA_beta: 0.99
2025-01-05 21:26:38,339 [trainer.py] => anchor_lambda: 0.1
2025-01-05 21:26:38,339 [trainer.py] => kl_weight: 0.001
2025-01-05 21:26:38,339 [trainer.py] => TIP_init: zero
2025-01-05 21:26:38,339 [trainer.py] => tuned_epoch: 10
2025-01-05 21:26:38,339 [trainer.py] => fs_epoch: 0
2025-01-05 21:26:38,339 [trainer.py] => init_lr: 0.01
2025-01-05 21:26:38,339 [trainer.py] => fs_lr: 0.001
2025-01-05 21:26:38,339 [trainer.py] => batch_size: 48
2025-01-05 21:26:38,339 [trainer.py] => fs_batch_size: 16
2025-01-05 21:26:38,339 [trainer.py] => weight_decay: 0.0005
2025-01-05 21:26:38,339 [trainer.py] => min_lr: 0
2025-01-05 21:26:38,339 [trainer.py] => optimizer: sgd
2025-01-05 21:26:38,339 [trainer.py] => memory_size: 0
2025-01-05 21:26:38,339 [trainer.py] => memory_per_class: 0
2025-01-05 21:26:38,339 [trainer.py] => fixed_memory: False
2025-01-05 21:26:38,339 [trainer.py] => shuffle: False
2025-01-05 21:26:38,339 [trainer.py] => top_k: 5
2025-01-05 21:26:38,339 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 21:26:38,339 [trainer.py] => prefix: asp
2025-01-05 21:26:38,339 [trainer.py] => model_prefix: asp
2025-01-05 21:26:40,687 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 21:28:10,310 [trainer.py] => All params: 173596160
2025-01-05 21:28:10,311 [trainer.py] => Trainable params: 1998848
2025-01-05 21:28:10,312 [asp.py] => Learning on 0-1
2025-01-05 21:28:10,314 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 21:31:20,583 [asp.py] => total parameters: 173596929
2025-01-05 21:31:20,584 [asp.py] => trainable parameters: 1999617
2025-01-05 21:33:26,066 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 21:33:26,066 [trainer.py] => model_name: asp
2025-01-05 21:33:26,066 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 21:33:26,066 [trainer.py] => device: ['cuda']
2025-01-05 21:33:26,066 [trainer.py] => seed: 2024
2025-01-05 21:33:26,066 [trainer.py] => dataset: cifar224
2025-01-05 21:33:26,066 [trainer.py] => init_cls: 1
2025-01-05 21:33:26,066 [trainer.py] => increment: 5
2025-01-05 21:33:26,067 [trainer.py] => kshot: 5
2025-01-05 21:33:26,067 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 21:33:26,067 [trainer.py] => z_dim: 1000
2025-01-05 21:33:26,067 [trainer.py] => conv_dim: 64
2025-01-05 21:33:26,067 [trainer.py] => img_size: 224
2025-01-05 21:33:26,067 [trainer.py] => generator_lr: 0.005
2025-01-05 21:33:26,067 [trainer.py] => pi: 100
2025-01-05 21:33:26,067 [trainer.py] => w_bn: 50.0
2025-01-05 21:33:26,067 [trainer.py] => w_noise: 0.001
2025-01-05 21:33:26,067 [trainer.py] => server_ss: 32
2025-01-05 21:33:26,067 [trainer.py] => bn_loss: 1
2025-01-05 21:33:26,067 [trainer.py] => noise: 1
2025-01-05 21:33:26,067 [trainer.py] => ie_loss: 1
2025-01-05 21:33:26,067 [trainer.py] => act_loss: 0
2025-01-05 21:33:26,067 [trainer.py] => w_ie: 1.0
2025-01-05 21:33:26,067 [trainer.py] => w_act: 0.1
2025-01-05 21:33:26,067 [trainer.py] => syn_size: 32
2025-01-05 21:33:26,067 [trainer.py] => need_syn_imgs: True
2025-01-05 21:33:26,067 [trainer.py] => g_local_bs: 5
2025-01-05 21:33:26,067 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 21:33:26,067 [trainer.py] => g_local_train_steps: 10
2025-01-05 21:33:26,067 [trainer.py] => dataset_syn: cifar100
2025-01-05 21:33:26,067 [trainer.py] => com_round_gen: 10
2025-01-05 21:33:26,067 [trainer.py] => g_sigma: 0
2025-01-05 21:33:26,067 [trainer.py] => save_cls_embeds: False
2025-01-05 21:33:26,067 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 21:33:26,067 [trainer.py] => save_dir: outputs
2025-01-05 21:33:26,067 [trainer.py] => n_iter: 5
2025-01-05 21:33:26,067 [trainer.py] => num_users: 1
2025-01-05 21:33:26,067 [trainer.py] => cur_size: 50
2025-01-05 21:33:26,067 [trainer.py] => local_bs: 12
2025-01-05 21:33:26,067 [trainer.py] => vpt_type: Deep
2025-01-05 21:33:26,067 [trainer.py] => prompt_token_num: 6
2025-01-05 21:33:26,067 [trainer.py] => avg_alpha: 0.8
2025-01-05 21:33:26,068 [trainer.py] => perturb_var: 1
2025-01-05 21:33:26,068 [trainer.py] => EMA_beta: 0.99
2025-01-05 21:33:26,068 [trainer.py] => anchor_lambda: 0.1
2025-01-05 21:33:26,068 [trainer.py] => kl_weight: 0.001
2025-01-05 21:33:26,068 [trainer.py] => TIP_init: zero
2025-01-05 21:33:26,068 [trainer.py] => tuned_epoch: 10
2025-01-05 21:33:26,068 [trainer.py] => fs_epoch: 0
2025-01-05 21:33:26,068 [trainer.py] => init_lr: 0.01
2025-01-05 21:33:26,068 [trainer.py] => fs_lr: 0.001
2025-01-05 21:33:26,068 [trainer.py] => batch_size: 48
2025-01-05 21:33:26,068 [trainer.py] => fs_batch_size: 16
2025-01-05 21:33:26,068 [trainer.py] => weight_decay: 0.0005
2025-01-05 21:33:26,068 [trainer.py] => min_lr: 0
2025-01-05 21:33:26,068 [trainer.py] => optimizer: sgd
2025-01-05 21:33:26,068 [trainer.py] => memory_size: 0
2025-01-05 21:33:26,068 [trainer.py] => memory_per_class: 0
2025-01-05 21:33:26,068 [trainer.py] => fixed_memory: False
2025-01-05 21:33:26,068 [trainer.py] => shuffle: False
2025-01-05 21:33:26,068 [trainer.py] => top_k: 5
2025-01-05 21:33:26,068 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 21:33:26,068 [trainer.py] => prefix: asp
2025-01-05 21:33:26,068 [trainer.py] => model_prefix: asp
2025-01-05 21:33:27,793 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 21:34:00,695 [trainer.py] => All params: 173596160
2025-01-05 21:34:00,696 [trainer.py] => Trainable params: 1998848
2025-01-05 21:34:00,697 [asp.py] => Learning on 0-1
2025-01-05 21:34:00,701 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 21:37:13,025 [asp.py] => total parameters: 173596929
2025-01-05 21:37:13,026 [asp.py] => trainable parameters: 1999617
2025-01-05 21:51:04,249 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 21:51:04,249 [trainer.py] => model_name: asp
2025-01-05 21:51:04,249 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 21:51:04,249 [trainer.py] => device: ['cuda']
2025-01-05 21:51:04,249 [trainer.py] => seed: 2024
2025-01-05 21:51:04,249 [trainer.py] => dataset: cifar224
2025-01-05 21:51:04,249 [trainer.py] => init_cls: 1
2025-01-05 21:51:04,249 [trainer.py] => increment: 5
2025-01-05 21:51:04,249 [trainer.py] => kshot: 5
2025-01-05 21:51:04,249 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 21:51:04,249 [trainer.py] => z_dim: 1000
2025-01-05 21:51:04,249 [trainer.py] => conv_dim: 64
2025-01-05 21:51:04,249 [trainer.py] => img_size: 224
2025-01-05 21:51:04,249 [trainer.py] => generator_lr: 0.005
2025-01-05 21:51:04,249 [trainer.py] => pi: 100
2025-01-05 21:51:04,249 [trainer.py] => w_bn: 50.0
2025-01-05 21:51:04,249 [trainer.py] => w_noise: 0.001
2025-01-05 21:51:04,250 [trainer.py] => server_ss: 32
2025-01-05 21:51:04,250 [trainer.py] => bn_loss: 1
2025-01-05 21:51:04,250 [trainer.py] => noise: 1
2025-01-05 21:51:04,250 [trainer.py] => ie_loss: 1
2025-01-05 21:51:04,250 [trainer.py] => act_loss: 0
2025-01-05 21:51:04,250 [trainer.py] => w_ie: 1.0
2025-01-05 21:51:04,250 [trainer.py] => w_act: 0.1
2025-01-05 21:51:04,250 [trainer.py] => syn_size: 32
2025-01-05 21:51:04,250 [trainer.py] => need_syn_imgs: True
2025-01-05 21:51:04,250 [trainer.py] => g_local_bs: 5
2025-01-05 21:51:04,250 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 21:51:04,250 [trainer.py] => g_local_train_steps: 10
2025-01-05 21:51:04,250 [trainer.py] => dataset_syn: cifar100
2025-01-05 21:51:04,250 [trainer.py] => com_round_gen: 10
2025-01-05 21:51:04,250 [trainer.py] => g_sigma: 0
2025-01-05 21:51:04,250 [trainer.py] => save_cls_embeds: False
2025-01-05 21:51:04,250 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 21:51:04,250 [trainer.py] => save_dir: outputs
2025-01-05 21:51:04,250 [trainer.py] => n_iter: 5
2025-01-05 21:51:04,250 [trainer.py] => num_users: 1
2025-01-05 21:51:04,250 [trainer.py] => cur_size: 50
2025-01-05 21:51:04,250 [trainer.py] => local_bs: 12
2025-01-05 21:51:04,250 [trainer.py] => vpt_type: Deep
2025-01-05 21:51:04,250 [trainer.py] => prompt_token_num: 6
2025-01-05 21:51:04,250 [trainer.py] => avg_alpha: 0.8
2025-01-05 21:51:04,250 [trainer.py] => perturb_var: 1
2025-01-05 21:51:04,250 [trainer.py] => EMA_beta: 0.99
2025-01-05 21:51:04,250 [trainer.py] => anchor_lambda: 0.1
2025-01-05 21:51:04,250 [trainer.py] => kl_weight: 0.001
2025-01-05 21:51:04,250 [trainer.py] => TIP_init: zero
2025-01-05 21:51:04,250 [trainer.py] => tuned_epoch: 10
2025-01-05 21:51:04,250 [trainer.py] => fs_epoch: 0
2025-01-05 21:51:04,250 [trainer.py] => init_lr: 0.01
2025-01-05 21:51:04,250 [trainer.py] => fs_lr: 0.001
2025-01-05 21:51:04,250 [trainer.py] => batch_size: 48
2025-01-05 21:51:04,250 [trainer.py] => fs_batch_size: 16
2025-01-05 21:51:04,251 [trainer.py] => weight_decay: 0.0005
2025-01-05 21:51:04,251 [trainer.py] => min_lr: 0
2025-01-05 21:51:04,251 [trainer.py] => optimizer: sgd
2025-01-05 21:51:04,251 [trainer.py] => memory_size: 0
2025-01-05 21:51:04,251 [trainer.py] => memory_per_class: 0
2025-01-05 21:51:04,251 [trainer.py] => fixed_memory: False
2025-01-05 21:51:04,251 [trainer.py] => shuffle: False
2025-01-05 21:51:04,251 [trainer.py] => top_k: 5
2025-01-05 21:51:04,251 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 21:51:04,251 [trainer.py] => prefix: asp
2025-01-05 21:51:04,251 [trainer.py] => model_prefix: asp
2025-01-05 21:51:07,932 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 21:53:08,496 [trainer.py] => All params: 173596160
2025-01-05 21:53:08,497 [trainer.py] => Trainable params: 1998848
2025-01-05 21:53:08,498 [asp.py] => Learning on 0-1
2025-01-05 21:53:08,500 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 21:56:17,714 [asp.py] => total parameters: 173596929
2025-01-05 21:56:17,715 [asp.py] => trainable parameters: 1999617
2025-01-05 21:59:18,968 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 21:59:18,968 [trainer.py] => model_name: asp
2025-01-05 21:59:18,968 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 21:59:18,968 [trainer.py] => device: ['cuda']
2025-01-05 21:59:18,968 [trainer.py] => seed: 2024
2025-01-05 21:59:18,968 [trainer.py] => dataset: cifar224
2025-01-05 21:59:18,968 [trainer.py] => init_cls: 1
2025-01-05 21:59:18,968 [trainer.py] => increment: 5
2025-01-05 21:59:18,968 [trainer.py] => kshot: 5
2025-01-05 21:59:18,968 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 21:59:18,968 [trainer.py] => z_dim: 1000
2025-01-05 21:59:18,968 [trainer.py] => conv_dim: 64
2025-01-05 21:59:18,968 [trainer.py] => img_size: 224
2025-01-05 21:59:18,968 [trainer.py] => generator_lr: 0.005
2025-01-05 21:59:18,968 [trainer.py] => pi: 100
2025-01-05 21:59:18,968 [trainer.py] => w_bn: 50.0
2025-01-05 21:59:18,968 [trainer.py] => w_noise: 0.001
2025-01-05 21:59:18,968 [trainer.py] => server_ss: 32
2025-01-05 21:59:18,968 [trainer.py] => bn_loss: 1
2025-01-05 21:59:18,968 [trainer.py] => noise: 1
2025-01-05 21:59:18,968 [trainer.py] => ie_loss: 1
2025-01-05 21:59:18,968 [trainer.py] => act_loss: 0
2025-01-05 21:59:18,968 [trainer.py] => w_ie: 1.0
2025-01-05 21:59:18,969 [trainer.py] => w_act: 0.1
2025-01-05 21:59:18,969 [trainer.py] => syn_size: 32
2025-01-05 21:59:18,969 [trainer.py] => need_syn_imgs: True
2025-01-05 21:59:18,969 [trainer.py] => g_local_bs: 5
2025-01-05 21:59:18,969 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 21:59:18,969 [trainer.py] => g_local_train_steps: 10
2025-01-05 21:59:18,969 [trainer.py] => dataset_syn: cifar100
2025-01-05 21:59:18,969 [trainer.py] => com_round_gen: 10
2025-01-05 21:59:18,969 [trainer.py] => g_sigma: 0
2025-01-05 21:59:18,969 [trainer.py] => save_cls_embeds: False
2025-01-05 21:59:18,969 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 21:59:18,969 [trainer.py] => save_dir: outputs
2025-01-05 21:59:18,969 [trainer.py] => n_iter: 5
2025-01-05 21:59:18,969 [trainer.py] => num_users: 1
2025-01-05 21:59:18,969 [trainer.py] => cur_size: 50
2025-01-05 21:59:18,969 [trainer.py] => local_bs: 12
2025-01-05 21:59:18,969 [trainer.py] => vpt_type: Deep
2025-01-05 21:59:18,969 [trainer.py] => prompt_token_num: 6
2025-01-05 21:59:18,969 [trainer.py] => avg_alpha: 0.8
2025-01-05 21:59:18,969 [trainer.py] => perturb_var: 1
2025-01-05 21:59:18,969 [trainer.py] => EMA_beta: 0.99
2025-01-05 21:59:18,969 [trainer.py] => anchor_lambda: 0.1
2025-01-05 21:59:18,969 [trainer.py] => kl_weight: 0.001
2025-01-05 21:59:18,969 [trainer.py] => TIP_init: zero
2025-01-05 21:59:18,969 [trainer.py] => tuned_epoch: 10
2025-01-05 21:59:18,969 [trainer.py] => fs_epoch: 0
2025-01-05 21:59:18,969 [trainer.py] => init_lr: 0.01
2025-01-05 21:59:18,969 [trainer.py] => fs_lr: 0.001
2025-01-05 21:59:18,969 [trainer.py] => batch_size: 48
2025-01-05 21:59:18,969 [trainer.py] => fs_batch_size: 16
2025-01-05 21:59:18,970 [trainer.py] => weight_decay: 0.0005
2025-01-05 21:59:18,970 [trainer.py] => min_lr: 0
2025-01-05 21:59:18,970 [trainer.py] => optimizer: sgd
2025-01-05 21:59:18,970 [trainer.py] => memory_size: 0
2025-01-05 21:59:18,970 [trainer.py] => memory_per_class: 0
2025-01-05 21:59:18,970 [trainer.py] => fixed_memory: False
2025-01-05 21:59:18,970 [trainer.py] => shuffle: False
2025-01-05 21:59:18,970 [trainer.py] => top_k: 5
2025-01-05 21:59:18,970 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 21:59:18,970 [trainer.py] => prefix: asp
2025-01-05 21:59:18,970 [trainer.py] => model_prefix: asp
2025-01-05 21:59:20,699 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 22:00:05,879 [trainer.py] => All params: 173596160
2025-01-05 22:00:05,880 [trainer.py] => Trainable params: 1998848
2025-01-05 22:00:05,881 [asp.py] => Learning on 0-1
2025-01-05 22:00:05,910 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 22:03:15,249 [asp.py] => total parameters: 173596929
2025-01-05 22:03:15,250 [asp.py] => trainable parameters: 1999617
2025-01-05 22:03:59,130 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 22:03:59,130 [trainer.py] => model_name: asp
2025-01-05 22:03:59,131 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 22:03:59,131 [trainer.py] => device: ['cuda']
2025-01-05 22:03:59,132 [trainer.py] => seed: 2024
2025-01-05 22:03:59,132 [trainer.py] => dataset: cifar224
2025-01-05 22:03:59,132 [trainer.py] => init_cls: 1
2025-01-05 22:03:59,132 [trainer.py] => increment: 5
2025-01-05 22:03:59,132 [trainer.py] => kshot: 5
2025-01-05 22:03:59,132 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 22:03:59,132 [trainer.py] => z_dim: 1000
2025-01-05 22:03:59,132 [trainer.py] => conv_dim: 64
2025-01-05 22:03:59,132 [trainer.py] => img_size: 224
2025-01-05 22:03:59,132 [trainer.py] => generator_lr: 0.005
2025-01-05 22:03:59,132 [trainer.py] => pi: 100
2025-01-05 22:03:59,132 [trainer.py] => w_bn: 50.0
2025-01-05 22:03:59,132 [trainer.py] => w_noise: 0.001
2025-01-05 22:03:59,132 [trainer.py] => server_ss: 32
2025-01-05 22:03:59,132 [trainer.py] => bn_loss: 1
2025-01-05 22:03:59,132 [trainer.py] => noise: 1
2025-01-05 22:03:59,132 [trainer.py] => ie_loss: 1
2025-01-05 22:03:59,132 [trainer.py] => act_loss: 0
2025-01-05 22:03:59,132 [trainer.py] => w_ie: 1.0
2025-01-05 22:03:59,132 [trainer.py] => w_act: 0.1
2025-01-05 22:03:59,132 [trainer.py] => syn_size: 32
2025-01-05 22:03:59,132 [trainer.py] => need_syn_imgs: True
2025-01-05 22:03:59,132 [trainer.py] => g_local_bs: 5
2025-01-05 22:03:59,132 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 22:03:59,132 [trainer.py] => g_local_train_steps: 10
2025-01-05 22:03:59,132 [trainer.py] => dataset_syn: cifar100
2025-01-05 22:03:59,133 [trainer.py] => com_round_gen: 10
2025-01-05 22:03:59,133 [trainer.py] => g_sigma: 0
2025-01-05 22:03:59,133 [trainer.py] => save_cls_embeds: False
2025-01-05 22:03:59,133 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 22:03:59,133 [trainer.py] => save_dir: outputs
2025-01-05 22:03:59,133 [trainer.py] => n_iter: 5
2025-01-05 22:03:59,133 [trainer.py] => num_users: 1
2025-01-05 22:03:59,133 [trainer.py] => cur_size: 50
2025-01-05 22:03:59,133 [trainer.py] => local_bs: 12
2025-01-05 22:03:59,133 [trainer.py] => vpt_type: Deep
2025-01-05 22:03:59,133 [trainer.py] => prompt_token_num: 6
2025-01-05 22:03:59,133 [trainer.py] => avg_alpha: 0.8
2025-01-05 22:03:59,133 [trainer.py] => perturb_var: 1
2025-01-05 22:03:59,133 [trainer.py] => EMA_beta: 0.99
2025-01-05 22:03:59,133 [trainer.py] => anchor_lambda: 0.1
2025-01-05 22:03:59,133 [trainer.py] => kl_weight: 0.001
2025-01-05 22:03:59,133 [trainer.py] => TIP_init: zero
2025-01-05 22:03:59,133 [trainer.py] => tuned_epoch: 10
2025-01-05 22:03:59,133 [trainer.py] => fs_epoch: 0
2025-01-05 22:03:59,133 [trainer.py] => init_lr: 0.01
2025-01-05 22:03:59,133 [trainer.py] => fs_lr: 0.001
2025-01-05 22:03:59,133 [trainer.py] => batch_size: 48
2025-01-05 22:03:59,133 [trainer.py] => fs_batch_size: 16
2025-01-05 22:03:59,133 [trainer.py] => weight_decay: 0.0005
2025-01-05 22:03:59,133 [trainer.py] => min_lr: 0
2025-01-05 22:03:59,133 [trainer.py] => optimizer: sgd
2025-01-05 22:03:59,134 [trainer.py] => memory_size: 0
2025-01-05 22:03:59,134 [trainer.py] => memory_per_class: 0
2025-01-05 22:03:59,134 [trainer.py] => fixed_memory: False
2025-01-05 22:03:59,134 [trainer.py] => shuffle: False
2025-01-05 22:03:59,134 [trainer.py] => top_k: 5
2025-01-05 22:03:59,134 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 22:03:59,134 [trainer.py] => prefix: asp
2025-01-05 22:03:59,134 [trainer.py] => model_prefix: asp
2025-01-05 22:04:00,950 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 22:04:47,870 [trainer.py] => All params: 173596160
2025-01-05 22:04:47,871 [trainer.py] => Trainable params: 1998848
2025-01-05 22:04:47,872 [asp.py] => Learning on 0-1
2025-01-05 22:04:47,904 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 22:07:59,684 [asp.py] => total parameters: 173596929
2025-01-05 22:07:59,685 [asp.py] => trainable parameters: 1999617
2025-01-05 22:19:35,417 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 22:19:35,417 [trainer.py] => model_name: asp
2025-01-05 22:19:35,417 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 22:19:35,417 [trainer.py] => device: ['cuda']
2025-01-05 22:19:35,417 [trainer.py] => seed: 2024
2025-01-05 22:19:35,418 [trainer.py] => dataset: cifar224
2025-01-05 22:19:35,418 [trainer.py] => init_cls: 1
2025-01-05 22:19:35,418 [trainer.py] => increment: 5
2025-01-05 22:19:35,418 [trainer.py] => kshot: 5
2025-01-05 22:19:35,418 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 22:19:35,418 [trainer.py] => z_dim: 1000
2025-01-05 22:19:35,418 [trainer.py] => conv_dim: 64
2025-01-05 22:19:35,418 [trainer.py] => img_size: 224
2025-01-05 22:19:35,418 [trainer.py] => generator_lr: 0.005
2025-01-05 22:19:35,418 [trainer.py] => pi: 100
2025-01-05 22:19:35,418 [trainer.py] => w_bn: 50.0
2025-01-05 22:19:35,418 [trainer.py] => w_noise: 0.001
2025-01-05 22:19:35,418 [trainer.py] => server_ss: 32
2025-01-05 22:19:35,418 [trainer.py] => bn_loss: 1
2025-01-05 22:19:35,418 [trainer.py] => noise: 1
2025-01-05 22:19:35,418 [trainer.py] => ie_loss: 1
2025-01-05 22:19:35,418 [trainer.py] => act_loss: 0
2025-01-05 22:19:35,418 [trainer.py] => w_ie: 1.0
2025-01-05 22:19:35,418 [trainer.py] => w_act: 0.1
2025-01-05 22:19:35,418 [trainer.py] => syn_size: 32
2025-01-05 22:19:35,418 [trainer.py] => need_syn_imgs: True
2025-01-05 22:19:35,418 [trainer.py] => g_local_bs: 5
2025-01-05 22:19:35,418 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 22:19:35,418 [trainer.py] => g_local_train_steps: 10
2025-01-05 22:19:35,418 [trainer.py] => dataset_syn: cifar100
2025-01-05 22:19:35,418 [trainer.py] => com_round_gen: 10
2025-01-05 22:19:35,418 [trainer.py] => g_sigma: 0
2025-01-05 22:19:35,418 [trainer.py] => save_cls_embeds: False
2025-01-05 22:19:35,418 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 22:19:35,418 [trainer.py] => save_dir: outputs
2025-01-05 22:19:35,418 [trainer.py] => n_iter: 5
2025-01-05 22:19:35,418 [trainer.py] => num_users: 1
2025-01-05 22:19:35,418 [trainer.py] => cur_size: 50
2025-01-05 22:19:35,418 [trainer.py] => local_bs: 12
2025-01-05 22:19:35,418 [trainer.py] => vpt_type: Deep
2025-01-05 22:19:35,419 [trainer.py] => prompt_token_num: 6
2025-01-05 22:19:35,419 [trainer.py] => avg_alpha: 0.8
2025-01-05 22:19:35,419 [trainer.py] => perturb_var: 1
2025-01-05 22:19:35,419 [trainer.py] => EMA_beta: 0.99
2025-01-05 22:19:35,419 [trainer.py] => anchor_lambda: 0.1
2025-01-05 22:19:35,419 [trainer.py] => kl_weight: 0.001
2025-01-05 22:19:35,419 [trainer.py] => TIP_init: zero
2025-01-05 22:19:35,419 [trainer.py] => tuned_epoch: 10
2025-01-05 22:19:35,419 [trainer.py] => fs_epoch: 0
2025-01-05 22:19:35,419 [trainer.py] => init_lr: 0.01
2025-01-05 22:19:35,419 [trainer.py] => fs_lr: 0.001
2025-01-05 22:19:35,419 [trainer.py] => batch_size: 48
2025-01-05 22:19:35,419 [trainer.py] => fs_batch_size: 16
2025-01-05 22:19:35,419 [trainer.py] => weight_decay: 0.0005
2025-01-05 22:19:35,419 [trainer.py] => min_lr: 0
2025-01-05 22:19:35,419 [trainer.py] => optimizer: sgd
2025-01-05 22:19:35,419 [trainer.py] => memory_size: 0
2025-01-05 22:19:35,419 [trainer.py] => memory_per_class: 0
2025-01-05 22:19:35,419 [trainer.py] => fixed_memory: False
2025-01-05 22:19:35,419 [trainer.py] => shuffle: False
2025-01-05 22:19:35,419 [trainer.py] => top_k: 5
2025-01-05 22:19:35,419 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 22:19:35,419 [trainer.py] => prefix: asp
2025-01-05 22:19:35,419 [trainer.py] => model_prefix: asp
2025-01-05 22:19:37,283 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 22:20:13,103 [trainer.py] => All params: 173596160
2025-01-05 22:20:13,104 [trainer.py] => Trainable params: 1998848
2025-01-05 22:20:13,106 [asp.py] => Learning on 0-1
2025-01-05 22:20:13,111 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 22:23:22,101 [asp.py] => total parameters: 173596929
2025-01-05 22:23:22,102 [asp.py] => trainable parameters: 1999617
2025-01-05 22:25:50,610 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 22:25:50,611 [trainer.py] => model_name: asp
2025-01-05 22:25:50,611 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 22:25:50,611 [trainer.py] => device: ['cuda']
2025-01-05 22:25:50,611 [trainer.py] => seed: 2024
2025-01-05 22:25:50,611 [trainer.py] => dataset: cifar224
2025-01-05 22:25:50,611 [trainer.py] => init_cls: 1
2025-01-05 22:25:50,611 [trainer.py] => increment: 5
2025-01-05 22:25:50,611 [trainer.py] => kshot: 5
2025-01-05 22:25:50,611 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 22:25:50,611 [trainer.py] => z_dim: 1000
2025-01-05 22:25:50,611 [trainer.py] => conv_dim: 64
2025-01-05 22:25:50,611 [trainer.py] => img_size: 224
2025-01-05 22:25:50,611 [trainer.py] => generator_lr: 0.005
2025-01-05 22:25:50,611 [trainer.py] => pi: 100
2025-01-05 22:25:50,611 [trainer.py] => w_bn: 50.0
2025-01-05 22:25:50,611 [trainer.py] => w_noise: 0.001
2025-01-05 22:25:50,611 [trainer.py] => server_ss: 32
2025-01-05 22:25:50,611 [trainer.py] => bn_loss: 1
2025-01-05 22:25:50,611 [trainer.py] => noise: 1
2025-01-05 22:25:50,611 [trainer.py] => ie_loss: 1
2025-01-05 22:25:50,611 [trainer.py] => act_loss: 0
2025-01-05 22:25:50,611 [trainer.py] => w_ie: 1.0
2025-01-05 22:25:50,611 [trainer.py] => w_act: 0.1
2025-01-05 22:25:50,611 [trainer.py] => syn_size: 32
2025-01-05 22:25:50,612 [trainer.py] => need_syn_imgs: True
2025-01-05 22:25:50,612 [trainer.py] => g_local_bs: 5
2025-01-05 22:25:50,612 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 22:25:50,612 [trainer.py] => g_local_train_steps: 10
2025-01-05 22:25:50,612 [trainer.py] => dataset_syn: cifar100
2025-01-05 22:25:50,612 [trainer.py] => com_round_gen: 10
2025-01-05 22:25:50,612 [trainer.py] => g_sigma: 0
2025-01-05 22:25:50,612 [trainer.py] => save_cls_embeds: False
2025-01-05 22:25:50,612 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-05 22:25:50,612 [trainer.py] => save_dir: outputs
2025-01-05 22:25:50,612 [trainer.py] => n_iter: 5
2025-01-05 22:25:50,612 [trainer.py] => num_users: 1
2025-01-05 22:25:50,612 [trainer.py] => cur_size: 50
2025-01-05 22:25:50,612 [trainer.py] => local_bs: 12
2025-01-05 22:25:50,612 [trainer.py] => vpt_type: Deep
2025-01-05 22:25:50,612 [trainer.py] => prompt_token_num: 6
2025-01-05 22:25:50,612 [trainer.py] => avg_alpha: 0.8
2025-01-05 22:25:50,612 [trainer.py] => perturb_var: 1
2025-01-05 22:25:50,612 [trainer.py] => EMA_beta: 0.99
2025-01-05 22:25:50,612 [trainer.py] => anchor_lambda: 0.1
2025-01-05 22:25:50,612 [trainer.py] => kl_weight: 0.001
2025-01-05 22:25:50,612 [trainer.py] => TIP_init: zero
2025-01-05 22:25:50,612 [trainer.py] => tuned_epoch: 10
2025-01-05 22:25:50,612 [trainer.py] => fs_epoch: 0
2025-01-05 22:25:50,612 [trainer.py] => init_lr: 0.01
2025-01-05 22:25:50,612 [trainer.py] => fs_lr: 0.001
2025-01-05 22:25:50,612 [trainer.py] => batch_size: 48
2025-01-05 22:25:50,612 [trainer.py] => fs_batch_size: 16
2025-01-05 22:25:50,612 [trainer.py] => weight_decay: 0.0005
2025-01-05 22:25:50,612 [trainer.py] => min_lr: 0
2025-01-05 22:25:50,612 [trainer.py] => optimizer: sgd
2025-01-05 22:25:50,612 [trainer.py] => memory_size: 0
2025-01-05 22:25:50,612 [trainer.py] => memory_per_class: 0
2025-01-05 22:25:50,612 [trainer.py] => fixed_memory: False
2025-01-05 22:25:50,612 [trainer.py] => shuffle: False
2025-01-05 22:25:50,613 [trainer.py] => top_k: 5
2025-01-05 22:25:50,613 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 22:25:50,613 [trainer.py] => prefix: asp
2025-01-05 22:25:50,613 [trainer.py] => model_prefix: asp
2025-01-05 22:25:52,442 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 22:26:31,332 [trainer.py] => All params: 173596160
2025-01-05 22:26:31,333 [trainer.py] => Trainable params: 1998848
2025-01-05 22:26:31,334 [asp.py] => Learning on 0-1
2025-01-05 22:26:31,397 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-05 22:29:41,906 [asp.py] => total parameters: 173596929
2025-01-05 22:29:41,908 [asp.py] => trainable parameters: 1999617
2025-01-06 11:21:11,658 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-06 11:21:11,658 [trainer.py] => model_name: asp
2025-01-06 11:21:11,658 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-06 11:21:11,658 [trainer.py] => device: ['cuda']
2025-01-06 11:21:11,658 [trainer.py] => seed: 2024
2025-01-06 11:21:11,658 [trainer.py] => dataset: cifar224
2025-01-06 11:21:11,658 [trainer.py] => init_cls: 1
2025-01-06 11:21:11,658 [trainer.py] => increment: 5
2025-01-06 11:21:11,658 [trainer.py] => kshot: 5
2025-01-06 11:21:11,658 [trainer.py] => generator_model: CIFAR_GEN
2025-01-06 11:21:11,658 [trainer.py] => z_dim: 1000
2025-01-06 11:21:11,658 [trainer.py] => conv_dim: 64
2025-01-06 11:21:11,658 [trainer.py] => img_size: 224
2025-01-06 11:21:11,658 [trainer.py] => generator_lr: 0.005
2025-01-06 11:21:11,658 [trainer.py] => pi: 100
2025-01-06 11:21:11,658 [trainer.py] => w_bn: 50.0
2025-01-06 11:21:11,658 [trainer.py] => w_noise: 0.001
2025-01-06 11:21:11,658 [trainer.py] => server_ss: 32
2025-01-06 11:21:11,658 [trainer.py] => bn_loss: 1
2025-01-06 11:21:11,658 [trainer.py] => noise: 1
2025-01-06 11:21:11,658 [trainer.py] => ie_loss: 1
2025-01-06 11:21:11,658 [trainer.py] => act_loss: 0
2025-01-06 11:21:11,659 [trainer.py] => w_ie: 1.0
2025-01-06 11:21:11,659 [trainer.py] => w_act: 0.1
2025-01-06 11:21:11,659 [trainer.py] => syn_size: 32
2025-01-06 11:21:11,659 [trainer.py] => need_syn_imgs: True
2025-01-06 11:21:11,659 [trainer.py] => g_local_bs: 5
2025-01-06 11:21:11,659 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-06 11:21:11,659 [trainer.py] => g_local_train_steps: 10
2025-01-06 11:21:11,659 [trainer.py] => dataset_syn: cifar100
2025-01-06 11:21:11,659 [trainer.py] => com_round_gen: 10
2025-01-06 11:21:11,659 [trainer.py] => g_sigma: 0
2025-01-06 11:21:11,659 [trainer.py] => save_cls_embeds: False
2025-01-06 11:21:11,659 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-06 11:21:11,659 [trainer.py] => save_dir: outputs
2025-01-06 11:21:11,659 [trainer.py] => n_iter: 5
2025-01-06 11:21:11,659 [trainer.py] => num_users: 1
2025-01-06 11:21:11,659 [trainer.py] => cur_size: 50
2025-01-06 11:21:11,659 [trainer.py] => local_bs: 12
2025-01-06 11:21:11,659 [trainer.py] => vpt_type: Deep
2025-01-06 11:21:11,659 [trainer.py] => prompt_token_num: 6
2025-01-06 11:21:11,659 [trainer.py] => avg_alpha: 0.8
2025-01-06 11:21:11,659 [trainer.py] => perturb_var: 1
2025-01-06 11:21:11,659 [trainer.py] => EMA_beta: 0.99
2025-01-06 11:21:11,659 [trainer.py] => anchor_lambda: 0.1
2025-01-06 11:21:11,659 [trainer.py] => kl_weight: 0.001
2025-01-06 11:21:11,659 [trainer.py] => TIP_init: zero
2025-01-06 11:21:11,659 [trainer.py] => tuned_epoch: 10
2025-01-06 11:21:11,659 [trainer.py] => fs_epoch: 0
2025-01-06 11:21:11,659 [trainer.py] => init_lr: 0.01
2025-01-06 11:21:11,659 [trainer.py] => fs_lr: 0.001
2025-01-06 11:21:11,659 [trainer.py] => batch_size: 48
2025-01-06 11:21:11,659 [trainer.py] => fs_batch_size: 16
2025-01-06 11:21:11,659 [trainer.py] => weight_decay: 0.0005
2025-01-06 11:21:11,659 [trainer.py] => min_lr: 0
2025-01-06 11:21:11,660 [trainer.py] => optimizer: sgd
2025-01-06 11:21:11,660 [trainer.py] => memory_size: 0
2025-01-06 11:21:11,660 [trainer.py] => memory_per_class: 0
2025-01-06 11:21:11,660 [trainer.py] => fixed_memory: False
2025-01-06 11:21:11,660 [trainer.py] => shuffle: False
2025-01-06 11:21:11,660 [trainer.py] => top_k: 5
2025-01-06 11:21:11,660 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-06 11:21:11,660 [trainer.py] => prefix: asp
2025-01-06 11:21:11,660 [trainer.py] => model_prefix: asp
2025-01-06 11:21:50,922 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-06 11:32:32,936 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-06 11:32:32,938 [trainer.py] => model_name: asp
2025-01-06 11:32:32,938 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-06 11:32:32,938 [trainer.py] => device: ['cuda']
2025-01-06 11:32:32,939 [trainer.py] => seed: 2024
2025-01-06 11:32:32,939 [trainer.py] => dataset: cifar224
2025-01-06 11:32:32,940 [trainer.py] => init_cls: 1
2025-01-06 11:32:32,940 [trainer.py] => increment: 5
2025-01-06 11:32:32,940 [trainer.py] => kshot: 5
2025-01-06 11:32:32,941 [trainer.py] => generator_model: CIFAR_GEN
2025-01-06 11:32:32,941 [trainer.py] => z_dim: 1000
2025-01-06 11:32:32,941 [trainer.py] => conv_dim: 64
2025-01-06 11:32:32,942 [trainer.py] => img_size: 224
2025-01-06 11:32:32,942 [trainer.py] => generator_lr: 0.005
2025-01-06 11:32:32,943 [trainer.py] => pi: 100
2025-01-06 11:32:32,943 [trainer.py] => w_bn: 50.0
2025-01-06 11:32:32,944 [trainer.py] => w_noise: 0.001
2025-01-06 11:32:32,944 [trainer.py] => server_ss: 32
2025-01-06 11:32:32,944 [trainer.py] => bn_loss: 1
2025-01-06 11:32:32,945 [trainer.py] => noise: 1
2025-01-06 11:32:32,945 [trainer.py] => ie_loss: 1
2025-01-06 11:32:32,945 [trainer.py] => act_loss: 0
2025-01-06 11:32:32,946 [trainer.py] => w_ie: 1.0
2025-01-06 11:32:32,946 [trainer.py] => w_act: 0.1
2025-01-06 11:32:32,946 [trainer.py] => syn_size: 32
2025-01-06 11:32:32,947 [trainer.py] => need_syn_imgs: True
2025-01-06 11:32:32,947 [trainer.py] => g_local_bs: 5
2025-01-06 11:32:32,948 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-06 11:32:32,948 [trainer.py] => g_local_train_steps: 10
2025-01-06 11:32:32,948 [trainer.py] => dataset_syn: cifar100
2025-01-06 11:32:32,948 [trainer.py] => com_round_gen: 10
2025-01-06 11:32:32,948 [trainer.py] => g_sigma: 0
2025-01-06 11:32:32,948 [trainer.py] => save_cls_embeds: False
2025-01-06 11:32:32,949 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-06 11:32:32,949 [trainer.py] => save_dir: outputs
2025-01-06 11:32:32,949 [trainer.py] => n_iter: 5
2025-01-06 11:32:32,949 [trainer.py] => num_users: 1
2025-01-06 11:32:32,949 [trainer.py] => cur_size: 50
2025-01-06 11:32:32,949 [trainer.py] => local_bs: 12
2025-01-06 11:32:32,949 [trainer.py] => vpt_type: Deep
2025-01-06 11:32:32,949 [trainer.py] => prompt_token_num: 6
2025-01-06 11:32:32,949 [trainer.py] => avg_alpha: 0.8
2025-01-06 11:32:32,950 [trainer.py] => perturb_var: 1
2025-01-06 11:32:32,950 [trainer.py] => EMA_beta: 0.99
2025-01-06 11:32:32,950 [trainer.py] => anchor_lambda: 0.1
2025-01-06 11:32:32,950 [trainer.py] => kl_weight: 0.001
2025-01-06 11:32:32,950 [trainer.py] => TIP_init: zero
2025-01-06 11:32:32,950 [trainer.py] => tuned_epoch: 10
2025-01-06 11:32:32,950 [trainer.py] => fs_epoch: 0
2025-01-06 11:32:32,950 [trainer.py] => init_lr: 0.01
2025-01-06 11:32:32,950 [trainer.py] => fs_lr: 0.001
2025-01-06 11:32:32,951 [trainer.py] => batch_size: 48
2025-01-06 11:32:32,951 [trainer.py] => fs_batch_size: 16
2025-01-06 11:32:32,951 [trainer.py] => weight_decay: 0.0005
2025-01-06 11:32:32,951 [trainer.py] => min_lr: 0
2025-01-06 11:32:32,951 [trainer.py] => optimizer: sgd
2025-01-06 11:32:32,951 [trainer.py] => memory_size: 0
2025-01-06 11:32:32,951 [trainer.py] => memory_per_class: 0
2025-01-06 11:32:32,952 [trainer.py] => fixed_memory: False
2025-01-06 11:32:32,952 [trainer.py] => shuffle: False
2025-01-06 11:32:32,952 [trainer.py] => top_k: 5
2025-01-06 11:32:32,952 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-06 11:32:32,952 [trainer.py] => prefix: asp
2025-01-06 11:32:32,952 [trainer.py] => model_prefix: asp
2025-01-06 11:32:40,713 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-06 11:45:04,227 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-06 11:45:04,227 [trainer.py] => model_name: asp
2025-01-06 11:45:04,227 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-06 11:45:04,227 [trainer.py] => device: ['cuda']
2025-01-06 11:45:04,227 [trainer.py] => seed: 2024
2025-01-06 11:45:04,227 [trainer.py] => dataset: cifar224
2025-01-06 11:45:04,227 [trainer.py] => init_cls: 1
2025-01-06 11:45:04,227 [trainer.py] => increment: 5
2025-01-06 11:45:04,227 [trainer.py] => kshot: 5
2025-01-06 11:45:04,227 [trainer.py] => generator_model: CIFAR_GEN
2025-01-06 11:45:04,227 [trainer.py] => z_dim: 1000
2025-01-06 11:45:04,227 [trainer.py] => conv_dim: 64
2025-01-06 11:45:04,227 [trainer.py] => img_size: 224
2025-01-06 11:45:04,227 [trainer.py] => generator_lr: 0.005
2025-01-06 11:45:04,227 [trainer.py] => pi: 100
2025-01-06 11:45:04,227 [trainer.py] => w_bn: 50.0
2025-01-06 11:45:04,227 [trainer.py] => w_noise: 0.001
2025-01-06 11:45:04,227 [trainer.py] => server_ss: 32
2025-01-06 11:45:04,227 [trainer.py] => bn_loss: 1
2025-01-06 11:45:04,227 [trainer.py] => noise: 1
2025-01-06 11:45:04,228 [trainer.py] => ie_loss: 1
2025-01-06 11:45:04,228 [trainer.py] => act_loss: 0
2025-01-06 11:45:04,228 [trainer.py] => w_ie: 1.0
2025-01-06 11:45:04,228 [trainer.py] => w_act: 0.1
2025-01-06 11:45:04,228 [trainer.py] => syn_size: 32
2025-01-06 11:45:04,228 [trainer.py] => need_syn_imgs: True
2025-01-06 11:45:04,228 [trainer.py] => g_local_bs: 5
2025-01-06 11:45:04,228 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-06 11:45:04,228 [trainer.py] => g_local_train_steps: 10
2025-01-06 11:45:04,228 [trainer.py] => dataset_syn: cifar100
2025-01-06 11:45:04,228 [trainer.py] => com_round_gen: 10
2025-01-06 11:45:04,228 [trainer.py] => g_sigma: 0
2025-01-06 11:45:04,228 [trainer.py] => save_cls_embeds: False
2025-01-06 11:45:04,228 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-06 11:45:04,228 [trainer.py] => save_dir: outputs
2025-01-06 11:45:04,228 [trainer.py] => n_iter: 5
2025-01-06 11:45:04,228 [trainer.py] => num_users: 1
2025-01-06 11:45:04,228 [trainer.py] => cur_size: 50
2025-01-06 11:45:04,228 [trainer.py] => local_bs: 12
2025-01-06 11:45:04,228 [trainer.py] => vpt_type: Deep
2025-01-06 11:45:04,228 [trainer.py] => prompt_token_num: 6
2025-01-06 11:45:04,228 [trainer.py] => avg_alpha: 0.8
2025-01-06 11:45:04,228 [trainer.py] => perturb_var: 1
2025-01-06 11:45:04,228 [trainer.py] => EMA_beta: 0.99
2025-01-06 11:45:04,228 [trainer.py] => anchor_lambda: 0.1
2025-01-06 11:45:04,228 [trainer.py] => kl_weight: 0.001
2025-01-06 11:45:04,228 [trainer.py] => TIP_init: zero
2025-01-06 11:45:04,228 [trainer.py] => tuned_epoch: 10
2025-01-06 11:45:04,228 [trainer.py] => fs_epoch: 0
2025-01-06 11:45:04,228 [trainer.py] => init_lr: 0.01
2025-01-06 11:45:04,228 [trainer.py] => fs_lr: 0.001
2025-01-06 11:45:04,228 [trainer.py] => batch_size: 48
2025-01-06 11:45:04,228 [trainer.py] => fs_batch_size: 16
2025-01-06 11:45:04,229 [trainer.py] => weight_decay: 0.0005
2025-01-06 11:45:04,229 [trainer.py] => min_lr: 0
2025-01-06 11:45:04,229 [trainer.py] => optimizer: sgd
2025-01-06 11:45:04,229 [trainer.py] => memory_size: 0
2025-01-06 11:45:04,229 [trainer.py] => memory_per_class: 0
2025-01-06 11:45:04,229 [trainer.py] => fixed_memory: False
2025-01-06 11:45:04,229 [trainer.py] => shuffle: False
2025-01-06 11:45:04,229 [trainer.py] => top_k: 5
2025-01-06 11:45:04,229 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-06 11:45:04,229 [trainer.py] => prefix: asp
2025-01-06 11:45:04,229 [trainer.py] => model_prefix: asp
2025-01-06 11:45:06,053 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-06 11:45:35,047 [trainer.py] => All params: 173596160
2025-01-06 11:45:35,054 [trainer.py] => Trainable params: 1998848
2025-01-06 11:45:35,056 [asp.py] => Learning on 0-1
2025-01-06 11:45:35,069 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-06 11:46:41,014 [trainer.py] => All params: 173596160
2025-01-06 11:46:41,015 [trainer.py] => Trainable params: 1998848
2025-01-06 11:46:41,016 [asp.py] => Learning on 0-1
2025-01-06 11:46:41,020 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-06 11:49:58,459 [asp.py] => total parameters: 173596929
2025-01-06 11:49:58,464 [asp.py] => trainable parameters: 1999617
2025-01-06 11:54:14,694 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-06 11:54:14,694 [trainer.py] => model_name: asp
2025-01-06 11:54:14,695 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-06 11:54:14,695 [trainer.py] => device: ['cuda']
2025-01-06 11:54:14,695 [trainer.py] => seed: 2024
2025-01-06 11:54:14,695 [trainer.py] => dataset: cifar224
2025-01-06 11:54:14,695 [trainer.py] => init_cls: 1
2025-01-06 11:54:14,695 [trainer.py] => increment: 5
2025-01-06 11:54:14,695 [trainer.py] => kshot: 5
2025-01-06 11:54:14,695 [trainer.py] => generator_model: CIFAR_GEN
2025-01-06 11:54:14,696 [trainer.py] => z_dim: 1000
2025-01-06 11:54:14,696 [trainer.py] => conv_dim: 64
2025-01-06 11:54:14,696 [trainer.py] => img_size: 224
2025-01-06 11:54:14,696 [trainer.py] => generator_lr: 0.005
2025-01-06 11:54:14,696 [trainer.py] => pi: 100
2025-01-06 11:54:14,696 [trainer.py] => w_bn: 50.0
2025-01-06 11:54:14,696 [trainer.py] => w_noise: 0.001
2025-01-06 11:54:14,696 [trainer.py] => server_ss: 32
2025-01-06 11:54:14,697 [trainer.py] => bn_loss: 1
2025-01-06 11:54:14,697 [trainer.py] => noise: 1
2025-01-06 11:54:14,697 [trainer.py] => ie_loss: 1
2025-01-06 11:54:14,697 [trainer.py] => act_loss: 0
2025-01-06 11:54:14,697 [trainer.py] => w_ie: 1.0
2025-01-06 11:54:14,697 [trainer.py] => w_act: 0.1
2025-01-06 11:54:14,697 [trainer.py] => syn_size: 32
2025-01-06 11:54:14,698 [trainer.py] => need_syn_imgs: True
2025-01-06 11:54:14,698 [trainer.py] => g_local_bs: 5
2025-01-06 11:54:14,698 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-06 11:54:14,698 [trainer.py] => g_local_train_steps: 10
2025-01-06 11:54:14,698 [trainer.py] => dataset_syn: cifar100
2025-01-06 11:54:14,699 [trainer.py] => com_round_gen: 10
2025-01-06 11:54:14,699 [trainer.py] => g_sigma: 0
2025-01-06 11:54:14,699 [trainer.py] => save_cls_embeds: False
2025-01-06 11:54:14,699 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-06 11:54:14,699 [trainer.py] => save_dir: outputs
2025-01-06 11:54:14,699 [trainer.py] => n_iter: 5
2025-01-06 11:54:14,700 [trainer.py] => num_users: 1
2025-01-06 11:54:14,700 [trainer.py] => cur_size: 50
2025-01-06 11:54:14,700 [trainer.py] => local_bs: 12
2025-01-06 11:54:14,700 [trainer.py] => vpt_type: Deep
2025-01-06 11:54:14,700 [trainer.py] => prompt_token_num: 6
2025-01-06 11:54:14,701 [trainer.py] => avg_alpha: 0.8
2025-01-06 11:54:14,701 [trainer.py] => perturb_var: 1
2025-01-06 11:54:14,701 [trainer.py] => EMA_beta: 0.99
2025-01-06 11:54:14,701 [trainer.py] => anchor_lambda: 0.1
2025-01-06 11:54:14,702 [trainer.py] => kl_weight: 0.001
2025-01-06 11:54:14,702 [trainer.py] => TIP_init: zero
2025-01-06 11:54:14,702 [trainer.py] => tuned_epoch: 10
2025-01-06 11:54:14,702 [trainer.py] => fs_epoch: 0
2025-01-06 11:54:14,702 [trainer.py] => init_lr: 0.01
2025-01-06 11:54:14,702 [trainer.py] => fs_lr: 0.001
2025-01-06 11:54:14,703 [trainer.py] => batch_size: 48
2025-01-06 11:54:14,703 [trainer.py] => fs_batch_size: 16
2025-01-06 11:54:14,703 [trainer.py] => weight_decay: 0.0005
2025-01-06 11:54:14,703 [trainer.py] => min_lr: 0
2025-01-06 11:54:14,703 [trainer.py] => optimizer: sgd
2025-01-06 11:54:14,704 [trainer.py] => memory_size: 0
2025-01-06 11:54:14,704 [trainer.py] => memory_per_class: 0
2025-01-06 11:54:14,704 [trainer.py] => fixed_memory: False
2025-01-06 11:54:14,704 [trainer.py] => shuffle: False
2025-01-06 11:54:14,704 [trainer.py] => top_k: 5
2025-01-06 11:54:14,705 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-06 11:54:14,705 [trainer.py] => prefix: asp
2025-01-06 11:54:14,705 [trainer.py] => model_prefix: asp
2025-01-06 11:54:16,425 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-06 11:54:36,471 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-06 11:54:36,471 [trainer.py] => model_name: asp
2025-01-06 11:54:36,471 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-06 11:54:36,471 [trainer.py] => device: ['cuda']
2025-01-06 11:54:36,471 [trainer.py] => seed: 2024
2025-01-06 11:54:36,472 [trainer.py] => dataset: cifar224
2025-01-06 11:54:36,472 [trainer.py] => init_cls: 1
2025-01-06 11:54:36,472 [trainer.py] => increment: 5
2025-01-06 11:54:36,472 [trainer.py] => kshot: 5
2025-01-06 11:54:36,472 [trainer.py] => generator_model: CIFAR_GEN
2025-01-06 11:54:36,472 [trainer.py] => z_dim: 1000
2025-01-06 11:54:36,472 [trainer.py] => conv_dim: 64
2025-01-06 11:54:36,472 [trainer.py] => img_size: 224
2025-01-06 11:54:36,472 [trainer.py] => generator_lr: 0.005
2025-01-06 11:54:36,472 [trainer.py] => pi: 100
2025-01-06 11:54:36,472 [trainer.py] => w_bn: 50.0
2025-01-06 11:54:36,473 [trainer.py] => w_noise: 0.001
2025-01-06 11:54:36,473 [trainer.py] => server_ss: 32
2025-01-06 11:54:36,473 [trainer.py] => bn_loss: 1
2025-01-06 11:54:36,473 [trainer.py] => noise: 1
2025-01-06 11:54:36,473 [trainer.py] => ie_loss: 1
2025-01-06 11:54:36,473 [trainer.py] => act_loss: 0
2025-01-06 11:54:36,473 [trainer.py] => w_ie: 1.0
2025-01-06 11:54:36,473 [trainer.py] => w_act: 0.1
2025-01-06 11:54:36,473 [trainer.py] => syn_size: 32
2025-01-06 11:54:36,473 [trainer.py] => need_syn_imgs: True
2025-01-06 11:54:36,474 [trainer.py] => g_local_bs: 5
2025-01-06 11:54:36,474 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-06 11:54:36,474 [trainer.py] => g_local_train_steps: 10
2025-01-06 11:54:36,474 [trainer.py] => dataset_syn: cifar100
2025-01-06 11:54:36,474 [trainer.py] => com_round_gen: 10
2025-01-06 11:54:36,474 [trainer.py] => g_sigma: 0
2025-01-06 11:54:36,474 [trainer.py] => save_cls_embeds: False
2025-01-06 11:54:36,474 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-06 11:54:36,474 [trainer.py] => save_dir: outputs
2025-01-06 11:54:36,475 [trainer.py] => n_iter: 5
2025-01-06 11:54:36,475 [trainer.py] => num_users: 1
2025-01-06 11:54:36,475 [trainer.py] => cur_size: 50
2025-01-06 11:54:36,475 [trainer.py] => local_bs: 12
2025-01-06 11:54:36,475 [trainer.py] => vpt_type: Deep
2025-01-06 11:54:36,475 [trainer.py] => prompt_token_num: 6
2025-01-06 11:54:36,475 [trainer.py] => avg_alpha: 0.8
2025-01-06 11:54:36,475 [trainer.py] => perturb_var: 1
2025-01-06 11:54:36,475 [trainer.py] => EMA_beta: 0.99
2025-01-06 11:54:36,476 [trainer.py] => anchor_lambda: 0.1
2025-01-06 11:54:36,476 [trainer.py] => kl_weight: 0.001
2025-01-06 11:54:36,476 [trainer.py] => TIP_init: zero
2025-01-06 11:54:36,476 [trainer.py] => tuned_epoch: 10
2025-01-06 11:54:36,476 [trainer.py] => fs_epoch: 0
2025-01-06 11:54:36,476 [trainer.py] => init_lr: 0.01
2025-01-06 11:54:36,476 [trainer.py] => fs_lr: 0.001
2025-01-06 11:54:36,476 [trainer.py] => batch_size: 48
2025-01-06 11:54:36,476 [trainer.py] => fs_batch_size: 16
2025-01-06 11:54:36,477 [trainer.py] => weight_decay: 0.0005
2025-01-06 11:54:36,477 [trainer.py] => min_lr: 0
2025-01-06 11:54:36,477 [trainer.py] => optimizer: sgd
2025-01-06 11:54:36,477 [trainer.py] => memory_size: 0
2025-01-06 11:54:36,477 [trainer.py] => memory_per_class: 0
2025-01-06 11:54:36,477 [trainer.py] => fixed_memory: False
2025-01-06 11:54:36,477 [trainer.py] => shuffle: False
2025-01-06 11:54:36,477 [trainer.py] => top_k: 5
2025-01-06 11:54:36,477 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-06 11:54:36,477 [trainer.py] => prefix: asp
2025-01-06 11:54:36,478 [trainer.py] => model_prefix: asp
2025-01-06 11:54:38,248 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-06 11:55:34,223 [trainer.py] => All params: 173596160
2025-01-06 11:55:34,228 [trainer.py] => Trainable params: 1998848
2025-01-06 11:55:34,230 [asp.py] => Learning on 0-1
2025-01-06 11:55:34,234 [asp.py] => training set size: 500, fc construct set size: 500
2025-01-06 11:58:43,515 [asp.py] => total parameters: 173596929
2025-01-06 11:58:43,522 [asp.py] => trainable parameters: 1999617
2025-01-06 12:08:11,278 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-06 12:08:11,278 [trainer.py] => model_name: asp
2025-01-06 12:08:11,278 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-06 12:08:11,278 [trainer.py] => device: ['cuda']
2025-01-06 12:08:11,279 [trainer.py] => seed: 2024
2025-01-06 12:08:11,279 [trainer.py] => dataset: cifar224
2025-01-06 12:08:11,279 [trainer.py] => init_cls: 1
2025-01-06 12:08:11,279 [trainer.py] => increment: 5
2025-01-06 12:08:11,279 [trainer.py] => kshot: 5
2025-01-06 12:08:11,279 [trainer.py] => generator_model: CIFAR_GEN
2025-01-06 12:08:11,279 [trainer.py] => z_dim: 1000
2025-01-06 12:08:11,279 [trainer.py] => conv_dim: 64
2025-01-06 12:08:11,279 [trainer.py] => img_size: 224
2025-01-06 12:08:11,279 [trainer.py] => generator_lr: 0.005
2025-01-06 12:08:11,280 [trainer.py] => pi: 100
2025-01-06 12:08:11,280 [trainer.py] => w_bn: 50.0
2025-01-06 12:08:11,280 [trainer.py] => w_noise: 0.001
2025-01-06 12:08:11,280 [trainer.py] => server_ss: 32
2025-01-06 12:08:11,280 [trainer.py] => bn_loss: 1
2025-01-06 12:08:11,280 [trainer.py] => noise: 1
2025-01-06 12:08:11,280 [trainer.py] => ie_loss: 1
2025-01-06 12:08:11,280 [trainer.py] => act_loss: 0
2025-01-06 12:08:11,280 [trainer.py] => w_ie: 1.0
2025-01-06 12:08:11,281 [trainer.py] => w_act: 0.1
2025-01-06 12:08:11,281 [trainer.py] => syn_size: 32
2025-01-06 12:08:11,281 [trainer.py] => need_syn_imgs: True
2025-01-06 12:08:11,281 [trainer.py] => g_local_bs: 5
2025-01-06 12:08:11,281 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-06 12:08:11,281 [trainer.py] => g_local_train_steps: 10
2025-01-06 12:08:11,281 [trainer.py] => dataset_syn: cifar100
2025-01-06 12:08:11,281 [trainer.py] => com_round_gen: 10
2025-01-06 12:08:11,281 [trainer.py] => g_sigma: 0
2025-01-06 12:08:11,281 [trainer.py] => save_cls_embeds: False
2025-01-06 12:08:11,282 [trainer.py] => syn_image_path: outputs/syn_image_10
2025-01-06 12:08:11,282 [trainer.py] => save_dir: outputs
2025-01-06 12:08:11,282 [trainer.py] => n_iter: 5
2025-01-06 12:08:11,282 [trainer.py] => num_users: 1
2025-01-06 12:08:11,282 [trainer.py] => cur_size: 50
2025-01-06 12:08:11,282 [trainer.py] => local_bs: 12
2025-01-06 12:08:11,282 [trainer.py] => vpt_type: Deep
2025-01-06 12:08:11,282 [trainer.py] => prompt_token_num: 6
2025-01-06 12:08:11,282 [trainer.py] => avg_alpha: 0.8
2025-01-06 12:08:11,282 [trainer.py] => perturb_var: 1
2025-01-06 12:08:11,283 [trainer.py] => EMA_beta: 0.99
2025-01-06 12:08:11,283 [trainer.py] => anchor_lambda: 0.1
2025-01-06 12:08:11,283 [trainer.py] => kl_weight: 0.001
2025-01-06 12:08:11,283 [trainer.py] => TIP_init: zero
2025-01-06 12:08:11,283 [trainer.py] => tuned_epoch: 10
2025-01-06 12:08:11,283 [trainer.py] => fs_epoch: 0
2025-01-06 12:08:11,283 [trainer.py] => init_lr: 0.01
2025-01-06 12:08:11,283 [trainer.py] => fs_lr: 0.001
2025-01-06 12:08:11,283 [trainer.py] => batch_size: 48
2025-01-06 12:08:11,284 [trainer.py] => fs_batch_size: 16
2025-01-06 12:08:11,284 [trainer.py] => weight_decay: 0.0005
2025-01-06 12:08:11,284 [trainer.py] => min_lr: 0
2025-01-06 12:08:11,284 [trainer.py] => optimizer: sgd
2025-01-06 12:08:11,284 [trainer.py] => memory_size: 0
2025-01-06 12:08:11,284 [trainer.py] => memory_per_class: 0
2025-01-06 12:08:11,284 [trainer.py] => fixed_memory: False
2025-01-06 12:08:11,284 [trainer.py] => shuffle: False
2025-01-06 12:08:11,284 [trainer.py] => top_k: 5
2025-01-06 12:08:11,284 [trainer.py] => base_model_path: saved_model/asp/cifar224/1_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-06 12:08:11,285 [trainer.py] => prefix: asp
2025-01-06 12:08:11,285 [trainer.py] => model_prefix: asp
2025-01-06 12:08:12,910 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-06 12:09:15,524 [trainer.py] => All params: 173596160
2025-01-06 12:09:15,529 [trainer.py] => Trainable params: 1998848
