2025-01-05 15:37:32,901 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:37:32,902 [trainer.py] => model_name: asp
2025-01-05 15:37:32,902 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:37:32,902 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:37:32,902 [trainer.py] => seed: 2024
2025-01-05 15:37:32,902 [trainer.py] => dataset: cifar224
2025-01-05 15:37:32,902 [trainer.py] => init_cls: 60
2025-01-05 15:37:32,902 [trainer.py] => increment: 60
2025-01-05 15:37:32,902 [trainer.py] => kshot: 5
2025-01-05 15:37:32,902 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:37:32,902 [trainer.py] => z_dim: 1000
2025-01-05 15:37:32,902 [trainer.py] => conv_dim: 64
2025-01-05 15:37:32,902 [trainer.py] => img_size: 224
2025-01-05 15:37:32,902 [trainer.py] => generator_lr: 0.005
2025-01-05 15:37:32,902 [trainer.py] => pi: 100
2025-01-05 15:37:32,902 [trainer.py] => w_bn: 50.0
2025-01-05 15:37:32,902 [trainer.py] => w_noise: 0.001
2025-01-05 15:37:32,902 [trainer.py] => server_ss: 32
2025-01-05 15:37:32,902 [trainer.py] => bn_loss: 1
2025-01-05 15:37:32,902 [trainer.py] => noise: 1
2025-01-05 15:37:32,902 [trainer.py] => ie_loss: 1
2025-01-05 15:37:32,902 [trainer.py] => act_loss: 0
2025-01-05 15:37:32,902 [trainer.py] => w_ie: 1.0
2025-01-05 15:37:32,902 [trainer.py] => w_act: 0.1
2025-01-05 15:37:32,902 [trainer.py] => syn_size: 32
2025-01-05 15:37:32,903 [trainer.py] => need_syn_imgs: True
2025-01-05 15:37:32,903 [trainer.py] => g_local_bs: 5
2025-01-05 15:37:32,903 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:37:32,903 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:37:32,903 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:37:32,903 [trainer.py] => com_round_gen: 10
2025-01-05 15:37:32,903 [trainer.py] => vpt_type: Deep
2025-01-05 15:37:32,903 [trainer.py] => prompt_token_num: 6
2025-01-05 15:37:32,903 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:37:32,903 [trainer.py] => perturb_var: 1
2025-01-05 15:37:32,903 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:37:32,903 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:37:32,903 [trainer.py] => kl_weight: 0.001
2025-01-05 15:37:32,903 [trainer.py] => TIP_init: zero
2025-01-05 15:37:32,903 [trainer.py] => tuned_epoch: 10
2025-01-05 15:37:32,903 [trainer.py] => fs_epoch: 0
2025-01-05 15:37:32,903 [trainer.py] => init_lr: 0.01
2025-01-05 15:37:32,903 [trainer.py] => fs_lr: 0.001
2025-01-05 15:37:32,903 [trainer.py] => batch_size: 48
2025-01-05 15:37:32,903 [trainer.py] => fs_batch_size: 16
2025-01-05 15:37:32,903 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:37:32,903 [trainer.py] => min_lr: 0
2025-01-05 15:37:32,903 [trainer.py] => optimizer: sgd
2025-01-05 15:37:32,903 [trainer.py] => memory_size: 0
2025-01-05 15:37:32,903 [trainer.py] => memory_per_class: 0
2025-01-05 15:37:32,903 [trainer.py] => fixed_memory: False
2025-01-05 15:37:32,903 [trainer.py] => shuffle: False
2025-01-05 15:37:32,903 [trainer.py] => top_k: 5
2025-01-05 15:37:32,903 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_60/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:37:32,904 [trainer.py] => prefix: asp
2025-01-05 15:37:32,904 [trainer.py] => model_prefix: asp
2025-01-05 15:37:34,658 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:38:13,830 [trainer.py] => All params: 173596160
2025-01-05 15:38:13,833 [trainer.py] => Trainable params: 1998848
2025-01-05 15:38:13,836 [asp.py] => Learning on 0-60
2025-01-05 15:38:14,008 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 15:39:24,165 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:39:24,165 [trainer.py] => model_name: asp
2025-01-05 15:39:24,165 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:39:24,165 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:39:24,165 [trainer.py] => seed: 2024
2025-01-05 15:39:24,165 [trainer.py] => dataset: cifar224
2025-01-05 15:39:24,165 [trainer.py] => init_cls: 60
2025-01-05 15:39:24,165 [trainer.py] => increment: 60
2025-01-05 15:39:24,165 [trainer.py] => kshot: 5
2025-01-05 15:39:24,165 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:39:24,165 [trainer.py] => z_dim: 1000
2025-01-05 15:39:24,165 [trainer.py] => conv_dim: 64
2025-01-05 15:39:24,165 [trainer.py] => img_size: 224
2025-01-05 15:39:24,165 [trainer.py] => generator_lr: 0.005
2025-01-05 15:39:24,165 [trainer.py] => pi: 100
2025-01-05 15:39:24,165 [trainer.py] => w_bn: 50.0
2025-01-05 15:39:24,165 [trainer.py] => w_noise: 0.001
2025-01-05 15:39:24,165 [trainer.py] => server_ss: 32
2025-01-05 15:39:24,165 [trainer.py] => bn_loss: 1
2025-01-05 15:39:24,165 [trainer.py] => noise: 1
2025-01-05 15:39:24,165 [trainer.py] => ie_loss: 1
2025-01-05 15:39:24,165 [trainer.py] => act_loss: 0
2025-01-05 15:39:24,165 [trainer.py] => w_ie: 1.0
2025-01-05 15:39:24,166 [trainer.py] => w_act: 0.1
2025-01-05 15:39:24,166 [trainer.py] => syn_size: 32
2025-01-05 15:39:24,166 [trainer.py] => need_syn_imgs: True
2025-01-05 15:39:24,166 [trainer.py] => g_local_bs: 5
2025-01-05 15:39:24,166 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:39:24,166 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:39:24,166 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:39:24,166 [trainer.py] => com_round_gen: 10
2025-01-05 15:39:24,166 [trainer.py] => vpt_type: Deep
2025-01-05 15:39:24,166 [trainer.py] => prompt_token_num: 6
2025-01-05 15:39:24,166 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:39:24,166 [trainer.py] => perturb_var: 1
2025-01-05 15:39:24,166 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:39:24,166 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:39:24,166 [trainer.py] => kl_weight: 0.001
2025-01-05 15:39:24,166 [trainer.py] => TIP_init: zero
2025-01-05 15:39:24,166 [trainer.py] => tuned_epoch: 10
2025-01-05 15:39:24,166 [trainer.py] => fs_epoch: 0
2025-01-05 15:39:24,166 [trainer.py] => init_lr: 0.01
2025-01-05 15:39:24,166 [trainer.py] => fs_lr: 0.001
2025-01-05 15:39:24,166 [trainer.py] => batch_size: 48
2025-01-05 15:39:24,166 [trainer.py] => fs_batch_size: 16
2025-01-05 15:39:24,166 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:39:24,166 [trainer.py] => min_lr: 0
2025-01-05 15:39:24,166 [trainer.py] => optimizer: sgd
2025-01-05 15:39:24,166 [trainer.py] => memory_size: 0
2025-01-05 15:39:24,166 [trainer.py] => memory_per_class: 0
2025-01-05 15:39:24,166 [trainer.py] => fixed_memory: False
2025-01-05 15:39:24,166 [trainer.py] => shuffle: False
2025-01-05 15:39:24,166 [trainer.py] => top_k: 5
2025-01-05 15:39:24,166 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_60/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:39:24,166 [trainer.py] => prefix: asp
2025-01-05 15:39:24,166 [trainer.py] => model_prefix: asp
2025-01-05 15:39:25,925 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:40:03,562 [trainer.py] => All params: 173596160
2025-01-05 15:40:03,564 [trainer.py] => Trainable params: 1998848
2025-01-05 15:40:03,566 [asp.py] => Learning on 0-60
2025-01-05 15:40:03,692 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 15:45:25,862 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:45:25,862 [trainer.py] => model_name: asp
2025-01-05 15:45:25,862 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:45:25,862 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:45:25,862 [trainer.py] => seed: 2024
2025-01-05 15:45:25,862 [trainer.py] => dataset: cifar224
2025-01-05 15:45:25,862 [trainer.py] => init_cls: 60
2025-01-05 15:45:25,862 [trainer.py] => increment: 60
2025-01-05 15:45:25,862 [trainer.py] => kshot: 5
2025-01-05 15:45:25,862 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:45:25,862 [trainer.py] => z_dim: 1000
2025-01-05 15:45:25,862 [trainer.py] => conv_dim: 64
2025-01-05 15:45:25,862 [trainer.py] => img_size: 224
2025-01-05 15:45:25,862 [trainer.py] => generator_lr: 0.005
2025-01-05 15:45:25,862 [trainer.py] => pi: 100
2025-01-05 15:45:25,862 [trainer.py] => w_bn: 50.0
2025-01-05 15:45:25,862 [trainer.py] => w_noise: 0.001
2025-01-05 15:45:25,862 [trainer.py] => server_ss: 32
2025-01-05 15:45:25,862 [trainer.py] => bn_loss: 1
2025-01-05 15:45:25,862 [trainer.py] => noise: 1
2025-01-05 15:45:25,863 [trainer.py] => ie_loss: 1
2025-01-05 15:45:25,863 [trainer.py] => act_loss: 0
2025-01-05 15:45:25,863 [trainer.py] => w_ie: 1.0
2025-01-05 15:45:25,863 [trainer.py] => w_act: 0.1
2025-01-05 15:45:25,863 [trainer.py] => syn_size: 32
2025-01-05 15:45:25,863 [trainer.py] => need_syn_imgs: True
2025-01-05 15:45:25,863 [trainer.py] => g_local_bs: 5
2025-01-05 15:45:25,863 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:45:25,863 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:45:25,863 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:45:25,863 [trainer.py] => com_round_gen: 10
2025-01-05 15:45:25,863 [trainer.py] => vpt_type: Deep
2025-01-05 15:45:25,863 [trainer.py] => prompt_token_num: 6
2025-01-05 15:45:25,863 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:45:25,863 [trainer.py] => perturb_var: 1
2025-01-05 15:45:25,863 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:45:25,863 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:45:25,863 [trainer.py] => kl_weight: 0.001
2025-01-05 15:45:25,863 [trainer.py] => TIP_init: zero
2025-01-05 15:45:25,863 [trainer.py] => tuned_epoch: 10
2025-01-05 15:45:25,863 [trainer.py] => fs_epoch: 0
2025-01-05 15:45:25,863 [trainer.py] => init_lr: 0.01
2025-01-05 15:45:25,863 [trainer.py] => fs_lr: 0.001
2025-01-05 15:45:25,863 [trainer.py] => batch_size: 48
2025-01-05 15:45:25,863 [trainer.py] => fs_batch_size: 16
2025-01-05 15:45:25,863 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:45:25,863 [trainer.py] => min_lr: 0
2025-01-05 15:45:25,863 [trainer.py] => optimizer: sgd
2025-01-05 15:45:25,863 [trainer.py] => memory_size: 0
2025-01-05 15:45:25,863 [trainer.py] => memory_per_class: 0
2025-01-05 15:45:25,864 [trainer.py] => fixed_memory: False
2025-01-05 15:45:25,864 [trainer.py] => shuffle: False
2025-01-05 15:45:25,864 [trainer.py] => top_k: 5
2025-01-05 15:45:25,864 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_60/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:45:25,864 [trainer.py] => prefix: asp
2025-01-05 15:45:25,864 [trainer.py] => model_prefix: asp
2025-01-05 15:45:27,799 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:46:06,883 [trainer.py] => All params: 173596160
2025-01-05 15:46:06,884 [trainer.py] => Trainable params: 1998848
2025-01-05 15:46:06,885 [asp.py] => Learning on 0-60
2025-01-05 15:46:07,052 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 15:47:20,751 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:47:20,751 [trainer.py] => model_name: asp
2025-01-05 15:47:20,751 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:47:20,751 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:47:20,751 [trainer.py] => seed: 2024
2025-01-05 15:47:20,751 [trainer.py] => dataset: cifar224
2025-01-05 15:47:20,751 [trainer.py] => init_cls: 60
2025-01-05 15:47:20,752 [trainer.py] => increment: 60
2025-01-05 15:47:20,752 [trainer.py] => kshot: 5
2025-01-05 15:47:20,752 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:47:20,752 [trainer.py] => z_dim: 1000
2025-01-05 15:47:20,752 [trainer.py] => conv_dim: 64
2025-01-05 15:47:20,752 [trainer.py] => img_size: 224
2025-01-05 15:47:20,752 [trainer.py] => generator_lr: 0.005
2025-01-05 15:47:20,752 [trainer.py] => pi: 100
2025-01-05 15:47:20,752 [trainer.py] => w_bn: 50.0
2025-01-05 15:47:20,752 [trainer.py] => w_noise: 0.001
2025-01-05 15:47:20,752 [trainer.py] => server_ss: 32
2025-01-05 15:47:20,752 [trainer.py] => bn_loss: 1
2025-01-05 15:47:20,752 [trainer.py] => noise: 1
2025-01-05 15:47:20,752 [trainer.py] => ie_loss: 1
2025-01-05 15:47:20,752 [trainer.py] => act_loss: 0
2025-01-05 15:47:20,752 [trainer.py] => w_ie: 1.0
2025-01-05 15:47:20,752 [trainer.py] => w_act: 0.1
2025-01-05 15:47:20,752 [trainer.py] => syn_size: 32
2025-01-05 15:47:20,752 [trainer.py] => need_syn_imgs: True
2025-01-05 15:47:20,752 [trainer.py] => g_local_bs: 5
2025-01-05 15:47:20,752 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:47:20,752 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:47:20,752 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:47:20,752 [trainer.py] => com_round_gen: 10
2025-01-05 15:47:20,752 [trainer.py] => g_sigma: 0
2025-01-05 15:47:20,752 [trainer.py] => vpt_type: Deep
2025-01-05 15:47:20,752 [trainer.py] => prompt_token_num: 6
2025-01-05 15:47:20,752 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:47:20,752 [trainer.py] => perturb_var: 1
2025-01-05 15:47:20,752 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:47:20,752 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:47:20,752 [trainer.py] => kl_weight: 0.001
2025-01-05 15:47:20,752 [trainer.py] => TIP_init: zero
2025-01-05 15:47:20,752 [trainer.py] => tuned_epoch: 10
2025-01-05 15:47:20,753 [trainer.py] => fs_epoch: 0
2025-01-05 15:47:20,753 [trainer.py] => init_lr: 0.01
2025-01-05 15:47:20,753 [trainer.py] => fs_lr: 0.001
2025-01-05 15:47:20,753 [trainer.py] => batch_size: 48
2025-01-05 15:47:20,753 [trainer.py] => fs_batch_size: 16
2025-01-05 15:47:20,753 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:47:20,753 [trainer.py] => min_lr: 0
2025-01-05 15:47:20,753 [trainer.py] => optimizer: sgd
2025-01-05 15:47:20,753 [trainer.py] => memory_size: 0
2025-01-05 15:47:20,753 [trainer.py] => memory_per_class: 0
2025-01-05 15:47:20,753 [trainer.py] => fixed_memory: False
2025-01-05 15:47:20,753 [trainer.py] => shuffle: False
2025-01-05 15:47:20,753 [trainer.py] => top_k: 5
2025-01-05 15:47:20,753 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_60/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:47:20,753 [trainer.py] => prefix: asp
2025-01-05 15:47:20,753 [trainer.py] => model_prefix: asp
2025-01-05 15:47:22,755 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:47:59,316 [trainer.py] => All params: 173596160
2025-01-05 15:47:59,317 [trainer.py] => Trainable params: 1998848
2025-01-05 15:47:59,317 [asp.py] => Learning on 0-60
2025-01-05 15:47:59,436 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 15:48:53,136 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:48:53,136 [trainer.py] => model_name: asp
2025-01-05 15:48:53,136 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:48:53,136 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:48:53,136 [trainer.py] => seed: 2024
2025-01-05 15:48:53,136 [trainer.py] => dataset: cifar224
2025-01-05 15:48:53,136 [trainer.py] => init_cls: 60
2025-01-05 15:48:53,136 [trainer.py] => increment: 60
2025-01-05 15:48:53,136 [trainer.py] => kshot: 5
2025-01-05 15:48:53,137 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:48:53,137 [trainer.py] => z_dim: 1000
2025-01-05 15:48:53,137 [trainer.py] => conv_dim: 64
2025-01-05 15:48:53,137 [trainer.py] => img_size: 224
2025-01-05 15:48:53,137 [trainer.py] => generator_lr: 0.005
2025-01-05 15:48:53,137 [trainer.py] => pi: 100
2025-01-05 15:48:53,137 [trainer.py] => w_bn: 50.0
2025-01-05 15:48:53,137 [trainer.py] => w_noise: 0.001
2025-01-05 15:48:53,137 [trainer.py] => server_ss: 32
2025-01-05 15:48:53,137 [trainer.py] => bn_loss: 1
2025-01-05 15:48:53,137 [trainer.py] => noise: 1
2025-01-05 15:48:53,137 [trainer.py] => ie_loss: 1
2025-01-05 15:48:53,137 [trainer.py] => act_loss: 0
2025-01-05 15:48:53,137 [trainer.py] => w_ie: 1.0
2025-01-05 15:48:53,137 [trainer.py] => w_act: 0.1
2025-01-05 15:48:53,137 [trainer.py] => syn_size: 32
2025-01-05 15:48:53,137 [trainer.py] => need_syn_imgs: True
2025-01-05 15:48:53,137 [trainer.py] => g_local_bs: 5
2025-01-05 15:48:53,137 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:48:53,138 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:48:53,138 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:48:53,138 [trainer.py] => com_round_gen: 10
2025-01-05 15:48:53,138 [trainer.py] => g_sigma: 0
2025-01-05 15:48:53,138 [trainer.py] => vpt_type: Deep
2025-01-05 15:48:53,138 [trainer.py] => prompt_token_num: 6
2025-01-05 15:48:53,138 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:48:53,138 [trainer.py] => perturb_var: 1
2025-01-05 15:48:53,138 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:48:53,138 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:48:53,138 [trainer.py] => kl_weight: 0.001
2025-01-05 15:48:53,138 [trainer.py] => TIP_init: zero
2025-01-05 15:48:53,138 [trainer.py] => tuned_epoch: 10
2025-01-05 15:48:53,138 [trainer.py] => fs_epoch: 0
2025-01-05 15:48:53,138 [trainer.py] => init_lr: 0.01
2025-01-05 15:48:53,138 [trainer.py] => fs_lr: 0.001
2025-01-05 15:48:53,138 [trainer.py] => batch_size: 48
2025-01-05 15:48:53,138 [trainer.py] => fs_batch_size: 16
2025-01-05 15:48:53,138 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:48:53,139 [trainer.py] => min_lr: 0
2025-01-05 15:48:53,139 [trainer.py] => optimizer: sgd
2025-01-05 15:48:53,139 [trainer.py] => memory_size: 0
2025-01-05 15:48:53,139 [trainer.py] => memory_per_class: 0
2025-01-05 15:48:53,139 [trainer.py] => fixed_memory: False
2025-01-05 15:48:53,139 [trainer.py] => shuffle: False
2025-01-05 15:48:53,139 [trainer.py] => top_k: 5
2025-01-05 15:48:53,139 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_60/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:48:53,139 [trainer.py] => prefix: asp
2025-01-05 15:48:53,139 [trainer.py] => model_prefix: asp
2025-01-05 15:48:55,130 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:49:31,622 [trainer.py] => All params: 173596160
2025-01-05 15:49:31,623 [trainer.py] => Trainable params: 1998848
2025-01-05 15:49:31,624 [asp.py] => Learning on 0-60
2025-01-05 15:49:31,811 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 15:51:16,089 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:51:16,089 [trainer.py] => model_name: asp
2025-01-05 15:51:16,089 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:51:16,090 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:51:16,090 [trainer.py] => seed: 2024
2025-01-05 15:51:16,090 [trainer.py] => dataset: cifar224
2025-01-05 15:51:16,090 [trainer.py] => init_cls: 60
2025-01-05 15:51:16,090 [trainer.py] => increment: 60
2025-01-05 15:51:16,090 [trainer.py] => kshot: 5
2025-01-05 15:51:16,090 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:51:16,090 [trainer.py] => z_dim: 1000
2025-01-05 15:51:16,090 [trainer.py] => conv_dim: 64
2025-01-05 15:51:16,090 [trainer.py] => img_size: 224
2025-01-05 15:51:16,090 [trainer.py] => generator_lr: 0.005
2025-01-05 15:51:16,090 [trainer.py] => pi: 100
2025-01-05 15:51:16,090 [trainer.py] => w_bn: 50.0
2025-01-05 15:51:16,090 [trainer.py] => w_noise: 0.001
2025-01-05 15:51:16,090 [trainer.py] => server_ss: 32
2025-01-05 15:51:16,090 [trainer.py] => bn_loss: 1
2025-01-05 15:51:16,090 [trainer.py] => noise: 1
2025-01-05 15:51:16,090 [trainer.py] => ie_loss: 1
2025-01-05 15:51:16,090 [trainer.py] => act_loss: 0
2025-01-05 15:51:16,090 [trainer.py] => w_ie: 1.0
2025-01-05 15:51:16,090 [trainer.py] => w_act: 0.1
2025-01-05 15:51:16,090 [trainer.py] => syn_size: 32
2025-01-05 15:51:16,090 [trainer.py] => need_syn_imgs: True
2025-01-05 15:51:16,090 [trainer.py] => g_local_bs: 5
2025-01-05 15:51:16,090 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:51:16,090 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:51:16,090 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:51:16,090 [trainer.py] => com_round_gen: 10
2025-01-05 15:51:16,090 [trainer.py] => g_sigma: 0
2025-01-05 15:51:16,090 [trainer.py] => save_cls_embeds: False
2025-01-05 15:51:16,090 [trainer.py] => vpt_type: Deep
2025-01-05 15:51:16,091 [trainer.py] => prompt_token_num: 6
2025-01-05 15:51:16,091 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:51:16,091 [trainer.py] => perturb_var: 1
2025-01-05 15:51:16,091 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:51:16,091 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:51:16,091 [trainer.py] => kl_weight: 0.001
2025-01-05 15:51:16,091 [trainer.py] => TIP_init: zero
2025-01-05 15:51:16,091 [trainer.py] => tuned_epoch: 10
2025-01-05 15:51:16,091 [trainer.py] => fs_epoch: 0
2025-01-05 15:51:16,091 [trainer.py] => init_lr: 0.01
2025-01-05 15:51:16,091 [trainer.py] => fs_lr: 0.001
2025-01-05 15:51:16,091 [trainer.py] => batch_size: 48
2025-01-05 15:51:16,091 [trainer.py] => fs_batch_size: 16
2025-01-05 15:51:16,091 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:51:16,091 [trainer.py] => min_lr: 0
2025-01-05 15:51:16,091 [trainer.py] => optimizer: sgd
2025-01-05 15:51:16,091 [trainer.py] => memory_size: 0
2025-01-05 15:51:16,091 [trainer.py] => memory_per_class: 0
2025-01-05 15:51:16,091 [trainer.py] => fixed_memory: False
2025-01-05 15:51:16,091 [trainer.py] => shuffle: False
2025-01-05 15:51:16,091 [trainer.py] => top_k: 5
2025-01-05 15:51:16,091 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_60/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:51:16,091 [trainer.py] => prefix: asp
2025-01-05 15:51:16,091 [trainer.py] => model_prefix: asp
2025-01-05 15:51:17,936 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:51:55,344 [trainer.py] => All params: 173596160
2025-01-05 15:51:55,345 [trainer.py] => Trainable params: 1998848
2025-01-05 15:51:55,346 [asp.py] => Learning on 0-60
2025-01-05 15:51:55,806 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 15:56:38,110 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:56:38,111 [trainer.py] => model_name: asp
2025-01-05 15:56:38,111 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:56:38,111 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:56:38,111 [trainer.py] => seed: 2024
2025-01-05 15:56:38,111 [trainer.py] => dataset: cifar224
2025-01-05 15:56:38,111 [trainer.py] => init_cls: 60
2025-01-05 15:56:38,111 [trainer.py] => increment: 60
2025-01-05 15:56:38,111 [trainer.py] => kshot: 5
2025-01-05 15:56:38,111 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:56:38,111 [trainer.py] => z_dim: 1000
2025-01-05 15:56:38,111 [trainer.py] => conv_dim: 64
2025-01-05 15:56:38,111 [trainer.py] => img_size: 224
2025-01-05 15:56:38,111 [trainer.py] => generator_lr: 0.005
2025-01-05 15:56:38,111 [trainer.py] => pi: 100
2025-01-05 15:56:38,111 [trainer.py] => w_bn: 50.0
2025-01-05 15:56:38,111 [trainer.py] => w_noise: 0.001
2025-01-05 15:56:38,111 [trainer.py] => server_ss: 32
2025-01-05 15:56:38,111 [trainer.py] => bn_loss: 1
2025-01-05 15:56:38,111 [trainer.py] => noise: 1
2025-01-05 15:56:38,111 [trainer.py] => ie_loss: 1
2025-01-05 15:56:38,111 [trainer.py] => act_loss: 0
2025-01-05 15:56:38,111 [trainer.py] => w_ie: 1.0
2025-01-05 15:56:38,111 [trainer.py] => w_act: 0.1
2025-01-05 15:56:38,112 [trainer.py] => syn_size: 32
2025-01-05 15:56:38,112 [trainer.py] => need_syn_imgs: True
2025-01-05 15:56:38,112 [trainer.py] => g_local_bs: 5
2025-01-05 15:56:38,112 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:56:38,112 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:56:38,112 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:56:38,112 [trainer.py] => com_round_gen: 10
2025-01-05 15:56:38,112 [trainer.py] => g_sigma: 0
2025-01-05 15:56:38,112 [trainer.py] => save_cls_embeds: False
2025-01-05 15:56:38,112 [trainer.py] => syn_image_path: None
2025-01-05 15:56:38,112 [trainer.py] => save_dir: outputs
2025-01-05 15:56:38,112 [trainer.py] => vpt_type: Deep
2025-01-05 15:56:38,112 [trainer.py] => prompt_token_num: 6
2025-01-05 15:56:38,112 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:56:38,112 [trainer.py] => perturb_var: 1
2025-01-05 15:56:38,112 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:56:38,112 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:56:38,112 [trainer.py] => kl_weight: 0.001
2025-01-05 15:56:38,112 [trainer.py] => TIP_init: zero
2025-01-05 15:56:38,112 [trainer.py] => tuned_epoch: 10
2025-01-05 15:56:38,112 [trainer.py] => fs_epoch: 0
2025-01-05 15:56:38,112 [trainer.py] => init_lr: 0.01
2025-01-05 15:56:38,112 [trainer.py] => fs_lr: 0.001
2025-01-05 15:56:38,112 [trainer.py] => batch_size: 48
2025-01-05 15:56:38,112 [trainer.py] => fs_batch_size: 16
2025-01-05 15:56:38,112 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:56:38,112 [trainer.py] => min_lr: 0
2025-01-05 15:56:38,112 [trainer.py] => optimizer: sgd
2025-01-05 15:56:38,112 [trainer.py] => memory_size: 0
2025-01-05 15:56:38,112 [trainer.py] => memory_per_class: 0
2025-01-05 15:56:38,113 [trainer.py] => fixed_memory: False
2025-01-05 15:56:38,113 [trainer.py] => shuffle: False
2025-01-05 15:56:38,113 [trainer.py] => top_k: 5
2025-01-05 15:56:38,113 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_60/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:56:38,113 [trainer.py] => prefix: asp
2025-01-05 15:56:38,113 [trainer.py] => model_prefix: asp
2025-01-05 15:56:39,699 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:57:15,257 [trainer.py] => All params: 173596160
2025-01-05 15:57:15,259 [trainer.py] => Trainable params: 1998848
2025-01-05 15:57:15,261 [asp.py] => Learning on 0-60
2025-01-05 15:57:15,397 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 16:00:15,826 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 16:00:15,826 [trainer.py] => model_name: asp
2025-01-05 16:00:15,826 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 16:00:15,826 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 16:00:15,826 [trainer.py] => seed: 2024
2025-01-05 16:00:15,826 [trainer.py] => dataset: cifar224
2025-01-05 16:00:15,826 [trainer.py] => init_cls: 60
2025-01-05 16:00:15,826 [trainer.py] => increment: 60
2025-01-05 16:00:15,826 [trainer.py] => kshot: 5
2025-01-05 16:00:15,826 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 16:00:15,826 [trainer.py] => z_dim: 1000
2025-01-05 16:00:15,826 [trainer.py] => conv_dim: 64
2025-01-05 16:00:15,826 [trainer.py] => img_size: 224
2025-01-05 16:00:15,826 [trainer.py] => generator_lr: 0.005
2025-01-05 16:00:15,826 [trainer.py] => pi: 100
2025-01-05 16:00:15,826 [trainer.py] => w_bn: 50.0
2025-01-05 16:00:15,826 [trainer.py] => w_noise: 0.001
2025-01-05 16:00:15,826 [trainer.py] => server_ss: 32
2025-01-05 16:00:15,826 [trainer.py] => bn_loss: 1
2025-01-05 16:00:15,827 [trainer.py] => noise: 1
2025-01-05 16:00:15,827 [trainer.py] => ie_loss: 1
2025-01-05 16:00:15,827 [trainer.py] => act_loss: 0
2025-01-05 16:00:15,827 [trainer.py] => w_ie: 1.0
2025-01-05 16:00:15,827 [trainer.py] => w_act: 0.1
2025-01-05 16:00:15,827 [trainer.py] => syn_size: 32
2025-01-05 16:00:15,827 [trainer.py] => need_syn_imgs: True
2025-01-05 16:00:15,827 [trainer.py] => g_local_bs: 5
2025-01-05 16:00:15,827 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 16:00:15,827 [trainer.py] => g_local_train_steps: 50
2025-01-05 16:00:15,827 [trainer.py] => dataset_syn: cifar100
2025-01-05 16:00:15,827 [trainer.py] => com_round_gen: 10
2025-01-05 16:00:15,827 [trainer.py] => g_sigma: 0
2025-01-05 16:00:15,827 [trainer.py] => save_cls_embeds: False
2025-01-05 16:00:15,827 [trainer.py] => syn_image_path: None
2025-01-05 16:00:15,827 [trainer.py] => save_dir: outputs
2025-01-05 16:00:15,827 [trainer.py] => n_iter: 5
2025-01-05 16:00:15,827 [trainer.py] => vpt_type: Deep
2025-01-05 16:00:15,827 [trainer.py] => prompt_token_num: 6
2025-01-05 16:00:15,827 [trainer.py] => avg_alpha: 0.8
2025-01-05 16:00:15,827 [trainer.py] => perturb_var: 1
2025-01-05 16:00:15,827 [trainer.py] => EMA_beta: 0.99
2025-01-05 16:00:15,827 [trainer.py] => anchor_lambda: 0.1
2025-01-05 16:00:15,827 [trainer.py] => kl_weight: 0.001
2025-01-05 16:00:15,828 [trainer.py] => TIP_init: zero
2025-01-05 16:00:15,828 [trainer.py] => tuned_epoch: 10
2025-01-05 16:00:15,828 [trainer.py] => fs_epoch: 0
2025-01-05 16:00:15,828 [trainer.py] => init_lr: 0.01
2025-01-05 16:00:15,828 [trainer.py] => fs_lr: 0.001
2025-01-05 16:00:15,828 [trainer.py] => batch_size: 48
2025-01-05 16:00:15,828 [trainer.py] => fs_batch_size: 16
2025-01-05 16:00:15,828 [trainer.py] => weight_decay: 0.0005
2025-01-05 16:00:15,828 [trainer.py] => min_lr: 0
2025-01-05 16:00:15,828 [trainer.py] => optimizer: sgd
2025-01-05 16:00:15,828 [trainer.py] => memory_size: 0
2025-01-05 16:00:15,828 [trainer.py] => memory_per_class: 0
2025-01-05 16:00:15,828 [trainer.py] => fixed_memory: False
2025-01-05 16:00:15,828 [trainer.py] => shuffle: False
2025-01-05 16:00:15,828 [trainer.py] => top_k: 5
2025-01-05 16:00:15,828 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_60/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 16:00:15,828 [trainer.py] => prefix: asp
2025-01-05 16:00:15,828 [trainer.py] => model_prefix: asp
2025-01-05 16:00:18,001 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 16:00:58,268 [trainer.py] => All params: 173596160
2025-01-05 16:00:58,269 [trainer.py] => Trainable params: 1998848
2025-01-05 16:00:58,270 [asp.py] => Learning on 0-60
2025-01-05 16:00:58,353 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 16:01:47,141 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 16:01:47,141 [trainer.py] => model_name: asp
2025-01-05 16:01:47,141 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 16:01:47,141 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 16:01:47,141 [trainer.py] => seed: 2024
2025-01-05 16:01:47,141 [trainer.py] => dataset: cifar224
2025-01-05 16:01:47,141 [trainer.py] => init_cls: 60
2025-01-05 16:01:47,142 [trainer.py] => increment: 60
2025-01-05 16:01:47,142 [trainer.py] => kshot: 5
2025-01-05 16:01:47,142 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 16:01:47,142 [trainer.py] => z_dim: 1000
2025-01-05 16:01:47,142 [trainer.py] => conv_dim: 64
2025-01-05 16:01:47,142 [trainer.py] => img_size: 224
2025-01-05 16:01:47,142 [trainer.py] => generator_lr: 0.005
2025-01-05 16:01:47,142 [trainer.py] => pi: 100
2025-01-05 16:01:47,142 [trainer.py] => w_bn: 50.0
2025-01-05 16:01:47,142 [trainer.py] => w_noise: 0.001
2025-01-05 16:01:47,142 [trainer.py] => server_ss: 32
2025-01-05 16:01:47,142 [trainer.py] => bn_loss: 1
2025-01-05 16:01:47,142 [trainer.py] => noise: 1
2025-01-05 16:01:47,142 [trainer.py] => ie_loss: 1
2025-01-05 16:01:47,142 [trainer.py] => act_loss: 0
2025-01-05 16:01:47,142 [trainer.py] => w_ie: 1.0
2025-01-05 16:01:47,142 [trainer.py] => w_act: 0.1
2025-01-05 16:01:47,142 [trainer.py] => syn_size: 32
2025-01-05 16:01:47,142 [trainer.py] => need_syn_imgs: True
2025-01-05 16:01:47,142 [trainer.py] => g_local_bs: 5
2025-01-05 16:01:47,142 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 16:01:47,142 [trainer.py] => g_local_train_steps: 50
2025-01-05 16:01:47,142 [trainer.py] => dataset_syn: cifar100
2025-01-05 16:01:47,142 [trainer.py] => com_round_gen: 10
2025-01-05 16:01:47,142 [trainer.py] => g_sigma: 0
2025-01-05 16:01:47,142 [trainer.py] => save_cls_embeds: False
2025-01-05 16:01:47,143 [trainer.py] => syn_image_path: None
2025-01-05 16:01:47,143 [trainer.py] => save_dir: outputs
2025-01-05 16:01:47,143 [trainer.py] => n_iter: 5
2025-01-05 16:01:47,143 [trainer.py] => vpt_type: Deep
2025-01-05 16:01:47,143 [trainer.py] => prompt_token_num: 6
2025-01-05 16:01:47,143 [trainer.py] => avg_alpha: 0.8
2025-01-05 16:01:47,143 [trainer.py] => perturb_var: 1
2025-01-05 16:01:47,143 [trainer.py] => EMA_beta: 0.99
2025-01-05 16:01:47,143 [trainer.py] => anchor_lambda: 0.1
2025-01-05 16:01:47,143 [trainer.py] => kl_weight: 0.001
2025-01-05 16:01:47,143 [trainer.py] => TIP_init: zero
2025-01-05 16:01:47,143 [trainer.py] => tuned_epoch: 10
2025-01-05 16:01:47,143 [trainer.py] => fs_epoch: 0
2025-01-05 16:01:47,143 [trainer.py] => init_lr: 0.01
2025-01-05 16:01:47,143 [trainer.py] => fs_lr: 0.001
2025-01-05 16:01:47,143 [trainer.py] => batch_size: 48
2025-01-05 16:01:47,143 [trainer.py] => fs_batch_size: 16
2025-01-05 16:01:47,143 [trainer.py] => weight_decay: 0.0005
2025-01-05 16:01:47,143 [trainer.py] => min_lr: 0
2025-01-05 16:01:47,143 [trainer.py] => optimizer: sgd
2025-01-05 16:01:47,143 [trainer.py] => memory_size: 0
2025-01-05 16:01:47,143 [trainer.py] => memory_per_class: 0
2025-01-05 16:01:47,143 [trainer.py] => fixed_memory: False
2025-01-05 16:01:47,143 [trainer.py] => shuffle: False
2025-01-05 16:01:47,143 [trainer.py] => top_k: 5
2025-01-05 16:01:47,143 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_60/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 16:01:47,143 [trainer.py] => prefix: asp
2025-01-05 16:01:47,143 [trainer.py] => model_prefix: asp
2025-01-05 16:01:49,066 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 16:02:24,630 [trainer.py] => All params: 173596160
2025-01-05 16:02:24,632 [trainer.py] => Trainable params: 1998848
2025-01-05 16:02:24,633 [asp.py] => Learning on 0-60
2025-01-05 16:02:24,756 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 16:33:35,141 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 16:33:35,141 [trainer.py] => model_name: asp
2025-01-05 16:33:35,141 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 16:33:35,142 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 16:33:35,142 [trainer.py] => seed: 2024
2025-01-05 16:33:35,142 [trainer.py] => dataset: cifar224
2025-01-05 16:33:35,142 [trainer.py] => init_cls: 60
2025-01-05 16:33:35,142 [trainer.py] => increment: 60
2025-01-05 16:33:35,142 [trainer.py] => kshot: 5
2025-01-05 16:33:35,142 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 16:33:35,142 [trainer.py] => z_dim: 1000
2025-01-05 16:33:35,142 [trainer.py] => conv_dim: 64
2025-01-05 16:33:35,142 [trainer.py] => img_size: 224
2025-01-05 16:33:35,142 [trainer.py] => generator_lr: 0.005
2025-01-05 16:33:35,142 [trainer.py] => pi: 100
2025-01-05 16:33:35,142 [trainer.py] => w_bn: 50.0
2025-01-05 16:33:35,142 [trainer.py] => w_noise: 0.001
2025-01-05 16:33:35,142 [trainer.py] => server_ss: 32
2025-01-05 16:33:35,142 [trainer.py] => bn_loss: 1
2025-01-05 16:33:35,142 [trainer.py] => noise: 1
2025-01-05 16:33:35,142 [trainer.py] => ie_loss: 1
2025-01-05 16:33:35,142 [trainer.py] => act_loss: 0
2025-01-05 16:33:35,143 [trainer.py] => w_ie: 1.0
2025-01-05 16:33:35,143 [trainer.py] => w_act: 0.1
2025-01-05 16:33:35,143 [trainer.py] => syn_size: 32
2025-01-05 16:33:35,143 [trainer.py] => need_syn_imgs: True
2025-01-05 16:33:35,143 [trainer.py] => g_local_bs: 5
2025-01-05 16:33:35,143 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 16:33:35,143 [trainer.py] => g_local_train_steps: 50
2025-01-05 16:33:35,143 [trainer.py] => dataset_syn: cifar100
2025-01-05 16:33:35,143 [trainer.py] => com_round_gen: 10
2025-01-05 16:33:35,143 [trainer.py] => g_sigma: 0
2025-01-05 16:33:35,143 [trainer.py] => save_cls_embeds: False
2025-01-05 16:33:35,143 [trainer.py] => syn_image_path: None
2025-01-05 16:33:35,143 [trainer.py] => save_dir: outputs
2025-01-05 16:33:35,143 [trainer.py] => n_iter: 5
2025-01-05 16:33:35,143 [trainer.py] => num_users: 1
2025-01-05 16:33:35,143 [trainer.py] => cur_size: 50
2025-01-05 16:33:35,143 [trainer.py] => vpt_type: Deep
2025-01-05 16:33:35,143 [trainer.py] => prompt_token_num: 6
2025-01-05 16:33:35,143 [trainer.py] => avg_alpha: 0.8
2025-01-05 16:33:35,144 [trainer.py] => perturb_var: 1
2025-01-05 16:33:35,144 [trainer.py] => EMA_beta: 0.99
2025-01-05 16:33:35,144 [trainer.py] => anchor_lambda: 0.1
2025-01-05 16:33:35,144 [trainer.py] => kl_weight: 0.001
2025-01-05 16:33:35,144 [trainer.py] => TIP_init: zero
2025-01-05 16:33:35,144 [trainer.py] => tuned_epoch: 10
2025-01-05 16:33:35,144 [trainer.py] => fs_epoch: 0
2025-01-05 16:33:35,144 [trainer.py] => init_lr: 0.01
2025-01-05 16:33:35,144 [trainer.py] => fs_lr: 0.001
2025-01-05 16:33:35,144 [trainer.py] => batch_size: 48
2025-01-05 16:33:35,144 [trainer.py] => fs_batch_size: 16
2025-01-05 16:33:35,144 [trainer.py] => weight_decay: 0.0005
2025-01-05 16:33:35,144 [trainer.py] => min_lr: 0
2025-01-05 16:33:35,144 [trainer.py] => optimizer: sgd
2025-01-05 16:33:35,144 [trainer.py] => memory_size: 0
2025-01-05 16:33:35,144 [trainer.py] => memory_per_class: 0
2025-01-05 16:33:35,144 [trainer.py] => fixed_memory: False
2025-01-05 16:33:35,144 [trainer.py] => shuffle: False
2025-01-05 16:33:35,144 [trainer.py] => top_k: 5
2025-01-05 16:33:35,144 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_60/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 16:33:35,144 [trainer.py] => prefix: asp
2025-01-05 16:33:35,145 [trainer.py] => model_prefix: asp
2025-01-05 16:33:36,963 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 16:34:31,929 [trainer.py] => All params: 173596160
2025-01-05 16:34:31,930 [trainer.py] => Trainable params: 1998848
2025-01-05 16:34:31,933 [asp.py] => Learning on 0-60
2025-01-05 16:34:32,069 [asp.py] => training set size: 30000, fc construct set size: 30000
