2025-01-09 11:29:27,407 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 11:29:27,407 [trainer.py] => model_name: asp
2025-01-09 11:29:27,407 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 11:29:27,407 [trainer.py] => device: ['cuda']
2025-01-09 11:29:27,407 [trainer.py] => seed: 2024
2025-01-09 11:29:27,407 [trainer.py] => dataset: cifar224
2025-01-09 11:29:27,407 [trainer.py] => init_cls: 5
2025-01-09 11:29:27,407 [trainer.py] => increment: 5
2025-01-09 11:29:27,407 [trainer.py] => kshot: 50
2025-01-09 11:29:27,407 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 11:29:27,407 [trainer.py] => z_dim: 1000
2025-01-09 11:29:27,407 [trainer.py] => conv_dim: 64
2025-01-09 11:29:27,407 [trainer.py] => img_size: 224
2025-01-09 11:29:27,407 [trainer.py] => generator_lr: 0.005
2025-01-09 11:29:27,407 [trainer.py] => pi: 100
2025-01-09 11:29:27,407 [trainer.py] => w_bn: 50.0
2025-01-09 11:29:27,407 [trainer.py] => w_noise: 0.001
2025-01-09 11:29:27,408 [trainer.py] => server_ss: 32
2025-01-09 11:29:27,408 [trainer.py] => bn_loss: 1
2025-01-09 11:29:27,408 [trainer.py] => noise: 1
2025-01-09 11:29:27,408 [trainer.py] => ie_loss: 1
2025-01-09 11:29:27,408 [trainer.py] => act_loss: 0
2025-01-09 11:29:27,408 [trainer.py] => w_ie: 1.0
2025-01-09 11:29:27,408 [trainer.py] => w_act: 0.1
2025-01-09 11:29:27,408 [trainer.py] => syn_size: 32
2025-01-09 11:29:27,408 [trainer.py] => need_syn_imgs: True
2025-01-09 11:29:27,408 [trainer.py] => g_local_bs: 42
2025-01-09 11:29:27,408 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 11:29:27,408 [trainer.py] => g_local_train_steps: 10
2025-01-09 11:29:27,408 [trainer.py] => dataset_syn: cifar100
2025-01-09 11:29:27,408 [trainer.py] => com_round_gen: 10
2025-01-09 11:29:27,408 [trainer.py] => g_sigma: 0
2025-01-09 11:29:27,408 [trainer.py] => save_cls_embeds: False
2025-01-09 11:29:27,408 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 11:29:27,408 [trainer.py] => save_dir: outputs
2025-01-09 11:29:27,408 [trainer.py] => n_iter: 5
2025-01-09 11:29:27,408 [trainer.py] => num_users: 1
2025-01-09 11:29:27,408 [trainer.py] => cur_size: 50
2025-01-09 11:29:27,408 [trainer.py] => local_bs: 5
2025-01-09 11:29:27,408 [trainer.py] => vpt_type: Deep
2025-01-09 11:29:27,408 [trainer.py] => prompt_token_num: 6
2025-01-09 11:29:27,408 [trainer.py] => avg_alpha: 0.8
2025-01-09 11:29:27,408 [trainer.py] => perturb_var: 1
2025-01-09 11:29:27,408 [trainer.py] => EMA_beta: 0.99
2025-01-09 11:29:27,408 [trainer.py] => anchor_lambda: 0.1
2025-01-09 11:29:27,408 [trainer.py] => kl_weight: 0.001
2025-01-09 11:29:27,408 [trainer.py] => TIP_init: zero
2025-01-09 11:29:27,408 [trainer.py] => tuned_epoch: 10
2025-01-09 11:29:27,409 [trainer.py] => fs_epoch: 0
2025-01-09 11:29:27,409 [trainer.py] => init_lr: 0.01
2025-01-09 11:29:27,409 [trainer.py] => fs_lr: 0.001
2025-01-09 11:29:27,409 [trainer.py] => batch_size: 48
2025-01-09 11:29:27,409 [trainer.py] => fs_batch_size: 16
2025-01-09 11:29:27,409 [trainer.py] => weight_decay: 0.0005
2025-01-09 11:29:27,409 [trainer.py] => min_lr: 0
2025-01-09 11:29:27,409 [trainer.py] => optimizer: sgd
2025-01-09 11:29:27,409 [trainer.py] => memory_size: 0
2025-01-09 11:29:27,409 [trainer.py] => memory_per_class: 0
2025-01-09 11:29:27,409 [trainer.py] => fixed_memory: False
2025-01-09 11:29:27,409 [trainer.py] => shuffle: False
2025-01-09 11:29:27,409 [trainer.py] => top_k: 5
2025-01-09 11:29:27,409 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 11:29:27,409 [trainer.py] => prefix: asp
2025-01-09 11:29:27,409 [trainer.py] => model_prefix: asp
2025-01-09 11:29:28,936 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 11:29:56,444 [trainer.py] => All params: 173596160
2025-01-09 11:29:56,446 [trainer.py] => Trainable params: 1998848
2025-01-09 11:29:56,447 [asp.py] => Learning on 0-5
2025-01-09 11:31:23,303 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 11:31:23,303 [trainer.py] => model_name: asp
2025-01-09 11:31:23,303 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 11:31:23,303 [trainer.py] => device: ['cuda']
2025-01-09 11:31:23,303 [trainer.py] => seed: 2024
2025-01-09 11:31:23,303 [trainer.py] => dataset: cifar224
2025-01-09 11:31:23,303 [trainer.py] => init_cls: 5
2025-01-09 11:31:23,303 [trainer.py] => increment: 5
2025-01-09 11:31:23,303 [trainer.py] => kshot: 50
2025-01-09 11:31:23,303 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 11:31:23,303 [trainer.py] => z_dim: 1000
2025-01-09 11:31:23,303 [trainer.py] => conv_dim: 64
2025-01-09 11:31:23,303 [trainer.py] => img_size: 224
2025-01-09 11:31:23,303 [trainer.py] => generator_lr: 0.005
2025-01-09 11:31:23,303 [trainer.py] => pi: 100
2025-01-09 11:31:23,303 [trainer.py] => w_bn: 50.0
2025-01-09 11:31:23,303 [trainer.py] => w_noise: 0.001
2025-01-09 11:31:23,303 [trainer.py] => server_ss: 32
2025-01-09 11:31:23,303 [trainer.py] => bn_loss: 1
2025-01-09 11:31:23,304 [trainer.py] => noise: 1
2025-01-09 11:31:23,304 [trainer.py] => ie_loss: 1
2025-01-09 11:31:23,304 [trainer.py] => act_loss: 0
2025-01-09 11:31:23,304 [trainer.py] => w_ie: 1.0
2025-01-09 11:31:23,304 [trainer.py] => w_act: 0.1
2025-01-09 11:31:23,304 [trainer.py] => syn_size: 32
2025-01-09 11:31:23,304 [trainer.py] => need_syn_imgs: True
2025-01-09 11:31:23,304 [trainer.py] => g_local_bs: 42
2025-01-09 11:31:23,304 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 11:31:23,304 [trainer.py] => g_local_train_steps: 10
2025-01-09 11:31:23,304 [trainer.py] => dataset_syn: cifar100
2025-01-09 11:31:23,304 [trainer.py] => com_round_gen: 10
2025-01-09 11:31:23,304 [trainer.py] => g_sigma: 0
2025-01-09 11:31:23,304 [trainer.py] => save_cls_embeds: False
2025-01-09 11:31:23,304 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 11:31:23,304 [trainer.py] => save_dir: outputs
2025-01-09 11:31:23,304 [trainer.py] => n_iter: 5
2025-01-09 11:31:23,304 [trainer.py] => num_users: 1
2025-01-09 11:31:23,304 [trainer.py] => cur_size: 50
2025-01-09 11:31:23,304 [trainer.py] => local_bs: 5
2025-01-09 11:31:23,304 [trainer.py] => vpt_type: Deep
2025-01-09 11:31:23,304 [trainer.py] => prompt_token_num: 6
2025-01-09 11:31:23,304 [trainer.py] => avg_alpha: 0.8
2025-01-09 11:31:23,304 [trainer.py] => perturb_var: 1
2025-01-09 11:31:23,304 [trainer.py] => EMA_beta: 0.99
2025-01-09 11:31:23,304 [trainer.py] => anchor_lambda: 0.1
2025-01-09 11:31:23,304 [trainer.py] => kl_weight: 0.001
2025-01-09 11:31:23,305 [trainer.py] => TIP_init: zero
2025-01-09 11:31:23,305 [trainer.py] => tuned_epoch: 10
2025-01-09 11:31:23,305 [trainer.py] => fs_epoch: 0
2025-01-09 11:31:23,305 [trainer.py] => init_lr: 0.01
2025-01-09 11:31:23,305 [trainer.py] => fs_lr: 0.001
2025-01-09 11:31:23,305 [trainer.py] => batch_size: 48
2025-01-09 11:31:23,305 [trainer.py] => fs_batch_size: 16
2025-01-09 11:31:23,305 [trainer.py] => weight_decay: 0.0005
2025-01-09 11:31:23,305 [trainer.py] => min_lr: 0
2025-01-09 11:31:23,305 [trainer.py] => optimizer: sgd
2025-01-09 11:31:23,305 [trainer.py] => memory_size: 0
2025-01-09 11:31:23,305 [trainer.py] => memory_per_class: 0
2025-01-09 11:31:23,305 [trainer.py] => fixed_memory: False
2025-01-09 11:31:23,305 [trainer.py] => shuffle: False
2025-01-09 11:31:23,305 [trainer.py] => top_k: 5
2025-01-09 11:31:23,305 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 11:31:23,305 [trainer.py] => prefix: asp
2025-01-09 11:31:23,305 [trainer.py] => model_prefix: asp
2025-01-09 11:31:24,872 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 11:31:49,742 [trainer.py] => All params: 173596160
2025-01-09 11:31:49,743 [trainer.py] => Trainable params: 1998848
2025-01-09 11:31:49,745 [asp.py] => Learning on 0-5
2025-01-09 11:32:08,029 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 11:32:08,029 [trainer.py] => model_name: asp
2025-01-09 11:32:08,029 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 11:32:08,029 [trainer.py] => device: ['cuda']
2025-01-09 11:32:08,029 [trainer.py] => seed: 2024
2025-01-09 11:32:08,029 [trainer.py] => dataset: cifar224
2025-01-09 11:32:08,029 [trainer.py] => init_cls: 5
2025-01-09 11:32:08,029 [trainer.py] => increment: 5
2025-01-09 11:32:08,029 [trainer.py] => kshot: 50
2025-01-09 11:32:08,029 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 11:32:08,029 [trainer.py] => z_dim: 1000
2025-01-09 11:32:08,029 [trainer.py] => conv_dim: 64
2025-01-09 11:32:08,029 [trainer.py] => img_size: 224
2025-01-09 11:32:08,029 [trainer.py] => generator_lr: 0.005
2025-01-09 11:32:08,030 [trainer.py] => pi: 100
2025-01-09 11:32:08,030 [trainer.py] => w_bn: 50.0
2025-01-09 11:32:08,030 [trainer.py] => w_noise: 0.001
2025-01-09 11:32:08,030 [trainer.py] => server_ss: 32
2025-01-09 11:32:08,030 [trainer.py] => bn_loss: 1
2025-01-09 11:32:08,030 [trainer.py] => noise: 1
2025-01-09 11:32:08,030 [trainer.py] => ie_loss: 1
2025-01-09 11:32:08,030 [trainer.py] => act_loss: 0
2025-01-09 11:32:08,030 [trainer.py] => w_ie: 1.0
2025-01-09 11:32:08,030 [trainer.py] => w_act: 0.1
2025-01-09 11:32:08,030 [trainer.py] => syn_size: 32
2025-01-09 11:32:08,030 [trainer.py] => need_syn_imgs: True
2025-01-09 11:32:08,030 [trainer.py] => g_local_bs: 42
2025-01-09 11:32:08,030 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 11:32:08,030 [trainer.py] => g_local_train_steps: 10
2025-01-09 11:32:08,030 [trainer.py] => dataset_syn: cifar100
2025-01-09 11:32:08,030 [trainer.py] => com_round_gen: 10
2025-01-09 11:32:08,030 [trainer.py] => g_sigma: 0
2025-01-09 11:32:08,030 [trainer.py] => save_cls_embeds: False
2025-01-09 11:32:08,030 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 11:32:08,030 [trainer.py] => save_dir: outputs
2025-01-09 11:32:08,030 [trainer.py] => n_iter: 5
2025-01-09 11:32:08,030 [trainer.py] => num_users: 1
2025-01-09 11:32:08,030 [trainer.py] => cur_size: 50
2025-01-09 11:32:08,030 [trainer.py] => local_bs: 5
2025-01-09 11:32:08,030 [trainer.py] => vpt_type: Deep
2025-01-09 11:32:08,031 [trainer.py] => prompt_token_num: 6
2025-01-09 11:32:08,031 [trainer.py] => avg_alpha: 0.8
2025-01-09 11:32:08,031 [trainer.py] => perturb_var: 1
2025-01-09 11:32:08,031 [trainer.py] => EMA_beta: 0.99
2025-01-09 11:32:08,031 [trainer.py] => anchor_lambda: 0.1
2025-01-09 11:32:08,031 [trainer.py] => kl_weight: 0.001
2025-01-09 11:32:08,031 [trainer.py] => TIP_init: zero
2025-01-09 11:32:08,031 [trainer.py] => tuned_epoch: 10
2025-01-09 11:32:08,031 [trainer.py] => fs_epoch: 0
2025-01-09 11:32:08,031 [trainer.py] => init_lr: 0.01
2025-01-09 11:32:08,031 [trainer.py] => fs_lr: 0.001
2025-01-09 11:32:08,031 [trainer.py] => batch_size: 48
2025-01-09 11:32:08,031 [trainer.py] => fs_batch_size: 16
2025-01-09 11:32:08,031 [trainer.py] => weight_decay: 0.0005
2025-01-09 11:32:08,031 [trainer.py] => min_lr: 0
2025-01-09 11:32:08,031 [trainer.py] => optimizer: sgd
2025-01-09 11:32:08,031 [trainer.py] => memory_size: 0
2025-01-09 11:32:08,031 [trainer.py] => memory_per_class: 0
2025-01-09 11:32:08,031 [trainer.py] => fixed_memory: False
2025-01-09 11:32:08,031 [trainer.py] => shuffle: False
2025-01-09 11:32:08,031 [trainer.py] => top_k: 5
2025-01-09 11:32:08,031 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 11:32:08,031 [trainer.py] => prefix: asp
2025-01-09 11:32:08,031 [trainer.py] => model_prefix: asp
2025-01-09 11:32:09,709 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 11:32:36,445 [trainer.py] => All params: 173596160
2025-01-09 11:32:36,447 [trainer.py] => Trainable params: 1998848
2025-01-09 11:32:36,448 [asp.py] => Learning on 0-5
2025-01-09 11:32:36,489 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 11:32:41,410 [trainer.py] => Top1 curve: [21.6]
2025-01-09 11:32:41,412 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-09 11:32:41,413 [trainer.py] => All params: 173600001
2025-01-09 11:32:41,414 [trainer.py] => Trainable params: 2002689
2025-01-09 11:32:41,415 [asp.py] => Learning on 5-10
2025-01-09 11:32:41,432 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:32:47,243 [trainer.py] => Top1 curve: [21.6, 10.8]
2025-01-09 11:32:47,244 [trainer.py] => Average Accuracy (Top1): 16.200000000000003   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:32:47,246 [trainer.py] => All params: 173603841
2025-01-09 11:32:47,246 [trainer.py] => Trainable params: 2006529
2025-01-09 11:32:47,247 [asp.py] => Learning on 10-15
2025-01-09 11:32:47,263 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:32:53,183 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 11:32:53,183 [trainer.py] => model_name: asp
2025-01-09 11:32:53,183 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 11:32:53,183 [trainer.py] => device: ['cuda']
2025-01-09 11:32:53,183 [trainer.py] => seed: 2024
2025-01-09 11:32:53,183 [trainer.py] => dataset: cifar224
2025-01-09 11:32:53,183 [trainer.py] => init_cls: 5
2025-01-09 11:32:53,183 [trainer.py] => increment: 5
2025-01-09 11:32:53,183 [trainer.py] => kshot: 50
2025-01-09 11:32:53,183 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 11:32:53,183 [trainer.py] => z_dim: 1000
2025-01-09 11:32:53,183 [trainer.py] => conv_dim: 64
2025-01-09 11:32:53,183 [trainer.py] => img_size: 224
2025-01-09 11:32:53,183 [trainer.py] => generator_lr: 0.005
2025-01-09 11:32:53,183 [trainer.py] => pi: 100
2025-01-09 11:32:53,183 [trainer.py] => w_bn: 50.0
2025-01-09 11:32:53,183 [trainer.py] => w_noise: 0.001
2025-01-09 11:32:53,183 [trainer.py] => server_ss: 32
2025-01-09 11:32:53,183 [trainer.py] => bn_loss: 1
2025-01-09 11:32:53,183 [trainer.py] => noise: 1
2025-01-09 11:32:53,183 [trainer.py] => ie_loss: 1
2025-01-09 11:32:53,183 [trainer.py] => act_loss: 0
2025-01-09 11:32:53,184 [trainer.py] => w_ie: 1.0
2025-01-09 11:32:53,184 [trainer.py] => w_act: 0.1
2025-01-09 11:32:53,184 [trainer.py] => syn_size: 32
2025-01-09 11:32:53,184 [trainer.py] => need_syn_imgs: True
2025-01-09 11:32:53,184 [trainer.py] => g_local_bs: 42
2025-01-09 11:32:53,184 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 11:32:53,184 [trainer.py] => g_local_train_steps: 10
2025-01-09 11:32:53,184 [trainer.py] => dataset_syn: cifar100
2025-01-09 11:32:53,184 [trainer.py] => com_round_gen: 10
2025-01-09 11:32:53,184 [trainer.py] => g_sigma: 0
2025-01-09 11:32:53,184 [trainer.py] => save_cls_embeds: False
2025-01-09 11:32:53,184 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 11:32:53,184 [trainer.py] => save_dir: outputs
2025-01-09 11:32:53,184 [trainer.py] => n_iter: 5
2025-01-09 11:32:53,184 [trainer.py] => num_users: 1
2025-01-09 11:32:53,184 [trainer.py] => cur_size: 50
2025-01-09 11:32:53,184 [trainer.py] => local_bs: 5
2025-01-09 11:32:53,184 [trainer.py] => vpt_type: Deep
2025-01-09 11:32:53,184 [trainer.py] => prompt_token_num: 6
2025-01-09 11:32:53,184 [trainer.py] => avg_alpha: 0.8
2025-01-09 11:32:53,184 [trainer.py] => perturb_var: 1
2025-01-09 11:32:53,184 [trainer.py] => EMA_beta: 0.99
2025-01-09 11:32:53,184 [trainer.py] => anchor_lambda: 0.1
2025-01-09 11:32:53,184 [trainer.py] => kl_weight: 0.001
2025-01-09 11:32:53,184 [trainer.py] => TIP_init: zero
2025-01-09 11:32:53,184 [trainer.py] => tuned_epoch: 10
2025-01-09 11:32:53,184 [trainer.py] => fs_epoch: 0
2025-01-09 11:32:53,184 [trainer.py] => init_lr: 0.01
2025-01-09 11:32:53,184 [trainer.py] => fs_lr: 0.001
2025-01-09 11:32:53,184 [trainer.py] => batch_size: 48
2025-01-09 11:32:53,185 [trainer.py] => fs_batch_size: 16
2025-01-09 11:32:53,185 [trainer.py] => weight_decay: 0.0005
2025-01-09 11:32:53,185 [trainer.py] => min_lr: 0
2025-01-09 11:32:53,185 [trainer.py] => optimizer: sgd
2025-01-09 11:32:53,185 [trainer.py] => memory_size: 0
2025-01-09 11:32:53,185 [trainer.py] => memory_per_class: 0
2025-01-09 11:32:53,185 [trainer.py] => fixed_memory: False
2025-01-09 11:32:53,185 [trainer.py] => shuffle: False
2025-01-09 11:32:53,185 [trainer.py] => top_k: 5
2025-01-09 11:32:53,185 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 11:32:53,185 [trainer.py] => prefix: asp
2025-01-09 11:32:53,185 [trainer.py] => model_prefix: asp
2025-01-09 11:32:54,690 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 11:32:55,369 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2]
2025-01-09 11:32:55,371 [trainer.py] => Average Accuracy (Top1): 13.200000000000003   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:32:55,372 [trainer.py] => All params: 173607681
2025-01-09 11:32:55,373 [trainer.py] => Trainable params: 2010369
2025-01-09 11:32:55,374 [asp.py] => Learning on 15-20
2025-01-09 11:32:55,391 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:33:05,702 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4]
2025-01-09 11:33:05,704 [trainer.py] => Average Accuracy (Top1): 11.250000000000002   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:33:05,705 [trainer.py] => All params: 173611521
2025-01-09 11:33:05,706 [trainer.py] => Trainable params: 2014209
2025-01-09 11:33:05,707 [asp.py] => Learning on 20-25
2025-01-09 11:33:05,724 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:33:18,680 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32]
2025-01-09 11:33:18,682 [trainer.py] => Average Accuracy (Top1): 9.864   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:33:18,683 [trainer.py] => All params: 173615361
2025-01-09 11:33:18,684 [trainer.py] => Trainable params: 2018049
2025-01-09 11:33:18,685 [asp.py] => Learning on 25-30
2025-01-09 11:33:18,706 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:33:22,643 [trainer.py] => All params: 173596160
2025-01-09 11:33:22,644 [trainer.py] => Trainable params: 1998848
2025-01-09 11:33:22,644 [asp.py] => Learning on 0-5
2025-01-09 11:33:22,649 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 11:33:33,821 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6]
2025-01-09 11:33:33,822 [trainer.py] => Average Accuracy (Top1): 8.820000000000002   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:33:33,823 [trainer.py] => All params: 173619201
2025-01-09 11:33:33,823 [trainer.py] => Trainable params: 2021889
2025-01-09 11:33:33,825 [asp.py] => Learning on 30-35
2025-01-09 11:33:33,848 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:33:50,908 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09]
2025-01-09 11:33:50,909 [trainer.py] => Average Accuracy (Top1): 8.001428571428573   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:33:50,911 [trainer.py] => All params: 173623041
2025-01-09 11:33:50,912 [trainer.py] => Trainable params: 2025729
2025-01-09 11:33:50,913 [asp.py] => Learning on 35-40
2025-01-09 11:33:50,938 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:34:10,489 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7]
2025-01-09 11:34:10,489 [trainer.py] => Average Accuracy (Top1): 7.338750000000001   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:34:10,491 [trainer.py] => All params: 173626881
2025-01-09 11:34:10,491 [trainer.py] => Trainable params: 2029569
2025-01-09 11:34:10,493 [asp.py] => Learning on 40-45
2025-01-09 11:34:10,531 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:34:32,694 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4]
2025-01-09 11:34:32,695 [trainer.py] => Average Accuracy (Top1): 6.790000000000001   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:34:32,697 [trainer.py] => All params: 173630721
2025-01-09 11:34:32,697 [trainer.py] => Trainable params: 2033409
2025-01-09 11:34:32,698 [asp.py] => Learning on 45-50
2025-01-09 11:34:32,711 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:34:57,282 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16]
2025-01-09 11:34:57,284 [trainer.py] => Average Accuracy (Top1): 6.327000000000001   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:34:57,286 [trainer.py] => All params: 173634561
2025-01-09 11:34:57,286 [trainer.py] => Trainable params: 2037249
2025-01-09 11:34:57,288 [asp.py] => Learning on 50-55
2025-01-09 11:34:57,322 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:35:24,794 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16, 1.96]
2025-01-09 11:35:24,795 [trainer.py] => Average Accuracy (Top1): 5.930000000000001   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:35:24,797 [trainer.py] => All params: 173638401
2025-01-09 11:35:24,798 [trainer.py] => Trainable params: 2041089
2025-01-09 11:35:24,799 [asp.py] => Learning on 55-60
2025-01-09 11:35:24,812 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:35:54,480 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16, 1.96, 1.8]
2025-01-09 11:35:54,481 [trainer.py] => Average Accuracy (Top1): 5.585833333333333   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:35:54,483 [trainer.py] => All params: 173642241
2025-01-09 11:35:54,483 [trainer.py] => Trainable params: 2044929
2025-01-09 11:35:54,484 [asp.py] => Learning on 60-65
2025-01-09 11:35:54,499 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:36:26,305 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16, 1.96, 1.8, 1.66]
2025-01-09 11:36:26,306 [trainer.py] => Average Accuracy (Top1): 5.283846153846154   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:36:26,307 [trainer.py] => All params: 173646081
2025-01-09 11:36:26,308 [trainer.py] => Trainable params: 2048769
2025-01-09 11:36:26,310 [asp.py] => Learning on 65-70
2025-01-09 11:36:26,333 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:37:00,516 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16, 1.96, 1.8, 1.66, 1.54]
2025-01-09 11:37:00,517 [trainer.py] => Average Accuracy (Top1): 5.0164285714285715   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:37:00,518 [trainer.py] => All params: 173649921
2025-01-09 11:37:00,519 [trainer.py] => Trainable params: 2052609
2025-01-09 11:37:00,520 [asp.py] => Learning on 70-75
2025-01-09 11:37:00,533 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:37:07,699 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 11:37:07,699 [trainer.py] => model_name: asp
2025-01-09 11:37:07,699 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 11:37:07,699 [trainer.py] => device: ['cuda']
2025-01-09 11:37:07,699 [trainer.py] => seed: 2024
2025-01-09 11:37:07,700 [trainer.py] => dataset: cifar224
2025-01-09 11:37:07,700 [trainer.py] => init_cls: 5
2025-01-09 11:37:07,700 [trainer.py] => increment: 5
2025-01-09 11:37:07,700 [trainer.py] => kshot: 50
2025-01-09 11:37:07,700 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 11:37:07,700 [trainer.py] => z_dim: 1000
2025-01-09 11:37:07,700 [trainer.py] => conv_dim: 64
2025-01-09 11:37:07,700 [trainer.py] => img_size: 224
2025-01-09 11:37:07,700 [trainer.py] => generator_lr: 0.005
2025-01-09 11:37:07,700 [trainer.py] => pi: 100
2025-01-09 11:37:07,700 [trainer.py] => w_bn: 50.0
2025-01-09 11:37:07,700 [trainer.py] => w_noise: 0.001
2025-01-09 11:37:07,700 [trainer.py] => server_ss: 32
2025-01-09 11:37:07,700 [trainer.py] => bn_loss: 1
2025-01-09 11:37:07,700 [trainer.py] => noise: 1
2025-01-09 11:37:07,700 [trainer.py] => ie_loss: 1
2025-01-09 11:37:07,700 [trainer.py] => act_loss: 0
2025-01-09 11:37:07,700 [trainer.py] => w_ie: 1.0
2025-01-09 11:37:07,700 [trainer.py] => w_act: 0.1
2025-01-09 11:37:07,700 [trainer.py] => syn_size: 32
2025-01-09 11:37:07,700 [trainer.py] => need_syn_imgs: True
2025-01-09 11:37:07,700 [trainer.py] => g_local_bs: 42
2025-01-09 11:37:07,700 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 11:37:07,700 [trainer.py] => g_local_train_steps: 10
2025-01-09 11:37:07,700 [trainer.py] => dataset_syn: cifar100
2025-01-09 11:37:07,700 [trainer.py] => com_round_gen: 10
2025-01-09 11:37:07,700 [trainer.py] => g_sigma: 0
2025-01-09 11:37:07,701 [trainer.py] => save_cls_embeds: False
2025-01-09 11:37:07,701 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 11:37:07,701 [trainer.py] => save_dir: outputs
2025-01-09 11:37:07,701 [trainer.py] => n_iter: 5
2025-01-09 11:37:07,701 [trainer.py] => num_users: 1
2025-01-09 11:37:07,701 [trainer.py] => cur_size: 50
2025-01-09 11:37:07,701 [trainer.py] => local_bs: 5
2025-01-09 11:37:07,701 [trainer.py] => vpt_type: Deep
2025-01-09 11:37:07,701 [trainer.py] => prompt_token_num: 6
2025-01-09 11:37:07,701 [trainer.py] => avg_alpha: 0.8
2025-01-09 11:37:07,701 [trainer.py] => perturb_var: 1
2025-01-09 11:37:07,701 [trainer.py] => EMA_beta: 0.99
2025-01-09 11:37:07,701 [trainer.py] => anchor_lambda: 0.1
2025-01-09 11:37:07,701 [trainer.py] => kl_weight: 0.001
2025-01-09 11:37:07,701 [trainer.py] => TIP_init: zero
2025-01-09 11:37:07,701 [trainer.py] => tuned_epoch: 10
2025-01-09 11:37:07,701 [trainer.py] => fs_epoch: 0
2025-01-09 11:37:07,701 [trainer.py] => init_lr: 0.01
2025-01-09 11:37:07,701 [trainer.py] => fs_lr: 0.001
2025-01-09 11:37:07,701 [trainer.py] => batch_size: 48
2025-01-09 11:37:07,701 [trainer.py] => fs_batch_size: 16
2025-01-09 11:37:07,701 [trainer.py] => weight_decay: 0.0005
2025-01-09 11:37:07,701 [trainer.py] => min_lr: 0
2025-01-09 11:37:07,701 [trainer.py] => optimizer: sgd
2025-01-09 11:37:07,702 [trainer.py] => memory_size: 0
2025-01-09 11:37:07,702 [trainer.py] => memory_per_class: 0
2025-01-09 11:37:07,702 [trainer.py] => fixed_memory: False
2025-01-09 11:37:07,702 [trainer.py] => shuffle: False
2025-01-09 11:37:07,702 [trainer.py] => top_k: 5
2025-01-09 11:37:07,702 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 11:37:07,702 [trainer.py] => prefix: asp
2025-01-09 11:37:07,702 [trainer.py] => model_prefix: asp
2025-01-09 11:37:09,438 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 11:37:38,112 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16, 1.96, 1.8, 1.66, 1.54, 1.44]
2025-01-09 11:37:38,113 [trainer.py] => Average Accuracy (Top1): 4.7780000000000005   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:37:38,114 [trainer.py] => All params: 173653761
2025-01-09 11:37:38,115 [trainer.py] => Trainable params: 2056449
2025-01-09 11:37:38,116 [asp.py] => Learning on 75-80
2025-01-09 11:37:38,131 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:37:38,210 [trainer.py] => All params: 173596160
2025-01-09 11:37:38,211 [trainer.py] => Trainable params: 1998848
2025-01-09 11:37:38,212 [asp.py] => Learning on 0-5
2025-01-09 11:37:38,218 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 11:38:17,254 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16, 1.96, 1.8, 1.66, 1.54, 1.44, 1.35]
2025-01-09 11:38:17,254 [trainer.py] => Average Accuracy (Top1): 4.56375   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:38:17,256 [trainer.py] => All params: 173657601
2025-01-09 11:38:17,256 [trainer.py] => Trainable params: 2060289
2025-01-09 11:38:17,259 [asp.py] => Learning on 80-85
2025-01-09 11:38:17,288 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:38:58,392 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16, 1.96, 1.8, 1.66, 1.54, 1.44, 1.35, 1.27]
2025-01-09 11:38:58,393 [trainer.py] => Average Accuracy (Top1): 4.369999999999999   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:38:58,395 [trainer.py] => All params: 173661441
2025-01-09 11:38:58,396 [trainer.py] => Trainable params: 2064129
2025-01-09 11:38:58,403 [asp.py] => Learning on 85-90
2025-01-09 11:38:58,490 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:39:42,085 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16, 1.96, 1.8, 1.66, 1.54, 1.44, 1.35, 1.27, 1.2]
2025-01-09 11:39:42,087 [trainer.py] => Average Accuracy (Top1): 4.193888888888889   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:39:42,088 [trainer.py] => All params: 173665281
2025-01-09 11:39:42,089 [trainer.py] => Trainable params: 2067969
2025-01-09 11:39:42,090 [asp.py] => Learning on 90-95
2025-01-09 11:39:42,124 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:40:27,934 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16, 1.96, 1.8, 1.66, 1.54, 1.44, 1.35, 1.27, 1.2, 1.14]
2025-01-09 11:40:27,938 [trainer.py] => Average Accuracy (Top1): 4.033157894736842   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:40:27,940 [trainer.py] => All params: 173669121
2025-01-09 11:40:27,941 [trainer.py] => Trainable params: 2071809
2025-01-09 11:40:27,942 [asp.py] => Learning on 95-100
2025-01-09 11:40:27,965 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 11:41:16,182 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16, 1.96, 1.8, 1.66, 1.54, 1.44, 1.35, 1.27, 1.2, 1.14, 1.08]
2025-01-09 11:41:16,183 [trainer.py] => Average Accuracy (Top1): 3.8854999999999995   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 11:41:16,183 [trainer.py] => 

2025-01-09 11:54:37,136 [trainer.py] => Top1 curve: [21.6]
2025-01-09 11:54:37,137 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-09 11:54:37,138 [trainer.py] => All params: 173600001
2025-01-09 11:54:37,138 [trainer.py] => Trainable params: 2002689
2025-01-09 11:54:37,140 [asp.py] => Learning on 5-10
2025-01-09 11:54:37,151 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 12:06:27,027 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:06:27,027 [trainer.py] => model_name: asp
2025-01-09 12:06:27,027 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:06:27,027 [trainer.py] => device: ['cuda']
2025-01-09 12:06:27,027 [trainer.py] => seed: 2024
2025-01-09 12:06:27,027 [trainer.py] => dataset: cifar224
2025-01-09 12:06:27,027 [trainer.py] => init_cls: 5
2025-01-09 12:06:27,027 [trainer.py] => increment: 5
2025-01-09 12:06:27,027 [trainer.py] => kshot: 50
2025-01-09 12:06:27,027 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:06:27,027 [trainer.py] => z_dim: 1000
2025-01-09 12:06:27,027 [trainer.py] => conv_dim: 64
2025-01-09 12:06:27,027 [trainer.py] => img_size: 224
2025-01-09 12:06:27,027 [trainer.py] => generator_lr: 0.005
2025-01-09 12:06:27,027 [trainer.py] => pi: 100
2025-01-09 12:06:27,027 [trainer.py] => w_bn: 50.0
2025-01-09 12:06:27,027 [trainer.py] => w_noise: 0.001
2025-01-09 12:06:27,027 [trainer.py] => server_ss: 32
2025-01-09 12:06:27,027 [trainer.py] => bn_loss: 1
2025-01-09 12:06:27,027 [trainer.py] => noise: 1
2025-01-09 12:06:27,027 [trainer.py] => ie_loss: 1
2025-01-09 12:06:27,028 [trainer.py] => act_loss: 0
2025-01-09 12:06:27,028 [trainer.py] => w_ie: 1.0
2025-01-09 12:06:27,028 [trainer.py] => w_act: 0.1
2025-01-09 12:06:27,028 [trainer.py] => syn_size: 32
2025-01-09 12:06:27,028 [trainer.py] => need_syn_imgs: True
2025-01-09 12:06:27,028 [trainer.py] => g_local_bs: 42
2025-01-09 12:06:27,028 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:06:27,028 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:06:27,028 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:06:27,028 [trainer.py] => com_round_gen: 10
2025-01-09 12:06:27,028 [trainer.py] => g_sigma: 0
2025-01-09 12:06:27,028 [trainer.py] => save_cls_embeds: False
2025-01-09 12:06:27,028 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:06:27,028 [trainer.py] => save_dir: outputs
2025-01-09 12:06:27,028 [trainer.py] => n_iter: 5
2025-01-09 12:06:27,028 [trainer.py] => num_users: 1
2025-01-09 12:06:27,028 [trainer.py] => cur_size: 50
2025-01-09 12:06:27,028 [trainer.py] => local_bs: 5
2025-01-09 12:06:27,028 [trainer.py] => vpt_type: Deep
2025-01-09 12:06:27,028 [trainer.py] => prompt_token_num: 6
2025-01-09 12:06:27,028 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:06:27,028 [trainer.py] => perturb_var: 1
2025-01-09 12:06:27,028 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:06:27,028 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:06:27,028 [trainer.py] => kl_weight: 0.001
2025-01-09 12:06:27,028 [trainer.py] => TIP_init: zero
2025-01-09 12:06:27,028 [trainer.py] => tuned_epoch: 10
2025-01-09 12:06:27,028 [trainer.py] => fs_epoch: 0
2025-01-09 12:06:27,028 [trainer.py] => init_lr: 0.01
2025-01-09 12:06:27,028 [trainer.py] => fs_lr: 0.001
2025-01-09 12:06:27,028 [trainer.py] => batch_size: 48
2025-01-09 12:06:27,028 [trainer.py] => fs_batch_size: 16
2025-01-09 12:06:27,028 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:06:27,029 [trainer.py] => min_lr: 0
2025-01-09 12:06:27,029 [trainer.py] => optimizer: sgd
2025-01-09 12:06:27,029 [trainer.py] => memory_size: 0
2025-01-09 12:06:27,029 [trainer.py] => memory_per_class: 0
2025-01-09 12:06:27,029 [trainer.py] => fixed_memory: False
2025-01-09 12:06:27,029 [trainer.py] => shuffle: False
2025-01-09 12:06:27,029 [trainer.py] => top_k: 5
2025-01-09 12:06:27,029 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:06:27,029 [trainer.py] => prefix: asp
2025-01-09 12:06:27,029 [trainer.py] => model_prefix: asp
2025-01-09 12:06:28,739 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:06:55,855 [trainer.py] => All params: 173596160
2025-01-09 12:06:55,856 [trainer.py] => Trainable params: 1998848
2025-01-09 12:06:55,860 [asp.py] => Learning on 0-5
2025-01-09 12:06:55,866 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 12:19:25,756 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:19:25,756 [trainer.py] => model_name: asp
2025-01-09 12:19:25,756 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:19:25,756 [trainer.py] => device: ['cuda']
2025-01-09 12:19:25,756 [trainer.py] => seed: 2024
2025-01-09 12:19:25,756 [trainer.py] => dataset: cifar224
2025-01-09 12:19:25,756 [trainer.py] => init_cls: 5
2025-01-09 12:19:25,757 [trainer.py] => increment: 5
2025-01-09 12:19:25,757 [trainer.py] => kshot: 50
2025-01-09 12:19:25,757 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:19:25,757 [trainer.py] => z_dim: 1000
2025-01-09 12:19:25,757 [trainer.py] => conv_dim: 64
2025-01-09 12:19:25,757 [trainer.py] => img_size: 224
2025-01-09 12:19:25,757 [trainer.py] => generator_lr: 0.005
2025-01-09 12:19:25,757 [trainer.py] => pi: 100
2025-01-09 12:19:25,757 [trainer.py] => w_bn: 50.0
2025-01-09 12:19:25,757 [trainer.py] => w_noise: 0.001
2025-01-09 12:19:25,757 [trainer.py] => server_ss: 32
2025-01-09 12:19:25,757 [trainer.py] => bn_loss: 1
2025-01-09 12:19:25,757 [trainer.py] => noise: 1
2025-01-09 12:19:25,757 [trainer.py] => ie_loss: 1
2025-01-09 12:19:25,757 [trainer.py] => act_loss: 0
2025-01-09 12:19:25,757 [trainer.py] => w_ie: 1.0
2025-01-09 12:19:25,757 [trainer.py] => w_act: 0.1
2025-01-09 12:19:25,757 [trainer.py] => syn_size: 32
2025-01-09 12:19:25,757 [trainer.py] => need_syn_imgs: True
2025-01-09 12:19:25,757 [trainer.py] => g_local_bs: 42
2025-01-09 12:19:25,757 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:19:25,757 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:19:25,757 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:19:25,757 [trainer.py] => com_round_gen: 10
2025-01-09 12:19:25,757 [trainer.py] => g_sigma: 0
2025-01-09 12:19:25,757 [trainer.py] => save_cls_embeds: False
2025-01-09 12:19:25,757 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:19:25,757 [trainer.py] => save_dir: outputs
2025-01-09 12:19:25,758 [trainer.py] => n_iter: 5
2025-01-09 12:19:25,758 [trainer.py] => num_users: 1
2025-01-09 12:19:25,758 [trainer.py] => cur_size: 50
2025-01-09 12:19:25,758 [trainer.py] => local_bs: 5
2025-01-09 12:19:25,758 [trainer.py] => vpt_type: Deep
2025-01-09 12:19:25,758 [trainer.py] => prompt_token_num: 6
2025-01-09 12:19:25,758 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:19:25,758 [trainer.py] => perturb_var: 1
2025-01-09 12:19:25,758 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:19:25,758 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:19:25,758 [trainer.py] => kl_weight: 0.001
2025-01-09 12:19:25,758 [trainer.py] => TIP_init: zero
2025-01-09 12:19:25,758 [trainer.py] => tuned_epoch: 10
2025-01-09 12:19:25,758 [trainer.py] => fs_epoch: 0
2025-01-09 12:19:25,758 [trainer.py] => init_lr: 0.01
2025-01-09 12:19:25,758 [trainer.py] => fs_lr: 0.001
2025-01-09 12:19:25,758 [trainer.py] => batch_size: 48
2025-01-09 12:19:25,758 [trainer.py] => fs_batch_size: 16
2025-01-09 12:19:25,758 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:19:25,758 [trainer.py] => min_lr: 0
2025-01-09 12:19:25,758 [trainer.py] => optimizer: sgd
2025-01-09 12:19:25,758 [trainer.py] => memory_size: 0
2025-01-09 12:19:25,758 [trainer.py] => memory_per_class: 0
2025-01-09 12:19:25,758 [trainer.py] => fixed_memory: False
2025-01-09 12:19:25,758 [trainer.py] => shuffle: False
2025-01-09 12:19:25,759 [trainer.py] => top_k: 5
2025-01-09 12:19:25,759 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:19:25,759 [trainer.py] => prefix: asp
2025-01-09 12:19:25,759 [trainer.py] => model_prefix: asp
2025-01-09 12:19:27,449 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:19:54,056 [trainer.py] => All params: 173596160
2025-01-09 12:19:54,057 [trainer.py] => Trainable params: 1998848
2025-01-09 12:19:54,060 [asp.py] => Learning on 0-5
2025-01-09 12:19:54,066 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 12:23:10,444 [trainer.py] => Top1 curve: [21.6]
2025-01-09 12:23:10,444 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-09 12:23:10,445 [trainer.py] => All params: 173600001
2025-01-09 12:23:10,446 [trainer.py] => Trainable params: 2002689
2025-01-09 12:23:10,447 [asp.py] => Learning on 5-10
2025-01-09 12:23:10,455 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 12:39:28,278 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:39:28,278 [trainer.py] => model_name: asp
2025-01-09 12:39:28,278 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:39:28,278 [trainer.py] => device: ['cuda']
2025-01-09 12:39:28,278 [trainer.py] => seed: 2024
2025-01-09 12:39:28,278 [trainer.py] => dataset: cifar224
2025-01-09 12:39:28,278 [trainer.py] => init_cls: 5
2025-01-09 12:39:28,278 [trainer.py] => increment: 5
2025-01-09 12:39:28,278 [trainer.py] => kshot: 50
2025-01-09 12:39:28,278 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:39:28,278 [trainer.py] => z_dim: 1000
2025-01-09 12:39:28,278 [trainer.py] => conv_dim: 64
2025-01-09 12:39:28,278 [trainer.py] => img_size: 224
2025-01-09 12:39:28,278 [trainer.py] => generator_lr: 0.005
2025-01-09 12:39:28,278 [trainer.py] => pi: 100
2025-01-09 12:39:28,278 [trainer.py] => w_bn: 50.0
2025-01-09 12:39:28,278 [trainer.py] => w_noise: 0.001
2025-01-09 12:39:28,278 [trainer.py] => server_ss: 32
2025-01-09 12:39:28,278 [trainer.py] => bn_loss: 1
2025-01-09 12:39:28,278 [trainer.py] => noise: 1
2025-01-09 12:39:28,278 [trainer.py] => ie_loss: 1
2025-01-09 12:39:28,279 [trainer.py] => act_loss: 0
2025-01-09 12:39:28,279 [trainer.py] => w_ie: 1.0
2025-01-09 12:39:28,279 [trainer.py] => w_act: 0.1
2025-01-09 12:39:28,279 [trainer.py] => syn_size: 32
2025-01-09 12:39:28,279 [trainer.py] => need_syn_imgs: True
2025-01-09 12:39:28,279 [trainer.py] => g_local_bs: 42
2025-01-09 12:39:28,279 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:39:28,279 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:39:28,279 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:39:28,279 [trainer.py] => com_round_gen: 10
2025-01-09 12:39:28,279 [trainer.py] => g_sigma: 0
2025-01-09 12:39:28,279 [trainer.py] => save_cls_embeds: False
2025-01-09 12:39:28,279 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:39:28,279 [trainer.py] => save_dir: outputs
2025-01-09 12:39:28,279 [trainer.py] => n_iter: 5
2025-01-09 12:39:28,279 [trainer.py] => num_users: 1
2025-01-09 12:39:28,279 [trainer.py] => cur_size: 50
2025-01-09 12:39:28,279 [trainer.py] => local_bs: 5
2025-01-09 12:39:28,279 [trainer.py] => vpt_type: Deep
2025-01-09 12:39:28,279 [trainer.py] => prompt_token_num: 6
2025-01-09 12:39:28,279 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:39:28,279 [trainer.py] => perturb_var: 1
2025-01-09 12:39:28,279 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:39:28,279 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:39:28,279 [trainer.py] => kl_weight: 0.001
2025-01-09 12:39:28,279 [trainer.py] => TIP_init: zero
2025-01-09 12:39:28,279 [trainer.py] => tuned_epoch: 10
2025-01-09 12:39:28,279 [trainer.py] => fs_epoch: 0
2025-01-09 12:39:28,279 [trainer.py] => init_lr: 0.01
2025-01-09 12:39:28,279 [trainer.py] => fs_lr: 0.001
2025-01-09 12:39:28,279 [trainer.py] => batch_size: 48
2025-01-09 12:39:28,279 [trainer.py] => fs_batch_size: 16
2025-01-09 12:39:28,280 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:39:28,280 [trainer.py] => min_lr: 0
2025-01-09 12:39:28,280 [trainer.py] => optimizer: sgd
2025-01-09 12:39:28,280 [trainer.py] => memory_size: 0
2025-01-09 12:39:28,280 [trainer.py] => memory_per_class: 0
2025-01-09 12:39:28,280 [trainer.py] => fixed_memory: False
2025-01-09 12:39:28,280 [trainer.py] => shuffle: False
2025-01-09 12:39:28,280 [trainer.py] => top_k: 5
2025-01-09 12:39:28,280 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:39:28,280 [trainer.py] => prefix: asp
2025-01-09 12:39:28,280 [trainer.py] => model_prefix: asp
2025-01-09 12:39:29,825 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:39:56,476 [trainer.py] => All params: 173596160
2025-01-09 12:39:56,477 [trainer.py] => Trainable params: 1998848
2025-01-09 12:39:56,478 [asp.py] => Learning on 0-5
2025-01-09 12:39:56,509 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 12:41:18,081 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:41:18,081 [trainer.py] => model_name: asp
2025-01-09 12:41:18,081 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:41:18,081 [trainer.py] => device: ['cuda']
2025-01-09 12:41:18,082 [trainer.py] => seed: 2024
2025-01-09 12:41:18,082 [trainer.py] => dataset: cifar224
2025-01-09 12:41:18,082 [trainer.py] => init_cls: 5
2025-01-09 12:41:18,082 [trainer.py] => increment: 5
2025-01-09 12:41:18,082 [trainer.py] => kshot: 50
2025-01-09 12:41:18,082 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:41:18,082 [trainer.py] => z_dim: 1000
2025-01-09 12:41:18,082 [trainer.py] => conv_dim: 64
2025-01-09 12:41:18,082 [trainer.py] => img_size: 224
2025-01-09 12:41:18,082 [trainer.py] => generator_lr: 0.005
2025-01-09 12:41:18,082 [trainer.py] => pi: 100
2025-01-09 12:41:18,082 [trainer.py] => w_bn: 50.0
2025-01-09 12:41:18,082 [trainer.py] => w_noise: 0.001
2025-01-09 12:41:18,082 [trainer.py] => server_ss: 32
2025-01-09 12:41:18,082 [trainer.py] => bn_loss: 1
2025-01-09 12:41:18,082 [trainer.py] => noise: 1
2025-01-09 12:41:18,082 [trainer.py] => ie_loss: 1
2025-01-09 12:41:18,082 [trainer.py] => act_loss: 0
2025-01-09 12:41:18,082 [trainer.py] => w_ie: 1.0
2025-01-09 12:41:18,082 [trainer.py] => w_act: 0.1
2025-01-09 12:41:18,082 [trainer.py] => syn_size: 32
2025-01-09 12:41:18,082 [trainer.py] => need_syn_imgs: True
2025-01-09 12:41:18,082 [trainer.py] => g_local_bs: 42
2025-01-09 12:41:18,082 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:41:18,082 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:41:18,082 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:41:18,082 [trainer.py] => com_round_gen: 10
2025-01-09 12:41:18,082 [trainer.py] => g_sigma: 0
2025-01-09 12:41:18,082 [trainer.py] => save_cls_embeds: False
2025-01-09 12:41:18,083 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:41:18,083 [trainer.py] => save_dir: outputs
2025-01-09 12:41:18,083 [trainer.py] => n_iter: 5
2025-01-09 12:41:18,083 [trainer.py] => num_users: 1
2025-01-09 12:41:18,083 [trainer.py] => cur_size: 50
2025-01-09 12:41:18,083 [trainer.py] => local_bs: 5
2025-01-09 12:41:18,083 [trainer.py] => vpt_type: Deep
2025-01-09 12:41:18,083 [trainer.py] => prompt_token_num: 6
2025-01-09 12:41:18,083 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:41:18,083 [trainer.py] => perturb_var: 1
2025-01-09 12:41:18,083 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:41:18,083 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:41:18,083 [trainer.py] => kl_weight: 0.001
2025-01-09 12:41:18,083 [trainer.py] => TIP_init: zero
2025-01-09 12:41:18,083 [trainer.py] => tuned_epoch: 10
2025-01-09 12:41:18,083 [trainer.py] => fs_epoch: 0
2025-01-09 12:41:18,083 [trainer.py] => init_lr: 0.01
2025-01-09 12:41:18,083 [trainer.py] => fs_lr: 0.001
2025-01-09 12:41:18,083 [trainer.py] => batch_size: 48
2025-01-09 12:41:18,083 [trainer.py] => fs_batch_size: 16
2025-01-09 12:41:18,083 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:41:18,083 [trainer.py] => min_lr: 0
2025-01-09 12:41:18,083 [trainer.py] => optimizer: sgd
2025-01-09 12:41:18,083 [trainer.py] => memory_size: 0
2025-01-09 12:41:18,083 [trainer.py] => memory_per_class: 0
2025-01-09 12:41:18,083 [trainer.py] => fixed_memory: False
2025-01-09 12:41:18,083 [trainer.py] => shuffle: False
2025-01-09 12:41:18,083 [trainer.py] => top_k: 5
2025-01-09 12:41:18,083 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:41:18,084 [trainer.py] => prefix: asp
2025-01-09 12:41:18,084 [trainer.py] => model_prefix: asp
2025-01-09 12:41:19,739 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:41:46,147 [trainer.py] => All params: 173596160
2025-01-09 12:41:46,148 [trainer.py] => Trainable params: 1998848
2025-01-09 12:41:46,149 [asp.py] => Learning on 0-5
2025-01-09 12:41:46,154 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 12:42:06,356 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:42:06,356 [trainer.py] => model_name: asp
2025-01-09 12:42:06,356 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:42:06,356 [trainer.py] => device: ['cuda']
2025-01-09 12:42:06,356 [trainer.py] => seed: 2024
2025-01-09 12:42:06,356 [trainer.py] => dataset: cifar224
2025-01-09 12:42:06,356 [trainer.py] => init_cls: 5
2025-01-09 12:42:06,356 [trainer.py] => increment: 5
2025-01-09 12:42:06,356 [trainer.py] => kshot: 50
2025-01-09 12:42:06,356 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:42:06,356 [trainer.py] => z_dim: 1000
2025-01-09 12:42:06,356 [trainer.py] => conv_dim: 64
2025-01-09 12:42:06,356 [trainer.py] => img_size: 224
2025-01-09 12:42:06,357 [trainer.py] => generator_lr: 0.005
2025-01-09 12:42:06,357 [trainer.py] => pi: 100
2025-01-09 12:42:06,357 [trainer.py] => w_bn: 50.0
2025-01-09 12:42:06,357 [trainer.py] => w_noise: 0.001
2025-01-09 12:42:06,357 [trainer.py] => server_ss: 32
2025-01-09 12:42:06,357 [trainer.py] => bn_loss: 1
2025-01-09 12:42:06,357 [trainer.py] => noise: 1
2025-01-09 12:42:06,357 [trainer.py] => ie_loss: 1
2025-01-09 12:42:06,357 [trainer.py] => act_loss: 0
2025-01-09 12:42:06,357 [trainer.py] => w_ie: 1.0
2025-01-09 12:42:06,357 [trainer.py] => w_act: 0.1
2025-01-09 12:42:06,357 [trainer.py] => syn_size: 32
2025-01-09 12:42:06,357 [trainer.py] => need_syn_imgs: True
2025-01-09 12:42:06,357 [trainer.py] => g_local_bs: 42
2025-01-09 12:42:06,357 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:42:06,357 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:42:06,357 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:42:06,357 [trainer.py] => com_round_gen: 10
2025-01-09 12:42:06,357 [trainer.py] => g_sigma: 0
2025-01-09 12:42:06,357 [trainer.py] => save_cls_embeds: False
2025-01-09 12:42:06,357 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:42:06,357 [trainer.py] => save_dir: outputs
2025-01-09 12:42:06,357 [trainer.py] => n_iter: 5
2025-01-09 12:42:06,357 [trainer.py] => num_users: 1
2025-01-09 12:42:06,357 [trainer.py] => cur_size: 50
2025-01-09 12:42:06,357 [trainer.py] => local_bs: 5
2025-01-09 12:42:06,357 [trainer.py] => vpt_type: Deep
2025-01-09 12:42:06,357 [trainer.py] => prompt_token_num: 6
2025-01-09 12:42:06,357 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:42:06,357 [trainer.py] => perturb_var: 1
2025-01-09 12:42:06,357 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:42:06,357 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:42:06,358 [trainer.py] => kl_weight: 0.001
2025-01-09 12:42:06,358 [trainer.py] => TIP_init: zero
2025-01-09 12:42:06,358 [trainer.py] => tuned_epoch: 10
2025-01-09 12:42:06,358 [trainer.py] => fs_epoch: 0
2025-01-09 12:42:06,358 [trainer.py] => init_lr: 0.01
2025-01-09 12:42:06,358 [trainer.py] => fs_lr: 0.001
2025-01-09 12:42:06,358 [trainer.py] => batch_size: 48
2025-01-09 12:42:06,358 [trainer.py] => fs_batch_size: 16
2025-01-09 12:42:06,358 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:42:06,358 [trainer.py] => min_lr: 0
2025-01-09 12:42:06,358 [trainer.py] => optimizer: sgd
2025-01-09 12:42:06,358 [trainer.py] => memory_size: 0
2025-01-09 12:42:06,358 [trainer.py] => memory_per_class: 0
2025-01-09 12:42:06,358 [trainer.py] => fixed_memory: False
2025-01-09 12:42:06,358 [trainer.py] => shuffle: False
2025-01-09 12:42:06,358 [trainer.py] => top_k: 5
2025-01-09 12:42:06,358 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:42:06,358 [trainer.py] => prefix: asp
2025-01-09 12:42:06,358 [trainer.py] => model_prefix: asp
2025-01-09 12:42:08,022 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:42:34,771 [trainer.py] => All params: 173596160
2025-01-09 12:42:34,772 [trainer.py] => Trainable params: 1998848
2025-01-09 12:43:33,816 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:43:33,816 [trainer.py] => model_name: asp
2025-01-09 12:43:33,816 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:43:33,816 [trainer.py] => device: ['cuda']
2025-01-09 12:43:33,816 [trainer.py] => seed: 2024
2025-01-09 12:43:33,816 [trainer.py] => dataset: cifar224
2025-01-09 12:43:33,816 [trainer.py] => init_cls: 5
2025-01-09 12:43:33,817 [trainer.py] => increment: 5
2025-01-09 12:43:33,817 [trainer.py] => kshot: 50
2025-01-09 12:43:33,817 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:43:33,817 [trainer.py] => z_dim: 1000
2025-01-09 12:43:33,817 [trainer.py] => conv_dim: 64
2025-01-09 12:43:33,817 [trainer.py] => img_size: 224
2025-01-09 12:43:33,817 [trainer.py] => generator_lr: 0.005
2025-01-09 12:43:33,817 [trainer.py] => pi: 100
2025-01-09 12:43:33,817 [trainer.py] => w_bn: 50.0
2025-01-09 12:43:33,817 [trainer.py] => w_noise: 0.001
2025-01-09 12:43:33,817 [trainer.py] => server_ss: 32
2025-01-09 12:43:33,817 [trainer.py] => bn_loss: 1
2025-01-09 12:43:33,817 [trainer.py] => noise: 1
2025-01-09 12:43:33,817 [trainer.py] => ie_loss: 1
2025-01-09 12:43:33,817 [trainer.py] => act_loss: 0
2025-01-09 12:43:33,817 [trainer.py] => w_ie: 1.0
2025-01-09 12:43:33,817 [trainer.py] => w_act: 0.1
2025-01-09 12:43:33,817 [trainer.py] => syn_size: 32
2025-01-09 12:43:33,817 [trainer.py] => need_syn_imgs: True
2025-01-09 12:43:33,817 [trainer.py] => g_local_bs: 42
2025-01-09 12:43:33,817 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:43:33,817 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:43:33,817 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:43:33,817 [trainer.py] => com_round_gen: 10
2025-01-09 12:43:33,817 [trainer.py] => g_sigma: 0
2025-01-09 12:43:33,817 [trainer.py] => save_cls_embeds: False
2025-01-09 12:43:33,817 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:43:33,817 [trainer.py] => save_dir: outputs
2025-01-09 12:43:33,817 [trainer.py] => n_iter: 5
2025-01-09 12:43:33,818 [trainer.py] => num_users: 1
2025-01-09 12:43:33,818 [trainer.py] => cur_size: 50
2025-01-09 12:43:33,818 [trainer.py] => local_bs: 5
2025-01-09 12:43:33,818 [trainer.py] => vpt_type: Deep
2025-01-09 12:43:33,818 [trainer.py] => prompt_token_num: 6
2025-01-09 12:43:33,818 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:43:33,818 [trainer.py] => perturb_var: 1
2025-01-09 12:43:33,818 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:43:33,818 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:43:33,818 [trainer.py] => kl_weight: 0.001
2025-01-09 12:43:33,818 [trainer.py] => TIP_init: zero
2025-01-09 12:43:33,818 [trainer.py] => tuned_epoch: 10
2025-01-09 12:43:33,818 [trainer.py] => fs_epoch: 0
2025-01-09 12:43:33,818 [trainer.py] => init_lr: 0.01
2025-01-09 12:43:33,818 [trainer.py] => fs_lr: 0.001
2025-01-09 12:43:33,818 [trainer.py] => batch_size: 48
2025-01-09 12:43:33,818 [trainer.py] => fs_batch_size: 16
2025-01-09 12:43:33,818 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:43:33,818 [trainer.py] => min_lr: 0
2025-01-09 12:43:33,818 [trainer.py] => optimizer: sgd
2025-01-09 12:43:33,818 [trainer.py] => memory_size: 0
2025-01-09 12:43:33,818 [trainer.py] => memory_per_class: 0
2025-01-09 12:43:33,818 [trainer.py] => fixed_memory: False
2025-01-09 12:43:33,818 [trainer.py] => shuffle: False
2025-01-09 12:43:33,818 [trainer.py] => top_k: 5
2025-01-09 12:43:33,818 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:43:33,818 [trainer.py] => prefix: asp
2025-01-09 12:43:33,818 [trainer.py] => model_prefix: asp
2025-01-09 12:43:35,599 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:44:03,613 [trainer.py] => All params: 173596160
2025-01-09 12:44:03,614 [trainer.py] => Trainable params: 1998848
2025-01-09 12:44:03,614 [asp.py] => Learning on 5-10
2025-01-09 12:44:03,623 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 12:44:42,232 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:44:42,232 [trainer.py] => model_name: asp
2025-01-09 12:44:42,232 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:44:42,232 [trainer.py] => device: ['cuda']
2025-01-09 12:44:42,232 [trainer.py] => seed: 2024
2025-01-09 12:44:42,232 [trainer.py] => dataset: cifar224
2025-01-09 12:44:42,232 [trainer.py] => init_cls: 5
2025-01-09 12:44:42,232 [trainer.py] => increment: 5
2025-01-09 12:44:42,232 [trainer.py] => kshot: 50
2025-01-09 12:44:42,232 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:44:42,232 [trainer.py] => z_dim: 1000
2025-01-09 12:44:42,232 [trainer.py] => conv_dim: 64
2025-01-09 12:44:42,232 [trainer.py] => img_size: 224
2025-01-09 12:44:42,232 [trainer.py] => generator_lr: 0.005
2025-01-09 12:44:42,232 [trainer.py] => pi: 100
2025-01-09 12:44:42,233 [trainer.py] => w_bn: 50.0
2025-01-09 12:44:42,233 [trainer.py] => w_noise: 0.001
2025-01-09 12:44:42,233 [trainer.py] => server_ss: 32
2025-01-09 12:44:42,233 [trainer.py] => bn_loss: 1
2025-01-09 12:44:42,233 [trainer.py] => noise: 1
2025-01-09 12:44:42,233 [trainer.py] => ie_loss: 1
2025-01-09 12:44:42,233 [trainer.py] => act_loss: 0
2025-01-09 12:44:42,233 [trainer.py] => w_ie: 1.0
2025-01-09 12:44:42,233 [trainer.py] => w_act: 0.1
2025-01-09 12:44:42,233 [trainer.py] => syn_size: 32
2025-01-09 12:44:42,233 [trainer.py] => need_syn_imgs: True
2025-01-09 12:44:42,233 [trainer.py] => g_local_bs: 42
2025-01-09 12:44:42,233 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:44:42,233 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:44:42,233 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:44:42,233 [trainer.py] => com_round_gen: 10
2025-01-09 12:44:42,233 [trainer.py] => g_sigma: 0
2025-01-09 12:44:42,233 [trainer.py] => save_cls_embeds: False
2025-01-09 12:44:42,233 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:44:42,233 [trainer.py] => save_dir: outputs
2025-01-09 12:44:42,233 [trainer.py] => n_iter: 5
2025-01-09 12:44:42,233 [trainer.py] => num_users: 1
2025-01-09 12:44:42,233 [trainer.py] => cur_size: 50
2025-01-09 12:44:42,233 [trainer.py] => local_bs: 5
2025-01-09 12:44:42,233 [trainer.py] => vpt_type: Deep
2025-01-09 12:44:42,233 [trainer.py] => prompt_token_num: 6
2025-01-09 12:44:42,233 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:44:42,233 [trainer.py] => perturb_var: 1
2025-01-09 12:44:42,233 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:44:42,233 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:44:42,233 [trainer.py] => kl_weight: 0.001
2025-01-09 12:44:42,234 [trainer.py] => TIP_init: zero
2025-01-09 12:44:42,234 [trainer.py] => tuned_epoch: 10
2025-01-09 12:44:42,234 [trainer.py] => fs_epoch: 0
2025-01-09 12:44:42,234 [trainer.py] => init_lr: 0.01
2025-01-09 12:44:42,234 [trainer.py] => fs_lr: 0.001
2025-01-09 12:44:42,234 [trainer.py] => batch_size: 48
2025-01-09 12:44:42,234 [trainer.py] => fs_batch_size: 16
2025-01-09 12:44:42,234 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:44:42,234 [trainer.py] => min_lr: 0
2025-01-09 12:44:42,234 [trainer.py] => optimizer: sgd
2025-01-09 12:44:42,234 [trainer.py] => memory_size: 0
2025-01-09 12:44:42,234 [trainer.py] => memory_per_class: 0
2025-01-09 12:44:42,234 [trainer.py] => fixed_memory: False
2025-01-09 12:44:42,234 [trainer.py] => shuffle: False
2025-01-09 12:44:42,234 [trainer.py] => top_k: 5
2025-01-09 12:44:42,234 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:44:42,234 [trainer.py] => prefix: asp
2025-01-09 12:44:42,234 [trainer.py] => model_prefix: asp
2025-01-09 12:44:43,859 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:45:09,275 [trainer.py] => All params: 173596160
2025-01-09 12:45:09,275 [trainer.py] => Trainable params: 1998848
2025-01-09 12:45:09,276 [asp.py] => Learning on 15-20
2025-01-09 12:45:09,285 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 12:45:28,668 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:45:28,668 [trainer.py] => model_name: asp
2025-01-09 12:45:28,668 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:45:28,668 [trainer.py] => device: ['cuda']
2025-01-09 12:45:28,668 [trainer.py] => seed: 2024
2025-01-09 12:45:28,668 [trainer.py] => dataset: cifar224
2025-01-09 12:45:28,668 [trainer.py] => init_cls: 5
2025-01-09 12:45:28,668 [trainer.py] => increment: 5
2025-01-09 12:45:28,668 [trainer.py] => kshot: 50
2025-01-09 12:45:28,668 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:45:28,668 [trainer.py] => z_dim: 1000
2025-01-09 12:45:28,668 [trainer.py] => conv_dim: 64
2025-01-09 12:45:28,668 [trainer.py] => img_size: 224
2025-01-09 12:45:28,668 [trainer.py] => generator_lr: 0.005
2025-01-09 12:45:28,668 [trainer.py] => pi: 100
2025-01-09 12:45:28,668 [trainer.py] => w_bn: 50.0
2025-01-09 12:45:28,668 [trainer.py] => w_noise: 0.001
2025-01-09 12:45:28,669 [trainer.py] => server_ss: 32
2025-01-09 12:45:28,669 [trainer.py] => bn_loss: 1
2025-01-09 12:45:28,669 [trainer.py] => noise: 1
2025-01-09 12:45:28,669 [trainer.py] => ie_loss: 1
2025-01-09 12:45:28,669 [trainer.py] => act_loss: 0
2025-01-09 12:45:28,669 [trainer.py] => w_ie: 1.0
2025-01-09 12:45:28,669 [trainer.py] => w_act: 0.1
2025-01-09 12:45:28,669 [trainer.py] => syn_size: 32
2025-01-09 12:45:28,669 [trainer.py] => need_syn_imgs: True
2025-01-09 12:45:28,669 [trainer.py] => g_local_bs: 42
2025-01-09 12:45:28,669 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:45:28,669 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:45:28,669 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:45:28,669 [trainer.py] => com_round_gen: 10
2025-01-09 12:45:28,669 [trainer.py] => g_sigma: 0
2025-01-09 12:45:28,669 [trainer.py] => save_cls_embeds: False
2025-01-09 12:45:28,669 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:45:28,669 [trainer.py] => save_dir: outputs
2025-01-09 12:45:28,669 [trainer.py] => n_iter: 5
2025-01-09 12:45:28,669 [trainer.py] => num_users: 1
2025-01-09 12:45:28,669 [trainer.py] => cur_size: 50
2025-01-09 12:45:28,669 [trainer.py] => local_bs: 5
2025-01-09 12:45:28,669 [trainer.py] => vpt_type: Deep
2025-01-09 12:45:28,669 [trainer.py] => prompt_token_num: 6
2025-01-09 12:45:28,669 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:45:28,669 [trainer.py] => perturb_var: 1
2025-01-09 12:45:28,669 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:45:28,669 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:45:28,669 [trainer.py] => kl_weight: 0.001
2025-01-09 12:45:28,669 [trainer.py] => TIP_init: zero
2025-01-09 12:45:28,669 [trainer.py] => tuned_epoch: 10
2025-01-09 12:45:28,670 [trainer.py] => fs_epoch: 0
2025-01-09 12:45:28,670 [trainer.py] => init_lr: 0.01
2025-01-09 12:45:28,670 [trainer.py] => fs_lr: 0.001
2025-01-09 12:45:28,670 [trainer.py] => batch_size: 48
2025-01-09 12:45:28,670 [trainer.py] => fs_batch_size: 16
2025-01-09 12:45:28,670 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:45:28,670 [trainer.py] => min_lr: 0
2025-01-09 12:45:28,670 [trainer.py] => optimizer: sgd
2025-01-09 12:45:28,670 [trainer.py] => memory_size: 0
2025-01-09 12:45:28,670 [trainer.py] => memory_per_class: 0
2025-01-09 12:45:28,670 [trainer.py] => fixed_memory: False
2025-01-09 12:45:28,670 [trainer.py] => shuffle: False
2025-01-09 12:45:28,670 [trainer.py] => top_k: 5
2025-01-09 12:45:28,670 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:45:28,670 [trainer.py] => prefix: asp
2025-01-09 12:45:28,670 [trainer.py] => model_prefix: asp
2025-01-09 12:45:30,222 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:46:11,203 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:46:11,203 [trainer.py] => model_name: asp
2025-01-09 12:46:11,203 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:46:11,203 [trainer.py] => device: ['cuda']
2025-01-09 12:46:11,203 [trainer.py] => seed: 2024
2025-01-09 12:46:11,203 [trainer.py] => dataset: cifar224
2025-01-09 12:46:11,203 [trainer.py] => init_cls: 5
2025-01-09 12:46:11,203 [trainer.py] => increment: 5
2025-01-09 12:46:11,203 [trainer.py] => kshot: 50
2025-01-09 12:46:11,203 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:46:11,203 [trainer.py] => z_dim: 1000
2025-01-09 12:46:11,203 [trainer.py] => conv_dim: 64
2025-01-09 12:46:11,203 [trainer.py] => img_size: 224
2025-01-09 12:46:11,203 [trainer.py] => generator_lr: 0.005
2025-01-09 12:46:11,203 [trainer.py] => pi: 100
2025-01-09 12:46:11,203 [trainer.py] => w_bn: 50.0
2025-01-09 12:46:11,203 [trainer.py] => w_noise: 0.001
2025-01-09 12:46:11,203 [trainer.py] => server_ss: 32
2025-01-09 12:46:11,203 [trainer.py] => bn_loss: 1
2025-01-09 12:46:11,203 [trainer.py] => noise: 1
2025-01-09 12:46:11,204 [trainer.py] => ie_loss: 1
2025-01-09 12:46:11,204 [trainer.py] => act_loss: 0
2025-01-09 12:46:11,204 [trainer.py] => w_ie: 1.0
2025-01-09 12:46:11,204 [trainer.py] => w_act: 0.1
2025-01-09 12:46:11,204 [trainer.py] => syn_size: 32
2025-01-09 12:46:11,204 [trainer.py] => need_syn_imgs: True
2025-01-09 12:46:11,204 [trainer.py] => g_local_bs: 42
2025-01-09 12:46:11,204 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:46:11,204 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:46:11,204 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:46:11,204 [trainer.py] => com_round_gen: 10
2025-01-09 12:46:11,204 [trainer.py] => g_sigma: 0
2025-01-09 12:46:11,204 [trainer.py] => save_cls_embeds: False
2025-01-09 12:46:11,204 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:46:11,204 [trainer.py] => save_dir: outputs
2025-01-09 12:46:11,204 [trainer.py] => n_iter: 5
2025-01-09 12:46:11,204 [trainer.py] => num_users: 1
2025-01-09 12:46:11,204 [trainer.py] => cur_size: 50
2025-01-09 12:46:11,204 [trainer.py] => local_bs: 5
2025-01-09 12:46:11,204 [trainer.py] => vpt_type: Deep
2025-01-09 12:46:11,204 [trainer.py] => prompt_token_num: 6
2025-01-09 12:46:11,204 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:46:11,204 [trainer.py] => perturb_var: 1
2025-01-09 12:46:11,204 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:46:11,204 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:46:11,204 [trainer.py] => kl_weight: 0.001
2025-01-09 12:46:11,204 [trainer.py] => TIP_init: zero
2025-01-09 12:46:11,204 [trainer.py] => tuned_epoch: 10
2025-01-09 12:46:11,204 [trainer.py] => fs_epoch: 0
2025-01-09 12:46:11,204 [trainer.py] => init_lr: 0.01
2025-01-09 12:46:11,204 [trainer.py] => fs_lr: 0.001
2025-01-09 12:46:11,204 [trainer.py] => batch_size: 48
2025-01-09 12:46:11,204 [trainer.py] => fs_batch_size: 16
2025-01-09 12:46:11,204 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:46:11,205 [trainer.py] => min_lr: 0
2025-01-09 12:46:11,205 [trainer.py] => optimizer: sgd
2025-01-09 12:46:11,205 [trainer.py] => memory_size: 0
2025-01-09 12:46:11,205 [trainer.py] => memory_per_class: 0
2025-01-09 12:46:11,205 [trainer.py] => fixed_memory: False
2025-01-09 12:46:11,205 [trainer.py] => shuffle: False
2025-01-09 12:46:11,205 [trainer.py] => top_k: 5
2025-01-09 12:46:11,205 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:46:11,205 [trainer.py] => prefix: asp
2025-01-09 12:46:11,205 [trainer.py] => model_prefix: asp
2025-01-09 12:46:12,799 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:46:38,204 [trainer.py] => All params: 173596160
2025-01-09 12:46:38,204 [trainer.py] => Trainable params: 1998848
2025-01-09 12:46:38,205 [asp.py] => Learning on 15-20
2025-01-09 12:46:38,211 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 12:46:55,479 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:46:55,480 [trainer.py] => model_name: asp
2025-01-09 12:46:55,480 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:46:55,480 [trainer.py] => device: ['cuda']
2025-01-09 12:46:55,480 [trainer.py] => seed: 2024
2025-01-09 12:46:55,480 [trainer.py] => dataset: cifar224
2025-01-09 12:46:55,480 [trainer.py] => init_cls: 5
2025-01-09 12:46:55,480 [trainer.py] => increment: 5
2025-01-09 12:46:55,480 [trainer.py] => kshot: 50
2025-01-09 12:46:55,480 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:46:55,480 [trainer.py] => z_dim: 1000
2025-01-09 12:46:55,480 [trainer.py] => conv_dim: 64
2025-01-09 12:46:55,480 [trainer.py] => img_size: 224
2025-01-09 12:46:55,480 [trainer.py] => generator_lr: 0.005
2025-01-09 12:46:55,480 [trainer.py] => pi: 100
2025-01-09 12:46:55,480 [trainer.py] => w_bn: 50.0
2025-01-09 12:46:55,480 [trainer.py] => w_noise: 0.001
2025-01-09 12:46:55,480 [trainer.py] => server_ss: 32
2025-01-09 12:46:55,480 [trainer.py] => bn_loss: 1
2025-01-09 12:46:55,480 [trainer.py] => noise: 1
2025-01-09 12:46:55,480 [trainer.py] => ie_loss: 1
2025-01-09 12:46:55,480 [trainer.py] => act_loss: 0
2025-01-09 12:46:55,480 [trainer.py] => w_ie: 1.0
2025-01-09 12:46:55,480 [trainer.py] => w_act: 0.1
2025-01-09 12:46:55,480 [trainer.py] => syn_size: 32
2025-01-09 12:46:55,480 [trainer.py] => need_syn_imgs: True
2025-01-09 12:46:55,480 [trainer.py] => g_local_bs: 42
2025-01-09 12:46:55,480 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:46:55,480 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:46:55,480 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:46:55,480 [trainer.py] => com_round_gen: 10
2025-01-09 12:46:55,481 [trainer.py] => g_sigma: 0
2025-01-09 12:46:55,481 [trainer.py] => save_cls_embeds: False
2025-01-09 12:46:55,481 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:46:55,481 [trainer.py] => save_dir: outputs
2025-01-09 12:46:55,481 [trainer.py] => n_iter: 5
2025-01-09 12:46:55,481 [trainer.py] => num_users: 1
2025-01-09 12:46:55,481 [trainer.py] => cur_size: 50
2025-01-09 12:46:55,481 [trainer.py] => local_bs: 5
2025-01-09 12:46:55,481 [trainer.py] => vpt_type: Deep
2025-01-09 12:46:55,481 [trainer.py] => prompt_token_num: 6
2025-01-09 12:46:55,481 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:46:55,481 [trainer.py] => perturb_var: 1
2025-01-09 12:46:55,481 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:46:55,481 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:46:55,481 [trainer.py] => kl_weight: 0.001
2025-01-09 12:46:55,481 [trainer.py] => TIP_init: zero
2025-01-09 12:46:55,481 [trainer.py] => tuned_epoch: 10
2025-01-09 12:46:55,481 [trainer.py] => fs_epoch: 0
2025-01-09 12:46:55,481 [trainer.py] => init_lr: 0.01
2025-01-09 12:46:55,481 [trainer.py] => fs_lr: 0.001
2025-01-09 12:46:55,481 [trainer.py] => batch_size: 48
2025-01-09 12:46:55,481 [trainer.py] => fs_batch_size: 16
2025-01-09 12:46:55,481 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:46:55,481 [trainer.py] => min_lr: 0
2025-01-09 12:46:55,481 [trainer.py] => optimizer: sgd
2025-01-09 12:46:55,481 [trainer.py] => memory_size: 0
2025-01-09 12:46:55,481 [trainer.py] => memory_per_class: 0
2025-01-09 12:46:55,481 [trainer.py] => fixed_memory: False
2025-01-09 12:46:55,481 [trainer.py] => shuffle: False
2025-01-09 12:46:55,481 [trainer.py] => top_k: 5
2025-01-09 12:46:55,481 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:46:55,481 [trainer.py] => prefix: asp
2025-01-09 12:46:55,481 [trainer.py] => model_prefix: asp
2025-01-09 12:46:57,195 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:47:22,803 [trainer.py] => All params: 173596160
2025-01-09 12:47:22,804 [trainer.py] => Trainable params: 1998848
2025-01-09 12:47:22,805 [asp.py] => Learning on 15-20
2025-01-09 12:47:22,812 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 12:48:01,550 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:48:01,550 [trainer.py] => model_name: asp
2025-01-09 12:48:01,550 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:48:01,550 [trainer.py] => device: ['cuda']
2025-01-09 12:48:01,550 [trainer.py] => seed: 2024
2025-01-09 12:48:01,550 [trainer.py] => dataset: cifar224
2025-01-09 12:48:01,550 [trainer.py] => init_cls: 5
2025-01-09 12:48:01,550 [trainer.py] => increment: 5
2025-01-09 12:48:01,550 [trainer.py] => kshot: 50
2025-01-09 12:48:01,550 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:48:01,550 [trainer.py] => z_dim: 1000
2025-01-09 12:48:01,551 [trainer.py] => conv_dim: 64
2025-01-09 12:48:01,551 [trainer.py] => img_size: 224
2025-01-09 12:48:01,551 [trainer.py] => generator_lr: 0.005
2025-01-09 12:48:01,551 [trainer.py] => pi: 100
2025-01-09 12:48:01,551 [trainer.py] => w_bn: 50.0
2025-01-09 12:48:01,551 [trainer.py] => w_noise: 0.001
2025-01-09 12:48:01,551 [trainer.py] => server_ss: 32
2025-01-09 12:48:01,551 [trainer.py] => bn_loss: 1
2025-01-09 12:48:01,551 [trainer.py] => noise: 1
2025-01-09 12:48:01,551 [trainer.py] => ie_loss: 1
2025-01-09 12:48:01,551 [trainer.py] => act_loss: 0
2025-01-09 12:48:01,551 [trainer.py] => w_ie: 1.0
2025-01-09 12:48:01,551 [trainer.py] => w_act: 0.1
2025-01-09 12:48:01,551 [trainer.py] => syn_size: 32
2025-01-09 12:48:01,551 [trainer.py] => need_syn_imgs: True
2025-01-09 12:48:01,551 [trainer.py] => g_local_bs: 42
2025-01-09 12:48:01,551 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:48:01,551 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:48:01,551 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:48:01,551 [trainer.py] => com_round_gen: 10
2025-01-09 12:48:01,551 [trainer.py] => g_sigma: 0
2025-01-09 12:48:01,551 [trainer.py] => save_cls_embeds: False
2025-01-09 12:48:01,551 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:48:01,551 [trainer.py] => save_dir: outputs
2025-01-09 12:48:01,551 [trainer.py] => n_iter: 5
2025-01-09 12:48:01,551 [trainer.py] => num_users: 1
2025-01-09 12:48:01,551 [trainer.py] => cur_size: 50
2025-01-09 12:48:01,551 [trainer.py] => local_bs: 5
2025-01-09 12:48:01,551 [trainer.py] => vpt_type: Deep
2025-01-09 12:48:01,551 [trainer.py] => prompt_token_num: 6
2025-01-09 12:48:01,551 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:48:01,552 [trainer.py] => perturb_var: 1
2025-01-09 12:48:01,552 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:48:01,552 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:48:01,552 [trainer.py] => kl_weight: 0.001
2025-01-09 12:48:01,552 [trainer.py] => TIP_init: zero
2025-01-09 12:48:01,552 [trainer.py] => tuned_epoch: 10
2025-01-09 12:48:01,552 [trainer.py] => fs_epoch: 0
2025-01-09 12:48:01,552 [trainer.py] => init_lr: 0.01
2025-01-09 12:48:01,552 [trainer.py] => fs_lr: 0.001
2025-01-09 12:48:01,552 [trainer.py] => batch_size: 48
2025-01-09 12:48:01,552 [trainer.py] => fs_batch_size: 16
2025-01-09 12:48:01,552 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:48:01,552 [trainer.py] => min_lr: 0
2025-01-09 12:48:01,552 [trainer.py] => optimizer: sgd
2025-01-09 12:48:01,552 [trainer.py] => memory_size: 0
2025-01-09 12:48:01,552 [trainer.py] => memory_per_class: 0
2025-01-09 12:48:01,552 [trainer.py] => fixed_memory: False
2025-01-09 12:48:01,552 [trainer.py] => shuffle: False
2025-01-09 12:48:01,552 [trainer.py] => top_k: 5
2025-01-09 12:48:01,552 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:48:01,552 [trainer.py] => prefix: asp
2025-01-09 12:48:01,552 [trainer.py] => model_prefix: asp
2025-01-09 12:48:03,224 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:48:29,293 [trainer.py] => All params: 173596160
2025-01-09 12:48:29,294 [trainer.py] => Trainable params: 1998848
2025-01-09 12:48:29,294 [asp.py] => Learning on 15-20
2025-01-09 12:48:29,303 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 12:48:50,667 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:48:50,667 [trainer.py] => model_name: asp
2025-01-09 12:48:50,667 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:48:50,667 [trainer.py] => device: ['cuda']
2025-01-09 12:48:50,667 [trainer.py] => seed: 2024
2025-01-09 12:48:50,667 [trainer.py] => dataset: cifar224
2025-01-09 12:48:50,667 [trainer.py] => init_cls: 5
2025-01-09 12:48:50,668 [trainer.py] => increment: 5
2025-01-09 12:48:50,668 [trainer.py] => kshot: 50
2025-01-09 12:48:50,668 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:48:50,668 [trainer.py] => z_dim: 1000
2025-01-09 12:48:50,668 [trainer.py] => conv_dim: 64
2025-01-09 12:48:50,668 [trainer.py] => img_size: 224
2025-01-09 12:48:50,668 [trainer.py] => generator_lr: 0.005
2025-01-09 12:48:50,668 [trainer.py] => pi: 100
2025-01-09 12:48:50,668 [trainer.py] => w_bn: 50.0
2025-01-09 12:48:50,668 [trainer.py] => w_noise: 0.001
2025-01-09 12:48:50,668 [trainer.py] => server_ss: 32
2025-01-09 12:48:50,668 [trainer.py] => bn_loss: 1
2025-01-09 12:48:50,668 [trainer.py] => noise: 1
2025-01-09 12:48:50,668 [trainer.py] => ie_loss: 1
2025-01-09 12:48:50,668 [trainer.py] => act_loss: 0
2025-01-09 12:48:50,668 [trainer.py] => w_ie: 1.0
2025-01-09 12:48:50,668 [trainer.py] => w_act: 0.1
2025-01-09 12:48:50,668 [trainer.py] => syn_size: 32
2025-01-09 12:48:50,668 [trainer.py] => need_syn_imgs: True
2025-01-09 12:48:50,668 [trainer.py] => g_local_bs: 42
2025-01-09 12:48:50,668 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:48:50,668 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:48:50,668 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:48:50,668 [trainer.py] => com_round_gen: 10
2025-01-09 12:48:50,668 [trainer.py] => g_sigma: 0
2025-01-09 12:48:50,668 [trainer.py] => save_cls_embeds: False
2025-01-09 12:48:50,668 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:48:50,668 [trainer.py] => save_dir: outputs
2025-01-09 12:48:50,668 [trainer.py] => n_iter: 5
2025-01-09 12:48:50,668 [trainer.py] => num_users: 1
2025-01-09 12:48:50,668 [trainer.py] => cur_size: 50
2025-01-09 12:48:50,669 [trainer.py] => local_bs: 5
2025-01-09 12:48:50,669 [trainer.py] => vpt_type: Deep
2025-01-09 12:48:50,669 [trainer.py] => prompt_token_num: 6
2025-01-09 12:48:50,669 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:48:50,669 [trainer.py] => perturb_var: 1
2025-01-09 12:48:50,669 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:48:50,669 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:48:50,669 [trainer.py] => kl_weight: 0.001
2025-01-09 12:48:50,669 [trainer.py] => TIP_init: zero
2025-01-09 12:48:50,669 [trainer.py] => tuned_epoch: 10
2025-01-09 12:48:50,669 [trainer.py] => fs_epoch: 0
2025-01-09 12:48:50,669 [trainer.py] => init_lr: 0.01
2025-01-09 12:48:50,669 [trainer.py] => fs_lr: 0.001
2025-01-09 12:48:50,669 [trainer.py] => batch_size: 48
2025-01-09 12:48:50,669 [trainer.py] => fs_batch_size: 16
2025-01-09 12:48:50,669 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:48:50,669 [trainer.py] => min_lr: 0
2025-01-09 12:48:50,669 [trainer.py] => optimizer: sgd
2025-01-09 12:48:50,669 [trainer.py] => memory_size: 0
2025-01-09 12:48:50,669 [trainer.py] => memory_per_class: 0
2025-01-09 12:48:50,669 [trainer.py] => fixed_memory: False
2025-01-09 12:48:50,669 [trainer.py] => shuffle: False
2025-01-09 12:48:50,669 [trainer.py] => top_k: 5
2025-01-09 12:48:50,669 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:48:50,669 [trainer.py] => prefix: asp
2025-01-09 12:48:50,669 [trainer.py] => model_prefix: asp
2025-01-09 12:48:52,659 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:49:18,572 [trainer.py] => All params: 173596160
2025-01-09 12:49:18,573 [trainer.py] => Trainable params: 1998848
2025-01-09 12:49:18,573 [asp.py] => Learning on 15-20
2025-01-09 12:49:18,579 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 12:50:35,909 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:50:35,909 [trainer.py] => model_name: asp
2025-01-09 12:50:35,909 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:50:35,909 [trainer.py] => device: ['cuda']
2025-01-09 12:50:35,909 [trainer.py] => seed: 2024
2025-01-09 12:50:35,909 [trainer.py] => dataset: cifar224
2025-01-09 12:50:35,909 [trainer.py] => init_cls: 5
2025-01-09 12:50:35,909 [trainer.py] => increment: 5
2025-01-09 12:50:35,909 [trainer.py] => kshot: 50
2025-01-09 12:50:35,909 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:50:35,909 [trainer.py] => z_dim: 1000
2025-01-09 12:50:35,909 [trainer.py] => conv_dim: 64
2025-01-09 12:50:35,909 [trainer.py] => img_size: 224
2025-01-09 12:50:35,909 [trainer.py] => generator_lr: 0.005
2025-01-09 12:50:35,909 [trainer.py] => pi: 100
2025-01-09 12:50:35,909 [trainer.py] => w_bn: 50.0
2025-01-09 12:50:35,909 [trainer.py] => w_noise: 0.001
2025-01-09 12:50:35,909 [trainer.py] => server_ss: 32
2025-01-09 12:50:35,909 [trainer.py] => bn_loss: 1
2025-01-09 12:50:35,909 [trainer.py] => noise: 1
2025-01-09 12:50:35,909 [trainer.py] => ie_loss: 1
2025-01-09 12:50:35,909 [trainer.py] => act_loss: 0
2025-01-09 12:50:35,909 [trainer.py] => w_ie: 1.0
2025-01-09 12:50:35,909 [trainer.py] => w_act: 0.1
2025-01-09 12:50:35,910 [trainer.py] => syn_size: 32
2025-01-09 12:50:35,910 [trainer.py] => need_syn_imgs: True
2025-01-09 12:50:35,910 [trainer.py] => g_local_bs: 42
2025-01-09 12:50:35,910 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:50:35,910 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:50:35,910 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:50:35,910 [trainer.py] => com_round_gen: 10
2025-01-09 12:50:35,910 [trainer.py] => g_sigma: 0
2025-01-09 12:50:35,910 [trainer.py] => save_cls_embeds: False
2025-01-09 12:50:35,910 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:50:35,910 [trainer.py] => save_dir: outputs
2025-01-09 12:50:35,910 [trainer.py] => n_iter: 5
2025-01-09 12:50:35,910 [trainer.py] => num_users: 1
2025-01-09 12:50:35,910 [trainer.py] => cur_size: 50
2025-01-09 12:50:35,910 [trainer.py] => local_bs: 5
2025-01-09 12:50:35,910 [trainer.py] => vpt_type: Deep
2025-01-09 12:50:35,910 [trainer.py] => prompt_token_num: 6
2025-01-09 12:50:35,910 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:50:35,910 [trainer.py] => perturb_var: 1
2025-01-09 12:50:35,910 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:50:35,910 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:50:35,910 [trainer.py] => kl_weight: 0.001
2025-01-09 12:50:35,910 [trainer.py] => TIP_init: zero
2025-01-09 12:50:35,910 [trainer.py] => tuned_epoch: 10
2025-01-09 12:50:35,910 [trainer.py] => fs_epoch: 0
2025-01-09 12:50:35,910 [trainer.py] => init_lr: 0.01
2025-01-09 12:50:35,910 [trainer.py] => fs_lr: 0.001
2025-01-09 12:50:35,910 [trainer.py] => batch_size: 48
2025-01-09 12:50:35,910 [trainer.py] => fs_batch_size: 16
2025-01-09 12:50:35,910 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:50:35,910 [trainer.py] => min_lr: 0
2025-01-09 12:50:35,911 [trainer.py] => optimizer: sgd
2025-01-09 12:50:35,911 [trainer.py] => memory_size: 0
2025-01-09 12:50:35,911 [trainer.py] => memory_per_class: 0
2025-01-09 12:50:35,911 [trainer.py] => fixed_memory: False
2025-01-09 12:50:35,911 [trainer.py] => shuffle: False
2025-01-09 12:50:35,911 [trainer.py] => top_k: 5
2025-01-09 12:50:35,911 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:50:35,911 [trainer.py] => prefix: asp
2025-01-09 12:50:35,911 [trainer.py] => model_prefix: asp
2025-01-09 12:50:37,651 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:51:04,382 [trainer.py] => All params: 173596160
2025-01-09 12:51:04,383 [trainer.py] => Trainable params: 1998848
2025-01-09 12:51:04,384 [asp.py] => Learning on 15-20
2025-01-09 12:51:04,395 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 12:51:57,848 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:51:57,848 [trainer.py] => model_name: asp
2025-01-09 12:51:57,848 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:51:57,848 [trainer.py] => device: ['cuda']
2025-01-09 12:51:57,848 [trainer.py] => seed: 2024
2025-01-09 12:51:57,848 [trainer.py] => dataset: cifar224
2025-01-09 12:51:57,848 [trainer.py] => init_cls: 5
2025-01-09 12:51:57,848 [trainer.py] => increment: 5
2025-01-09 12:51:57,848 [trainer.py] => kshot: 50
2025-01-09 12:51:57,849 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:51:57,849 [trainer.py] => z_dim: 1000
2025-01-09 12:51:57,849 [trainer.py] => conv_dim: 64
2025-01-09 12:51:57,849 [trainer.py] => img_size: 224
2025-01-09 12:51:57,849 [trainer.py] => generator_lr: 0.005
2025-01-09 12:51:57,849 [trainer.py] => pi: 100
2025-01-09 12:51:57,849 [trainer.py] => w_bn: 50.0
2025-01-09 12:51:57,849 [trainer.py] => w_noise: 0.001
2025-01-09 12:51:57,849 [trainer.py] => server_ss: 32
2025-01-09 12:51:57,849 [trainer.py] => bn_loss: 1
2025-01-09 12:51:57,849 [trainer.py] => noise: 1
2025-01-09 12:51:57,849 [trainer.py] => ie_loss: 1
2025-01-09 12:51:57,849 [trainer.py] => act_loss: 0
2025-01-09 12:51:57,849 [trainer.py] => w_ie: 1.0
2025-01-09 12:51:57,849 [trainer.py] => w_act: 0.1
2025-01-09 12:51:57,849 [trainer.py] => syn_size: 32
2025-01-09 12:51:57,849 [trainer.py] => need_syn_imgs: True
2025-01-09 12:51:57,849 [trainer.py] => g_local_bs: 42
2025-01-09 12:51:57,849 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:51:57,849 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:51:57,849 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:51:57,849 [trainer.py] => com_round_gen: 10
2025-01-09 12:51:57,849 [trainer.py] => g_sigma: 0
2025-01-09 12:51:57,849 [trainer.py] => save_cls_embeds: False
2025-01-09 12:51:57,849 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:51:57,850 [trainer.py] => save_dir: outputs
2025-01-09 12:51:57,850 [trainer.py] => n_iter: 5
2025-01-09 12:51:57,850 [trainer.py] => num_users: 1
2025-01-09 12:51:57,850 [trainer.py] => cur_size: 50
2025-01-09 12:51:57,850 [trainer.py] => local_bs: 5
2025-01-09 12:51:57,850 [trainer.py] => vpt_type: Deep
2025-01-09 12:51:57,850 [trainer.py] => prompt_token_num: 6
2025-01-09 12:51:57,850 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:51:57,850 [trainer.py] => perturb_var: 1
2025-01-09 12:51:57,850 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:51:57,850 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:51:57,850 [trainer.py] => kl_weight: 0.001
2025-01-09 12:51:57,850 [trainer.py] => TIP_init: zero
2025-01-09 12:51:57,850 [trainer.py] => tuned_epoch: 10
2025-01-09 12:51:57,850 [trainer.py] => fs_epoch: 0
2025-01-09 12:51:57,850 [trainer.py] => init_lr: 0.01
2025-01-09 12:51:57,850 [trainer.py] => fs_lr: 0.001
2025-01-09 12:51:57,850 [trainer.py] => batch_size: 48
2025-01-09 12:51:57,850 [trainer.py] => fs_batch_size: 16
2025-01-09 12:51:57,850 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:51:57,850 [trainer.py] => min_lr: 0
2025-01-09 12:51:57,850 [trainer.py] => optimizer: sgd
2025-01-09 12:51:57,850 [trainer.py] => memory_size: 0
2025-01-09 12:51:57,850 [trainer.py] => memory_per_class: 0
2025-01-09 12:51:57,850 [trainer.py] => fixed_memory: False
2025-01-09 12:51:57,850 [trainer.py] => shuffle: False
2025-01-09 12:51:57,850 [trainer.py] => top_k: 5
2025-01-09 12:51:57,850 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:51:57,850 [trainer.py] => prefix: asp
2025-01-09 12:51:57,850 [trainer.py] => model_prefix: asp
2025-01-09 12:51:59,442 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:52:25,711 [trainer.py] => All params: 173596160
2025-01-09 12:52:25,712 [trainer.py] => Trainable params: 1998848
2025-01-09 12:52:25,713 [asp.py] => Learning on 15-20
2025-01-09 12:52:25,721 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 12:52:52,400 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 12:52:52,400 [trainer.py] => model_name: asp
2025-01-09 12:52:52,401 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 12:52:52,401 [trainer.py] => device: ['cuda']
2025-01-09 12:52:52,401 [trainer.py] => seed: 2024
2025-01-09 12:52:52,401 [trainer.py] => dataset: cifar224
2025-01-09 12:52:52,401 [trainer.py] => init_cls: 5
2025-01-09 12:52:52,401 [trainer.py] => increment: 5
2025-01-09 12:52:52,401 [trainer.py] => kshot: 50
2025-01-09 12:52:52,401 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 12:52:52,401 [trainer.py] => z_dim: 1000
2025-01-09 12:52:52,401 [trainer.py] => conv_dim: 64
2025-01-09 12:52:52,401 [trainer.py] => img_size: 224
2025-01-09 12:52:52,401 [trainer.py] => generator_lr: 0.005
2025-01-09 12:52:52,401 [trainer.py] => pi: 100
2025-01-09 12:52:52,401 [trainer.py] => w_bn: 50.0
2025-01-09 12:52:52,401 [trainer.py] => w_noise: 0.001
2025-01-09 12:52:52,401 [trainer.py] => server_ss: 32
2025-01-09 12:52:52,401 [trainer.py] => bn_loss: 1
2025-01-09 12:52:52,401 [trainer.py] => noise: 1
2025-01-09 12:52:52,401 [trainer.py] => ie_loss: 1
2025-01-09 12:52:52,401 [trainer.py] => act_loss: 0
2025-01-09 12:52:52,401 [trainer.py] => w_ie: 1.0
2025-01-09 12:52:52,401 [trainer.py] => w_act: 0.1
2025-01-09 12:52:52,402 [trainer.py] => syn_size: 32
2025-01-09 12:52:52,402 [trainer.py] => need_syn_imgs: True
2025-01-09 12:52:52,402 [trainer.py] => g_local_bs: 42
2025-01-09 12:52:52,402 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 12:52:52,402 [trainer.py] => g_local_train_steps: 10
2025-01-09 12:52:52,402 [trainer.py] => dataset_syn: cifar100
2025-01-09 12:52:52,402 [trainer.py] => com_round_gen: 10
2025-01-09 12:52:52,402 [trainer.py] => g_sigma: 0
2025-01-09 12:52:52,402 [trainer.py] => save_cls_embeds: False
2025-01-09 12:52:52,402 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 12:52:52,402 [trainer.py] => save_dir: outputs
2025-01-09 12:52:52,402 [trainer.py] => n_iter: 5
2025-01-09 12:52:52,402 [trainer.py] => num_users: 1
2025-01-09 12:52:52,402 [trainer.py] => cur_size: 50
2025-01-09 12:52:52,402 [trainer.py] => local_bs: 5
2025-01-09 12:52:52,402 [trainer.py] => vpt_type: Deep
2025-01-09 12:52:52,402 [trainer.py] => prompt_token_num: 6
2025-01-09 12:52:52,402 [trainer.py] => avg_alpha: 0.8
2025-01-09 12:52:52,402 [trainer.py] => perturb_var: 1
2025-01-09 12:52:52,403 [trainer.py] => EMA_beta: 0.99
2025-01-09 12:52:52,403 [trainer.py] => anchor_lambda: 0.1
2025-01-09 12:52:52,403 [trainer.py] => kl_weight: 0.001
2025-01-09 12:52:52,403 [trainer.py] => TIP_init: zero
2025-01-09 12:52:52,403 [trainer.py] => tuned_epoch: 10
2025-01-09 12:52:52,403 [trainer.py] => fs_epoch: 0
2025-01-09 12:52:52,403 [trainer.py] => init_lr: 0.01
2025-01-09 12:52:52,403 [trainer.py] => fs_lr: 0.001
2025-01-09 12:52:52,403 [trainer.py] => batch_size: 48
2025-01-09 12:52:52,403 [trainer.py] => fs_batch_size: 16
2025-01-09 12:52:52,403 [trainer.py] => weight_decay: 0.0005
2025-01-09 12:52:52,403 [trainer.py] => min_lr: 0
2025-01-09 12:52:52,403 [trainer.py] => optimizer: sgd
2025-01-09 12:52:52,403 [trainer.py] => memory_size: 0
2025-01-09 12:52:52,403 [trainer.py] => memory_per_class: 0
2025-01-09 12:52:52,403 [trainer.py] => fixed_memory: False
2025-01-09 12:52:52,403 [trainer.py] => shuffle: False
2025-01-09 12:52:52,403 [trainer.py] => top_k: 5
2025-01-09 12:52:52,403 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 12:52:52,403 [trainer.py] => prefix: asp
2025-01-09 12:52:52,403 [trainer.py] => model_prefix: asp
2025-01-09 12:52:54,002 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 12:53:18,707 [trainer.py] => All params: 173596160
2025-01-09 12:53:18,708 [trainer.py] => Trainable params: 1998848
2025-01-09 12:53:18,708 [asp.py] => Learning on 15-20
2025-01-09 12:53:18,740 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 12:58:06,106 [trainer.py] => Top1 curve: [21.6]
2025-01-09 12:58:06,107 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-09 12:58:06,108 [trainer.py] => All params: 173600001
2025-01-09 12:58:06,109 [trainer.py] => Trainable params: 2002689
2025-01-09 12:58:06,110 [asp.py] => Learning on 5-10
2025-01-09 12:58:06,121 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 13:02:45,451 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 13:02:45,451 [trainer.py] => model_name: asp
2025-01-09 13:02:45,451 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 13:02:45,451 [trainer.py] => device: ['cuda']
2025-01-09 13:02:45,451 [trainer.py] => seed: 2024
2025-01-09 13:02:45,451 [trainer.py] => dataset: cifar224
2025-01-09 13:02:45,451 [trainer.py] => init_cls: 5
2025-01-09 13:02:45,451 [trainer.py] => increment: 5
2025-01-09 13:02:45,451 [trainer.py] => kshot: 50
2025-01-09 13:02:45,451 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 13:02:45,451 [trainer.py] => z_dim: 1000
2025-01-09 13:02:45,451 [trainer.py] => conv_dim: 64
2025-01-09 13:02:45,451 [trainer.py] => img_size: 224
2025-01-09 13:02:45,451 [trainer.py] => generator_lr: 0.005
2025-01-09 13:02:45,451 [trainer.py] => pi: 100
2025-01-09 13:02:45,451 [trainer.py] => w_bn: 50.0
2025-01-09 13:02:45,451 [trainer.py] => w_noise: 0.001
2025-01-09 13:02:45,451 [trainer.py] => server_ss: 32
2025-01-09 13:02:45,451 [trainer.py] => bn_loss: 1
2025-01-09 13:02:45,452 [trainer.py] => noise: 1
2025-01-09 13:02:45,452 [trainer.py] => ie_loss: 1
2025-01-09 13:02:45,452 [trainer.py] => act_loss: 0
2025-01-09 13:02:45,452 [trainer.py] => w_ie: 1.0
2025-01-09 13:02:45,452 [trainer.py] => w_act: 0.1
2025-01-09 13:02:45,452 [trainer.py] => syn_size: 32
2025-01-09 13:02:45,452 [trainer.py] => need_syn_imgs: True
2025-01-09 13:02:45,452 [trainer.py] => g_local_bs: 42
2025-01-09 13:02:45,452 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 13:02:45,452 [trainer.py] => g_local_train_steps: 10
2025-01-09 13:02:45,452 [trainer.py] => dataset_syn: cifar100
2025-01-09 13:02:45,452 [trainer.py] => com_round_gen: 10
2025-01-09 13:02:45,452 [trainer.py] => g_sigma: 0
2025-01-09 13:02:45,452 [trainer.py] => save_cls_embeds: False
2025-01-09 13:02:45,452 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 13:02:45,452 [trainer.py] => save_dir: outputs
2025-01-09 13:02:45,452 [trainer.py] => n_iter: 5
2025-01-09 13:02:45,452 [trainer.py] => num_users: 1
2025-01-09 13:02:45,452 [trainer.py] => cur_size: 50
2025-01-09 13:02:45,452 [trainer.py] => local_bs: 5
2025-01-09 13:02:45,452 [trainer.py] => vpt_type: Deep
2025-01-09 13:02:45,452 [trainer.py] => prompt_token_num: 6
2025-01-09 13:02:45,452 [trainer.py] => avg_alpha: 0.8
2025-01-09 13:02:45,452 [trainer.py] => perturb_var: 1
2025-01-09 13:02:45,452 [trainer.py] => EMA_beta: 0.99
2025-01-09 13:02:45,452 [trainer.py] => anchor_lambda: 0.1
2025-01-09 13:02:45,452 [trainer.py] => kl_weight: 0.001
2025-01-09 13:02:45,452 [trainer.py] => TIP_init: zero
2025-01-09 13:02:45,453 [trainer.py] => tuned_epoch: 10
2025-01-09 13:02:45,453 [trainer.py] => fs_epoch: 0
2025-01-09 13:02:45,453 [trainer.py] => init_lr: 0.01
2025-01-09 13:02:45,453 [trainer.py] => fs_lr: 0.001
2025-01-09 13:02:45,453 [trainer.py] => batch_size: 48
2025-01-09 13:02:45,453 [trainer.py] => fs_batch_size: 16
2025-01-09 13:02:45,453 [trainer.py] => weight_decay: 0.0005
2025-01-09 13:02:45,453 [trainer.py] => min_lr: 0
2025-01-09 13:02:45,453 [trainer.py] => optimizer: sgd
2025-01-09 13:02:45,453 [trainer.py] => memory_size: 0
2025-01-09 13:02:45,453 [trainer.py] => memory_per_class: 0
2025-01-09 13:02:45,453 [trainer.py] => fixed_memory: False
2025-01-09 13:02:45,453 [trainer.py] => shuffle: False
2025-01-09 13:02:45,453 [trainer.py] => top_k: 5
2025-01-09 13:02:45,453 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 13:02:45,453 [trainer.py] => prefix: asp
2025-01-09 13:02:45,453 [trainer.py] => model_prefix: asp
2025-01-09 13:02:47,153 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 13:03:13,317 [trainer.py] => All params: 173596160
2025-01-09 13:03:13,318 [trainer.py] => Trainable params: 1998848
2025-01-09 13:03:13,319 [asp.py] => Learning on 5-10
2025-01-09 13:03:13,328 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 13:04:08,949 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 13:04:08,949 [trainer.py] => model_name: asp
2025-01-09 13:04:08,949 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 13:04:08,949 [trainer.py] => device: ['cuda']
2025-01-09 13:04:08,949 [trainer.py] => seed: 2024
2025-01-09 13:04:08,949 [trainer.py] => dataset: cifar224
2025-01-09 13:04:08,950 [trainer.py] => init_cls: 5
2025-01-09 13:04:08,950 [trainer.py] => increment: 5
2025-01-09 13:04:08,950 [trainer.py] => kshot: 50
2025-01-09 13:04:08,950 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 13:04:08,950 [trainer.py] => z_dim: 1000
2025-01-09 13:04:08,950 [trainer.py] => conv_dim: 64
2025-01-09 13:04:08,950 [trainer.py] => img_size: 224
2025-01-09 13:04:08,950 [trainer.py] => generator_lr: 0.005
2025-01-09 13:04:08,950 [trainer.py] => pi: 100
2025-01-09 13:04:08,950 [trainer.py] => w_bn: 50.0
2025-01-09 13:04:08,950 [trainer.py] => w_noise: 0.001
2025-01-09 13:04:08,950 [trainer.py] => server_ss: 32
2025-01-09 13:04:08,950 [trainer.py] => bn_loss: 1
2025-01-09 13:04:08,950 [trainer.py] => noise: 1
2025-01-09 13:04:08,950 [trainer.py] => ie_loss: 1
2025-01-09 13:04:08,950 [trainer.py] => act_loss: 0
2025-01-09 13:04:08,950 [trainer.py] => w_ie: 1.0
2025-01-09 13:04:08,950 [trainer.py] => w_act: 0.1
2025-01-09 13:04:08,950 [trainer.py] => syn_size: 32
2025-01-09 13:04:08,950 [trainer.py] => need_syn_imgs: True
2025-01-09 13:04:08,950 [trainer.py] => g_local_bs: 42
2025-01-09 13:04:08,950 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 13:04:08,950 [trainer.py] => g_local_train_steps: 10
2025-01-09 13:04:08,950 [trainer.py] => dataset_syn: cifar100
2025-01-09 13:04:08,950 [trainer.py] => com_round_gen: 10
2025-01-09 13:04:08,950 [trainer.py] => g_sigma: 0
2025-01-09 13:04:08,950 [trainer.py] => save_cls_embeds: False
2025-01-09 13:04:08,950 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 13:04:08,950 [trainer.py] => save_dir: outputs
2025-01-09 13:04:08,950 [trainer.py] => n_iter: 5
2025-01-09 13:04:08,951 [trainer.py] => num_users: 1
2025-01-09 13:04:08,951 [trainer.py] => cur_size: 50
2025-01-09 13:04:08,951 [trainer.py] => local_bs: 5
2025-01-09 13:04:08,951 [trainer.py] => vpt_type: Deep
2025-01-09 13:04:08,951 [trainer.py] => prompt_token_num: 6
2025-01-09 13:04:08,951 [trainer.py] => avg_alpha: 0.8
2025-01-09 13:04:08,951 [trainer.py] => perturb_var: 1
2025-01-09 13:04:08,951 [trainer.py] => EMA_beta: 0.99
2025-01-09 13:04:08,951 [trainer.py] => anchor_lambda: 0.1
2025-01-09 13:04:08,951 [trainer.py] => kl_weight: 0.001
2025-01-09 13:04:08,951 [trainer.py] => TIP_init: zero
2025-01-09 13:04:08,951 [trainer.py] => tuned_epoch: 10
2025-01-09 13:04:08,951 [trainer.py] => fs_epoch: 0
2025-01-09 13:04:08,951 [trainer.py] => init_lr: 0.01
2025-01-09 13:04:08,951 [trainer.py] => fs_lr: 0.001
2025-01-09 13:04:08,951 [trainer.py] => batch_size: 48
2025-01-09 13:04:08,951 [trainer.py] => fs_batch_size: 16
2025-01-09 13:04:08,951 [trainer.py] => weight_decay: 0.0005
2025-01-09 13:04:08,951 [trainer.py] => min_lr: 0
2025-01-09 13:04:08,951 [trainer.py] => optimizer: sgd
2025-01-09 13:04:08,951 [trainer.py] => memory_size: 0
2025-01-09 13:04:08,951 [trainer.py] => memory_per_class: 0
2025-01-09 13:04:08,951 [trainer.py] => fixed_memory: False
2025-01-09 13:04:08,951 [trainer.py] => shuffle: False
2025-01-09 13:04:08,951 [trainer.py] => top_k: 5
2025-01-09 13:04:08,951 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 13:04:08,951 [trainer.py] => prefix: asp
2025-01-09 13:04:08,951 [trainer.py] => model_prefix: asp
2025-01-09 13:04:10,671 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 13:04:28,316 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 13:04:28,316 [trainer.py] => model_name: asp
2025-01-09 13:04:28,316 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 13:04:28,316 [trainer.py] => device: ['cuda']
2025-01-09 13:04:28,316 [trainer.py] => seed: 2024
2025-01-09 13:04:28,316 [trainer.py] => dataset: cifar224
2025-01-09 13:04:28,316 [trainer.py] => init_cls: 5
2025-01-09 13:04:28,316 [trainer.py] => increment: 5
2025-01-09 13:04:28,316 [trainer.py] => kshot: 50
2025-01-09 13:04:28,316 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 13:04:28,316 [trainer.py] => z_dim: 1000
2025-01-09 13:04:28,316 [trainer.py] => conv_dim: 64
2025-01-09 13:04:28,316 [trainer.py] => img_size: 224
2025-01-09 13:04:28,316 [trainer.py] => generator_lr: 0.005
2025-01-09 13:04:28,316 [trainer.py] => pi: 100
2025-01-09 13:04:28,316 [trainer.py] => w_bn: 50.0
2025-01-09 13:04:28,316 [trainer.py] => w_noise: 0.001
2025-01-09 13:04:28,316 [trainer.py] => server_ss: 32
2025-01-09 13:04:28,316 [trainer.py] => bn_loss: 1
2025-01-09 13:04:28,316 [trainer.py] => noise: 1
2025-01-09 13:04:28,316 [trainer.py] => ie_loss: 1
2025-01-09 13:04:28,316 [trainer.py] => act_loss: 0
2025-01-09 13:04:28,317 [trainer.py] => w_ie: 1.0
2025-01-09 13:04:28,317 [trainer.py] => w_act: 0.1
2025-01-09 13:04:28,317 [trainer.py] => syn_size: 32
2025-01-09 13:04:28,317 [trainer.py] => need_syn_imgs: True
2025-01-09 13:04:28,317 [trainer.py] => g_local_bs: 42
2025-01-09 13:04:28,317 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 13:04:28,317 [trainer.py] => g_local_train_steps: 10
2025-01-09 13:04:28,317 [trainer.py] => dataset_syn: cifar100
2025-01-09 13:04:28,317 [trainer.py] => com_round_gen: 10
2025-01-09 13:04:28,317 [trainer.py] => g_sigma: 0
2025-01-09 13:04:28,317 [trainer.py] => save_cls_embeds: False
2025-01-09 13:04:28,317 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 13:04:28,317 [trainer.py] => save_dir: outputs
2025-01-09 13:04:28,317 [trainer.py] => n_iter: 5
2025-01-09 13:04:28,317 [trainer.py] => num_users: 1
2025-01-09 13:04:28,317 [trainer.py] => cur_size: 50
2025-01-09 13:04:28,317 [trainer.py] => local_bs: 5
2025-01-09 13:04:28,317 [trainer.py] => vpt_type: Deep
2025-01-09 13:04:28,317 [trainer.py] => prompt_token_num: 6
2025-01-09 13:04:28,317 [trainer.py] => avg_alpha: 0.8
2025-01-09 13:04:28,317 [trainer.py] => perturb_var: 1
2025-01-09 13:04:28,317 [trainer.py] => EMA_beta: 0.99
2025-01-09 13:04:28,317 [trainer.py] => anchor_lambda: 0.1
2025-01-09 13:04:28,317 [trainer.py] => kl_weight: 0.001
2025-01-09 13:04:28,317 [trainer.py] => TIP_init: zero
2025-01-09 13:04:28,317 [trainer.py] => tuned_epoch: 10
2025-01-09 13:04:28,317 [trainer.py] => fs_epoch: 0
2025-01-09 13:04:28,317 [trainer.py] => init_lr: 0.01
2025-01-09 13:04:28,317 [trainer.py] => fs_lr: 0.001
2025-01-09 13:04:28,317 [trainer.py] => batch_size: 48
2025-01-09 13:04:28,317 [trainer.py] => fs_batch_size: 16
2025-01-09 13:04:28,318 [trainer.py] => weight_decay: 0.0005
2025-01-09 13:04:28,318 [trainer.py] => min_lr: 0
2025-01-09 13:04:28,318 [trainer.py] => optimizer: sgd
2025-01-09 13:04:28,318 [trainer.py] => memory_size: 0
2025-01-09 13:04:28,318 [trainer.py] => memory_per_class: 0
2025-01-09 13:04:28,318 [trainer.py] => fixed_memory: False
2025-01-09 13:04:28,318 [trainer.py] => shuffle: False
2025-01-09 13:04:28,318 [trainer.py] => top_k: 5
2025-01-09 13:04:28,318 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 13:04:28,318 [trainer.py] => prefix: asp
2025-01-09 13:04:28,318 [trainer.py] => model_prefix: asp
2025-01-09 13:04:29,976 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 13:04:56,466 [trainer.py] => All params: 173596160
2025-01-09 13:04:56,469 [trainer.py] => Trainable params: 1998848
2025-01-09 13:04:56,470 [asp.py] => Learning on 5-10
2025-01-09 13:04:56,475 [asp.py] => training set size: 250, fc construct set size: 250
2025-01-09 13:07:15,398 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 13:07:15,398 [trainer.py] => model_name: asp
2025-01-09 13:07:15,398 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 13:07:15,398 [trainer.py] => device: ['cuda']
2025-01-09 13:07:15,398 [trainer.py] => seed: 2024
2025-01-09 13:07:15,398 [trainer.py] => dataset: cifar224
2025-01-09 13:07:15,398 [trainer.py] => init_cls: 5
2025-01-09 13:07:15,398 [trainer.py] => increment: 5
2025-01-09 13:07:15,398 [trainer.py] => kshot: 50
2025-01-09 13:07:15,398 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 13:07:15,398 [trainer.py] => z_dim: 1000
2025-01-09 13:07:15,398 [trainer.py] => conv_dim: 64
2025-01-09 13:07:15,398 [trainer.py] => img_size: 224
2025-01-09 13:07:15,398 [trainer.py] => generator_lr: 0.005
2025-01-09 13:07:15,399 [trainer.py] => pi: 100
2025-01-09 13:07:15,399 [trainer.py] => w_bn: 50.0
2025-01-09 13:07:15,399 [trainer.py] => w_noise: 0.001
2025-01-09 13:07:15,399 [trainer.py] => server_ss: 32
2025-01-09 13:07:15,399 [trainer.py] => bn_loss: 1
2025-01-09 13:07:15,399 [trainer.py] => noise: 1
2025-01-09 13:07:15,399 [trainer.py] => ie_loss: 1
2025-01-09 13:07:15,399 [trainer.py] => act_loss: 0
2025-01-09 13:07:15,399 [trainer.py] => w_ie: 1.0
2025-01-09 13:07:15,399 [trainer.py] => w_act: 0.1
2025-01-09 13:07:15,399 [trainer.py] => syn_size: 32
2025-01-09 13:07:15,399 [trainer.py] => need_syn_imgs: True
2025-01-09 13:07:15,399 [trainer.py] => g_local_bs: 42
2025-01-09 13:07:15,399 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 13:07:15,399 [trainer.py] => g_local_train_steps: 10
2025-01-09 13:07:15,399 [trainer.py] => dataset_syn: cifar100
2025-01-09 13:07:15,399 [trainer.py] => com_round_gen: 10
2025-01-09 13:07:15,399 [trainer.py] => g_sigma: 0
2025-01-09 13:07:15,399 [trainer.py] => save_cls_embeds: False
2025-01-09 13:07:15,399 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 13:07:15,399 [trainer.py] => save_dir: outputs
2025-01-09 13:07:15,399 [trainer.py] => n_iter: 5
2025-01-09 13:07:15,399 [trainer.py] => num_users: 1
2025-01-09 13:07:15,399 [trainer.py] => cur_size: 50
2025-01-09 13:07:15,399 [trainer.py] => local_bs: 5
2025-01-09 13:07:15,399 [trainer.py] => vpt_type: Deep
2025-01-09 13:07:15,399 [trainer.py] => prompt_token_num: 6
2025-01-09 13:07:15,399 [trainer.py] => avg_alpha: 0.8
2025-01-09 13:07:15,399 [trainer.py] => perturb_var: 1
2025-01-09 13:07:15,399 [trainer.py] => EMA_beta: 0.99
2025-01-09 13:07:15,399 [trainer.py] => anchor_lambda: 0.1
2025-01-09 13:07:15,399 [trainer.py] => kl_weight: 0.001
2025-01-09 13:07:15,400 [trainer.py] => TIP_init: zero
2025-01-09 13:07:15,400 [trainer.py] => tuned_epoch: 10
2025-01-09 13:07:15,400 [trainer.py] => fs_epoch: 0
2025-01-09 13:07:15,400 [trainer.py] => init_lr: 0.01
2025-01-09 13:07:15,400 [trainer.py] => fs_lr: 0.001
2025-01-09 13:07:15,400 [trainer.py] => batch_size: 48
2025-01-09 13:07:15,400 [trainer.py] => fs_batch_size: 16
2025-01-09 13:07:15,400 [trainer.py] => weight_decay: 0.0005
2025-01-09 13:07:15,400 [trainer.py] => min_lr: 0
2025-01-09 13:07:15,400 [trainer.py] => optimizer: sgd
2025-01-09 13:07:15,400 [trainer.py] => memory_size: 0
2025-01-09 13:07:15,400 [trainer.py] => memory_per_class: 0
2025-01-09 13:07:15,400 [trainer.py] => fixed_memory: False
2025-01-09 13:07:15,400 [trainer.py] => shuffle: False
2025-01-09 13:07:15,400 [trainer.py] => top_k: 5
2025-01-09 13:07:15,400 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 13:07:15,400 [trainer.py] => prefix: asp
2025-01-09 13:07:15,400 [trainer.py] => model_prefix: asp
2025-01-09 13:07:17,226 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 13:07:44,010 [trainer.py] => All params: 173596160
2025-01-09 13:07:44,011 [trainer.py] => Trainable params: 1998848
2025-01-09 13:07:44,012 [asp.py] => Learning on 0-5
2025-01-09 13:07:44,017 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 13:24:37,741 [trainer.py] => Top1 curve: [21.6]
2025-01-09 13:24:37,743 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-09 13:24:37,744 [trainer.py] => All params: 173600001
2025-01-09 13:24:37,745 [trainer.py] => Trainable params: 2002689
2025-01-09 13:24:37,746 [asp.py] => Learning on 5-10
2025-01-09 13:24:37,756 [asp.py] => training set size: 250, fc construct set size: 250
