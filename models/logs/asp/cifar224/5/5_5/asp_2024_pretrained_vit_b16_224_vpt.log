2025-01-08 11:32:03,660 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 11:32:03,660 [trainer.py] => model_name: asp
2025-01-08 11:32:03,660 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 11:32:03,660 [trainer.py] => device: ['cuda']
2025-01-08 11:32:03,660 [trainer.py] => seed: 2024
2025-01-08 11:32:03,660 [trainer.py] => dataset: cifar224
2025-01-08 11:32:03,660 [trainer.py] => init_cls: 5
2025-01-08 11:32:03,660 [trainer.py] => increment: 5
2025-01-08 11:32:03,660 [trainer.py] => kshot: 5
2025-01-08 11:32:03,660 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 11:32:03,660 [trainer.py] => z_dim: 1000
2025-01-08 11:32:03,660 [trainer.py] => conv_dim: 64
2025-01-08 11:32:03,660 [trainer.py] => img_size: 224
2025-01-08 11:32:03,660 [trainer.py] => generator_lr: 0.005
2025-01-08 11:32:03,660 [trainer.py] => pi: 100
2025-01-08 11:32:03,660 [trainer.py] => w_bn: 50.0
2025-01-08 11:32:03,660 [trainer.py] => w_noise: 0.001
2025-01-08 11:32:03,660 [trainer.py] => server_ss: 32
2025-01-08 11:32:03,660 [trainer.py] => bn_loss: 1
2025-01-08 11:32:03,660 [trainer.py] => noise: 1
2025-01-08 11:32:03,660 [trainer.py] => ie_loss: 1
2025-01-08 11:32:03,660 [trainer.py] => act_loss: 0
2025-01-08 11:32:03,660 [trainer.py] => w_ie: 1.0
2025-01-08 11:32:03,661 [trainer.py] => w_act: 0.1
2025-01-08 11:32:03,661 [trainer.py] => syn_size: 32
2025-01-08 11:32:03,661 [trainer.py] => need_syn_imgs: True
2025-01-08 11:32:03,661 [trainer.py] => g_local_bs: 42
2025-01-08 11:32:03,661 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 11:32:03,661 [trainer.py] => g_local_train_steps: 10
2025-01-08 11:32:03,661 [trainer.py] => dataset_syn: cifar100
2025-01-08 11:32:03,661 [trainer.py] => com_round_gen: 10
2025-01-08 11:32:03,661 [trainer.py] => g_sigma: 0
2025-01-08 11:32:03,661 [trainer.py] => save_cls_embeds: False
2025-01-08 11:32:03,661 [trainer.py] => syn_image_path: outputs/syn_image_10_1
2025-01-08 11:32:03,661 [trainer.py] => save_dir: outputs
2025-01-08 11:32:03,661 [trainer.py] => n_iter: 5
2025-01-08 11:32:03,661 [trainer.py] => num_users: 1
2025-01-08 11:32:03,661 [trainer.py] => cur_size: 50
2025-01-08 11:32:03,661 [trainer.py] => local_bs: 12
2025-01-08 11:32:03,661 [trainer.py] => vpt_type: Deep
2025-01-08 11:32:03,661 [trainer.py] => prompt_token_num: 6
2025-01-08 11:32:03,661 [trainer.py] => avg_alpha: 0.8
2025-01-08 11:32:03,661 [trainer.py] => perturb_var: 1
2025-01-08 11:32:03,661 [trainer.py] => EMA_beta: 0.99
2025-01-08 11:32:03,661 [trainer.py] => anchor_lambda: 0.1
2025-01-08 11:32:03,661 [trainer.py] => kl_weight: 0.001
2025-01-08 11:32:03,661 [trainer.py] => TIP_init: zero
2025-01-08 11:32:03,661 [trainer.py] => tuned_epoch: 10
2025-01-08 11:32:03,661 [trainer.py] => fs_epoch: 0
2025-01-08 11:32:03,661 [trainer.py] => init_lr: 0.01
2025-01-08 11:32:03,661 [trainer.py] => fs_lr: 0.001
2025-01-08 11:32:03,661 [trainer.py] => batch_size: 48
2025-01-08 11:32:03,661 [trainer.py] => fs_batch_size: 16
2025-01-08 11:32:03,661 [trainer.py] => weight_decay: 0.0005
2025-01-08 11:32:03,661 [trainer.py] => min_lr: 0
2025-01-08 11:32:03,661 [trainer.py] => optimizer: sgd
2025-01-08 11:32:03,661 [trainer.py] => memory_size: 0
2025-01-08 11:32:03,661 [trainer.py] => memory_per_class: 0
2025-01-08 11:32:03,662 [trainer.py] => fixed_memory: False
2025-01-08 11:32:03,662 [trainer.py] => shuffle: False
2025-01-08 11:32:03,662 [trainer.py] => top_k: 5
2025-01-08 11:32:03,662 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 11:32:03,662 [trainer.py] => prefix: asp
2025-01-08 11:32:03,662 [trainer.py] => model_prefix: asp
2025-01-08 11:32:05,147 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 11:32:30,329 [trainer.py] => All params: 173596160
2025-01-08 11:32:30,330 [trainer.py] => Trainable params: 1998848
2025-01-08 11:32:30,331 [asp.py] => Learning on 0-5
2025-01-08 11:32:30,345 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 11:50:21,910 [asp.py] => total parameters: 173600001
2025-01-08 11:50:21,911 [asp.py] => trainable parameters: 2002689
2025-01-08 11:57:25,471 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 11:57:25,472 [trainer.py] => model_name: asp
2025-01-08 11:57:25,472 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 11:57:25,472 [trainer.py] => device: ['cuda']
2025-01-08 11:57:25,472 [trainer.py] => seed: 2024
2025-01-08 11:57:25,473 [trainer.py] => dataset: cifar224
2025-01-08 11:57:25,473 [trainer.py] => init_cls: 5
2025-01-08 11:57:25,473 [trainer.py] => increment: 5
2025-01-08 11:57:25,473 [trainer.py] => kshot: 5
2025-01-08 11:57:25,473 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 11:57:25,473 [trainer.py] => z_dim: 1000
2025-01-08 11:57:25,473 [trainer.py] => conv_dim: 64
2025-01-08 11:57:25,473 [trainer.py] => img_size: 224
2025-01-08 11:57:25,473 [trainer.py] => generator_lr: 0.005
2025-01-08 11:57:25,473 [trainer.py] => pi: 100
2025-01-08 11:57:25,474 [trainer.py] => w_bn: 50.0
2025-01-08 11:57:25,474 [trainer.py] => w_noise: 0.001
2025-01-08 11:57:25,474 [trainer.py] => server_ss: 32
2025-01-08 11:57:25,474 [trainer.py] => bn_loss: 1
2025-01-08 11:57:25,474 [trainer.py] => noise: 1
2025-01-08 11:57:25,474 [trainer.py] => ie_loss: 1
2025-01-08 11:57:25,474 [trainer.py] => act_loss: 0
2025-01-08 11:57:25,474 [trainer.py] => w_ie: 1.0
2025-01-08 11:57:25,474 [trainer.py] => w_act: 0.1
2025-01-08 11:57:25,474 [trainer.py] => syn_size: 32
2025-01-08 11:57:25,475 [trainer.py] => need_syn_imgs: True
2025-01-08 11:57:25,475 [trainer.py] => g_local_bs: 42
2025-01-08 11:57:25,475 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 11:57:25,475 [trainer.py] => g_local_train_steps: 10
2025-01-08 11:57:25,475 [trainer.py] => dataset_syn: cifar100
2025-01-08 11:57:25,475 [trainer.py] => com_round_gen: 10
2025-01-08 11:57:25,475 [trainer.py] => g_sigma: 0
2025-01-08 11:57:25,475 [trainer.py] => save_cls_embeds: False
2025-01-08 11:57:25,475 [trainer.py] => syn_image_path: outputs/syn_image_10_1
2025-01-08 11:57:25,475 [trainer.py] => save_dir: outputs
2025-01-08 11:57:25,475 [trainer.py] => n_iter: 5
2025-01-08 11:57:25,475 [trainer.py] => num_users: 1
2025-01-08 11:57:25,475 [trainer.py] => cur_size: 50
2025-01-08 11:57:25,476 [trainer.py] => local_bs: 12
2025-01-08 11:57:25,476 [trainer.py] => vpt_type: Deep
2025-01-08 11:57:25,476 [trainer.py] => prompt_token_num: 6
2025-01-08 11:57:25,476 [trainer.py] => avg_alpha: 0.8
2025-01-08 11:57:25,476 [trainer.py] => perturb_var: 1
2025-01-08 11:57:25,476 [trainer.py] => EMA_beta: 0.99
2025-01-08 11:57:25,476 [trainer.py] => anchor_lambda: 0.1
2025-01-08 11:57:25,476 [trainer.py] => kl_weight: 0.001
2025-01-08 11:57:25,476 [trainer.py] => TIP_init: zero
2025-01-08 11:57:25,476 [trainer.py] => tuned_epoch: 10
2025-01-08 11:57:25,476 [trainer.py] => fs_epoch: 0
2025-01-08 11:57:25,476 [trainer.py] => init_lr: 0.01
2025-01-08 11:57:25,477 [trainer.py] => fs_lr: 0.001
2025-01-08 11:57:25,477 [trainer.py] => batch_size: 48
2025-01-08 11:57:25,477 [trainer.py] => fs_batch_size: 16
2025-01-08 11:57:25,477 [trainer.py] => weight_decay: 0.0005
2025-01-08 11:57:25,477 [trainer.py] => min_lr: 0
2025-01-08 11:57:25,477 [trainer.py] => optimizer: sgd
2025-01-08 11:57:25,477 [trainer.py] => memory_size: 0
2025-01-08 11:57:25,477 [trainer.py] => memory_per_class: 0
2025-01-08 11:57:25,477 [trainer.py] => fixed_memory: False
2025-01-08 11:57:25,477 [trainer.py] => shuffle: False
2025-01-08 11:57:25,477 [trainer.py] => top_k: 5
2025-01-08 11:57:25,477 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 11:57:25,478 [trainer.py] => prefix: asp
2025-01-08 11:57:25,478 [trainer.py] => model_prefix: asp
2025-01-08 11:57:27,121 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 11:57:57,245 [trainer.py] => All params: 173596160
2025-01-08 11:57:57,249 [trainer.py] => Trainable params: 1998848
2025-01-08 11:57:57,250 [asp.py] => Learning on 0-5
2025-01-08 11:57:57,255 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 12:14:03,060 [asp.py] => total parameters: 173600001
2025-01-08 12:14:03,065 [asp.py] => trainable parameters: 2002689
2025-01-08 12:20:34,760 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 12:20:34,760 [trainer.py] => model_name: asp
2025-01-08 12:20:34,761 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 12:20:34,761 [trainer.py] => device: ['cuda']
2025-01-08 12:20:34,761 [trainer.py] => seed: 2024
2025-01-08 12:20:34,761 [trainer.py] => dataset: cifar224
2025-01-08 12:20:34,761 [trainer.py] => init_cls: 5
2025-01-08 12:20:34,761 [trainer.py] => increment: 5
2025-01-08 12:20:34,761 [trainer.py] => kshot: 5
2025-01-08 12:20:34,761 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 12:20:34,761 [trainer.py] => z_dim: 1000
2025-01-08 12:20:34,761 [trainer.py] => conv_dim: 64
2025-01-08 12:20:34,761 [trainer.py] => img_size: 224
2025-01-08 12:20:34,761 [trainer.py] => generator_lr: 0.005
2025-01-08 12:20:34,762 [trainer.py] => pi: 100
2025-01-08 12:20:34,762 [trainer.py] => w_bn: 50.0
2025-01-08 12:20:34,762 [trainer.py] => w_noise: 0.001
2025-01-08 12:20:34,762 [trainer.py] => server_ss: 32
2025-01-08 12:20:34,762 [trainer.py] => bn_loss: 1
2025-01-08 12:20:34,762 [trainer.py] => noise: 1
2025-01-08 12:20:34,762 [trainer.py] => ie_loss: 1
2025-01-08 12:20:34,762 [trainer.py] => act_loss: 0
2025-01-08 12:20:34,762 [trainer.py] => w_ie: 1.0
2025-01-08 12:20:34,762 [trainer.py] => w_act: 0.1
2025-01-08 12:20:34,762 [trainer.py] => syn_size: 32
2025-01-08 12:20:34,762 [trainer.py] => need_syn_imgs: True
2025-01-08 12:20:34,763 [trainer.py] => g_local_bs: 42
2025-01-08 12:20:34,763 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 12:20:34,763 [trainer.py] => g_local_train_steps: 10
2025-01-08 12:20:34,763 [trainer.py] => dataset_syn: cifar100
2025-01-08 12:20:34,763 [trainer.py] => com_round_gen: 10
2025-01-08 12:20:34,763 [trainer.py] => g_sigma: 0
2025-01-08 12:20:34,763 [trainer.py] => save_cls_embeds: False
2025-01-08 12:20:34,763 [trainer.py] => syn_image_path: outputs/syn_image_10_1
2025-01-08 12:20:34,763 [trainer.py] => save_dir: outputs
2025-01-08 12:20:34,763 [trainer.py] => n_iter: 5
2025-01-08 12:20:34,763 [trainer.py] => num_users: 1
2025-01-08 12:20:34,763 [trainer.py] => cur_size: 50
2025-01-08 12:20:34,763 [trainer.py] => local_bs: 5
2025-01-08 12:20:34,764 [trainer.py] => vpt_type: Deep
2025-01-08 12:20:34,764 [trainer.py] => prompt_token_num: 6
2025-01-08 12:20:34,764 [trainer.py] => avg_alpha: 0.8
2025-01-08 12:20:34,764 [trainer.py] => perturb_var: 1
2025-01-08 12:20:34,764 [trainer.py] => EMA_beta: 0.99
2025-01-08 12:20:34,764 [trainer.py] => anchor_lambda: 0.1
2025-01-08 12:20:34,764 [trainer.py] => kl_weight: 0.001
2025-01-08 12:20:34,764 [trainer.py] => TIP_init: zero
2025-01-08 12:20:34,764 [trainer.py] => tuned_epoch: 10
2025-01-08 12:20:34,764 [trainer.py] => fs_epoch: 0
2025-01-08 12:20:34,764 [trainer.py] => init_lr: 0.01
2025-01-08 12:20:34,764 [trainer.py] => fs_lr: 0.001
2025-01-08 12:20:34,764 [trainer.py] => batch_size: 48
2025-01-08 12:20:34,765 [trainer.py] => fs_batch_size: 16
2025-01-08 12:20:34,765 [trainer.py] => weight_decay: 0.0005
2025-01-08 12:20:34,765 [trainer.py] => min_lr: 0
2025-01-08 12:20:34,765 [trainer.py] => optimizer: sgd
2025-01-08 12:20:34,765 [trainer.py] => memory_size: 0
2025-01-08 12:20:34,765 [trainer.py] => memory_per_class: 0
2025-01-08 12:20:34,765 [trainer.py] => fixed_memory: False
2025-01-08 12:20:34,765 [trainer.py] => shuffle: False
2025-01-08 12:20:34,765 [trainer.py] => top_k: 5
2025-01-08 12:20:34,765 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 12:20:34,765 [trainer.py] => prefix: asp
2025-01-08 12:20:34,765 [trainer.py] => model_prefix: asp
2025-01-08 12:20:36,309 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 12:21:05,195 [trainer.py] => All params: 173596160
2025-01-08 12:21:05,200 [trainer.py] => Trainable params: 1998848
2025-01-08 12:21:05,201 [asp.py] => Learning on 0-5
2025-01-08 12:21:05,207 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 12:37:13,782 [asp.py] => total parameters: 173600001
2025-01-08 12:37:13,787 [asp.py] => trainable parameters: 2002689
2025-01-08 12:45:09,814 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 12:45:09,815 [trainer.py] => model_name: asp
2025-01-08 12:45:09,815 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 12:45:09,815 [trainer.py] => device: ['cuda']
2025-01-08 12:45:09,815 [trainer.py] => seed: 2024
2025-01-08 12:45:09,815 [trainer.py] => dataset: cifar224
2025-01-08 12:45:09,815 [trainer.py] => init_cls: 5
2025-01-08 12:45:09,815 [trainer.py] => increment: 5
2025-01-08 12:45:09,816 [trainer.py] => kshot: 5
2025-01-08 12:45:09,816 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 12:45:09,816 [trainer.py] => z_dim: 1000
2025-01-08 12:45:09,816 [trainer.py] => conv_dim: 64
2025-01-08 12:45:09,816 [trainer.py] => img_size: 224
2025-01-08 12:45:09,816 [trainer.py] => generator_lr: 0.005
2025-01-08 12:45:09,816 [trainer.py] => pi: 100
2025-01-08 12:45:09,816 [trainer.py] => w_bn: 50.0
2025-01-08 12:45:09,816 [trainer.py] => w_noise: 0.001
2025-01-08 12:45:09,816 [trainer.py] => server_ss: 32
2025-01-08 12:45:09,817 [trainer.py] => bn_loss: 1
2025-01-08 12:45:09,817 [trainer.py] => noise: 1
2025-01-08 12:45:09,817 [trainer.py] => ie_loss: 1
2025-01-08 12:45:09,817 [trainer.py] => act_loss: 0
2025-01-08 12:45:09,817 [trainer.py] => w_ie: 1.0
2025-01-08 12:45:09,817 [trainer.py] => w_act: 0.1
2025-01-08 12:45:09,817 [trainer.py] => syn_size: 32
2025-01-08 12:45:09,817 [trainer.py] => need_syn_imgs: True
2025-01-08 12:45:09,817 [trainer.py] => g_local_bs: 42
2025-01-08 12:45:09,817 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 12:45:09,818 [trainer.py] => g_local_train_steps: 10
2025-01-08 12:45:09,818 [trainer.py] => dataset_syn: cifar100
2025-01-08 12:45:09,818 [trainer.py] => com_round_gen: 10
2025-01-08 12:45:09,818 [trainer.py] => g_sigma: 0
2025-01-08 12:45:09,818 [trainer.py] => save_cls_embeds: False
2025-01-08 12:45:09,818 [trainer.py] => syn_image_path: outputs/syn_image_10_5
2025-01-08 12:45:09,818 [trainer.py] => save_dir: outputs
2025-01-08 12:45:09,818 [trainer.py] => n_iter: 5
2025-01-08 12:45:09,818 [trainer.py] => num_users: 1
2025-01-08 12:45:09,818 [trainer.py] => cur_size: 50
2025-01-08 12:45:09,818 [trainer.py] => local_bs: 5
2025-01-08 12:45:09,819 [trainer.py] => vpt_type: Deep
2025-01-08 12:45:09,819 [trainer.py] => prompt_token_num: 6
2025-01-08 12:45:09,819 [trainer.py] => avg_alpha: 0.8
2025-01-08 12:45:09,819 [trainer.py] => perturb_var: 1
2025-01-08 12:45:09,819 [trainer.py] => EMA_beta: 0.99
2025-01-08 12:45:09,819 [trainer.py] => anchor_lambda: 0.1
2025-01-08 12:45:09,819 [trainer.py] => kl_weight: 0.001
2025-01-08 12:45:09,819 [trainer.py] => TIP_init: zero
2025-01-08 12:45:09,819 [trainer.py] => tuned_epoch: 10
2025-01-08 12:45:09,819 [trainer.py] => fs_epoch: 0
2025-01-08 12:45:09,820 [trainer.py] => init_lr: 0.01
2025-01-08 12:45:09,820 [trainer.py] => fs_lr: 0.001
2025-01-08 12:45:09,820 [trainer.py] => batch_size: 48
2025-01-08 12:45:09,820 [trainer.py] => fs_batch_size: 16
2025-01-08 12:45:09,820 [trainer.py] => weight_decay: 0.0005
2025-01-08 12:45:09,820 [trainer.py] => min_lr: 0
2025-01-08 12:45:09,820 [trainer.py] => optimizer: sgd
2025-01-08 12:45:09,820 [trainer.py] => memory_size: 0
2025-01-08 12:45:09,821 [trainer.py] => memory_per_class: 0
2025-01-08 12:45:09,821 [trainer.py] => fixed_memory: False
2025-01-08 12:45:09,821 [trainer.py] => shuffle: False
2025-01-08 12:45:09,821 [trainer.py] => top_k: 5
2025-01-08 12:45:09,821 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 12:45:09,821 [trainer.py] => prefix: asp
2025-01-08 12:45:09,821 [trainer.py] => model_prefix: asp
2025-01-08 12:45:11,621 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 12:45:41,208 [trainer.py] => All params: 173596160
2025-01-08 12:45:41,212 [trainer.py] => Trainable params: 1998848
2025-01-08 12:45:41,213 [asp.py] => Learning on 0-5
2025-01-08 12:45:41,218 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 13:01:53,013 [asp.py] => total parameters: 173600001
2025-01-08 13:01:53,018 [asp.py] => trainable parameters: 2002689
2025-01-08 13:56:32,118 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 13:56:32,118 [trainer.py] => model_name: asp
2025-01-08 13:56:32,118 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 13:56:32,118 [trainer.py] => device: ['cuda']
2025-01-08 13:56:32,118 [trainer.py] => seed: 2024
2025-01-08 13:56:32,118 [trainer.py] => dataset: cifar224
2025-01-08 13:56:32,118 [trainer.py] => init_cls: 5
2025-01-08 13:56:32,118 [trainer.py] => increment: 5
2025-01-08 13:56:32,118 [trainer.py] => kshot: 5
2025-01-08 13:56:32,118 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 13:56:32,118 [trainer.py] => z_dim: 1000
2025-01-08 13:56:32,118 [trainer.py] => conv_dim: 64
2025-01-08 13:56:32,118 [trainer.py] => img_size: 224
2025-01-08 13:56:32,118 [trainer.py] => generator_lr: 0.005
2025-01-08 13:56:32,118 [trainer.py] => pi: 100
2025-01-08 13:56:32,118 [trainer.py] => w_bn: 50.0
2025-01-08 13:56:32,118 [trainer.py] => w_noise: 0.001
2025-01-08 13:56:32,119 [trainer.py] => server_ss: 32
2025-01-08 13:56:32,119 [trainer.py] => bn_loss: 1
2025-01-08 13:56:32,119 [trainer.py] => noise: 1
2025-01-08 13:56:32,119 [trainer.py] => ie_loss: 1
2025-01-08 13:56:32,119 [trainer.py] => act_loss: 0
2025-01-08 13:56:32,119 [trainer.py] => w_ie: 1.0
2025-01-08 13:56:32,119 [trainer.py] => w_act: 0.1
2025-01-08 13:56:32,119 [trainer.py] => syn_size: 32
2025-01-08 13:56:32,119 [trainer.py] => need_syn_imgs: True
2025-01-08 13:56:32,119 [trainer.py] => g_local_bs: 42
2025-01-08 13:56:32,119 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 13:56:32,119 [trainer.py] => g_local_train_steps: 10
2025-01-08 13:56:32,119 [trainer.py] => dataset_syn: cifar100
2025-01-08 13:56:32,119 [trainer.py] => com_round_gen: 10
2025-01-08 13:56:32,119 [trainer.py] => g_sigma: 0
2025-01-08 13:56:32,119 [trainer.py] => save_cls_embeds: False
2025-01-08 13:56:32,119 [trainer.py] => syn_image_path: outputs/syn_image_10_5
2025-01-08 13:56:32,119 [trainer.py] => save_dir: outputs
2025-01-08 13:56:32,119 [trainer.py] => n_iter: 5
2025-01-08 13:56:32,119 [trainer.py] => num_users: 1
2025-01-08 13:56:32,119 [trainer.py] => cur_size: 50
2025-01-08 13:56:32,119 [trainer.py] => local_bs: 5
2025-01-08 13:56:32,119 [trainer.py] => vpt_type: Deep
2025-01-08 13:56:32,119 [trainer.py] => prompt_token_num: 6
2025-01-08 13:56:32,119 [trainer.py] => avg_alpha: 0.8
2025-01-08 13:56:32,119 [trainer.py] => perturb_var: 1
2025-01-08 13:56:32,119 [trainer.py] => EMA_beta: 0.99
2025-01-08 13:56:32,119 [trainer.py] => anchor_lambda: 0.1
2025-01-08 13:56:32,119 [trainer.py] => kl_weight: 0.001
2025-01-08 13:56:32,119 [trainer.py] => TIP_init: zero
2025-01-08 13:56:32,119 [trainer.py] => tuned_epoch: 10
2025-01-08 13:56:32,119 [trainer.py] => fs_epoch: 0
2025-01-08 13:56:32,119 [trainer.py] => init_lr: 0.01
2025-01-08 13:56:32,119 [trainer.py] => fs_lr: 0.001
2025-01-08 13:56:32,119 [trainer.py] => batch_size: 48
2025-01-08 13:56:32,119 [trainer.py] => fs_batch_size: 16
2025-01-08 13:56:32,120 [trainer.py] => weight_decay: 0.0005
2025-01-08 13:56:32,120 [trainer.py] => min_lr: 0
2025-01-08 13:56:32,120 [trainer.py] => optimizer: sgd
2025-01-08 13:56:32,120 [trainer.py] => memory_size: 0
2025-01-08 13:56:32,120 [trainer.py] => memory_per_class: 0
2025-01-08 13:56:32,120 [trainer.py] => fixed_memory: False
2025-01-08 13:56:32,120 [trainer.py] => shuffle: False
2025-01-08 13:56:32,120 [trainer.py] => top_k: 5
2025-01-08 13:56:32,120 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 13:56:32,120 [trainer.py] => prefix: asp
2025-01-08 13:56:32,120 [trainer.py] => model_prefix: asp
2025-01-08 13:56:33,740 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 13:56:59,992 [trainer.py] => All params: 173596160
2025-01-08 13:56:59,994 [trainer.py] => Trainable params: 1998848
2025-01-08 13:56:59,995 [asp.py] => Learning on 0-5
2025-01-08 13:57:00,000 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 14:14:13,505 [asp.py] => total parameters: 173600001
2025-01-08 14:14:13,506 [asp.py] => trainable parameters: 2002689
2025-01-08 14:15:21,299 [asp.py] => Task 0, Epoch 1 => Loss 1.235, Train_accy 81.49, Test_curr_accy 98.20, Test_accy 98.20
2025-01-08 14:16:28,224 [asp.py] => Task 0, Epoch 2 => Loss 0.552, Train_accy 93.02, Test_curr_accy 99.00, Test_accy 99.00
2025-01-08 14:17:34,671 [asp.py] => Task 0, Epoch 3 => Loss 0.452, Train_accy 92.76, Test_curr_accy 99.00, Test_accy 99.00
2025-01-08 14:18:41,823 [asp.py] => Task 0, Epoch 4 => Loss 0.427, Train_accy 93.89, Test_curr_accy 99.20, Test_accy 99.20
2025-01-08 14:19:48,476 [asp.py] => Task 0, Epoch 5 => Loss 0.329, Train_accy 94.11, Test_curr_accy 98.60, Test_accy 98.60
2025-01-08 14:20:55,487 [asp.py] => Task 0, Epoch 6 => Loss 0.277, Train_accy 95.20, Test_curr_accy 98.80, Test_accy 98.80
2025-01-08 14:22:02,195 [asp.py] => Task 0, Epoch 7 => Loss 0.257, Train_accy 94.65, Test_curr_accy 99.00, Test_accy 99.00
2025-01-08 14:23:08,811 [asp.py] => Task 0, Epoch 8 => Loss 0.266, Train_accy 94.36, Test_curr_accy 99.00, Test_accy 99.00
2025-01-08 14:24:15,325 [asp.py] => Task 0, Epoch 9 => Loss 0.217, Train_accy 95.35, Test_curr_accy 99.00, Test_accy 99.00
2025-01-08 14:25:21,550 [asp.py] => Task 0, Epoch 10 => Loss 0.199, Train_accy 95.78, Test_curr_accy 99.40, Test_accy 99.40
2025-01-08 14:25:44,470 [trainer.py] => Top1 curve: [99.0]
2025-01-08 14:25:44,470 [trainer.py] => Average Accuracy (Top1): 99.0   (Harmonic Accuracy): None (Old Acc): 99.0 (New Acc): [] 

2025-01-08 14:25:44,471 [trainer.py] => All params: 173600001
2025-01-08 14:25:44,472 [trainer.py] => Trainable params: 2002689
2025-01-08 14:25:44,474 [asp.py] => Learning on 5-10
2025-01-08 14:25:44,484 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-08 14:43:28,770 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 14:43:28,770 [trainer.py] => model_name: asp
2025-01-08 14:43:28,770 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 14:43:28,770 [trainer.py] => device: ['cuda']
2025-01-08 14:43:28,770 [trainer.py] => seed: 2024
2025-01-08 14:43:28,770 [trainer.py] => dataset: cifar224
2025-01-08 14:43:28,770 [trainer.py] => init_cls: 5
2025-01-08 14:43:28,770 [trainer.py] => increment: 5
2025-01-08 14:43:28,770 [trainer.py] => kshot: 5
2025-01-08 14:43:28,770 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 14:43:28,770 [trainer.py] => z_dim: 1000
2025-01-08 14:43:28,770 [trainer.py] => conv_dim: 64
2025-01-08 14:43:28,770 [trainer.py] => img_size: 224
2025-01-08 14:43:28,770 [trainer.py] => generator_lr: 0.005
2025-01-08 14:43:28,770 [trainer.py] => pi: 100
2025-01-08 14:43:28,770 [trainer.py] => w_bn: 50.0
2025-01-08 14:43:28,770 [trainer.py] => w_noise: 0.001
2025-01-08 14:43:28,770 [trainer.py] => server_ss: 32
2025-01-08 14:43:28,771 [trainer.py] => bn_loss: 1
2025-01-08 14:43:28,771 [trainer.py] => noise: 1
2025-01-08 14:43:28,771 [trainer.py] => ie_loss: 1
2025-01-08 14:43:28,771 [trainer.py] => act_loss: 0
2025-01-08 14:43:28,771 [trainer.py] => w_ie: 1.0
2025-01-08 14:43:28,771 [trainer.py] => w_act: 0.1
2025-01-08 14:43:28,771 [trainer.py] => syn_size: 32
2025-01-08 14:43:28,771 [trainer.py] => need_syn_imgs: True
2025-01-08 14:43:28,771 [trainer.py] => g_local_bs: 42
2025-01-08 14:43:28,771 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 14:43:28,771 [trainer.py] => g_local_train_steps: 10
2025-01-08 14:43:28,771 [trainer.py] => dataset_syn: cifar100
2025-01-08 14:43:28,771 [trainer.py] => com_round_gen: 10
2025-01-08 14:43:28,771 [trainer.py] => g_sigma: 0
2025-01-08 14:43:28,771 [trainer.py] => save_cls_embeds: False
2025-01-08 14:43:28,771 [trainer.py] => syn_image_path: outputs/syn_image_10_5
2025-01-08 14:43:28,771 [trainer.py] => save_dir: outputs
2025-01-08 14:43:28,771 [trainer.py] => n_iter: 5
2025-01-08 14:43:28,771 [trainer.py] => num_users: 1
2025-01-08 14:43:28,771 [trainer.py] => cur_size: 50
2025-01-08 14:43:28,771 [trainer.py] => local_bs: 5
2025-01-08 14:43:28,771 [trainer.py] => vpt_type: Deep
2025-01-08 14:43:28,771 [trainer.py] => prompt_token_num: 6
2025-01-08 14:43:28,771 [trainer.py] => avg_alpha: 0.8
2025-01-08 14:43:28,771 [trainer.py] => perturb_var: 1
2025-01-08 14:43:28,771 [trainer.py] => EMA_beta: 0.99
2025-01-08 14:43:28,771 [trainer.py] => anchor_lambda: 0.1
2025-01-08 14:43:28,771 [trainer.py] => kl_weight: 0.001
2025-01-08 14:43:28,771 [trainer.py] => TIP_init: zero
2025-01-08 14:43:28,771 [trainer.py] => tuned_epoch: 10
2025-01-08 14:43:28,771 [trainer.py] => fs_epoch: 0
2025-01-08 14:43:28,771 [trainer.py] => init_lr: 0.01
2025-01-08 14:43:28,771 [trainer.py] => fs_lr: 0.001
2025-01-08 14:43:28,771 [trainer.py] => batch_size: 48
2025-01-08 14:43:28,771 [trainer.py] => fs_batch_size: 16
2025-01-08 14:43:28,771 [trainer.py] => weight_decay: 0.0005
2025-01-08 14:43:28,771 [trainer.py] => min_lr: 0
2025-01-08 14:43:28,772 [trainer.py] => optimizer: sgd
2025-01-08 14:43:28,772 [trainer.py] => memory_size: 0
2025-01-08 14:43:28,772 [trainer.py] => memory_per_class: 0
2025-01-08 14:43:28,772 [trainer.py] => fixed_memory: False
2025-01-08 14:43:28,772 [trainer.py] => shuffle: False
2025-01-08 14:43:28,772 [trainer.py] => top_k: 5
2025-01-08 14:43:28,772 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 14:43:28,772 [trainer.py] => prefix: asp
2025-01-08 14:43:28,772 [trainer.py] => model_prefix: asp
2025-01-08 14:43:30,381 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 14:43:54,080 [trainer.py] => All params: 173596160
2025-01-08 14:43:54,081 [trainer.py] => Trainable params: 1998848
2025-01-08 14:43:54,081 [asp.py] => Learning on 0-5
2025-01-08 14:43:54,087 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 14:43:54,873 [asp.py] => total parameters: 173600001
2025-01-08 14:43:54,873 [asp.py] => trainable parameters: 2002689
2025-01-08 14:45:00,042 [asp.py] => Task 0, Epoch 1 => Loss 1.423, Train_accy 76.73, Test_curr_accy 97.40, Test_accy 97.40
2025-01-08 14:46:33,127 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 14:46:33,127 [trainer.py] => model_name: asp
2025-01-08 14:46:33,127 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 14:46:33,127 [trainer.py] => device: ['cuda']
2025-01-08 14:46:33,128 [trainer.py] => seed: 2024
2025-01-08 14:46:33,128 [trainer.py] => dataset: cifar224
2025-01-08 14:46:33,128 [trainer.py] => init_cls: 5
2025-01-08 14:46:33,128 [trainer.py] => increment: 5
2025-01-08 14:46:33,128 [trainer.py] => kshot: 5
2025-01-08 14:46:33,128 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 14:46:33,128 [trainer.py] => z_dim: 1000
2025-01-08 14:46:33,128 [trainer.py] => conv_dim: 64
2025-01-08 14:46:33,128 [trainer.py] => img_size: 224
2025-01-08 14:46:33,128 [trainer.py] => generator_lr: 0.005
2025-01-08 14:46:33,128 [trainer.py] => pi: 100
2025-01-08 14:46:33,128 [trainer.py] => w_bn: 50.0
2025-01-08 14:46:33,128 [trainer.py] => w_noise: 0.001
2025-01-08 14:46:33,128 [trainer.py] => server_ss: 32
2025-01-08 14:46:33,128 [trainer.py] => bn_loss: 1
2025-01-08 14:46:33,128 [trainer.py] => noise: 1
2025-01-08 14:46:33,128 [trainer.py] => ie_loss: 1
2025-01-08 14:46:33,128 [trainer.py] => act_loss: 0
2025-01-08 14:46:33,128 [trainer.py] => w_ie: 1.0
2025-01-08 14:46:33,128 [trainer.py] => w_act: 0.1
2025-01-08 14:46:33,128 [trainer.py] => syn_size: 32
2025-01-08 14:46:33,128 [trainer.py] => need_syn_imgs: True
2025-01-08 14:46:33,128 [trainer.py] => g_local_bs: 42
2025-01-08 14:46:33,128 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 14:46:33,128 [trainer.py] => g_local_train_steps: 10
2025-01-08 14:46:33,128 [trainer.py] => dataset_syn: cifar100
2025-01-08 14:46:33,128 [trainer.py] => com_round_gen: 10
2025-01-08 14:46:33,128 [trainer.py] => g_sigma: 0
2025-01-08 14:46:33,128 [trainer.py] => save_cls_embeds: False
2025-01-08 14:46:33,128 [trainer.py] => syn_image_path: outputs/syn_image_10_5
2025-01-08 14:46:33,128 [trainer.py] => save_dir: outputs
2025-01-08 14:46:33,128 [trainer.py] => n_iter: 5
2025-01-08 14:46:33,128 [trainer.py] => num_users: 1
2025-01-08 14:46:33,128 [trainer.py] => cur_size: 50
2025-01-08 14:46:33,128 [trainer.py] => local_bs: 5
2025-01-08 14:46:33,128 [trainer.py] => vpt_type: Deep
2025-01-08 14:46:33,128 [trainer.py] => prompt_token_num: 6
2025-01-08 14:46:33,129 [trainer.py] => avg_alpha: 0.8
2025-01-08 14:46:33,129 [trainer.py] => perturb_var: 1
2025-01-08 14:46:33,129 [trainer.py] => EMA_beta: 0.99
2025-01-08 14:46:33,129 [trainer.py] => anchor_lambda: 0.1
2025-01-08 14:46:33,129 [trainer.py] => kl_weight: 0.001
2025-01-08 14:46:33,129 [trainer.py] => TIP_init: zero
2025-01-08 14:46:33,129 [trainer.py] => tuned_epoch: 10
2025-01-08 14:46:33,129 [trainer.py] => fs_epoch: 0
2025-01-08 14:46:33,129 [trainer.py] => init_lr: 0.01
2025-01-08 14:46:33,129 [trainer.py] => fs_lr: 0.001
2025-01-08 14:46:33,129 [trainer.py] => batch_size: 48
2025-01-08 14:46:33,129 [trainer.py] => fs_batch_size: 16
2025-01-08 14:46:33,129 [trainer.py] => weight_decay: 0.0005
2025-01-08 14:46:33,129 [trainer.py] => min_lr: 0
2025-01-08 14:46:33,129 [trainer.py] => optimizer: sgd
2025-01-08 14:46:33,129 [trainer.py] => memory_size: 0
2025-01-08 14:46:33,129 [trainer.py] => memory_per_class: 0
2025-01-08 14:46:33,129 [trainer.py] => fixed_memory: False
2025-01-08 14:46:33,129 [trainer.py] => shuffle: False
2025-01-08 14:46:33,129 [trainer.py] => top_k: 5
2025-01-08 14:46:33,129 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 14:46:33,129 [trainer.py] => prefix: asp
2025-01-08 14:46:33,129 [trainer.py] => model_prefix: asp
2025-01-08 14:46:34,609 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 14:47:03,462 [trainer.py] => All params: 173596160
2025-01-08 14:47:03,463 [trainer.py] => Trainable params: 1998848
2025-01-08 14:47:03,464 [asp.py] => Learning on 0-5
2025-01-08 14:47:03,469 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 14:50:39,284 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 14:50:39,284 [trainer.py] => model_name: asp
2025-01-08 14:50:39,284 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 14:50:39,285 [trainer.py] => device: ['cuda']
2025-01-08 14:50:39,285 [trainer.py] => seed: 2024
2025-01-08 14:50:39,285 [trainer.py] => dataset: cifar224
2025-01-08 14:50:39,285 [trainer.py] => init_cls: 5
2025-01-08 14:50:39,285 [trainer.py] => increment: 5
2025-01-08 14:50:39,285 [trainer.py] => kshot: 5
2025-01-08 14:50:39,285 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 14:50:39,285 [trainer.py] => z_dim: 1000
2025-01-08 14:50:39,285 [trainer.py] => conv_dim: 64
2025-01-08 14:50:39,285 [trainer.py] => img_size: 224
2025-01-08 14:50:39,285 [trainer.py] => generator_lr: 0.005
2025-01-08 14:50:39,285 [trainer.py] => pi: 100
2025-01-08 14:50:39,286 [trainer.py] => w_bn: 50.0
2025-01-08 14:50:39,286 [trainer.py] => w_noise: 0.001
2025-01-08 14:50:39,286 [trainer.py] => server_ss: 32
2025-01-08 14:50:39,286 [trainer.py] => bn_loss: 1
2025-01-08 14:50:39,286 [trainer.py] => noise: 1
2025-01-08 14:50:39,286 [trainer.py] => ie_loss: 1
2025-01-08 14:50:39,286 [trainer.py] => act_loss: 0
2025-01-08 14:50:39,286 [trainer.py] => w_ie: 1.0
2025-01-08 14:50:39,286 [trainer.py] => w_act: 0.1
2025-01-08 14:50:39,286 [trainer.py] => syn_size: 32
2025-01-08 14:50:39,286 [trainer.py] => need_syn_imgs: True
2025-01-08 14:50:39,286 [trainer.py] => g_local_bs: 42
2025-01-08 14:50:39,286 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 14:50:39,287 [trainer.py] => g_local_train_steps: 10
2025-01-08 14:50:39,287 [trainer.py] => dataset_syn: cifar100
2025-01-08 14:50:39,287 [trainer.py] => com_round_gen: 10
2025-01-08 14:50:39,287 [trainer.py] => g_sigma: 0
2025-01-08 14:50:39,287 [trainer.py] => save_cls_embeds: False
2025-01-08 14:50:39,287 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-08 14:50:39,287 [trainer.py] => save_dir: outputs
2025-01-08 14:50:39,287 [trainer.py] => n_iter: 5
2025-01-08 14:50:39,287 [trainer.py] => num_users: 1
2025-01-08 14:50:39,287 [trainer.py] => cur_size: 50
2025-01-08 14:50:39,287 [trainer.py] => local_bs: 5
2025-01-08 14:50:39,287 [trainer.py] => vpt_type: Deep
2025-01-08 14:50:39,287 [trainer.py] => prompt_token_num: 6
2025-01-08 14:50:39,288 [trainer.py] => avg_alpha: 0.8
2025-01-08 14:50:39,288 [trainer.py] => perturb_var: 1
2025-01-08 14:50:39,288 [trainer.py] => EMA_beta: 0.99
2025-01-08 14:50:39,288 [trainer.py] => anchor_lambda: 0.1
2025-01-08 14:50:39,288 [trainer.py] => kl_weight: 0.001
2025-01-08 14:50:39,288 [trainer.py] => TIP_init: zero
2025-01-08 14:50:39,288 [trainer.py] => tuned_epoch: 10
2025-01-08 14:50:39,288 [trainer.py] => fs_epoch: 0
2025-01-08 14:50:39,288 [trainer.py] => init_lr: 0.01
2025-01-08 14:50:39,288 [trainer.py] => fs_lr: 0.001
2025-01-08 14:50:39,288 [trainer.py] => batch_size: 48
2025-01-08 14:50:39,289 [trainer.py] => fs_batch_size: 16
2025-01-08 14:50:39,289 [trainer.py] => weight_decay: 0.0005
2025-01-08 14:50:39,289 [trainer.py] => min_lr: 0
2025-01-08 14:50:39,289 [trainer.py] => optimizer: sgd
2025-01-08 14:50:39,289 [trainer.py] => memory_size: 0
2025-01-08 14:50:39,289 [trainer.py] => memory_per_class: 0
2025-01-08 14:50:39,289 [trainer.py] => fixed_memory: False
2025-01-08 14:50:39,289 [trainer.py] => shuffle: False
2025-01-08 14:50:39,289 [trainer.py] => top_k: 5
2025-01-08 14:50:39,289 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 14:50:39,289 [trainer.py] => prefix: asp
2025-01-08 14:50:39,289 [trainer.py] => model_prefix: asp
2025-01-08 14:50:40,967 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 14:51:21,756 [trainer.py] => All params: 173596160
2025-01-08 14:51:21,760 [trainer.py] => Trainable params: 1998848
2025-01-08 14:51:21,762 [asp.py] => Learning on 0-5
2025-01-08 14:51:21,768 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 15:24:38,192 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 15:24:38,192 [trainer.py] => model_name: asp
2025-01-08 15:24:38,192 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 15:24:38,192 [trainer.py] => device: ['cuda']
2025-01-08 15:24:38,192 [trainer.py] => seed: 2024
2025-01-08 15:24:38,192 [trainer.py] => dataset: cifar224
2025-01-08 15:24:38,192 [trainer.py] => init_cls: 5
2025-01-08 15:24:38,192 [trainer.py] => increment: 5
2025-01-08 15:24:38,192 [trainer.py] => kshot: 5
2025-01-08 15:24:38,192 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 15:24:38,192 [trainer.py] => z_dim: 1000
2025-01-08 15:24:38,192 [trainer.py] => conv_dim: 64
2025-01-08 15:24:38,192 [trainer.py] => img_size: 224
2025-01-08 15:24:38,192 [trainer.py] => generator_lr: 0.005
2025-01-08 15:24:38,192 [trainer.py] => pi: 100
2025-01-08 15:24:38,192 [trainer.py] => w_bn: 50.0
2025-01-08 15:24:38,192 [trainer.py] => w_noise: 0.001
2025-01-08 15:24:38,192 [trainer.py] => server_ss: 32
2025-01-08 15:24:38,192 [trainer.py] => bn_loss: 1
2025-01-08 15:24:38,192 [trainer.py] => noise: 1
2025-01-08 15:24:38,192 [trainer.py] => ie_loss: 1
2025-01-08 15:24:38,192 [trainer.py] => act_loss: 0
2025-01-08 15:24:38,192 [trainer.py] => w_ie: 1.0
2025-01-08 15:24:38,192 [trainer.py] => w_act: 0.1
2025-01-08 15:24:38,192 [trainer.py] => syn_size: 32
2025-01-08 15:24:38,192 [trainer.py] => need_syn_imgs: True
2025-01-08 15:24:38,192 [trainer.py] => g_local_bs: 42
2025-01-08 15:24:38,192 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 15:24:38,192 [trainer.py] => g_local_train_steps: 10
2025-01-08 15:24:38,193 [trainer.py] => dataset_syn: cifar100
2025-01-08 15:24:38,193 [trainer.py] => com_round_gen: 10
2025-01-08 15:24:38,193 [trainer.py] => g_sigma: 0
2025-01-08 15:24:38,193 [trainer.py] => save_cls_embeds: False
2025-01-08 15:24:38,193 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-08 15:24:38,193 [trainer.py] => save_dir: outputs
2025-01-08 15:24:38,193 [trainer.py] => n_iter: 5
2025-01-08 15:24:38,193 [trainer.py] => num_users: 1
2025-01-08 15:24:38,193 [trainer.py] => cur_size: 50
2025-01-08 15:24:38,193 [trainer.py] => local_bs: 5
2025-01-08 15:24:38,193 [trainer.py] => vpt_type: Deep
2025-01-08 15:24:38,193 [trainer.py] => prompt_token_num: 6
2025-01-08 15:24:38,193 [trainer.py] => avg_alpha: 0.8
2025-01-08 15:24:38,193 [trainer.py] => perturb_var: 1
2025-01-08 15:24:38,193 [trainer.py] => EMA_beta: 0.99
2025-01-08 15:24:38,193 [trainer.py] => anchor_lambda: 0.1
2025-01-08 15:24:38,193 [trainer.py] => kl_weight: 0.001
2025-01-08 15:24:38,193 [trainer.py] => TIP_init: zero
2025-01-08 15:24:38,193 [trainer.py] => tuned_epoch: 10
2025-01-08 15:24:38,193 [trainer.py] => fs_epoch: 0
2025-01-08 15:24:38,193 [trainer.py] => init_lr: 0.01
2025-01-08 15:24:38,193 [trainer.py] => fs_lr: 0.001
2025-01-08 15:24:38,193 [trainer.py] => batch_size: 48
2025-01-08 15:24:38,193 [trainer.py] => fs_batch_size: 16
2025-01-08 15:24:38,193 [trainer.py] => weight_decay: 0.0005
2025-01-08 15:24:38,193 [trainer.py] => min_lr: 0
2025-01-08 15:24:38,193 [trainer.py] => optimizer: sgd
2025-01-08 15:24:38,193 [trainer.py] => memory_size: 0
2025-01-08 15:24:38,193 [trainer.py] => memory_per_class: 0
2025-01-08 15:24:38,193 [trainer.py] => fixed_memory: False
2025-01-08 15:24:38,193 [trainer.py] => shuffle: False
2025-01-08 15:24:38,193 [trainer.py] => top_k: 5
2025-01-08 15:24:38,193 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 15:24:38,193 [trainer.py] => prefix: asp
2025-01-08 15:24:38,193 [trainer.py] => model_prefix: asp
2025-01-08 15:24:39,837 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 15:25:04,285 [trainer.py] => All params: 173596160
2025-01-08 15:25:04,286 [trainer.py] => Trainable params: 1998848
2025-01-08 15:25:04,286 [asp.py] => Learning on 0-5
2025-01-08 15:25:04,292 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 16:19:23,494 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 16:19:23,494 [trainer.py] => model_name: asp
2025-01-08 16:19:23,494 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 16:19:23,494 [trainer.py] => device: ['cuda']
2025-01-08 16:19:23,494 [trainer.py] => seed: 2024
2025-01-08 16:19:23,494 [trainer.py] => dataset: cifar224
2025-01-08 16:19:23,494 [trainer.py] => init_cls: 5
2025-01-08 16:19:23,494 [trainer.py] => increment: 5
2025-01-08 16:19:23,495 [trainer.py] => kshot: 5
2025-01-08 16:19:23,495 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 16:19:23,495 [trainer.py] => z_dim: 1000
2025-01-08 16:19:23,495 [trainer.py] => conv_dim: 64
2025-01-08 16:19:23,495 [trainer.py] => img_size: 224
2025-01-08 16:19:23,495 [trainer.py] => generator_lr: 0.005
2025-01-08 16:19:23,495 [trainer.py] => pi: 100
2025-01-08 16:19:23,495 [trainer.py] => w_bn: 50.0
2025-01-08 16:19:23,495 [trainer.py] => w_noise: 0.001
2025-01-08 16:19:23,495 [trainer.py] => server_ss: 32
2025-01-08 16:19:23,495 [trainer.py] => bn_loss: 1
2025-01-08 16:19:23,495 [trainer.py] => noise: 1
2025-01-08 16:19:23,495 [trainer.py] => ie_loss: 1
2025-01-08 16:19:23,495 [trainer.py] => act_loss: 0
2025-01-08 16:19:23,495 [trainer.py] => w_ie: 1.0
2025-01-08 16:19:23,495 [trainer.py] => w_act: 0.1
2025-01-08 16:19:23,495 [trainer.py] => syn_size: 32
2025-01-08 16:19:23,495 [trainer.py] => need_syn_imgs: True
2025-01-08 16:19:23,495 [trainer.py] => g_local_bs: 42
2025-01-08 16:19:23,495 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 16:19:23,495 [trainer.py] => g_local_train_steps: 10
2025-01-08 16:19:23,495 [trainer.py] => dataset_syn: cifar100
2025-01-08 16:19:23,495 [trainer.py] => com_round_gen: 10
2025-01-08 16:19:23,495 [trainer.py] => g_sigma: 0
2025-01-08 16:19:23,495 [trainer.py] => save_cls_embeds: False
2025-01-08 16:19:23,495 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-08 16:19:23,495 [trainer.py] => save_dir: outputs
2025-01-08 16:19:23,495 [trainer.py] => n_iter: 5
2025-01-08 16:19:23,495 [trainer.py] => num_users: 1
2025-01-08 16:19:23,495 [trainer.py] => cur_size: 50
2025-01-08 16:19:23,495 [trainer.py] => local_bs: 5
2025-01-08 16:19:23,495 [trainer.py] => vpt_type: Deep
2025-01-08 16:19:23,495 [trainer.py] => prompt_token_num: 6
2025-01-08 16:19:23,495 [trainer.py] => avg_alpha: 0.8
2025-01-08 16:19:23,495 [trainer.py] => perturb_var: 1
2025-01-08 16:19:23,495 [trainer.py] => EMA_beta: 0.99
2025-01-08 16:19:23,496 [trainer.py] => anchor_lambda: 0.1
2025-01-08 16:19:23,496 [trainer.py] => kl_weight: 0.001
2025-01-08 16:19:23,496 [trainer.py] => TIP_init: zero
2025-01-08 16:19:23,496 [trainer.py] => tuned_epoch: 10
2025-01-08 16:19:23,496 [trainer.py] => fs_epoch: 0
2025-01-08 16:19:23,496 [trainer.py] => init_lr: 0.01
2025-01-08 16:19:23,496 [trainer.py] => fs_lr: 0.001
2025-01-08 16:19:23,496 [trainer.py] => batch_size: 48
2025-01-08 16:19:23,496 [trainer.py] => fs_batch_size: 16
2025-01-08 16:19:23,496 [trainer.py] => weight_decay: 0.0005
2025-01-08 16:19:23,496 [trainer.py] => min_lr: 0
2025-01-08 16:19:23,496 [trainer.py] => optimizer: sgd
2025-01-08 16:19:23,496 [trainer.py] => memory_size: 0
2025-01-08 16:19:23,496 [trainer.py] => memory_per_class: 0
2025-01-08 16:19:23,496 [trainer.py] => fixed_memory: False
2025-01-08 16:19:23,496 [trainer.py] => shuffle: False
2025-01-08 16:19:23,496 [trainer.py] => top_k: 5
2025-01-08 16:19:23,496 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 16:19:23,496 [trainer.py] => prefix: asp
2025-01-08 16:19:23,496 [trainer.py] => model_prefix: asp
2025-01-08 16:19:25,189 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 16:19:53,916 [trainer.py] => All params: 173596160
2025-01-08 16:19:53,918 [trainer.py] => Trainable params: 1998848
2025-01-08 16:19:53,919 [asp.py] => Learning on 0-5
2025-01-08 16:19:53,924 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 16:27:05,453 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 16:27:05,454 [trainer.py] => model_name: asp
2025-01-08 16:27:05,454 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 16:27:05,454 [trainer.py] => device: ['cuda']
2025-01-08 16:27:05,454 [trainer.py] => seed: 2024
2025-01-08 16:27:05,454 [trainer.py] => dataset: cifar224
2025-01-08 16:27:05,454 [trainer.py] => init_cls: 5
2025-01-08 16:27:05,454 [trainer.py] => increment: 5
2025-01-08 16:27:05,454 [trainer.py] => kshot: 5
2025-01-08 16:27:05,454 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 16:27:05,454 [trainer.py] => z_dim: 1000
2025-01-08 16:27:05,454 [trainer.py] => conv_dim: 64
2025-01-08 16:27:05,454 [trainer.py] => img_size: 224
2025-01-08 16:27:05,454 [trainer.py] => generator_lr: 0.005
2025-01-08 16:27:05,454 [trainer.py] => pi: 100
2025-01-08 16:27:05,454 [trainer.py] => w_bn: 50.0
2025-01-08 16:27:05,454 [trainer.py] => w_noise: 0.001
2025-01-08 16:27:05,454 [trainer.py] => server_ss: 32
2025-01-08 16:27:05,454 [trainer.py] => bn_loss: 1
2025-01-08 16:27:05,454 [trainer.py] => noise: 1
2025-01-08 16:27:05,454 [trainer.py] => ie_loss: 1
2025-01-08 16:27:05,454 [trainer.py] => act_loss: 0
2025-01-08 16:27:05,454 [trainer.py] => w_ie: 1.0
2025-01-08 16:27:05,454 [trainer.py] => w_act: 0.1
2025-01-08 16:27:05,454 [trainer.py] => syn_size: 32
2025-01-08 16:27:05,454 [trainer.py] => need_syn_imgs: True
2025-01-08 16:27:05,454 [trainer.py] => g_local_bs: 42
2025-01-08 16:27:05,454 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 16:27:05,454 [trainer.py] => g_local_train_steps: 10
2025-01-08 16:27:05,455 [trainer.py] => dataset_syn: cifar100
2025-01-08 16:27:05,455 [trainer.py] => com_round_gen: 10
2025-01-08 16:27:05,455 [trainer.py] => g_sigma: 0
2025-01-08 16:27:05,455 [trainer.py] => save_cls_embeds: False
2025-01-08 16:27:05,455 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-08 16:27:05,455 [trainer.py] => save_dir: outputs
2025-01-08 16:27:05,455 [trainer.py] => n_iter: 5
2025-01-08 16:27:05,455 [trainer.py] => num_users: 1
2025-01-08 16:27:05,455 [trainer.py] => cur_size: 50
2025-01-08 16:27:05,455 [trainer.py] => local_bs: 5
2025-01-08 16:27:05,455 [trainer.py] => vpt_type: Deep
2025-01-08 16:27:05,455 [trainer.py] => prompt_token_num: 6
2025-01-08 16:27:05,455 [trainer.py] => avg_alpha: 0.8
2025-01-08 16:27:05,455 [trainer.py] => perturb_var: 1
2025-01-08 16:27:05,455 [trainer.py] => EMA_beta: 0.99
2025-01-08 16:27:05,455 [trainer.py] => anchor_lambda: 0.1
2025-01-08 16:27:05,455 [trainer.py] => kl_weight: 0.001
2025-01-08 16:27:05,455 [trainer.py] => TIP_init: zero
2025-01-08 16:27:05,455 [trainer.py] => tuned_epoch: 10
2025-01-08 16:27:05,455 [trainer.py] => fs_epoch: 0
2025-01-08 16:27:05,455 [trainer.py] => init_lr: 0.01
2025-01-08 16:27:05,455 [trainer.py] => fs_lr: 0.001
2025-01-08 16:27:05,455 [trainer.py] => batch_size: 48
2025-01-08 16:27:05,455 [trainer.py] => fs_batch_size: 16
2025-01-08 16:27:05,455 [trainer.py] => weight_decay: 0.0005
2025-01-08 16:27:05,455 [trainer.py] => min_lr: 0
2025-01-08 16:27:05,455 [trainer.py] => optimizer: sgd
2025-01-08 16:27:05,455 [trainer.py] => memory_size: 0
2025-01-08 16:27:05,455 [trainer.py] => memory_per_class: 0
2025-01-08 16:27:05,455 [trainer.py] => fixed_memory: False
2025-01-08 16:27:05,455 [trainer.py] => shuffle: False
2025-01-08 16:27:05,455 [trainer.py] => top_k: 5
2025-01-08 16:27:05,455 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 16:27:05,456 [trainer.py] => prefix: asp
2025-01-08 16:27:05,456 [trainer.py] => model_prefix: asp
2025-01-08 16:27:07,183 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 16:30:36,039 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 16:30:36,039 [trainer.py] => model_name: asp
2025-01-08 16:30:36,039 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 16:30:36,039 [trainer.py] => device: ['cuda']
2025-01-08 16:30:36,039 [trainer.py] => seed: 2024
2025-01-08 16:30:36,039 [trainer.py] => dataset: cifar224
2025-01-08 16:30:36,039 [trainer.py] => init_cls: 5
2025-01-08 16:30:36,039 [trainer.py] => increment: 5
2025-01-08 16:30:36,039 [trainer.py] => kshot: 5
2025-01-08 16:30:36,039 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 16:30:36,039 [trainer.py] => z_dim: 1000
2025-01-08 16:30:36,039 [trainer.py] => conv_dim: 64
2025-01-08 16:30:36,039 [trainer.py] => img_size: 224
2025-01-08 16:30:36,039 [trainer.py] => generator_lr: 0.005
2025-01-08 16:30:36,039 [trainer.py] => pi: 100
2025-01-08 16:30:36,039 [trainer.py] => w_bn: 50.0
2025-01-08 16:30:36,039 [trainer.py] => w_noise: 0.001
2025-01-08 16:30:36,039 [trainer.py] => server_ss: 32
2025-01-08 16:30:36,039 [trainer.py] => bn_loss: 1
2025-01-08 16:30:36,039 [trainer.py] => noise: 1
2025-01-08 16:30:36,039 [trainer.py] => ie_loss: 1
2025-01-08 16:30:36,039 [trainer.py] => act_loss: 0
2025-01-08 16:30:36,040 [trainer.py] => w_ie: 1.0
2025-01-08 16:30:36,040 [trainer.py] => w_act: 0.1
2025-01-08 16:30:36,040 [trainer.py] => syn_size: 32
2025-01-08 16:30:36,040 [trainer.py] => need_syn_imgs: True
2025-01-08 16:30:36,040 [trainer.py] => g_local_bs: 42
2025-01-08 16:30:36,040 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 16:30:36,040 [trainer.py] => g_local_train_steps: 10
2025-01-08 16:30:36,040 [trainer.py] => dataset_syn: cifar100
2025-01-08 16:30:36,040 [trainer.py] => com_round_gen: 10
2025-01-08 16:30:36,040 [trainer.py] => g_sigma: 0
2025-01-08 16:30:36,040 [trainer.py] => save_cls_embeds: False
2025-01-08 16:30:36,040 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-08 16:30:36,040 [trainer.py] => save_dir: outputs
2025-01-08 16:30:36,040 [trainer.py] => n_iter: 5
2025-01-08 16:30:36,040 [trainer.py] => num_users: 1
2025-01-08 16:30:36,040 [trainer.py] => cur_size: 50
2025-01-08 16:30:36,040 [trainer.py] => local_bs: 5
2025-01-08 16:30:36,040 [trainer.py] => vpt_type: Deep
2025-01-08 16:30:36,040 [trainer.py] => prompt_token_num: 6
2025-01-08 16:30:36,040 [trainer.py] => avg_alpha: 0.8
2025-01-08 16:30:36,040 [trainer.py] => perturb_var: 1
2025-01-08 16:30:36,040 [trainer.py] => EMA_beta: 0.99
2025-01-08 16:30:36,040 [trainer.py] => anchor_lambda: 0.1
2025-01-08 16:30:36,040 [trainer.py] => kl_weight: 0.001
2025-01-08 16:30:36,040 [trainer.py] => TIP_init: zero
2025-01-08 16:30:36,040 [trainer.py] => tuned_epoch: 10
2025-01-08 16:30:36,040 [trainer.py] => fs_epoch: 0
2025-01-08 16:30:36,040 [trainer.py] => init_lr: 0.01
2025-01-08 16:30:36,040 [trainer.py] => fs_lr: 0.001
2025-01-08 16:30:36,040 [trainer.py] => batch_size: 48
2025-01-08 16:30:36,040 [trainer.py] => fs_batch_size: 16
2025-01-08 16:30:36,040 [trainer.py] => weight_decay: 0.0005
2025-01-08 16:30:36,040 [trainer.py] => min_lr: 0
2025-01-08 16:30:36,040 [trainer.py] => optimizer: sgd
2025-01-08 16:30:36,041 [trainer.py] => memory_size: 0
2025-01-08 16:30:36,041 [trainer.py] => memory_per_class: 0
2025-01-08 16:30:36,041 [trainer.py] => fixed_memory: False
2025-01-08 16:30:36,041 [trainer.py] => shuffle: False
2025-01-08 16:30:36,041 [trainer.py] => top_k: 5
2025-01-08 16:30:36,041 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 16:30:36,041 [trainer.py] => prefix: asp
2025-01-08 16:30:36,041 [trainer.py] => model_prefix: asp
2025-01-08 16:30:37,512 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 16:31:33,995 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 16:31:33,995 [trainer.py] => model_name: asp
2025-01-08 16:31:33,995 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 16:31:33,995 [trainer.py] => device: ['cuda']
2025-01-08 16:31:33,995 [trainer.py] => seed: 2024
2025-01-08 16:31:33,995 [trainer.py] => dataset: cifar224
2025-01-08 16:31:33,995 [trainer.py] => init_cls: 5
2025-01-08 16:31:33,995 [trainer.py] => increment: 5
2025-01-08 16:31:33,995 [trainer.py] => kshot: 5
2025-01-08 16:31:33,995 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 16:31:33,995 [trainer.py] => z_dim: 1000
2025-01-08 16:31:33,995 [trainer.py] => conv_dim: 64
2025-01-08 16:31:33,995 [trainer.py] => img_size: 224
2025-01-08 16:31:33,995 [trainer.py] => generator_lr: 0.005
2025-01-08 16:31:33,995 [trainer.py] => pi: 100
2025-01-08 16:31:33,995 [trainer.py] => w_bn: 50.0
2025-01-08 16:31:33,995 [trainer.py] => w_noise: 0.001
2025-01-08 16:31:33,995 [trainer.py] => server_ss: 32
2025-01-08 16:31:33,995 [trainer.py] => bn_loss: 1
2025-01-08 16:31:33,995 [trainer.py] => noise: 1
2025-01-08 16:31:33,995 [trainer.py] => ie_loss: 1
2025-01-08 16:31:33,995 [trainer.py] => act_loss: 0
2025-01-08 16:31:33,995 [trainer.py] => w_ie: 1.0
2025-01-08 16:31:33,995 [trainer.py] => w_act: 0.1
2025-01-08 16:31:33,995 [trainer.py] => syn_size: 32
2025-01-08 16:31:33,995 [trainer.py] => need_syn_imgs: True
2025-01-08 16:31:33,996 [trainer.py] => g_local_bs: 42
2025-01-08 16:31:33,996 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 16:31:33,996 [trainer.py] => g_local_train_steps: 10
2025-01-08 16:31:33,996 [trainer.py] => dataset_syn: cifar100
2025-01-08 16:31:33,996 [trainer.py] => com_round_gen: 10
2025-01-08 16:31:33,996 [trainer.py] => g_sigma: 0
2025-01-08 16:31:33,996 [trainer.py] => save_cls_embeds: False
2025-01-08 16:31:33,996 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-08 16:31:33,996 [trainer.py] => save_dir: outputs
2025-01-08 16:31:33,996 [trainer.py] => n_iter: 5
2025-01-08 16:31:33,996 [trainer.py] => num_users: 1
2025-01-08 16:31:33,996 [trainer.py] => cur_size: 50
2025-01-08 16:31:33,996 [trainer.py] => local_bs: 5
2025-01-08 16:31:33,996 [trainer.py] => vpt_type: Deep
2025-01-08 16:31:33,996 [trainer.py] => prompt_token_num: 6
2025-01-08 16:31:33,996 [trainer.py] => avg_alpha: 0.8
2025-01-08 16:31:33,996 [trainer.py] => perturb_var: 1
2025-01-08 16:31:33,996 [trainer.py] => EMA_beta: 0.99
2025-01-08 16:31:33,996 [trainer.py] => anchor_lambda: 0.1
2025-01-08 16:31:33,996 [trainer.py] => kl_weight: 0.001
2025-01-08 16:31:33,996 [trainer.py] => TIP_init: zero
2025-01-08 16:31:33,996 [trainer.py] => tuned_epoch: 10
2025-01-08 16:31:33,996 [trainer.py] => fs_epoch: 0
2025-01-08 16:31:33,996 [trainer.py] => init_lr: 0.01
2025-01-08 16:31:33,996 [trainer.py] => fs_lr: 0.001
2025-01-08 16:31:33,996 [trainer.py] => batch_size: 48
2025-01-08 16:31:33,996 [trainer.py] => fs_batch_size: 16
2025-01-08 16:31:33,996 [trainer.py] => weight_decay: 0.0005
2025-01-08 16:31:33,996 [trainer.py] => min_lr: 0
2025-01-08 16:31:33,996 [trainer.py] => optimizer: sgd
2025-01-08 16:31:33,996 [trainer.py] => memory_size: 0
2025-01-08 16:31:33,996 [trainer.py] => memory_per_class: 0
2025-01-08 16:31:33,996 [trainer.py] => fixed_memory: False
2025-01-08 16:31:33,996 [trainer.py] => shuffle: False
2025-01-08 16:31:33,996 [trainer.py] => top_k: 5
2025-01-08 16:31:33,996 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 16:31:33,996 [trainer.py] => prefix: asp
2025-01-08 16:31:33,997 [trainer.py] => model_prefix: asp
2025-01-08 16:31:35,663 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 16:37:44,570 [trainer.py] => Top1 curve: [21.6]
2025-01-08 16:37:44,571 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-08 16:37:44,572 [trainer.py] => All params: 173600001
2025-01-08 16:37:44,573 [trainer.py] => Trainable params: 2002689
2025-01-08 16:37:44,574 [asp.py] => Learning on 5-10
2025-01-08 16:37:44,585 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-08 16:40:42,816 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 16:40:42,816 [trainer.py] => model_name: asp
2025-01-08 16:40:42,816 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 16:40:42,816 [trainer.py] => device: ['cuda']
2025-01-08 16:40:42,816 [trainer.py] => seed: 2024
2025-01-08 16:40:42,816 [trainer.py] => dataset: cifar224
2025-01-08 16:40:42,816 [trainer.py] => init_cls: 5
2025-01-08 16:40:42,816 [trainer.py] => increment: 5
2025-01-08 16:40:42,816 [trainer.py] => kshot: 5
2025-01-08 16:40:42,816 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 16:40:42,816 [trainer.py] => z_dim: 1000
2025-01-08 16:40:42,816 [trainer.py] => conv_dim: 64
2025-01-08 16:40:42,816 [trainer.py] => img_size: 224
2025-01-08 16:40:42,816 [trainer.py] => generator_lr: 0.005
2025-01-08 16:40:42,816 [trainer.py] => pi: 100
2025-01-08 16:40:42,816 [trainer.py] => w_bn: 50.0
2025-01-08 16:40:42,816 [trainer.py] => w_noise: 0.001
2025-01-08 16:40:42,816 [trainer.py] => server_ss: 32
2025-01-08 16:40:42,816 [trainer.py] => bn_loss: 1
2025-01-08 16:40:42,816 [trainer.py] => noise: 1
2025-01-08 16:40:42,816 [trainer.py] => ie_loss: 1
2025-01-08 16:40:42,816 [trainer.py] => act_loss: 0
2025-01-08 16:40:42,817 [trainer.py] => w_ie: 1.0
2025-01-08 16:40:42,817 [trainer.py] => w_act: 0.1
2025-01-08 16:40:42,817 [trainer.py] => syn_size: 32
2025-01-08 16:40:42,817 [trainer.py] => need_syn_imgs: True
2025-01-08 16:40:42,817 [trainer.py] => g_local_bs: 42
2025-01-08 16:40:42,817 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 16:40:42,817 [trainer.py] => g_local_train_steps: 10
2025-01-08 16:40:42,817 [trainer.py] => dataset_syn: cifar100
2025-01-08 16:40:42,817 [trainer.py] => com_round_gen: 10
2025-01-08 16:40:42,817 [trainer.py] => g_sigma: 0
2025-01-08 16:40:42,817 [trainer.py] => save_cls_embeds: False
2025-01-08 16:40:42,817 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-08 16:40:42,817 [trainer.py] => save_dir: outputs
2025-01-08 16:40:42,817 [trainer.py] => n_iter: 5
2025-01-08 16:40:42,817 [trainer.py] => num_users: 1
2025-01-08 16:40:42,817 [trainer.py] => cur_size: 50
2025-01-08 16:40:42,817 [trainer.py] => local_bs: 5
2025-01-08 16:40:42,817 [trainer.py] => vpt_type: Deep
2025-01-08 16:40:42,817 [trainer.py] => prompt_token_num: 6
2025-01-08 16:40:42,817 [trainer.py] => avg_alpha: 0.8
2025-01-08 16:40:42,817 [trainer.py] => perturb_var: 1
2025-01-08 16:40:42,817 [trainer.py] => EMA_beta: 0.99
2025-01-08 16:40:42,817 [trainer.py] => anchor_lambda: 0.1
2025-01-08 16:40:42,817 [trainer.py] => kl_weight: 0.001
2025-01-08 16:40:42,817 [trainer.py] => TIP_init: zero
2025-01-08 16:40:42,817 [trainer.py] => tuned_epoch: 10
2025-01-08 16:40:42,817 [trainer.py] => fs_epoch: 0
2025-01-08 16:40:42,817 [trainer.py] => init_lr: 0.01
2025-01-08 16:40:42,817 [trainer.py] => fs_lr: 0.001
2025-01-08 16:40:42,817 [trainer.py] => batch_size: 48
2025-01-08 16:40:42,817 [trainer.py] => fs_batch_size: 16
2025-01-08 16:40:42,817 [trainer.py] => weight_decay: 0.0005
2025-01-08 16:40:42,817 [trainer.py] => min_lr: 0
2025-01-08 16:40:42,817 [trainer.py] => optimizer: sgd
2025-01-08 16:40:42,817 [trainer.py] => memory_size: 0
2025-01-08 16:40:42,818 [trainer.py] => memory_per_class: 0
2025-01-08 16:40:42,818 [trainer.py] => fixed_memory: False
2025-01-08 16:40:42,818 [trainer.py] => shuffle: False
2025-01-08 16:40:42,818 [trainer.py] => top_k: 5
2025-01-08 16:40:42,818 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 16:40:42,818 [trainer.py] => prefix: asp
2025-01-08 16:40:42,818 [trainer.py] => model_prefix: asp
2025-01-08 16:40:44,400 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 16:41:43,447 [trainer.py] => All params: 173596160
2025-01-08 16:41:43,448 [trainer.py] => Trainable params: 1998848
2025-01-08 16:41:43,449 [asp.py] => Learning on 0-5
2025-01-08 16:41:43,479 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 17:09:34,142 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 17:09:34,142 [trainer.py] => model_name: asp
2025-01-08 17:09:34,142 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 17:09:34,142 [trainer.py] => device: ['cuda']
2025-01-08 17:09:34,142 [trainer.py] => seed: 2024
2025-01-08 17:09:34,142 [trainer.py] => dataset: cifar224
2025-01-08 17:09:34,142 [trainer.py] => init_cls: 5
2025-01-08 17:09:34,142 [trainer.py] => increment: 5
2025-01-08 17:09:34,142 [trainer.py] => kshot: 5
2025-01-08 17:09:34,142 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 17:09:34,142 [trainer.py] => z_dim: 1000
2025-01-08 17:09:34,142 [trainer.py] => conv_dim: 64
2025-01-08 17:09:34,142 [trainer.py] => img_size: 224
2025-01-08 17:09:34,142 [trainer.py] => generator_lr: 0.005
2025-01-08 17:09:34,142 [trainer.py] => pi: 100
2025-01-08 17:09:34,142 [trainer.py] => w_bn: 50.0
2025-01-08 17:09:34,142 [trainer.py] => w_noise: 0.001
2025-01-08 17:09:34,142 [trainer.py] => server_ss: 32
2025-01-08 17:09:34,142 [trainer.py] => bn_loss: 1
2025-01-08 17:09:34,142 [trainer.py] => noise: 1
2025-01-08 17:09:34,142 [trainer.py] => ie_loss: 1
2025-01-08 17:09:34,143 [trainer.py] => act_loss: 0
2025-01-08 17:09:34,143 [trainer.py] => w_ie: 1.0
2025-01-08 17:09:34,143 [trainer.py] => w_act: 0.1
2025-01-08 17:09:34,143 [trainer.py] => syn_size: 32
2025-01-08 17:09:34,143 [trainer.py] => need_syn_imgs: True
2025-01-08 17:09:34,143 [trainer.py] => g_local_bs: 42
2025-01-08 17:09:34,143 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 17:09:34,143 [trainer.py] => g_local_train_steps: 10
2025-01-08 17:09:34,143 [trainer.py] => dataset_syn: cifar100
2025-01-08 17:09:34,143 [trainer.py] => com_round_gen: 10
2025-01-08 17:09:34,143 [trainer.py] => g_sigma: 0
2025-01-08 17:09:34,143 [trainer.py] => save_cls_embeds: False
2025-01-08 17:09:34,143 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-08 17:09:34,143 [trainer.py] => save_dir: outputs
2025-01-08 17:09:34,143 [trainer.py] => n_iter: 5
2025-01-08 17:09:34,143 [trainer.py] => num_users: 1
2025-01-08 17:09:34,143 [trainer.py] => cur_size: 50
2025-01-08 17:09:34,143 [trainer.py] => local_bs: 5
2025-01-08 17:09:34,143 [trainer.py] => vpt_type: Deep
2025-01-08 17:09:34,143 [trainer.py] => prompt_token_num: 6
2025-01-08 17:09:34,143 [trainer.py] => avg_alpha: 0.8
2025-01-08 17:09:34,143 [trainer.py] => perturb_var: 1
2025-01-08 17:09:34,143 [trainer.py] => EMA_beta: 0.99
2025-01-08 17:09:34,143 [trainer.py] => anchor_lambda: 0.1
2025-01-08 17:09:34,143 [trainer.py] => kl_weight: 0.001
2025-01-08 17:09:34,143 [trainer.py] => TIP_init: zero
2025-01-08 17:09:34,143 [trainer.py] => tuned_epoch: 10
2025-01-08 17:09:34,143 [trainer.py] => fs_epoch: 0
2025-01-08 17:09:34,143 [trainer.py] => init_lr: 0.01
2025-01-08 17:09:34,143 [trainer.py] => fs_lr: 0.001
2025-01-08 17:09:34,143 [trainer.py] => batch_size: 48
2025-01-08 17:09:34,143 [trainer.py] => fs_batch_size: 16
2025-01-08 17:09:34,143 [trainer.py] => weight_decay: 0.0005
2025-01-08 17:09:34,144 [trainer.py] => min_lr: 0
2025-01-08 17:09:34,144 [trainer.py] => optimizer: sgd
2025-01-08 17:09:34,144 [trainer.py] => memory_size: 0
2025-01-08 17:09:34,144 [trainer.py] => memory_per_class: 0
2025-01-08 17:09:34,144 [trainer.py] => fixed_memory: False
2025-01-08 17:09:34,144 [trainer.py] => shuffle: False
2025-01-08 17:09:34,144 [trainer.py] => top_k: 5
2025-01-08 17:09:34,144 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 17:09:34,144 [trainer.py] => prefix: asp
2025-01-08 17:09:34,144 [trainer.py] => model_prefix: asp
2025-01-08 17:09:35,857 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 17:10:10,749 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 17:10:10,749 [trainer.py] => model_name: asp
2025-01-08 17:10:10,749 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 17:10:10,749 [trainer.py] => device: ['cuda']
2025-01-08 17:10:10,749 [trainer.py] => seed: 2024
2025-01-08 17:10:10,749 [trainer.py] => dataset: cifar224
2025-01-08 17:10:10,749 [trainer.py] => init_cls: 5
2025-01-08 17:10:10,750 [trainer.py] => increment: 5
2025-01-08 17:10:10,750 [trainer.py] => kshot: 5
2025-01-08 17:10:10,750 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 17:10:10,750 [trainer.py] => z_dim: 1000
2025-01-08 17:10:10,750 [trainer.py] => conv_dim: 64
2025-01-08 17:10:10,750 [trainer.py] => img_size: 224
2025-01-08 17:10:10,750 [trainer.py] => generator_lr: 0.005
2025-01-08 17:10:10,750 [trainer.py] => pi: 100
2025-01-08 17:10:10,750 [trainer.py] => w_bn: 50.0
2025-01-08 17:10:10,750 [trainer.py] => w_noise: 0.001
2025-01-08 17:10:10,750 [trainer.py] => server_ss: 32
2025-01-08 17:10:10,750 [trainer.py] => bn_loss: 1
2025-01-08 17:10:10,750 [trainer.py] => noise: 1
2025-01-08 17:10:10,750 [trainer.py] => ie_loss: 1
2025-01-08 17:10:10,750 [trainer.py] => act_loss: 0
2025-01-08 17:10:10,750 [trainer.py] => w_ie: 1.0
2025-01-08 17:10:10,750 [trainer.py] => w_act: 0.1
2025-01-08 17:10:10,750 [trainer.py] => syn_size: 32
2025-01-08 17:10:10,750 [trainer.py] => need_syn_imgs: True
2025-01-08 17:10:10,750 [trainer.py] => g_local_bs: 42
2025-01-08 17:10:10,750 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 17:10:10,750 [trainer.py] => g_local_train_steps: 10
2025-01-08 17:10:10,750 [trainer.py] => dataset_syn: cifar100
2025-01-08 17:10:10,750 [trainer.py] => com_round_gen: 10
2025-01-08 17:10:10,750 [trainer.py] => g_sigma: 0
2025-01-08 17:10:10,750 [trainer.py] => save_cls_embeds: False
2025-01-08 17:10:10,750 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-08 17:10:10,750 [trainer.py] => save_dir: outputs
2025-01-08 17:10:10,750 [trainer.py] => n_iter: 5
2025-01-08 17:10:10,750 [trainer.py] => num_users: 1
2025-01-08 17:10:10,750 [trainer.py] => cur_size: 50
2025-01-08 17:10:10,750 [trainer.py] => local_bs: 5
2025-01-08 17:10:10,750 [trainer.py] => vpt_type: Deep
2025-01-08 17:10:10,750 [trainer.py] => prompt_token_num: 6
2025-01-08 17:10:10,750 [trainer.py] => avg_alpha: 0.8
2025-01-08 17:10:10,750 [trainer.py] => perturb_var: 1
2025-01-08 17:10:10,751 [trainer.py] => EMA_beta: 0.99
2025-01-08 17:10:10,751 [trainer.py] => anchor_lambda: 0.1
2025-01-08 17:10:10,751 [trainer.py] => kl_weight: 0.001
2025-01-08 17:10:10,751 [trainer.py] => TIP_init: zero
2025-01-08 17:10:10,751 [trainer.py] => tuned_epoch: 10
2025-01-08 17:10:10,751 [trainer.py] => fs_epoch: 0
2025-01-08 17:10:10,751 [trainer.py] => init_lr: 0.01
2025-01-08 17:10:10,751 [trainer.py] => fs_lr: 0.001
2025-01-08 17:10:10,751 [trainer.py] => batch_size: 48
2025-01-08 17:10:10,751 [trainer.py] => fs_batch_size: 16
2025-01-08 17:10:10,751 [trainer.py] => weight_decay: 0.0005
2025-01-08 17:10:10,751 [trainer.py] => min_lr: 0
2025-01-08 17:10:10,751 [trainer.py] => optimizer: sgd
2025-01-08 17:10:10,751 [trainer.py] => memory_size: 0
2025-01-08 17:10:10,751 [trainer.py] => memory_per_class: 0
2025-01-08 17:10:10,751 [trainer.py] => fixed_memory: False
2025-01-08 17:10:10,751 [trainer.py] => shuffle: False
2025-01-08 17:10:10,751 [trainer.py] => top_k: 5
2025-01-08 17:10:10,751 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 17:10:10,751 [trainer.py] => prefix: asp
2025-01-08 17:10:10,751 [trainer.py] => model_prefix: asp
2025-01-08 17:10:12,492 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 17:10:38,822 [trainer.py] => All params: 173596160
2025-01-08 17:10:38,822 [trainer.py] => Trainable params: 1998848
2025-01-08 17:10:38,823 [asp.py] => Learning on 0-5
2025-01-08 17:10:38,828 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 17:28:06,133 [trainer.py] => Top1 curve: [21.6]
2025-01-08 17:28:06,134 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-08 17:28:06,135 [trainer.py] => All params: 173600001
2025-01-08 17:28:06,135 [trainer.py] => Trainable params: 2002689
2025-01-08 17:28:06,137 [asp.py] => Learning on 5-10
2025-01-08 17:28:06,147 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-08 21:44:56,746 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 21:44:56,746 [trainer.py] => model_name: asp
2025-01-08 21:44:56,746 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 21:44:56,746 [trainer.py] => device: ['cuda']
2025-01-08 21:44:56,746 [trainer.py] => seed: 2024
2025-01-08 21:44:56,746 [trainer.py] => dataset: cifar224
2025-01-08 21:44:56,746 [trainer.py] => init_cls: 5
2025-01-08 21:44:56,746 [trainer.py] => increment: 5
2025-01-08 21:44:56,746 [trainer.py] => kshot: 5
2025-01-08 21:44:56,746 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 21:44:56,746 [trainer.py] => z_dim: 1000
2025-01-08 21:44:56,746 [trainer.py] => conv_dim: 64
2025-01-08 21:44:56,746 [trainer.py] => img_size: 224
2025-01-08 21:44:56,746 [trainer.py] => generator_lr: 0.005
2025-01-08 21:44:56,746 [trainer.py] => pi: 100
2025-01-08 21:44:56,746 [trainer.py] => w_bn: 50.0
2025-01-08 21:44:56,746 [trainer.py] => w_noise: 0.001
2025-01-08 21:44:56,747 [trainer.py] => server_ss: 32
2025-01-08 21:44:56,747 [trainer.py] => bn_loss: 1
2025-01-08 21:44:56,747 [trainer.py] => noise: 1
2025-01-08 21:44:56,747 [trainer.py] => ie_loss: 1
2025-01-08 21:44:56,747 [trainer.py] => act_loss: 0
2025-01-08 21:44:56,747 [trainer.py] => w_ie: 1.0
2025-01-08 21:44:56,747 [trainer.py] => w_act: 0.1
2025-01-08 21:44:56,747 [trainer.py] => syn_size: 32
2025-01-08 21:44:56,747 [trainer.py] => need_syn_imgs: True
2025-01-08 21:44:56,747 [trainer.py] => g_local_bs: 42
2025-01-08 21:44:56,747 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 21:44:56,747 [trainer.py] => g_local_train_steps: 10
2025-01-08 21:44:56,747 [trainer.py] => dataset_syn: cifar100
2025-01-08 21:44:56,747 [trainer.py] => com_round_gen: 10
2025-01-08 21:44:56,747 [trainer.py] => g_sigma: 0
2025-01-08 21:44:56,747 [trainer.py] => save_cls_embeds: False
2025-01-08 21:44:56,747 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-08 21:44:56,747 [trainer.py] => save_dir: outputs
2025-01-08 21:44:56,747 [trainer.py] => n_iter: 5
2025-01-08 21:44:56,747 [trainer.py] => num_users: 1
2025-01-08 21:44:56,747 [trainer.py] => cur_size: 50
2025-01-08 21:44:56,748 [trainer.py] => local_bs: 5
2025-01-08 21:44:56,748 [trainer.py] => vpt_type: Deep
2025-01-08 21:44:56,748 [trainer.py] => prompt_token_num: 6
2025-01-08 21:44:56,748 [trainer.py] => avg_alpha: 0.8
2025-01-08 21:44:56,748 [trainer.py] => perturb_var: 1
2025-01-08 21:44:56,748 [trainer.py] => EMA_beta: 0.99
2025-01-08 21:44:56,748 [trainer.py] => anchor_lambda: 0.1
2025-01-08 21:44:56,748 [trainer.py] => kl_weight: 0.001
2025-01-08 21:44:56,748 [trainer.py] => TIP_init: zero
2025-01-08 21:44:56,748 [trainer.py] => tuned_epoch: 10
2025-01-08 21:44:56,748 [trainer.py] => fs_epoch: 0
2025-01-08 21:44:56,748 [trainer.py] => init_lr: 0.01
2025-01-08 21:44:56,748 [trainer.py] => fs_lr: 0.001
2025-01-08 21:44:56,748 [trainer.py] => batch_size: 48
2025-01-08 21:44:56,748 [trainer.py] => fs_batch_size: 16
2025-01-08 21:44:56,748 [trainer.py] => weight_decay: 0.0005
2025-01-08 21:44:56,748 [trainer.py] => min_lr: 0
2025-01-08 21:44:56,748 [trainer.py] => optimizer: sgd
2025-01-08 21:44:56,748 [trainer.py] => memory_size: 0
2025-01-08 21:44:56,748 [trainer.py] => memory_per_class: 0
2025-01-08 21:44:56,748 [trainer.py] => fixed_memory: False
2025-01-08 21:44:56,748 [trainer.py] => shuffle: False
2025-01-08 21:44:56,749 [trainer.py] => top_k: 5
2025-01-08 21:44:56,749 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 21:44:56,749 [trainer.py] => prefix: asp
2025-01-08 21:44:56,749 [trainer.py] => model_prefix: asp
2025-01-08 21:44:58,446 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 21:45:25,951 [trainer.py] => All params: 173596160
2025-01-08 21:45:25,952 [trainer.py] => Trainable params: 1998848
2025-01-08 21:45:25,952 [asp.py] => Learning on 0-5
2025-01-08 21:45:25,962 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 22:03:00,188 [trainer.py] => Top1 curve: [21.6]
2025-01-08 22:03:00,189 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-08 22:03:00,190 [trainer.py] => All params: 173600001
2025-01-08 22:03:00,191 [trainer.py] => Trainable params: 2002689
2025-01-08 22:03:00,193 [asp.py] => Learning on 5-10
2025-01-08 22:03:00,207 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-08 22:13:05,097 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-08 22:13:05,097 [trainer.py] => model_name: asp
2025-01-08 22:13:05,097 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-08 22:13:05,097 [trainer.py] => device: ['cuda']
2025-01-08 22:13:05,097 [trainer.py] => seed: 2024
2025-01-08 22:13:05,097 [trainer.py] => dataset: cifar224
2025-01-08 22:13:05,097 [trainer.py] => init_cls: 5
2025-01-08 22:13:05,097 [trainer.py] => increment: 5
2025-01-08 22:13:05,097 [trainer.py] => kshot: 5
2025-01-08 22:13:05,097 [trainer.py] => generator_model: CIFAR_GEN
2025-01-08 22:13:05,097 [trainer.py] => z_dim: 1000
2025-01-08 22:13:05,097 [trainer.py] => conv_dim: 64
2025-01-08 22:13:05,097 [trainer.py] => img_size: 224
2025-01-08 22:13:05,097 [trainer.py] => generator_lr: 0.005
2025-01-08 22:13:05,097 [trainer.py] => pi: 100
2025-01-08 22:13:05,097 [trainer.py] => w_bn: 50.0
2025-01-08 22:13:05,097 [trainer.py] => w_noise: 0.001
2025-01-08 22:13:05,097 [trainer.py] => server_ss: 32
2025-01-08 22:13:05,097 [trainer.py] => bn_loss: 1
2025-01-08 22:13:05,097 [trainer.py] => noise: 1
2025-01-08 22:13:05,097 [trainer.py] => ie_loss: 1
2025-01-08 22:13:05,097 [trainer.py] => act_loss: 0
2025-01-08 22:13:05,097 [trainer.py] => w_ie: 1.0
2025-01-08 22:13:05,098 [trainer.py] => w_act: 0.1
2025-01-08 22:13:05,098 [trainer.py] => syn_size: 32
2025-01-08 22:13:05,098 [trainer.py] => need_syn_imgs: True
2025-01-08 22:13:05,098 [trainer.py] => g_local_bs: 42
2025-01-08 22:13:05,098 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-08 22:13:05,098 [trainer.py] => g_local_train_steps: 10
2025-01-08 22:13:05,098 [trainer.py] => dataset_syn: cifar100
2025-01-08 22:13:05,098 [trainer.py] => com_round_gen: 10
2025-01-08 22:13:05,098 [trainer.py] => g_sigma: 0
2025-01-08 22:13:05,098 [trainer.py] => save_cls_embeds: False
2025-01-08 22:13:05,098 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-08 22:13:05,098 [trainer.py] => save_dir: outputs
2025-01-08 22:13:05,098 [trainer.py] => n_iter: 5
2025-01-08 22:13:05,098 [trainer.py] => num_users: 1
2025-01-08 22:13:05,098 [trainer.py] => cur_size: 50
2025-01-08 22:13:05,098 [trainer.py] => local_bs: 5
2025-01-08 22:13:05,098 [trainer.py] => vpt_type: Deep
2025-01-08 22:13:05,098 [trainer.py] => prompt_token_num: 6
2025-01-08 22:13:05,098 [trainer.py] => avg_alpha: 0.8
2025-01-08 22:13:05,098 [trainer.py] => perturb_var: 1
2025-01-08 22:13:05,098 [trainer.py] => EMA_beta: 0.99
2025-01-08 22:13:05,098 [trainer.py] => anchor_lambda: 0.1
2025-01-08 22:13:05,098 [trainer.py] => kl_weight: 0.001
2025-01-08 22:13:05,098 [trainer.py] => TIP_init: zero
2025-01-08 22:13:05,098 [trainer.py] => tuned_epoch: 10
2025-01-08 22:13:05,098 [trainer.py] => fs_epoch: 0
2025-01-08 22:13:05,098 [trainer.py] => init_lr: 0.01
2025-01-08 22:13:05,098 [trainer.py] => fs_lr: 0.001
2025-01-08 22:13:05,099 [trainer.py] => batch_size: 48
2025-01-08 22:13:05,099 [trainer.py] => fs_batch_size: 16
2025-01-08 22:13:05,099 [trainer.py] => weight_decay: 0.0005
2025-01-08 22:13:05,099 [trainer.py] => min_lr: 0
2025-01-08 22:13:05,099 [trainer.py] => optimizer: sgd
2025-01-08 22:13:05,099 [trainer.py] => memory_size: 0
2025-01-08 22:13:05,099 [trainer.py] => memory_per_class: 0
2025-01-08 22:13:05,099 [trainer.py] => fixed_memory: False
2025-01-08 22:13:05,099 [trainer.py] => shuffle: False
2025-01-08 22:13:05,099 [trainer.py] => top_k: 5
2025-01-08 22:13:05,099 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-08 22:13:05,099 [trainer.py] => prefix: asp
2025-01-08 22:13:05,099 [trainer.py] => model_prefix: asp
2025-01-08 22:13:06,737 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-08 22:13:34,332 [trainer.py] => All params: 173596160
2025-01-08 22:13:34,333 [trainer.py] => Trainable params: 1998848
2025-01-08 22:13:34,333 [asp.py] => Learning on 0-5
2025-01-08 22:13:34,360 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-08 22:30:22,978 [trainer.py] => Top1 curve: [21.6]
2025-01-08 22:30:22,978 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-08 22:30:22,979 [trainer.py] => All params: 173600001
2025-01-08 22:30:22,980 [trainer.py] => Trainable params: 2002689
2025-01-08 22:30:22,981 [asp.py] => Learning on 5-10
2025-01-08 22:30:22,993 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 00:09:38,646 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 00:09:38,646 [trainer.py] => model_name: asp
2025-01-09 00:09:38,646 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 00:09:38,646 [trainer.py] => device: ['cuda']
2025-01-09 00:09:38,646 [trainer.py] => seed: 2024
2025-01-09 00:09:38,646 [trainer.py] => dataset: cifar224
2025-01-09 00:09:38,646 [trainer.py] => init_cls: 5
2025-01-09 00:09:38,646 [trainer.py] => increment: 5
2025-01-09 00:09:38,646 [trainer.py] => kshot: 5
2025-01-09 00:09:38,646 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 00:09:38,646 [trainer.py] => z_dim: 1000
2025-01-09 00:09:38,646 [trainer.py] => conv_dim: 64
2025-01-09 00:09:38,646 [trainer.py] => img_size: 224
2025-01-09 00:09:38,646 [trainer.py] => generator_lr: 0.005
2025-01-09 00:09:38,646 [trainer.py] => pi: 100
2025-01-09 00:09:38,646 [trainer.py] => w_bn: 50.0
2025-01-09 00:09:38,646 [trainer.py] => w_noise: 0.001
2025-01-09 00:09:38,646 [trainer.py] => server_ss: 32
2025-01-09 00:09:38,646 [trainer.py] => bn_loss: 1
2025-01-09 00:09:38,646 [trainer.py] => noise: 1
2025-01-09 00:09:38,646 [trainer.py] => ie_loss: 1
2025-01-09 00:09:38,646 [trainer.py] => act_loss: 0
2025-01-09 00:09:38,646 [trainer.py] => w_ie: 1.0
2025-01-09 00:09:38,646 [trainer.py] => w_act: 0.1
2025-01-09 00:09:38,646 [trainer.py] => syn_size: 32
2025-01-09 00:09:38,646 [trainer.py] => need_syn_imgs: True
2025-01-09 00:09:38,646 [trainer.py] => g_local_bs: 42
2025-01-09 00:09:38,646 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 00:09:38,646 [trainer.py] => g_local_train_steps: 10
2025-01-09 00:09:38,646 [trainer.py] => dataset_syn: cifar100
2025-01-09 00:09:38,647 [trainer.py] => com_round_gen: 10
2025-01-09 00:09:38,647 [trainer.py] => g_sigma: 0
2025-01-09 00:09:38,647 [trainer.py] => save_cls_embeds: False
2025-01-09 00:09:38,647 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 00:09:38,647 [trainer.py] => save_dir: outputs
2025-01-09 00:09:38,647 [trainer.py] => n_iter: 5
2025-01-09 00:09:38,647 [trainer.py] => num_users: 1
2025-01-09 00:09:38,647 [trainer.py] => cur_size: 50
2025-01-09 00:09:38,647 [trainer.py] => local_bs: 5
2025-01-09 00:09:38,647 [trainer.py] => vpt_type: Deep
2025-01-09 00:09:38,647 [trainer.py] => prompt_token_num: 6
2025-01-09 00:09:38,647 [trainer.py] => avg_alpha: 0.8
2025-01-09 00:09:38,647 [trainer.py] => perturb_var: 1
2025-01-09 00:09:38,647 [trainer.py] => EMA_beta: 0.99
2025-01-09 00:09:38,647 [trainer.py] => anchor_lambda: 0.1
2025-01-09 00:09:38,647 [trainer.py] => kl_weight: 0.001
2025-01-09 00:09:38,647 [trainer.py] => TIP_init: zero
2025-01-09 00:09:38,647 [trainer.py] => tuned_epoch: 10
2025-01-09 00:09:38,647 [trainer.py] => fs_epoch: 0
2025-01-09 00:09:38,647 [trainer.py] => init_lr: 0.01
2025-01-09 00:09:38,647 [trainer.py] => fs_lr: 0.001
2025-01-09 00:09:38,647 [trainer.py] => batch_size: 48
2025-01-09 00:09:38,647 [trainer.py] => fs_batch_size: 16
2025-01-09 00:09:38,647 [trainer.py] => weight_decay: 0.0005
2025-01-09 00:09:38,647 [trainer.py] => min_lr: 0
2025-01-09 00:09:38,647 [trainer.py] => optimizer: sgd
2025-01-09 00:09:38,647 [trainer.py] => memory_size: 0
2025-01-09 00:09:38,647 [trainer.py] => memory_per_class: 0
2025-01-09 00:09:38,647 [trainer.py] => fixed_memory: False
2025-01-09 00:09:38,647 [trainer.py] => shuffle: False
2025-01-09 00:09:38,647 [trainer.py] => top_k: 5
2025-01-09 00:09:38,647 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 00:09:38,647 [trainer.py] => prefix: asp
2025-01-09 00:09:38,647 [trainer.py] => model_prefix: asp
2025-01-09 00:09:40,151 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 00:10:07,141 [trainer.py] => All params: 173596160
2025-01-09 00:10:07,142 [trainer.py] => Trainable params: 1998848
2025-01-09 00:10:07,142 [asp.py] => Learning on 0-5
2025-01-09 00:10:07,173 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 00:10:35,150 [trainer.py] => Top1 curve: [21.6]
2025-01-09 00:10:35,151 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-09 00:10:35,153 [trainer.py] => All params: 173600001
2025-01-09 00:10:35,154 [trainer.py] => Trainable params: 2002689
2025-01-09 00:10:35,155 [asp.py] => Learning on 5-10
2025-01-09 00:10:35,163 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 00:10:43,065 [trainer.py] => Top1 curve: [21.6, 10.8]
2025-01-09 00:10:43,067 [trainer.py] => Average Accuracy (Top1): 16.200000000000003   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 00:10:43,068 [trainer.py] => All params: 173603841
2025-01-09 00:10:43,069 [trainer.py] => Trainable params: 2006529
2025-01-09 00:10:43,070 [asp.py] => Learning on 10-15
2025-01-09 00:10:43,082 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 00:10:53,088 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2]
2025-01-09 00:10:53,089 [trainer.py] => Average Accuracy (Top1): 13.200000000000003   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 00:10:53,090 [trainer.py] => All params: 173607681
2025-01-09 00:10:53,091 [trainer.py] => Trainable params: 2010369
2025-01-09 00:10:53,092 [asp.py] => Learning on 15-20
2025-01-09 00:10:53,113 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 00:11:10,747 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 00:11:10,747 [trainer.py] => model_name: asp
2025-01-09 00:11:10,747 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 00:11:10,747 [trainer.py] => device: ['cuda']
2025-01-09 00:11:10,747 [trainer.py] => seed: 2024
2025-01-09 00:11:10,747 [trainer.py] => dataset: cifar224
2025-01-09 00:11:10,747 [trainer.py] => init_cls: 5
2025-01-09 00:11:10,747 [trainer.py] => increment: 5
2025-01-09 00:11:10,747 [trainer.py] => kshot: 5
2025-01-09 00:11:10,747 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 00:11:10,747 [trainer.py] => z_dim: 1000
2025-01-09 00:11:10,747 [trainer.py] => conv_dim: 64
2025-01-09 00:11:10,747 [trainer.py] => img_size: 224
2025-01-09 00:11:10,747 [trainer.py] => generator_lr: 0.005
2025-01-09 00:11:10,748 [trainer.py] => pi: 100
2025-01-09 00:11:10,748 [trainer.py] => w_bn: 50.0
2025-01-09 00:11:10,748 [trainer.py] => w_noise: 0.001
2025-01-09 00:11:10,748 [trainer.py] => server_ss: 32
2025-01-09 00:11:10,748 [trainer.py] => bn_loss: 1
2025-01-09 00:11:10,748 [trainer.py] => noise: 1
2025-01-09 00:11:10,748 [trainer.py] => ie_loss: 1
2025-01-09 00:11:10,748 [trainer.py] => act_loss: 0
2025-01-09 00:11:10,748 [trainer.py] => w_ie: 1.0
2025-01-09 00:11:10,748 [trainer.py] => w_act: 0.1
2025-01-09 00:11:10,748 [trainer.py] => syn_size: 32
2025-01-09 00:11:10,748 [trainer.py] => need_syn_imgs: True
2025-01-09 00:11:10,748 [trainer.py] => g_local_bs: 42
2025-01-09 00:11:10,748 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 00:11:10,748 [trainer.py] => g_local_train_steps: 10
2025-01-09 00:11:10,748 [trainer.py] => dataset_syn: cifar100
2025-01-09 00:11:10,748 [trainer.py] => com_round_gen: 10
2025-01-09 00:11:10,748 [trainer.py] => g_sigma: 0
2025-01-09 00:11:10,748 [trainer.py] => save_cls_embeds: False
2025-01-09 00:11:10,748 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 00:11:10,748 [trainer.py] => save_dir: outputs
2025-01-09 00:11:10,748 [trainer.py] => n_iter: 5
2025-01-09 00:11:10,748 [trainer.py] => num_users: 1
2025-01-09 00:11:10,748 [trainer.py] => cur_size: 50
2025-01-09 00:11:10,748 [trainer.py] => local_bs: 5
2025-01-09 00:11:10,748 [trainer.py] => vpt_type: Deep
2025-01-09 00:11:10,748 [trainer.py] => prompt_token_num: 6
2025-01-09 00:11:10,748 [trainer.py] => avg_alpha: 0.8
2025-01-09 00:11:10,748 [trainer.py] => perturb_var: 1
2025-01-09 00:11:10,748 [trainer.py] => EMA_beta: 0.99
2025-01-09 00:11:10,749 [trainer.py] => anchor_lambda: 0.1
2025-01-09 00:11:10,749 [trainer.py] => kl_weight: 0.001
2025-01-09 00:11:10,749 [trainer.py] => TIP_init: zero
2025-01-09 00:11:10,749 [trainer.py] => tuned_epoch: 10
2025-01-09 00:11:10,749 [trainer.py] => fs_epoch: 0
2025-01-09 00:11:10,749 [trainer.py] => init_lr: 0.01
2025-01-09 00:11:10,749 [trainer.py] => fs_lr: 0.001
2025-01-09 00:11:10,749 [trainer.py] => batch_size: 48
2025-01-09 00:11:10,749 [trainer.py] => fs_batch_size: 16
2025-01-09 00:11:10,749 [trainer.py] => weight_decay: 0.0005
2025-01-09 00:11:10,749 [trainer.py] => min_lr: 0
2025-01-09 00:11:10,749 [trainer.py] => optimizer: sgd
2025-01-09 00:11:10,749 [trainer.py] => memory_size: 0
2025-01-09 00:11:10,749 [trainer.py] => memory_per_class: 0
2025-01-09 00:11:10,749 [trainer.py] => fixed_memory: False
2025-01-09 00:11:10,749 [trainer.py] => shuffle: False
2025-01-09 00:11:10,749 [trainer.py] => top_k: 5
2025-01-09 00:11:10,749 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 00:11:10,749 [trainer.py] => prefix: asp
2025-01-09 00:11:10,749 [trainer.py] => model_prefix: asp
2025-01-09 00:11:12,474 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 00:11:39,500 [trainer.py] => All params: 173596160
2025-01-09 00:11:39,501 [trainer.py] => Trainable params: 1998848
2025-01-09 00:11:39,501 [asp.py] => Learning on 0-5
2025-01-09 11:03:38,936 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 11:03:45,730 [trainer.py] => Top1 curve: [21.6]
2025-01-09 11:03:45,731 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-09 11:03:45,732 [trainer.py] => All params: 173600001
2025-01-09 11:03:45,733 [trainer.py] => Trainable params: 2002689
2025-01-09 11:03:45,734 [asp.py] => Learning on 5-10
2025-01-09 11:06:36,609 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 11:06:36,609 [trainer.py] => model_name: asp
2025-01-09 11:06:36,609 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 11:06:36,609 [trainer.py] => device: ['cuda']
2025-01-09 11:06:36,609 [trainer.py] => seed: 2024
2025-01-09 11:06:36,609 [trainer.py] => dataset: cifar224
2025-01-09 11:06:36,609 [trainer.py] => init_cls: 5
2025-01-09 11:06:36,609 [trainer.py] => increment: 5
2025-01-09 11:06:36,609 [trainer.py] => kshot: 5
2025-01-09 11:06:36,609 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 11:06:36,609 [trainer.py] => z_dim: 1000
2025-01-09 11:06:36,609 [trainer.py] => conv_dim: 64
2025-01-09 11:06:36,609 [trainer.py] => img_size: 224
2025-01-09 11:06:36,610 [trainer.py] => generator_lr: 0.005
2025-01-09 11:06:36,610 [trainer.py] => pi: 100
2025-01-09 11:06:36,610 [trainer.py] => w_bn: 50.0
2025-01-09 11:06:36,610 [trainer.py] => w_noise: 0.001
2025-01-09 11:06:36,610 [trainer.py] => server_ss: 32
2025-01-09 11:06:36,610 [trainer.py] => bn_loss: 1
2025-01-09 11:06:36,610 [trainer.py] => noise: 1
2025-01-09 11:06:36,610 [trainer.py] => ie_loss: 1
2025-01-09 11:06:36,610 [trainer.py] => act_loss: 0
2025-01-09 11:06:36,610 [trainer.py] => w_ie: 1.0
2025-01-09 11:06:36,610 [trainer.py] => w_act: 0.1
2025-01-09 11:06:36,610 [trainer.py] => syn_size: 32
2025-01-09 11:06:36,610 [trainer.py] => need_syn_imgs: True
2025-01-09 11:06:36,610 [trainer.py] => g_local_bs: 42
2025-01-09 11:06:36,610 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 11:06:36,610 [trainer.py] => g_local_train_steps: 10
2025-01-09 11:06:36,610 [trainer.py] => dataset_syn: cifar100
2025-01-09 11:06:36,610 [trainer.py] => com_round_gen: 10
2025-01-09 11:06:36,610 [trainer.py] => g_sigma: 0
2025-01-09 11:06:36,610 [trainer.py] => save_cls_embeds: False
2025-01-09 11:06:36,610 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 11:06:36,610 [trainer.py] => save_dir: outputs
2025-01-09 11:06:36,610 [trainer.py] => n_iter: 5
2025-01-09 11:06:36,610 [trainer.py] => num_users: 1
2025-01-09 11:06:36,610 [trainer.py] => cur_size: 50
2025-01-09 11:06:36,610 [trainer.py] => local_bs: 5
2025-01-09 11:06:36,610 [trainer.py] => vpt_type: Deep
2025-01-09 11:06:36,610 [trainer.py] => prompt_token_num: 6
2025-01-09 11:06:36,610 [trainer.py] => avg_alpha: 0.8
2025-01-09 11:06:36,610 [trainer.py] => perturb_var: 1
2025-01-09 11:06:36,610 [trainer.py] => EMA_beta: 0.99
2025-01-09 11:06:36,610 [trainer.py] => anchor_lambda: 0.1
2025-01-09 11:06:36,610 [trainer.py] => kl_weight: 0.001
2025-01-09 11:06:36,610 [trainer.py] => TIP_init: zero
2025-01-09 11:06:36,610 [trainer.py] => tuned_epoch: 10
2025-01-09 11:06:36,610 [trainer.py] => fs_epoch: 0
2025-01-09 11:06:36,611 [trainer.py] => init_lr: 0.01
2025-01-09 11:06:36,611 [trainer.py] => fs_lr: 0.001
2025-01-09 11:06:36,611 [trainer.py] => batch_size: 48
2025-01-09 11:06:36,611 [trainer.py] => fs_batch_size: 16
2025-01-09 11:06:36,611 [trainer.py] => weight_decay: 0.0005
2025-01-09 11:06:36,611 [trainer.py] => min_lr: 0
2025-01-09 11:06:36,611 [trainer.py] => optimizer: sgd
2025-01-09 11:06:36,611 [trainer.py] => memory_size: 0
2025-01-09 11:06:36,611 [trainer.py] => memory_per_class: 0
2025-01-09 11:06:36,611 [trainer.py] => fixed_memory: False
2025-01-09 11:06:36,611 [trainer.py] => shuffle: False
2025-01-09 11:06:36,611 [trainer.py] => top_k: 5
2025-01-09 11:06:36,611 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 11:06:36,611 [trainer.py] => prefix: asp
2025-01-09 11:06:36,611 [trainer.py] => model_prefix: asp
2025-01-09 11:06:38,490 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 11:07:21,261 [trainer.py] => All params: 173596160
2025-01-09 11:07:21,262 [trainer.py] => Trainable params: 1998848
2025-01-09 11:07:21,263 [asp.py] => Learning on 0-5
2025-01-09 11:21:59,028 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 11:21:59,028 [trainer.py] => model_name: asp
2025-01-09 11:21:59,028 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 11:21:59,028 [trainer.py] => device: ['cuda']
2025-01-09 11:21:59,028 [trainer.py] => seed: 2024
2025-01-09 11:21:59,028 [trainer.py] => dataset: cifar224
2025-01-09 11:21:59,028 [trainer.py] => init_cls: 5
2025-01-09 11:21:59,028 [trainer.py] => increment: 5
2025-01-09 11:21:59,028 [trainer.py] => kshot: 5
2025-01-09 11:21:59,028 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 11:21:59,028 [trainer.py] => z_dim: 1000
2025-01-09 11:21:59,028 [trainer.py] => conv_dim: 64
2025-01-09 11:21:59,028 [trainer.py] => img_size: 224
2025-01-09 11:21:59,028 [trainer.py] => generator_lr: 0.005
2025-01-09 11:21:59,028 [trainer.py] => pi: 100
2025-01-09 11:21:59,028 [trainer.py] => w_bn: 50.0
2025-01-09 11:21:59,028 [trainer.py] => w_noise: 0.001
2025-01-09 11:21:59,028 [trainer.py] => server_ss: 32
2025-01-09 11:21:59,028 [trainer.py] => bn_loss: 1
2025-01-09 11:21:59,028 [trainer.py] => noise: 1
2025-01-09 11:21:59,028 [trainer.py] => ie_loss: 1
2025-01-09 11:21:59,028 [trainer.py] => act_loss: 0
2025-01-09 11:21:59,028 [trainer.py] => w_ie: 1.0
2025-01-09 11:21:59,028 [trainer.py] => w_act: 0.1
2025-01-09 11:21:59,029 [trainer.py] => syn_size: 32
2025-01-09 11:21:59,029 [trainer.py] => need_syn_imgs: True
2025-01-09 11:21:59,029 [trainer.py] => g_local_bs: 42
2025-01-09 11:21:59,029 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 11:21:59,029 [trainer.py] => g_local_train_steps: 10
2025-01-09 11:21:59,029 [trainer.py] => dataset_syn: cifar100
2025-01-09 11:21:59,029 [trainer.py] => com_round_gen: 10
2025-01-09 11:21:59,029 [trainer.py] => g_sigma: 0
2025-01-09 11:21:59,029 [trainer.py] => save_cls_embeds: False
2025-01-09 11:21:59,029 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 11:21:59,029 [trainer.py] => save_dir: outputs
2025-01-09 11:21:59,029 [trainer.py] => n_iter: 5
2025-01-09 11:21:59,029 [trainer.py] => num_users: 1
2025-01-09 11:21:59,029 [trainer.py] => cur_size: 50
2025-01-09 11:21:59,029 [trainer.py] => local_bs: 5
2025-01-09 11:21:59,029 [trainer.py] => vpt_type: Deep
2025-01-09 11:21:59,029 [trainer.py] => prompt_token_num: 6
2025-01-09 11:21:59,029 [trainer.py] => avg_alpha: 0.8
2025-01-09 11:21:59,029 [trainer.py] => perturb_var: 1
2025-01-09 11:21:59,029 [trainer.py] => EMA_beta: 0.99
2025-01-09 11:21:59,029 [trainer.py] => anchor_lambda: 0.1
2025-01-09 11:21:59,029 [trainer.py] => kl_weight: 0.001
2025-01-09 11:21:59,029 [trainer.py] => TIP_init: zero
2025-01-09 11:21:59,029 [trainer.py] => tuned_epoch: 10
2025-01-09 11:21:59,029 [trainer.py] => fs_epoch: 0
2025-01-09 11:21:59,029 [trainer.py] => init_lr: 0.01
2025-01-09 11:21:59,029 [trainer.py] => fs_lr: 0.001
2025-01-09 11:21:59,029 [trainer.py] => batch_size: 48
2025-01-09 11:21:59,029 [trainer.py] => fs_batch_size: 16
2025-01-09 11:21:59,029 [trainer.py] => weight_decay: 0.0005
2025-01-09 11:21:59,029 [trainer.py] => min_lr: 0
2025-01-09 11:21:59,029 [trainer.py] => optimizer: sgd
2025-01-09 11:21:59,029 [trainer.py] => memory_size: 0
2025-01-09 11:21:59,029 [trainer.py] => memory_per_class: 0
2025-01-09 11:21:59,029 [trainer.py] => fixed_memory: False
2025-01-09 11:21:59,029 [trainer.py] => shuffle: False
2025-01-09 11:21:59,029 [trainer.py] => top_k: 5
2025-01-09 11:21:59,029 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 11:21:59,029 [trainer.py] => prefix: asp
2025-01-09 11:21:59,030 [trainer.py] => model_prefix: asp
2025-01-09 11:22:00,695 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 11:22:27,130 [trainer.py] => All params: 173596160
2025-01-09 11:22:27,131 [trainer.py] => Trainable params: 1998848
2025-01-09 11:22:27,131 [asp.py] => Learning on 0-5
2025-01-09 13:44:57,850 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 13:44:57,850 [trainer.py] => model_name: asp
2025-01-09 13:44:57,850 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 13:44:57,850 [trainer.py] => device: ['cuda']
2025-01-09 13:44:57,850 [trainer.py] => seed: 2024
2025-01-09 13:44:57,850 [trainer.py] => dataset: cifar224
2025-01-09 13:44:57,850 [trainer.py] => init_cls: 5
2025-01-09 13:44:57,850 [trainer.py] => increment: 5
2025-01-09 13:44:57,850 [trainer.py] => kshot: 5
2025-01-09 13:44:57,850 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 13:44:57,850 [trainer.py] => z_dim: 1000
2025-01-09 13:44:57,850 [trainer.py] => conv_dim: 64
2025-01-09 13:44:57,850 [trainer.py] => img_size: 224
2025-01-09 13:44:57,851 [trainer.py] => generator_lr: 0.005
2025-01-09 13:44:57,851 [trainer.py] => pi: 100
2025-01-09 13:44:57,851 [trainer.py] => w_bn: 50.0
2025-01-09 13:44:57,851 [trainer.py] => w_noise: 0.001
2025-01-09 13:44:57,851 [trainer.py] => server_ss: 32
2025-01-09 13:44:57,851 [trainer.py] => bn_loss: 1
2025-01-09 13:44:57,851 [trainer.py] => noise: 1
2025-01-09 13:44:57,851 [trainer.py] => ie_loss: 1
2025-01-09 13:44:57,851 [trainer.py] => act_loss: 0
2025-01-09 13:44:57,851 [trainer.py] => w_ie: 1.0
2025-01-09 13:44:57,851 [trainer.py] => w_act: 0.1
2025-01-09 13:44:57,851 [trainer.py] => syn_size: 32
2025-01-09 13:44:57,851 [trainer.py] => need_syn_imgs: True
2025-01-09 13:44:57,851 [trainer.py] => g_local_bs: 42
2025-01-09 13:44:57,851 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 13:44:57,851 [trainer.py] => g_local_train_steps: 10
2025-01-09 13:44:57,851 [trainer.py] => dataset_syn: cifar100
2025-01-09 13:44:57,851 [trainer.py] => com_round_gen: 10
2025-01-09 13:44:57,851 [trainer.py] => g_sigma: 0
2025-01-09 13:44:57,851 [trainer.py] => save_cls_embeds: False
2025-01-09 13:44:57,851 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 13:44:57,851 [trainer.py] => save_dir: outputs
2025-01-09 13:44:57,851 [trainer.py] => n_iter: 5
2025-01-09 13:44:57,851 [trainer.py] => num_users: 1
2025-01-09 13:44:57,851 [trainer.py] => cur_size: 50
2025-01-09 13:44:57,851 [trainer.py] => local_bs: 5
2025-01-09 13:44:57,851 [trainer.py] => vpt_type: Deep
2025-01-09 13:44:57,851 [trainer.py] => prompt_token_num: 6
2025-01-09 13:44:57,851 [trainer.py] => avg_alpha: 0.8
2025-01-09 13:44:57,851 [trainer.py] => perturb_var: 1
2025-01-09 13:44:57,851 [trainer.py] => EMA_beta: 0.99
2025-01-09 13:44:57,851 [trainer.py] => anchor_lambda: 0.1
2025-01-09 13:44:57,851 [trainer.py] => kl_weight: 0.001
2025-01-09 13:44:57,851 [trainer.py] => TIP_init: zero
2025-01-09 13:44:57,851 [trainer.py] => tuned_epoch: 10
2025-01-09 13:44:57,851 [trainer.py] => fs_epoch: 0
2025-01-09 13:44:57,852 [trainer.py] => init_lr: 0.01
2025-01-09 13:44:57,852 [trainer.py] => fs_lr: 0.001
2025-01-09 13:44:57,852 [trainer.py] => batch_size: 48
2025-01-09 13:44:57,852 [trainer.py] => fs_batch_size: 16
2025-01-09 13:44:57,852 [trainer.py] => weight_decay: 0.0005
2025-01-09 13:44:57,852 [trainer.py] => min_lr: 0
2025-01-09 13:44:57,852 [trainer.py] => optimizer: sgd
2025-01-09 13:44:57,852 [trainer.py] => memory_size: 0
2025-01-09 13:44:57,852 [trainer.py] => memory_per_class: 0
2025-01-09 13:44:57,852 [trainer.py] => fixed_memory: False
2025-01-09 13:44:57,852 [trainer.py] => shuffle: False
2025-01-09 13:44:57,852 [trainer.py] => top_k: 5
2025-01-09 13:44:57,852 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 13:44:57,852 [trainer.py] => prefix: asp
2025-01-09 13:44:57,852 [trainer.py] => model_prefix: asp
2025-01-09 13:44:59,386 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 13:45:23,356 [trainer.py] => All params: 173596160
2025-01-09 13:45:23,357 [trainer.py] => Trainable params: 1998848
2025-01-09 13:45:23,357 [asp.py] => Learning on 0-5
2025-01-09 13:45:23,363 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 14:02:10,054 [trainer.py] => Top1 curve: [21.6]
2025-01-09 14:02:10,055 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-09 14:02:10,056 [trainer.py] => All params: 173600001
2025-01-09 14:02:10,056 [trainer.py] => Trainable params: 2002689
2025-01-09 14:02:10,057 [asp.py] => Learning on 5-10
2025-01-09 14:02:10,066 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 14:18:08,316 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 14:18:08,316 [trainer.py] => model_name: asp
2025-01-09 14:18:08,316 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 14:18:08,316 [trainer.py] => device: ['cuda']
2025-01-09 14:18:08,316 [trainer.py] => seed: 2024
2025-01-09 14:18:08,316 [trainer.py] => dataset: cifar224
2025-01-09 14:18:08,316 [trainer.py] => init_cls: 5
2025-01-09 14:18:08,316 [trainer.py] => increment: 5
2025-01-09 14:18:08,316 [trainer.py] => kshot: 5
2025-01-09 14:18:08,316 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 14:18:08,316 [trainer.py] => z_dim: 1000
2025-01-09 14:18:08,316 [trainer.py] => conv_dim: 64
2025-01-09 14:18:08,316 [trainer.py] => img_size: 224
2025-01-09 14:18:08,316 [trainer.py] => generator_lr: 0.005
2025-01-09 14:18:08,316 [trainer.py] => pi: 100
2025-01-09 14:18:08,316 [trainer.py] => w_bn: 50.0
2025-01-09 14:18:08,317 [trainer.py] => w_noise: 0.001
2025-01-09 14:18:08,317 [trainer.py] => server_ss: 32
2025-01-09 14:18:08,317 [trainer.py] => bn_loss: 1
2025-01-09 14:18:08,317 [trainer.py] => noise: 1
2025-01-09 14:18:08,317 [trainer.py] => ie_loss: 1
2025-01-09 14:18:08,317 [trainer.py] => act_loss: 0
2025-01-09 14:18:08,317 [trainer.py] => w_ie: 1.0
2025-01-09 14:18:08,317 [trainer.py] => w_act: 0.1
2025-01-09 14:18:08,317 [trainer.py] => syn_size: 32
2025-01-09 14:18:08,317 [trainer.py] => need_syn_imgs: True
2025-01-09 14:18:08,317 [trainer.py] => g_local_bs: 42
2025-01-09 14:18:08,317 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 14:18:08,317 [trainer.py] => g_local_train_steps: 5
2025-01-09 14:18:08,317 [trainer.py] => dataset_syn: cifar100
2025-01-09 14:18:08,317 [trainer.py] => com_round_gen: 10
2025-01-09 14:18:08,317 [trainer.py] => g_sigma: 0
2025-01-09 14:18:08,317 [trainer.py] => save_cls_embeds: False
2025-01-09 14:18:08,317 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 14:18:08,317 [trainer.py] => save_dir: outputs
2025-01-09 14:18:08,317 [trainer.py] => n_iter: 5
2025-01-09 14:18:08,317 [trainer.py] => num_users: 1
2025-01-09 14:18:08,317 [trainer.py] => cur_size: 50
2025-01-09 14:18:08,317 [trainer.py] => local_bs: 5
2025-01-09 14:18:08,317 [trainer.py] => vpt_type: Deep
2025-01-09 14:18:08,317 [trainer.py] => prompt_token_num: 6
2025-01-09 14:18:08,317 [trainer.py] => avg_alpha: 0.8
2025-01-09 14:18:08,317 [trainer.py] => perturb_var: 1
2025-01-09 14:18:08,317 [trainer.py] => EMA_beta: 0.99
2025-01-09 14:18:08,317 [trainer.py] => anchor_lambda: 0.1
2025-01-09 14:18:08,317 [trainer.py] => kl_weight: 0.001
2025-01-09 14:18:08,317 [trainer.py] => TIP_init: zero
2025-01-09 14:18:08,317 [trainer.py] => tuned_epoch: 10
2025-01-09 14:18:08,317 [trainer.py] => fs_epoch: 0
2025-01-09 14:18:08,317 [trainer.py] => init_lr: 0.01
2025-01-09 14:18:08,317 [trainer.py] => fs_lr: 0.001
2025-01-09 14:18:08,318 [trainer.py] => batch_size: 48
2025-01-09 14:18:08,318 [trainer.py] => fs_batch_size: 16
2025-01-09 14:18:08,318 [trainer.py] => weight_decay: 0.0005
2025-01-09 14:18:08,318 [trainer.py] => min_lr: 0
2025-01-09 14:18:08,318 [trainer.py] => optimizer: sgd
2025-01-09 14:18:08,318 [trainer.py] => memory_size: 0
2025-01-09 14:18:08,318 [trainer.py] => memory_per_class: 0
2025-01-09 14:18:08,318 [trainer.py] => fixed_memory: False
2025-01-09 14:18:08,318 [trainer.py] => shuffle: False
2025-01-09 14:18:08,318 [trainer.py] => top_k: 5
2025-01-09 14:18:08,318 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 14:18:08,318 [trainer.py] => prefix: asp
2025-01-09 14:18:08,318 [trainer.py] => model_prefix: asp
2025-01-09 14:18:09,835 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 14:18:32,920 [trainer.py] => All params: 173596160
2025-01-09 14:18:32,921 [trainer.py] => Trainable params: 1998848
2025-01-09 14:18:32,922 [asp.py] => Learning on 0-5
2025-01-09 14:18:32,927 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 14:19:15,267 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 14:19:15,267 [trainer.py] => model_name: asp
2025-01-09 14:19:15,268 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 14:19:15,268 [trainer.py] => device: ['cuda']
2025-01-09 14:19:15,268 [trainer.py] => seed: 2024
2025-01-09 14:19:15,268 [trainer.py] => dataset: cifar224
2025-01-09 14:19:15,268 [trainer.py] => init_cls: 5
2025-01-09 14:19:15,268 [trainer.py] => increment: 5
2025-01-09 14:19:15,268 [trainer.py] => kshot: 5
2025-01-09 14:19:15,268 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 14:19:15,268 [trainer.py] => z_dim: 1000
2025-01-09 14:19:15,268 [trainer.py] => conv_dim: 64
2025-01-09 14:19:15,268 [trainer.py] => img_size: 224
2025-01-09 14:19:15,268 [trainer.py] => generator_lr: 0.005
2025-01-09 14:19:15,268 [trainer.py] => pi: 100
2025-01-09 14:19:15,268 [trainer.py] => w_bn: 50.0
2025-01-09 14:19:15,268 [trainer.py] => w_noise: 0.001
2025-01-09 14:19:15,268 [trainer.py] => server_ss: 32
2025-01-09 14:19:15,268 [trainer.py] => bn_loss: 1
2025-01-09 14:19:15,268 [trainer.py] => noise: 1
2025-01-09 14:19:15,268 [trainer.py] => ie_loss: 1
2025-01-09 14:19:15,268 [trainer.py] => act_loss: 0
2025-01-09 14:19:15,268 [trainer.py] => w_ie: 1.0
2025-01-09 14:19:15,268 [trainer.py] => w_act: 0.1
2025-01-09 14:19:15,268 [trainer.py] => syn_size: 32
2025-01-09 14:19:15,268 [trainer.py] => need_syn_imgs: True
2025-01-09 14:19:15,268 [trainer.py] => g_local_bs: 42
2025-01-09 14:19:15,268 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 14:19:15,268 [trainer.py] => g_local_train_steps: 5
2025-01-09 14:19:15,268 [trainer.py] => dataset_syn: cifar100
2025-01-09 14:19:15,268 [trainer.py] => com_round_gen: 10
2025-01-09 14:19:15,268 [trainer.py] => g_sigma: 0
2025-01-09 14:19:15,268 [trainer.py] => save_cls_embeds: False
2025-01-09 14:19:15,268 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 14:19:15,268 [trainer.py] => save_dir: outputs
2025-01-09 14:19:15,268 [trainer.py] => n_iter: 5
2025-01-09 14:19:15,268 [trainer.py] => num_users: 1
2025-01-09 14:19:15,268 [trainer.py] => cur_size: 50
2025-01-09 14:19:15,269 [trainer.py] => local_bs: 5
2025-01-09 14:19:15,269 [trainer.py] => vpt_type: Deep
2025-01-09 14:19:15,269 [trainer.py] => prompt_token_num: 6
2025-01-09 14:19:15,269 [trainer.py] => avg_alpha: 0.8
2025-01-09 14:19:15,269 [trainer.py] => perturb_var: 1
2025-01-09 14:19:15,269 [trainer.py] => EMA_beta: 0.99
2025-01-09 14:19:15,269 [trainer.py] => anchor_lambda: 0.1
2025-01-09 14:19:15,269 [trainer.py] => kl_weight: 0.001
2025-01-09 14:19:15,269 [trainer.py] => TIP_init: zero
2025-01-09 14:19:15,269 [trainer.py] => tuned_epoch: 10
2025-01-09 14:19:15,269 [trainer.py] => fs_epoch: 0
2025-01-09 14:19:15,269 [trainer.py] => init_lr: 0.01
2025-01-09 14:19:15,269 [trainer.py] => fs_lr: 0.001
2025-01-09 14:19:15,269 [trainer.py] => batch_size: 48
2025-01-09 14:19:15,269 [trainer.py] => fs_batch_size: 16
2025-01-09 14:19:15,269 [trainer.py] => weight_decay: 0.0005
2025-01-09 14:19:15,269 [trainer.py] => min_lr: 0
2025-01-09 14:19:15,269 [trainer.py] => optimizer: sgd
2025-01-09 14:19:15,269 [trainer.py] => memory_size: 0
2025-01-09 14:19:15,269 [trainer.py] => memory_per_class: 0
2025-01-09 14:19:15,269 [trainer.py] => fixed_memory: False
2025-01-09 14:19:15,269 [trainer.py] => shuffle: False
2025-01-09 14:19:15,269 [trainer.py] => top_k: 5
2025-01-09 14:19:15,269 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 14:19:15,269 [trainer.py] => prefix: asp
2025-01-09 14:19:15,269 [trainer.py] => model_prefix: asp
2025-01-09 14:19:16,937 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 14:19:41,799 [trainer.py] => All params: 173596160
2025-01-09 14:19:41,801 [trainer.py] => Trainable params: 1998848
2025-01-09 14:19:41,801 [asp.py] => Learning on 0-5
2025-01-09 14:19:41,807 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 14:21:52,062 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 14:21:52,062 [trainer.py] => model_name: asp
2025-01-09 14:21:52,062 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 14:21:52,062 [trainer.py] => device: ['cuda']
2025-01-09 14:21:52,062 [trainer.py] => seed: 2024
2025-01-09 14:21:52,062 [trainer.py] => dataset: cifar224
2025-01-09 14:21:52,062 [trainer.py] => init_cls: 5
2025-01-09 14:21:52,062 [trainer.py] => increment: 5
2025-01-09 14:21:52,062 [trainer.py] => kshot: 5
2025-01-09 14:21:52,062 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 14:21:52,062 [trainer.py] => z_dim: 1000
2025-01-09 14:21:52,062 [trainer.py] => conv_dim: 64
2025-01-09 14:21:52,062 [trainer.py] => img_size: 224
2025-01-09 14:21:52,062 [trainer.py] => generator_lr: 0.005
2025-01-09 14:21:52,062 [trainer.py] => pi: 100
2025-01-09 14:21:52,062 [trainer.py] => w_bn: 50.0
2025-01-09 14:21:52,062 [trainer.py] => w_noise: 0.001
2025-01-09 14:21:52,062 [trainer.py] => server_ss: 32
2025-01-09 14:21:52,062 [trainer.py] => bn_loss: 1
2025-01-09 14:21:52,062 [trainer.py] => noise: 1
2025-01-09 14:21:52,062 [trainer.py] => ie_loss: 1
2025-01-09 14:21:52,062 [trainer.py] => act_loss: 0
2025-01-09 14:21:52,062 [trainer.py] => w_ie: 1.0
2025-01-09 14:21:52,062 [trainer.py] => w_act: 0.1
2025-01-09 14:21:52,062 [trainer.py] => syn_size: 32
2025-01-09 14:21:52,062 [trainer.py] => need_syn_imgs: True
2025-01-09 14:21:52,062 [trainer.py] => g_local_bs: 12
2025-01-09 14:21:52,063 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 14:21:52,063 [trainer.py] => g_local_train_steps: 5
2025-01-09 14:21:52,063 [trainer.py] => dataset_syn: cifar100
2025-01-09 14:21:52,063 [trainer.py] => com_round_gen: 10
2025-01-09 14:21:52,063 [trainer.py] => g_sigma: 0
2025-01-09 14:21:52,063 [trainer.py] => save_cls_embeds: False
2025-01-09 14:21:52,063 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 14:21:52,063 [trainer.py] => save_dir: outputs
2025-01-09 14:21:52,063 [trainer.py] => n_iter: 5
2025-01-09 14:21:52,063 [trainer.py] => num_users: 1
2025-01-09 14:21:52,063 [trainer.py] => cur_size: 50
2025-01-09 14:21:52,063 [trainer.py] => local_bs: 5
2025-01-09 14:21:52,063 [trainer.py] => vpt_type: Deep
2025-01-09 14:21:52,063 [trainer.py] => prompt_token_num: 6
2025-01-09 14:21:52,063 [trainer.py] => avg_alpha: 0.8
2025-01-09 14:21:52,063 [trainer.py] => perturb_var: 1
2025-01-09 14:21:52,063 [trainer.py] => EMA_beta: 0.99
2025-01-09 14:21:52,063 [trainer.py] => anchor_lambda: 0.1
2025-01-09 14:21:52,063 [trainer.py] => kl_weight: 0.001
2025-01-09 14:21:52,063 [trainer.py] => TIP_init: zero
2025-01-09 14:21:52,063 [trainer.py] => tuned_epoch: 10
2025-01-09 14:21:52,063 [trainer.py] => fs_epoch: 0
2025-01-09 14:21:52,063 [trainer.py] => init_lr: 0.01
2025-01-09 14:21:52,063 [trainer.py] => fs_lr: 0.001
2025-01-09 14:21:52,063 [trainer.py] => batch_size: 48
2025-01-09 14:21:52,063 [trainer.py] => fs_batch_size: 16
2025-01-09 14:21:52,063 [trainer.py] => weight_decay: 0.0005
2025-01-09 14:21:52,063 [trainer.py] => min_lr: 0
2025-01-09 14:21:52,063 [trainer.py] => optimizer: sgd
2025-01-09 14:21:52,063 [trainer.py] => memory_size: 0
2025-01-09 14:21:52,063 [trainer.py] => memory_per_class: 0
2025-01-09 14:21:52,063 [trainer.py] => fixed_memory: False
2025-01-09 14:21:52,063 [trainer.py] => shuffle: False
2025-01-09 14:21:52,063 [trainer.py] => top_k: 5
2025-01-09 14:21:52,063 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 14:21:52,063 [trainer.py] => prefix: asp
2025-01-09 14:21:52,063 [trainer.py] => model_prefix: asp
2025-01-09 14:21:53,836 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 14:22:18,536 [trainer.py] => All params: 173596160
2025-01-09 14:22:18,538 [trainer.py] => Trainable params: 1998848
2025-01-09 14:22:18,539 [asp.py] => Learning on 0-5
2025-01-09 14:22:18,544 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 14:25:52,458 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 14:25:52,458 [trainer.py] => model_name: asp
2025-01-09 14:25:52,458 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 14:25:52,458 [trainer.py] => device: ['cuda']
2025-01-09 14:25:52,458 [trainer.py] => seed: 2024
2025-01-09 14:25:52,458 [trainer.py] => dataset: cifar224
2025-01-09 14:25:52,458 [trainer.py] => init_cls: 5
2025-01-09 14:25:52,458 [trainer.py] => increment: 5
2025-01-09 14:25:52,458 [trainer.py] => kshot: 5
2025-01-09 14:25:52,458 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 14:25:52,458 [trainer.py] => z_dim: 1000
2025-01-09 14:25:52,458 [trainer.py] => conv_dim: 64
2025-01-09 14:25:52,458 [trainer.py] => img_size: 224
2025-01-09 14:25:52,459 [trainer.py] => generator_lr: 0.005
2025-01-09 14:25:52,459 [trainer.py] => pi: 100
2025-01-09 14:25:52,459 [trainer.py] => w_bn: 50.0
2025-01-09 14:25:52,459 [trainer.py] => w_noise: 0.001
2025-01-09 14:25:52,459 [trainer.py] => server_ss: 32
2025-01-09 14:25:52,459 [trainer.py] => bn_loss: 1
2025-01-09 14:25:52,459 [trainer.py] => noise: 1
2025-01-09 14:25:52,459 [trainer.py] => ie_loss: 1
2025-01-09 14:25:52,459 [trainer.py] => act_loss: 0
2025-01-09 14:25:52,459 [trainer.py] => w_ie: 1.0
2025-01-09 14:25:52,459 [trainer.py] => w_act: 0.1
2025-01-09 14:25:52,459 [trainer.py] => syn_size: 32
2025-01-09 14:25:52,459 [trainer.py] => need_syn_imgs: True
2025-01-09 14:25:52,459 [trainer.py] => g_local_bs: 5
2025-01-09 14:25:52,459 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 14:25:52,459 [trainer.py] => g_local_train_steps: 5
2025-01-09 14:25:52,459 [trainer.py] => dataset_syn: cifar100
2025-01-09 14:25:52,459 [trainer.py] => com_round_gen: 10
2025-01-09 14:25:52,459 [trainer.py] => g_sigma: 0
2025-01-09 14:25:52,459 [trainer.py] => save_cls_embeds: False
2025-01-09 14:25:52,459 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 14:25:52,459 [trainer.py] => save_dir: outputs
2025-01-09 14:25:52,459 [trainer.py] => n_iter: 5
2025-01-09 14:25:52,459 [trainer.py] => num_users: 1
2025-01-09 14:25:52,459 [trainer.py] => cur_size: 50
2025-01-09 14:25:52,459 [trainer.py] => local_bs: 5
2025-01-09 14:25:52,459 [trainer.py] => vpt_type: Deep
2025-01-09 14:25:52,459 [trainer.py] => prompt_token_num: 6
2025-01-09 14:25:52,459 [trainer.py] => avg_alpha: 0.8
2025-01-09 14:25:52,459 [trainer.py] => perturb_var: 1
2025-01-09 14:25:52,459 [trainer.py] => EMA_beta: 0.99
2025-01-09 14:25:52,459 [trainer.py] => anchor_lambda: 0.1
2025-01-09 14:25:52,459 [trainer.py] => kl_weight: 0.001
2025-01-09 14:25:52,459 [trainer.py] => TIP_init: zero
2025-01-09 14:25:52,459 [trainer.py] => tuned_epoch: 10
2025-01-09 14:25:52,459 [trainer.py] => fs_epoch: 0
2025-01-09 14:25:52,460 [trainer.py] => init_lr: 0.01
2025-01-09 14:25:52,460 [trainer.py] => fs_lr: 0.001
2025-01-09 14:25:52,460 [trainer.py] => batch_size: 48
2025-01-09 14:25:52,460 [trainer.py] => fs_batch_size: 16
2025-01-09 14:25:52,460 [trainer.py] => weight_decay: 0.0005
2025-01-09 14:25:52,460 [trainer.py] => min_lr: 0
2025-01-09 14:25:52,460 [trainer.py] => optimizer: sgd
2025-01-09 14:25:52,460 [trainer.py] => memory_size: 0
2025-01-09 14:25:52,460 [trainer.py] => memory_per_class: 0
2025-01-09 14:25:52,460 [trainer.py] => fixed_memory: False
2025-01-09 14:25:52,460 [trainer.py] => shuffle: False
2025-01-09 14:25:52,460 [trainer.py] => top_k: 5
2025-01-09 14:25:52,460 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 14:25:52,460 [trainer.py] => prefix: asp
2025-01-09 14:25:52,460 [trainer.py] => model_prefix: asp
2025-01-09 14:25:54,204 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 14:26:17,550 [trainer.py] => All params: 173596160
2025-01-09 14:26:17,551 [trainer.py] => Trainable params: 1998848
2025-01-09 14:26:17,551 [asp.py] => Learning on 0-5
2025-01-09 14:26:17,556 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 14:38:58,758 [trainer.py] => Top1 curve: [21.6]
2025-01-09 14:38:58,759 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-09 14:38:58,760 [trainer.py] => All params: 173600001
2025-01-09 14:38:58,760 [trainer.py] => Trainable params: 2002689
2025-01-09 14:38:58,762 [asp.py] => Learning on 5-10
2025-01-09 14:38:58,771 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 14:41:59,294 [trainer.py] => Top1 curve: [21.6]
2025-01-09 14:41:59,295 [trainer.py] => Average Accuracy (Top1): 21.6   (Harmonic Accuracy): None (Old Acc): 21.6 (New Acc): [] 

2025-01-09 14:41:59,296 [trainer.py] => All params: 173600001
2025-01-09 14:41:59,296 [trainer.py] => Trainable params: 2002689
2025-01-09 14:41:59,297 [asp.py] => Learning on 5-10
2025-01-09 14:41:59,307 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 14:55:52,867 [trainer.py] => Top1 curve: [21.6, 10.8]
2025-01-09 14:55:52,868 [trainer.py] => Average Accuracy (Top1): 16.200000000000003   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 14:55:52,869 [trainer.py] => All params: 173603841
2025-01-09 14:55:52,869 [trainer.py] => Trainable params: 2006529
2025-01-09 14:55:52,871 [asp.py] => Learning on 10-15
2025-01-09 14:55:52,885 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 14:57:51,542 [trainer.py] => Top1 curve: [21.6, 10.8]
2025-01-09 14:57:51,542 [trainer.py] => Average Accuracy (Top1): 16.200000000000003   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 14:57:51,543 [trainer.py] => All params: 173603841
2025-01-09 14:57:51,543 [trainer.py] => Trainable params: 2006529
2025-01-09 14:57:51,544 [asp.py] => Learning on 10-15
2025-01-09 14:57:51,557 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 15:12:47,534 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2]
2025-01-09 15:12:47,535 [trainer.py] => Average Accuracy (Top1): 13.200000000000003   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 15:12:47,536 [trainer.py] => All params: 173607681
2025-01-09 15:12:47,536 [trainer.py] => Trainable params: 2010369
2025-01-09 15:12:47,537 [asp.py] => Learning on 15-20
2025-01-09 15:12:47,546 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 15:13:45,075 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2]
2025-01-09 15:13:45,075 [trainer.py] => Average Accuracy (Top1): 13.200000000000003   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 15:13:45,077 [trainer.py] => All params: 173607681
2025-01-09 15:13:45,077 [trainer.py] => Trainable params: 2010369
2025-01-09 15:13:45,079 [asp.py] => Learning on 15-20
2025-01-09 15:13:45,092 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 15:29:39,863 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4]
2025-01-09 15:29:39,864 [trainer.py] => Average Accuracy (Top1): 11.250000000000002   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 15:29:39,866 [trainer.py] => All params: 173611521
2025-01-09 15:29:39,866 [trainer.py] => Trainable params: 2014209
2025-01-09 15:29:39,867 [asp.py] => Learning on 20-25
2025-01-09 15:29:39,884 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 15:29:45,582 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4]
2025-01-09 15:29:45,583 [trainer.py] => Average Accuracy (Top1): 11.250000000000002   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 15:29:45,584 [trainer.py] => All params: 173611521
2025-01-09 15:29:45,584 [trainer.py] => Trainable params: 2014209
2025-01-09 15:29:45,585 [asp.py] => Learning on 20-25
2025-01-09 15:29:45,602 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 15:45:37,347 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32]
2025-01-09 15:45:37,348 [trainer.py] => Average Accuracy (Top1): 9.864   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 15:45:37,349 [trainer.py] => All params: 173615361
2025-01-09 15:45:37,350 [trainer.py] => Trainable params: 2018049
2025-01-09 15:45:37,351 [asp.py] => Learning on 25-30
2025-01-09 15:45:37,360 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 15:46:35,913 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32]
2025-01-09 15:46:35,914 [trainer.py] => Average Accuracy (Top1): 9.864   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 15:46:35,915 [trainer.py] => All params: 173615361
2025-01-09 15:46:35,915 [trainer.py] => Trainable params: 2018049
2025-01-09 15:46:35,917 [asp.py] => Learning on 25-30
2025-01-09 15:46:35,930 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 16:01:37,611 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6]
2025-01-09 16:01:37,612 [trainer.py] => Average Accuracy (Top1): 8.820000000000002   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 16:01:37,613 [trainer.py] => All params: 173619201
2025-01-09 16:01:37,614 [trainer.py] => Trainable params: 2021889
2025-01-09 16:01:37,615 [asp.py] => Learning on 30-35
2025-01-09 16:01:37,638 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 16:03:28,273 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6]
2025-01-09 16:03:28,273 [trainer.py] => Average Accuracy (Top1): 8.820000000000002   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 16:03:28,274 [trainer.py] => All params: 173619201
2025-01-09 16:03:28,275 [trainer.py] => Trainable params: 2021889
2025-01-09 16:03:28,276 [asp.py] => Learning on 30-35
2025-01-09 16:03:28,297 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 16:17:43,334 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09]
2025-01-09 16:17:43,335 [trainer.py] => Average Accuracy (Top1): 8.001428571428573   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 16:17:43,336 [trainer.py] => All params: 173623041
2025-01-09 16:17:43,337 [trainer.py] => Trainable params: 2025729
2025-01-09 16:17:43,338 [asp.py] => Learning on 35-40
2025-01-09 16:17:43,347 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 16:20:27,240 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09]
2025-01-09 16:20:27,241 [trainer.py] => Average Accuracy (Top1): 8.001428571428573   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 16:20:27,242 [trainer.py] => All params: 173623041
2025-01-09 16:20:27,243 [trainer.py] => Trainable params: 2025729
2025-01-09 16:20:27,244 [asp.py] => Learning on 35-40
2025-01-09 16:20:27,261 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 16:33:48,351 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7]
2025-01-09 16:33:48,351 [trainer.py] => Average Accuracy (Top1): 7.338750000000001   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 16:33:48,352 [trainer.py] => All params: 173626881
2025-01-09 16:33:48,353 [trainer.py] => Trainable params: 2029569
2025-01-09 16:33:48,354 [asp.py] => Learning on 40-45
2025-01-09 16:33:48,380 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 16:37:25,777 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7]
2025-01-09 16:37:25,777 [trainer.py] => Average Accuracy (Top1): 7.338750000000001   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 16:37:25,778 [trainer.py] => All params: 173626881
2025-01-09 16:37:25,779 [trainer.py] => Trainable params: 2029569
2025-01-09 16:37:25,780 [asp.py] => Learning on 40-45
2025-01-09 16:37:25,812 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 16:49:54,763 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4]
2025-01-09 16:49:54,764 [trainer.py] => Average Accuracy (Top1): 6.790000000000001   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 16:49:54,764 [trainer.py] => All params: 173630721
2025-01-09 16:49:54,765 [trainer.py] => Trainable params: 2033409
2025-01-09 16:49:54,766 [asp.py] => Learning on 45-50
2025-01-09 16:49:54,798 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 16:54:25,874 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4]
2025-01-09 16:54:25,874 [trainer.py] => Average Accuracy (Top1): 6.790000000000001   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 16:54:25,876 [trainer.py] => All params: 173630721
2025-01-09 16:54:25,876 [trainer.py] => Trainable params: 2033409
2025-01-09 16:54:25,878 [asp.py] => Learning on 45-50
2025-01-09 16:54:25,909 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 17:06:04,617 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16]
2025-01-09 17:06:04,618 [trainer.py] => Average Accuracy (Top1): 6.327000000000001   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 17:06:04,627 [trainer.py] => All params: 173634561
2025-01-09 17:06:04,630 [trainer.py] => Trainable params: 2037249
2025-01-09 17:06:04,632 [asp.py] => Learning on 50-55
2025-01-09 17:06:04,650 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 17:11:38,034 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16]
2025-01-09 17:11:38,034 [trainer.py] => Average Accuracy (Top1): 6.327000000000001   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 17:11:38,035 [trainer.py] => All params: 173634561
2025-01-09 17:11:38,036 [trainer.py] => Trainable params: 2037249
2025-01-09 17:11:38,037 [asp.py] => Learning on 50-55
2025-01-09 17:11:38,048 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 17:22:15,531 [trainer.py] => Top1 curve: [21.6, 10.8, 7.2, 5.4, 4.32, 3.6, 3.09, 2.7, 2.4, 2.16, 1.96]
2025-01-09 17:22:15,532 [trainer.py] => Average Accuracy (Top1): 5.930000000000001   (Harmonic Accuracy): 0.0 (Old Acc): 21.6 (New Acc): 0.0 

2025-01-09 17:22:15,533 [trainer.py] => All params: 173638401
2025-01-09 17:22:15,534 [trainer.py] => Trainable params: 2041089
2025-01-09 17:22:15,535 [asp.py] => Learning on 55-60
2025-01-09 17:22:15,547 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-09 22:20:23,310 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 22:20:23,311 [trainer.py] => model_name: asp
2025-01-09 22:20:23,311 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 22:20:23,311 [trainer.py] => device: ['cuda']
2025-01-09 22:20:23,311 [trainer.py] => seed: 2024
2025-01-09 22:20:23,311 [trainer.py] => dataset: cifar224
2025-01-09 22:20:23,311 [trainer.py] => init_cls: 5
2025-01-09 22:20:23,311 [trainer.py] => increment: 5
2025-01-09 22:20:23,311 [trainer.py] => kshot: 5
2025-01-09 22:20:23,311 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 22:20:23,311 [trainer.py] => z_dim: 1000
2025-01-09 22:20:23,311 [trainer.py] => conv_dim: 64
2025-01-09 22:20:23,311 [trainer.py] => img_size: 224
2025-01-09 22:20:23,311 [trainer.py] => generator_lr: 0.005
2025-01-09 22:20:23,311 [trainer.py] => pi: 100
2025-01-09 22:20:23,311 [trainer.py] => w_bn: 50.0
2025-01-09 22:20:23,311 [trainer.py] => w_noise: 0.001
2025-01-09 22:20:23,311 [trainer.py] => server_ss: 32
2025-01-09 22:20:23,311 [trainer.py] => bn_loss: 1
2025-01-09 22:20:23,311 [trainer.py] => noise: 1
2025-01-09 22:20:23,311 [trainer.py] => ie_loss: 1
2025-01-09 22:20:23,311 [trainer.py] => act_loss: 0
2025-01-09 22:20:23,311 [trainer.py] => w_ie: 1.0
2025-01-09 22:20:23,311 [trainer.py] => w_act: 0.1
2025-01-09 22:20:23,311 [trainer.py] => syn_size: 32
2025-01-09 22:20:23,312 [trainer.py] => need_syn_imgs: True
2025-01-09 22:20:23,312 [trainer.py] => g_local_bs: 5
2025-01-09 22:20:23,312 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 22:20:23,312 [trainer.py] => g_local_train_steps: 5
2025-01-09 22:20:23,312 [trainer.py] => dataset_syn: cifar100
2025-01-09 22:20:23,312 [trainer.py] => com_round_gen: 10
2025-01-09 22:20:23,312 [trainer.py] => g_sigma: 0
2025-01-09 22:20:23,312 [trainer.py] => save_cls_embeds: False
2025-01-09 22:20:23,312 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 22:20:23,312 [trainer.py] => save_dir: outputs
2025-01-09 22:20:23,312 [trainer.py] => n_iter: 5
2025-01-09 22:20:23,312 [trainer.py] => num_users: 1
2025-01-09 22:20:23,312 [trainer.py] => cur_size: 50
2025-01-09 22:20:23,312 [trainer.py] => local_bs: 5
2025-01-09 22:20:23,312 [trainer.py] => vpt_type: Deep
2025-01-09 22:20:23,312 [trainer.py] => prompt_token_num: 6
2025-01-09 22:20:23,312 [trainer.py] => avg_alpha: 0.8
2025-01-09 22:20:23,312 [trainer.py] => perturb_var: 1
2025-01-09 22:20:23,312 [trainer.py] => EMA_beta: 0.99
2025-01-09 22:20:23,312 [trainer.py] => anchor_lambda: 0.1
2025-01-09 22:20:23,312 [trainer.py] => kl_weight: 0.001
2025-01-09 22:20:23,312 [trainer.py] => TIP_init: zero
2025-01-09 22:20:23,312 [trainer.py] => tuned_epoch: 10
2025-01-09 22:20:23,312 [trainer.py] => fs_epoch: 0
2025-01-09 22:20:23,312 [trainer.py] => init_lr: 0.01
2025-01-09 22:20:23,312 [trainer.py] => fs_lr: 0.001
2025-01-09 22:20:23,312 [trainer.py] => batch_size: 48
2025-01-09 22:20:23,312 [trainer.py] => fs_batch_size: 16
2025-01-09 22:20:23,313 [trainer.py] => weight_decay: 0.0005
2025-01-09 22:20:23,313 [trainer.py] => min_lr: 0
2025-01-09 22:20:23,313 [trainer.py] => optimizer: sgd
2025-01-09 22:20:23,313 [trainer.py] => memory_size: 0
2025-01-09 22:20:23,313 [trainer.py] => memory_per_class: 0
2025-01-09 22:20:23,313 [trainer.py] => fixed_memory: False
2025-01-09 22:20:23,313 [trainer.py] => shuffle: False
2025-01-09 22:20:23,313 [trainer.py] => top_k: 5
2025-01-09 22:20:23,313 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 22:20:23,313 [trainer.py] => prefix: asp
2025-01-09 22:20:23,313 [trainer.py] => model_prefix: asp
2025-01-09 22:20:24,720 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 22:20:48,213 [trainer.py] => All params: 173596160
2025-01-09 22:20:48,214 [trainer.py] => Trainable params: 1998848
2025-01-09 22:20:48,215 [asp.py] => Learning on 0-5
2025-01-09 22:20:48,220 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 22:26:00,450 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 22:26:00,450 [trainer.py] => model_name: asp
2025-01-09 22:26:00,450 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 22:26:00,450 [trainer.py] => device: ['cuda']
2025-01-09 22:26:00,450 [trainer.py] => seed: 2024
2025-01-09 22:26:00,450 [trainer.py] => dataset: cifar224
2025-01-09 22:26:00,450 [trainer.py] => init_cls: 5
2025-01-09 22:26:00,450 [trainer.py] => increment: 5
2025-01-09 22:26:00,450 [trainer.py] => kshot: 5
2025-01-09 22:26:00,450 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 22:26:00,450 [trainer.py] => z_dim: 1000
2025-01-09 22:26:00,450 [trainer.py] => conv_dim: 64
2025-01-09 22:26:00,450 [trainer.py] => img_size: 224
2025-01-09 22:26:00,451 [trainer.py] => generator_lr: 0.005
2025-01-09 22:26:00,451 [trainer.py] => pi: 100
2025-01-09 22:26:00,451 [trainer.py] => w_bn: 50.0
2025-01-09 22:26:00,451 [trainer.py] => w_noise: 0.001
2025-01-09 22:26:00,451 [trainer.py] => server_ss: 32
2025-01-09 22:26:00,451 [trainer.py] => bn_loss: 1
2025-01-09 22:26:00,451 [trainer.py] => noise: 1
2025-01-09 22:26:00,451 [trainer.py] => ie_loss: 1
2025-01-09 22:26:00,451 [trainer.py] => act_loss: 0
2025-01-09 22:26:00,451 [trainer.py] => w_ie: 1.0
2025-01-09 22:26:00,451 [trainer.py] => w_act: 0.1
2025-01-09 22:26:00,451 [trainer.py] => syn_size: 32
2025-01-09 22:26:00,451 [trainer.py] => need_syn_imgs: True
2025-01-09 22:26:00,451 [trainer.py] => g_local_bs: 5
2025-01-09 22:26:00,451 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 22:26:00,451 [trainer.py] => g_local_train_steps: 5
2025-01-09 22:26:00,451 [trainer.py] => dataset_syn: cifar100
2025-01-09 22:26:00,451 [trainer.py] => com_round_gen: 10
2025-01-09 22:26:00,451 [trainer.py] => g_sigma: 0
2025-01-09 22:26:00,451 [trainer.py] => save_cls_embeds: False
2025-01-09 22:26:00,451 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 22:26:00,451 [trainer.py] => save_dir: outputs
2025-01-09 22:26:00,451 [trainer.py] => n_iter: 5
2025-01-09 22:26:00,451 [trainer.py] => num_users: 1
2025-01-09 22:26:00,451 [trainer.py] => cur_size: 50
2025-01-09 22:26:00,451 [trainer.py] => local_bs: 5
2025-01-09 22:26:00,451 [trainer.py] => vpt_type: Deep
2025-01-09 22:26:00,451 [trainer.py] => prompt_token_num: 6
2025-01-09 22:26:00,451 [trainer.py] => avg_alpha: 0.8
2025-01-09 22:26:00,451 [trainer.py] => perturb_var: 1
2025-01-09 22:26:00,451 [trainer.py] => EMA_beta: 0.99
2025-01-09 22:26:00,451 [trainer.py] => anchor_lambda: 0.1
2025-01-09 22:26:00,451 [trainer.py] => kl_weight: 0.001
2025-01-09 22:26:00,452 [trainer.py] => TIP_init: zero
2025-01-09 22:26:00,452 [trainer.py] => tuned_epoch: 10
2025-01-09 22:26:00,452 [trainer.py] => fs_epoch: 0
2025-01-09 22:26:00,452 [trainer.py] => init_lr: 0.01
2025-01-09 22:26:00,452 [trainer.py] => fs_lr: 0.001
2025-01-09 22:26:00,452 [trainer.py] => batch_size: 48
2025-01-09 22:26:00,452 [trainer.py] => fs_batch_size: 16
2025-01-09 22:26:00,452 [trainer.py] => weight_decay: 0.0005
2025-01-09 22:26:00,452 [trainer.py] => min_lr: 0
2025-01-09 22:26:00,452 [trainer.py] => optimizer: sgd
2025-01-09 22:26:00,452 [trainer.py] => memory_size: 0
2025-01-09 22:26:00,452 [trainer.py] => memory_per_class: 0
2025-01-09 22:26:00,452 [trainer.py] => fixed_memory: False
2025-01-09 22:26:00,452 [trainer.py] => shuffle: False
2025-01-09 22:26:00,452 [trainer.py] => top_k: 5
2025-01-09 22:26:00,452 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 22:26:00,452 [trainer.py] => prefix: asp
2025-01-09 22:26:00,452 [trainer.py] => model_prefix: asp
2025-01-09 22:26:10,940 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 22:26:10,940 [trainer.py] => model_name: asp
2025-01-09 22:26:10,941 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 22:26:10,941 [trainer.py] => device: ['cuda']
2025-01-09 22:26:10,941 [trainer.py] => seed: 2024
2025-01-09 22:26:10,941 [trainer.py] => dataset: cifar224
2025-01-09 22:26:10,941 [trainer.py] => init_cls: 5
2025-01-09 22:26:10,941 [trainer.py] => increment: 5
2025-01-09 22:26:10,941 [trainer.py] => kshot: 5
2025-01-09 22:26:10,941 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 22:26:10,941 [trainer.py] => z_dim: 1000
2025-01-09 22:26:10,941 [trainer.py] => conv_dim: 64
2025-01-09 22:26:10,941 [trainer.py] => img_size: 224
2025-01-09 22:26:10,941 [trainer.py] => generator_lr: 0.005
2025-01-09 22:26:10,941 [trainer.py] => pi: 100
2025-01-09 22:26:10,941 [trainer.py] => w_bn: 50.0
2025-01-09 22:26:10,941 [trainer.py] => w_noise: 0.001
2025-01-09 22:26:10,941 [trainer.py] => server_ss: 32
2025-01-09 22:26:10,941 [trainer.py] => bn_loss: 1
2025-01-09 22:26:10,941 [trainer.py] => noise: 1
2025-01-09 22:26:10,941 [trainer.py] => ie_loss: 1
2025-01-09 22:26:10,941 [trainer.py] => act_loss: 0
2025-01-09 22:26:10,941 [trainer.py] => w_ie: 1.0
2025-01-09 22:26:10,941 [trainer.py] => w_act: 0.1
2025-01-09 22:26:10,941 [trainer.py] => syn_size: 32
2025-01-09 22:26:10,941 [trainer.py] => need_syn_imgs: True
2025-01-09 22:26:10,941 [trainer.py] => g_local_bs: 5
2025-01-09 22:26:10,941 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 22:26:10,941 [trainer.py] => g_local_train_steps: 5
2025-01-09 22:26:10,941 [trainer.py] => dataset_syn: cifar100
2025-01-09 22:26:10,941 [trainer.py] => com_round_gen: 10
2025-01-09 22:26:10,941 [trainer.py] => g_sigma: 0
2025-01-09 22:26:10,941 [trainer.py] => save_cls_embeds: False
2025-01-09 22:26:10,942 [trainer.py] => syn_image_path: outputs/syn_image_10_debug
2025-01-09 22:26:10,942 [trainer.py] => save_dir: outputs
2025-01-09 22:26:10,942 [trainer.py] => n_iter: 5
2025-01-09 22:26:10,942 [trainer.py] => num_users: 1
2025-01-09 22:26:10,942 [trainer.py] => cur_size: 50
2025-01-09 22:26:10,942 [trainer.py] => local_bs: 5
2025-01-09 22:26:10,942 [trainer.py] => vpt_type: Deep
2025-01-09 22:26:10,942 [trainer.py] => prompt_token_num: 6
2025-01-09 22:26:10,942 [trainer.py] => avg_alpha: 0.8
2025-01-09 22:26:10,942 [trainer.py] => perturb_var: 1
2025-01-09 22:26:10,942 [trainer.py] => EMA_beta: 0.99
2025-01-09 22:26:10,942 [trainer.py] => anchor_lambda: 0.1
2025-01-09 22:26:10,942 [trainer.py] => kl_weight: 0.001
2025-01-09 22:26:10,942 [trainer.py] => TIP_init: zero
2025-01-09 22:26:10,942 [trainer.py] => tuned_epoch: 10
2025-01-09 22:26:10,942 [trainer.py] => fs_epoch: 0
2025-01-09 22:26:10,942 [trainer.py] => init_lr: 0.01
2025-01-09 22:26:10,942 [trainer.py] => fs_lr: 0.001
2025-01-09 22:26:10,942 [trainer.py] => batch_size: 48
2025-01-09 22:26:10,942 [trainer.py] => fs_batch_size: 16
2025-01-09 22:26:10,942 [trainer.py] => weight_decay: 0.0005
2025-01-09 22:26:10,942 [trainer.py] => min_lr: 0
2025-01-09 22:26:10,942 [trainer.py] => optimizer: sgd
2025-01-09 22:26:10,942 [trainer.py] => memory_size: 0
2025-01-09 22:26:10,942 [trainer.py] => memory_per_class: 0
2025-01-09 22:26:10,942 [trainer.py] => fixed_memory: False
2025-01-09 22:26:10,942 [trainer.py] => shuffle: False
2025-01-09 22:26:10,942 [trainer.py] => top_k: 5
2025-01-09 22:26:10,942 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 22:26:10,942 [trainer.py] => prefix: asp
2025-01-09 22:26:10,942 [trainer.py] => model_prefix: asp
2025-01-09 22:26:12,490 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 22:26:37,674 [trainer.py] => All params: 173596160
2025-01-09 22:26:37,675 [trainer.py] => Trainable params: 1998848
2025-01-09 22:26:37,675 [asp.py] => Learning on 0-5
2025-01-09 22:26:37,692 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 22:29:39,879 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 22:29:39,879 [trainer.py] => model_name: asp
2025-01-09 22:29:39,879 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 22:29:39,879 [trainer.py] => device: ['cuda']
2025-01-09 22:29:39,879 [trainer.py] => seed: 2024
2025-01-09 22:29:39,879 [trainer.py] => dataset: cifar224
2025-01-09 22:29:39,879 [trainer.py] => init_cls: 5
2025-01-09 22:29:39,879 [trainer.py] => increment: 5
2025-01-09 22:29:39,879 [trainer.py] => kshot: 5
2025-01-09 22:29:39,879 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 22:29:39,879 [trainer.py] => z_dim: 1000
2025-01-09 22:29:39,880 [trainer.py] => conv_dim: 64
2025-01-09 22:29:39,880 [trainer.py] => img_size: 224
2025-01-09 22:29:39,880 [trainer.py] => generator_lr: 0.005
2025-01-09 22:29:39,880 [trainer.py] => pi: 100
2025-01-09 22:29:39,880 [trainer.py] => w_bn: 50.0
2025-01-09 22:29:39,880 [trainer.py] => w_noise: 0.001
2025-01-09 22:29:39,880 [trainer.py] => server_ss: 32
2025-01-09 22:29:39,880 [trainer.py] => bn_loss: 1
2025-01-09 22:29:39,880 [trainer.py] => noise: 1
2025-01-09 22:29:39,880 [trainer.py] => ie_loss: 1
2025-01-09 22:29:39,880 [trainer.py] => act_loss: 0
2025-01-09 22:29:39,880 [trainer.py] => w_ie: 1.0
2025-01-09 22:29:39,880 [trainer.py] => w_act: 0.1
2025-01-09 22:29:39,880 [trainer.py] => syn_size: 32
2025-01-09 22:29:39,880 [trainer.py] => need_syn_imgs: True
2025-01-09 22:29:39,880 [trainer.py] => g_local_bs: 5
2025-01-09 22:29:39,880 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 22:29:39,880 [trainer.py] => g_local_train_steps: 5
2025-01-09 22:29:39,880 [trainer.py] => dataset_syn: cifar100
2025-01-09 22:29:39,880 [trainer.py] => com_round_gen: 10
2025-01-09 22:29:39,880 [trainer.py] => g_sigma: 0
2025-01-09 22:29:39,880 [trainer.py] => save_cls_embeds: False
2025-01-09 22:29:39,880 [trainer.py] => syn_image_path: outputs/syn_image_5
2025-01-09 22:29:39,880 [trainer.py] => save_dir: outputs
2025-01-09 22:29:39,880 [trainer.py] => n_iter: 5
2025-01-09 22:29:39,880 [trainer.py] => num_users: 1
2025-01-09 22:29:39,880 [trainer.py] => cur_size: 50
2025-01-09 22:29:39,880 [trainer.py] => local_bs: 5
2025-01-09 22:29:39,880 [trainer.py] => vpt_type: Deep
2025-01-09 22:29:39,880 [trainer.py] => prompt_token_num: 6
2025-01-09 22:29:39,880 [trainer.py] => avg_alpha: 0.8
2025-01-09 22:29:39,880 [trainer.py] => perturb_var: 1
2025-01-09 22:29:39,880 [trainer.py] => EMA_beta: 0.99
2025-01-09 22:29:39,880 [trainer.py] => anchor_lambda: 0.1
2025-01-09 22:29:39,881 [trainer.py] => kl_weight: 0.001
2025-01-09 22:29:39,881 [trainer.py] => TIP_init: zero
2025-01-09 22:29:39,881 [trainer.py] => tuned_epoch: 10
2025-01-09 22:29:39,881 [trainer.py] => fs_epoch: 0
2025-01-09 22:29:39,881 [trainer.py] => init_lr: 0.01
2025-01-09 22:29:39,881 [trainer.py] => fs_lr: 0.001
2025-01-09 22:29:39,881 [trainer.py] => batch_size: 48
2025-01-09 22:29:39,881 [trainer.py] => fs_batch_size: 16
2025-01-09 22:29:39,881 [trainer.py] => weight_decay: 0.0005
2025-01-09 22:29:39,881 [trainer.py] => min_lr: 0
2025-01-09 22:29:39,881 [trainer.py] => optimizer: sgd
2025-01-09 22:29:39,881 [trainer.py] => memory_size: 0
2025-01-09 22:29:39,881 [trainer.py] => memory_per_class: 0
2025-01-09 22:29:39,881 [trainer.py] => fixed_memory: False
2025-01-09 22:29:39,881 [trainer.py] => shuffle: False
2025-01-09 22:29:39,881 [trainer.py] => top_k: 5
2025-01-09 22:29:39,881 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 22:29:39,881 [trainer.py] => prefix: asp
2025-01-09 22:29:39,881 [trainer.py] => model_prefix: asp
2025-01-09 22:29:41,486 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 22:30:05,549 [trainer.py] => All params: 173596160
2025-01-09 22:30:05,550 [trainer.py] => Trainable params: 1998848
2025-01-09 22:30:05,550 [asp.py] => Learning on 0-5
2025-01-09 22:30:05,556 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 22:53:46,766 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 22:53:46,767 [trainer.py] => model_name: asp
2025-01-09 22:53:46,767 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 22:53:46,767 [trainer.py] => device: ['cuda']
2025-01-09 22:53:46,767 [trainer.py] => seed: 2024
2025-01-09 22:53:46,767 [trainer.py] => dataset: cifar224
2025-01-09 22:53:46,767 [trainer.py] => init_cls: 5
2025-01-09 22:53:46,767 [trainer.py] => increment: 5
2025-01-09 22:53:46,767 [trainer.py] => kshot: 5
2025-01-09 22:53:46,767 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 22:53:46,767 [trainer.py] => z_dim: 1000
2025-01-09 22:53:46,767 [trainer.py] => conv_dim: 64
2025-01-09 22:53:46,767 [trainer.py] => img_size: 224
2025-01-09 22:53:46,767 [trainer.py] => generator_lr: 0.005
2025-01-09 22:53:46,767 [trainer.py] => pi: 100
2025-01-09 22:53:46,767 [trainer.py] => w_bn: 50.0
2025-01-09 22:53:46,767 [trainer.py] => w_noise: 0.001
2025-01-09 22:53:46,767 [trainer.py] => server_ss: 32
2025-01-09 22:53:46,767 [trainer.py] => bn_loss: 1
2025-01-09 22:53:46,767 [trainer.py] => noise: 1
2025-01-09 22:53:46,767 [trainer.py] => ie_loss: 1
2025-01-09 22:53:46,767 [trainer.py] => act_loss: 0
2025-01-09 22:53:46,767 [trainer.py] => w_ie: 1.0
2025-01-09 22:53:46,767 [trainer.py] => w_act: 0.1
2025-01-09 22:53:46,767 [trainer.py] => syn_size: 32
2025-01-09 22:53:46,767 [trainer.py] => need_syn_imgs: True
2025-01-09 22:53:46,767 [trainer.py] => g_local_bs: 5
2025-01-09 22:53:46,767 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 22:53:46,767 [trainer.py] => g_local_train_steps: 5
2025-01-09 22:53:46,767 [trainer.py] => dataset_syn: cifar100
2025-01-09 22:53:46,767 [trainer.py] => com_round_gen: 10
2025-01-09 22:53:46,767 [trainer.py] => g_sigma: 0
2025-01-09 22:53:46,768 [trainer.py] => save_cls_embeds: False
2025-01-09 22:53:46,768 [trainer.py] => syn_image_path: outputs/syn_image_5
2025-01-09 22:53:46,768 [trainer.py] => save_dir: outputs
2025-01-09 22:53:46,768 [trainer.py] => n_iter: 5
2025-01-09 22:53:46,768 [trainer.py] => num_users: 1
2025-01-09 22:53:46,768 [trainer.py] => cur_size: 50
2025-01-09 22:53:46,768 [trainer.py] => local_bs: 5
2025-01-09 22:53:46,768 [trainer.py] => vpt_type: Deep
2025-01-09 22:53:46,768 [trainer.py] => prompt_token_num: 6
2025-01-09 22:53:46,768 [trainer.py] => avg_alpha: 0.8
2025-01-09 22:53:46,768 [trainer.py] => perturb_var: 1
2025-01-09 22:53:46,768 [trainer.py] => EMA_beta: 0.99
2025-01-09 22:53:46,768 [trainer.py] => anchor_lambda: 0.1
2025-01-09 22:53:46,768 [trainer.py] => kl_weight: 0.001
2025-01-09 22:53:46,768 [trainer.py] => TIP_init: zero
2025-01-09 22:53:46,768 [trainer.py] => tuned_epoch: 10
2025-01-09 22:53:46,768 [trainer.py] => fs_epoch: 0
2025-01-09 22:53:46,768 [trainer.py] => init_lr: 0.01
2025-01-09 22:53:46,768 [trainer.py] => fs_lr: 0.001
2025-01-09 22:53:46,768 [trainer.py] => batch_size: 48
2025-01-09 22:53:46,768 [trainer.py] => fs_batch_size: 16
2025-01-09 22:53:46,768 [trainer.py] => weight_decay: 0.0005
2025-01-09 22:53:46,768 [trainer.py] => min_lr: 0
2025-01-09 22:53:46,768 [trainer.py] => optimizer: sgd
2025-01-09 22:53:46,768 [trainer.py] => memory_size: 0
2025-01-09 22:53:46,768 [trainer.py] => memory_per_class: 0
2025-01-09 22:53:46,768 [trainer.py] => fixed_memory: False
2025-01-09 22:53:46,768 [trainer.py] => shuffle: False
2025-01-09 22:53:46,768 [trainer.py] => top_k: 5
2025-01-09 22:53:46,768 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 22:53:46,768 [trainer.py] => prefix: asp
2025-01-09 22:53:46,768 [trainer.py] => model_prefix: asp
2025-01-09 22:53:48,401 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 22:54:13,436 [trainer.py] => All params: 173596160
2025-01-09 22:54:13,437 [trainer.py] => Trainable params: 1998848
2025-01-09 22:54:13,438 [asp.py] => Learning on 0-5
2025-01-09 22:54:13,443 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 23:10:57,903 [asp.py] => total parameters: 173600001
2025-01-09 23:10:57,904 [asp.py] => trainable parameters: 2002689
2025-01-09 23:12:07,911 [asp.py] => Task 0, Epoch 1 => Loss 1.589, Train_accy 61.64, Test_curr_accy 98.00, Test_accy 98.00
2025-01-09 23:13:17,356 [asp.py] => Task 0, Epoch 2 => Loss 0.629, Train_accy 90.18, Test_curr_accy 98.00, Test_accy 98.00
2025-01-09 23:14:27,301 [asp.py] => Task 0, Epoch 3 => Loss 0.504, Train_accy 91.82, Test_curr_accy 97.80, Test_accy 97.80
2025-01-09 23:15:36,637 [asp.py] => Task 0, Epoch 4 => Loss 0.451, Train_accy 92.11, Test_curr_accy 98.00, Test_accy 98.00
2025-01-09 23:16:45,350 [asp.py] => Task 0, Epoch 5 => Loss 0.416, Train_accy 93.09, Test_curr_accy 99.00, Test_accy 99.00
2025-01-09 23:17:54,740 [asp.py] => Task 0, Epoch 6 => Loss 0.339, Train_accy 93.67, Test_curr_accy 98.80, Test_accy 98.80
2025-01-09 23:19:38,608 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-09 23:19:38,608 [trainer.py] => model_name: asp
2025-01-09 23:19:38,608 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-09 23:19:38,608 [trainer.py] => device: ['cuda']
2025-01-09 23:19:38,608 [trainer.py] => seed: 2024
2025-01-09 23:19:38,608 [trainer.py] => dataset: cifar224
2025-01-09 23:19:38,608 [trainer.py] => init_cls: 5
2025-01-09 23:19:38,608 [trainer.py] => increment: 5
2025-01-09 23:19:38,608 [trainer.py] => kshot: 5
2025-01-09 23:19:38,608 [trainer.py] => generator_model: CIFAR_GEN
2025-01-09 23:19:38,608 [trainer.py] => z_dim: 1000
2025-01-09 23:19:38,608 [trainer.py] => conv_dim: 64
2025-01-09 23:19:38,608 [trainer.py] => img_size: 224
2025-01-09 23:19:38,609 [trainer.py] => generator_lr: 0.005
2025-01-09 23:19:38,609 [trainer.py] => pi: 100
2025-01-09 23:19:38,609 [trainer.py] => w_bn: 50.0
2025-01-09 23:19:38,609 [trainer.py] => w_noise: 0.001
2025-01-09 23:19:38,609 [trainer.py] => server_ss: 32
2025-01-09 23:19:38,609 [trainer.py] => bn_loss: 1
2025-01-09 23:19:38,609 [trainer.py] => noise: 1
2025-01-09 23:19:38,609 [trainer.py] => ie_loss: 1
2025-01-09 23:19:38,609 [trainer.py] => act_loss: 0
2025-01-09 23:19:38,609 [trainer.py] => w_ie: 1.0
2025-01-09 23:19:38,609 [trainer.py] => w_act: 0.1
2025-01-09 23:19:38,609 [trainer.py] => syn_size: 32
2025-01-09 23:19:38,609 [trainer.py] => need_syn_imgs: True
2025-01-09 23:19:38,609 [trainer.py] => g_local_bs: 5
2025-01-09 23:19:38,609 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-09 23:19:38,609 [trainer.py] => g_local_train_steps: 5
2025-01-09 23:19:38,609 [trainer.py] => dataset_syn: cifar100
2025-01-09 23:19:38,609 [trainer.py] => com_round_gen: 10
2025-01-09 23:19:38,609 [trainer.py] => g_sigma: 0
2025-01-09 23:19:38,609 [trainer.py] => save_cls_embeds: False
2025-01-09 23:19:38,609 [trainer.py] => syn_image_path: outputs/syn_image_5
2025-01-09 23:19:38,609 [trainer.py] => save_dir: outputs
2025-01-09 23:19:38,609 [trainer.py] => n_iter: 5
2025-01-09 23:19:38,609 [trainer.py] => num_users: 1
2025-01-09 23:19:38,609 [trainer.py] => cur_size: 50
2025-01-09 23:19:38,609 [trainer.py] => local_bs: 5
2025-01-09 23:19:38,609 [trainer.py] => vpt_type: Deep
2025-01-09 23:19:38,609 [trainer.py] => prompt_token_num: 6
2025-01-09 23:19:38,610 [trainer.py] => avg_alpha: 0.8
2025-01-09 23:19:38,610 [trainer.py] => perturb_var: 1
2025-01-09 23:19:38,610 [trainer.py] => EMA_beta: 0.99
2025-01-09 23:19:38,610 [trainer.py] => anchor_lambda: 0.1
2025-01-09 23:19:38,610 [trainer.py] => kl_weight: 0.001
2025-01-09 23:19:38,610 [trainer.py] => TIP_init: zero
2025-01-09 23:19:38,610 [trainer.py] => tuned_epoch: 10
2025-01-09 23:19:38,610 [trainer.py] => fs_epoch: 0
2025-01-09 23:19:38,610 [trainer.py] => init_lr: 0.01
2025-01-09 23:19:38,610 [trainer.py] => fs_lr: 0.001
2025-01-09 23:19:38,610 [trainer.py] => batch_size: 48
2025-01-09 23:19:38,610 [trainer.py] => fs_batch_size: 16
2025-01-09 23:19:38,610 [trainer.py] => weight_decay: 0.0005
2025-01-09 23:19:38,610 [trainer.py] => min_lr: 0
2025-01-09 23:19:38,610 [trainer.py] => optimizer: sgd
2025-01-09 23:19:38,610 [trainer.py] => memory_size: 0
2025-01-09 23:19:38,610 [trainer.py] => memory_per_class: 0
2025-01-09 23:19:38,610 [trainer.py] => fixed_memory: False
2025-01-09 23:19:38,610 [trainer.py] => shuffle: False
2025-01-09 23:19:38,610 [trainer.py] => top_k: 5
2025-01-09 23:19:38,610 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-09 23:19:38,610 [trainer.py] => prefix: asp
2025-01-09 23:19:38,610 [trainer.py] => model_prefix: asp
2025-01-09 23:19:40,234 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-09 23:20:03,615 [trainer.py] => All params: 173596160
2025-01-09 23:20:03,616 [trainer.py] => Trainable params: 1998848
2025-01-09 23:20:03,616 [asp.py] => Learning on 0-5
2025-01-09 23:20:03,622 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-09 23:36:48,089 [asp.py] => total parameters: 173600001
2025-01-09 23:36:48,090 [asp.py] => trainable parameters: 2002689
2025-01-09 23:37:57,982 [asp.py] => Task 0, Epoch 1 => Loss 1.624, Train_accy 60.07, Test_curr_accy 97.80, Test_accy 97.80
2025-01-09 23:39:06,108 [asp.py] => Task 0, Epoch 2 => Loss 0.655, Train_accy 88.95, Test_curr_accy 99.40, Test_accy 99.40
2025-01-09 23:40:14,196 [asp.py] => Task 0, Epoch 3 => Loss 0.541, Train_accy 91.16, Test_curr_accy 97.80, Test_accy 97.80
2025-01-09 23:41:22,423 [asp.py] => Task 0, Epoch 4 => Loss 0.496, Train_accy 91.71, Test_curr_accy 94.80, Test_accy 94.80
2025-01-09 23:42:30,804 [asp.py] => Task 0, Epoch 5 => Loss 0.386, Train_accy 92.98, Test_curr_accy 99.00, Test_accy 99.00
2025-01-09 23:43:39,965 [asp.py] => Task 0, Epoch 6 => Loss 0.348, Train_accy 93.42, Test_curr_accy 98.40, Test_accy 98.40
2025-01-09 23:44:48,018 [asp.py] => Task 0, Epoch 7 => Loss 0.276, Train_accy 94.62, Test_curr_accy 98.80, Test_accy 98.80
2025-01-09 23:45:56,572 [asp.py] => Task 0, Epoch 8 => Loss 0.273, Train_accy 94.18, Test_curr_accy 99.40, Test_accy 99.40
2025-01-09 23:47:04,839 [asp.py] => Task 0, Epoch 9 => Loss 0.241, Train_accy 94.47, Test_curr_accy 97.80, Test_accy 97.80
2025-01-09 23:48:13,398 [asp.py] => Task 0, Epoch 10 => Loss 0.216, Train_accy 95.60, Test_curr_accy 99.20, Test_accy 99.20
2025-01-09 23:48:39,619 [trainer.py] => Top1 curve: [96.8]
2025-01-09 23:48:39,620 [trainer.py] => Average Accuracy (Top1): 96.8   (Harmonic Accuracy): None (Old Acc): 96.8 (New Acc): [] 

2025-01-09 23:48:39,621 [trainer.py] => All params: 173600001
2025-01-09 23:48:39,621 [trainer.py] => Trainable params: 2002689
2025-01-09 23:48:39,623 [asp.py] => Learning on 5-10
2025-01-09 23:48:39,634 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 12:05:18,823 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 12:05:18,823 [trainer.py] => model_name: asp
2025-01-10 12:05:18,823 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 12:05:18,823 [trainer.py] => device: ['cuda']
2025-01-10 12:05:18,823 [trainer.py] => seed: 2024
2025-01-10 12:05:18,823 [trainer.py] => dataset: cifar224
2025-01-10 12:05:18,823 [trainer.py] => init_cls: 5
2025-01-10 12:05:18,824 [trainer.py] => increment: 5
2025-01-10 12:05:18,825 [trainer.py] => kshot: 5
2025-01-10 12:05:18,825 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 12:05:18,825 [trainer.py] => z_dim: 1000
2025-01-10 12:05:18,825 [trainer.py] => conv_dim: 64
2025-01-10 12:05:18,825 [trainer.py] => img_size: 224
2025-01-10 12:05:18,825 [trainer.py] => generator_lr: 0.005
2025-01-10 12:05:18,825 [trainer.py] => pi: 100
2025-01-10 12:05:18,825 [trainer.py] => w_bn: 50.0
2025-01-10 12:05:18,825 [trainer.py] => w_noise: 0.001
2025-01-10 12:05:18,825 [trainer.py] => server_ss: 32
2025-01-10 12:05:18,825 [trainer.py] => bn_loss: 1
2025-01-10 12:05:18,825 [trainer.py] => noise: 1
2025-01-10 12:05:18,825 [trainer.py] => ie_loss: 1
2025-01-10 12:05:18,825 [trainer.py] => act_loss: 0
2025-01-10 12:05:18,826 [trainer.py] => w_ie: 1.0
2025-01-10 12:05:18,826 [trainer.py] => w_act: 0.1
2025-01-10 12:05:18,826 [trainer.py] => syn_size: 32
2025-01-10 12:05:18,826 [trainer.py] => need_syn_imgs: True
2025-01-10 12:05:18,826 [trainer.py] => g_local_bs: 5
2025-01-10 12:05:18,826 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 12:05:18,826 [trainer.py] => g_local_train_steps: 5
2025-01-10 12:05:18,826 [trainer.py] => dataset_syn: cifar100
2025-01-10 12:05:18,826 [trainer.py] => com_round_gen: 10
2025-01-10 12:05:18,826 [trainer.py] => g_sigma: 0
2025-01-10 12:05:18,826 [trainer.py] => save_cls_embeds: False
2025-01-10 12:05:18,826 [trainer.py] => syn_image_path: outputs/syn_image_5
2025-01-10 12:05:18,826 [trainer.py] => save_dir: outputs
2025-01-10 12:05:18,826 [trainer.py] => n_iter: 5
2025-01-10 12:05:18,826 [trainer.py] => num_users: 1
2025-01-10 12:05:18,826 [trainer.py] => cur_size: 50
2025-01-10 12:05:18,826 [trainer.py] => local_bs: 5
2025-01-10 12:05:18,826 [trainer.py] => pre_size: 48
2025-01-10 12:05:18,826 [trainer.py] => vpt_type: Deep
2025-01-10 12:05:18,826 [trainer.py] => prompt_token_num: 6
2025-01-10 12:05:18,826 [trainer.py] => avg_alpha: 0.8
2025-01-10 12:05:18,826 [trainer.py] => perturb_var: 1
2025-01-10 12:05:18,826 [trainer.py] => EMA_beta: 0.99
2025-01-10 12:05:18,826 [trainer.py] => anchor_lambda: 0.1
2025-01-10 12:05:18,826 [trainer.py] => kl_weight: 0.001
2025-01-10 12:05:18,826 [trainer.py] => TIP_init: zero
2025-01-10 12:05:18,826 [trainer.py] => tuned_epoch: 10
2025-01-10 12:05:18,826 [trainer.py] => fs_epoch: 0
2025-01-10 12:05:18,826 [trainer.py] => init_lr: 0.01
2025-01-10 12:05:18,826 [trainer.py] => fs_lr: 0.001
2025-01-10 12:05:18,826 [trainer.py] => batch_size: 48
2025-01-10 12:05:18,827 [trainer.py] => fs_batch_size: 16
2025-01-10 12:05:18,827 [trainer.py] => weight_decay: 0.0005
2025-01-10 12:05:18,827 [trainer.py] => min_lr: 0
2025-01-10 12:05:18,827 [trainer.py] => optimizer: sgd
2025-01-10 12:05:18,827 [trainer.py] => memory_size: 0
2025-01-10 12:05:18,827 [trainer.py] => memory_per_class: 0
2025-01-10 12:05:18,827 [trainer.py] => fixed_memory: False
2025-01-10 12:05:18,827 [trainer.py] => shuffle: False
2025-01-10 12:05:18,827 [trainer.py] => top_k: 5
2025-01-10 12:05:18,827 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 12:05:18,827 [trainer.py] => prefix: asp
2025-01-10 12:05:18,827 [trainer.py] => model_prefix: asp
2025-01-10 12:05:20,430 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 12:06:23,641 [trainer.py] => All params: 173596160
2025-01-10 12:06:23,642 [trainer.py] => Trainable params: 1998848
2025-01-10 12:06:23,642 [asp.py] => Learning on 0-5
2025-01-10 12:06:23,647 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 12:23:11,051 [asp.py] => total parameters: 173600001
2025-01-10 12:23:11,051 [asp.py] => trainable parameters: 2002689
2025-01-10 12:24:22,033 [asp.py] => Task 0, Epoch 1 => Loss 1.622, Train_accy 59.93, Test_curr_accy 98.00, Test_accy 98.00
2025-01-10 12:25:31,934 [asp.py] => Task 0, Epoch 2 => Loss 0.788, Train_accy 89.31, Test_curr_accy 95.20, Test_accy 95.20
2025-01-10 12:26:43,097 [asp.py] => Task 0, Epoch 3 => Loss 0.625, Train_accy 91.35, Test_curr_accy 97.80, Test_accy 97.80
2025-01-10 12:27:53,554 [asp.py] => Task 0, Epoch 4 => Loss 0.464, Train_accy 92.51, Test_curr_accy 98.80, Test_accy 98.80
2025-01-10 12:29:03,952 [asp.py] => Task 0, Epoch 5 => Loss 0.394, Train_accy 92.91, Test_curr_accy 98.40, Test_accy 98.40
2025-01-10 12:30:14,336 [asp.py] => Task 0, Epoch 6 => Loss 0.341, Train_accy 93.42, Test_curr_accy 98.40, Test_accy 98.40
2025-01-10 12:31:24,808 [asp.py] => Task 0, Epoch 7 => Loss 0.281, Train_accy 94.73, Test_curr_accy 98.60, Test_accy 98.60
2025-01-10 12:32:34,436 [asp.py] => Task 0, Epoch 8 => Loss 0.268, Train_accy 94.36, Test_curr_accy 97.20, Test_accy 97.20
2025-01-10 12:33:44,414 [asp.py] => Task 0, Epoch 9 => Loss 0.238, Train_accy 95.24, Test_curr_accy 94.40, Test_accy 94.40
2025-01-10 12:34:53,234 [asp.py] => Task 0, Epoch 10 => Loss 0.235, Train_accy 95.27, Test_curr_accy 95.20, Test_accy 95.20
2025-01-10 12:35:20,438 [trainer.py] => Top1 curve: [94.0]
2025-01-10 12:35:20,439 [trainer.py] => Average Accuracy (Top1): 94.0   (Harmonic Accuracy): None (Old Acc): 94.0 (New Acc): [] 

2025-01-10 12:35:20,439 [trainer.py] => All params: 173600001
2025-01-10 12:35:20,440 [trainer.py] => Trainable params: 2002689
2025-01-10 12:35:20,441 [asp.py] => Learning on 5-10
2025-01-10 12:35:20,450 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 12:44:09,453 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 12:44:09,453 [trainer.py] => model_name: asp
2025-01-10 12:44:09,453 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 12:44:09,453 [trainer.py] => device: ['cuda']
2025-01-10 12:44:09,453 [trainer.py] => seed: 2024
2025-01-10 12:44:09,453 [trainer.py] => dataset: cifar224
2025-01-10 12:44:09,453 [trainer.py] => init_cls: 5
2025-01-10 12:44:09,453 [trainer.py] => increment: 5
2025-01-10 12:44:09,453 [trainer.py] => kshot: 5
2025-01-10 12:44:09,453 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 12:44:09,453 [trainer.py] => z_dim: 1000
2025-01-10 12:44:09,453 [trainer.py] => conv_dim: 64
2025-01-10 12:44:09,453 [trainer.py] => img_size: 224
2025-01-10 12:44:09,453 [trainer.py] => generator_lr: 0.005
2025-01-10 12:44:09,453 [trainer.py] => pi: 100
2025-01-10 12:44:09,453 [trainer.py] => w_bn: 50.0
2025-01-10 12:44:09,453 [trainer.py] => w_noise: 0.001
2025-01-10 12:44:09,453 [trainer.py] => server_ss: 32
2025-01-10 12:44:09,453 [trainer.py] => bn_loss: 1
2025-01-10 12:44:09,453 [trainer.py] => noise: 1
2025-01-10 12:44:09,454 [trainer.py] => ie_loss: 1
2025-01-10 12:44:09,454 [trainer.py] => act_loss: 0
2025-01-10 12:44:09,454 [trainer.py] => w_ie: 1.0
2025-01-10 12:44:09,454 [trainer.py] => w_act: 0.1
2025-01-10 12:44:09,454 [trainer.py] => syn_size: 32
2025-01-10 12:44:09,454 [trainer.py] => need_syn_imgs: True
2025-01-10 12:44:09,454 [trainer.py] => g_local_bs: 5
2025-01-10 12:44:09,454 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 12:44:09,454 [trainer.py] => g_local_train_steps: 5
2025-01-10 12:44:09,454 [trainer.py] => dataset_syn: cifar100
2025-01-10 12:44:09,454 [trainer.py] => com_round_gen: 10
2025-01-10 12:44:09,454 [trainer.py] => g_sigma: 0
2025-01-10 12:44:09,454 [trainer.py] => save_cls_embeds: False
2025-01-10 12:44:09,454 [trainer.py] => syn_image_path: outputs/syn_image_5
2025-01-10 12:44:09,454 [trainer.py] => save_dir: outputs
2025-01-10 12:44:09,454 [trainer.py] => n_iter: 5
2025-01-10 12:44:09,454 [trainer.py] => num_users: 1
2025-01-10 12:44:09,454 [trainer.py] => cur_size: 50
2025-01-10 12:44:09,454 [trainer.py] => local_bs: 5
2025-01-10 12:44:09,454 [trainer.py] => pre_size: 48
2025-01-10 12:44:09,454 [trainer.py] => vpt_type: Deep
2025-01-10 12:44:09,454 [trainer.py] => prompt_token_num: 6
2025-01-10 12:44:09,454 [trainer.py] => avg_alpha: 0.8
2025-01-10 12:44:09,454 [trainer.py] => perturb_var: 1
2025-01-10 12:44:09,454 [trainer.py] => EMA_beta: 0.99
2025-01-10 12:44:09,454 [trainer.py] => anchor_lambda: 0.1
2025-01-10 12:44:09,454 [trainer.py] => kl_weight: 0.001
2025-01-10 12:44:09,454 [trainer.py] => TIP_init: zero
2025-01-10 12:44:09,454 [trainer.py] => tuned_epoch: 10
2025-01-10 12:44:09,454 [trainer.py] => fs_epoch: 0
2025-01-10 12:44:09,454 [trainer.py] => init_lr: 0.01
2025-01-10 12:44:09,454 [trainer.py] => fs_lr: 0.001
2025-01-10 12:44:09,455 [trainer.py] => batch_size: 48
2025-01-10 12:44:09,455 [trainer.py] => fs_batch_size: 16
2025-01-10 12:44:09,455 [trainer.py] => weight_decay: 0.0005
2025-01-10 12:44:09,455 [trainer.py] => min_lr: 0
2025-01-10 12:44:09,455 [trainer.py] => optimizer: sgd
2025-01-10 12:44:09,455 [trainer.py] => memory_size: 0
2025-01-10 12:44:09,455 [trainer.py] => memory_per_class: 0
2025-01-10 12:44:09,455 [trainer.py] => fixed_memory: False
2025-01-10 12:44:09,455 [trainer.py] => shuffle: False
2025-01-10 12:44:09,455 [trainer.py] => top_k: 5
2025-01-10 12:44:09,455 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 12:44:09,455 [trainer.py] => prefix: asp
2025-01-10 12:44:09,455 [trainer.py] => model_prefix: asp
2025-01-10 12:44:11,615 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 12:52:48,984 [asp.py] => total parameters: 173603841
2025-01-10 12:52:48,985 [asp.py] => trainable parameters: 2006529
2025-01-10 12:52:55,673 [trainer.py] => Top1 curve: [94.0, 90.5]
2025-01-10 12:52:55,673 [trainer.py] => Average Accuracy (Top1): 92.25   (Harmonic Accuracy): 90.3796685082873 (Old Acc): 93.8 (New Acc): 87.2 

2025-01-10 12:52:55,674 [trainer.py] => All params: 173603841
2025-01-10 12:52:55,675 [trainer.py] => Trainable params: 2006529
2025-01-10 12:52:55,677 [asp.py] => Learning on 10-15
2025-01-10 12:52:55,688 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 12:55:32,438 [trainer.py] => All params: 173596160
2025-01-10 12:55:32,439 [trainer.py] => Trainable params: 1998848
2025-01-10 12:55:32,439 [asp.py] => Learning on 0-5
2025-01-10 12:55:32,449 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 13:10:08,159 [asp.py] => total parameters: 173607681
2025-01-10 13:10:08,161 [asp.py] => trainable parameters: 2010369
2025-01-10 13:10:17,064 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2]
2025-01-10 13:10:17,064 [trainer.py] => Average Accuracy (Top1): 88.23333333333333   (Harmonic Accuracy): 82.18916967509026 (Old Acc): 91.8 (New Acc): 74.4 

2025-01-10 13:10:17,065 [trainer.py] => All params: 173607681
2025-01-10 13:10:17,066 [trainer.py] => Trainable params: 2010369
2025-01-10 13:10:17,067 [asp.py] => Learning on 15-20
2025-01-10 13:10:17,075 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 13:27:05,052 [asp.py] => total parameters: 173611521
2025-01-10 13:27:05,054 [asp.py] => trainable parameters: 2014209
2025-01-10 13:27:16,711 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7]
2025-01-10 13:27:16,711 [trainer.py] => Average Accuracy (Top1): 85.1   (Harmonic Accuracy): 79.61283950617282 (Old Acc): 91.6 (New Acc): 70.39999999999999 

2025-01-10 13:27:16,712 [trainer.py] => All params: 173611521
2025-01-10 13:27:16,712 [trainer.py] => Trainable params: 2014209
2025-01-10 13:27:16,714 [asp.py] => Learning on 20-25
2025-01-10 13:27:16,731 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 13:44:09,748 [asp.py] => total parameters: 173615361
2025-01-10 13:44:09,749 [asp.py] => trainable parameters: 2018049
2025-01-10 13:44:23,737 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84]
2025-01-10 13:44:23,737 [trainer.py] => Average Accuracy (Top1): 83.048   (Harmonic Accuracy): 79.63906056860321 (Old Acc): 91.0 (New Acc): 70.8 

2025-01-10 13:44:23,738 [trainer.py] => All params: 173615361
2025-01-10 13:44:23,739 [trainer.py] => Trainable params: 2018049
2025-01-10 13:44:23,740 [asp.py] => Learning on 25-30
2025-01-10 13:44:23,757 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 14:01:14,122 [asp.py] => total parameters: 173619201
2025-01-10 14:01:14,123 [asp.py] => trainable parameters: 2021889
2025-01-10 14:01:30,612 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4]
2025-01-10 14:01:30,613 [trainer.py] => Average Accuracy (Top1): 81.10666666666667   (Harmonic Accuracy): 77.2124936515998 (Old Acc): 89.8 (New Acc): 67.72 

2025-01-10 14:01:30,613 [trainer.py] => All params: 173619201
2025-01-10 14:01:30,614 [trainer.py] => Trainable params: 2021889
2025-01-10 14:01:30,615 [asp.py] => Learning on 30-35
2025-01-10 14:01:30,637 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 14:18:13,039 [asp.py] => total parameters: 173623041
2025-01-10 14:18:13,039 [asp.py] => trainable parameters: 2025729
2025-01-10 14:18:31,979 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71]
2025-01-10 14:18:31,979 [trainer.py] => Average Accuracy (Top1): 79.47857142857143   (Harmonic Accuracy): 76.2748717948718 (Old Acc): 89.6 (New Acc): 66.4 

2025-01-10 14:18:31,980 [trainer.py] => All params: 173623041
2025-01-10 14:18:31,981 [trainer.py] => Trainable params: 2025729
2025-01-10 14:18:31,982 [asp.py] => Learning on 35-40
2025-01-10 14:18:31,995 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 14:35:24,252 [asp.py] => total parameters: 173626881
2025-01-10 14:35:24,252 [asp.py] => trainable parameters: 2029569
2025-01-10 14:35:45,389 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62]
2025-01-10 14:35:45,389 [trainer.py] => Average Accuracy (Top1): 78.12125   (Harmonic Accuracy): 75.2254606365159 (Old Acc): 87.6 (New Acc): 65.91428571428571 

2025-01-10 14:35:45,390 [trainer.py] => All params: 173626881
2025-01-10 14:35:45,390 [trainer.py] => Trainable params: 2029569
2025-01-10 14:35:45,391 [asp.py] => Learning on 40-45
2025-01-10 14:35:45,416 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 14:52:31,040 [asp.py] => total parameters: 173630721
2025-01-10 14:52:31,041 [asp.py] => trainable parameters: 2033409
2025-01-10 14:52:54,993 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18]
2025-01-10 14:52:54,993 [trainer.py] => Average Accuracy (Top1): 77.01666666666668   (Harmonic Accuracy): 75.00339869281046 (Old Acc): 87.2 (New Acc): 65.8 

2025-01-10 14:52:54,994 [trainer.py] => All params: 173630721
2025-01-10 14:52:54,995 [trainer.py] => Trainable params: 2033409
2025-01-10 14:52:54,996 [asp.py] => Learning on 45-50
2025-01-10 14:52:55,024 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 15:09:48,881 [asp.py] => total parameters: 173634561
2025-01-10 15:09:48,882 [asp.py] => trainable parameters: 2037249
2025-01-10 15:10:15,276 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18, 64.72]
2025-01-10 15:10:15,276 [trainer.py] => Average Accuracy (Top1): 75.787   (Harmonic Accuracy): 72.62343842950625 (Old Acc): 87.2 (New Acc): 62.22222222222222 

2025-01-10 15:10:15,277 [trainer.py] => All params: 173634561
2025-01-10 15:10:15,278 [trainer.py] => Trainable params: 2037249
2025-01-10 15:10:15,279 [asp.py] => Learning on 50-55
2025-01-10 15:10:15,289 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 15:27:00,445 [asp.py] => total parameters: 173638401
2025-01-10 15:27:00,446 [asp.py] => trainable parameters: 2041089
2025-01-10 15:27:28,539 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18, 64.72, 65.07]
2025-01-10 15:27:28,539 [trainer.py] => Average Accuracy (Top1): 74.81272727272727   (Harmonic Accuracy): 72.82732020891925 (Old Acc): 86.4 (New Acc): 62.94 

2025-01-10 15:27:28,540 [trainer.py] => All params: 173638401
2025-01-10 15:27:28,541 [trainer.py] => Trainable params: 2041089
2025-01-10 15:27:28,542 [asp.py] => Learning on 55-60
2025-01-10 15:27:28,555 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 15:33:26,998 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 15:33:26,998 [trainer.py] => model_name: asp
2025-01-10 15:33:26,998 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 15:33:26,998 [trainer.py] => device: ['cuda']
2025-01-10 15:33:26,998 [trainer.py] => seed: 2024
2025-01-10 15:33:26,998 [trainer.py] => dataset: cifar224
2025-01-10 15:33:26,998 [trainer.py] => init_cls: 5
2025-01-10 15:33:26,998 [trainer.py] => increment: 5
2025-01-10 15:33:26,998 [trainer.py] => kshot: 5
2025-01-10 15:33:26,998 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 15:33:26,998 [trainer.py] => z_dim: 1000
2025-01-10 15:33:26,999 [trainer.py] => conv_dim: 64
2025-01-10 15:33:26,999 [trainer.py] => img_size: 224
2025-01-10 15:33:26,999 [trainer.py] => generator_lr: 0.005
2025-01-10 15:33:26,999 [trainer.py] => pi: 100
2025-01-10 15:33:26,999 [trainer.py] => w_bn: 50.0
2025-01-10 15:33:26,999 [trainer.py] => w_noise: 0.001
2025-01-10 15:33:26,999 [trainer.py] => server_ss: 32
2025-01-10 15:33:26,999 [trainer.py] => bn_loss: 1
2025-01-10 15:33:26,999 [trainer.py] => noise: 1
2025-01-10 15:33:26,999 [trainer.py] => ie_loss: 1
2025-01-10 15:33:26,999 [trainer.py] => act_loss: 0
2025-01-10 15:33:26,999 [trainer.py] => w_ie: 1.0
2025-01-10 15:33:26,999 [trainer.py] => w_act: 0.1
2025-01-10 15:33:26,999 [trainer.py] => syn_size: 32
2025-01-10 15:33:26,999 [trainer.py] => need_syn_imgs: True
2025-01-10 15:33:26,999 [trainer.py] => g_local_bs: 5
2025-01-10 15:33:26,999 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 15:33:26,999 [trainer.py] => g_local_train_steps: 5
2025-01-10 15:33:26,999 [trainer.py] => dataset_syn: cifar100
2025-01-10 15:33:26,999 [trainer.py] => com_round_gen: 10
2025-01-10 15:33:26,999 [trainer.py] => g_sigma: 0
2025-01-10 15:33:26,999 [trainer.py] => save_cls_embeds: False
2025-01-10 15:33:26,999 [trainer.py] => syn_image_path: outputs/syn_image_5
2025-01-10 15:33:26,999 [trainer.py] => save_dir: outputs
2025-01-10 15:33:26,999 [trainer.py] => n_iter: 5
2025-01-10 15:33:26,999 [trainer.py] => num_users: 1
2025-01-10 15:33:26,999 [trainer.py] => cur_size: 50
2025-01-10 15:33:26,999 [trainer.py] => local_bs: 5
2025-01-10 15:33:26,999 [trainer.py] => pre_size: 48
2025-01-10 15:33:27,000 [trainer.py] => w_ce_pre: 0.5
2025-01-10 15:33:27,000 [trainer.py] => vpt_type: Deep
2025-01-10 15:33:27,000 [trainer.py] => prompt_token_num: 6
2025-01-10 15:33:27,000 [trainer.py] => avg_alpha: 0.8
2025-01-10 15:33:27,000 [trainer.py] => perturb_var: 1
2025-01-10 15:33:27,000 [trainer.py] => EMA_beta: 0.99
2025-01-10 15:33:27,000 [trainer.py] => anchor_lambda: 0.1
2025-01-10 15:33:27,000 [trainer.py] => kl_weight: 0.001
2025-01-10 15:33:27,000 [trainer.py] => TIP_init: zero
2025-01-10 15:33:27,000 [trainer.py] => tuned_epoch: 10
2025-01-10 15:33:27,000 [trainer.py] => fs_epoch: 0
2025-01-10 15:33:27,000 [trainer.py] => init_lr: 0.01
2025-01-10 15:33:27,000 [trainer.py] => fs_lr: 0.001
2025-01-10 15:33:27,000 [trainer.py] => batch_size: 48
2025-01-10 15:33:27,000 [trainer.py] => fs_batch_size: 16
2025-01-10 15:33:27,000 [trainer.py] => weight_decay: 0.0005
2025-01-10 15:33:27,000 [trainer.py] => min_lr: 0
2025-01-10 15:33:27,000 [trainer.py] => optimizer: sgd
2025-01-10 15:33:27,000 [trainer.py] => memory_size: 0
2025-01-10 15:33:27,000 [trainer.py] => memory_per_class: 0
2025-01-10 15:33:27,000 [trainer.py] => fixed_memory: False
2025-01-10 15:33:27,000 [trainer.py] => shuffle: False
2025-01-10 15:33:27,000 [trainer.py] => top_k: 5
2025-01-10 15:33:27,000 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 15:33:27,000 [trainer.py] => prefix: asp
2025-01-10 15:33:27,000 [trainer.py] => model_prefix: asp
2025-01-10 15:33:28,669 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 15:33:51,238 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 15:33:51,238 [trainer.py] => model_name: asp
2025-01-10 15:33:51,238 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 15:33:51,238 [trainer.py] => device: ['cuda']
2025-01-10 15:33:51,238 [trainer.py] => seed: 2024
2025-01-10 15:33:51,238 [trainer.py] => dataset: cifar224
2025-01-10 15:33:51,238 [trainer.py] => init_cls: 5
2025-01-10 15:33:51,238 [trainer.py] => increment: 5
2025-01-10 15:33:51,238 [trainer.py] => kshot: 5
2025-01-10 15:33:51,238 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 15:33:51,238 [trainer.py] => z_dim: 1000
2025-01-10 15:33:51,238 [trainer.py] => conv_dim: 64
2025-01-10 15:33:51,238 [trainer.py] => img_size: 224
2025-01-10 15:33:51,238 [trainer.py] => generator_lr: 0.005
2025-01-10 15:33:51,238 [trainer.py] => pi: 100
2025-01-10 15:33:51,238 [trainer.py] => w_bn: 50.0
2025-01-10 15:33:51,238 [trainer.py] => w_noise: 0.001
2025-01-10 15:33:51,238 [trainer.py] => server_ss: 32
2025-01-10 15:33:51,238 [trainer.py] => bn_loss: 1
2025-01-10 15:33:51,238 [trainer.py] => noise: 1
2025-01-10 15:33:51,239 [trainer.py] => ie_loss: 1
2025-01-10 15:33:51,239 [trainer.py] => act_loss: 0
2025-01-10 15:33:51,239 [trainer.py] => w_ie: 1.0
2025-01-10 15:33:51,239 [trainer.py] => w_act: 0.1
2025-01-10 15:33:51,239 [trainer.py] => syn_size: 32
2025-01-10 15:33:51,239 [trainer.py] => need_syn_imgs: True
2025-01-10 15:33:51,239 [trainer.py] => g_local_bs: 5
2025-01-10 15:33:51,239 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 15:33:51,239 [trainer.py] => g_local_train_steps: 5
2025-01-10 15:33:51,239 [trainer.py] => dataset_syn: cifar100
2025-01-10 15:33:51,239 [trainer.py] => com_round_gen: 10
2025-01-10 15:33:51,239 [trainer.py] => g_sigma: 0
2025-01-10 15:33:51,239 [trainer.py] => save_cls_embeds: False
2025-01-10 15:33:51,239 [trainer.py] => syn_image_path: outputs/syn_image_5_pre
2025-01-10 15:33:51,239 [trainer.py] => save_dir: outputs
2025-01-10 15:33:51,239 [trainer.py] => n_iter: 5
2025-01-10 15:33:51,239 [trainer.py] => num_users: 1
2025-01-10 15:33:51,239 [trainer.py] => cur_size: 50
2025-01-10 15:33:51,239 [trainer.py] => local_bs: 5
2025-01-10 15:33:51,239 [trainer.py] => pre_size: 48
2025-01-10 15:33:51,239 [trainer.py] => w_ce_pre: 0.5
2025-01-10 15:33:51,239 [trainer.py] => vpt_type: Deep
2025-01-10 15:33:51,239 [trainer.py] => prompt_token_num: 6
2025-01-10 15:33:51,239 [trainer.py] => avg_alpha: 0.8
2025-01-10 15:33:51,239 [trainer.py] => perturb_var: 1
2025-01-10 15:33:51,239 [trainer.py] => EMA_beta: 0.99
2025-01-10 15:33:51,239 [trainer.py] => anchor_lambda: 0.1
2025-01-10 15:33:51,239 [trainer.py] => kl_weight: 0.001
2025-01-10 15:33:51,239 [trainer.py] => TIP_init: zero
2025-01-10 15:33:51,239 [trainer.py] => tuned_epoch: 10
2025-01-10 15:33:51,240 [trainer.py] => fs_epoch: 0
2025-01-10 15:33:51,240 [trainer.py] => init_lr: 0.01
2025-01-10 15:33:51,240 [trainer.py] => fs_lr: 0.001
2025-01-10 15:33:51,240 [trainer.py] => batch_size: 48
2025-01-10 15:33:51,240 [trainer.py] => fs_batch_size: 16
2025-01-10 15:33:51,240 [trainer.py] => weight_decay: 0.0005
2025-01-10 15:33:51,240 [trainer.py] => min_lr: 0
2025-01-10 15:33:51,240 [trainer.py] => optimizer: sgd
2025-01-10 15:33:51,240 [trainer.py] => memory_size: 0
2025-01-10 15:33:51,240 [trainer.py] => memory_per_class: 0
2025-01-10 15:33:51,240 [trainer.py] => fixed_memory: False
2025-01-10 15:33:51,240 [trainer.py] => shuffle: False
2025-01-10 15:33:51,240 [trainer.py] => top_k: 5
2025-01-10 15:33:51,240 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 15:33:51,240 [trainer.py] => prefix: asp
2025-01-10 15:33:51,240 [trainer.py] => model_prefix: asp
2025-01-10 15:33:52,894 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 15:34:18,274 [trainer.py] => All params: 173596160
2025-01-10 15:34:18,275 [trainer.py] => Trainable params: 1998848
2025-01-10 15:34:18,276 [asp.py] => Learning on 0-5
2025-01-10 15:34:18,282 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 15:44:12,596 [asp.py] => total parameters: 173642241
2025-01-10 15:44:12,597 [asp.py] => trainable parameters: 2044929
2025-01-10 15:44:43,865 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18, 64.72, 65.07, 63.27]
2025-01-10 15:44:43,865 [trainer.py] => Average Accuracy (Top1): 73.85083333333334   (Harmonic Accuracy): 71.33959831391024 (Old Acc): 85.4 (New Acc): 61.25454545454545 

2025-01-10 15:44:43,866 [trainer.py] => All params: 173642241
2025-01-10 15:44:43,867 [trainer.py] => Trainable params: 2044929
2025-01-10 15:44:43,868 [asp.py] => Learning on 60-65
2025-01-10 15:44:43,881 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 15:49:47,772 [asp.py] => total parameters: 173600001
2025-01-10 15:49:47,773 [asp.py] => trainable parameters: 2002689
2025-01-10 15:50:53,591 [asp.py] => Task 0, Epoch 1 => Loss 1.595, Train_accy 61.16, Test_curr_accy 98.20, Test_accy 98.20
2025-01-10 15:51:58,296 [asp.py] => Task 0, Epoch 2 => Loss 0.679, Train_accy 89.64, Test_curr_accy 96.60, Test_accy 96.60
2025-01-10 15:53:03,404 [asp.py] => Task 0, Epoch 3 => Loss 0.475, Train_accy 92.04, Test_curr_accy 97.00, Test_accy 97.00
2025-01-10 15:54:07,570 [asp.py] => Task 0, Epoch 4 => Loss 0.485, Train_accy 92.55, Test_curr_accy 98.60, Test_accy 98.60
2025-01-10 15:55:12,474 [asp.py] => Task 0, Epoch 5 => Loss 0.401, Train_accy 92.87, Test_curr_accy 98.80, Test_accy 98.80
2025-01-10 15:56:17,073 [asp.py] => Task 0, Epoch 6 => Loss 0.345, Train_accy 93.20, Test_curr_accy 98.80, Test_accy 98.80
2025-01-10 15:57:21,558 [asp.py] => Task 0, Epoch 7 => Loss 0.290, Train_accy 94.65, Test_curr_accy 96.40, Test_accy 96.40
2025-01-10 15:58:26,120 [asp.py] => Task 0, Epoch 8 => Loss 0.264, Train_accy 94.33, Test_curr_accy 99.00, Test_accy 99.00
2025-01-10 15:59:30,735 [asp.py] => Task 0, Epoch 9 => Loss 0.243, Train_accy 95.09, Test_curr_accy 87.40, Test_accy 87.40
2025-01-10 16:00:35,131 [asp.py] => Task 0, Epoch 10 => Loss 0.235, Train_accy 95.35, Test_curr_accy 98.40, Test_accy 98.40
2025-01-10 16:01:00,796 [trainer.py] => Top1 curve: [94.0]
2025-01-10 16:01:00,796 [trainer.py] => Average Accuracy (Top1): 94.0   (Harmonic Accuracy): None (Old Acc): 94.0 (New Acc): [] 

2025-01-10 16:01:00,797 [trainer.py] => All params: 173600001
2025-01-10 16:01:00,798 [trainer.py] => Trainable params: 2002689
2025-01-10 16:01:00,799 [asp.py] => Learning on 5-10
2025-01-10 16:01:00,809 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 16:01:26,091 [asp.py] => total parameters: 173646081
2025-01-10 16:01:26,093 [asp.py] => trainable parameters: 2048769
2025-01-10 16:01:59,408 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18, 64.72, 65.07, 63.27, 61.37]
2025-01-10 16:01:59,408 [trainer.py] => Average Accuracy (Top1): 72.89076923076924   (Harmonic Accuracy): 69.64711348588686 (Old Acc): 84.0 (New Acc): 59.48333333333333 

2025-01-10 16:01:59,409 [trainer.py] => All params: 173646081
2025-01-10 16:01:59,410 [trainer.py] => Trainable params: 2048769
2025-01-10 16:01:59,411 [asp.py] => Learning on 65-70
2025-01-10 16:01:59,426 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 16:16:41,152 [asp.py] => total parameters: 173603841
2025-01-10 16:16:41,153 [asp.py] => trainable parameters: 2006529
2025-01-10 16:16:47,278 [trainer.py] => Top1 curve: [94.0, 88.5]
2025-01-10 16:16:47,278 [trainer.py] => Average Accuracy (Top1): 91.25   (Harmonic Accuracy): 88.1825988700565 (Old Acc): 93.8 (New Acc): 83.2 

2025-01-10 16:16:47,280 [trainer.py] => All params: 173603841
2025-01-10 16:16:47,280 [trainer.py] => Trainable params: 2006529
2025-01-10 16:16:47,281 [asp.py] => Learning on 10-15
2025-01-10 16:16:47,295 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 16:18:41,727 [asp.py] => total parameters: 173649921
2025-01-10 16:18:41,728 [asp.py] => trainable parameters: 2052609
2025-01-10 16:19:17,520 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18, 64.72, 65.07, 63.27, 61.37, 61.21]
2025-01-10 16:19:17,520 [trainer.py] => Average Accuracy (Top1): 72.05642857142858   (Harmonic Accuracy): 69.57388596585417 (Old Acc): 83.8 (New Acc): 59.47692307692307 

2025-01-10 16:19:17,521 [trainer.py] => All params: 173649921
2025-01-10 16:19:17,522 [trainer.py] => Trainable params: 2052609
2025-01-10 16:19:17,524 [asp.py] => Learning on 70-75
2025-01-10 16:19:17,542 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 16:32:28,488 [asp.py] => total parameters: 173607681
2025-01-10 16:32:28,489 [asp.py] => trainable parameters: 2010369
2025-01-10 16:32:36,949 [trainer.py] => Top1 curve: [94.0, 88.5, 77.47]
2025-01-10 16:32:36,949 [trainer.py] => Average Accuracy (Top1): 86.65666666666668   (Harmonic Accuracy): 79.68162261831593 (Old Acc): 93.0 (New Acc): 69.7 

2025-01-10 16:32:36,950 [trainer.py] => All params: 173607681
2025-01-10 16:32:36,951 [trainer.py] => Trainable params: 2010369
2025-01-10 16:32:36,952 [asp.py] => Learning on 15-20
2025-01-10 16:32:36,965 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 16:35:50,347 [asp.py] => total parameters: 173653761
2025-01-10 16:35:50,349 [asp.py] => trainable parameters: 2056449
2025-01-10 16:35:51,373 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 16:35:51,373 [trainer.py] => model_name: asp
2025-01-10 16:35:51,373 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 16:35:51,373 [trainer.py] => device: ['cuda']
2025-01-10 16:35:51,373 [trainer.py] => seed: 2024
2025-01-10 16:35:51,373 [trainer.py] => dataset: cifar224
2025-01-10 16:35:51,373 [trainer.py] => init_cls: 5
2025-01-10 16:35:51,373 [trainer.py] => increment: 5
2025-01-10 16:35:51,373 [trainer.py] => kshot: 5
2025-01-10 16:35:51,373 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 16:35:51,373 [trainer.py] => z_dim: 1000
2025-01-10 16:35:51,373 [trainer.py] => conv_dim: 64
2025-01-10 16:35:51,373 [trainer.py] => img_size: 224
2025-01-10 16:35:51,373 [trainer.py] => generator_lr: 0.005
2025-01-10 16:35:51,373 [trainer.py] => pi: 100
2025-01-10 16:35:51,373 [trainer.py] => w_bn: 50.0
2025-01-10 16:35:51,373 [trainer.py] => w_noise: 0.001
2025-01-10 16:35:51,374 [trainer.py] => server_ss: 32
2025-01-10 16:35:51,374 [trainer.py] => bn_loss: 1
2025-01-10 16:35:51,374 [trainer.py] => noise: 1
2025-01-10 16:35:51,374 [trainer.py] => ie_loss: 1
2025-01-10 16:35:51,374 [trainer.py] => act_loss: 0
2025-01-10 16:35:51,374 [trainer.py] => w_ie: 1.0
2025-01-10 16:35:51,374 [trainer.py] => w_act: 0.1
2025-01-10 16:35:51,374 [trainer.py] => syn_size: 32
2025-01-10 16:35:51,374 [trainer.py] => need_syn_imgs: True
2025-01-10 16:35:51,374 [trainer.py] => g_local_bs: 5
2025-01-10 16:35:51,374 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 16:35:51,374 [trainer.py] => g_local_train_steps: 5
2025-01-10 16:35:51,374 [trainer.py] => dataset_syn: cifar100
2025-01-10 16:35:51,374 [trainer.py] => com_round_gen: 10
2025-01-10 16:35:51,374 [trainer.py] => g_sigma: 0
2025-01-10 16:35:51,374 [trainer.py] => save_cls_embeds: False
2025-01-10 16:35:51,374 [trainer.py] => syn_image_path: outputs/syn_image_5_pre
2025-01-10 16:35:51,374 [trainer.py] => save_dir: outputs
2025-01-10 16:35:51,374 [trainer.py] => n_iter: 5
2025-01-10 16:35:51,374 [trainer.py] => num_users: 1
2025-01-10 16:35:51,374 [trainer.py] => cur_size: 50
2025-01-10 16:35:51,374 [trainer.py] => local_bs: 5
2025-01-10 16:35:51,374 [trainer.py] => pre_size: 48
2025-01-10 16:35:51,374 [trainer.py] => w_ce_pre: 0.5
2025-01-10 16:35:51,374 [trainer.py] => vpt_type: Deep
2025-01-10 16:35:51,374 [trainer.py] => prompt_token_num: 6
2025-01-10 16:35:51,374 [trainer.py] => avg_alpha: 0.8
2025-01-10 16:35:51,374 [trainer.py] => perturb_var: 1
2025-01-10 16:35:51,374 [trainer.py] => EMA_beta: 0.99
2025-01-10 16:35:51,374 [trainer.py] => anchor_lambda: 0.1
2025-01-10 16:35:51,375 [trainer.py] => kl_weight: 0.001
2025-01-10 16:35:51,375 [trainer.py] => TIP_init: zero
2025-01-10 16:35:51,375 [trainer.py] => tuned_epoch: 10
2025-01-10 16:35:51,375 [trainer.py] => fs_epoch: 0
2025-01-10 16:35:51,375 [trainer.py] => init_lr: 0.01
2025-01-10 16:35:51,375 [trainer.py] => fs_lr: 0.001
2025-01-10 16:35:51,375 [trainer.py] => batch_size: 48
2025-01-10 16:35:51,375 [trainer.py] => fs_batch_size: 16
2025-01-10 16:35:51,375 [trainer.py] => weight_decay: 0.0005
2025-01-10 16:35:51,375 [trainer.py] => min_lr: 0
2025-01-10 16:35:51,375 [trainer.py] => optimizer: sgd
2025-01-10 16:35:51,375 [trainer.py] => memory_size: 0
2025-01-10 16:35:51,375 [trainer.py] => memory_per_class: 0
2025-01-10 16:35:51,375 [trainer.py] => fixed_memory: False
2025-01-10 16:35:51,375 [trainer.py] => shuffle: False
2025-01-10 16:35:51,375 [trainer.py] => top_k: 5
2025-01-10 16:35:51,375 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 16:35:51,375 [trainer.py] => prefix: asp
2025-01-10 16:35:51,375 [trainer.py] => model_prefix: asp
2025-01-10 16:35:53,042 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 16:36:18,750 [trainer.py] => All params: 173596160
2025-01-10 16:36:18,750 [trainer.py] => Trainable params: 1998848
2025-01-10 16:36:18,751 [asp.py] => Learning on 0-5
2025-01-10 16:36:18,755 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 16:36:28,812 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18, 64.72, 65.07, 63.27, 61.37, 61.21, 59.23]
2025-01-10 16:36:28,812 [trainer.py] => Average Accuracy (Top1): 71.20133333333334   (Harmonic Accuracy): 68.069552874379 (Old Acc): 83.4 (New Acc): 57.50000000000001 

2025-01-10 16:36:28,813 [trainer.py] => All params: 173653761
2025-01-10 16:36:28,814 [trainer.py] => Trainable params: 2056449
2025-01-10 16:36:28,815 [asp.py] => Learning on 75-80
2025-01-10 16:36:28,831 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 16:51:58,420 [asp.py] => total parameters: 173600001
2025-01-10 16:51:58,421 [asp.py] => trainable parameters: 2002689
2025-01-10 16:53:04,370 [asp.py] => Task 0, Epoch 1 => Loss 1.606, Train_accy 60.87, Test_curr_accy 99.00, Test_accy 99.00
2025-01-10 16:53:27,357 [asp.py] => total parameters: 173657601
2025-01-10 16:53:27,358 [asp.py] => trainable parameters: 2060289
2025-01-10 16:54:08,770 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18, 64.72, 65.07, 63.27, 61.37, 61.21, 59.23, 59.35]
2025-01-10 16:54:08,771 [trainer.py] => Average Accuracy (Top1): 70.460625   (Harmonic Accuracy): 68.18433598183881 (Old Acc): 83.2 (New Acc): 57.76 

2025-01-10 16:54:08,772 [trainer.py] => All params: 173657601
2025-01-10 16:54:08,773 [trainer.py] => Trainable params: 2060289
2025-01-10 16:54:08,774 [asp.py] => Learning on 80-85
2025-01-10 16:54:08,792 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 16:54:09,610 [asp.py] => Task 0, Epoch 2 => Loss 0.675, Train_accy 88.80, Test_curr_accy 98.20, Test_accy 98.20
2025-01-10 16:55:16,469 [asp.py] => Task 0, Epoch 3 => Loss 1.474, Train_accy 88.69, Test_curr_accy 96.00, Test_accy 96.00
2025-01-10 16:56:25,082 [asp.py] => Task 0, Epoch 4 => Loss 0.510, Train_accy 90.87, Test_curr_accy 99.60, Test_accy 99.60
2025-01-10 16:57:29,864 [asp.py] => Task 0, Epoch 5 => Loss 0.373, Train_accy 92.65, Test_curr_accy 98.80, Test_accy 98.80
2025-01-10 16:58:34,320 [asp.py] => Task 0, Epoch 6 => Loss 0.374, Train_accy 93.27, Test_curr_accy 96.20, Test_accy 96.20
2025-01-10 16:59:38,862 [asp.py] => Task 0, Epoch 7 => Loss 0.298, Train_accy 94.33, Test_curr_accy 96.60, Test_accy 96.60
2025-01-10 17:00:43,545 [asp.py] => Task 0, Epoch 8 => Loss 0.293, Train_accy 93.89, Test_curr_accy 98.40, Test_accy 98.40
2025-01-10 17:01:47,976 [asp.py] => Task 0, Epoch 9 => Loss 0.245, Train_accy 94.69, Test_curr_accy 99.20, Test_accy 99.20
2025-01-10 17:02:52,641 [asp.py] => Task 0, Epoch 10 => Loss 0.239, Train_accy 95.27, Test_curr_accy 98.00, Test_accy 98.00
2025-01-10 17:03:18,187 [trainer.py] => Top1 curve: [95.4]
2025-01-10 17:03:18,187 [trainer.py] => Average Accuracy (Top1): 95.4   (Harmonic Accuracy): None (Old Acc): 95.4 (New Acc): [] 

2025-01-10 17:03:18,188 [trainer.py] => All params: 173600001
2025-01-10 17:03:18,189 [trainer.py] => Trainable params: 2002689
2025-01-10 17:03:18,190 [asp.py] => Learning on 5-10
2025-01-10 17:03:18,201 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 17:10:51,313 [asp.py] => total parameters: 173661441
2025-01-10 17:10:51,314 [asp.py] => trainable parameters: 2064129
2025-01-10 17:11:34,475 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18, 64.72, 65.07, 63.27, 61.37, 61.21, 59.23, 59.35, 58.65]
2025-01-10 17:11:34,476 [trainer.py] => Average Accuracy (Top1): 69.76588235294118   (Harmonic Accuracy): 67.6735057983943 (Old Acc): 83.0 (New Acc): 57.12500000000001 

2025-01-10 17:11:34,477 [trainer.py] => All params: 173661441
2025-01-10 17:11:34,477 [trainer.py] => Trainable params: 2064129
2025-01-10 17:11:34,479 [asp.py] => Learning on 85-90
2025-01-10 17:11:34,546 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 17:19:00,962 [asp.py] => total parameters: 173603841
2025-01-10 17:19:00,963 [asp.py] => trainable parameters: 2006529
2025-01-10 17:19:07,263 [trainer.py] => Top1 curve: [95.4, 89.9]
2025-01-10 17:19:07,264 [trainer.py] => Average Accuracy (Top1): 92.65   (Harmonic Accuracy): 89.53859844271412 (Old Acc): 95.6 (New Acc): 84.2 

2025-01-10 17:19:07,265 [trainer.py] => All params: 173603841
2025-01-10 17:19:07,266 [trainer.py] => Trainable params: 2006529
2025-01-10 17:19:07,267 [asp.py] => Learning on 10-15
2025-01-10 17:19:07,280 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 17:28:16,626 [asp.py] => total parameters: 173665281
2025-01-10 17:28:16,627 [asp.py] => trainable parameters: 2067969
2025-01-10 17:29:02,184 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18, 64.72, 65.07, 63.27, 61.37, 61.21, 59.23, 59.35, 58.65, 58.19]
2025-01-10 17:29:02,185 [trainer.py] => Average Accuracy (Top1): 69.12277777777778   (Harmonic Accuracy): 67.22123594555752 (Old Acc): 82.4 (New Acc): 56.76470588235294 

2025-01-10 17:29:02,186 [trainer.py] => All params: 173665281
2025-01-10 17:29:02,186 [trainer.py] => Trainable params: 2067969
2025-01-10 17:29:02,188 [asp.py] => Learning on 90-95
2025-01-10 17:29:02,212 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 17:34:51,500 [asp.py] => total parameters: 173607681
2025-01-10 17:34:51,500 [asp.py] => trainable parameters: 2010369
2025-01-10 17:35:00,246 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6]
2025-01-10 17:35:00,246 [trainer.py] => Average Accuracy (Top1): 87.63333333333333   (Harmonic Accuracy): 79.79422249539029 (Old Acc): 92.6 (New Acc): 70.1 

2025-01-10 17:35:00,247 [trainer.py] => All params: 173607681
2025-01-10 17:35:00,248 [trainer.py] => Trainable params: 2010369
2025-01-10 17:35:00,249 [asp.py] => Learning on 15-20
2025-01-10 17:35:00,267 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 17:45:44,962 [asp.py] => total parameters: 173669121
2025-01-10 17:45:44,963 [asp.py] => trainable parameters: 2071809
2025-01-10 17:46:33,318 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18, 64.72, 65.07, 63.27, 61.37, 61.21, 59.23, 59.35, 58.65, 58.19, 57.45]
2025-01-10 17:46:33,319 [trainer.py] => Average Accuracy (Top1): 68.50842105263159   (Harmonic Accuracy): 66.72932113625421 (Old Acc): 82.4 (New Acc): 56.06666666666668 

2025-01-10 17:46:33,320 [trainer.py] => All params: 173669121
2025-01-10 17:46:33,320 [trainer.py] => Trainable params: 2071809
2025-01-10 17:46:33,321 [asp.py] => Learning on 95-100
2025-01-10 17:46:33,368 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 17:47:50,750 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 17:47:50,751 [trainer.py] => model_name: asp
2025-01-10 17:47:50,751 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 17:47:50,751 [trainer.py] => device: ['cuda']
2025-01-10 17:47:50,751 [trainer.py] => seed: 2024
2025-01-10 17:47:50,751 [trainer.py] => dataset: cifar224
2025-01-10 17:47:50,751 [trainer.py] => init_cls: 5
2025-01-10 17:47:50,751 [trainer.py] => increment: 5
2025-01-10 17:47:50,751 [trainer.py] => kshot: 5
2025-01-10 17:47:50,751 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 17:47:50,751 [trainer.py] => z_dim: 1000
2025-01-10 17:47:50,751 [trainer.py] => conv_dim: 64
2025-01-10 17:47:50,751 [trainer.py] => img_size: 224
2025-01-10 17:47:50,751 [trainer.py] => generator_lr: 0.005
2025-01-10 17:47:50,751 [trainer.py] => pi: 100
2025-01-10 17:47:50,751 [trainer.py] => w_bn: 50.0
2025-01-10 17:47:50,751 [trainer.py] => w_noise: 0.001
2025-01-10 17:47:50,751 [trainer.py] => server_ss: 32
2025-01-10 17:47:50,751 [trainer.py] => bn_loss: 1
2025-01-10 17:47:50,751 [trainer.py] => noise: 1
2025-01-10 17:47:50,751 [trainer.py] => ie_loss: 1
2025-01-10 17:47:50,751 [trainer.py] => act_loss: 0
2025-01-10 17:47:50,751 [trainer.py] => w_ie: 1.0
2025-01-10 17:47:50,751 [trainer.py] => w_act: 0.1
2025-01-10 17:47:50,752 [trainer.py] => syn_size: 32
2025-01-10 17:47:50,752 [trainer.py] => need_syn_imgs: True
2025-01-10 17:47:50,752 [trainer.py] => g_local_bs: 5
2025-01-10 17:47:50,752 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 17:47:50,752 [trainer.py] => g_local_train_steps: 5
2025-01-10 17:47:50,752 [trainer.py] => dataset_syn: cifar100
2025-01-10 17:47:50,752 [trainer.py] => com_round_gen: 10
2025-01-10 17:47:50,752 [trainer.py] => g_sigma: 0
2025-01-10 17:47:50,752 [trainer.py] => save_cls_embeds: False
2025-01-10 17:47:50,752 [trainer.py] => syn_image_path: outputs/syn_image_5_pre_0
2025-01-10 17:47:50,752 [trainer.py] => save_dir: outputs
2025-01-10 17:47:50,752 [trainer.py] => n_iter: 5
2025-01-10 17:47:50,752 [trainer.py] => num_users: 1
2025-01-10 17:47:50,752 [trainer.py] => cur_size: 50
2025-01-10 17:47:50,752 [trainer.py] => local_bs: 5
2025-01-10 17:47:50,752 [trainer.py] => pre_size: 48
2025-01-10 17:47:50,752 [trainer.py] => w_ce_pre: 0.5
2025-01-10 17:47:50,752 [trainer.py] => vpt_type: Deep
2025-01-10 17:47:50,752 [trainer.py] => prompt_token_num: 6
2025-01-10 17:47:50,752 [trainer.py] => avg_alpha: 0.8
2025-01-10 17:47:50,752 [trainer.py] => perturb_var: 1
2025-01-10 17:47:50,752 [trainer.py] => EMA_beta: 0.99
2025-01-10 17:47:50,752 [trainer.py] => anchor_lambda: 0.1
2025-01-10 17:47:50,752 [trainer.py] => kl_weight: 0.001
2025-01-10 17:47:50,752 [trainer.py] => TIP_init: zero
2025-01-10 17:47:50,752 [trainer.py] => tuned_epoch: 10
2025-01-10 17:47:50,752 [trainer.py] => fs_epoch: 0
2025-01-10 17:47:50,753 [trainer.py] => init_lr: 0.01
2025-01-10 17:47:50,753 [trainer.py] => fs_lr: 0.001
2025-01-10 17:47:50,753 [trainer.py] => batch_size: 48
2025-01-10 17:47:50,753 [trainer.py] => fs_batch_size: 16
2025-01-10 17:47:50,753 [trainer.py] => weight_decay: 0.0005
2025-01-10 17:47:50,753 [trainer.py] => min_lr: 0
2025-01-10 17:47:50,753 [trainer.py] => optimizer: sgd
2025-01-10 17:47:50,753 [trainer.py] => memory_size: 0
2025-01-10 17:47:50,753 [trainer.py] => memory_per_class: 0
2025-01-10 17:47:50,753 [trainer.py] => fixed_memory: False
2025-01-10 17:47:50,753 [trainer.py] => shuffle: False
2025-01-10 17:47:50,753 [trainer.py] => top_k: 5
2025-01-10 17:47:50,753 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 17:47:50,753 [trainer.py] => prefix: asp
2025-01-10 17:47:50,753 [trainer.py] => model_prefix: asp
2025-01-10 17:47:52,379 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 17:48:20,205 [trainer.py] => All params: 173596160
2025-01-10 17:48:20,206 [trainer.py] => Trainable params: 1998848
2025-01-10 17:48:20,207 [asp.py] => Learning on 0-5
2025-01-10 17:48:20,220 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 17:48:39,013 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 17:48:39,013 [trainer.py] => model_name: asp
2025-01-10 17:48:39,013 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 17:48:39,013 [trainer.py] => device: ['cuda']
2025-01-10 17:48:39,013 [trainer.py] => seed: 2024
2025-01-10 17:48:39,013 [trainer.py] => dataset: cifar224
2025-01-10 17:48:39,013 [trainer.py] => init_cls: 5
2025-01-10 17:48:39,013 [trainer.py] => increment: 5
2025-01-10 17:48:39,013 [trainer.py] => kshot: 5
2025-01-10 17:48:39,013 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 17:48:39,013 [trainer.py] => z_dim: 1000
2025-01-10 17:48:39,013 [trainer.py] => conv_dim: 64
2025-01-10 17:48:39,013 [trainer.py] => img_size: 224
2025-01-10 17:48:39,013 [trainer.py] => generator_lr: 0.005
2025-01-10 17:48:39,013 [trainer.py] => pi: 100
2025-01-10 17:48:39,013 [trainer.py] => w_bn: 50.0
2025-01-10 17:48:39,013 [trainer.py] => w_noise: 0.001
2025-01-10 17:48:39,013 [trainer.py] => server_ss: 32
2025-01-10 17:48:39,013 [trainer.py] => bn_loss: 1
2025-01-10 17:48:39,013 [trainer.py] => noise: 1
2025-01-10 17:48:39,014 [trainer.py] => ie_loss: 1
2025-01-10 17:48:39,014 [trainer.py] => act_loss: 0
2025-01-10 17:48:39,014 [trainer.py] => w_ie: 1.0
2025-01-10 17:48:39,014 [trainer.py] => w_act: 0.1
2025-01-10 17:48:39,014 [trainer.py] => syn_size: 32
2025-01-10 17:48:39,014 [trainer.py] => need_syn_imgs: True
2025-01-10 17:48:39,014 [trainer.py] => g_local_bs: 5
2025-01-10 17:48:39,014 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 17:48:39,014 [trainer.py] => g_local_train_steps: 5
2025-01-10 17:48:39,014 [trainer.py] => dataset_syn: cifar100
2025-01-10 17:48:39,014 [trainer.py] => com_round_gen: 10
2025-01-10 17:48:39,014 [trainer.py] => g_sigma: 0
2025-01-10 17:48:39,014 [trainer.py] => save_cls_embeds: False
2025-01-10 17:48:39,014 [trainer.py] => syn_image_path: outputs/syn_image_5_pre_0.3
2025-01-10 17:48:39,014 [trainer.py] => save_dir: outputs
2025-01-10 17:48:39,014 [trainer.py] => n_iter: 5
2025-01-10 17:48:39,014 [trainer.py] => num_users: 1
2025-01-10 17:48:39,014 [trainer.py] => cur_size: 50
2025-01-10 17:48:39,014 [trainer.py] => local_bs: 5
2025-01-10 17:48:39,014 [trainer.py] => pre_size: 48
2025-01-10 17:48:39,014 [trainer.py] => w_ce_pre: 0.0
2025-01-10 17:48:39,014 [trainer.py] => vpt_type: Deep
2025-01-10 17:48:39,014 [trainer.py] => prompt_token_num: 6
2025-01-10 17:48:39,014 [trainer.py] => avg_alpha: 0.8
2025-01-10 17:48:39,014 [trainer.py] => perturb_var: 1
2025-01-10 17:48:39,014 [trainer.py] => EMA_beta: 0.99
2025-01-10 17:48:39,014 [trainer.py] => anchor_lambda: 0.1
2025-01-10 17:48:39,014 [trainer.py] => kl_weight: 0.001
2025-01-10 17:48:39,014 [trainer.py] => TIP_init: zero
2025-01-10 17:48:39,014 [trainer.py] => tuned_epoch: 10
2025-01-10 17:48:39,015 [trainer.py] => fs_epoch: 0
2025-01-10 17:48:39,015 [trainer.py] => init_lr: 0.01
2025-01-10 17:48:39,015 [trainer.py] => fs_lr: 0.001
2025-01-10 17:48:39,015 [trainer.py] => batch_size: 48
2025-01-10 17:48:39,015 [trainer.py] => fs_batch_size: 16
2025-01-10 17:48:39,015 [trainer.py] => weight_decay: 0.0005
2025-01-10 17:48:39,015 [trainer.py] => min_lr: 0
2025-01-10 17:48:39,015 [trainer.py] => optimizer: sgd
2025-01-10 17:48:39,015 [trainer.py] => memory_size: 0
2025-01-10 17:48:39,015 [trainer.py] => memory_per_class: 0
2025-01-10 17:48:39,015 [trainer.py] => fixed_memory: False
2025-01-10 17:48:39,015 [trainer.py] => shuffle: False
2025-01-10 17:48:39,015 [trainer.py] => top_k: 5
2025-01-10 17:48:39,015 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 17:48:39,015 [trainer.py] => prefix: asp
2025-01-10 17:48:39,015 [trainer.py] => model_prefix: asp
2025-01-10 17:48:40,702 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 17:48:56,531 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 17:48:56,531 [trainer.py] => model_name: asp
2025-01-10 17:48:56,531 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 17:48:56,531 [trainer.py] => device: ['cuda']
2025-01-10 17:48:56,531 [trainer.py] => seed: 2024
2025-01-10 17:48:56,531 [trainer.py] => dataset: cifar224
2025-01-10 17:48:56,531 [trainer.py] => init_cls: 5
2025-01-10 17:48:56,531 [trainer.py] => increment: 5
2025-01-10 17:48:56,531 [trainer.py] => kshot: 5
2025-01-10 17:48:56,531 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 17:48:56,531 [trainer.py] => z_dim: 1000
2025-01-10 17:48:56,531 [trainer.py] => conv_dim: 64
2025-01-10 17:48:56,531 [trainer.py] => img_size: 224
2025-01-10 17:48:56,531 [trainer.py] => generator_lr: 0.005
2025-01-10 17:48:56,531 [trainer.py] => pi: 100
2025-01-10 17:48:56,531 [trainer.py] => w_bn: 50.0
2025-01-10 17:48:56,532 [trainer.py] => w_noise: 0.001
2025-01-10 17:48:56,532 [trainer.py] => server_ss: 32
2025-01-10 17:48:56,532 [trainer.py] => bn_loss: 1
2025-01-10 17:48:56,532 [trainer.py] => noise: 1
2025-01-10 17:48:56,532 [trainer.py] => ie_loss: 1
2025-01-10 17:48:56,532 [trainer.py] => act_loss: 0
2025-01-10 17:48:56,532 [trainer.py] => w_ie: 1.0
2025-01-10 17:48:56,532 [trainer.py] => w_act: 0.1
2025-01-10 17:48:56,532 [trainer.py] => syn_size: 32
2025-01-10 17:48:56,532 [trainer.py] => need_syn_imgs: True
2025-01-10 17:48:56,532 [trainer.py] => g_local_bs: 5
2025-01-10 17:48:56,532 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 17:48:56,532 [trainer.py] => g_local_train_steps: 5
2025-01-10 17:48:56,532 [trainer.py] => dataset_syn: cifar100
2025-01-10 17:48:56,532 [trainer.py] => com_round_gen: 10
2025-01-10 17:48:56,532 [trainer.py] => g_sigma: 0
2025-01-10 17:48:56,532 [trainer.py] => save_cls_embeds: False
2025-01-10 17:48:56,532 [trainer.py] => syn_image_path: outputs/syn_image_5_pre_0.0
2025-01-10 17:48:56,532 [trainer.py] => save_dir: outputs
2025-01-10 17:48:56,532 [trainer.py] => n_iter: 5
2025-01-10 17:48:56,532 [trainer.py] => num_users: 1
2025-01-10 17:48:56,532 [trainer.py] => cur_size: 50
2025-01-10 17:48:56,532 [trainer.py] => local_bs: 5
2025-01-10 17:48:56,532 [trainer.py] => pre_size: 48
2025-01-10 17:48:56,532 [trainer.py] => w_ce_pre: 0.0
2025-01-10 17:48:56,532 [trainer.py] => vpt_type: Deep
2025-01-10 17:48:56,532 [trainer.py] => prompt_token_num: 6
2025-01-10 17:48:56,533 [trainer.py] => avg_alpha: 0.8
2025-01-10 17:48:56,533 [trainer.py] => perturb_var: 1
2025-01-10 17:48:56,533 [trainer.py] => EMA_beta: 0.99
2025-01-10 17:48:56,533 [trainer.py] => anchor_lambda: 0.1
2025-01-10 17:48:56,533 [trainer.py] => kl_weight: 0.001
2025-01-10 17:48:56,533 [trainer.py] => TIP_init: zero
2025-01-10 17:48:56,533 [trainer.py] => tuned_epoch: 10
2025-01-10 17:48:56,533 [trainer.py] => fs_epoch: 0
2025-01-10 17:48:56,533 [trainer.py] => init_lr: 0.01
2025-01-10 17:48:56,533 [trainer.py] => fs_lr: 0.001
2025-01-10 17:48:56,533 [trainer.py] => batch_size: 48
2025-01-10 17:48:56,533 [trainer.py] => fs_batch_size: 16
2025-01-10 17:48:56,533 [trainer.py] => weight_decay: 0.0005
2025-01-10 17:48:56,533 [trainer.py] => min_lr: 0
2025-01-10 17:48:56,533 [trainer.py] => optimizer: sgd
2025-01-10 17:48:56,533 [trainer.py] => memory_size: 0
2025-01-10 17:48:56,533 [trainer.py] => memory_per_class: 0
2025-01-10 17:48:56,533 [trainer.py] => fixed_memory: False
2025-01-10 17:48:56,533 [trainer.py] => shuffle: False
2025-01-10 17:48:56,533 [trainer.py] => top_k: 5
2025-01-10 17:48:56,533 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 17:48:56,533 [trainer.py] => prefix: asp
2025-01-10 17:48:56,533 [trainer.py] => model_prefix: asp
2025-01-10 17:48:58,228 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 17:49:24,764 [trainer.py] => All params: 173596160
2025-01-10 17:49:24,765 [trainer.py] => Trainable params: 1998848
2025-01-10 17:49:24,766 [asp.py] => Learning on 0-5
2025-01-10 17:49:24,781 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 17:49:31,168 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 17:49:31,168 [trainer.py] => model_name: asp
2025-01-10 17:49:31,168 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 17:49:31,168 [trainer.py] => device: ['cuda']
2025-01-10 17:49:31,168 [trainer.py] => seed: 2024
2025-01-10 17:49:31,168 [trainer.py] => dataset: cifar224
2025-01-10 17:49:31,168 [trainer.py] => init_cls: 5
2025-01-10 17:49:31,168 [trainer.py] => increment: 5
2025-01-10 17:49:31,168 [trainer.py] => kshot: 5
2025-01-10 17:49:31,168 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 17:49:31,168 [trainer.py] => z_dim: 1000
2025-01-10 17:49:31,168 [trainer.py] => conv_dim: 64
2025-01-10 17:49:31,168 [trainer.py] => img_size: 224
2025-01-10 17:49:31,169 [trainer.py] => generator_lr: 0.005
2025-01-10 17:49:31,169 [trainer.py] => pi: 100
2025-01-10 17:49:31,169 [trainer.py] => w_bn: 50.0
2025-01-10 17:49:31,169 [trainer.py] => w_noise: 0.001
2025-01-10 17:49:31,169 [trainer.py] => server_ss: 32
2025-01-10 17:49:31,169 [trainer.py] => bn_loss: 1
2025-01-10 17:49:31,169 [trainer.py] => noise: 1
2025-01-10 17:49:31,169 [trainer.py] => ie_loss: 1
2025-01-10 17:49:31,169 [trainer.py] => act_loss: 0
2025-01-10 17:49:31,169 [trainer.py] => w_ie: 1.0
2025-01-10 17:49:31,169 [trainer.py] => w_act: 0.1
2025-01-10 17:49:31,169 [trainer.py] => syn_size: 32
2025-01-10 17:49:31,169 [trainer.py] => need_syn_imgs: True
2025-01-10 17:49:31,169 [trainer.py] => g_local_bs: 5
2025-01-10 17:49:31,169 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 17:49:31,169 [trainer.py] => g_local_train_steps: 5
2025-01-10 17:49:31,169 [trainer.py] => dataset_syn: cifar100
2025-01-10 17:49:31,169 [trainer.py] => com_round_gen: 10
2025-01-10 17:49:31,169 [trainer.py] => g_sigma: 0
2025-01-10 17:49:31,169 [trainer.py] => save_cls_embeds: False
2025-01-10 17:49:31,169 [trainer.py] => syn_image_path: outputs/syn_image_5_pre_0.3
2025-01-10 17:49:31,169 [trainer.py] => save_dir: outputs
2025-01-10 17:49:31,169 [trainer.py] => n_iter: 5
2025-01-10 17:49:31,169 [trainer.py] => num_users: 1
2025-01-10 17:49:31,169 [trainer.py] => cur_size: 50
2025-01-10 17:49:31,169 [trainer.py] => local_bs: 5
2025-01-10 17:49:31,169 [trainer.py] => pre_size: 48
2025-01-10 17:49:31,169 [trainer.py] => w_ce_pre: 0.3
2025-01-10 17:49:31,169 [trainer.py] => vpt_type: Deep
2025-01-10 17:49:31,170 [trainer.py] => prompt_token_num: 6
2025-01-10 17:49:31,170 [trainer.py] => avg_alpha: 0.8
2025-01-10 17:49:31,170 [trainer.py] => perturb_var: 1
2025-01-10 17:49:31,170 [trainer.py] => EMA_beta: 0.99
2025-01-10 17:49:31,170 [trainer.py] => anchor_lambda: 0.1
2025-01-10 17:49:31,170 [trainer.py] => kl_weight: 0.001
2025-01-10 17:49:31,170 [trainer.py] => TIP_init: zero
2025-01-10 17:49:31,170 [trainer.py] => tuned_epoch: 10
2025-01-10 17:49:31,170 [trainer.py] => fs_epoch: 0
2025-01-10 17:49:31,170 [trainer.py] => init_lr: 0.01
2025-01-10 17:49:31,170 [trainer.py] => fs_lr: 0.001
2025-01-10 17:49:31,170 [trainer.py] => batch_size: 48
2025-01-10 17:49:31,170 [trainer.py] => fs_batch_size: 16
2025-01-10 17:49:31,170 [trainer.py] => weight_decay: 0.0005
2025-01-10 17:49:31,170 [trainer.py] => min_lr: 0
2025-01-10 17:49:31,170 [trainer.py] => optimizer: sgd
2025-01-10 17:49:31,170 [trainer.py] => memory_size: 0
2025-01-10 17:49:31,170 [trainer.py] => memory_per_class: 0
2025-01-10 17:49:31,170 [trainer.py] => fixed_memory: False
2025-01-10 17:49:31,170 [trainer.py] => shuffle: False
2025-01-10 17:49:31,170 [trainer.py] => top_k: 5
2025-01-10 17:49:31,170 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 17:49:31,170 [trainer.py] => prefix: asp
2025-01-10 17:49:31,170 [trainer.py] => model_prefix: asp
2025-01-10 17:49:32,753 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 17:49:58,762 [trainer.py] => All params: 173596160
2025-01-10 17:49:58,763 [trainer.py] => Trainable params: 1998848
2025-01-10 17:49:58,763 [asp.py] => Learning on 0-5
2025-01-10 17:49:58,773 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 17:50:45,273 [asp.py] => total parameters: 173611521
2025-01-10 17:50:45,274 [asp.py] => trainable parameters: 2014209
2025-01-10 17:50:56,317 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6]
2025-01-10 17:50:56,318 [trainer.py] => Average Accuracy (Top1): 84.875   (Harmonic Accuracy): 80.54467046379169 (Old Acc): 92.6 (New Acc): 71.26666666666667 

2025-01-10 17:50:56,319 [trainer.py] => All params: 173611521
2025-01-10 17:50:56,319 [trainer.py] => Trainable params: 2014209
2025-01-10 17:50:56,321 [asp.py] => Learning on 20-25
2025-01-10 17:50:56,340 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 18:03:17,217 [asp.py] => total parameters: 173672961
2025-01-10 18:03:17,218 [asp.py] => trainable parameters: 2075649
2025-01-10 18:04:08,070 [trainer.py] => Top1 curve: [94.0, 90.5, 80.2, 75.7, 74.84, 71.4, 69.71, 68.62, 68.18, 64.72, 65.07, 63.27, 61.37, 61.21, 59.23, 59.35, 58.65, 58.19, 57.45, 56.59]
2025-01-10 18:04:08,071 [trainer.py] => Average Accuracy (Top1): 67.9125   (Harmonic Accuracy): 66.07729187409053 (Old Acc): 82.2 (New Acc): 55.24210526315789 

2025-01-10 18:04:08,071 [trainer.py] => 

2025-01-10 18:04:58,577 [asp.py] => total parameters: 173600001
2025-01-10 18:04:58,578 [asp.py] => trainable parameters: 2002689
2025-01-10 18:05:30,500 [asp.py] => total parameters: 173600001
2025-01-10 18:05:30,501 [asp.py] => trainable parameters: 2002689
2025-01-10 18:06:05,420 [asp.py] => Task 0, Epoch 1 => Loss 1.618, Train_accy 60.25, Test_curr_accy 96.80, Test_accy 96.80
2025-01-10 18:06:35,702 [asp.py] => Task 0, Epoch 1 => Loss 1.599, Train_accy 61.20, Test_curr_accy 97.20, Test_accy 97.20
2025-01-10 18:06:39,613 [asp.py] => total parameters: 173615361
2025-01-10 18:06:39,614 [asp.py] => trainable parameters: 2018049
2025-01-10 18:06:52,915 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8]
2025-01-10 18:06:52,916 [trainer.py] => Average Accuracy (Top1): 82.86   (Harmonic Accuracy): 79.78429319371728 (Old Acc): 91.8 (New Acc): 70.55 

2025-01-10 18:06:52,918 [trainer.py] => All params: 173615361
2025-01-10 18:06:52,919 [trainer.py] => Trainable params: 2018049
2025-01-10 18:06:52,921 [asp.py] => Learning on 25-30
2025-01-10 18:06:52,940 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 18:07:08,291 [asp.py] => Task 0, Epoch 2 => Loss nan, Train_accy 47.31, Test_curr_accy 20.00, Test_accy 20.00
2025-01-10 18:07:40,110 [asp.py] => Task 0, Epoch 2 => Loss 0.619, Train_accy 90.15, Test_curr_accy 97.60, Test_accy 97.60
2025-01-10 18:08:08,688 [asp.py] => Task 0, Epoch 3 => Loss nan, Train_accy 20.00, Test_curr_accy 20.00, Test_accy 20.00
2025-01-10 18:08:44,344 [asp.py] => Task 0, Epoch 3 => Loss 0.590, Train_accy 91.16, Test_curr_accy 96.80, Test_accy 96.80
2025-01-10 18:09:08,969 [asp.py] => Task 0, Epoch 4 => Loss nan, Train_accy 20.00, Test_curr_accy 20.00, Test_accy 20.00
2025-01-10 18:09:48,416 [asp.py] => Task 0, Epoch 4 => Loss 0.681, Train_accy 91.31, Test_curr_accy 92.00, Test_accy 92.00
2025-01-10 18:10:08,950 [asp.py] => Task 0, Epoch 5 => Loss nan, Train_accy 20.00, Test_curr_accy 20.00, Test_accy 20.00
2025-01-10 18:10:52,524 [asp.py] => Task 0, Epoch 5 => Loss 0.400, Train_accy 93.42, Test_curr_accy 99.20, Test_accy 99.20
2025-01-10 18:11:09,216 [asp.py] => Task 0, Epoch 6 => Loss nan, Train_accy 20.00, Test_curr_accy 20.00, Test_accy 20.00
2025-01-10 18:11:57,770 [asp.py] => Task 0, Epoch 6 => Loss 0.397, Train_accy 93.38, Test_curr_accy 98.60, Test_accy 98.60
2025-01-10 18:12:10,716 [asp.py] => Task 0, Epoch 7 => Loss nan, Train_accy 20.00, Test_curr_accy 20.00, Test_accy 20.00
2025-01-10 18:13:02,195 [asp.py] => Task 0, Epoch 7 => Loss 0.308, Train_accy 94.29, Test_curr_accy 98.40, Test_accy 98.40
2025-01-10 18:13:11,152 [asp.py] => Task 0, Epoch 8 => Loss nan, Train_accy 20.00, Test_curr_accy 20.00, Test_accy 20.00
2025-01-10 18:14:06,631 [asp.py] => Task 0, Epoch 8 => Loss 0.275, Train_accy 94.84, Test_curr_accy 98.00, Test_accy 98.00
2025-01-10 18:14:12,155 [asp.py] => Task 0, Epoch 9 => Loss nan, Train_accy 20.00, Test_curr_accy 20.00, Test_accy 20.00
2025-01-10 18:15:10,665 [asp.py] => Task 0, Epoch 9 => Loss 0.246, Train_accy 94.62, Test_curr_accy 98.80, Test_accy 98.80
2025-01-10 18:15:13,035 [asp.py] => Task 0, Epoch 10 => Loss nan, Train_accy 20.00, Test_curr_accy 20.00, Test_accy 20.00
2025-01-10 18:15:37,728 [trainer.py] => Top1 curve: [20.0]
2025-01-10 18:15:37,728 [trainer.py] => Average Accuracy (Top1): 20.0   (Harmonic Accuracy): None (Old Acc): 20.0 (New Acc): [] 

2025-01-10 18:15:37,729 [trainer.py] => All params: 173600001
2025-01-10 18:15:37,729 [trainer.py] => Trainable params: 2002689
2025-01-10 18:15:37,731 [asp.py] => Learning on 5-10
2025-01-10 18:15:37,740 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 18:16:18,076 [asp.py] => Task 0, Epoch 10 => Loss 0.234, Train_accy 95.60, Test_curr_accy 96.40, Test_accy 96.40
2025-01-10 18:16:43,735 [trainer.py] => Top1 curve: [96.4]
2025-01-10 18:16:43,736 [trainer.py] => Average Accuracy (Top1): 96.4   (Harmonic Accuracy): None (Old Acc): 96.4 (New Acc): [] 

2025-01-10 18:16:43,737 [trainer.py] => All params: 173600001
2025-01-10 18:16:43,738 [trainer.py] => Trainable params: 2002689
2025-01-10 18:16:43,740 [asp.py] => Learning on 5-10
2025-01-10 18:16:43,750 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 18:22:43,304 [asp.py] => total parameters: 173619201
2025-01-10 18:22:43,305 [asp.py] => trainable parameters: 2021889
2025-01-10 18:22:58,819 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43]
2025-01-10 18:22:58,819 [trainer.py] => Average Accuracy (Top1): 80.62166666666667   (Harmonic Accuracy): 75.7863788229247 (Old Acc): 90.4 (New Acc): 65.24 

2025-01-10 18:22:58,820 [trainer.py] => All params: 173619201
2025-01-10 18:22:58,821 [trainer.py] => Trainable params: 2021889
2025-01-10 18:22:58,823 [asp.py] => Learning on 30-35
2025-01-10 18:22:58,854 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 18:23:31,221 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 18:23:31,221 [trainer.py] => model_name: asp
2025-01-10 18:23:31,221 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 18:23:31,221 [trainer.py] => device: ['cuda']
2025-01-10 18:23:31,221 [trainer.py] => seed: 2024
2025-01-10 18:23:31,221 [trainer.py] => dataset: cifar224
2025-01-10 18:23:31,221 [trainer.py] => init_cls: 5
2025-01-10 18:23:31,221 [trainer.py] => increment: 5
2025-01-10 18:23:31,221 [trainer.py] => kshot: 5
2025-01-10 18:23:31,221 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 18:23:31,222 [trainer.py] => z_dim: 1000
2025-01-10 18:23:31,222 [trainer.py] => conv_dim: 64
2025-01-10 18:23:31,222 [trainer.py] => img_size: 224
2025-01-10 18:23:31,222 [trainer.py] => generator_lr: 0.005
2025-01-10 18:23:31,222 [trainer.py] => pi: 100
2025-01-10 18:23:31,222 [trainer.py] => w_bn: 50.0
2025-01-10 18:23:31,222 [trainer.py] => w_noise: 0.001
2025-01-10 18:23:31,222 [trainer.py] => server_ss: 32
2025-01-10 18:23:31,222 [trainer.py] => bn_loss: 1
2025-01-10 18:23:31,222 [trainer.py] => noise: 1
2025-01-10 18:23:31,222 [trainer.py] => ie_loss: 1
2025-01-10 18:23:31,222 [trainer.py] => act_loss: 0
2025-01-10 18:23:31,222 [trainer.py] => w_ie: 1.0
2025-01-10 18:23:31,222 [trainer.py] => w_act: 0.1
2025-01-10 18:23:31,222 [trainer.py] => syn_size: 32
2025-01-10 18:23:31,222 [trainer.py] => need_syn_imgs: True
2025-01-10 18:23:31,222 [trainer.py] => g_local_bs: 5
2025-01-10 18:23:31,222 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 18:23:31,222 [trainer.py] => g_local_train_steps: 5
2025-01-10 18:23:31,222 [trainer.py] => dataset_syn: cifar100
2025-01-10 18:23:31,222 [trainer.py] => com_round_gen: 10
2025-01-10 18:23:31,222 [trainer.py] => g_sigma: 0
2025-01-10 18:23:31,222 [trainer.py] => save_cls_embeds: False
2025-01-10 18:23:31,222 [trainer.py] => syn_image_path: outputs/syn_image_5_pre1
2025-01-10 18:23:31,222 [trainer.py] => save_dir: outputs
2025-01-10 18:23:31,222 [trainer.py] => n_iter: 5
2025-01-10 18:23:31,223 [trainer.py] => num_users: 1
2025-01-10 18:23:31,223 [trainer.py] => cur_size: 50
2025-01-10 18:23:31,223 [trainer.py] => local_bs: 5
2025-01-10 18:23:31,223 [trainer.py] => pre_size: 48
2025-01-10 18:23:31,223 [trainer.py] => w_ce_pre: 0.3
2025-01-10 18:23:31,223 [trainer.py] => vpt_type: Deep
2025-01-10 18:23:31,223 [trainer.py] => prompt_token_num: 6
2025-01-10 18:23:31,223 [trainer.py] => avg_alpha: 0.8
2025-01-10 18:23:31,223 [trainer.py] => perturb_var: 1
2025-01-10 18:23:31,223 [trainer.py] => EMA_beta: 0.99
2025-01-10 18:23:31,223 [trainer.py] => anchor_lambda: 0.1
2025-01-10 18:23:31,223 [trainer.py] => kl_weight: 0.001
2025-01-10 18:23:31,223 [trainer.py] => TIP_init: zero
2025-01-10 18:23:31,223 [trainer.py] => tuned_epoch: 10
2025-01-10 18:23:31,223 [trainer.py] => fs_epoch: 0
2025-01-10 18:23:31,223 [trainer.py] => init_lr: 0.01
2025-01-10 18:23:31,223 [trainer.py] => fs_lr: 0.001
2025-01-10 18:23:31,223 [trainer.py] => batch_size: 48
2025-01-10 18:23:31,223 [trainer.py] => fs_batch_size: 16
2025-01-10 18:23:31,223 [trainer.py] => weight_decay: 0.0005
2025-01-10 18:23:31,223 [trainer.py] => min_lr: 0
2025-01-10 18:23:31,223 [trainer.py] => optimizer: sgd
2025-01-10 18:23:31,224 [trainer.py] => memory_size: 0
2025-01-10 18:23:31,224 [trainer.py] => memory_per_class: 0
2025-01-10 18:23:31,224 [trainer.py] => fixed_memory: False
2025-01-10 18:23:31,224 [trainer.py] => shuffle: False
2025-01-10 18:23:31,224 [trainer.py] => top_k: 5
2025-01-10 18:23:31,224 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 18:23:31,224 [trainer.py] => prefix: asp
2025-01-10 18:23:31,224 [trainer.py] => model_prefix: asp
2025-01-10 18:23:32,893 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 18:23:59,134 [trainer.py] => All params: 173596160
2025-01-10 18:23:59,135 [trainer.py] => Trainable params: 1998848
2025-01-10 18:23:59,140 [asp.py] => Learning on 0-5
2025-01-10 18:23:59,147 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 18:27:58,321 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 18:27:58,321 [trainer.py] => model_name: asp
2025-01-10 18:27:58,321 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 18:27:58,321 [trainer.py] => device: ['cuda']
2025-01-10 18:27:58,321 [trainer.py] => seed: 2024
2025-01-10 18:27:58,321 [trainer.py] => dataset: cifar224
2025-01-10 18:27:58,321 [trainer.py] => init_cls: 5
2025-01-10 18:27:58,321 [trainer.py] => increment: 5
2025-01-10 18:27:58,321 [trainer.py] => kshot: 5
2025-01-10 18:27:58,322 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 18:27:58,322 [trainer.py] => z_dim: 1000
2025-01-10 18:27:58,322 [trainer.py] => conv_dim: 64
2025-01-10 18:27:58,322 [trainer.py] => img_size: 224
2025-01-10 18:27:58,322 [trainer.py] => generator_lr: 0.005
2025-01-10 18:27:58,322 [trainer.py] => pi: 100
2025-01-10 18:27:58,322 [trainer.py] => w_bn: 50.0
2025-01-10 18:27:58,322 [trainer.py] => w_noise: 0.001
2025-01-10 18:27:58,322 [trainer.py] => server_ss: 32
2025-01-10 18:27:58,322 [trainer.py] => bn_loss: 1
2025-01-10 18:27:58,322 [trainer.py] => noise: 1
2025-01-10 18:27:58,322 [trainer.py] => ie_loss: 1
2025-01-10 18:27:58,322 [trainer.py] => act_loss: 0
2025-01-10 18:27:58,322 [trainer.py] => w_ie: 1.0
2025-01-10 18:27:58,322 [trainer.py] => w_act: 0.1
2025-01-10 18:27:58,322 [trainer.py] => syn_size: 32
2025-01-10 18:27:58,322 [trainer.py] => need_syn_imgs: True
2025-01-10 18:27:58,322 [trainer.py] => g_local_bs: 5
2025-01-10 18:27:58,322 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 18:27:58,322 [trainer.py] => g_local_train_steps: 5
2025-01-10 18:27:58,322 [trainer.py] => dataset_syn: cifar100
2025-01-10 18:27:58,322 [trainer.py] => com_round_gen: 10
2025-01-10 18:27:58,322 [trainer.py] => g_sigma: 0
2025-01-10 18:27:58,322 [trainer.py] => save_cls_embeds: False
2025-01-10 18:27:58,322 [trainer.py] => syn_image_path: outputs/syn_image_5_pre1
2025-01-10 18:27:58,322 [trainer.py] => save_dir: outputs
2025-01-10 18:27:58,322 [trainer.py] => n_iter: 5
2025-01-10 18:27:58,322 [trainer.py] => num_users: 1
2025-01-10 18:27:58,323 [trainer.py] => cur_size: 50
2025-01-10 18:27:58,323 [trainer.py] => local_bs: 5
2025-01-10 18:27:58,323 [trainer.py] => pre_size: 48
2025-01-10 18:27:58,323 [trainer.py] => w_ce_pre: 0.3
2025-01-10 18:27:58,323 [trainer.py] => vpt_type: Deep
2025-01-10 18:27:58,323 [trainer.py] => prompt_token_num: 6
2025-01-10 18:27:58,323 [trainer.py] => avg_alpha: 0.8
2025-01-10 18:27:58,323 [trainer.py] => perturb_var: 1
2025-01-10 18:27:58,323 [trainer.py] => EMA_beta: 0.99
2025-01-10 18:27:58,323 [trainer.py] => anchor_lambda: 0.1
2025-01-10 18:27:58,323 [trainer.py] => kl_weight: 0.001
2025-01-10 18:27:58,323 [trainer.py] => TIP_init: zero
2025-01-10 18:27:58,323 [trainer.py] => tuned_epoch: 10
2025-01-10 18:27:58,323 [trainer.py] => fs_epoch: 0
2025-01-10 18:27:58,323 [trainer.py] => init_lr: 0.01
2025-01-10 18:27:58,323 [trainer.py] => fs_lr: 0.001
2025-01-10 18:27:58,323 [trainer.py] => batch_size: 48
2025-01-10 18:27:58,323 [trainer.py] => fs_batch_size: 16
2025-01-10 18:27:58,323 [trainer.py] => weight_decay: 0.0005
2025-01-10 18:27:58,323 [trainer.py] => min_lr: 0
2025-01-10 18:27:58,323 [trainer.py] => optimizer: sgd
2025-01-10 18:27:58,323 [trainer.py] => memory_size: 0
2025-01-10 18:27:58,323 [trainer.py] => memory_per_class: 0
2025-01-10 18:27:58,323 [trainer.py] => fixed_memory: False
2025-01-10 18:27:58,323 [trainer.py] => shuffle: False
2025-01-10 18:27:58,323 [trainer.py] => top_k: 5
2025-01-10 18:27:58,323 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 18:27:58,323 [trainer.py] => prefix: asp
2025-01-10 18:27:58,323 [trainer.py] => model_prefix: asp
2025-01-10 18:27:59,881 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 18:28:26,619 [trainer.py] => All params: 173596160
2025-01-10 18:28:26,621 [trainer.py] => Trainable params: 1998848
2025-01-10 18:28:26,621 [asp.py] => Learning on 0-5
2025-01-10 18:28:26,658 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 18:32:19,005 [asp.py] => total parameters: 173603841
2025-01-10 18:32:19,006 [asp.py] => trainable parameters: 2006529
2025-01-10 18:32:24,977 [trainer.py] => Top1 curve: [20.0, 10.0]
2025-01-10 18:32:24,978 [trainer.py] => Average Accuracy (Top1): 15.0   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 18:32:24,978 [trainer.py] => All params: 173603841
2025-01-10 18:32:24,979 [trainer.py] => Trainable params: 2006529
2025-01-10 18:32:24,981 [asp.py] => Learning on 10-15
2025-01-10 18:32:25,002 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 18:32:25,782 [asp.py] => total parameters: 173603841
2025-01-10 18:32:25,783 [asp.py] => trainable parameters: 2006529
2025-01-10 18:32:32,138 [trainer.py] => Top1 curve: [96.4, 94.1]
2025-01-10 18:32:32,139 [trainer.py] => Average Accuracy (Top1): 95.25   (Harmonic Accuracy): 94.05313496280553 (Old Acc): 96.2 (New Acc): 92.0 

2025-01-10 18:32:32,140 [trainer.py] => All params: 173603841
2025-01-10 18:32:32,141 [trainer.py] => Trainable params: 2006529
2025-01-10 18:32:32,142 [asp.py] => Learning on 10-15
2025-01-10 18:32:32,161 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 18:38:44,123 [asp.py] => total parameters: 173623041
2025-01-10 18:38:44,124 [asp.py] => trainable parameters: 2025729
2025-01-10 18:39:01,994 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46]
2025-01-10 18:39:01,994 [trainer.py] => Average Accuracy (Top1): 78.88428571428572   (Harmonic Accuracy): 75.44141044936572 (Old Acc): 90.2 (New Acc): 64.83333333333333 

2025-01-10 18:39:01,995 [trainer.py] => All params: 173623041
2025-01-10 18:39:01,996 [trainer.py] => Trainable params: 2025729
2025-01-10 18:39:01,997 [asp.py] => Learning on 35-40
2025-01-10 18:39:02,023 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 18:44:43,925 [asp.py] => total parameters: 173600001
2025-01-10 18:44:43,926 [asp.py] => trainable parameters: 2002689
2025-01-10 18:45:53,356 [asp.py] => Task 0, Epoch 1 => Loss 1.603, Train_accy 61.60, Test_curr_accy 97.00, Test_accy 97.00
2025-01-10 18:47:01,917 [asp.py] => Task 0, Epoch 2 => Loss 0.667, Train_accy 89.93, Test_curr_accy 97.20, Test_accy 97.20
2025-01-10 18:48:10,620 [asp.py] => Task 0, Epoch 3 => Loss 0.583, Train_accy 91.45, Test_curr_accy 98.00, Test_accy 98.00
2025-01-10 18:48:12,471 [asp.py] => total parameters: 173607681
2025-01-10 18:48:12,472 [asp.py] => trainable parameters: 2010369
2025-01-10 18:48:13,972 [asp.py] => total parameters: 173607681
2025-01-10 18:48:13,973 [asp.py] => trainable parameters: 2010369
2025-01-10 18:48:21,395 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67]
2025-01-10 18:48:21,395 [trainer.py] => Average Accuracy (Top1): 12.223333333333334   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 18:48:21,396 [trainer.py] => All params: 173607681
2025-01-10 18:48:21,397 [trainer.py] => Trainable params: 2010369
2025-01-10 18:48:21,399 [asp.py] => Learning on 15-20
2025-01-10 18:48:21,410 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 18:48:23,266 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4]
2025-01-10 18:48:23,266 [trainer.py] => Average Accuracy (Top1): 91.3   (Harmonic Accuracy): 85.31551423590935 (Old Acc): 94.0 (New Acc): 78.1 

2025-01-10 18:48:23,267 [trainer.py] => All params: 173607681
2025-01-10 18:48:23,268 [trainer.py] => Trainable params: 2010369
2025-01-10 18:48:23,269 [asp.py] => Learning on 15-20
2025-01-10 18:48:23,279 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 18:49:19,307 [asp.py] => Task 0, Epoch 4 => Loss 0.465, Train_accy 92.15, Test_curr_accy 99.00, Test_accy 99.00
2025-01-10 18:50:27,771 [asp.py] => Task 0, Epoch 5 => Loss 0.388, Train_accy 92.95, Test_curr_accy 99.00, Test_accy 99.00
2025-01-10 18:51:36,331 [asp.py] => Task 0, Epoch 6 => Loss 0.375, Train_accy 93.09, Test_curr_accy 95.40, Test_accy 95.40
2025-01-10 18:52:44,597 [asp.py] => Task 0, Epoch 7 => Loss 0.282, Train_accy 94.55, Test_curr_accy 98.40, Test_accy 98.40
2025-01-10 18:53:52,892 [asp.py] => Task 0, Epoch 8 => Loss 0.274, Train_accy 94.36, Test_curr_accy 91.40, Test_accy 91.40
2025-01-10 18:54:42,609 [asp.py] => total parameters: 173626881
2025-01-10 18:54:42,610 [asp.py] => trainable parameters: 2029569
2025-01-10 18:55:01,679 [asp.py] => Task 0, Epoch 9 => Loss 0.239, Train_accy 94.87, Test_curr_accy 98.00, Test_accy 98.00
2025-01-10 18:55:02,795 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95]
2025-01-10 18:55:02,796 [trainer.py] => Average Accuracy (Top1): 77.64250000000001   (Harmonic Accuracy): 75.95713235294117 (Old Acc): 89.4 (New Acc): 66.02857142857142 

2025-01-10 18:55:02,797 [trainer.py] => All params: 173626881
2025-01-10 18:55:02,797 [trainer.py] => Trainable params: 2029569
2025-01-10 18:55:02,799 [asp.py] => Learning on 40-45
2025-01-10 18:55:02,827 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 18:56:10,595 [asp.py] => Task 0, Epoch 10 => Loss 0.229, Train_accy 95.24, Test_curr_accy 87.80, Test_accy 87.80
2025-01-10 18:56:38,012 [trainer.py] => Top1 curve: [99.2]
2025-01-10 18:56:38,012 [trainer.py] => Average Accuracy (Top1): 99.2   (Harmonic Accuracy): None (Old Acc): 99.2 (New Acc): [] 

2025-01-10 18:56:38,014 [trainer.py] => All params: 173600001
2025-01-10 18:56:38,014 [trainer.py] => Trainable params: 2002689
2025-01-10 18:56:38,016 [asp.py] => Learning on 5-10
2025-01-10 18:56:38,038 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:04:05,370 [asp.py] => total parameters: 173611521
2025-01-10 19:04:05,371 [asp.py] => trainable parameters: 2014209
2025-01-10 19:04:10,367 [asp.py] => total parameters: 173611521
2025-01-10 19:04:10,368 [asp.py] => trainable parameters: 2014209
2025-01-10 19:04:16,309 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55]
2025-01-10 19:04:16,310 [trainer.py] => Average Accuracy (Top1): 88.8625   (Harmonic Accuracy): 84.89614935822638 (Old Acc): 94.0 (New Acc): 77.39999999999999 

2025-01-10 19:04:16,311 [trainer.py] => All params: 173611521
2025-01-10 19:04:16,312 [trainer.py] => Trainable params: 2014209
2025-01-10 19:04:16,313 [asp.py] => Learning on 20-25
2025-01-10 19:04:16,329 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:04:20,740 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0]
2025-01-10 19:04:20,741 [trainer.py] => Average Accuracy (Top1): 10.4175   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 19:04:20,742 [trainer.py] => All params: 173611521
2025-01-10 19:04:20,742 [trainer.py] => Trainable params: 2014209
2025-01-10 19:04:20,744 [asp.py] => Learning on 20-25
2025-01-10 19:04:20,760 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:10:45,607 [asp.py] => total parameters: 173630721
2025-01-10 19:10:45,608 [asp.py] => trainable parameters: 2033409
2025-01-10 19:11:07,987 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87]
2025-01-10 19:11:07,988 [trainer.py] => Average Accuracy (Top1): 76.55666666666667   (Harmonic Accuracy): 75.11411841249188 (Old Acc): 88.4 (New Acc): 65.3 

2025-01-10 19:11:07,988 [trainer.py] => All params: 173630721
2025-01-10 19:11:07,989 [trainer.py] => Trainable params: 2033409
2025-01-10 19:11:07,990 [asp.py] => Learning on 45-50
2025-01-10 19:11:08,020 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:13:19,522 [asp.py] => total parameters: 173603841
2025-01-10 19:13:19,523 [asp.py] => trainable parameters: 2006529
2025-01-10 19:13:26,410 [trainer.py] => Top1 curve: [99.2, 97.6]
2025-01-10 19:13:26,410 [trainer.py] => Average Accuracy (Top1): 98.4   (Harmonic Accuracy): 97.58524590163935 (Old Acc): 98.8 (New Acc): 96.4 

2025-01-10 19:13:26,411 [trainer.py] => All params: 173603841
2025-01-10 19:13:26,412 [trainer.py] => Trainable params: 2006529
2025-01-10 19:13:26,413 [asp.py] => Learning on 10-15
2025-01-10 19:13:26,423 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:19:56,663 [asp.py] => total parameters: 173615361
2025-01-10 19:19:56,665 [asp.py] => trainable parameters: 2018049
2025-01-10 19:20:04,992 [asp.py] => total parameters: 173615361
2025-01-10 19:20:04,993 [asp.py] => trainable parameters: 2018049
2025-01-10 19:20:09,873 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84]
2025-01-10 19:20:09,873 [trainer.py] => Average Accuracy (Top1): 87.258   (Harmonic Accuracy): 84.93442240373396 (Old Acc): 93.8 (New Acc): 77.6 

2025-01-10 19:20:09,874 [trainer.py] => All params: 173615361
2025-01-10 19:20:09,875 [trainer.py] => Trainable params: 2018049
2025-01-10 19:20:09,876 [asp.py] => Learning on 25-30
2025-01-10 19:20:09,885 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:20:17,842 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0]
2025-01-10 19:20:17,843 [trainer.py] => Average Accuracy (Top1): 9.134   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 19:20:17,844 [trainer.py] => All params: 173615361
2025-01-10 19:20:17,844 [trainer.py] => Trainable params: 2018049
2025-01-10 19:20:17,846 [asp.py] => Learning on 25-30
2025-01-10 19:20:17,867 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:26:44,151 [asp.py] => total parameters: 173634561
2025-01-10 19:26:44,152 [asp.py] => trainable parameters: 2037249
2025-01-10 19:27:08,688 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87, 66.2]
2025-01-10 19:27:08,689 [trainer.py] => Average Accuracy (Top1): 75.52100000000002   (Harmonic Accuracy): 74.01164083065224 (Old Acc): 88.2 (New Acc): 63.75555555555556 

2025-01-10 19:27:08,690 [trainer.py] => All params: 173634561
2025-01-10 19:27:08,691 [trainer.py] => Trainable params: 2037249
2025-01-10 19:27:08,692 [asp.py] => Learning on 50-55
2025-01-10 19:27:08,714 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:30:08,883 [asp.py] => total parameters: 173607681
2025-01-10 19:30:08,884 [asp.py] => trainable parameters: 2010369
2025-01-10 19:30:18,151 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73]
2025-01-10 19:30:18,151 [trainer.py] => Average Accuracy (Top1): 95.84333333333335   (Harmonic Accuracy): 92.16311519740401 (Old Acc): 97.6 (New Acc): 87.30000000000001 

2025-01-10 19:30:18,152 [trainer.py] => All params: 173607681
2025-01-10 19:30:18,153 [trainer.py] => Trainable params: 2010369
2025-01-10 19:30:18,154 [asp.py] => Learning on 15-20
2025-01-10 19:30:18,166 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:36:01,620 [asp.py] => total parameters: 173619201
2025-01-10 19:36:01,621 [asp.py] => trainable parameters: 2021889
2025-01-10 19:36:11,311 [asp.py] => total parameters: 173619201
2025-01-10 19:36:11,312 [asp.py] => trainable parameters: 2021889
2025-01-10 19:36:15,963 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33]
2025-01-10 19:36:15,963 [trainer.py] => Average Accuracy (Top1): 8.166666666666666   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 19:36:15,964 [trainer.py] => All params: 173619201
2025-01-10 19:36:15,965 [trainer.py] => Trainable params: 2021889
2025-01-10 19:36:15,967 [asp.py] => Learning on 30-35
2025-01-10 19:36:15,988 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:36:31,189 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97]
2025-01-10 19:36:31,190 [trainer.py] => Average Accuracy (Top1): 85.37666666666667   (Harmonic Accuracy): 81.72226233453671 (Old Acc): 93.8 (New Acc): 72.4 

2025-01-10 19:36:31,191 [trainer.py] => All params: 173619201
2025-01-10 19:36:31,192 [trainer.py] => Trainable params: 2021889
2025-01-10 19:36:31,193 [asp.py] => Learning on 30-35
2025-01-10 19:36:31,221 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:42:45,942 [asp.py] => total parameters: 173638401
2025-01-10 19:42:45,943 [asp.py] => trainable parameters: 2041089
2025-01-10 19:43:12,917 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87, 66.2, 66.82]
2025-01-10 19:43:12,920 [trainer.py] => Average Accuracy (Top1): 74.73000000000002   (Harmonic Accuracy): 74.6889324447929 (Old Acc): 88.4 (New Acc): 64.66 

2025-01-10 19:43:12,921 [trainer.py] => All params: 173638401
2025-01-10 19:43:12,922 [trainer.py] => Trainable params: 2041089
2025-01-10 19:43:12,923 [asp.py] => Learning on 55-60
2025-01-10 19:43:12,941 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:47:00,270 [asp.py] => total parameters: 173611521
2025-01-10 19:47:00,271 [asp.py] => trainable parameters: 2014209
2025-01-10 19:47:12,065 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1]
2025-01-10 19:47:12,065 [trainer.py] => Average Accuracy (Top1): 93.9075   (Harmonic Accuracy): 90.77850877192982 (Old Acc): 97.4 (New Acc): 85.0 

2025-01-10 19:47:12,067 [trainer.py] => All params: 173611521
2025-01-10 19:47:12,067 [trainer.py] => Trainable params: 2014209
2025-01-10 19:47:12,069 [asp.py] => Learning on 20-25
2025-01-10 19:47:12,085 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:52:02,173 [asp.py] => total parameters: 173623041
2025-01-10 19:52:02,174 [asp.py] => trainable parameters: 2025729
2025-01-10 19:52:18,512 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86]
2025-01-10 19:52:18,512 [trainer.py] => Average Accuracy (Top1): 7.408571428571428   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 19:52:18,513 [trainer.py] => All params: 173623041
2025-01-10 19:52:18,514 [trainer.py] => Trainable params: 2025729
2025-01-10 19:52:18,515 [asp.py] => Learning on 35-40
2025-01-10 19:52:18,525 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:52:36,590 [asp.py] => total parameters: 173623041
2025-01-10 19:52:36,591 [asp.py] => trainable parameters: 2025729
2025-01-10 19:52:54,363 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86]
2025-01-10 19:52:54,363 [trainer.py] => Average Accuracy (Top1): 83.58857142857143   (Harmonic Accuracy): 79.34327497425336 (Old Acc): 92.2 (New Acc): 69.63333333333334 

2025-01-10 19:52:54,364 [trainer.py] => All params: 173623041
2025-01-10 19:52:54,365 [trainer.py] => Trainable params: 2025729
2025-01-10 19:52:54,366 [asp.py] => Learning on 35-40
2025-01-10 19:52:54,377 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 19:58:58,625 [asp.py] => total parameters: 173642241
2025-01-10 19:58:58,626 [asp.py] => trainable parameters: 2044929
2025-01-10 19:59:28,125 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87, 66.2, 66.82, 63.92]
2025-01-10 19:59:28,125 [trainer.py] => Average Accuracy (Top1): 73.82916666666668   (Harmonic Accuracy): 72.39127361365023 (Old Acc): 87.4 (New Acc): 61.781818181818196 

2025-01-10 19:59:28,126 [trainer.py] => All params: 173642241
2025-01-10 19:59:28,127 [trainer.py] => Trainable params: 2044929
2025-01-10 19:59:28,128 [asp.py] => Learning on 60-65
2025-01-10 19:59:28,145 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:03:56,268 [asp.py] => total parameters: 173615361
2025-01-10 20:03:56,269 [asp.py] => trainable parameters: 2018049
2025-01-10 20:04:10,589 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32]
2025-01-10 20:04:10,589 [trainer.py] => Average Accuracy (Top1): 92.59   (Harmonic Accuracy): 90.54755360087961 (Old Acc): 97.0 (New Acc): 84.9 

2025-01-10 20:04:10,591 [trainer.py] => All params: 173615361
2025-01-10 20:04:10,592 [trainer.py] => Trainable params: 2018049
2025-01-10 20:04:10,593 [asp.py] => Learning on 25-30
2025-01-10 20:04:10,608 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:08:03,776 [asp.py] => total parameters: 173626881
2025-01-10 20:08:03,777 [asp.py] => trainable parameters: 2029569
2025-01-10 20:08:22,210 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5]
2025-01-10 20:08:22,210 [trainer.py] => Average Accuracy (Top1): 6.795   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 20:08:22,211 [trainer.py] => All params: 173626881
2025-01-10 20:08:22,212 [trainer.py] => Trainable params: 2029569
2025-01-10 20:08:22,213 [asp.py] => Learning on 40-45
2025-01-10 20:08:22,240 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:08:35,897 [asp.py] => total parameters: 173626881
2025-01-10 20:08:35,898 [asp.py] => trainable parameters: 2029569
2025-01-10 20:08:55,899 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58]
2025-01-10 20:08:55,900 [trainer.py] => Average Accuracy (Top1): 82.0875   (Harmonic Accuracy): 78.13338121745377 (Old Acc): 90.2 (New Acc): 68.91428571428573 

2025-01-10 20:08:55,901 [trainer.py] => All params: 173626881
2025-01-10 20:08:55,901 [trainer.py] => Trainable params: 2029569
2025-01-10 20:08:55,902 [asp.py] => Learning on 40-45
2025-01-10 20:08:55,931 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:15:11,470 [asp.py] => total parameters: 173646081
2025-01-10 20:15:11,472 [asp.py] => trainable parameters: 2048769
2025-01-10 20:15:43,245 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87, 66.2, 66.82, 63.92, 61.92]
2025-01-10 20:15:43,245 [trainer.py] => Average Accuracy (Top1): 72.91307692307693   (Harmonic Accuracy): 71.06665158882731 (Old Acc): 87.6 (New Acc): 59.78333333333333 

2025-01-10 20:15:43,246 [trainer.py] => All params: 173646081
2025-01-10 20:15:43,247 [trainer.py] => Trainable params: 2048769
2025-01-10 20:15:43,248 [asp.py] => Learning on 65-70
2025-01-10 20:15:43,264 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:20:54,002 [asp.py] => total parameters: 173619201
2025-01-10 20:20:54,003 [asp.py] => trainable parameters: 2021889
2025-01-10 20:21:10,651 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33]
2025-01-10 20:21:10,651 [trainer.py] => Average Accuracy (Top1): 91.04666666666667   (Harmonic Accuracy): 87.86594399277327 (Old Acc): 96.4 (New Acc): 80.72 

2025-01-10 20:21:10,652 [trainer.py] => All params: 173619201
2025-01-10 20:21:10,652 [trainer.py] => Trainable params: 2021889
2025-01-10 20:21:10,654 [asp.py] => Learning on 30-35
2025-01-10 20:21:10,676 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:24:09,447 [asp.py] => total parameters: 173630721
2025-01-10 20:24:09,448 [asp.py] => trainable parameters: 2033409
2025-01-10 20:24:30,012 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5, 2.22]
2025-01-10 20:24:30,012 [trainer.py] => Average Accuracy (Top1): 6.286666666666666   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 20:24:30,013 [trainer.py] => All params: 173630721
2025-01-10 20:24:30,014 [trainer.py] => Trainable params: 2033409
2025-01-10 20:24:30,015 [asp.py] => Learning on 45-50
2025-01-10 20:24:30,043 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:24:39,131 [asp.py] => total parameters: 173630721
2025-01-10 20:24:39,132 [asp.py] => trainable parameters: 2033409
2025-01-10 20:25:01,390 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58, 71.18]
2025-01-10 20:25:01,390 [trainer.py] => Average Accuracy (Top1): 80.87555555555556   (Harmonic Accuracy): 77.94175858808698 (Old Acc): 89.8 (New Acc): 68.85000000000001 

2025-01-10 20:25:01,391 [trainer.py] => All params: 173630721
2025-01-10 20:25:01,392 [trainer.py] => Trainable params: 2033409
2025-01-10 20:25:01,393 [asp.py] => Learning on 45-50
2025-01-10 20:25:01,424 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:31:25,979 [asp.py] => total parameters: 173649921
2025-01-10 20:31:25,980 [asp.py] => trainable parameters: 2052609
2025-01-10 20:32:02,644 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87, 66.2, 66.82, 63.92, 61.92, 61.37]
2025-01-10 20:32:02,644 [trainer.py] => Average Accuracy (Top1): 72.08857142857144   (Harmonic Accuracy): 70.48794774546985 (Old Acc): 86.6 (New Acc): 59.43076923076923 

2025-01-10 20:32:02,645 [trainer.py] => All params: 173649921
2025-01-10 20:32:02,646 [trainer.py] => Trainable params: 2052609
2025-01-10 20:32:02,647 [asp.py] => Learning on 70-75
2025-01-10 20:32:02,662 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:37:55,435 [asp.py] => total parameters: 173623041
2025-01-10 20:37:55,436 [asp.py] => trainable parameters: 2025729
2025-01-10 20:38:14,904 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8]
2025-01-10 20:38:14,904 [trainer.py] => Average Accuracy (Top1): 89.72571428571428   (Harmonic Accuracy): 87.05799355205765 (Old Acc): 96.4 (New Acc): 79.36666666666667 

2025-01-10 20:38:14,906 [trainer.py] => All params: 173623041
2025-01-10 20:38:14,907 [trainer.py] => Trainable params: 2025729
2025-01-10 20:38:14,908 [asp.py] => Learning on 35-40
2025-01-10 20:38:14,921 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:40:17,063 [asp.py] => total parameters: 173634561
2025-01-10 20:40:17,064 [asp.py] => trainable parameters: 2037249
2025-01-10 20:40:40,113 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5, 2.22, 2.0]
2025-01-10 20:40:40,113 [trainer.py] => Average Accuracy (Top1): 5.858   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 20:40:40,114 [trainer.py] => All params: 173634561
2025-01-10 20:40:40,115 [trainer.py] => Trainable params: 2037249
2025-01-10 20:40:40,117 [asp.py] => Learning on 50-55
2025-01-10 20:40:40,134 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:40:44,501 [asp.py] => total parameters: 173634561
2025-01-10 20:40:44,501 [asp.py] => trainable parameters: 2037249
2025-01-10 20:41:09,067 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58, 71.18, 69.48]
2025-01-10 20:41:09,068 [trainer.py] => Average Accuracy (Top1): 79.73600000000002   (Harmonic Accuracy): 76.94656488549619 (Old Acc): 90.0 (New Acc): 67.2 

2025-01-10 20:41:09,069 [trainer.py] => All params: 173634561
2025-01-10 20:41:09,069 [trainer.py] => Trainable params: 2037249
2025-01-10 20:41:09,071 [asp.py] => Learning on 50-55
2025-01-10 20:41:09,082 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:47:42,905 [asp.py] => total parameters: 173653761
2025-01-10 20:47:42,906 [asp.py] => trainable parameters: 2056449
2025-01-10 20:48:19,130 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87, 66.2, 66.82, 63.92, 61.92, 61.37, 59.91]
2025-01-10 20:48:19,130 [trainer.py] => Average Accuracy (Top1): 71.27666666666667   (Harmonic Accuracy): 69.1983692950184 (Old Acc): 85.6 (New Acc): 58.07142857142858 

2025-01-10 20:48:19,131 [trainer.py] => All params: 173653761
2025-01-10 20:48:19,132 [trainer.py] => Trainable params: 2056449
2025-01-10 20:48:19,133 [asp.py] => Learning on 75-80
2025-01-10 20:48:19,150 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:54:57,550 [asp.py] => total parameters: 173626881
2025-01-10 20:54:57,552 [asp.py] => trainable parameters: 2029569
2025-01-10 20:55:19,709 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18]
2025-01-10 20:55:19,710 [trainer.py] => Average Accuracy (Top1): 88.5325   (Harmonic Accuracy): 85.57035566583953 (Old Acc): 94.6 (New Acc): 78.11428571428571 

2025-01-10 20:55:19,711 [trainer.py] => All params: 173626881
2025-01-10 20:55:19,711 [trainer.py] => Trainable params: 2029569
2025-01-10 20:55:19,713 [asp.py] => Learning on 40-45
2025-01-10 20:55:19,745 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:56:26,367 [asp.py] => total parameters: 173638401
2025-01-10 20:56:26,367 [asp.py] => trainable parameters: 2041089
2025-01-10 20:56:51,396 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5, 2.22, 2.0, 1.82]
2025-01-10 20:56:51,396 [trainer.py] => Average Accuracy (Top1): 5.490909090909091   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 20:56:51,397 [trainer.py] => All params: 173638401
2025-01-10 20:56:51,398 [trainer.py] => Trainable params: 2041089
2025-01-10 20:56:51,399 [asp.py] => Learning on 55-60
2025-01-10 20:56:51,406 [asp.py] => total parameters: 173638401
2025-01-10 20:56:51,407 [asp.py] => trainable parameters: 2041089
2025-01-10 20:56:51,434 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 20:57:18,283 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58, 71.18, 69.48, 69.84]
2025-01-10 20:57:18,284 [trainer.py] => Average Accuracy (Top1): 78.83636363636366   (Harmonic Accuracy): 77.1677517802645 (Old Acc): 89.4 (New Acc): 67.88000000000001 

2025-01-10 20:57:18,285 [trainer.py] => All params: 173638401
2025-01-10 20:57:18,285 [trainer.py] => Trainable params: 2041089
2025-01-10 20:57:18,287 [asp.py] => Learning on 55-60
2025-01-10 20:57:18,299 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:03:59,317 [asp.py] => total parameters: 173657601
2025-01-10 21:03:59,318 [asp.py] => trainable parameters: 2060289
2025-01-10 21:04:38,350 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87, 66.2, 66.82, 63.92, 61.92, 61.37, 59.91, 59.98]
2025-01-10 21:04:38,350 [trainer.py] => Average Accuracy (Top1): 70.570625   (Harmonic Accuracy): 69.33679332715477 (Old Acc): 85.6 (New Acc): 58.266666666666666 

2025-01-10 21:04:38,351 [trainer.py] => All params: 173657601
2025-01-10 21:04:38,352 [trainer.py] => Trainable params: 2060289
2025-01-10 21:04:38,353 [asp.py] => Learning on 80-85
2025-01-10 21:04:38,371 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:11:54,024 [asp.py] => total parameters: 173630721
2025-01-10 21:11:54,025 [asp.py] => trainable parameters: 2033409
2025-01-10 21:12:18,394 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8]
2025-01-10 21:12:18,394 [trainer.py] => Average Accuracy (Top1): 87.4511111111111   (Harmonic Accuracy): 84.66023673827269 (Old Acc): 94.2 (New Acc): 76.875 

2025-01-10 21:12:18,395 [trainer.py] => All params: 173630721
2025-01-10 21:12:18,396 [trainer.py] => Trainable params: 2033409
2025-01-10 21:12:18,397 [asp.py] => Learning on 45-50
2025-01-10 21:12:18,427 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:12:38,130 [asp.py] => total parameters: 173642241
2025-01-10 21:12:38,131 [asp.py] => trainable parameters: 2044929
2025-01-10 21:13:00,093 [asp.py] => total parameters: 173642241
2025-01-10 21:13:00,094 [asp.py] => trainable parameters: 2044929
2025-01-10 21:13:05,192 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5, 2.22, 2.0, 1.82, 1.67]
2025-01-10 21:13:05,193 [trainer.py] => Average Accuracy (Top1): 5.1725   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 21:13:05,194 [trainer.py] => All params: 173642241
2025-01-10 21:13:05,195 [trainer.py] => Trainable params: 2044929
2025-01-10 21:13:05,197 [asp.py] => Learning on 60-65
2025-01-10 21:13:05,212 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:13:29,501 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58, 71.18, 69.48, 69.84, 67.72]
2025-01-10 21:13:29,502 [trainer.py] => Average Accuracy (Top1): 77.91000000000001   (Harmonic Accuracy): 75.64947727005756 (Old Acc): 89.0 (New Acc): 65.78181818181818 

2025-01-10 21:13:29,503 [trainer.py] => All params: 173642241
2025-01-10 21:13:29,503 [trainer.py] => Trainable params: 2044929
2025-01-10 21:13:29,505 [asp.py] => Learning on 60-65
2025-01-10 21:13:29,518 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:20:15,290 [asp.py] => total parameters: 173661441
2025-01-10 21:20:15,291 [asp.py] => trainable parameters: 2064129
2025-01-10 21:20:56,389 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87, 66.2, 66.82, 63.92, 61.92, 61.37, 59.91, 59.98, 59.33]
2025-01-10 21:20:56,390 [trainer.py] => Average Accuracy (Top1): 69.90941176470588   (Harmonic Accuracy): 68.75634962340165 (Old Acc): 85.0 (New Acc): 57.725 

2025-01-10 21:20:56,390 [trainer.py] => All params: 173661441
2025-01-10 21:20:56,391 [trainer.py] => Trainable params: 2064129
2025-01-10 21:20:56,393 [asp.py] => Learning on 85-90
2025-01-10 21:20:56,437 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:28:51,904 [asp.py] => total parameters: 173634561
2025-01-10 21:28:51,905 [asp.py] => trainable parameters: 2037249
2025-01-10 21:28:53,972 [asp.py] => total parameters: 173646081
2025-01-10 21:28:53,974 [asp.py] => trainable parameters: 2048769
2025-01-10 21:29:12,109 [asp.py] => total parameters: 173646081
2025-01-10 21:29:12,110 [asp.py] => trainable parameters: 2048769
2025-01-10 21:29:22,165 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04]
2025-01-10 21:29:22,165 [trainer.py] => Average Accuracy (Top1): 86.41   (Harmonic Accuracy): 83.5932283464567 (Old Acc): 94.2 (New Acc): 75.13333333333334 

2025-01-10 21:29:22,167 [trainer.py] => All params: 173634561
2025-01-10 21:29:22,167 [trainer.py] => Trainable params: 2037249
2025-01-10 21:29:22,169 [asp.py] => Learning on 50-55
2025-01-10 21:29:22,181 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:29:27,786 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5, 2.22, 2.0, 1.82, 1.67, 1.54]
2025-01-10 21:29:27,786 [trainer.py] => Average Accuracy (Top1): 4.893076923076923   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 21:29:27,788 [trainer.py] => All params: 173646081
2025-01-10 21:29:27,788 [trainer.py] => Trainable params: 2048769
2025-01-10 21:29:27,790 [asp.py] => Learning on 65-70
2025-01-10 21:29:27,818 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:29:47,335 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58, 71.18, 69.48, 69.84, 67.72, 65.35]
2025-01-10 21:29:47,336 [trainer.py] => Average Accuracy (Top1): 76.94384615384617   (Harmonic Accuracy): 73.98055190538766 (Old Acc): 88.8 (New Acc): 63.4 

2025-01-10 21:29:47,336 [trainer.py] => All params: 173646081
2025-01-10 21:29:47,337 [trainer.py] => Trainable params: 2048769
2025-01-10 21:29:47,339 [asp.py] => Learning on 65-70
2025-01-10 21:29:47,351 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:36:36,093 [asp.py] => total parameters: 173665281
2025-01-10 21:36:36,095 [asp.py] => trainable parameters: 2067969
2025-01-10 21:37:19,019 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87, 66.2, 66.82, 63.92, 61.92, 61.37, 59.91, 59.98, 59.33, 58.92]
2025-01-10 21:37:19,019 [trainer.py] => Average Accuracy (Top1): 69.2988888888889   (Harmonic Accuracy): 68.34614682704272 (Old Acc): 84.4 (New Acc): 57.42352941176471 

2025-01-10 21:37:19,020 [trainer.py] => All params: 173665281
2025-01-10 21:37:19,021 [trainer.py] => Trainable params: 2067969
2025-01-10 21:37:19,023 [asp.py] => Learning on 90-95
2025-01-10 21:37:19,051 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:45:16,579 [asp.py] => total parameters: 173649921
2025-01-10 21:45:16,580 [asp.py] => trainable parameters: 2052609
2025-01-10 21:45:29,872 [asp.py] => total parameters: 173649921
2025-01-10 21:45:29,873 [asp.py] => trainable parameters: 2052609
2025-01-10 21:45:48,661 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5, 2.22, 2.0, 1.82, 1.67, 1.54, 1.43]
2025-01-10 21:45:48,662 [trainer.py] => Average Accuracy (Top1): 4.645714285714286   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 21:45:48,664 [trainer.py] => All params: 173649921
2025-01-10 21:45:48,665 [trainer.py] => Trainable params: 2052609
2025-01-10 21:45:48,667 [asp.py] => Learning on 70-75
2025-01-10 21:45:48,705 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:45:55,747 [asp.py] => total parameters: 173638401
2025-01-10 21:45:55,748 [asp.py] => trainable parameters: 2041089
2025-01-10 21:46:03,882 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58, 71.18, 69.48, 69.84, 67.72, 65.35, 65.07]
2025-01-10 21:46:03,882 [trainer.py] => Average Accuracy (Top1): 76.0957142857143   (Harmonic Accuracy): 73.81687772262183 (Old Acc): 88.6 (New Acc): 63.26153846153847 

2025-01-10 21:46:03,883 [trainer.py] => All params: 173649921
2025-01-10 21:46:03,884 [trainer.py] => Trainable params: 2052609
2025-01-10 21:46:03,886 [asp.py] => Learning on 70-75
2025-01-10 21:46:03,901 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:46:24,936 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84]
2025-01-10 21:46:24,937 [trainer.py] => Average Accuracy (Top1): 85.53999999999999   (Harmonic Accuracy): 83.37255273761555 (Old Acc): 93.6 (New Acc): 75.16 

2025-01-10 21:46:24,938 [trainer.py] => All params: 173638401
2025-01-10 21:46:24,939 [trainer.py] => Trainable params: 2041089
2025-01-10 21:46:24,940 [asp.py] => Learning on 55-60
2025-01-10 21:46:24,953 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 21:51:53,378 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 21:51:53,378 [trainer.py] => model_name: asp
2025-01-10 21:51:53,378 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 21:51:53,378 [trainer.py] => device: ['cuda']
2025-01-10 21:51:53,378 [trainer.py] => seed: 2024
2025-01-10 21:51:53,378 [trainer.py] => dataset: cifar224
2025-01-10 21:51:53,378 [trainer.py] => init_cls: 5
2025-01-10 21:51:53,378 [trainer.py] => increment: 5
2025-01-10 21:51:53,378 [trainer.py] => kshot: 5
2025-01-10 21:51:53,378 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 21:51:53,379 [trainer.py] => z_dim: 1000
2025-01-10 21:51:53,379 [trainer.py] => conv_dim: 64
2025-01-10 21:51:53,379 [trainer.py] => img_size: 224
2025-01-10 21:51:53,379 [trainer.py] => generator_lr: 0.005
2025-01-10 21:51:53,379 [trainer.py] => pi: 100
2025-01-10 21:51:53,379 [trainer.py] => w_bn: 50.0
2025-01-10 21:51:53,379 [trainer.py] => w_noise: 0.001
2025-01-10 21:51:53,379 [trainer.py] => server_ss: 32
2025-01-10 21:51:53,379 [trainer.py] => bn_loss: 1
2025-01-10 21:51:53,379 [trainer.py] => noise: 1
2025-01-10 21:51:53,379 [trainer.py] => ie_loss: 1
2025-01-10 21:51:53,379 [trainer.py] => act_loss: 0
2025-01-10 21:51:53,379 [trainer.py] => w_ie: 1.0
2025-01-10 21:51:53,379 [trainer.py] => w_act: 0.1
2025-01-10 21:51:53,379 [trainer.py] => syn_size: 32
2025-01-10 21:51:53,379 [trainer.py] => need_syn_imgs: True
2025-01-10 21:51:53,379 [trainer.py] => g_local_bs: 5
2025-01-10 21:51:53,379 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 21:51:53,379 [trainer.py] => g_local_train_steps: 5
2025-01-10 21:51:53,379 [trainer.py] => dataset_syn: cifar100
2025-01-10 21:51:53,379 [trainer.py] => com_round_gen: 10
2025-01-10 21:51:53,379 [trainer.py] => g_sigma: 0
2025-01-10 21:51:53,379 [trainer.py] => save_cls_embeds: False
2025-01-10 21:51:53,379 [trainer.py] => syn_image_path: outputs/syn_image_5_5_local_bs0
2025-01-10 21:51:53,379 [trainer.py] => save_dir: outputs
2025-01-10 21:51:53,379 [trainer.py] => n_iter: 5
2025-01-10 21:51:53,379 [trainer.py] => num_users: 1
2025-01-10 21:51:53,380 [trainer.py] => cur_size: 50
2025-01-10 21:51:53,380 [trainer.py] => local_bs: 50
2025-01-10 21:51:53,380 [trainer.py] => pre_size: 48
2025-01-10 21:51:53,380 [trainer.py] => w_ce_pre: 0.3
2025-01-10 21:51:53,380 [trainer.py] => vpt_type: Deep
2025-01-10 21:51:53,380 [trainer.py] => prompt_token_num: 6
2025-01-10 21:51:53,380 [trainer.py] => avg_alpha: 0.8
2025-01-10 21:51:53,380 [trainer.py] => perturb_var: 1
2025-01-10 21:51:53,380 [trainer.py] => EMA_beta: 0.99
2025-01-10 21:51:53,380 [trainer.py] => anchor_lambda: 0.1
2025-01-10 21:51:53,380 [trainer.py] => kl_weight: 0.001
2025-01-10 21:51:53,380 [trainer.py] => TIP_init: zero
2025-01-10 21:51:53,380 [trainer.py] => tuned_epoch: 10
2025-01-10 21:51:53,380 [trainer.py] => fs_epoch: 0
2025-01-10 21:51:53,380 [trainer.py] => init_lr: 0.01
2025-01-10 21:51:53,380 [trainer.py] => fs_lr: 0.001
2025-01-10 21:51:53,380 [trainer.py] => batch_size: 48
2025-01-10 21:51:53,380 [trainer.py] => fs_batch_size: 16
2025-01-10 21:51:53,380 [trainer.py] => weight_decay: 0.0005
2025-01-10 21:51:53,380 [trainer.py] => min_lr: 0
2025-01-10 21:51:53,380 [trainer.py] => optimizer: sgd
2025-01-10 21:51:53,380 [trainer.py] => memory_size: 0
2025-01-10 21:51:53,380 [trainer.py] => memory_per_class: 0
2025-01-10 21:51:53,380 [trainer.py] => fixed_memory: False
2025-01-10 21:51:53,380 [trainer.py] => shuffle: False
2025-01-10 21:51:53,380 [trainer.py] => top_k: 5
2025-01-10 21:51:53,380 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 21:51:53,380 [trainer.py] => prefix: asp
2025-01-10 21:51:53,380 [trainer.py] => model_prefix: asp
2025-01-10 21:51:55,035 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 21:52:04,022 [trainer.py] => All params: 173596160
2025-01-10 21:52:04,023 [trainer.py] => Trainable params: 1998848
2025-01-10 21:52:21,906 [asp.py] => Learning on 0-5
2025-01-10 21:52:21,911 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 21:53:00,181 [asp.py] => total parameters: 173669121
2025-01-10 21:53:00,182 [asp.py] => trainable parameters: 2071809
2025-01-10 21:53:45,964 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87, 66.2, 66.82, 63.92, 61.92, 61.37, 59.91, 59.98, 59.33, 58.92, 58.32]
2025-01-10 21:53:45,964 [trainer.py] => Average Accuracy (Top1): 68.72105263157896   (Harmonic Accuracy): 67.95016517225106 (Old Acc): 84.4 (New Acc): 56.86666666666666 

2025-01-10 21:53:45,965 [trainer.py] => All params: 173669121
2025-01-10 21:53:45,966 [trainer.py] => Trainable params: 2071809
2025-01-10 21:53:45,967 [asp.py] => Learning on 95-100
2025-01-10 21:53:46,030 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:01:38,594 [asp.py] => total parameters: 173653761
2025-01-10 22:01:38,595 [asp.py] => trainable parameters: 2056449
2025-01-10 22:01:45,815 [asp.py] => total parameters: 173653761
2025-01-10 22:01:45,816 [asp.py] => trainable parameters: 2056449
2025-01-10 22:02:12,959 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5, 2.22, 2.0, 1.82, 1.67, 1.54, 1.43, 1.33]
2025-01-10 22:02:12,960 [trainer.py] => Average Accuracy (Top1): 4.424666666666667   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 22:02:12,961 [trainer.py] => All params: 173653761
2025-01-10 22:02:12,962 [trainer.py] => Trainable params: 2056449
2025-01-10 22:02:12,964 [asp.py] => Learning on 75-80
2025-01-10 22:02:12,986 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:02:21,952 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58, 71.18, 69.48, 69.84, 67.72, 65.35, 65.07, 63.55]
2025-01-10 22:02:21,952 [trainer.py] => Average Accuracy (Top1): 75.25933333333334   (Harmonic Accuracy): 72.7248097412481 (Old Acc): 88.4 (New Acc): 61.771428571428565 

2025-01-10 22:02:21,953 [trainer.py] => All params: 173653761
2025-01-10 22:02:21,954 [trainer.py] => Trainable params: 2056449
2025-01-10 22:02:21,955 [asp.py] => Learning on 75-80
2025-01-10 22:02:21,971 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:03:07,608 [asp.py] => total parameters: 173642241
2025-01-10 22:03:07,609 [asp.py] => trainable parameters: 2044929
2025-01-10 22:03:38,877 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84, 75.6]
2025-01-10 22:03:38,878 [trainer.py] => Average Accuracy (Top1): 84.71166666666666   (Harmonic Accuracy): 82.5645448620465 (Old Acc): 93.4 (New Acc): 73.98181818181818 

2025-01-10 22:03:38,879 [trainer.py] => All params: 173642241
2025-01-10 22:03:38,880 [trainer.py] => Trainable params: 2044929
2025-01-10 22:03:38,881 [asp.py] => Learning on 60-65
2025-01-10 22:03:38,897 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:07:41,646 [asp.py] => total parameters: 173600001
2025-01-10 22:07:41,647 [asp.py] => trainable parameters: 2002689
2025-01-10 22:08:45,460 [asp.py] => Task 0, Epoch 1 => Loss 5.330, Train_accy 42.58, Test_curr_accy 78.80, Test_accy 78.80
2025-01-10 22:09:25,837 [asp.py] => total parameters: 173672961
2025-01-10 22:09:25,837 [asp.py] => trainable parameters: 2075649
2025-01-10 22:09:48,378 [asp.py] => Task 0, Epoch 2 => Loss 1.234, Train_accy 79.09, Test_curr_accy 96.00, Test_accy 96.00
2025-01-10 22:10:13,861 [trainer.py] => Top1 curve: [95.4, 89.9, 77.6, 76.6, 74.8, 69.43, 68.46, 68.95, 67.87, 66.2, 66.82, 63.92, 61.92, 61.37, 59.91, 59.98, 59.33, 58.92, 58.32, 57.06]
2025-01-10 22:10:13,861 [trainer.py] => Average Accuracy (Top1): 68.138   (Harmonic Accuracy): 66.9416553595658 (Old Acc): 84.0 (New Acc): 55.64210526315789 

2025-01-10 22:10:13,861 [trainer.py] => 

2025-01-10 22:10:51,148 [asp.py] => Task 0, Epoch 3 => Loss 1.488, Train_accy 58.36, Test_curr_accy 77.40, Test_accy 77.40
2025-01-10 22:11:55,070 [asp.py] => Task 0, Epoch 4 => Loss 1.100, Train_accy 79.09, Test_curr_accy 91.60, Test_accy 91.60
2025-01-10 22:12:59,793 [asp.py] => Task 0, Epoch 5 => Loss 0.913, Train_accy 84.91, Test_curr_accy 94.00, Test_accy 94.00
2025-01-10 22:14:04,230 [asp.py] => Task 0, Epoch 6 => Loss 0.965, Train_accy 83.75, Test_curr_accy 89.00, Test_accy 89.00
2025-01-10 22:15:08,575 [asp.py] => Task 0, Epoch 7 => Loss 1.141, Train_accy 78.73, Test_curr_accy 84.80, Test_accy 84.80
2025-01-10 22:15:45,192 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 22:15:45,193 [trainer.py] => model_name: asp
2025-01-10 22:15:45,193 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 22:15:45,193 [trainer.py] => device: ['cuda']
2025-01-10 22:15:45,193 [trainer.py] => seed: 2024
2025-01-10 22:15:45,193 [trainer.py] => dataset: cifar224
2025-01-10 22:15:45,193 [trainer.py] => init_cls: 5
2025-01-10 22:15:45,193 [trainer.py] => increment: 5
2025-01-10 22:15:45,193 [trainer.py] => kshot: 5
2025-01-10 22:15:45,193 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 22:15:45,193 [trainer.py] => z_dim: 1000
2025-01-10 22:15:45,193 [trainer.py] => conv_dim: 64
2025-01-10 22:15:45,193 [trainer.py] => img_size: 224
2025-01-10 22:15:45,193 [trainer.py] => generator_lr: 0.005
2025-01-10 22:15:45,193 [trainer.py] => pi: 100
2025-01-10 22:15:45,193 [trainer.py] => w_bn: 50.0
2025-01-10 22:15:45,193 [trainer.py] => w_noise: 0.001
2025-01-10 22:15:45,193 [trainer.py] => server_ss: 32
2025-01-10 22:15:45,193 [trainer.py] => bn_loss: 1
2025-01-10 22:15:45,193 [trainer.py] => noise: 1
2025-01-10 22:15:45,193 [trainer.py] => ie_loss: 1
2025-01-10 22:15:45,193 [trainer.py] => act_loss: 0
2025-01-10 22:15:45,193 [trainer.py] => w_ie: 1.0
2025-01-10 22:15:45,193 [trainer.py] => w_act: 0.1
2025-01-10 22:15:45,193 [trainer.py] => syn_size: 32
2025-01-10 22:15:45,193 [trainer.py] => need_syn_imgs: True
2025-01-10 22:15:45,193 [trainer.py] => g_local_bs: 5
2025-01-10 22:15:45,193 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 22:15:45,194 [trainer.py] => g_local_train_steps: 5
2025-01-10 22:15:45,194 [trainer.py] => dataset_syn: cifar100
2025-01-10 22:15:45,194 [trainer.py] => com_round_gen: 10
2025-01-10 22:15:45,194 [trainer.py] => g_sigma: 0
2025-01-10 22:15:45,194 [trainer.py] => save_cls_embeds: False
2025-01-10 22:15:45,194 [trainer.py] => syn_image_path: outputs/syn_image_5_5_local_bs5
2025-01-10 22:15:45,194 [trainer.py] => save_dir: outputs
2025-01-10 22:15:45,194 [trainer.py] => n_iter: 5
2025-01-10 22:15:45,194 [trainer.py] => num_users: 1
2025-01-10 22:15:45,194 [trainer.py] => cur_size: 50
2025-01-10 22:15:45,194 [trainer.py] => local_bs: 5
2025-01-10 22:15:45,194 [trainer.py] => pre_size: 48
2025-01-10 22:15:45,194 [trainer.py] => w_ce_pre: 0.3
2025-01-10 22:15:45,194 [trainer.py] => vpt_type: Deep
2025-01-10 22:15:45,194 [trainer.py] => prompt_token_num: 6
2025-01-10 22:15:45,194 [trainer.py] => avg_alpha: 0.8
2025-01-10 22:15:45,194 [trainer.py] => perturb_var: 1
2025-01-10 22:15:45,194 [trainer.py] => EMA_beta: 0.99
2025-01-10 22:15:45,194 [trainer.py] => anchor_lambda: 0.1
2025-01-10 22:15:45,194 [trainer.py] => kl_weight: 0.001
2025-01-10 22:15:45,194 [trainer.py] => TIP_init: zero
2025-01-10 22:15:45,194 [trainer.py] => tuned_epoch: 10
2025-01-10 22:15:45,194 [trainer.py] => fs_epoch: 0
2025-01-10 22:15:45,194 [trainer.py] => init_lr: 0.01
2025-01-10 22:15:45,194 [trainer.py] => fs_lr: 0.001
2025-01-10 22:15:45,194 [trainer.py] => batch_size: 48
2025-01-10 22:15:45,194 [trainer.py] => fs_batch_size: 16
2025-01-10 22:15:45,194 [trainer.py] => weight_decay: 0.0005
2025-01-10 22:15:45,194 [trainer.py] => min_lr: 0
2025-01-10 22:15:45,194 [trainer.py] => optimizer: sgd
2025-01-10 22:15:45,194 [trainer.py] => memory_size: 0
2025-01-10 22:15:45,194 [trainer.py] => memory_per_class: 0
2025-01-10 22:15:45,195 [trainer.py] => fixed_memory: False
2025-01-10 22:15:45,195 [trainer.py] => shuffle: False
2025-01-10 22:15:45,195 [trainer.py] => top_k: 5
2025-01-10 22:15:45,195 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 22:15:45,195 [trainer.py] => prefix: asp
2025-01-10 22:15:45,195 [trainer.py] => model_prefix: asp
2025-01-10 22:15:46,650 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 22:15:55,631 [trainer.py] => All params: 173596160
2025-01-10 22:15:55,633 [trainer.py] => Trainable params: 1998848
2025-01-10 22:16:13,200 [asp.py] => Task 0, Epoch 8 => Loss 0.861, Train_accy 87.05, Test_curr_accy 93.00, Test_accy 93.00
2025-01-10 22:16:19,317 [asp.py] => Learning on 0-5
2025-01-10 22:16:19,324 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 22:17:17,691 [asp.py] => Task 0, Epoch 9 => Loss 0.925, Train_accy 85.45, Test_curr_accy 67.00, Test_accy 67.00
2025-01-10 22:18:06,062 [asp.py] => total parameters: 173657601
2025-01-10 22:18:06,063 [asp.py] => trainable parameters: 2060289
2025-01-10 22:18:06,437 [asp.py] => total parameters: 173657601
2025-01-10 22:18:06,438 [asp.py] => trainable parameters: 2060289
2025-01-10 22:18:21,922 [asp.py] => Task 0, Epoch 10 => Loss 1.139, Train_accy 80.29, Test_curr_accy 93.40, Test_accy 93.40
2025-01-10 22:18:48,475 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5, 2.22, 2.0, 1.82, 1.67, 1.54, 1.43, 1.33, 1.25]
2025-01-10 22:18:48,476 [trainer.py] => Average Accuracy (Top1): 4.22625   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 22:18:48,478 [trainer.py] => All params: 173657601
2025-01-10 22:18:48,479 [trainer.py] => Trainable params: 2060289
2025-01-10 22:18:48,482 [asp.py] => Learning on 80-85
2025-01-10 22:18:48,507 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:18:49,392 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58, 71.18, 69.48, 69.84, 67.72, 65.35, 65.07, 63.55, 63.85]
2025-01-10 22:18:49,393 [trainer.py] => Average Accuracy (Top1): 74.54625   (Harmonic Accuracy): 73.03016997167138 (Old Acc): 88.4 (New Acc): 62.21333333333333 

2025-01-10 22:18:49,394 [trainer.py] => All params: 173657601
2025-01-10 22:18:49,395 [trainer.py] => Trainable params: 2060289
2025-01-10 22:18:49,397 [asp.py] => Learning on 80-85
2025-01-10 22:18:49,417 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:18:49,810 [trainer.py] => Top1 curve: [88.8]
2025-01-10 22:18:49,811 [trainer.py] => Average Accuracy (Top1): 88.8   (Harmonic Accuracy): None (Old Acc): 88.8 (New Acc): [] 

2025-01-10 22:18:49,812 [trainer.py] => All params: 173600001
2025-01-10 22:18:49,813 [trainer.py] => Trainable params: 2002689
2025-01-10 22:19:08,273 [asp.py] => Learning on 5-10
2025-01-10 22:19:08,282 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:20:25,007 [asp.py] => total parameters: 173646081
2025-01-10 22:20:25,007 [asp.py] => trainable parameters: 2048769
2025-01-10 22:20:58,892 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84, 75.6, 74.35]
2025-01-10 22:20:58,892 [trainer.py] => Average Accuracy (Top1): 83.91461538461537   (Harmonic Accuracy): 81.73599759011948 (Old Acc): 93.2 (New Acc): 72.78333333333332 

2025-01-10 22:20:58,893 [trainer.py] => All params: 173646081
2025-01-10 22:20:58,894 [trainer.py] => Trainable params: 2048769
2025-01-10 22:20:58,896 [asp.py] => Learning on 65-70
2025-01-10 22:20:58,938 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:31:45,745 [asp.py] => total parameters: 173600001
2025-01-10 22:31:45,746 [asp.py] => trainable parameters: 2002689
2025-01-10 22:32:52,536 [asp.py] => Task 0, Epoch 1 => Loss 1.662, Train_accy 60.69, Test_curr_accy 98.20, Test_accy 98.20
2025-01-10 22:33:57,120 [asp.py] => Task 0, Epoch 2 => Loss 0.666, Train_accy 89.89, Test_curr_accy 98.60, Test_accy 98.60
2025-01-10 22:34:30,525 [asp.py] => total parameters: 173603841
2025-01-10 22:34:30,526 [asp.py] => trainable parameters: 2006529
2025-01-10 22:34:31,230 [asp.py] => total parameters: 173661441
2025-01-10 22:34:31,230 [asp.py] => trainable parameters: 2064129
2025-01-10 22:34:37,128 [trainer.py] => Top1 curve: [88.8, 63.8]
2025-01-10 22:34:37,128 [trainer.py] => Average Accuracy (Top1): 76.3   (Harmonic Accuracy): 57.6551724137931 (Old Acc): 83.6 (New Acc): 44.0 

2025-01-10 22:34:37,129 [trainer.py] => All params: 173603841
2025-01-10 22:34:37,130 [trainer.py] => Trainable params: 2006529
2025-01-10 22:34:38,236 [asp.py] => total parameters: 173661441
2025-01-10 22:34:38,238 [asp.py] => trainable parameters: 2064129
2025-01-10 22:35:02,246 [asp.py] => Task 0, Epoch 3 => Loss 0.629, Train_accy 91.71, Test_curr_accy 97.40, Test_accy 97.40
2025-01-10 22:35:12,812 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58, 71.18, 69.48, 69.84, 67.72, 65.35, 65.07, 63.55, 63.85, 63.24]
2025-01-10 22:35:12,812 [trainer.py] => Average Accuracy (Top1): 73.88117647058823   (Harmonic Accuracy): 72.59029190992493 (Old Acc): 88.2 (New Acc): 61.675 

2025-01-10 22:35:12,813 [trainer.py] => All params: 173661441
2025-01-10 22:35:12,814 [trainer.py] => Trainable params: 2064129
2025-01-10 22:35:12,816 [asp.py] => Learning on 85-90
2025-01-10 22:35:12,853 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:35:17,828 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5, 2.22, 2.0, 1.82, 1.67, 1.54, 1.43, 1.33, 1.25, 1.18]
2025-01-10 22:35:17,829 [trainer.py] => Average Accuracy (Top1): 4.0470588235294125   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 22:35:17,832 [trainer.py] => All params: 173661441
2025-01-10 22:35:17,834 [trainer.py] => Trainable params: 2064129
2025-01-10 22:35:17,837 [asp.py] => Learning on 85-90
2025-01-10 22:35:17,903 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:35:20,947 [asp.py] => Learning on 10-15
2025-01-10 22:35:20,963 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:36:08,294 [asp.py] => Task 0, Epoch 4 => Loss 0.478, Train_accy 92.00, Test_curr_accy 96.40, Test_accy 96.40
2025-01-10 22:37:13,291 [asp.py] => Task 0, Epoch 5 => Loss 0.487, Train_accy 92.47, Test_curr_accy 98.60, Test_accy 98.60
2025-01-10 22:37:42,154 [asp.py] => total parameters: 173649921
2025-01-10 22:37:42,155 [asp.py] => trainable parameters: 2052609
2025-01-10 22:38:18,122 [asp.py] => Task 0, Epoch 6 => Loss 0.349, Train_accy 93.38, Test_curr_accy 98.80, Test_accy 98.80
2025-01-10 22:38:19,076 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84, 75.6, 74.35, 73.79]
2025-01-10 22:38:19,076 [trainer.py] => Average Accuracy (Top1): 83.19142857142856   (Harmonic Accuracy): 81.42545319326949 (Old Acc): 93.2 (New Acc): 72.29230769230767 

2025-01-10 22:38:19,078 [trainer.py] => All params: 173649921
2025-01-10 22:38:19,079 [trainer.py] => Trainable params: 2052609
2025-01-10 22:38:19,081 [asp.py] => Learning on 70-75
2025-01-10 22:38:19,115 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:39:23,277 [asp.py] => Task 0, Epoch 7 => Loss 0.281, Train_accy 95.09, Test_curr_accy 98.00, Test_accy 98.00
2025-01-10 22:40:28,590 [asp.py] => Task 0, Epoch 8 => Loss 0.269, Train_accy 94.55, Test_curr_accy 97.80, Test_accy 97.80
2025-01-10 22:41:33,703 [asp.py] => Task 0, Epoch 9 => Loss 0.251, Train_accy 95.02, Test_curr_accy 95.60, Test_accy 95.60
2025-01-10 22:42:38,804 [asp.py] => Task 0, Epoch 10 => Loss 0.225, Train_accy 95.45, Test_curr_accy 93.60, Test_accy 93.60
2025-01-10 22:43:04,951 [trainer.py] => Top1 curve: [94.2]
2025-01-10 22:43:04,951 [trainer.py] => Average Accuracy (Top1): 94.2   (Harmonic Accuracy): None (Old Acc): 94.2 (New Acc): [] 

2025-01-10 22:43:04,952 [trainer.py] => All params: 173600001
2025-01-10 22:43:04,953 [trainer.py] => Trainable params: 2002689
2025-01-10 22:43:50,381 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 22:43:50,381 [trainer.py] => model_name: asp
2025-01-10 22:43:50,381 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 22:43:50,381 [trainer.py] => device: ['cuda']
2025-01-10 22:43:50,381 [trainer.py] => seed: 2024
2025-01-10 22:43:50,381 [trainer.py] => dataset: cifar224
2025-01-10 22:43:50,381 [trainer.py] => init_cls: 5
2025-01-10 22:43:50,381 [trainer.py] => increment: 5
2025-01-10 22:43:50,381 [trainer.py] => kshot: 5
2025-01-10 22:43:50,381 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 22:43:50,381 [trainer.py] => z_dim: 1000
2025-01-10 22:43:50,381 [trainer.py] => conv_dim: 64
2025-01-10 22:43:50,381 [trainer.py] => img_size: 224
2025-01-10 22:43:50,381 [trainer.py] => generator_lr: 0.005
2025-01-10 22:43:50,382 [trainer.py] => pi: 100
2025-01-10 22:43:50,382 [trainer.py] => w_bn: 50.0
2025-01-10 22:43:50,382 [trainer.py] => w_noise: 0.001
2025-01-10 22:43:50,382 [trainer.py] => server_ss: 32
2025-01-10 22:43:50,382 [trainer.py] => bn_loss: 1
2025-01-10 22:43:50,382 [trainer.py] => noise: 1
2025-01-10 22:43:50,382 [trainer.py] => ie_loss: 1
2025-01-10 22:43:50,382 [trainer.py] => act_loss: 0
2025-01-10 22:43:50,382 [trainer.py] => w_ie: 1.0
2025-01-10 22:43:50,382 [trainer.py] => w_act: 0.1
2025-01-10 22:43:50,382 [trainer.py] => syn_size: 32
2025-01-10 22:43:50,382 [trainer.py] => need_syn_imgs: True
2025-01-10 22:43:50,382 [trainer.py] => g_local_bs: 5
2025-01-10 22:43:50,382 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 22:43:50,382 [trainer.py] => g_local_train_steps: 5
2025-01-10 22:43:50,382 [trainer.py] => dataset_syn: cifar100
2025-01-10 22:43:50,382 [trainer.py] => com_round_gen: 10
2025-01-10 22:43:50,382 [trainer.py] => g_sigma: 0
2025-01-10 22:43:50,382 [trainer.py] => save_cls_embeds: False
2025-01-10 22:43:50,382 [trainer.py] => syn_image_path: outputs/syn_image_5_5_local_bs5_0
2025-01-10 22:43:50,382 [trainer.py] => save_dir: outputs
2025-01-10 22:43:50,382 [trainer.py] => n_iter: 5
2025-01-10 22:43:50,382 [trainer.py] => num_users: 1
2025-01-10 22:43:50,382 [trainer.py] => cur_size: 50
2025-01-10 22:43:50,382 [trainer.py] => local_bs: 5
2025-01-10 22:43:50,382 [trainer.py] => pre_size: 48
2025-01-10 22:43:50,382 [trainer.py] => w_ce_pre: 0.3
2025-01-10 22:43:50,382 [trainer.py] => vpt_type: Deep
2025-01-10 22:43:50,382 [trainer.py] => prompt_token_num: 6
2025-01-10 22:43:50,382 [trainer.py] => avg_alpha: 0.8
2025-01-10 22:43:50,382 [trainer.py] => perturb_var: 1
2025-01-10 22:43:50,382 [trainer.py] => EMA_beta: 0.99
2025-01-10 22:43:50,383 [trainer.py] => anchor_lambda: 0.1
2025-01-10 22:43:50,383 [trainer.py] => kl_weight: 0.001
2025-01-10 22:43:50,383 [trainer.py] => TIP_init: zero
2025-01-10 22:43:50,383 [trainer.py] => tuned_epoch: 10
2025-01-10 22:43:50,383 [trainer.py] => fs_epoch: 0
2025-01-10 22:43:50,383 [trainer.py] => init_lr: 0.01
2025-01-10 22:43:50,383 [trainer.py] => fs_lr: 0.001
2025-01-10 22:43:50,383 [trainer.py] => batch_size: 48
2025-01-10 22:43:50,383 [trainer.py] => fs_batch_size: 16
2025-01-10 22:43:50,383 [trainer.py] => weight_decay: 0.0005
2025-01-10 22:43:50,383 [trainer.py] => min_lr: 0
2025-01-10 22:43:50,383 [trainer.py] => optimizer: sgd
2025-01-10 22:43:50,383 [trainer.py] => memory_size: 0
2025-01-10 22:43:50,383 [trainer.py] => memory_per_class: 0
2025-01-10 22:43:50,383 [trainer.py] => fixed_memory: False
2025-01-10 22:43:50,383 [trainer.py] => shuffle: False
2025-01-10 22:43:50,383 [trainer.py] => top_k: 5
2025-01-10 22:43:50,383 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 22:43:50,383 [trainer.py] => prefix: asp
2025-01-10 22:43:50,383 [trainer.py] => model_prefix: asp
2025-01-10 22:43:52,062 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 22:44:20,772 [asp.py] => Learning on 5-10
2025-01-10 22:44:20,782 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:44:26,285 [trainer.py] => All params: 173596160
2025-01-10 22:44:26,286 [trainer.py] => Trainable params: 1998848
2025-01-10 22:44:42,745 [asp.py] => Learning on 0-5
2025-01-10 22:44:42,786 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 22:50:57,598 [asp.py] => total parameters: 173665281
2025-01-10 22:50:57,600 [asp.py] => trainable parameters: 2067969
2025-01-10 22:51:09,479 [asp.py] => total parameters: 173665281
2025-01-10 22:51:09,480 [asp.py] => trainable parameters: 2067969
2025-01-10 22:51:40,329 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58, 71.18, 69.48, 69.84, 67.72, 65.35, 65.07, 63.55, 63.85, 63.24, 63.61]
2025-01-10 22:51:40,329 [trainer.py] => Average Accuracy (Top1): 73.31055555555555   (Harmonic Accuracy): 72.98854419004456 (Old Acc): 88.4 (New Acc): 62.1529411764706 

2025-01-10 22:51:40,330 [trainer.py] => All params: 173665281
2025-01-10 22:51:40,331 [trainer.py] => Trainable params: 2067969
2025-01-10 22:51:40,333 [asp.py] => Learning on 90-95
2025-01-10 22:51:40,355 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:51:49,687 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5, 2.22, 2.0, 1.82, 1.67, 1.54, 1.43, 1.33, 1.25, 1.18, 1.11]
2025-01-10 22:51:49,687 [trainer.py] => Average Accuracy (Top1): 3.8838888888888894   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 22:51:49,688 [trainer.py] => All params: 173665281
2025-01-10 22:51:49,689 [trainer.py] => Trainable params: 2067969
2025-01-10 22:51:49,691 [asp.py] => Learning on 90-95
2025-01-10 22:51:49,719 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:55:04,534 [asp.py] => total parameters: 173653761
2025-01-10 22:55:04,535 [asp.py] => trainable parameters: 2056449
2025-01-10 22:55:43,355 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84, 75.6, 74.35, 73.79, 71.67]
2025-01-10 22:55:43,356 [trainer.py] => Average Accuracy (Top1): 82.42333333333333   (Harmonic Accuracy): 79.7752745804411 (Old Acc): 92.4 (New Acc): 70.1857142857143 

2025-01-10 22:55:43,357 [trainer.py] => All params: 173653761
2025-01-10 22:55:43,358 [trainer.py] => Trainable params: 2056449
2025-01-10 22:55:43,360 [asp.py] => Learning on 75-80
2025-01-10 22:55:43,384 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 22:59:51,442 [asp.py] => total parameters: 173603841
2025-01-10 22:59:51,443 [asp.py] => trainable parameters: 2006529
2025-01-10 22:59:53,625 [asp.py] => total parameters: 173600001
2025-01-10 22:59:53,626 [asp.py] => trainable parameters: 2002689
2025-01-10 22:59:58,228 [trainer.py] => Top1 curve: [94.2, 90.9]
2025-01-10 22:59:58,228 [trainer.py] => Average Accuracy (Top1): 92.55000000000001   (Harmonic Accuracy): 90.81980198019802 (Old Acc): 93.6 (New Acc): 88.2 

2025-01-10 22:59:58,230 [trainer.py] => All params: 173603841
2025-01-10 22:59:58,230 [trainer.py] => Trainable params: 2006529
2025-01-10 23:00:17,951 [asp.py] => Learning on 10-15
2025-01-10 23:00:17,974 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 23:01:00,920 [asp.py] => Task 0, Epoch 1 => Loss 1.607, Train_accy 61.67, Test_curr_accy 97.80, Test_accy 97.80
2025-01-10 23:02:05,217 [asp.py] => Task 0, Epoch 2 => Loss 0.651, Train_accy 90.00, Test_curr_accy 97.60, Test_accy 97.60
2025-01-10 23:03:08,770 [asp.py] => Task 0, Epoch 3 => Loss 0.605, Train_accy 91.49, Test_curr_accy 96.00, Test_accy 96.00
2025-01-10 23:04:12,021 [asp.py] => Task 0, Epoch 4 => Loss 0.507, Train_accy 91.78, Test_curr_accy 98.80, Test_accy 98.80
2025-01-10 23:05:15,086 [asp.py] => Task 0, Epoch 5 => Loss 0.411, Train_accy 92.95, Test_curr_accy 96.80, Test_accy 96.80
2025-01-10 23:06:17,759 [asp.py] => Task 0, Epoch 6 => Loss 0.341, Train_accy 93.27, Test_curr_accy 98.00, Test_accy 98.00
2025-01-10 23:07:20,981 [asp.py] => Task 0, Epoch 7 => Loss 0.284, Train_accy 94.80, Test_curr_accy 98.40, Test_accy 98.40
2025-01-10 23:07:21,505 [asp.py] => total parameters: 173669121
2025-01-10 23:07:21,506 [asp.py] => trainable parameters: 2071809
2025-01-10 23:07:39,145 [asp.py] => total parameters: 173669121
2025-01-10 23:07:39,146 [asp.py] => trainable parameters: 2071809
2025-01-10 23:08:06,448 [trainer.py] => Top1 curve: [96.4, 94.1, 83.4, 81.55, 80.84, 75.97, 72.86, 71.58, 71.18, 69.48, 69.84, 67.72, 65.35, 65.07, 63.55, 63.85, 63.24, 63.61, 62.83]
2025-01-10 23:08:06,448 [trainer.py] => Average Accuracy (Top1): 72.75894736842105   (Harmonic Accuracy): 72.4149116292886 (Old Acc): 88.2 (New Acc): 61.42222222222223 

2025-01-10 23:08:06,449 [trainer.py] => All params: 173669121
2025-01-10 23:08:06,450 [trainer.py] => Trainable params: 2071809
2025-01-10 23:08:06,451 [asp.py] => Learning on 95-100
2025-01-10 23:08:06,500 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 23:08:21,402 [trainer.py] => Top1 curve: [20.0, 10.0, 6.67, 5.0, 4.0, 3.33, 2.86, 2.5, 2.22, 2.0, 1.82, 1.67, 1.54, 1.43, 1.33, 1.25, 1.18, 1.11, 1.05]
2025-01-10 23:08:21,403 [trainer.py] => Average Accuracy (Top1): 3.7347368421052636   (Harmonic Accuracy): 0.0 (Old Acc): 20.0 (New Acc): 0.0 

2025-01-10 23:08:21,404 [trainer.py] => All params: 173669121
2025-01-10 23:08:21,404 [trainer.py] => Trainable params: 2071809
2025-01-10 23:08:21,406 [asp.py] => Learning on 95-100
2025-01-10 23:08:21,459 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 23:08:24,575 [asp.py] => Task 0, Epoch 8 => Loss 0.275, Train_accy 94.22, Test_curr_accy 98.40, Test_accy 98.40
2025-01-10 23:09:27,975 [asp.py] => Task 0, Epoch 9 => Loss 0.238, Train_accy 94.51, Test_curr_accy 89.40, Test_accy 89.40
2025-01-10 23:10:31,142 [asp.py] => Task 0, Epoch 10 => Loss 0.230, Train_accy 95.27, Test_curr_accy 89.80, Test_accy 89.80
2025-01-10 23:10:56,080 [trainer.py] => Top1 curve: [97.4]
2025-01-10 23:10:56,081 [trainer.py] => Average Accuracy (Top1): 97.4   (Harmonic Accuracy): None (Old Acc): 97.4 (New Acc): [] 

2025-01-10 23:10:56,082 [trainer.py] => All params: 173600001
2025-01-10 23:10:56,082 [trainer.py] => Trainable params: 2002689
2025-01-10 23:11:31,282 [asp.py] => Learning on 5-10
2025-01-10 23:11:31,290 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 23:12:26,093 [asp.py] => total parameters: 173657601
2025-01-10 23:12:26,094 [asp.py] => trainable parameters: 2060289
2025-01-10 23:13:07,564 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84, 75.6, 74.35, 73.79, 71.67, 71.9]
2025-01-10 23:13:07,565 [trainer.py] => Average Accuracy (Top1): 81.765625   (Harmonic Accuracy): 79.99934533551556 (Old Acc): 92.4 (New Acc): 70.53333333333333 

2025-01-10 23:13:07,567 [trainer.py] => All params: 173657601
2025-01-10 23:13:07,568 [trainer.py] => Trainable params: 2060289
2025-01-10 23:13:07,570 [asp.py] => Learning on 80-85
2025-01-10 23:13:07,590 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 23:25:59,720 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 23:25:59,721 [trainer.py] => model_name: asp
2025-01-10 23:25:59,721 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 23:25:59,721 [trainer.py] => device: ['cuda']
2025-01-10 23:25:59,721 [trainer.py] => seed: 2024
2025-01-10 23:25:59,721 [trainer.py] => dataset: cifar224
2025-01-10 23:25:59,721 [trainer.py] => init_cls: 5
2025-01-10 23:25:59,721 [trainer.py] => increment: 5
2025-01-10 23:25:59,721 [trainer.py] => kshot: 5
2025-01-10 23:25:59,721 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 23:25:59,721 [trainer.py] => z_dim: 1000
2025-01-10 23:25:59,721 [trainer.py] => conv_dim: 64
2025-01-10 23:25:59,721 [trainer.py] => img_size: 224
2025-01-10 23:25:59,721 [trainer.py] => generator_lr: 0.005
2025-01-10 23:25:59,721 [trainer.py] => pi: 100
2025-01-10 23:25:59,721 [trainer.py] => w_bn: 50.0
2025-01-10 23:25:59,721 [trainer.py] => w_noise: 0.001
2025-01-10 23:25:59,721 [trainer.py] => server_ss: 32
2025-01-10 23:25:59,721 [trainer.py] => bn_loss: 1
2025-01-10 23:25:59,721 [trainer.py] => noise: 1
2025-01-10 23:25:59,721 [trainer.py] => ie_loss: 1
2025-01-10 23:25:59,721 [trainer.py] => act_loss: 0
2025-01-10 23:25:59,721 [trainer.py] => w_ie: 1.0
2025-01-10 23:25:59,721 [trainer.py] => w_act: 0.1
2025-01-10 23:25:59,721 [trainer.py] => syn_size: 32
2025-01-10 23:25:59,721 [trainer.py] => need_syn_imgs: True
2025-01-10 23:25:59,721 [trainer.py] => g_local_bs: 5
2025-01-10 23:25:59,721 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 23:25:59,721 [trainer.py] => g_local_train_steps: 5
2025-01-10 23:25:59,721 [trainer.py] => dataset_syn: cifar100
2025-01-10 23:25:59,722 [trainer.py] => com_round_gen: 10
2025-01-10 23:25:59,722 [trainer.py] => g_sigma: 0
2025-01-10 23:25:59,722 [trainer.py] => save_cls_embeds: False
2025-01-10 23:25:59,722 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0_local_bs5
2025-01-10 23:25:59,722 [trainer.py] => save_dir: outputs
2025-01-10 23:25:59,722 [trainer.py] => n_iter: 5
2025-01-10 23:25:59,722 [trainer.py] => num_users: 1
2025-01-10 23:25:59,722 [trainer.py] => cur_size: 50
2025-01-10 23:25:59,722 [trainer.py] => local_bs: 5
2025-01-10 23:25:59,722 [trainer.py] => pre_size: 48
2025-01-10 23:25:59,722 [trainer.py] => w_ce_pre: 0.0
2025-01-10 23:25:59,722 [trainer.py] => vpt_type: Deep
2025-01-10 23:25:59,722 [trainer.py] => prompt_token_num: 6
2025-01-10 23:25:59,722 [trainer.py] => avg_alpha: 0.8
2025-01-10 23:25:59,722 [trainer.py] => perturb_var: 1
2025-01-10 23:25:59,722 [trainer.py] => EMA_beta: 0.99
2025-01-10 23:25:59,722 [trainer.py] => anchor_lambda: 0.1
2025-01-10 23:25:59,722 [trainer.py] => kl_weight: 0.001
2025-01-10 23:25:59,722 [trainer.py] => TIP_init: zero
2025-01-10 23:25:59,722 [trainer.py] => tuned_epoch: 10
2025-01-10 23:25:59,722 [trainer.py] => fs_epoch: 0
2025-01-10 23:25:59,722 [trainer.py] => init_lr: 0.01
2025-01-10 23:25:59,722 [trainer.py] => fs_lr: 0.001
2025-01-10 23:25:59,722 [trainer.py] => batch_size: 48
2025-01-10 23:25:59,722 [trainer.py] => fs_batch_size: 16
2025-01-10 23:25:59,722 [trainer.py] => weight_decay: 0.0005
2025-01-10 23:25:59,722 [trainer.py] => min_lr: 0
2025-01-10 23:25:59,722 [trainer.py] => optimizer: sgd
2025-01-10 23:25:59,722 [trainer.py] => memory_size: 0
2025-01-10 23:25:59,722 [trainer.py] => memory_per_class: 0
2025-01-10 23:25:59,723 [trainer.py] => fixed_memory: False
2025-01-10 23:25:59,723 [trainer.py] => shuffle: False
2025-01-10 23:25:59,723 [trainer.py] => top_k: 5
2025-01-10 23:25:59,723 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 23:25:59,723 [trainer.py] => prefix: asp
2025-01-10 23:25:59,723 [trainer.py] => model_prefix: asp
2025-01-10 23:26:01,157 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 23:26:19,374 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 23:26:19,374 [trainer.py] => model_name: asp
2025-01-10 23:26:19,374 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 23:26:19,374 [trainer.py] => device: ['cuda']
2025-01-10 23:26:19,374 [trainer.py] => seed: 2024
2025-01-10 23:26:19,374 [trainer.py] => dataset: cifar224
2025-01-10 23:26:19,374 [trainer.py] => init_cls: 5
2025-01-10 23:26:19,374 [trainer.py] => increment: 5
2025-01-10 23:26:19,374 [trainer.py] => kshot: 5
2025-01-10 23:26:19,374 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 23:26:19,374 [trainer.py] => z_dim: 1000
2025-01-10 23:26:19,374 [trainer.py] => conv_dim: 64
2025-01-10 23:26:19,375 [trainer.py] => img_size: 224
2025-01-10 23:26:19,375 [trainer.py] => generator_lr: 0.005
2025-01-10 23:26:19,375 [trainer.py] => pi: 100
2025-01-10 23:26:19,375 [trainer.py] => w_bn: 50.0
2025-01-10 23:26:19,375 [trainer.py] => w_noise: 0.001
2025-01-10 23:26:19,375 [trainer.py] => server_ss: 32
2025-01-10 23:26:19,375 [trainer.py] => bn_loss: 1
2025-01-10 23:26:19,375 [trainer.py] => noise: 1
2025-01-10 23:26:19,375 [trainer.py] => ie_loss: 1
2025-01-10 23:26:19,375 [trainer.py] => act_loss: 0
2025-01-10 23:26:19,375 [trainer.py] => w_ie: 1.0
2025-01-10 23:26:19,375 [trainer.py] => w_act: 0.1
2025-01-10 23:26:19,375 [trainer.py] => syn_size: 32
2025-01-10 23:26:19,375 [trainer.py] => need_syn_imgs: True
2025-01-10 23:26:19,375 [trainer.py] => g_local_bs: 5
2025-01-10 23:26:19,375 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 23:26:19,375 [trainer.py] => g_local_train_steps: 5
2025-01-10 23:26:19,375 [trainer.py] => dataset_syn: cifar100
2025-01-10 23:26:19,375 [trainer.py] => com_round_gen: 10
2025-01-10 23:26:19,375 [trainer.py] => g_sigma: 0
2025-01-10 23:26:19,375 [trainer.py] => save_cls_embeds: False
2025-01-10 23:26:19,375 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0_local_bs5
2025-01-10 23:26:19,375 [trainer.py] => save_dir: outputs
2025-01-10 23:26:19,375 [trainer.py] => n_iter: 5
2025-01-10 23:26:19,375 [trainer.py] => num_users: 1
2025-01-10 23:26:19,375 [trainer.py] => cur_size: 50
2025-01-10 23:26:19,375 [trainer.py] => local_bs: 5
2025-01-10 23:26:19,375 [trainer.py] => pre_size: 48
2025-01-10 23:26:19,375 [trainer.py] => w_ce_pre: 0.0
2025-01-10 23:26:19,375 [trainer.py] => vpt_type: Deep
2025-01-10 23:26:19,375 [trainer.py] => prompt_token_num: 6
2025-01-10 23:26:19,375 [trainer.py] => avg_alpha: 0.8
2025-01-10 23:26:19,375 [trainer.py] => perturb_var: 1
2025-01-10 23:26:19,376 [trainer.py] => EMA_beta: 0.99
2025-01-10 23:26:19,376 [trainer.py] => anchor_lambda: 0.1
2025-01-10 23:26:19,376 [trainer.py] => kl_weight: 0.001
2025-01-10 23:26:19,376 [trainer.py] => TIP_init: zero
2025-01-10 23:26:19,376 [trainer.py] => tuned_epoch: 10
2025-01-10 23:26:19,376 [trainer.py] => fs_epoch: 0
2025-01-10 23:26:19,376 [trainer.py] => init_lr: 0.01
2025-01-10 23:26:19,376 [trainer.py] => fs_lr: 0.001
2025-01-10 23:26:19,376 [trainer.py] => batch_size: 48
2025-01-10 23:26:19,376 [trainer.py] => fs_batch_size: 16
2025-01-10 23:26:19,376 [trainer.py] => weight_decay: 0.0005
2025-01-10 23:26:19,376 [trainer.py] => min_lr: 0
2025-01-10 23:26:19,376 [trainer.py] => optimizer: sgd
2025-01-10 23:26:19,376 [trainer.py] => memory_size: 0
2025-01-10 23:26:19,376 [trainer.py] => memory_per_class: 0
2025-01-10 23:26:19,376 [trainer.py] => fixed_memory: False
2025-01-10 23:26:19,376 [trainer.py] => shuffle: False
2025-01-10 23:26:19,376 [trainer.py] => top_k: 5
2025-01-10 23:26:19,376 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 23:26:19,376 [trainer.py] => prefix: asp
2025-01-10 23:26:19,376 [trainer.py] => model_prefix: asp
2025-01-10 23:26:21,053 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 23:26:30,317 [trainer.py] => All params: 173596160
2025-01-10 23:26:30,318 [trainer.py] => Trainable params: 1998848
2025-01-10 23:26:48,095 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 23:26:48,095 [trainer.py] => model_name: asp
2025-01-10 23:26:48,095 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 23:26:48,095 [trainer.py] => device: ['cuda']
2025-01-10 23:26:48,096 [trainer.py] => seed: 2024
2025-01-10 23:26:48,096 [trainer.py] => dataset: cifar224
2025-01-10 23:26:48,096 [trainer.py] => init_cls: 5
2025-01-10 23:26:48,096 [trainer.py] => increment: 5
2025-01-10 23:26:48,096 [trainer.py] => kshot: 5
2025-01-10 23:26:48,096 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 23:26:48,096 [trainer.py] => z_dim: 1000
2025-01-10 23:26:48,096 [trainer.py] => conv_dim: 64
2025-01-10 23:26:48,096 [trainer.py] => img_size: 224
2025-01-10 23:26:48,096 [trainer.py] => generator_lr: 0.005
2025-01-10 23:26:48,096 [trainer.py] => pi: 100
2025-01-10 23:26:48,096 [trainer.py] => w_bn: 50.0
2025-01-10 23:26:48,096 [trainer.py] => w_noise: 0.001
2025-01-10 23:26:48,096 [trainer.py] => server_ss: 32
2025-01-10 23:26:48,096 [trainer.py] => bn_loss: 1
2025-01-10 23:26:48,096 [trainer.py] => noise: 1
2025-01-10 23:26:48,096 [trainer.py] => ie_loss: 1
2025-01-10 23:26:48,096 [trainer.py] => act_loss: 0
2025-01-10 23:26:48,096 [trainer.py] => w_ie: 1.0
2025-01-10 23:26:48,096 [trainer.py] => w_act: 0.1
2025-01-10 23:26:48,096 [trainer.py] => syn_size: 32
2025-01-10 23:26:48,096 [trainer.py] => need_syn_imgs: True
2025-01-10 23:26:48,096 [trainer.py] => g_local_bs: 5
2025-01-10 23:26:48,096 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 23:26:48,096 [trainer.py] => g_local_train_steps: 5
2025-01-10 23:26:48,096 [trainer.py] => dataset_syn: cifar100
2025-01-10 23:26:48,096 [trainer.py] => com_round_gen: 10
2025-01-10 23:26:48,096 [trainer.py] => g_sigma: 0
2025-01-10 23:26:48,096 [trainer.py] => save_cls_embeds: False
2025-01-10 23:26:48,096 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.3_local_bs5
2025-01-10 23:26:48,096 [trainer.py] => save_dir: outputs
2025-01-10 23:26:48,097 [trainer.py] => n_iter: 5
2025-01-10 23:26:48,097 [trainer.py] => num_users: 1
2025-01-10 23:26:48,097 [trainer.py] => cur_size: 50
2025-01-10 23:26:48,097 [trainer.py] => local_bs: 5
2025-01-10 23:26:48,097 [trainer.py] => pre_size: 48
2025-01-10 23:26:48,097 [trainer.py] => w_ce_pre: 0.0
2025-01-10 23:26:48,097 [trainer.py] => vpt_type: Deep
2025-01-10 23:26:48,097 [trainer.py] => prompt_token_num: 6
2025-01-10 23:26:48,097 [trainer.py] => avg_alpha: 0.8
2025-01-10 23:26:48,097 [trainer.py] => perturb_var: 1
2025-01-10 23:26:48,097 [trainer.py] => EMA_beta: 0.99
2025-01-10 23:26:48,097 [trainer.py] => anchor_lambda: 0.1
2025-01-10 23:26:48,097 [trainer.py] => kl_weight: 0.001
2025-01-10 23:26:48,097 [trainer.py] => TIP_init: zero
2025-01-10 23:26:48,097 [trainer.py] => tuned_epoch: 10
2025-01-10 23:26:48,097 [trainer.py] => fs_epoch: 0
2025-01-10 23:26:48,097 [trainer.py] => init_lr: 0.01
2025-01-10 23:26:48,097 [trainer.py] => fs_lr: 0.001
2025-01-10 23:26:48,097 [trainer.py] => batch_size: 48
2025-01-10 23:26:48,097 [trainer.py] => fs_batch_size: 16
2025-01-10 23:26:48,097 [trainer.py] => weight_decay: 0.0005
2025-01-10 23:26:48,097 [trainer.py] => min_lr: 0
2025-01-10 23:26:48,097 [trainer.py] => optimizer: sgd
2025-01-10 23:26:48,097 [trainer.py] => memory_size: 0
2025-01-10 23:26:48,097 [trainer.py] => memory_per_class: 0
2025-01-10 23:26:48,097 [trainer.py] => fixed_memory: False
2025-01-10 23:26:48,097 [trainer.py] => shuffle: False
2025-01-10 23:26:48,097 [trainer.py] => top_k: 5
2025-01-10 23:26:48,097 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 23:26:48,097 [trainer.py] => prefix: asp
2025-01-10 23:26:48,097 [trainer.py] => model_prefix: asp
2025-01-10 23:26:48,288 [asp.py] => Learning on 0-5
2025-01-10 23:26:48,302 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 23:26:49,591 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 23:26:58,620 [trainer.py] => All params: 173596160
2025-01-10 23:26:58,620 [trainer.py] => Trainable params: 1998848
2025-01-10 23:27:02,210 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 23:27:02,210 [trainer.py] => model_name: asp
2025-01-10 23:27:02,210 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 23:27:02,210 [trainer.py] => device: ['cuda']
2025-01-10 23:27:02,210 [trainer.py] => seed: 2024
2025-01-10 23:27:02,210 [trainer.py] => dataset: cifar224
2025-01-10 23:27:02,210 [trainer.py] => init_cls: 5
2025-01-10 23:27:02,210 [trainer.py] => increment: 5
2025-01-10 23:27:02,210 [trainer.py] => kshot: 5
2025-01-10 23:27:02,210 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 23:27:02,210 [trainer.py] => z_dim: 1000
2025-01-10 23:27:02,210 [trainer.py] => conv_dim: 64
2025-01-10 23:27:02,211 [trainer.py] => img_size: 224
2025-01-10 23:27:02,211 [trainer.py] => generator_lr: 0.005
2025-01-10 23:27:02,211 [trainer.py] => pi: 100
2025-01-10 23:27:02,211 [trainer.py] => w_bn: 50.0
2025-01-10 23:27:02,211 [trainer.py] => w_noise: 0.001
2025-01-10 23:27:02,211 [trainer.py] => server_ss: 32
2025-01-10 23:27:02,211 [trainer.py] => bn_loss: 1
2025-01-10 23:27:02,211 [trainer.py] => noise: 1
2025-01-10 23:27:02,211 [trainer.py] => ie_loss: 1
2025-01-10 23:27:02,211 [trainer.py] => act_loss: 0
2025-01-10 23:27:02,211 [trainer.py] => w_ie: 1.0
2025-01-10 23:27:02,211 [trainer.py] => w_act: 0.1
2025-01-10 23:27:02,211 [trainer.py] => syn_size: 32
2025-01-10 23:27:02,211 [trainer.py] => need_syn_imgs: True
2025-01-10 23:27:02,211 [trainer.py] => g_local_bs: 5
2025-01-10 23:27:02,211 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 23:27:02,211 [trainer.py] => g_local_train_steps: 5
2025-01-10 23:27:02,211 [trainer.py] => dataset_syn: cifar100
2025-01-10 23:27:02,211 [trainer.py] => com_round_gen: 10
2025-01-10 23:27:02,211 [trainer.py] => g_sigma: 0
2025-01-10 23:27:02,211 [trainer.py] => save_cls_embeds: False
2025-01-10 23:27:02,211 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.3_local_bs5
2025-01-10 23:27:02,211 [trainer.py] => save_dir: outputs
2025-01-10 23:27:02,211 [trainer.py] => n_iter: 5
2025-01-10 23:27:02,211 [trainer.py] => num_users: 1
2025-01-10 23:27:02,211 [trainer.py] => cur_size: 50
2025-01-10 23:27:02,211 [trainer.py] => local_bs: 5
2025-01-10 23:27:02,211 [trainer.py] => pre_size: 48
2025-01-10 23:27:02,211 [trainer.py] => w_ce_pre: 0.0
2025-01-10 23:27:02,211 [trainer.py] => vpt_type: Deep
2025-01-10 23:27:02,211 [trainer.py] => prompt_token_num: 6
2025-01-10 23:27:02,211 [trainer.py] => avg_alpha: 0.8
2025-01-10 23:27:02,212 [trainer.py] => perturb_var: 1
2025-01-10 23:27:02,212 [trainer.py] => EMA_beta: 0.99
2025-01-10 23:27:02,212 [trainer.py] => anchor_lambda: 0.1
2025-01-10 23:27:02,212 [trainer.py] => kl_weight: 0.001
2025-01-10 23:27:02,212 [trainer.py] => TIP_init: zero
2025-01-10 23:27:02,212 [trainer.py] => tuned_epoch: 10
2025-01-10 23:27:02,212 [trainer.py] => fs_epoch: 0
2025-01-10 23:27:02,212 [trainer.py] => init_lr: 0.01
2025-01-10 23:27:02,212 [trainer.py] => fs_lr: 0.001
2025-01-10 23:27:02,212 [trainer.py] => batch_size: 48
2025-01-10 23:27:02,212 [trainer.py] => fs_batch_size: 16
2025-01-10 23:27:02,212 [trainer.py] => weight_decay: 0.0005
2025-01-10 23:27:02,212 [trainer.py] => min_lr: 0
2025-01-10 23:27:02,212 [trainer.py] => optimizer: sgd
2025-01-10 23:27:02,212 [trainer.py] => memory_size: 0
2025-01-10 23:27:02,212 [trainer.py] => memory_per_class: 0
2025-01-10 23:27:02,212 [trainer.py] => fixed_memory: False
2025-01-10 23:27:02,212 [trainer.py] => shuffle: False
2025-01-10 23:27:02,212 [trainer.py] => top_k: 5
2025-01-10 23:27:02,212 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 23:27:02,212 [trainer.py] => prefix: asp
2025-01-10 23:27:02,212 [trainer.py] => model_prefix: asp
2025-01-10 23:27:03,841 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 23:27:13,684 [trainer.py] => All params: 173596160
2025-01-10 23:27:13,685 [trainer.py] => Trainable params: 1998848
2025-01-10 23:27:17,541 [asp.py] => Learning on 0-5
2025-01-10 23:27:17,547 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 23:27:31,186 [asp.py] => Learning on 0-5
2025-01-10 23:27:31,221 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 23:30:27,849 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 23:30:27,849 [trainer.py] => model_name: asp
2025-01-10 23:30:27,849 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 23:30:27,849 [trainer.py] => device: ['cuda']
2025-01-10 23:30:27,849 [trainer.py] => seed: 2024
2025-01-10 23:30:27,849 [trainer.py] => dataset: cifar224
2025-01-10 23:30:27,849 [trainer.py] => init_cls: 5
2025-01-10 23:30:27,849 [trainer.py] => increment: 5
2025-01-10 23:30:27,849 [trainer.py] => kshot: 5
2025-01-10 23:30:27,849 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 23:30:27,849 [trainer.py] => z_dim: 1000
2025-01-10 23:30:27,849 [trainer.py] => conv_dim: 64
2025-01-10 23:30:27,849 [trainer.py] => img_size: 224
2025-01-10 23:30:27,849 [trainer.py] => generator_lr: 0.005
2025-01-10 23:30:27,849 [trainer.py] => pi: 100
2025-01-10 23:30:27,849 [trainer.py] => w_bn: 50.0
2025-01-10 23:30:27,849 [trainer.py] => w_noise: 0.001
2025-01-10 23:30:27,849 [trainer.py] => server_ss: 32
2025-01-10 23:30:27,849 [trainer.py] => bn_loss: 1
2025-01-10 23:30:27,849 [trainer.py] => noise: 1
2025-01-10 23:30:27,849 [trainer.py] => ie_loss: 1
2025-01-10 23:30:27,850 [trainer.py] => act_loss: 0
2025-01-10 23:30:27,850 [trainer.py] => w_ie: 1.0
2025-01-10 23:30:27,850 [trainer.py] => w_act: 0.1
2025-01-10 23:30:27,850 [trainer.py] => syn_size: 32
2025-01-10 23:30:27,850 [trainer.py] => need_syn_imgs: True
2025-01-10 23:30:27,850 [trainer.py] => g_local_bs: 5
2025-01-10 23:30:27,850 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 23:30:27,850 [trainer.py] => g_local_train_steps: 5
2025-01-10 23:30:27,850 [trainer.py] => dataset_syn: cifar100
2025-01-10 23:30:27,850 [trainer.py] => com_round_gen: 10
2025-01-10 23:30:27,850 [trainer.py] => g_sigma: 0
2025-01-10 23:30:27,850 [trainer.py] => save_cls_embeds: False
2025-01-10 23:30:27,850 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.0_local_bs5
2025-01-10 23:30:27,850 [trainer.py] => save_dir: outputs
2025-01-10 23:30:27,850 [trainer.py] => n_iter: 5
2025-01-10 23:30:27,850 [trainer.py] => num_users: 1
2025-01-10 23:30:27,850 [trainer.py] => cur_size: 50
2025-01-10 23:30:27,850 [trainer.py] => local_bs: 5
2025-01-10 23:30:27,850 [trainer.py] => pre_size: 48
2025-01-10 23:30:27,850 [trainer.py] => w_ce_pre: 0.0
2025-01-10 23:30:27,850 [trainer.py] => vpt_type: Deep
2025-01-10 23:30:27,850 [trainer.py] => prompt_token_num: 6
2025-01-10 23:30:27,850 [trainer.py] => avg_alpha: 0.8
2025-01-10 23:30:27,850 [trainer.py] => perturb_var: 1
2025-01-10 23:30:27,850 [trainer.py] => EMA_beta: 0.99
2025-01-10 23:30:27,850 [trainer.py] => anchor_lambda: 0.1
2025-01-10 23:30:27,850 [trainer.py] => kl_weight: 0.001
2025-01-10 23:30:27,850 [trainer.py] => TIP_init: zero
2025-01-10 23:30:27,850 [trainer.py] => tuned_epoch: 10
2025-01-10 23:30:27,850 [trainer.py] => fs_epoch: 0
2025-01-10 23:30:27,850 [trainer.py] => init_lr: 0.01
2025-01-10 23:30:27,851 [trainer.py] => fs_lr: 0.001
2025-01-10 23:30:27,851 [trainer.py] => batch_size: 48
2025-01-10 23:30:27,851 [trainer.py] => fs_batch_size: 16
2025-01-10 23:30:27,851 [trainer.py] => weight_decay: 0.0005
2025-01-10 23:30:27,851 [trainer.py] => min_lr: 0
2025-01-10 23:30:27,851 [trainer.py] => optimizer: sgd
2025-01-10 23:30:27,851 [trainer.py] => memory_size: 0
2025-01-10 23:30:27,851 [trainer.py] => memory_per_class: 0
2025-01-10 23:30:27,851 [trainer.py] => fixed_memory: False
2025-01-10 23:30:27,851 [trainer.py] => shuffle: False
2025-01-10 23:30:27,851 [trainer.py] => top_k: 5
2025-01-10 23:30:27,851 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 23:30:27,851 [trainer.py] => prefix: asp
2025-01-10 23:30:27,851 [trainer.py] => model_prefix: asp
2025-01-10 23:30:29,416 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 23:30:38,685 [trainer.py] => All params: 173596160
2025-01-10 23:30:38,686 [trainer.py] => Trainable params: 1998848
2025-01-10 23:30:55,345 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 23:30:55,345 [trainer.py] => model_name: asp
2025-01-10 23:30:55,346 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 23:30:55,346 [trainer.py] => device: ['cuda']
2025-01-10 23:30:55,346 [trainer.py] => seed: 2024
2025-01-10 23:30:55,346 [trainer.py] => dataset: cifar224
2025-01-10 23:30:55,346 [trainer.py] => init_cls: 5
2025-01-10 23:30:55,346 [trainer.py] => increment: 5
2025-01-10 23:30:55,346 [trainer.py] => kshot: 5
2025-01-10 23:30:55,346 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 23:30:55,346 [trainer.py] => z_dim: 1000
2025-01-10 23:30:55,346 [trainer.py] => conv_dim: 64
2025-01-10 23:30:55,346 [trainer.py] => img_size: 224
2025-01-10 23:30:55,346 [trainer.py] => generator_lr: 0.005
2025-01-10 23:30:55,346 [trainer.py] => pi: 100
2025-01-10 23:30:55,346 [trainer.py] => w_bn: 50.0
2025-01-10 23:30:55,346 [trainer.py] => w_noise: 0.001
2025-01-10 23:30:55,346 [trainer.py] => server_ss: 32
2025-01-10 23:30:55,346 [trainer.py] => bn_loss: 1
2025-01-10 23:30:55,346 [trainer.py] => noise: 1
2025-01-10 23:30:55,346 [trainer.py] => ie_loss: 1
2025-01-10 23:30:55,346 [trainer.py] => act_loss: 0
2025-01-10 23:30:55,346 [trainer.py] => w_ie: 1.0
2025-01-10 23:30:55,346 [trainer.py] => w_act: 0.1
2025-01-10 23:30:55,346 [trainer.py] => syn_size: 32
2025-01-10 23:30:55,346 [trainer.py] => need_syn_imgs: True
2025-01-10 23:30:55,346 [trainer.py] => g_local_bs: 5
2025-01-10 23:30:55,346 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 23:30:55,346 [trainer.py] => g_local_train_steps: 5
2025-01-10 23:30:55,346 [trainer.py] => dataset_syn: cifar100
2025-01-10 23:30:55,346 [trainer.py] => com_round_gen: 10
2025-01-10 23:30:55,346 [trainer.py] => g_sigma: 0
2025-01-10 23:30:55,347 [trainer.py] => save_cls_embeds: False
2025-01-10 23:30:55,347 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.3_local_bs5
2025-01-10 23:30:55,347 [trainer.py] => save_dir: outputs
2025-01-10 23:30:55,347 [trainer.py] => n_iter: 5
2025-01-10 23:30:55,347 [trainer.py] => num_users: 1
2025-01-10 23:30:55,347 [trainer.py] => cur_size: 50
2025-01-10 23:30:55,347 [trainer.py] => local_bs: 5
2025-01-10 23:30:55,347 [trainer.py] => pre_size: 48
2025-01-10 23:30:55,347 [trainer.py] => w_ce_pre: 0.3
2025-01-10 23:30:55,347 [trainer.py] => vpt_type: Deep
2025-01-10 23:30:55,347 [trainer.py] => prompt_token_num: 6
2025-01-10 23:30:55,347 [trainer.py] => avg_alpha: 0.8
2025-01-10 23:30:55,347 [trainer.py] => perturb_var: 1
2025-01-10 23:30:55,347 [trainer.py] => EMA_beta: 0.99
2025-01-10 23:30:55,347 [trainer.py] => anchor_lambda: 0.1
2025-01-10 23:30:55,347 [trainer.py] => kl_weight: 0.001
2025-01-10 23:30:55,347 [trainer.py] => TIP_init: zero
2025-01-10 23:30:55,347 [trainer.py] => tuned_epoch: 10
2025-01-10 23:30:55,347 [trainer.py] => fs_epoch: 0
2025-01-10 23:30:55,347 [trainer.py] => init_lr: 0.01
2025-01-10 23:30:55,347 [trainer.py] => fs_lr: 0.001
2025-01-10 23:30:55,347 [trainer.py] => batch_size: 48
2025-01-10 23:30:55,347 [trainer.py] => fs_batch_size: 16
2025-01-10 23:30:55,347 [trainer.py] => weight_decay: 0.0005
2025-01-10 23:30:55,347 [trainer.py] => min_lr: 0
2025-01-10 23:30:55,347 [trainer.py] => optimizer: sgd
2025-01-10 23:30:55,347 [trainer.py] => memory_size: 0
2025-01-10 23:30:55,347 [trainer.py] => memory_per_class: 0
2025-01-10 23:30:55,347 [trainer.py] => fixed_memory: False
2025-01-10 23:30:55,347 [trainer.py] => shuffle: False
2025-01-10 23:30:55,348 [trainer.py] => top_k: 5
2025-01-10 23:30:55,348 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 23:30:55,348 [trainer.py] => prefix: asp
2025-01-10 23:30:55,348 [trainer.py] => model_prefix: asp
2025-01-10 23:30:56,447 [asp.py] => Learning on 0-5
2025-01-10 23:30:56,453 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 23:30:57,004 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 23:31:06,167 [trainer.py] => All params: 173596160
2025-01-10 23:31:06,168 [trainer.py] => Trainable params: 1998848
2025-01-10 23:31:20,007 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 23:31:20,007 [trainer.py] => model_name: asp
2025-01-10 23:31:20,007 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 23:31:20,007 [trainer.py] => device: ['cuda']
2025-01-10 23:31:20,007 [trainer.py] => seed: 2024
2025-01-10 23:31:20,007 [trainer.py] => dataset: cifar224
2025-01-10 23:31:20,007 [trainer.py] => init_cls: 5
2025-01-10 23:31:20,007 [trainer.py] => increment: 5
2025-01-10 23:31:20,007 [trainer.py] => kshot: 5
2025-01-10 23:31:20,007 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 23:31:20,008 [trainer.py] => z_dim: 1000
2025-01-10 23:31:20,008 [trainer.py] => conv_dim: 64
2025-01-10 23:31:20,008 [trainer.py] => img_size: 224
2025-01-10 23:31:20,008 [trainer.py] => generator_lr: 0.005
2025-01-10 23:31:20,008 [trainer.py] => pi: 100
2025-01-10 23:31:20,008 [trainer.py] => w_bn: 50.0
2025-01-10 23:31:20,008 [trainer.py] => w_noise: 0.001
2025-01-10 23:31:20,008 [trainer.py] => server_ss: 32
2025-01-10 23:31:20,008 [trainer.py] => bn_loss: 1
2025-01-10 23:31:20,008 [trainer.py] => noise: 1
2025-01-10 23:31:20,008 [trainer.py] => ie_loss: 1
2025-01-10 23:31:20,008 [trainer.py] => act_loss: 0
2025-01-10 23:31:20,008 [trainer.py] => w_ie: 1.0
2025-01-10 23:31:20,008 [trainer.py] => w_act: 0.1
2025-01-10 23:31:20,008 [trainer.py] => syn_size: 32
2025-01-10 23:31:20,008 [trainer.py] => need_syn_imgs: True
2025-01-10 23:31:20,008 [trainer.py] => g_local_bs: 5
2025-01-10 23:31:20,008 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 23:31:20,008 [trainer.py] => g_local_train_steps: 5
2025-01-10 23:31:20,008 [trainer.py] => dataset_syn: cifar100
2025-01-10 23:31:20,008 [trainer.py] => com_round_gen: 10
2025-01-10 23:31:20,008 [trainer.py] => g_sigma: 0
2025-01-10 23:31:20,008 [trainer.py] => save_cls_embeds: False
2025-01-10 23:31:20,008 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_local_bs5
2025-01-10 23:31:20,008 [trainer.py] => save_dir: outputs
2025-01-10 23:31:20,008 [trainer.py] => n_iter: 5
2025-01-10 23:31:20,008 [trainer.py] => num_users: 1
2025-01-10 23:31:20,008 [trainer.py] => cur_size: 50
2025-01-10 23:31:20,008 [trainer.py] => local_bs: 5
2025-01-10 23:31:20,008 [trainer.py] => pre_size: 48
2025-01-10 23:31:20,008 [trainer.py] => w_ce_pre: 0.5
2025-01-10 23:31:20,008 [trainer.py] => vpt_type: Deep
2025-01-10 23:31:20,009 [trainer.py] => prompt_token_num: 6
2025-01-10 23:31:20,009 [trainer.py] => avg_alpha: 0.8
2025-01-10 23:31:20,009 [trainer.py] => perturb_var: 1
2025-01-10 23:31:20,009 [trainer.py] => EMA_beta: 0.99
2025-01-10 23:31:20,009 [trainer.py] => anchor_lambda: 0.1
2025-01-10 23:31:20,009 [trainer.py] => kl_weight: 0.001
2025-01-10 23:31:20,009 [trainer.py] => TIP_init: zero
2025-01-10 23:31:20,009 [trainer.py] => tuned_epoch: 10
2025-01-10 23:31:20,009 [trainer.py] => fs_epoch: 0
2025-01-10 23:31:20,009 [trainer.py] => init_lr: 0.01
2025-01-10 23:31:20,009 [trainer.py] => fs_lr: 0.001
2025-01-10 23:31:20,009 [trainer.py] => batch_size: 48
2025-01-10 23:31:20,009 [trainer.py] => fs_batch_size: 16
2025-01-10 23:31:20,009 [trainer.py] => weight_decay: 0.0005
2025-01-10 23:31:20,009 [trainer.py] => min_lr: 0
2025-01-10 23:31:20,009 [trainer.py] => optimizer: sgd
2025-01-10 23:31:20,009 [trainer.py] => memory_size: 0
2025-01-10 23:31:20,009 [trainer.py] => memory_per_class: 0
2025-01-10 23:31:20,009 [trainer.py] => fixed_memory: False
2025-01-10 23:31:20,009 [trainer.py] => shuffle: False
2025-01-10 23:31:20,009 [trainer.py] => top_k: 5
2025-01-10 23:31:20,009 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 23:31:20,009 [trainer.py] => prefix: asp
2025-01-10 23:31:20,009 [trainer.py] => model_prefix: asp
2025-01-10 23:31:21,607 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 23:31:22,158 [asp.py] => Learning on 0-5
2025-01-10 23:31:22,164 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 23:31:30,387 [trainer.py] => All params: 173596160
2025-01-10 23:31:30,388 [trainer.py] => Trainable params: 1998848
2025-01-10 23:31:46,657 [asp.py] => Learning on 0-5
2025-01-10 23:31:46,663 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-10 23:46:47,639 [asp.py] => total parameters: 173600001
2025-01-10 23:46:47,640 [asp.py] => trainable parameters: 2002689
2025-01-10 23:47:14,890 [asp.py] => total parameters: 173600001
2025-01-10 23:47:14,891 [asp.py] => trainable parameters: 2002689
2025-01-10 23:47:54,093 [asp.py] => Task 0, Epoch 1 => Loss 1.607, Train_accy 60.40, Test_curr_accy 97.60, Test_accy 97.60
2025-01-10 23:47:54,828 [asp.py] => total parameters: 173600001
2025-01-10 23:47:54,829 [asp.py] => trainable parameters: 2002689
2025-01-10 23:48:19,160 [asp.py] => Task 0, Epoch 1 => Loss 1.596, Train_accy 60.73, Test_curr_accy 98.00, Test_accy 98.00
2025-01-10 23:49:00,219 [asp.py] => Task 0, Epoch 2 => Loss 0.665, Train_accy 89.27, Test_curr_accy 98.60, Test_accy 98.60
2025-01-10 23:49:04,803 [asp.py] => Task 0, Epoch 1 => Loss 1.596, Train_accy 61.27, Test_curr_accy 96.60, Test_accy 96.60
2025-01-10 23:49:23,086 [asp.py] => Task 0, Epoch 2 => Loss 0.671, Train_accy 89.38, Test_curr_accy 98.60, Test_accy 98.60
2025-01-10 23:50:06,133 [asp.py] => Task 0, Epoch 3 => Loss 0.525, Train_accy 91.56, Test_curr_accy 96.60, Test_accy 96.60
2025-01-10 23:50:13,627 [asp.py] => Task 0, Epoch 2 => Loss 0.650, Train_accy 90.04, Test_curr_accy 97.80, Test_accy 97.80
2025-01-10 23:50:26,820 [asp.py] => Task 0, Epoch 3 => Loss 0.526, Train_accy 91.85, Test_curr_accy 97.60, Test_accy 97.60
2025-01-10 23:51:12,004 [asp.py] => Task 0, Epoch 4 => Loss 0.534, Train_accy 92.11, Test_curr_accy 97.40, Test_accy 97.40
2025-01-10 23:51:21,644 [asp.py] => Task 0, Epoch 3 => Loss 0.594, Train_accy 91.60, Test_curr_accy 96.80, Test_accy 96.80
2025-01-10 23:51:30,484 [asp.py] => Task 0, Epoch 4 => Loss 0.553, Train_accy 91.71, Test_curr_accy 98.60, Test_accy 98.60
2025-01-10 23:52:17,933 [asp.py] => Task 0, Epoch 5 => Loss 0.389, Train_accy 92.73, Test_curr_accy 99.40, Test_accy 99.40
2025-01-10 23:52:30,253 [asp.py] => Task 0, Epoch 4 => Loss 0.432, Train_accy 92.91, Test_curr_accy 99.00, Test_accy 99.00
2025-01-10 23:52:33,919 [asp.py] => Task 0, Epoch 5 => Loss 0.442, Train_accy 92.80, Test_curr_accy 98.00, Test_accy 98.00
2025-01-10 23:53:24,017 [asp.py] => Task 0, Epoch 6 => Loss 0.384, Train_accy 93.05, Test_curr_accy 92.00, Test_accy 92.00
2025-01-10 23:53:38,116 [asp.py] => Task 0, Epoch 6 => Loss 0.339, Train_accy 93.35, Test_curr_accy 98.60, Test_accy 98.60
2025-01-10 23:53:39,300 [asp.py] => Task 0, Epoch 5 => Loss 0.387, Train_accy 93.16, Test_curr_accy 98.80, Test_accy 98.80
2025-01-10 23:54:30,232 [asp.py] => Task 0, Epoch 7 => Loss 0.392, Train_accy 93.82, Test_curr_accy 88.40, Test_accy 88.40
2025-01-10 23:54:41,794 [asp.py] => Task 0, Epoch 7 => Loss 0.296, Train_accy 94.47, Test_curr_accy 95.40, Test_accy 95.40
2025-01-10 23:54:48,074 [asp.py] => Task 0, Epoch 6 => Loss 0.365, Train_accy 93.56, Test_curr_accy 94.80, Test_accy 94.80
2025-01-10 23:55:36,378 [asp.py] => Task 0, Epoch 8 => Loss 0.288, Train_accy 94.22, Test_curr_accy 97.60, Test_accy 97.60
2025-01-10 23:55:45,396 [asp.py] => Task 0, Epoch 8 => Loss 0.274, Train_accy 94.55, Test_curr_accy 97.40, Test_accy 97.40
2025-01-10 23:55:56,041 [asp.py] => Task 0, Epoch 7 => Loss 0.294, Train_accy 94.18, Test_curr_accy 98.40, Test_accy 98.40
2025-01-10 23:56:42,049 [asp.py] => Task 0, Epoch 9 => Loss 0.252, Train_accy 94.98, Test_curr_accy 96.00, Test_accy 96.00
2025-01-10 23:56:48,996 [asp.py] => Task 0, Epoch 9 => Loss 0.241, Train_accy 94.69, Test_curr_accy 97.00, Test_accy 97.00
2025-01-10 23:57:04,723 [asp.py] => Task 0, Epoch 8 => Loss 0.272, Train_accy 94.25, Test_curr_accy 91.60, Test_accy 91.60
2025-01-10 23:57:48,011 [asp.py] => Task 0, Epoch 10 => Loss 0.235, Train_accy 95.16, Test_curr_accy 94.60, Test_accy 94.60
2025-01-10 23:57:52,444 [asp.py] => Task 0, Epoch 10 => Loss 0.244, Train_accy 95.02, Test_curr_accy 95.00, Test_accy 95.00
2025-01-10 23:58:16,590 [trainer.py] => Top1 curve: [97.8]
2025-01-10 23:58:16,591 [trainer.py] => Average Accuracy (Top1): 97.8   (Harmonic Accuracy): None (Old Acc): 97.8 (New Acc): [] 

2025-01-10 23:58:16,592 [trainer.py] => All params: 173600001
2025-01-10 23:58:16,592 [trainer.py] => Trainable params: 2002689
2025-01-10 23:58:19,762 [asp.py] => Task 0, Epoch 9 => Loss 0.236, Train_accy 95.13, Test_curr_accy 98.00, Test_accy 98.00
2025-01-10 23:58:20,540 [trainer.py] => Top1 curve: [97.8]
2025-01-10 23:58:20,541 [trainer.py] => Average Accuracy (Top1): 97.8   (Harmonic Accuracy): None (Old Acc): 97.8 (New Acc): [] 

2025-01-10 23:58:20,541 [trainer.py] => All params: 173600001
2025-01-10 23:58:20,542 [trainer.py] => Trainable params: 2002689
2025-01-10 23:58:45,885 [asp.py] => Learning on 5-10
2025-01-10 23:58:45,913 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 23:58:46,473 [asp.py] => Learning on 5-10
2025-01-10 23:58:46,493 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-10 23:59:29,301 [asp.py] => Task 0, Epoch 10 => Loss 0.237, Train_accy 95.45, Test_curr_accy 86.20, Test_accy 86.20
2025-01-10 23:59:56,736 [trainer.py] => Top1 curve: [97.0]
2025-01-10 23:59:56,736 [trainer.py] => Average Accuracy (Top1): 97.0   (Harmonic Accuracy): None (Old Acc): 97.0 (New Acc): [] 

2025-01-10 23:59:56,738 [trainer.py] => All params: 173600001
2025-01-10 23:59:56,739 [trainer.py] => Trainable params: 2002689
2025-01-11 00:00:18,361 [asp.py] => Learning on 5-10
2025-01-11 00:00:18,407 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 00:14:21,936 [asp.py] => total parameters: 173603841
2025-01-11 00:14:21,937 [asp.py] => trainable parameters: 2006529
2025-01-11 00:14:28,629 [trainer.py] => Top1 curve: [97.8, 95.8]
2025-01-11 00:14:28,629 [trainer.py] => Average Accuracy (Top1): 96.8   (Harmonic Accuracy): 95.76617954070981 (Old Acc): 97.6 (New Acc): 94.0 

2025-01-11 00:14:28,630 [trainer.py] => All params: 173603841
2025-01-11 00:14:28,631 [trainer.py] => Trainable params: 2006529
2025-01-11 00:14:31,170 [asp.py] => total parameters: 173603841
2025-01-11 00:14:31,171 [asp.py] => trainable parameters: 2006529
2025-01-11 00:14:38,407 [trainer.py] => Top1 curve: [97.8, 92.9]
2025-01-11 00:14:38,408 [trainer.py] => Average Accuracy (Top1): 95.35   (Harmonic Accuracy): 92.70096878363832 (Old Acc): 97.2 (New Acc): 88.6 

2025-01-11 00:14:38,409 [trainer.py] => All params: 173603841
2025-01-11 00:14:38,409 [trainer.py] => Trainable params: 2006529
2025-01-11 00:14:47,501 [asp.py] => Learning on 10-15
2025-01-11 00:14:47,509 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 00:14:58,736 [asp.py] => Learning on 10-15
2025-01-11 00:14:58,745 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 00:16:48,172 [asp.py] => total parameters: 173603841
2025-01-11 00:16:48,173 [asp.py] => trainable parameters: 2006529
2025-01-11 00:16:56,268 [trainer.py] => Top1 curve: [97.0, 93.8]
2025-01-11 00:16:56,268 [trainer.py] => Average Accuracy (Top1): 95.4   (Harmonic Accuracy): 93.70405117270788 (Old Acc): 96.8 (New Acc): 90.8 

2025-01-11 00:16:56,269 [trainer.py] => All params: 173603841
2025-01-11 00:16:56,270 [trainer.py] => Trainable params: 2006529
2025-01-11 00:17:16,623 [asp.py] => Learning on 10-15
2025-01-11 00:17:16,640 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 00:30:24,122 [asp.py] => total parameters: 173607681
2025-01-11 00:30:24,123 [asp.py] => trainable parameters: 2010369
2025-01-11 00:30:33,318 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47]
2025-01-11 00:30:33,318 [trainer.py] => Average Accuracy (Top1): 93.35666666666667   (Harmonic Accuracy): 88.30056242969628 (Old Acc): 96.2 (New Acc): 81.6 

2025-01-11 00:30:33,319 [trainer.py] => All params: 173607681
2025-01-11 00:30:33,320 [trainer.py] => Trainable params: 2010369
2025-01-11 00:30:43,938 [asp.py] => total parameters: 173607681
2025-01-11 00:30:43,939 [asp.py] => trainable parameters: 2010369
2025-01-11 00:30:52,848 [asp.py] => Learning on 15-20
2025-01-11 00:30:52,858 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 00:30:53,296 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27]
2025-01-11 00:30:53,297 [trainer.py] => Average Accuracy (Top1): 89.99   (Harmonic Accuracy): 81.57366846199879 (Old Acc): 96.4 (New Acc): 70.7 

2025-01-11 00:30:53,299 [trainer.py] => All params: 173607681
2025-01-11 00:30:53,299 [trainer.py] => Trainable params: 2010369
2025-01-11 00:31:12,742 [asp.py] => Learning on 15-20
2025-01-11 00:31:12,753 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 00:33:56,058 [asp.py] => total parameters: 173607681
2025-01-11 00:33:56,059 [asp.py] => trainable parameters: 2010369
2025-01-11 00:34:05,925 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4]
2025-01-11 00:34:05,925 [trainer.py] => Average Accuracy (Top1): 92.06666666666668   (Harmonic Accuracy): 87.23505976095619 (Old Acc): 95.2 (New Acc): 80.5 

2025-01-11 00:34:05,926 [trainer.py] => All params: 173607681
2025-01-11 00:34:05,927 [trainer.py] => Trainable params: 2010369
2025-01-11 00:34:25,818 [asp.py] => Learning on 15-20
2025-01-11 00:34:25,836 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 00:46:28,913 [asp.py] => total parameters: 173611521
2025-01-11 00:46:28,914 [asp.py] => trainable parameters: 2014209
2025-01-11 00:46:39,810 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0]
2025-01-11 00:46:39,810 [trainer.py] => Average Accuracy (Top1): 91.0175   (Harmonic Accuracy): 87.27272727272727 (Old Acc): 96.0 (New Acc): 80.0 

2025-01-11 00:46:39,811 [trainer.py] => All params: 173611521
2025-01-11 00:46:39,811 [trainer.py] => Trainable params: 2014209
2025-01-11 00:46:58,906 [asp.py] => Learning on 20-25
2025-01-11 00:46:58,917 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 00:46:58,978 [asp.py] => total parameters: 173611521
2025-01-11 00:46:58,980 [asp.py] => trainable parameters: 2014209
2025-01-11 00:47:10,553 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25]
2025-01-11 00:47:10,554 [trainer.py] => Average Accuracy (Top1): 87.05499999999999   (Harmonic Accuracy): 82.5632265717675 (Old Acc): 96.4 (New Acc): 72.2 

2025-01-11 00:47:10,554 [trainer.py] => All params: 173611521
2025-01-11 00:47:10,555 [trainer.py] => Trainable params: 2014209
2025-01-11 00:47:30,368 [asp.py] => Learning on 20-25
2025-01-11 00:47:30,392 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 00:51:04,727 [asp.py] => total parameters: 173611521
2025-01-11 00:51:04,728 [asp.py] => trainable parameters: 2014209
2025-01-11 00:51:16,933 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55]
2025-01-11 00:51:16,934 [trainer.py] => Average Accuracy (Top1): 89.68750000000001   (Harmonic Accuracy): 85.90542099192619 (Old Acc): 95.0 (New Acc): 78.4 

2025-01-11 00:51:16,935 [trainer.py] => All params: 173611521
2025-01-11 00:51:16,935 [trainer.py] => Trainable params: 2014209
2025-01-11 00:51:39,094 [asp.py] => Learning on 20-25
2025-01-11 00:51:39,105 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:02:34,726 [asp.py] => total parameters: 173615361
2025-01-11 01:02:34,727 [asp.py] => trainable parameters: 2018049
2025-01-11 01:02:48,175 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04]
2025-01-11 01:02:48,176 [trainer.py] => Average Accuracy (Top1): 89.422   (Harmonic Accuracy): 86.99435414884516 (Old Acc): 95.4 (New Acc): 79.95 

2025-01-11 01:02:48,177 [trainer.py] => All params: 173615361
2025-01-11 01:02:48,177 [trainer.py] => Trainable params: 2018049
2025-01-11 01:03:07,768 [asp.py] => Learning on 25-30
2025-01-11 01:03:07,780 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:03:15,795 [asp.py] => total parameters: 173615361
2025-01-11 01:03:15,796 [asp.py] => trainable parameters: 2018049
2025-01-11 01:03:29,569 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4]
2025-01-11 01:03:29,570 [trainer.py] => Average Accuracy (Top1): 85.124   (Harmonic Accuracy): 82.64598930481284 (Old Acc): 95.4 (New Acc): 72.9 

2025-01-11 01:03:29,571 [trainer.py] => All params: 173615361
2025-01-11 01:03:29,572 [trainer.py] => Trainable params: 2018049
2025-01-11 01:03:48,772 [asp.py] => Learning on 25-30
2025-01-11 01:03:48,786 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:08:19,679 [asp.py] => total parameters: 173615361
2025-01-11 01:08:19,680 [asp.py] => trainable parameters: 2018049
2025-01-11 01:08:34,080 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48]
2025-01-11 01:08:34,080 [trainer.py] => Average Accuracy (Top1): 88.04600000000002   (Harmonic Accuracy): 85.62175925925925 (Old Acc): 94.6 (New Acc): 78.2 

2025-01-11 01:08:34,081 [trainer.py] => All params: 173615361
2025-01-11 01:08:34,082 [trainer.py] => Trainable params: 2018049
2025-01-11 01:08:54,118 [asp.py] => Learning on 25-30
2025-01-11 01:08:54,136 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:18:44,730 [asp.py] => total parameters: 173619201
2025-01-11 01:18:44,731 [asp.py] => trainable parameters: 2021889
2025-01-11 01:19:00,176 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1]
2025-01-11 01:19:00,177 [trainer.py] => Average Accuracy (Top1): 87.70166666666667   (Harmonic Accuracy): 84.44909983633389 (Old Acc): 95.2 (New Acc): 75.88000000000001 

2025-01-11 01:19:00,178 [trainer.py] => All params: 173619201
2025-01-11 01:19:00,178 [trainer.py] => Trainable params: 2021889
2025-01-11 01:19:19,568 [asp.py] => Learning on 30-35
2025-01-11 01:19:19,582 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:19:33,961 [asp.py] => total parameters: 173619201
2025-01-11 01:19:33,962 [asp.py] => trainable parameters: 2021889
2025-01-11 01:19:49,981 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23]
2025-01-11 01:19:49,981 [trainer.py] => Average Accuracy (Top1): 83.30833333333334   (Harmonic Accuracy): 80.70452674897118 (Old Acc): 95.2 (New Acc): 70.03999999999999 

2025-01-11 01:19:49,982 [trainer.py] => All params: 173619201
2025-01-11 01:19:49,983 [trainer.py] => Trainable params: 2021889
2025-01-11 01:20:10,289 [asp.py] => Learning on 30-35
2025-01-11 01:20:10,307 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:25:24,726 [asp.py] => total parameters: 173619201
2025-01-11 01:25:24,727 [asp.py] => trainable parameters: 2021889
2025-01-11 01:25:41,965 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83]
2025-01-11 01:25:41,966 [trainer.py] => Average Accuracy (Top1): 86.01   (Harmonic Accuracy): 81.7694931539755 (Old Acc): 94.4 (New Acc): 72.12 

2025-01-11 01:25:41,966 [trainer.py] => All params: 173619201
2025-01-11 01:25:41,967 [trainer.py] => Trainable params: 2021889
2025-01-11 01:26:01,104 [asp.py] => Learning on 30-35
2025-01-11 01:26:01,124 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:34:55,673 [asp.py] => total parameters: 173623041
2025-01-11 01:34:55,674 [asp.py] => trainable parameters: 2025729
2025-01-11 01:35:13,849 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03]
2025-01-11 01:35:13,850 [trainer.py] => Average Accuracy (Top1): 86.03428571428572   (Harmonic Accuracy): 82.42003577817532 (Old Acc): 94.8 (New Acc): 72.9 

2025-01-11 01:35:13,851 [trainer.py] => All params: 173623041
2025-01-11 01:35:13,851 [trainer.py] => Trainable params: 2025729
2025-01-11 01:35:33,583 [asp.py] => Learning on 35-40
2025-01-11 01:35:33,597 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:35:56,067 [asp.py] => total parameters: 173623041
2025-01-11 01:35:56,069 [asp.py] => trainable parameters: 2025729
2025-01-11 01:36:14,857 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14]
2025-01-11 01:36:14,857 [trainer.py] => Average Accuracy (Top1): 81.85571428571428   (Harmonic Accuracy): 80.27355623100304 (Old Acc): 95.0 (New Acc): 69.5 

2025-01-11 01:36:14,858 [trainer.py] => All params: 173623041
2025-01-11 01:36:14,859 [trainer.py] => Trainable params: 2025729
2025-01-11 01:36:34,329 [asp.py] => Learning on 35-40
2025-01-11 01:36:34,344 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:42:31,535 [asp.py] => total parameters: 173623041
2025-01-11 01:42:31,536 [asp.py] => trainable parameters: 2025729
2025-01-11 01:42:50,852 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97]
2025-01-11 01:42:50,853 [trainer.py] => Average Accuracy (Top1): 84.14714285714287   (Harmonic Accuracy): 79.94239152576898 (Old Acc): 94.2 (New Acc): 69.43333333333332 

2025-01-11 01:42:50,855 [trainer.py] => All params: 173623041
2025-01-11 01:42:50,857 [trainer.py] => Trainable params: 2025729
2025-01-11 01:43:09,490 [asp.py] => Learning on 35-40
2025-01-11 01:43:09,505 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:51:10,366 [asp.py] => total parameters: 173626881
2025-01-11 01:51:10,367 [asp.py] => trainable parameters: 2029569
2025-01-11 01:51:30,588 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4]
2025-01-11 01:51:30,589 [trainer.py] => Average Accuracy (Top1): 84.455   (Harmonic Accuracy): 79.98314606741575 (Old Acc): 92.0 (New Acc): 70.74285714285715 

2025-01-11 01:51:30,590 [trainer.py] => All params: 173626881
2025-01-11 01:51:30,590 [trainer.py] => Trainable params: 2029569
2025-01-11 01:51:49,680 [asp.py] => Learning on 40-45
2025-01-11 01:51:49,700 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:52:20,893 [asp.py] => total parameters: 173626881
2025-01-11 01:52:20,895 [asp.py] => trainable parameters: 2029569
2025-01-11 01:52:41,862 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35]
2025-01-11 01:52:41,862 [trainer.py] => Average Accuracy (Top1): 80.5425   (Harmonic Accuracy): 78.83514851485148 (Old Acc): 93.4 (New Acc): 68.2 

2025-01-11 01:52:41,863 [trainer.py] => All params: 173626881
2025-01-11 01:52:41,864 [trainer.py] => Trainable params: 2029569
2025-01-11 01:53:01,452 [asp.py] => Learning on 40-45
2025-01-11 01:53:01,482 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 01:59:39,898 [asp.py] => total parameters: 173626881
2025-01-11 01:59:39,899 [asp.py] => trainable parameters: 2029569
2025-01-11 02:00:01,381 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62]
2025-01-11 02:00:01,381 [trainer.py] => Average Accuracy (Top1): 82.58125000000001   (Harmonic Accuracy): 78.560912168181 (Old Acc): 91.6 (New Acc): 68.77142857142857 

2025-01-11 02:00:01,382 [trainer.py] => All params: 173626881
2025-01-11 02:00:01,383 [trainer.py] => Trainable params: 2029569
2025-01-11 02:00:21,291 [asp.py] => Learning on 40-45
2025-01-11 02:00:21,308 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 02:07:26,412 [asp.py] => total parameters: 173630721
2025-01-11 02:07:26,414 [asp.py] => trainable parameters: 2033409
2025-01-11 02:07:48,595 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04]
2025-01-11 02:07:48,595 [trainer.py] => Average Accuracy (Top1): 83.18666666666667   (Harmonic Accuracy): 79.88012307692308 (Old Acc): 91.8 (New Acc): 70.7 

2025-01-11 02:07:48,596 [trainer.py] => All params: 173630721
2025-01-11 02:07:48,597 [trainer.py] => Trainable params: 2033409
2025-01-11 02:08:08,441 [asp.py] => Learning on 45-50
2025-01-11 02:08:08,457 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 02:08:50,309 [asp.py] => total parameters: 173630721
2025-01-11 02:08:50,309 [asp.py] => trainable parameters: 2033409
2025-01-11 02:09:12,868 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53]
2025-01-11 02:09:12,868 [trainer.py] => Average Accuracy (Top1): 79.43   (Harmonic Accuracy): 78.42933499067745 (Old Acc): 93.2 (New Acc): 67.69999999999999 

2025-01-11 02:09:12,869 [trainer.py] => All params: 173630721
2025-01-11 02:09:12,870 [trainer.py] => Trainable params: 2033409
2025-01-11 02:09:33,748 [asp.py] => Learning on 45-50
2025-01-11 02:09:33,776 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 02:16:54,625 [asp.py] => total parameters: 173630721
2025-01-11 02:16:54,626 [asp.py] => trainable parameters: 2033409
2025-01-11 02:17:18,758 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82]
2025-01-11 02:17:18,758 [trainer.py] => Average Accuracy (Top1): 81.27444444444444   (Harmonic Accuracy): 78.08973193290484 (Old Acc): 91.2 (New Acc): 68.275 

2025-01-11 02:17:18,759 [trainer.py] => All params: 173630721
2025-01-11 02:17:18,760 [trainer.py] => Trainable params: 2033409
2025-01-11 02:17:44,502 [asp.py] => Learning on 45-50
2025-01-11 02:17:44,521 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 02:23:47,796 [asp.py] => total parameters: 173634561
2025-01-11 02:23:47,796 [asp.py] => trainable parameters: 2037249
2025-01-11 02:24:12,245 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04, 71.3]
2025-01-11 02:24:12,245 [trainer.py] => Average Accuracy (Top1): 81.99799999999999   (Harmonic Accuracy): 78.7980654967528 (Old Acc): 91.8 (New Acc): 69.02222222222221 

2025-01-11 02:24:12,246 [trainer.py] => All params: 173634561
2025-01-11 02:24:12,247 [trainer.py] => Trainable params: 2037249
2025-01-11 02:24:30,755 [asp.py] => Learning on 50-55
2025-01-11 02:24:30,774 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 02:25:20,527 [asp.py] => total parameters: 173634561
2025-01-11 02:25:20,527 [asp.py] => trainable parameters: 2037249
2025-01-11 02:25:45,851 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53, 68.68]
2025-01-11 02:25:45,852 [trainer.py] => Average Accuracy (Top1): 78.35499999999999   (Harmonic Accuracy): 77.24590896397655 (Old Acc): 93.2 (New Acc): 65.95555555555556 

2025-01-11 02:25:45,853 [trainer.py] => All params: 173634561
2025-01-11 02:25:45,854 [trainer.py] => Trainable params: 2037249
2025-01-11 02:26:05,149 [asp.py] => Learning on 50-55
2025-01-11 02:26:05,173 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 02:34:22,991 [asp.py] => total parameters: 173634561
2025-01-11 02:34:22,993 [asp.py] => trainable parameters: 2037249
2025-01-11 02:34:49,659 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82, 69.42]
2025-01-11 02:34:49,659 [trainer.py] => Average Accuracy (Top1): 80.089   (Harmonic Accuracy): 77.24905183312264 (Old Acc): 91.2 (New Acc): 67.0 

2025-01-11 02:34:49,660 [trainer.py] => All params: 173634561
2025-01-11 02:34:49,661 [trainer.py] => Trainable params: 2037249
2025-01-11 02:35:11,313 [asp.py] => Learning on 50-55
2025-01-11 02:35:11,330 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 02:40:06,591 [asp.py] => total parameters: 173638401
2025-01-11 02:40:06,592 [asp.py] => trainable parameters: 2041089
2025-01-11 02:40:33,417 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04, 71.3, 71.71]
2025-01-11 02:40:33,418 [trainer.py] => Average Accuracy (Top1): 81.06272727272727   (Harmonic Accuracy): 79.2378947368421 (Old Acc): 91.8 (New Acc): 69.69999999999999 

2025-01-11 02:40:33,419 [trainer.py] => All params: 173638401
2025-01-11 02:40:33,419 [trainer.py] => Trainable params: 2041089
2025-01-11 02:40:52,080 [asp.py] => Learning on 55-60
2025-01-11 02:40:52,100 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 02:41:51,266 [asp.py] => total parameters: 173638401
2025-01-11 02:41:51,267 [asp.py] => trainable parameters: 2041089
2025-01-11 02:42:18,903 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53, 68.68, 68.82]
2025-01-11 02:42:18,904 [trainer.py] => Average Accuracy (Top1): 77.48818181818181   (Harmonic Accuracy): 77.4805520702635 (Old Acc): 93.0 (New Acc): 66.4 

2025-01-11 02:42:18,905 [trainer.py] => All params: 173638401
2025-01-11 02:42:18,905 [trainer.py] => Trainable params: 2041089
2025-01-11 02:42:43,561 [asp.py] => Learning on 55-60
2025-01-11 02:42:43,587 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 02:51:44,514 [asp.py] => total parameters: 173638401
2025-01-11 02:51:44,515 [asp.py] => trainable parameters: 2041089
2025-01-11 02:52:14,049 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82, 69.42, 69.31]
2025-01-11 02:52:14,050 [trainer.py] => Average Accuracy (Top1): 79.10909090909091   (Harmonic Accuracy): 77.21104076981516 (Old Acc): 90.8 (New Acc): 67.16 

2025-01-11 02:52:14,051 [trainer.py] => All params: 173638401
2025-01-11 02:52:14,052 [trainer.py] => Trainable params: 2041089
2025-01-11 02:52:45,453 [asp.py] => Learning on 55-60
2025-01-11 02:52:45,475 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 02:56:31,121 [asp.py] => total parameters: 173642241
2025-01-11 02:56:31,122 [asp.py] => trainable parameters: 2044929
2025-01-11 02:57:00,284 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04, 71.3, 71.71, 69.72]
2025-01-11 02:57:00,284 [trainer.py] => Average Accuracy (Top1): 80.11749999999999   (Harmonic Accuracy): 77.87515690973412 (Old Acc): 91.6 (New Acc): 67.72727272727273 

2025-01-11 02:57:00,285 [trainer.py] => All params: 173642241
2025-01-11 02:57:00,285 [trainer.py] => Trainable params: 2044929
2025-01-11 02:57:19,996 [asp.py] => Learning on 60-65
2025-01-11 02:57:20,024 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 02:58:31,974 [asp.py] => total parameters: 173642241
2025-01-11 02:58:31,976 [asp.py] => trainable parameters: 2044929
2025-01-11 02:59:01,744 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53, 68.68, 68.82, 67.33]
2025-01-11 02:59:01,744 [trainer.py] => Average Accuracy (Top1): 76.64166666666667   (Harmonic Accuracy): 76.51898734177215 (Old Acc): 93.0 (New Acc): 65.0 

2025-01-11 02:59:01,745 [trainer.py] => All params: 173642241
2025-01-11 02:59:01,746 [trainer.py] => Trainable params: 2044929
2025-01-11 02:59:20,683 [asp.py] => Learning on 60-65
2025-01-11 02:59:20,704 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 03:09:25,887 [asp.py] => total parameters: 173642241
2025-01-11 03:09:25,888 [asp.py] => trainable parameters: 2044929
2025-01-11 03:09:56,883 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82, 69.42, 69.31, 67.78]
2025-01-11 03:09:56,884 [trainer.py] => Average Accuracy (Top1): 78.165   (Harmonic Accuracy): 76.17271141095729 (Old Acc): 90.6 (New Acc): 65.7090909090909 

2025-01-11 03:09:56,885 [trainer.py] => All params: 173642241
2025-01-11 03:09:56,886 [trainer.py] => Trainable params: 2044929
2025-01-11 03:10:18,373 [asp.py] => Learning on 60-65
2025-01-11 03:10:18,391 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 03:12:58,550 [asp.py] => total parameters: 173646081
2025-01-11 03:12:58,551 [asp.py] => trainable parameters: 2048769
2025-01-11 03:13:29,954 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04, 71.3, 71.71, 69.72, 68.49]
2025-01-11 03:13:29,954 [trainer.py] => Average Accuracy (Top1): 79.22307692307692   (Harmonic Accuracy): 77.04251503323137 (Old Acc): 91.4 (New Acc): 66.58333333333334 

2025-01-11 03:13:29,955 [trainer.py] => All params: 173646081
2025-01-11 03:13:29,956 [trainer.py] => Trainable params: 2048769
2025-01-11 03:13:48,717 [asp.py] => Learning on 65-70
2025-01-11 03:13:48,735 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 03:15:07,776 [asp.py] => total parameters: 173646081
2025-01-11 03:15:07,777 [asp.py] => trainable parameters: 2048769
2025-01-11 03:15:39,887 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53, 68.68, 68.82, 67.33, 65.91]
2025-01-11 03:15:39,887 [trainer.py] => Average Accuracy (Top1): 75.81615384615384   (Harmonic Accuracy): 75.57548675391 (Old Acc): 93.0 (New Acc): 63.650000000000006 

2025-01-11 03:15:39,888 [trainer.py] => All params: 173646081
2025-01-11 03:15:39,889 [trainer.py] => Trainable params: 2048769
2025-01-11 03:15:58,533 [asp.py] => Learning on 65-70
2025-01-11 03:15:58,555 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 03:26:50,434 [asp.py] => total parameters: 173646081
2025-01-11 03:26:50,435 [asp.py] => trainable parameters: 2048769
2025-01-11 03:27:25,094 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82, 69.42, 69.31, 67.78, 65.89]
2025-01-11 03:27:25,095 [trainer.py] => Average Accuracy (Top1): 77.22076923076924   (Harmonic Accuracy): 74.78286456079618 (Old Acc): 90.2 (New Acc): 63.86666666666665 

2025-01-11 03:27:25,095 [trainer.py] => All params: 173646081
2025-01-11 03:27:25,096 [trainer.py] => Trainable params: 2048769
2025-01-11 03:28:12,566 [asp.py] => Learning on 65-70
2025-01-11 03:28:12,589 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 03:29:26,707 [asp.py] => total parameters: 173649921
2025-01-11 03:29:26,708 [asp.py] => trainable parameters: 2052609
2025-01-11 03:30:00,719 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04, 71.3, 71.71, 69.72, 68.49, 67.84]
2025-01-11 03:30:00,720 [trainer.py] => Average Accuracy (Top1): 78.40999999999998   (Harmonic Accuracy): 76.73120546608101 (Old Acc): 91.6 (New Acc): 66.01538461538462 

2025-01-11 03:30:00,721 [trainer.py] => All params: 173649921
2025-01-11 03:30:00,721 [trainer.py] => Trainable params: 2052609
2025-01-11 03:30:36,569 [asp.py] => Learning on 70-75
2025-01-11 03:30:36,597 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 03:31:47,737 [asp.py] => total parameters: 173649921
2025-01-11 03:31:47,739 [asp.py] => trainable parameters: 2052609
2025-01-11 03:32:22,897 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53, 68.68, 68.82, 67.33, 65.91, 66.07]
2025-01-11 03:32:22,897 [trainer.py] => Average Accuracy (Top1): 75.11999999999999   (Harmonic Accuracy): 75.6536925951421 (Old Acc): 92.4 (New Acc): 64.04615384615384 

2025-01-11 03:32:22,898 [trainer.py] => All params: 173649921
2025-01-11 03:32:22,899 [trainer.py] => Trainable params: 2052609
2025-01-11 03:32:43,105 [asp.py] => Learning on 70-75
2025-01-11 03:32:43,147 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 03:44:41,818 [asp.py] => total parameters: 173649921
2025-01-11 03:44:41,819 [asp.py] => trainable parameters: 2052609
2025-01-11 03:45:18,160 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82, 69.42, 69.31, 67.78, 65.89, 65.51]
2025-01-11 03:45:18,160 [trainer.py] => Average Accuracy (Top1): 76.38428571428572   (Harmonic Accuracy): 74.5523733226517 (Old Acc): 90.0 (New Acc): 63.630769230769225 

2025-01-11 03:45:18,161 [trainer.py] => All params: 173649921
2025-01-11 03:45:18,162 [trainer.py] => Trainable params: 2052609
2025-01-11 03:45:39,727 [asp.py] => Learning on 70-75
2025-01-11 03:45:39,782 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 03:46:15,230 [asp.py] => total parameters: 173653761
2025-01-11 03:46:15,231 [asp.py] => trainable parameters: 2056449
2025-01-11 03:46:51,927 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04, 71.3, 71.71, 69.72, 68.49, 67.84, 65.64]
2025-01-11 03:46:51,927 [trainer.py] => Average Accuracy (Top1): 77.55866666666665   (Harmonic Accuracy): 75.03007935043365 (Old Acc): 91.0 (New Acc): 63.82857142857142 

2025-01-11 03:46:51,928 [trainer.py] => All params: 173653761
2025-01-11 03:46:51,929 [trainer.py] => Trainable params: 2056449
2025-01-11 03:47:13,510 [asp.py] => Learning on 75-80
2025-01-11 03:47:13,551 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 03:48:31,620 [asp.py] => total parameters: 173653761
2025-01-11 03:48:31,621 [asp.py] => trainable parameters: 2056449
2025-01-11 03:49:08,496 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53, 68.68, 68.82, 67.33, 65.91, 66.07, 64.75]
2025-01-11 03:49:08,496 [trainer.py] => Average Accuracy (Top1): 74.42866666666666   (Harmonic Accuracy): 74.59015060519265 (Old Acc): 91.8 (New Acc): 62.81428571428571 

2025-01-11 03:49:08,498 [trainer.py] => All params: 173653761
2025-01-11 03:49:08,498 [trainer.py] => Trainable params: 2056449
2025-01-11 03:49:27,321 [asp.py] => Learning on 75-80
2025-01-11 03:49:27,344 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:02:11,840 [asp.py] => total parameters: 173653761
2025-01-11 04:02:11,841 [asp.py] => trainable parameters: 2056449
2025-01-11 04:02:50,586 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82, 69.42, 69.31, 67.78, 65.89, 65.51, 63.61]
2025-01-11 04:02:50,587 [trainer.py] => Average Accuracy (Top1): 75.53266666666667   (Harmonic Accuracy): 72.88961396187044 (Old Acc): 88.8 (New Acc): 61.81428571428571 

2025-01-11 04:02:50,589 [trainer.py] => All params: 173653761
2025-01-11 04:02:50,590 [trainer.py] => Trainable params: 2056449
2025-01-11 04:02:52,139 [asp.py] => total parameters: 173657601
2025-01-11 04:02:52,140 [asp.py] => trainable parameters: 2060289
2025-01-11 04:03:11,208 [asp.py] => Learning on 75-80
2025-01-11 04:03:11,229 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:03:30,803 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04, 71.3, 71.71, 69.72, 68.49, 67.84, 65.64, 66.35]
2025-01-11 04:03:30,803 [trainer.py] => Average Accuracy (Top1): 76.85812499999999   (Harmonic Accuracy): 75.69319192610332 (Old Acc): 91.2 (New Acc): 64.69333333333334 

2025-01-11 04:03:30,804 [trainer.py] => All params: 173657601
2025-01-11 04:03:30,805 [trainer.py] => Trainable params: 2060289
2025-01-11 04:03:50,203 [asp.py] => Learning on 80-85
2025-01-11 04:03:50,230 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:05:16,035 [asp.py] => total parameters: 173657601
2025-01-11 04:05:16,037 [asp.py] => trainable parameters: 2060289
2025-01-11 04:05:55,592 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53, 68.68, 68.82, 67.33, 65.91, 66.07, 64.75, 65.31]
2025-01-11 04:05:55,593 [trainer.py] => Average Accuracy (Top1): 73.85874999999999   (Harmonic Accuracy): 75.1040769032701 (Old Acc): 91.8 (New Acc): 63.54666666666666 

2025-01-11 04:05:55,594 [trainer.py] => All params: 173657601
2025-01-11 04:05:55,596 [trainer.py] => Trainable params: 2060289
2025-01-11 04:06:15,725 [asp.py] => Learning on 80-85
2025-01-11 04:06:15,751 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:19:30,218 [asp.py] => total parameters: 173661441
2025-01-11 04:19:30,219 [asp.py] => trainable parameters: 2064129
2025-01-11 04:19:52,476 [asp.py] => total parameters: 173657601
2025-01-11 04:19:52,477 [asp.py] => trainable parameters: 2060289
2025-01-11 04:20:10,852 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04, 71.3, 71.71, 69.72, 68.49, 67.84, 65.64, 66.35, 66.48]
2025-01-11 04:20:10,852 [trainer.py] => Average Accuracy (Top1): 76.24764705882352   (Harmonic Accuracy): 75.86005924265471 (Old Acc): 91.2 (New Acc): 64.9375 

2025-01-11 04:20:10,853 [trainer.py] => All params: 173661441
2025-01-11 04:20:10,854 [trainer.py] => Trainable params: 2064129
2025-01-11 04:20:31,249 [asp.py] => Learning on 85-90
2025-01-11 04:20:31,275 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:20:34,216 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82, 69.42, 69.31, 67.78, 65.89, 65.51, 63.61, 64.7]
2025-01-11 04:20:34,217 [trainer.py] => Average Accuracy (Top1): 74.855625   (Harmonic Accuracy): 74.00922431865827 (Old Acc): 89.6 (New Acc): 63.03999999999999 

2025-01-11 04:20:34,218 [trainer.py] => All params: 173657601
2025-01-11 04:20:34,219 [trainer.py] => Trainable params: 2060289
2025-01-11 04:21:16,422 [asp.py] => Learning on 80-85
2025-01-11 04:21:16,454 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:22:04,837 [asp.py] => total parameters: 173661441
2025-01-11 04:22:04,838 [asp.py] => trainable parameters: 2064129
2025-01-11 04:22:47,008 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53, 68.68, 68.82, 67.33, 65.91, 66.07, 64.75, 65.31, 65.08]
2025-01-11 04:22:47,009 [trainer.py] => Average Accuracy (Top1): 73.34235294117646   (Harmonic Accuracy): 75.01029234114522 (Old Acc): 91.8 (New Acc): 63.41250000000001 

2025-01-11 04:22:47,010 [trainer.py] => All params: 173661441
2025-01-11 04:22:47,010 [trainer.py] => Trainable params: 2064129
2025-01-11 04:23:09,903 [asp.py] => Learning on 85-90
2025-01-11 04:23:09,946 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:36:12,958 [asp.py] => total parameters: 173665281
2025-01-11 04:36:12,959 [asp.py] => trainable parameters: 2067969
2025-01-11 04:36:55,688 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04, 71.3, 71.71, 69.72, 68.49, 67.84, 65.64, 66.35, 66.48, 66.61]
2025-01-11 04:36:55,689 [trainer.py] => Average Accuracy (Top1): 75.71222222222221   (Harmonic Accuracy): 75.95329566854991 (Old Acc): 91.0 (New Acc): 65.1764705882353 

2025-01-11 04:36:55,690 [trainer.py] => All params: 173665281
2025-01-11 04:36:55,691 [trainer.py] => Trainable params: 2067969
2025-01-11 04:37:15,645 [asp.py] => Learning on 90-95
2025-01-11 04:37:15,667 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:37:46,816 [asp.py] => total parameters: 173661441
2025-01-11 04:37:46,817 [asp.py] => trainable parameters: 2064129
2025-01-11 04:38:30,426 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82, 69.42, 69.31, 67.78, 65.89, 65.51, 63.61, 64.7, 64.36]
2025-01-11 04:38:30,427 [trainer.py] => Average Accuracy (Top1): 74.23823529411764   (Harmonic Accuracy): 73.65618310554915 (Old Acc): 89.0 (New Acc): 62.824999999999996 

2025-01-11 04:38:30,428 [trainer.py] => All params: 173661441
2025-01-11 04:38:30,428 [trainer.py] => Trainable params: 2064129
2025-01-11 04:38:48,977 [asp.py] => Learning on 85-90
2025-01-11 04:38:49,006 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:38:57,749 [asp.py] => total parameters: 173665281
2025-01-11 04:38:57,750 [asp.py] => trainable parameters: 2067969
2025-01-11 04:39:42,034 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53, 68.68, 68.82, 67.33, 65.91, 66.07, 64.75, 65.31, 65.08, 64.84]
2025-01-11 04:39:42,035 [trainer.py] => Average Accuracy (Top1): 72.86999999999998   (Harmonic Accuracy): 74.78560997870399 (Old Acc): 91.4 (New Acc): 63.28235294117647 

2025-01-11 04:39:42,036 [trainer.py] => All params: 173665281
2025-01-11 04:39:42,037 [trainer.py] => Trainable params: 2067969
2025-01-11 04:40:04,832 [asp.py] => Learning on 90-95
2025-01-11 04:40:04,867 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:53:02,808 [asp.py] => total parameters: 173669121
2025-01-11 04:53:02,809 [asp.py] => trainable parameters: 2071809
2025-01-11 04:53:47,408 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04, 71.3, 71.71, 69.72, 68.49, 67.84, 65.64, 66.35, 66.48, 66.61, 65.79]
2025-01-11 04:53:47,408 [trainer.py] => Average Accuracy (Top1): 75.18999999999998   (Harmonic Accuracy): 75.41580264569181 (Old Acc): 91.0 (New Acc): 64.3888888888889 

2025-01-11 04:53:47,409 [trainer.py] => All params: 173669121
2025-01-11 04:53:47,410 [trainer.py] => Trainable params: 2071809
2025-01-11 04:54:06,685 [asp.py] => Learning on 95-100
2025-01-11 04:54:06,710 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:55:27,148 [asp.py] => total parameters: 173665281
2025-01-11 04:55:27,149 [asp.py] => trainable parameters: 2067969
2025-01-11 04:55:53,451 [asp.py] => total parameters: 173669121
2025-01-11 04:55:53,452 [asp.py] => trainable parameters: 2071809
2025-01-11 04:56:13,487 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82, 69.42, 69.31, 67.78, 65.89, 65.51, 63.61, 64.7, 64.36, 64.58]
2025-01-11 04:56:13,487 [trainer.py] => Average Accuracy (Top1): 73.70166666666665   (Harmonic Accuracy): 73.8120780427377 (Old Acc): 88.8 (New Acc): 63.1529411764706 

2025-01-11 04:56:13,489 [trainer.py] => All params: 173665281
2025-01-11 04:56:13,489 [trainer.py] => Trainable params: 2067969
2025-01-11 04:56:32,792 [asp.py] => Learning on 90-95
2025-01-11 04:56:32,815 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:56:39,965 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53, 68.68, 68.82, 67.33, 65.91, 66.07, 64.75, 65.31, 65.08, 64.84, 64.0]
2025-01-11 04:56:39,966 [trainer.py] => Average Accuracy (Top1): 72.40315789473682   (Harmonic Accuracy): 74.22083904975088 (Old Acc): 91.4 (New Acc): 62.477777777777774 

2025-01-11 04:56:39,967 [trainer.py] => All params: 173669121
2025-01-11 04:56:39,968 [trainer.py] => Trainable params: 2071809
2025-01-11 04:56:59,460 [asp.py] => Learning on 95-100
2025-01-11 04:56:59,494 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 05:09:48,086 [asp.py] => total parameters: 173672961
2025-01-11 05:09:48,086 [asp.py] => trainable parameters: 2075649
2025-01-11 05:10:35,157 [trainer.py] => Top1 curve: [97.8, 95.8, 86.47, 84.0, 83.04, 79.1, 76.03, 73.4, 73.04, 71.3, 71.71, 69.72, 68.49, 67.84, 65.64, 66.35, 66.48, 66.61, 65.79, 64.44]
2025-01-11 05:10:35,158 [trainer.py] => Average Accuracy (Top1): 74.65249999999999   (Harmonic Accuracy): 74.48394150608172 (Old Acc): 91.0 (New Acc): 63.04210526315789 

2025-01-11 05:10:35,158 [trainer.py] => 

2025-01-11 05:12:49,812 [asp.py] => total parameters: 173672961
2025-01-11 05:12:49,813 [asp.py] => trainable parameters: 2075649
2025-01-11 05:13:06,949 [asp.py] => total parameters: 173669121
2025-01-11 05:13:06,950 [asp.py] => trainable parameters: 2071809
2025-01-11 05:13:41,479 [trainer.py] => Top1 curve: [97.8, 92.9, 79.27, 78.25, 77.4, 74.23, 73.14, 71.35, 70.53, 68.68, 68.82, 67.33, 65.91, 66.07, 64.75, 65.31, 65.08, 64.84, 64.0, 63.06]
2025-01-11 05:13:41,479 [trainer.py] => Average Accuracy (Top1): 71.93599999999998   (Harmonic Accuracy): 73.5179826374535 (Old Acc): 91.2 (New Acc): 61.57894736842106 

2025-01-11 05:13:41,480 [trainer.py] => 

2025-01-11 05:13:58,219 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82, 69.42, 69.31, 67.78, 65.89, 65.51, 63.61, 64.7, 64.36, 64.58, 63.69]
2025-01-11 05:13:58,220 [trainer.py] => Average Accuracy (Top1): 73.17473684210526   (Harmonic Accuracy): 73.16577823590045 (Old Acc): 88.6 (New Acc): 62.3111111111111 

2025-01-11 05:13:58,221 [trainer.py] => All params: 173669121
2025-01-11 05:13:58,221 [trainer.py] => Trainable params: 2071809
2025-01-11 05:14:17,699 [asp.py] => Learning on 95-100
2025-01-11 05:14:17,720 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 05:30:53,962 [asp.py] => total parameters: 173672961
2025-01-11 05:30:53,963 [asp.py] => trainable parameters: 2075649
2025-01-11 05:31:45,940 [trainer.py] => Top1 curve: [97.0, 93.8, 85.4, 82.55, 81.48, 75.83, 72.97, 71.62, 70.82, 69.42, 69.31, 67.78, 65.89, 65.51, 63.61, 64.7, 64.36, 64.58, 63.69, 62.66]
2025-01-11 05:31:45,941 [trainer.py] => Average Accuracy (Top1): 72.649   (Harmonic Accuracy): 72.46036516853931 (Old Acc): 88.6 (New Acc): 61.29473684210526 

2025-01-11 05:31:45,941 [trainer.py] => 

2025-01-13 17:57:30,690 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-13 17:57:30,690 [trainer.py] => model_name: asp
2025-01-13 17:57:30,690 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-13 17:57:30,690 [trainer.py] => device: ['cuda']
2025-01-13 17:57:30,690 [trainer.py] => seed: 2024
2025-01-13 17:57:30,690 [trainer.py] => dataset: cifar224
2025-01-13 17:57:30,690 [trainer.py] => init_cls: 5
2025-01-13 17:57:30,691 [trainer.py] => increment: 5
2025-01-13 17:57:30,691 [trainer.py] => kshot: 5
2025-01-13 17:57:30,691 [trainer.py] => generator_model: CIFAR_GEN
2025-01-13 17:57:30,691 [trainer.py] => z_dim: 1000
2025-01-13 17:57:30,691 [trainer.py] => conv_dim: 64
2025-01-13 17:57:30,691 [trainer.py] => img_size: 224
2025-01-13 17:57:30,691 [trainer.py] => generator_lr: 0.005
2025-01-13 17:57:30,691 [trainer.py] => pi: 100
2025-01-13 17:57:30,691 [trainer.py] => w_bn: 50.0
2025-01-13 17:57:30,691 [trainer.py] => w_noise: 0.001
2025-01-13 17:57:30,691 [trainer.py] => server_ss: 32
2025-01-13 17:57:30,691 [trainer.py] => bn_loss: 1
2025-01-13 17:57:30,691 [trainer.py] => noise: 1
2025-01-13 17:57:30,692 [trainer.py] => ie_loss: 1
2025-01-13 17:57:30,692 [trainer.py] => act_loss: 0
2025-01-13 17:57:30,692 [trainer.py] => w_ie: 1.0
2025-01-13 17:57:30,692 [trainer.py] => w_act: 0.1
2025-01-13 17:57:30,692 [trainer.py] => syn_size: 32
2025-01-13 17:57:30,692 [trainer.py] => need_syn_imgs: True
2025-01-13 17:57:30,692 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-13 17:57:30,692 [trainer.py] => g_local_train_steps: 5
2025-01-13 17:57:30,692 [trainer.py] => dataset_syn: cifar100
2025-01-13 17:57:30,692 [trainer.py] => com_round_gen: 10
2025-01-13 17:57:30,692 [trainer.py] => g_sigma: 0
2025-01-13 17:57:30,692 [trainer.py] => save_cls_embeds: False
2025-01-13 17:57:30,692 [trainer.py] => syn_image_path: outputs/syn_image_60_5_pre0.0_local_bs48_5
2025-01-13 17:57:30,693 [trainer.py] => save_dir: outputs
2025-01-13 17:57:30,693 [trainer.py] => n_iter: 5
2025-01-13 17:57:30,693 [trainer.py] => num_users: 1
2025-01-13 17:57:30,693 [trainer.py] => cur_size: 10
2025-01-13 17:57:30,693 [trainer.py] => g_local_bs: 5
2025-01-13 17:57:30,693 [trainer.py] => local_bs0: 5
2025-01-13 17:57:30,693 [trainer.py] => local_bs1: 5
2025-01-13 17:57:30,693 [trainer.py] => pre_size: 48
2025-01-13 17:57:30,693 [trainer.py] => w_ce_pre: 0.5
2025-01-13 17:57:30,693 [trainer.py] => vpt_type: Deep
2025-01-13 17:57:30,693 [trainer.py] => prompt_token_num: 6
2025-01-13 17:57:30,693 [trainer.py] => avg_alpha: 0.8
2025-01-13 17:57:30,694 [trainer.py] => perturb_var: 1
2025-01-13 17:57:30,694 [trainer.py] => EMA_beta: 0.99
2025-01-13 17:57:30,694 [trainer.py] => anchor_lambda: 0.1
2025-01-13 17:57:30,694 [trainer.py] => kl_weight: 0.001
2025-01-13 17:57:30,694 [trainer.py] => TIP_init: zero
2025-01-13 17:57:30,694 [trainer.py] => tuned_epoch: 10
2025-01-13 17:57:30,694 [trainer.py] => fs_epoch: 0
2025-01-13 17:57:30,694 [trainer.py] => init_lr: 0.01
2025-01-13 17:57:30,694 [trainer.py] => fs_lr: 0.001
2025-01-13 17:57:30,694 [trainer.py] => batch_size: 48
2025-01-13 17:57:30,694 [trainer.py] => fs_batch_size: 16
2025-01-13 17:57:30,694 [trainer.py] => weight_decay: 0.0005
2025-01-13 17:57:30,695 [trainer.py] => min_lr: 0
2025-01-13 17:57:30,695 [trainer.py] => optimizer: sgd
2025-01-13 17:57:30,695 [trainer.py] => memory_size: 0
2025-01-13 17:57:30,695 [trainer.py] => memory_per_class: 0
2025-01-13 17:57:30,695 [trainer.py] => fixed_memory: False
2025-01-13 17:57:30,695 [trainer.py] => shuffle: False
2025-01-13 17:57:30,695 [trainer.py] => top_k: 5
2025-01-13 17:57:30,695 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-13 17:57:30,695 [trainer.py] => prefix: asp
2025-01-13 17:57:30,695 [trainer.py] => model_prefix: asp
2025-01-13 17:57:33,168 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-13 17:57:56,751 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-13 17:57:56,751 [trainer.py] => model_name: asp
2025-01-13 17:57:56,751 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-13 17:57:56,751 [trainer.py] => device: ['cuda']
2025-01-13 17:57:56,751 [trainer.py] => seed: 2024
2025-01-13 17:57:56,751 [trainer.py] => dataset: cifar224
2025-01-13 17:57:56,751 [trainer.py] => init_cls: 5
2025-01-13 17:57:56,751 [trainer.py] => increment: 5
2025-01-13 17:57:56,751 [trainer.py] => kshot: 5
2025-01-13 17:57:56,751 [trainer.py] => generator_model: CIFAR_GEN
2025-01-13 17:57:56,751 [trainer.py] => z_dim: 1000
2025-01-13 17:57:56,751 [trainer.py] => conv_dim: 64
2025-01-13 17:57:56,752 [trainer.py] => img_size: 224
2025-01-13 17:57:56,752 [trainer.py] => generator_lr: 0.005
2025-01-13 17:57:56,752 [trainer.py] => pi: 100
2025-01-13 17:57:56,752 [trainer.py] => w_bn: 50.0
2025-01-13 17:57:56,752 [trainer.py] => w_noise: 0.001
2025-01-13 17:57:56,752 [trainer.py] => server_ss: 32
2025-01-13 17:57:56,752 [trainer.py] => bn_loss: 1
2025-01-13 17:57:56,752 [trainer.py] => noise: 1
2025-01-13 17:57:56,752 [trainer.py] => ie_loss: 1
2025-01-13 17:57:56,752 [trainer.py] => act_loss: 0
2025-01-13 17:57:56,752 [trainer.py] => w_ie: 1.0
2025-01-13 17:57:56,752 [trainer.py] => w_act: 0.1
2025-01-13 17:57:56,752 [trainer.py] => syn_size: 32
2025-01-13 17:57:56,752 [trainer.py] => need_syn_imgs: True
2025-01-13 17:57:56,752 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-13 17:57:56,752 [trainer.py] => g_local_train_steps: 5
2025-01-13 17:57:56,752 [trainer.py] => dataset_syn: cifar100
2025-01-13 17:57:56,752 [trainer.py] => com_round_gen: 10
2025-01-13 17:57:56,752 [trainer.py] => g_sigma: 0
2025-01-13 17:57:56,752 [trainer.py] => save_cls_embeds: False
2025-01-13 17:57:56,752 [trainer.py] => syn_image_path: outputs/syn_image_60_5_pre0.0_local_bs48_5
2025-01-13 17:57:56,752 [trainer.py] => save_dir: outputs
2025-01-13 17:57:56,752 [trainer.py] => n_iter: 5
2025-01-13 17:57:56,752 [trainer.py] => num_users: 1
2025-01-13 17:57:56,752 [trainer.py] => cur_size: 5
2025-01-13 17:57:56,752 [trainer.py] => g_local_bs: 5
2025-01-13 17:57:56,752 [trainer.py] => local_bs0: 5
2025-01-13 17:57:56,752 [trainer.py] => local_bs1: 5
2025-01-13 17:57:56,752 [trainer.py] => pre_size: 48
2025-01-13 17:57:56,753 [trainer.py] => w_ce_pre: 0.5
2025-01-13 17:57:56,753 [trainer.py] => vpt_type: Deep
2025-01-13 17:57:56,753 [trainer.py] => prompt_token_num: 6
2025-01-13 17:57:56,753 [trainer.py] => avg_alpha: 0.8
2025-01-13 17:57:56,753 [trainer.py] => perturb_var: 1
2025-01-13 17:57:56,753 [trainer.py] => EMA_beta: 0.99
2025-01-13 17:57:56,753 [trainer.py] => anchor_lambda: 0.1
2025-01-13 17:57:56,753 [trainer.py] => kl_weight: 0.001
2025-01-13 17:57:56,753 [trainer.py] => TIP_init: zero
2025-01-13 17:57:56,753 [trainer.py] => tuned_epoch: 10
2025-01-13 17:57:56,753 [trainer.py] => fs_epoch: 0
2025-01-13 17:57:56,753 [trainer.py] => init_lr: 0.01
2025-01-13 17:57:56,753 [trainer.py] => fs_lr: 0.001
2025-01-13 17:57:56,753 [trainer.py] => batch_size: 48
2025-01-13 17:57:56,753 [trainer.py] => fs_batch_size: 16
2025-01-13 17:57:56,753 [trainer.py] => weight_decay: 0.0005
2025-01-13 17:57:56,753 [trainer.py] => min_lr: 0
2025-01-13 17:57:56,753 [trainer.py] => optimizer: sgd
2025-01-13 17:57:56,753 [trainer.py] => memory_size: 0
2025-01-13 17:57:56,753 [trainer.py] => memory_per_class: 0
2025-01-13 17:57:56,753 [trainer.py] => fixed_memory: False
2025-01-13 17:57:56,753 [trainer.py] => shuffle: False
2025-01-13 17:57:56,753 [trainer.py] => top_k: 5
2025-01-13 17:57:56,753 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-13 17:57:56,753 [trainer.py] => prefix: asp
2025-01-13 17:57:56,753 [trainer.py] => model_prefix: asp
2025-01-13 17:57:58,439 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-13 17:58:21,980 [trainer.py] => All params: 173596160
2025-01-13 17:58:21,981 [trainer.py] => Trainable params: 1998848
2025-01-13 17:58:45,296 [asp.py] => Learning on 0-5
2025-01-13 17:58:45,304 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-13 17:59:11,342 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-13 17:59:11,342 [trainer.py] => model_name: asp
2025-01-13 17:59:11,342 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-13 17:59:11,342 [trainer.py] => device: ['cuda']
2025-01-13 17:59:11,342 [trainer.py] => seed: 2024
2025-01-13 17:59:11,342 [trainer.py] => dataset: cifar224
2025-01-13 17:59:11,343 [trainer.py] => init_cls: 5
2025-01-13 17:59:11,343 [trainer.py] => increment: 5
2025-01-13 17:59:11,343 [trainer.py] => kshot: 5
2025-01-13 17:59:11,343 [trainer.py] => generator_model: CIFAR_GEN
2025-01-13 17:59:11,343 [trainer.py] => z_dim: 1000
2025-01-13 17:59:11,343 [trainer.py] => conv_dim: 64
2025-01-13 17:59:11,343 [trainer.py] => img_size: 224
2025-01-13 17:59:11,343 [trainer.py] => generator_lr: 0.005
2025-01-13 17:59:11,343 [trainer.py] => pi: 100
2025-01-13 17:59:11,343 [trainer.py] => w_bn: 50.0
2025-01-13 17:59:11,343 [trainer.py] => w_noise: 0.001
2025-01-13 17:59:11,343 [trainer.py] => server_ss: 32
2025-01-13 17:59:11,343 [trainer.py] => bn_loss: 1
2025-01-13 17:59:11,343 [trainer.py] => noise: 1
2025-01-13 17:59:11,343 [trainer.py] => ie_loss: 1
2025-01-13 17:59:11,343 [trainer.py] => act_loss: 0
2025-01-13 17:59:11,343 [trainer.py] => w_ie: 1.0
2025-01-13 17:59:11,343 [trainer.py] => w_act: 0.1
2025-01-13 17:59:11,343 [trainer.py] => syn_size: 32
2025-01-13 17:59:11,343 [trainer.py] => need_syn_imgs: True
2025-01-13 17:59:11,343 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-13 17:59:11,343 [trainer.py] => g_local_train_steps: 5
2025-01-13 17:59:11,343 [trainer.py] => dataset_syn: cifar100
2025-01-13 17:59:11,343 [trainer.py] => com_round_gen: 10
2025-01-13 17:59:11,343 [trainer.py] => g_sigma: 0
2025-01-13 17:59:11,343 [trainer.py] => save_cls_embeds: False
2025-01-13 17:59:11,343 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot10_bs10
2025-01-13 17:59:11,343 [trainer.py] => save_dir: outputs
2025-01-13 17:59:11,343 [trainer.py] => n_iter: 5
2025-01-13 17:59:11,343 [trainer.py] => num_users: 1
2025-01-13 17:59:11,343 [trainer.py] => cur_size: 10
2025-01-13 17:59:11,344 [trainer.py] => g_local_bs: 5
2025-01-13 17:59:11,344 [trainer.py] => local_bs0: 5
2025-01-13 17:59:11,344 [trainer.py] => local_bs1: 5
2025-01-13 17:59:11,344 [trainer.py] => pre_size: 48
2025-01-13 17:59:11,344 [trainer.py] => w_ce_pre: 0.5
2025-01-13 17:59:11,344 [trainer.py] => vpt_type: Deep
2025-01-13 17:59:11,344 [trainer.py] => prompt_token_num: 6
2025-01-13 17:59:11,344 [trainer.py] => avg_alpha: 0.8
2025-01-13 17:59:11,344 [trainer.py] => perturb_var: 1
2025-01-13 17:59:11,344 [trainer.py] => EMA_beta: 0.99
2025-01-13 17:59:11,344 [trainer.py] => anchor_lambda: 0.1
2025-01-13 17:59:11,344 [trainer.py] => kl_weight: 0.001
2025-01-13 17:59:11,344 [trainer.py] => TIP_init: zero
2025-01-13 17:59:11,344 [trainer.py] => tuned_epoch: 10
2025-01-13 17:59:11,344 [trainer.py] => fs_epoch: 0
2025-01-13 17:59:11,344 [trainer.py] => init_lr: 0.01
2025-01-13 17:59:11,344 [trainer.py] => fs_lr: 0.001
2025-01-13 17:59:11,344 [trainer.py] => batch_size: 48
2025-01-13 17:59:11,344 [trainer.py] => fs_batch_size: 16
2025-01-13 17:59:11,344 [trainer.py] => weight_decay: 0.0005
2025-01-13 17:59:11,344 [trainer.py] => min_lr: 0
2025-01-13 17:59:11,344 [trainer.py] => optimizer: sgd
2025-01-13 17:59:11,344 [trainer.py] => memory_size: 0
2025-01-13 17:59:11,344 [trainer.py] => memory_per_class: 0
2025-01-13 17:59:11,344 [trainer.py] => fixed_memory: False
2025-01-13 17:59:11,344 [trainer.py] => shuffle: False
2025-01-13 17:59:11,344 [trainer.py] => top_k: 5
2025-01-13 17:59:11,344 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-13 17:59:11,344 [trainer.py] => prefix: asp
2025-01-13 17:59:11,344 [trainer.py] => model_prefix: asp
2025-01-13 17:59:12,801 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-13 17:59:21,387 [trainer.py] => All params: 173596160
2025-01-13 17:59:21,387 [trainer.py] => Trainable params: 1998848
2025-01-13 17:59:37,280 [asp.py] => Learning on 0-5
2025-01-13 17:59:37,285 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-13 18:00:25,449 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-13 18:00:25,449 [trainer.py] => model_name: asp
2025-01-13 18:00:25,449 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-13 18:00:25,449 [trainer.py] => device: ['cuda']
2025-01-13 18:00:25,449 [trainer.py] => seed: 2024
2025-01-13 18:00:25,449 [trainer.py] => dataset: cifar224
2025-01-13 18:00:25,449 [trainer.py] => init_cls: 5
2025-01-13 18:00:25,450 [trainer.py] => increment: 5
2025-01-13 18:00:25,450 [trainer.py] => kshot: 5
2025-01-13 18:00:25,450 [trainer.py] => generator_model: CIFAR_GEN
2025-01-13 18:00:25,450 [trainer.py] => z_dim: 1000
2025-01-13 18:00:25,450 [trainer.py] => conv_dim: 64
2025-01-13 18:00:25,450 [trainer.py] => img_size: 224
2025-01-13 18:00:25,450 [trainer.py] => generator_lr: 0.005
2025-01-13 18:00:25,450 [trainer.py] => pi: 100
2025-01-13 18:00:25,450 [trainer.py] => w_bn: 50.0
2025-01-13 18:00:25,450 [trainer.py] => w_noise: 0.001
2025-01-13 18:00:25,450 [trainer.py] => server_ss: 32
2025-01-13 18:00:25,450 [trainer.py] => bn_loss: 1
2025-01-13 18:00:25,450 [trainer.py] => noise: 1
2025-01-13 18:00:25,450 [trainer.py] => ie_loss: 1
2025-01-13 18:00:25,450 [trainer.py] => act_loss: 0
2025-01-13 18:00:25,450 [trainer.py] => w_ie: 1.0
2025-01-13 18:00:25,450 [trainer.py] => w_act: 0.1
2025-01-13 18:00:25,450 [trainer.py] => syn_size: 32
2025-01-13 18:00:25,450 [trainer.py] => need_syn_imgs: True
2025-01-13 18:00:25,450 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-13 18:00:25,450 [trainer.py] => g_local_train_steps: 5
2025-01-13 18:00:25,450 [trainer.py] => dataset_syn: cifar100
2025-01-13 18:00:25,450 [trainer.py] => com_round_gen: 20
2025-01-13 18:00:25,450 [trainer.py] => g_sigma: 0
2025-01-13 18:00:25,450 [trainer.py] => save_cls_embeds: False
2025-01-13 18:00:25,450 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_bs5
2025-01-13 18:00:25,450 [trainer.py] => save_dir: outputs
2025-01-13 18:00:25,450 [trainer.py] => n_iter: 5
2025-01-13 18:00:25,450 [trainer.py] => num_users: 1
2025-01-13 18:00:25,451 [trainer.py] => cur_size: 20
2025-01-13 18:00:25,451 [trainer.py] => g_local_bs: 5
2025-01-13 18:00:25,451 [trainer.py] => local_bs0: 5
2025-01-13 18:00:25,451 [trainer.py] => local_bs1: 5
2025-01-13 18:00:25,451 [trainer.py] => pre_size: 48
2025-01-13 18:00:25,451 [trainer.py] => w_ce_pre: 0.5
2025-01-13 18:00:25,451 [trainer.py] => vpt_type: Deep
2025-01-13 18:00:25,451 [trainer.py] => prompt_token_num: 6
2025-01-13 18:00:25,451 [trainer.py] => avg_alpha: 0.8
2025-01-13 18:00:25,451 [trainer.py] => perturb_var: 1
2025-01-13 18:00:25,451 [trainer.py] => EMA_beta: 0.99
2025-01-13 18:00:25,451 [trainer.py] => anchor_lambda: 0.1
2025-01-13 18:00:25,451 [trainer.py] => kl_weight: 0.001
2025-01-13 18:00:25,451 [trainer.py] => TIP_init: zero
2025-01-13 18:00:25,451 [trainer.py] => tuned_epoch: 10
2025-01-13 18:00:25,451 [trainer.py] => fs_epoch: 0
2025-01-13 18:00:25,451 [trainer.py] => init_lr: 0.01
2025-01-13 18:00:25,451 [trainer.py] => fs_lr: 0.001
2025-01-13 18:00:25,451 [trainer.py] => batch_size: 48
2025-01-13 18:00:25,451 [trainer.py] => fs_batch_size: 16
2025-01-13 18:00:25,451 [trainer.py] => weight_decay: 0.0005
2025-01-13 18:00:25,451 [trainer.py] => min_lr: 0
2025-01-13 18:00:25,451 [trainer.py] => optimizer: sgd
2025-01-13 18:00:25,451 [trainer.py] => memory_size: 0
2025-01-13 18:00:25,451 [trainer.py] => memory_per_class: 0
2025-01-13 18:00:25,451 [trainer.py] => fixed_memory: False
2025-01-13 18:00:25,451 [trainer.py] => shuffle: False
2025-01-13 18:00:25,451 [trainer.py] => top_k: 5
2025-01-13 18:00:25,451 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-13 18:00:25,451 [trainer.py] => prefix: asp
2025-01-13 18:00:25,451 [trainer.py] => model_prefix: asp
2025-01-13 18:00:27,103 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-13 18:00:36,035 [trainer.py] => All params: 173596160
2025-01-13 18:00:36,036 [trainer.py] => Trainable params: 1998848
2025-01-13 18:00:52,522 [asp.py] => Learning on 0-5
2025-01-13 18:00:52,528 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-13 18:14:41,722 [asp.py] => total parameters: 173600001
2025-01-13 18:14:41,723 [asp.py] => trainable parameters: 2002689
2025-01-13 18:16:09,041 [asp.py] => total parameters: 173600001
2025-01-13 18:16:09,042 [asp.py] => trainable parameters: 2002689
2025-01-13 18:16:24,014 [asp.py] => total parameters: 173600001
2025-01-13 18:16:24,015 [asp.py] => trainable parameters: 2002689
2025-01-13 18:17:17,066 [asp.py] => Task 0, Epoch 1 => Loss 1.455, Train_accy 71.18, Test_curr_accy 97.80, Test_accy 97.80
2025-01-13 18:17:27,088 [asp.py] => Task 0, Epoch 1 => Loss 1.371, Train_accy 74.31, Test_curr_accy 97.80, Test_accy 97.80
2025-01-13 18:18:24,431 [asp.py] => Task 0, Epoch 2 => Loss 0.642, Train_accy 90.27, Test_curr_accy 97.80, Test_accy 97.80
2025-01-13 18:18:30,040 [asp.py] => Task 0, Epoch 2 => Loss 0.724, Train_accy 90.54, Test_curr_accy 95.60, Test_accy 95.60
2025-01-13 18:19:31,059 [asp.py] => Task 0, Epoch 3 => Loss 0.534, Train_accy 91.14, Test_curr_accy 98.40, Test_accy 98.40
2025-01-13 18:19:33,146 [asp.py] => Task 0, Epoch 3 => Loss 0.497, Train_accy 92.38, Test_curr_accy 98.60, Test_accy 98.60
2025-01-13 18:20:35,904 [asp.py] => Task 0, Epoch 4 => Loss 0.525, Train_accy 92.54, Test_curr_accy 91.60, Test_accy 91.60
2025-01-13 18:20:36,741 [asp.py] => Task 0, Epoch 4 => Loss 0.375, Train_accy 93.29, Test_curr_accy 99.00, Test_accy 99.00
2025-01-13 18:21:39,308 [asp.py] => Task 0, Epoch 5 => Loss 0.363, Train_accy 93.00, Test_curr_accy 99.60, Test_accy 99.60
2025-01-13 18:21:42,671 [asp.py] => Task 0, Epoch 5 => Loss 0.339, Train_accy 93.29, Test_curr_accy 98.60, Test_accy 98.60
2025-01-13 18:22:42,462 [asp.py] => Task 0, Epoch 6 => Loss 0.346, Train_accy 94.31, Test_curr_accy 77.00, Test_accy 77.00
2025-01-13 18:22:49,308 [asp.py] => Task 0, Epoch 6 => Loss 0.321, Train_accy 93.57, Test_curr_accy 98.60, Test_accy 98.60
2025-01-13 18:23:45,380 [asp.py] => Task 0, Epoch 7 => Loss 0.281, Train_accy 94.27, Test_curr_accy 99.00, Test_accy 99.00
2025-01-13 18:23:55,173 [asp.py] => Task 0, Epoch 7 => Loss 0.275, Train_accy 94.20, Test_curr_accy 98.80, Test_accy 98.80
2025-01-13 18:24:48,337 [asp.py] => Task 0, Epoch 8 => Loss 0.252, Train_accy 94.54, Test_curr_accy 98.60, Test_accy 98.60
2025-01-13 18:25:00,760 [asp.py] => Task 0, Epoch 8 => Loss 0.263, Train_accy 94.04, Test_curr_accy 99.60, Test_accy 99.60
2025-01-13 18:25:51,269 [asp.py] => Task 0, Epoch 9 => Loss 0.216, Train_accy 95.27, Test_curr_accy 99.80, Test_accy 99.80
2025-01-13 18:26:06,861 [asp.py] => Task 0, Epoch 9 => Loss 0.244, Train_accy 94.39, Test_curr_accy 99.40, Test_accy 99.40
2025-01-13 18:26:53,919 [asp.py] => Task 0, Epoch 10 => Loss 0.214, Train_accy 96.12, Test_curr_accy 98.20, Test_accy 98.20
2025-01-13 18:27:14,725 [asp.py] => Task 0, Epoch 10 => Loss 0.212, Train_accy 95.80, Test_curr_accy 96.40, Test_accy 96.40
2025-01-13 18:27:21,358 [trainer.py] => Top1 curve: [93.6]
2025-01-13 18:27:21,359 [trainer.py] => Average Accuracy (Top1): 93.6   (Harmonic Accuracy): None (Old Acc): 93.6 (New Acc): [] 

2025-01-13 18:27:21,360 [trainer.py] => All params: 173600001
2025-01-13 18:27:21,361 [trainer.py] => Trainable params: 2002689
2025-01-13 18:27:41,410 [asp.py] => Learning on 5-10
2025-01-13 18:27:41,419 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 18:27:41,536 [trainer.py] => Top1 curve: [99.0]
2025-01-13 18:27:41,537 [trainer.py] => Average Accuracy (Top1): 99.0   (Harmonic Accuracy): None (Old Acc): 99.0 (New Acc): [] 

2025-01-13 18:27:41,538 [trainer.py] => All params: 173600001
2025-01-13 18:27:41,539 [trainer.py] => Trainable params: 2002689
2025-01-13 18:27:58,533 [asp.py] => Learning on 5-10
2025-01-13 18:27:58,540 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 18:43:18,946 [asp.py] => total parameters: 173603841
2025-01-13 18:43:18,947 [asp.py] => trainable parameters: 2006529
2025-01-13 18:43:25,181 [trainer.py] => Top1 curve: [93.6, 89.6]
2025-01-13 18:43:25,182 [trainer.py] => Average Accuracy (Top1): 91.6   (Harmonic Accuracy): 89.4388392857143 (Old Acc): 93.4 (New Acc): 85.8 

2025-01-13 18:43:25,183 [trainer.py] => All params: 173603841
2025-01-13 18:43:25,183 [trainer.py] => Trainable params: 2006529
2025-01-13 18:43:46,857 [asp.py] => Learning on 10-15
2025-01-13 18:43:46,868 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 18:44:46,190 [asp.py] => total parameters: 173603841
2025-01-13 18:44:46,190 [asp.py] => trainable parameters: 2006529
2025-01-13 18:44:52,796 [trainer.py] => Top1 curve: [99.0, 96.8]
2025-01-13 18:44:52,797 [trainer.py] => Average Accuracy (Top1): 97.9   (Harmonic Accuracy): 96.76652892561984 (Old Acc): 98.6 (New Acc): 95.0 

2025-01-13 18:44:52,798 [trainer.py] => All params: 173603841
2025-01-13 18:44:52,798 [trainer.py] => Trainable params: 2006529
2025-01-13 18:45:11,132 [asp.py] => Learning on 10-15
2025-01-13 18:45:11,141 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 18:59:26,694 [asp.py] => total parameters: 173607681
2025-01-13 18:59:26,695 [asp.py] => trainable parameters: 2010369
2025-01-13 18:59:36,560 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93]
2025-01-13 18:59:36,560 [trainer.py] => Average Accuracy (Top1): 88.04333333333334   (Harmonic Accuracy): 82.78994011976049 (Old Acc): 91.2 (New Acc): 75.80000000000001 

2025-01-13 18:59:36,561 [trainer.py] => All params: 173607681
2025-01-13 18:59:36,562 [trainer.py] => Trainable params: 2010369
2025-01-13 19:00:02,287 [asp.py] => Learning on 15-20
2025-01-13 19:00:02,301 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 19:01:53,810 [asp.py] => total parameters: 173607681
2025-01-13 19:01:53,811 [asp.py] => trainable parameters: 2010369
2025-01-13 19:02:02,972 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4]
2025-01-13 19:02:02,972 [trainer.py] => Average Accuracy (Top1): 94.40000000000002   (Harmonic Accuracy): 88.77484559236385 (Old Acc): 94.0 (New Acc): 84.1 

2025-01-13 19:02:02,973 [trainer.py] => All params: 173607681
2025-01-13 19:02:02,974 [trainer.py] => Trainable params: 2010369
2025-01-13 19:02:21,125 [asp.py] => Learning on 15-20
2025-01-13 19:02:21,148 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 19:15:40,590 [asp.py] => total parameters: 173611521
2025-01-13 19:15:40,591 [asp.py] => trainable parameters: 2014209
2025-01-13 19:15:52,247 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75]
2025-01-13 19:15:52,247 [trainer.py] => Average Accuracy (Top1): 85.47   (Harmonic Accuracy): 81.25561410620186 (Old Acc): 91.2 (New Acc): 73.26666666666667 

2025-01-13 19:15:52,248 [trainer.py] => All params: 173611521
2025-01-13 19:15:52,248 [trainer.py] => Trainable params: 2014209
2025-01-13 19:16:14,836 [asp.py] => Learning on 20-25
2025-01-13 19:16:14,854 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 19:18:59,685 [asp.py] => total parameters: 173611521
2025-01-13 19:18:59,686 [asp.py] => trainable parameters: 2014209
2025-01-13 19:19:11,371 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5]
2025-01-13 19:19:11,372 [trainer.py] => Average Accuracy (Top1): 92.17500000000001   (Harmonic Accuracy): 87.96981132075472 (Old Acc): 94.0 (New Acc): 82.66666666666667 

2025-01-13 19:19:11,373 [trainer.py] => All params: 173611521
2025-01-13 19:19:11,373 [trainer.py] => Trainable params: 2014209
2025-01-13 19:19:31,896 [asp.py] => Learning on 20-25
2025-01-13 19:19:31,911 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 19:31:54,386 [asp.py] => total parameters: 173615361
2025-01-13 19:31:54,387 [asp.py] => trainable parameters: 2018049
2025-01-13 19:32:08,022 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4]
2025-01-13 19:32:08,022 [trainer.py] => Average Accuracy (Top1): 83.856   (Harmonic Accuracy): 81.42141119221411 (Old Acc): 90.2 (New Acc): 74.2 

2025-01-13 19:32:08,024 [trainer.py] => All params: 173615361
2025-01-13 19:32:08,024 [trainer.py] => Trainable params: 2018049
2025-01-13 19:32:27,268 [asp.py] => Learning on 25-30
2025-01-13 19:32:27,283 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 19:36:21,958 [asp.py] => total parameters: 173615361
2025-01-13 19:36:21,959 [asp.py] => trainable parameters: 2018049
2025-01-13 19:36:37,066 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08]
2025-01-13 19:36:37,066 [trainer.py] => Average Accuracy (Top1): 90.756   (Harmonic Accuracy): 88.01380871533672 (Old Acc): 93.8 (New Acc): 82.89999999999999 

2025-01-13 19:36:37,067 [trainer.py] => All params: 173615361
2025-01-13 19:36:37,068 [trainer.py] => Trainable params: 2018049
2025-01-13 19:36:56,794 [asp.py] => Learning on 25-30
2025-01-13 19:36:56,822 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 19:48:06,201 [asp.py] => total parameters: 173619201
2025-01-13 19:48:06,202 [asp.py] => trainable parameters: 2021889
2025-01-13 19:48:21,658 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47]
2025-01-13 19:48:21,659 [trainer.py] => Average Accuracy (Top1): 81.79166666666667   (Harmonic Accuracy): 77.0698267074414 (Old Acc): 89.0 (New Acc): 67.96000000000001 

2025-01-13 19:48:21,660 [trainer.py] => All params: 173619201
2025-01-13 19:48:21,660 [trainer.py] => Trainable params: 2021889
2025-01-13 19:48:40,871 [asp.py] => Learning on 30-35
2025-01-13 19:48:40,885 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 19:53:47,161 [asp.py] => total parameters: 173619201
2025-01-13 19:53:47,163 [asp.py] => trainable parameters: 2021889
2025-01-13 19:54:04,259 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13]
2025-01-13 19:54:04,259 [trainer.py] => Average Accuracy (Top1): 89.31833333333334   (Harmonic Accuracy): 86.17416974169741 (Old Acc): 93.6 (New Acc): 79.84 

2025-01-13 19:54:04,260 [trainer.py] => All params: 173619201
2025-01-13 19:54:04,261 [trainer.py] => Trainable params: 2021889
2025-01-13 19:54:23,728 [asp.py] => Learning on 30-35
2025-01-13 19:54:23,749 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 20:04:20,091 [asp.py] => total parameters: 173623041
2025-01-13 20:04:20,093 [asp.py] => trainable parameters: 2025729
2025-01-13 20:04:37,945 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06]
2025-01-13 20:04:37,945 [trainer.py] => Average Accuracy (Top1): 79.97285714285714   (Harmonic Accuracy): 75.61740629039207 (Old Acc): 89.0 (New Acc): 65.73333333333333 

2025-01-13 20:04:37,946 [trainer.py] => All params: 173623041
2025-01-13 20:04:37,947 [trainer.py] => Trainable params: 2025729
2025-01-13 20:04:55,944 [asp.py] => Learning on 35-40
2025-01-13 20:04:55,960 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 20:11:13,314 [asp.py] => total parameters: 173623041
2025-01-13 20:11:13,314 [asp.py] => trainable parameters: 2025729
2025-01-13 20:11:32,736 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89]
2025-01-13 20:11:32,736 [trainer.py] => Average Accuracy (Top1): 88.11428571428573   (Harmonic Accuracy): 85.41677969385778 (Old Acc): 93.2 (New Acc): 78.83333333333333 

2025-01-13 20:11:32,737 [trainer.py] => All params: 173623041
2025-01-13 20:11:32,738 [trainer.py] => Trainable params: 2025729
2025-01-13 20:11:52,168 [asp.py] => Learning on 35-40
2025-01-13 20:11:52,189 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 20:20:36,989 [asp.py] => total parameters: 173626881
2025-01-13 20:20:36,991 [asp.py] => trainable parameters: 2029569
2025-01-13 20:20:57,237 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25]
2025-01-13 20:20:57,238 [trainer.py] => Average Accuracy (Top1): 78.5075   (Harmonic Accuracy): 74.99992542878448 (Old Acc): 87.8 (New Acc): 65.45714285714284 

2025-01-13 20:20:57,239 [trainer.py] => All params: 173626881
2025-01-13 20:20:57,239 [trainer.py] => Trainable params: 2029569
2025-01-13 20:21:17,026 [asp.py] => Learning on 40-45
2025-01-13 20:21:17,045 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 20:28:42,193 [asp.py] => total parameters: 173626881
2025-01-13 20:28:42,194 [asp.py] => trainable parameters: 2029569
2025-01-13 20:29:04,252 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55]
2025-01-13 20:29:04,253 [trainer.py] => Average Accuracy (Top1): 87.04375   (Harmonic Accuracy): 84.62190221031479 (Old Acc): 93.0 (New Acc): 77.62857142857142 

2025-01-13 20:29:04,254 [trainer.py] => All params: 173626881
2025-01-13 20:29:04,254 [trainer.py] => Trainable params: 2029569
2025-01-13 20:29:24,125 [asp.py] => Learning on 40-45
2025-01-13 20:29:24,142 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 20:37:13,752 [asp.py] => total parameters: 173630721
2025-01-13 20:37:13,753 [asp.py] => trainable parameters: 2033409
2025-01-13 20:37:36,941 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0]
2025-01-13 20:37:36,941 [trainer.py] => Average Accuracy (Top1): 77.33999999999999   (Harmonic Accuracy): 74.93060957672823 (Old Acc): 87.4 (New Acc): 65.575 

2025-01-13 20:37:36,942 [trainer.py] => All params: 173630721
2025-01-13 20:37:36,943 [trainer.py] => Trainable params: 2033409
2025-01-13 20:37:57,923 [asp.py] => Learning on 45-50
2025-01-13 20:37:57,949 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 20:46:14,966 [asp.py] => total parameters: 173630721
2025-01-13 20:46:14,967 [asp.py] => trainable parameters: 2033409
2025-01-13 20:46:39,371 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62]
2025-01-13 20:46:39,371 [trainer.py] => Average Accuracy (Top1): 86.10777777777778   (Harmonic Accuracy): 84.07521367521367 (Old Acc): 92.8 (New Acc): 76.85000000000001 

2025-01-13 20:46:39,372 [trainer.py] => All params: 173630721
2025-01-13 20:46:39,373 [trainer.py] => Trainable params: 2033409
2025-01-13 20:46:58,721 [asp.py] => Learning on 45-50
2025-01-13 20:46:58,743 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 20:53:55,016 [asp.py] => total parameters: 173634561
2025-01-13 20:53:55,018 [asp.py] => trainable parameters: 2037249
2025-01-13 20:54:20,449 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0, 66.5]
2025-01-13 20:54:20,450 [trainer.py] => Average Accuracy (Top1): 76.256   (Harmonic Accuracy): 74.06683262556743 (Old Acc): 87.6 (New Acc): 64.15555555555555 

2025-01-13 20:54:20,451 [trainer.py] => All params: 173634561
2025-01-13 20:54:20,452 [trainer.py] => Trainable params: 2037249
2025-01-13 20:54:39,594 [asp.py] => Learning on 50-55
2025-01-13 20:54:39,617 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 20:57:02,136 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-13 20:57:02,136 [trainer.py] => model_name: asp
2025-01-13 20:57:02,136 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-13 20:57:02,136 [trainer.py] => device: ['cuda']
2025-01-13 20:57:02,136 [trainer.py] => seed: 2024
2025-01-13 20:57:02,136 [trainer.py] => dataset: cifar224
2025-01-13 20:57:02,136 [trainer.py] => init_cls: 5
2025-01-13 20:57:02,136 [trainer.py] => increment: 5
2025-01-13 20:57:02,136 [trainer.py] => kshot: 5
2025-01-13 20:57:02,136 [trainer.py] => generator_model: CIFAR_GEN
2025-01-13 20:57:02,136 [trainer.py] => z_dim: 1000
2025-01-13 20:57:02,136 [trainer.py] => conv_dim: 64
2025-01-13 20:57:02,136 [trainer.py] => img_size: 224
2025-01-13 20:57:02,136 [trainer.py] => generator_lr: 0.005
2025-01-13 20:57:02,136 [trainer.py] => pi: 100
2025-01-13 20:57:02,136 [trainer.py] => w_bn: 50.0
2025-01-13 20:57:02,136 [trainer.py] => w_noise: 0.001
2025-01-13 20:57:02,136 [trainer.py] => server_ss: 32
2025-01-13 20:57:02,136 [trainer.py] => bn_loss: 1
2025-01-13 20:57:02,136 [trainer.py] => noise: 1
2025-01-13 20:57:02,136 [trainer.py] => ie_loss: 1
2025-01-13 20:57:02,136 [trainer.py] => act_loss: 0
2025-01-13 20:57:02,136 [trainer.py] => w_ie: 1.0
2025-01-13 20:57:02,136 [trainer.py] => w_act: 0.1
2025-01-13 20:57:02,137 [trainer.py] => syn_size: 32
2025-01-13 20:57:02,137 [trainer.py] => need_syn_imgs: True
2025-01-13 20:57:02,137 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-13 20:57:02,137 [trainer.py] => g_local_train_steps: 5
2025-01-13 20:57:02,137 [trainer.py] => dataset_syn: cifar100
2025-01-13 20:57:02,137 [trainer.py] => com_round_gen: 20
2025-01-13 20:57:02,137 [trainer.py] => g_sigma: 0
2025-01-13 20:57:02,137 [trainer.py] => save_cls_embeds: False
2025-01-13 20:57:02,137 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot5_bs5
2025-01-13 20:57:02,137 [trainer.py] => save_dir: outputs
2025-01-13 20:57:02,137 [trainer.py] => n_iter: 5
2025-01-13 20:57:02,137 [trainer.py] => num_users: 1
2025-01-13 20:57:02,137 [trainer.py] => cur_size: 5
2025-01-13 20:57:02,137 [trainer.py] => g_local_bs: 5
2025-01-13 20:57:02,137 [trainer.py] => local_bs0: 5
2025-01-13 20:57:02,137 [trainer.py] => local_bs1: 5
2025-01-13 20:57:02,137 [trainer.py] => pre_size: 48
2025-01-13 20:57:02,137 [trainer.py] => w_ce_pre: 0.5
2025-01-13 20:57:02,137 [trainer.py] => vpt_type: Deep
2025-01-13 20:57:02,137 [trainer.py] => prompt_token_num: 6
2025-01-13 20:57:02,137 [trainer.py] => avg_alpha: 0.8
2025-01-13 20:57:02,137 [trainer.py] => perturb_var: 1
2025-01-13 20:57:02,137 [trainer.py] => EMA_beta: 0.99
2025-01-13 20:57:02,137 [trainer.py] => anchor_lambda: 0.1
2025-01-13 20:57:02,137 [trainer.py] => kl_weight: 0.001
2025-01-13 20:57:02,137 [trainer.py] => TIP_init: zero
2025-01-13 20:57:02,137 [trainer.py] => tuned_epoch: 10
2025-01-13 20:57:02,138 [trainer.py] => fs_epoch: 0
2025-01-13 20:57:02,138 [trainer.py] => init_lr: 0.01
2025-01-13 20:57:02,138 [trainer.py] => fs_lr: 0.001
2025-01-13 20:57:02,138 [trainer.py] => batch_size: 48
2025-01-13 20:57:02,138 [trainer.py] => fs_batch_size: 16
2025-01-13 20:57:02,138 [trainer.py] => weight_decay: 0.0005
2025-01-13 20:57:02,138 [trainer.py] => min_lr: 0
2025-01-13 20:57:02,138 [trainer.py] => optimizer: sgd
2025-01-13 20:57:02,138 [trainer.py] => memory_size: 0
2025-01-13 20:57:02,138 [trainer.py] => memory_per_class: 0
2025-01-13 20:57:02,138 [trainer.py] => fixed_memory: False
2025-01-13 20:57:02,138 [trainer.py] => shuffle: False
2025-01-13 20:57:02,138 [trainer.py] => top_k: 5
2025-01-13 20:57:02,138 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-13 20:57:02,138 [trainer.py] => prefix: asp
2025-01-13 20:57:02,138 [trainer.py] => model_prefix: asp
2025-01-13 20:57:03,584 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-13 20:57:13,160 [trainer.py] => All params: 173596160
2025-01-13 20:57:13,161 [trainer.py] => Trainable params: 1998848
2025-01-13 20:57:36,221 [asp.py] => Learning on 0-5
2025-01-13 20:57:36,227 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-13 21:03:48,888 [asp.py] => total parameters: 173634561
2025-01-13 21:03:48,889 [asp.py] => trainable parameters: 2037249
2025-01-13 21:04:15,477 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62, 76.9]
2025-01-13 21:04:15,478 [trainer.py] => Average Accuracy (Top1): 85.187   (Harmonic Accuracy): 82.97077758643529 (Old Acc): 92.6 (New Acc): 75.15555555555555 

2025-01-13 21:04:15,478 [trainer.py] => All params: 173634561
2025-01-13 21:04:15,479 [trainer.py] => Trainable params: 2037249
2025-01-13 21:04:34,710 [asp.py] => Learning on 50-55
2025-01-13 21:04:34,730 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 21:10:54,952 [asp.py] => total parameters: 173638401
2025-01-13 21:10:54,954 [asp.py] => trainable parameters: 2041089
2025-01-13 21:11:22,285 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0, 66.5, 66.58]
2025-01-13 21:11:22,286 [trainer.py] => Average Accuracy (Top1): 75.37636363636364   (Harmonic Accuracy): 74.28258811152027 (Old Acc): 87.6 (New Acc): 64.48 

2025-01-13 21:11:22,287 [trainer.py] => All params: 173638401
2025-01-13 21:11:22,287 [trainer.py] => Trainable params: 2041089
2025-01-13 21:11:42,918 [asp.py] => Learning on 55-60
2025-01-13 21:11:42,947 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 21:21:25,978 [asp.py] => total parameters: 173638401
2025-01-13 21:21:25,979 [asp.py] => trainable parameters: 2041089
2025-01-13 21:21:55,049 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62, 76.9, 76.91]
2025-01-13 21:21:55,049 [trainer.py] => Average Accuracy (Top1): 84.43454545454546   (Harmonic Accuracy): 82.94588853085092 (Old Acc): 92.2 (New Acc): 75.37999999999998 

2025-01-13 21:21:55,050 [trainer.py] => All params: 173638401
2025-01-13 21:21:55,051 [trainer.py] => Trainable params: 2041089
2025-01-13 21:22:19,286 [asp.py] => Learning on 55-60
2025-01-13 21:22:19,310 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 21:23:13,092 [asp.py] => total parameters: 173600001
2025-01-13 21:23:13,093 [asp.py] => trainable parameters: 2002689
2025-01-13 21:24:50,973 [asp.py] => Task 0, Epoch 1 => Loss 1.216, Train_accy 82.69, Test_curr_accy 98.60, Test_accy 98.60
2025-01-13 21:25:54,985 [asp.py] => Task 0, Epoch 2 => Loss 0.521, Train_accy 91.84, Test_curr_accy 98.20, Test_accy 98.20
2025-01-13 21:26:57,016 [asp.py] => Task 0, Epoch 3 => Loss 0.422, Train_accy 92.36, Test_curr_accy 98.80, Test_accy 98.80
2025-01-13 21:27:25,073 [asp.py] => total parameters: 173642241
2025-01-13 21:27:25,075 [asp.py] => trainable parameters: 2044929
2025-01-13 21:27:55,613 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0, 66.5, 66.58, 65.12]
2025-01-13 21:27:55,615 [trainer.py] => Average Accuracy (Top1): 74.52166666666666   (Harmonic Accuracy): 73.28210704361481 (Old Acc): 87.4 (New Acc): 63.09090909090908 

2025-01-13 21:27:55,616 [trainer.py] => All params: 173642241
2025-01-13 21:27:55,617 [trainer.py] => Trainable params: 2044929
2025-01-13 21:27:58,836 [asp.py] => Task 0, Epoch 4 => Loss 0.385, Train_accy 92.83, Test_curr_accy 99.00, Test_accy 99.00
2025-01-13 21:28:26,977 [asp.py] => Learning on 60-65
2025-01-13 21:28:27,010 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 21:29:00,960 [asp.py] => Task 0, Epoch 5 => Loss 0.353, Train_accy 93.23, Test_curr_accy 99.40, Test_accy 99.40
2025-01-13 21:30:03,089 [asp.py] => Task 0, Epoch 6 => Loss 0.302, Train_accy 93.66, Test_curr_accy 99.60, Test_accy 99.60
2025-01-13 21:31:05,627 [asp.py] => Task 0, Epoch 7 => Loss 0.268, Train_accy 94.30, Test_curr_accy 99.40, Test_accy 99.40
2025-01-13 21:32:07,778 [asp.py] => Task 0, Epoch 8 => Loss 0.256, Train_accy 93.86, Test_curr_accy 98.80, Test_accy 98.80
2025-01-13 21:33:09,620 [asp.py] => Task 0, Epoch 9 => Loss 0.229, Train_accy 94.93, Test_curr_accy 99.40, Test_accy 99.40
2025-01-13 21:34:11,448 [asp.py] => Task 0, Epoch 10 => Loss 0.214, Train_accy 95.25, Test_curr_accy 99.60, Test_accy 99.60
2025-01-13 21:34:37,405 [trainer.py] => Top1 curve: [99.4]
2025-01-13 21:34:37,405 [trainer.py] => Average Accuracy (Top1): 99.4   (Harmonic Accuracy): None (Old Acc): 99.4 (New Acc): [] 

2025-01-13 21:34:37,406 [trainer.py] => All params: 173600001
2025-01-13 21:34:37,407 [trainer.py] => Trainable params: 2002689
2025-01-13 21:35:05,600 [asp.py] => Learning on 5-10
2025-01-13 21:35:05,621 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 21:39:11,105 [asp.py] => total parameters: 173642241
2025-01-13 21:39:11,106 [asp.py] => trainable parameters: 2044929
2025-01-13 21:39:45,428 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62, 76.9, 76.91, 75.68]
2025-01-13 21:39:45,429 [trainer.py] => Average Accuracy (Top1): 83.705   (Harmonic Accuracy): 82.14681107099881 (Old Acc): 92.0 (New Acc): 74.20000000000003 

2025-01-13 21:39:45,430 [trainer.py] => All params: 173642241
2025-01-13 21:39:45,430 [trainer.py] => Trainable params: 2044929
2025-01-13 21:40:06,096 [asp.py] => Learning on 60-65
2025-01-13 21:40:06,124 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 21:44:44,110 [asp.py] => total parameters: 173646081
2025-01-13 21:44:44,111 [asp.py] => trainable parameters: 2048769
2025-01-13 21:45:17,287 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0, 66.5, 66.58, 65.12, 63.38]
2025-01-13 21:45:17,287 [trainer.py] => Average Accuracy (Top1): 73.66461538461539   (Harmonic Accuracy): 71.8311992786294 (Old Acc): 86.4 (New Acc): 61.46666666666667 

2025-01-13 21:45:17,288 [trainer.py] => All params: 173646081
2025-01-13 21:45:17,289 [trainer.py] => Trainable params: 2048769
2025-01-13 21:45:36,168 [asp.py] => Learning on 65-70
2025-01-13 21:45:36,195 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 21:51:04,322 [asp.py] => total parameters: 173603841
2025-01-13 21:51:04,322 [asp.py] => trainable parameters: 2006529
2025-01-13 21:51:11,229 [trainer.py] => Top1 curve: [99.4, 96.9]
2025-01-13 21:51:11,229 [trainer.py] => Average Accuracy (Top1): 98.15   (Harmonic Accuracy): 96.86274509803921 (Old Acc): 98.8 (New Acc): 95.0 

2025-01-13 21:51:11,230 [trainer.py] => All params: 173603841
2025-01-13 21:51:11,231 [trainer.py] => Trainable params: 2006529
2025-01-13 21:51:42,541 [asp.py] => Learning on 10-15
2025-01-13 21:51:42,550 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 21:56:49,246 [asp.py] => total parameters: 173646081
2025-01-13 21:56:49,247 [asp.py] => trainable parameters: 2048769
2025-01-13 21:57:23,447 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62, 76.9, 76.91, 75.68, 73.88]
2025-01-13 21:57:23,448 [trainer.py] => Average Accuracy (Top1): 82.94923076923078   (Harmonic Accuracy): 80.8760975609756 (Old Acc): 91.6 (New Acc): 72.39999999999999 

2025-01-13 21:57:23,449 [trainer.py] => All params: 173646081
2025-01-13 21:57:23,449 [trainer.py] => Trainable params: 2048769
2025-01-13 21:57:41,692 [asp.py] => Learning on 65-70
2025-01-13 21:57:41,728 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 22:01:31,581 [asp.py] => total parameters: 173649921
2025-01-13 22:01:31,582 [asp.py] => trainable parameters: 2052609
2025-01-13 22:02:05,794 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0, 66.5, 66.58, 65.12, 63.38, 63.2]
2025-01-13 22:02:05,794 [trainer.py] => Average Accuracy (Top1): 72.91714285714286   (Harmonic Accuracy): 71.67863105175292 (Old Acc): 86.0 (New Acc): 61.446153846153834 

2025-01-13 22:02:05,795 [trainer.py] => All params: 173649921
2025-01-13 22:02:05,796 [trainer.py] => Trainable params: 2052609
2025-01-13 22:02:25,109 [asp.py] => Learning on 70-75
2025-01-13 22:02:25,133 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 22:08:08,962 [asp.py] => total parameters: 173607681
2025-01-13 22:08:08,965 [asp.py] => trainable parameters: 2010369
2025-01-13 22:08:22,763 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2]
2025-01-13 22:08:22,773 [trainer.py] => Average Accuracy (Top1): 96.16666666666667   (Harmonic Accuracy): 93.37466595403527 (Old Acc): 97.6 (New Acc): 89.5 

2025-01-13 22:08:22,775 [trainer.py] => All params: 173607681
2025-01-13 22:08:22,775 [trainer.py] => Trainable params: 2010369
2025-01-13 22:10:44,366 [asp.py] => Learning on 15-20
2025-01-13 22:10:44,386 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 22:14:35,105 [asp.py] => total parameters: 173649921
2025-01-13 22:14:35,107 [asp.py] => trainable parameters: 2052609
2025-01-13 22:15:11,731 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62, 76.9, 76.91, 75.68, 73.88, 73.5]
2025-01-13 22:15:11,732 [trainer.py] => Average Accuracy (Top1): 82.27428571428572   (Harmonic Accuracy): 80.69339347805656 (Old Acc): 91.6 (New Acc): 72.1076923076923 

2025-01-13 22:15:11,733 [trainer.py] => All params: 173649921
2025-01-13 22:15:11,733 [trainer.py] => Trainable params: 2052609
2025-01-13 22:15:31,393 [asp.py] => Learning on 70-75
2025-01-13 22:15:31,424 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 22:18:21,258 [asp.py] => total parameters: 173653761
2025-01-13 22:18:21,259 [asp.py] => trainable parameters: 2056449
2025-01-13 22:18:58,316 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0, 66.5, 66.58, 65.12, 63.38, 63.2, 60.77]
2025-01-13 22:18:58,318 [trainer.py] => Average Accuracy (Top1): 72.10733333333334   (Harmonic Accuracy): 69.62526315789475 (Old Acc): 84.8 (New Acc): 59.057142857142864 

2025-01-13 22:18:58,319 [trainer.py] => All params: 173653761
2025-01-13 22:18:58,320 [trainer.py] => Trainable params: 2056449
2025-01-13 22:19:20,020 [asp.py] => Learning on 75-80
2025-01-13 22:19:20,048 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 22:26:39,667 [asp.py] => total parameters: 173611521
2025-01-13 22:26:39,668 [asp.py] => trainable parameters: 2014209
2025-01-13 22:26:51,709 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65]
2025-01-13 22:26:51,709 [trainer.py] => Average Accuracy (Top1): 94.5375   (Harmonic Accuracy): 91.99566630552545 (Old Acc): 97.6 (New Acc): 87.0 

2025-01-13 22:26:51,710 [trainer.py] => All params: 173611521
2025-01-13 22:26:51,711 [trainer.py] => Trainable params: 2014209
2025-01-13 22:27:12,992 [asp.py] => Learning on 20-25
2025-01-13 22:27:13,009 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 22:32:24,006 [asp.py] => total parameters: 173653761
2025-01-13 22:32:24,007 [asp.py] => trainable parameters: 2056449
2025-01-13 22:33:03,846 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62, 76.9, 76.91, 75.68, 73.88, 73.5, 72.27]
2025-01-13 22:33:03,846 [trainer.py] => Average Accuracy (Top1): 81.60733333333334   (Harmonic Accuracy): 79.78794501233698 (Old Acc): 91.2 (New Acc): 70.91428571428571 

2025-01-13 22:33:03,847 [trainer.py] => All params: 173653761
2025-01-13 22:33:03,848 [trainer.py] => Trainable params: 2056449
2025-01-13 22:33:24,558 [asp.py] => Learning on 75-80
2025-01-13 22:33:24,595 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 22:35:07,265 [asp.py] => total parameters: 173657601
2025-01-13 22:35:07,266 [asp.py] => trainable parameters: 2060289
2025-01-13 22:35:46,270 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0, 66.5, 66.58, 65.12, 63.38, 63.2, 60.77, 60.95]
2025-01-13 22:35:46,270 [trainer.py] => Average Accuracy (Top1): 71.41000000000001   (Harmonic Accuracy): 69.8937742471827 (Old Acc): 85.0 (New Acc): 59.346666666666664 

2025-01-13 22:35:46,272 [trainer.py] => All params: 173657601
2025-01-13 22:35:46,273 [trainer.py] => Trainable params: 2060289
2025-01-13 22:36:17,861 [asp.py] => Learning on 80-85
2025-01-13 22:36:17,901 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 22:43:38,114 [asp.py] => total parameters: 173615361
2025-01-13 22:43:38,116 [asp.py] => trainable parameters: 2018049
2025-01-13 22:43:54,767 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92]
2025-01-13 22:43:54,767 [trainer.py] => Average Accuracy (Top1): 93.414   (Harmonic Accuracy): 91.67264817835782 (Old Acc): 97.0 (New Acc): 86.9 

2025-01-13 22:43:54,769 [trainer.py] => All params: 173615361
2025-01-13 22:43:54,769 [trainer.py] => Trainable params: 2018049
2025-01-13 22:44:32,045 [asp.py] => Learning on 25-30
2025-01-13 22:44:32,060 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 22:50:17,512 [asp.py] => total parameters: 173657601
2025-01-13 22:50:17,513 [asp.py] => trainable parameters: 2060289
2025-01-13 22:50:58,585 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62, 76.9, 76.91, 75.68, 73.88, 73.5, 72.27, 72.66]
2025-01-13 22:50:58,585 [trainer.py] => Average Accuracy (Top1): 81.04812500000001   (Harmonic Accuracy): 80.11124046896778 (Old Acc): 91.2 (New Acc): 71.42666666666666 

2025-01-13 22:50:58,586 [trainer.py] => All params: 173657601
2025-01-13 22:50:58,587 [trainer.py] => Trainable params: 2060289
2025-01-13 22:51:17,093 [asp.py] => Learning on 80-85
2025-01-13 22:51:17,122 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 22:52:06,152 [asp.py] => total parameters: 173661441
2025-01-13 22:52:06,153 [asp.py] => trainable parameters: 2064129
2025-01-13 22:52:47,903 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0, 66.5, 66.58, 65.12, 63.38, 63.2, 60.77, 60.95, 60.16]
2025-01-13 22:52:47,903 [trainer.py] => Average Accuracy (Top1): 70.74823529411766   (Harmonic Accuracy): 69.26583471507111 (Old Acc): 84.6 (New Acc): 58.63749999999999 

2025-01-13 22:52:47,904 [trainer.py] => All params: 173661441
2025-01-13 22:52:47,905 [trainer.py] => Trainable params: 2064129
2025-01-13 22:53:06,805 [asp.py] => Learning on 85-90
2025-01-13 22:53:06,849 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 23:05:17,179 [asp.py] => total parameters: 173619201
2025-01-13 23:05:17,180 [asp.py] => trainable parameters: 2021889
2025-01-13 23:05:40,537 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67]
2025-01-13 23:05:40,537 [trainer.py] => Average Accuracy (Top1): 92.12333333333333   (Harmonic Accuracy): 89.49897732325478 (Old Acc): 96.4 (New Acc): 83.52 

2025-01-13 23:05:40,538 [trainer.py] => All params: 173619201
2025-01-13 23:05:40,539 [trainer.py] => Trainable params: 2021889
2025-01-13 23:05:59,012 [asp.py] => Learning on 30-35
2025-01-13 23:05:59,026 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 23:07:57,902 [asp.py] => total parameters: 173661441
2025-01-13 23:07:57,903 [asp.py] => trainable parameters: 2064129
2025-01-13 23:08:41,083 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62, 76.9, 76.91, 75.68, 73.88, 73.5, 72.27, 72.66, 72.58]
2025-01-13 23:08:41,084 [trainer.py] => Average Accuracy (Top1): 80.55000000000001   (Harmonic Accuracy): 80.03293827920578 (Old Acc): 91.0 (New Acc): 71.425 

2025-01-13 23:08:41,086 [trainer.py] => All params: 173661441
2025-01-13 23:08:41,086 [trainer.py] => Trainable params: 2064129
2025-01-13 23:08:55,260 [asp.py] => total parameters: 173665281
2025-01-13 23:08:55,261 [asp.py] => trainable parameters: 2067969
2025-01-13 23:08:59,418 [asp.py] => Learning on 85-90
2025-01-13 23:08:59,456 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 23:09:39,083 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0, 66.5, 66.58, 65.12, 63.38, 63.2, 60.77, 60.95, 60.16, 60.28]
2025-01-13 23:09:39,084 [trainer.py] => Average Accuracy (Top1): 70.16666666666669   (Harmonic Accuracy): 69.29311734232382 (Old Acc): 84.2 (New Acc): 58.870588235294115 

2025-01-13 23:09:39,085 [trainer.py] => All params: 173665281
2025-01-13 23:09:39,085 [trainer.py] => Trainable params: 2067969
2025-01-13 23:09:59,346 [asp.py] => Learning on 90-95
2025-01-13 23:09:59,386 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 23:21:59,882 [asp.py] => total parameters: 173623041
2025-01-13 23:21:59,884 [asp.py] => trainable parameters: 2025729
2025-01-13 23:22:17,908 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54]
2025-01-13 23:22:17,908 [trainer.py] => Average Accuracy (Top1): 91.03999999999999   (Harmonic Accuracy): 88.882774049217 (Old Acc): 96.2 (New Acc): 82.60000000000001 

2025-01-13 23:22:17,909 [trainer.py] => All params: 173623041
2025-01-13 23:22:17,910 [trainer.py] => Trainable params: 2025729
2025-01-13 23:22:37,452 [asp.py] => Learning on 35-40
2025-01-13 23:22:37,473 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 23:25:49,662 [asp.py] => total parameters: 173669121
2025-01-13 23:25:49,664 [asp.py] => trainable parameters: 2071809
2025-01-13 23:25:51,518 [asp.py] => total parameters: 173665281
2025-01-13 23:25:51,519 [asp.py] => trainable parameters: 2067969
2025-01-13 23:26:35,913 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0, 66.5, 66.58, 65.12, 63.38, 63.2, 60.77, 60.95, 60.16, 60.28, 59.33]
2025-01-13 23:26:35,914 [trainer.py] => Average Accuracy (Top1): 69.59631578947369   (Harmonic Accuracy): 68.52960263343522 (Old Acc): 83.8 (New Acc): 57.96666666666666 

2025-01-13 23:26:35,915 [trainer.py] => All params: 173669121
2025-01-13 23:26:35,915 [trainer.py] => Trainable params: 2071809
2025-01-13 23:26:37,664 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62, 76.9, 76.91, 75.68, 73.88, 73.5, 72.27, 72.66, 72.58, 72.82]
2025-01-13 23:26:37,665 [trainer.py] => Average Accuracy (Top1): 80.12055555555555   (Harmonic Accuracy): 80.23839814948677 (Old Acc): 91.0 (New Acc): 71.75294117647059 

2025-01-13 23:26:37,666 [trainer.py] => All params: 173665281
2025-01-13 23:26:37,666 [trainer.py] => Trainable params: 2067969
2025-01-13 23:26:56,409 [asp.py] => Learning on 95-100
2025-01-13 23:26:56,516 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 23:26:57,024 [asp.py] => Learning on 90-95
2025-01-13 23:26:57,052 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 23:38:40,543 [asp.py] => total parameters: 173626881
2025-01-13 23:38:40,545 [asp.py] => trainable parameters: 2029569
2025-01-13 23:39:06,123 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02]
2025-01-13 23:39:06,124 [trainer.py] => Average Accuracy (Top1): 90.0375   (Harmonic Accuracy): 87.48848839097255 (Old Acc): 94.6 (New Acc): 81.37142857142858 

2025-01-13 23:39:06,126 [trainer.py] => All params: 173626881
2025-01-13 23:39:06,128 [trainer.py] => Trainable params: 2029569
2025-01-13 23:39:36,166 [asp.py] => Learning on 40-45
2025-01-13 23:39:36,191 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 23:42:54,485 [asp.py] => total parameters: 173672961
2025-01-13 23:42:54,486 [asp.py] => trainable parameters: 2075649
2025-01-13 23:43:43,556 [trainer.py] => Top1 curve: [93.6, 89.6, 80.93, 77.75, 77.4, 71.47, 69.06, 68.25, 68.0, 66.5, 66.58, 65.12, 63.38, 63.2, 60.77, 60.95, 60.16, 60.28, 59.33, 58.09]
2025-01-13 23:43:43,556 [trainer.py] => Average Accuracy (Top1): 69.021   (Harmonic Accuracy): 67.54679684566278 (Old Acc): 83.4 (New Acc): 56.7578947368421 

2025-01-13 23:43:43,556 [trainer.py] => 

2025-01-13 23:43:47,268 [asp.py] => total parameters: 173669121
2025-01-13 23:43:47,269 [asp.py] => trainable parameters: 2071809
2025-01-13 23:44:35,754 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62, 76.9, 76.91, 75.68, 73.88, 73.5, 72.27, 72.66, 72.58, 72.82, 71.73]
2025-01-13 23:44:35,754 [trainer.py] => Average Accuracy (Top1): 79.67894736842106   (Harmonic Accuracy): 79.54759777304281 (Old Acc): 91.0 (New Acc): 70.65555555555555 

2025-01-13 23:44:35,755 [trainer.py] => All params: 173669121
2025-01-13 23:44:35,755 [trainer.py] => Trainable params: 2071809
2025-01-13 23:44:55,733 [asp.py] => Learning on 95-100
2025-01-13 23:44:55,767 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-13 23:55:53,365 [asp.py] => total parameters: 173630721
2025-01-13 23:55:53,366 [asp.py] => trainable parameters: 2033409
2025-01-13 23:56:17,030 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04]
2025-01-13 23:56:17,030 [trainer.py] => Average Accuracy (Top1): 89.14888888888888   (Harmonic Accuracy): 86.96769955733257 (Old Acc): 94.6 (New Acc): 80.475 

2025-01-13 23:56:17,031 [trainer.py] => All params: 173630721
2025-01-13 23:56:17,032 [trainer.py] => Trainable params: 2033409
2025-01-13 23:56:37,654 [asp.py] => Learning on 45-50
2025-01-13 23:56:37,676 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 00:01:43,784 [asp.py] => total parameters: 173672961
2025-01-14 00:01:43,785 [asp.py] => trainable parameters: 2075649
2025-01-14 00:02:35,505 [trainer.py] => Top1 curve: [99.0, 96.8, 87.4, 85.5, 85.08, 82.13, 80.89, 79.55, 78.62, 76.9, 76.91, 75.68, 73.88, 73.5, 72.27, 72.66, 72.58, 72.82, 71.73, 70.53]
2025-01-14 00:02:35,506 [trainer.py] => Average Accuracy (Top1): 79.2215   (Harmonic Accuracy): 78.77950534671653 (Old Acc): 91.0 (New Acc): 69.45263157894738 

2025-01-14 00:02:35,506 [trainer.py] => 

2025-01-14 00:12:56,748 [asp.py] => total parameters: 173634561
2025-01-14 00:12:56,749 [asp.py] => trainable parameters: 2037249
2025-01-14 00:13:23,453 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04, 80.78]
2025-01-14 00:13:23,453 [trainer.py] => Average Accuracy (Top1): 88.31199999999998   (Harmonic Accuracy): 86.24404959734116 (Old Acc): 94.6 (New Acc): 79.24444444444444 

2025-01-14 00:13:23,454 [trainer.py] => All params: 173634561
2025-01-14 00:13:23,455 [trainer.py] => Trainable params: 2037249
2025-01-14 00:13:45,190 [asp.py] => Learning on 50-55
2025-01-14 00:13:45,225 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 00:30:05,144 [asp.py] => total parameters: 173638401
2025-01-14 00:30:05,147 [asp.py] => trainable parameters: 2041089
2025-01-14 00:30:34,058 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04, 80.78, 80.42]
2025-01-14 00:30:34,058 [trainer.py] => Average Accuracy (Top1): 87.59454545454544   (Harmonic Accuracy): 85.8851265457067 (Old Acc): 94.0 (New Acc): 79.06 

2025-01-14 00:30:34,059 [trainer.py] => All params: 173638401
2025-01-14 00:30:34,060 [trainer.py] => Trainable params: 2041089
2025-01-14 00:30:53,506 [asp.py] => Learning on 55-60
2025-01-14 00:30:53,533 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 00:47:14,555 [asp.py] => total parameters: 173642241
2025-01-14 00:47:14,557 [asp.py] => trainable parameters: 2044929
2025-01-14 00:47:45,401 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04, 80.78, 80.42, 79.4]
2025-01-14 00:47:45,401 [trainer.py] => Average Accuracy (Top1): 86.91166666666665   (Harmonic Accuracy): 85.15578144853876 (Old Acc): 93.6 (New Acc): 78.10909090909091 

2025-01-14 00:47:45,402 [trainer.py] => All params: 173642241
2025-01-14 00:47:45,403 [trainer.py] => Trainable params: 2044929
2025-01-14 00:48:04,900 [asp.py] => Learning on 60-65
2025-01-14 00:48:04,932 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 01:04:25,602 [asp.py] => total parameters: 173646081
2025-01-14 01:04:25,602 [asp.py] => trainable parameters: 2048769
2025-01-14 01:04:58,936 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04, 80.78, 80.42, 79.4, 77.86]
2025-01-14 01:04:58,936 [trainer.py] => Average Accuracy (Top1): 86.2153846153846   (Harmonic Accuracy): 84.22074640023509 (Old Acc): 93.6 (New Acc): 76.55 

2025-01-14 01:04:58,938 [trainer.py] => All params: 173646081
2025-01-14 01:04:58,938 [trainer.py] => Trainable params: 2048769
2025-01-14 01:05:17,724 [asp.py] => Learning on 65-70
2025-01-14 01:05:17,753 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 01:21:37,483 [asp.py] => total parameters: 173649921
2025-01-14 01:21:37,485 [asp.py] => trainable parameters: 2052609
2025-01-14 01:22:13,173 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04, 80.78, 80.42, 79.4, 77.86, 77.33]
2025-01-14 01:22:13,174 [trainer.py] => Average Accuracy (Top1): 85.58071428571427   (Harmonic Accuracy): 83.93362952216884 (Old Acc): 93.6 (New Acc): 76.07692307692308 

2025-01-14 01:22:13,175 [trainer.py] => All params: 173649921
2025-01-14 01:22:13,175 [trainer.py] => Trainable params: 2052609
2025-01-14 01:22:33,709 [asp.py] => Learning on 70-75
2025-01-14 01:22:33,739 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 01:38:53,669 [asp.py] => total parameters: 173653761
2025-01-14 01:38:53,670 [asp.py] => trainable parameters: 2056449
2025-01-14 01:39:31,707 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04, 80.78, 80.42, 79.4, 77.86, 77.33, 75.89]
2025-01-14 01:39:31,708 [trainer.py] => Average Accuracy (Top1): 84.93466666666664   (Harmonic Accuracy): 82.90437446808511 (Old Acc): 93.2 (New Acc): 74.65714285714286 

2025-01-14 01:39:31,709 [trainer.py] => All params: 173653761
2025-01-14 01:39:31,710 [trainer.py] => Trainable params: 2056449
2025-01-14 01:39:52,009 [asp.py] => Learning on 75-80
2025-01-14 01:39:52,036 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 01:56:14,055 [asp.py] => total parameters: 173657601
2025-01-14 01:56:14,057 [asp.py] => trainable parameters: 2060289
2025-01-14 01:56:54,509 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04, 80.78, 80.42, 79.4, 77.86, 77.33, 75.89, 76.0]
2025-01-14 01:56:54,509 [trainer.py] => Average Accuracy (Top1): 84.37624999999998   (Harmonic Accuracy): 83.02519834973023 (Old Acc): 93.2 (New Acc): 74.85333333333332 

2025-01-14 01:56:54,510 [trainer.py] => All params: 173657601
2025-01-14 01:56:54,511 [trainer.py] => Trainable params: 2060289
2025-01-14 01:57:17,599 [asp.py] => Learning on 80-85
2025-01-14 01:57:17,627 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 02:13:42,420 [asp.py] => total parameters: 173661441
2025-01-14 02:13:42,422 [asp.py] => trainable parameters: 2064129
2025-01-14 02:14:25,656 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04, 80.78, 80.42, 79.4, 77.86, 77.33, 75.89, 76.0, 75.93]
2025-01-14 02:14:25,657 [trainer.py] => Average Accuracy (Top1): 83.87941176470588   (Harmonic Accuracy): 83.02314787265693 (Old Acc): 93.2 (New Acc): 74.85 

2025-01-14 02:14:25,658 [trainer.py] => All params: 173661441
2025-01-14 02:14:25,658 [trainer.py] => Trainable params: 2064129
2025-01-14 02:14:45,301 [asp.py] => Learning on 85-90
2025-01-14 02:14:45,328 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 02:31:05,201 [asp.py] => total parameters: 173665281
2025-01-14 02:31:05,202 [asp.py] => trainable parameters: 2067969
2025-01-14 02:31:50,549 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04, 80.78, 80.42, 79.4, 77.86, 77.33, 75.89, 76.0, 75.93, 76.36]
2025-01-14 02:31:50,549 [trainer.py] => Average Accuracy (Top1): 83.46166666666664   (Harmonic Accuracy): 83.33880513679509 (Old Acc): 93.2 (New Acc): 75.36470588235294 

2025-01-14 02:31:50,550 [trainer.py] => All params: 173665281
2025-01-14 02:31:50,551 [trainer.py] => Trainable params: 2067969
2025-01-14 02:32:12,091 [asp.py] => Learning on 90-95
2025-01-14 02:32:12,117 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 02:48:33,966 [asp.py] => total parameters: 173669121
2025-01-14 02:48:33,967 [asp.py] => trainable parameters: 2071809
2025-01-14 02:49:22,348 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04, 80.78, 80.42, 79.4, 77.86, 77.33, 75.89, 76.0, 75.93, 76.36, 75.05]
2025-01-14 02:49:22,348 [trainer.py] => Average Accuracy (Top1): 83.01894736842104   (Harmonic Accuracy): 82.52521923996811 (Old Acc): 93.2 (New Acc): 74.04444444444445 

2025-01-14 02:49:22,349 [trainer.py] => All params: 173669121
2025-01-14 02:49:22,350 [trainer.py] => Trainable params: 2071809
2025-01-14 02:49:43,666 [asp.py] => Learning on 95-100
2025-01-14 02:49:43,717 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 03:06:06,135 [asp.py] => total parameters: 173672961
2025-01-14 03:06:06,136 [asp.py] => trainable parameters: 2075649
2025-01-14 03:06:56,339 [trainer.py] => Top1 curve: [99.4, 96.9, 92.2, 89.65, 88.92, 85.67, 84.54, 83.02, 82.04, 80.78, 80.42, 79.4, 77.86, 77.33, 75.89, 76.0, 75.93, 76.36, 75.05, 74.11]
2025-01-14 03:06:56,339 [trainer.py] => Average Accuracy (Top1): 82.57349999999998   (Harmonic Accuracy): 81.93860370909552 (Old Acc): 93.2 (New Acc): 73.10526315789473 

2025-01-14 03:06:56,340 [trainer.py] => 

2025-01-14 11:12:41,727 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-14 11:12:41,728 [trainer.py] => model_name: asp
2025-01-14 11:12:41,728 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-14 11:12:41,728 [trainer.py] => device: ['cuda']
2025-01-14 11:12:41,728 [trainer.py] => seed: 2024
2025-01-14 11:12:41,728 [trainer.py] => dataset: cifar224
2025-01-14 11:12:41,728 [trainer.py] => init_cls: 5
2025-01-14 11:12:41,728 [trainer.py] => increment: 5
2025-01-14 11:12:41,728 [trainer.py] => kshot: 5
2025-01-14 11:12:41,728 [trainer.py] => generator_model: CIFAR_GEN
2025-01-14 11:12:41,728 [trainer.py] => z_dim: 1000
2025-01-14 11:12:41,728 [trainer.py] => conv_dim: 64
2025-01-14 11:12:41,728 [trainer.py] => img_size: 224
2025-01-14 11:12:41,728 [trainer.py] => generator_lr: 0.005
2025-01-14 11:12:41,728 [trainer.py] => pi: 100
2025-01-14 11:12:41,728 [trainer.py] => w_bn: 50.0
2025-01-14 11:12:41,728 [trainer.py] => w_noise: 0.001
2025-01-14 11:12:41,729 [trainer.py] => server_ss: 32
2025-01-14 11:12:41,729 [trainer.py] => bn_loss: 1
2025-01-14 11:12:41,729 [trainer.py] => noise: 1
2025-01-14 11:12:41,729 [trainer.py] => ie_loss: 1
2025-01-14 11:12:41,729 [trainer.py] => act_loss: 0
2025-01-14 11:12:41,729 [trainer.py] => w_ie: 1.0
2025-01-14 11:12:41,729 [trainer.py] => w_act: 0.1
2025-01-14 11:12:41,729 [trainer.py] => syn_size: 32
2025-01-14 11:12:41,729 [trainer.py] => need_syn_imgs: True
2025-01-14 11:12:41,729 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-14 11:12:41,729 [trainer.py] => g_local_train_steps: 5
2025-01-14 11:12:41,729 [trainer.py] => dataset_syn: cifar100
2025-01-14 11:12:41,729 [trainer.py] => com_round_gen: 20
2025-01-14 11:12:41,729 [trainer.py] => g_sigma: 0
2025-01-14 11:12:41,729 [trainer.py] => save_cls_embeds: False
2025-01-14 11:12:41,729 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot5_b5_2
2025-01-14 11:12:41,729 [trainer.py] => save_dir: outputs
2025-01-14 11:12:41,729 [trainer.py] => n_iter: 5
2025-01-14 11:12:41,729 [trainer.py] => num_users: 1
2025-01-14 11:12:41,729 [trainer.py] => cur_size: 5
2025-01-14 11:12:41,730 [trainer.py] => g_local_bs: 5
2025-01-14 11:12:41,730 [trainer.py] => local_bs0: 5
2025-01-14 11:12:41,730 [trainer.py] => local_bs1: 5
2025-01-14 11:12:41,730 [trainer.py] => pre_size: 48
2025-01-14 11:12:41,730 [trainer.py] => w_ce_pre: 0.5
2025-01-14 11:12:41,730 [trainer.py] => vpt_type: Deep
2025-01-14 11:12:41,730 [trainer.py] => prompt_token_num: 6
2025-01-14 11:12:41,730 [trainer.py] => avg_alpha: 0.8
2025-01-14 11:12:41,730 [trainer.py] => perturb_var: 1
2025-01-14 11:12:41,730 [trainer.py] => EMA_beta: 0.99
2025-01-14 11:12:41,730 [trainer.py] => anchor_lambda: 0.1
2025-01-14 11:12:41,730 [trainer.py] => kl_weight: 0.001
2025-01-14 11:12:41,730 [trainer.py] => TIP_init: zero
2025-01-14 11:12:41,730 [trainer.py] => tuned_epoch: 10
2025-01-14 11:12:41,730 [trainer.py] => fs_epoch: 0
2025-01-14 11:12:41,730 [trainer.py] => init_lr: 0.01
2025-01-14 11:12:41,730 [trainer.py] => fs_lr: 0.001
2025-01-14 11:12:41,730 [trainer.py] => batch_size: 48
2025-01-14 11:12:41,730 [trainer.py] => fs_batch_size: 16
2025-01-14 11:12:41,730 [trainer.py] => weight_decay: 0.0005
2025-01-14 11:12:41,730 [trainer.py] => min_lr: 0
2025-01-14 11:12:41,730 [trainer.py] => optimizer: sgd
2025-01-14 11:12:41,731 [trainer.py] => memory_size: 0
2025-01-14 11:12:41,731 [trainer.py] => memory_per_class: 0
2025-01-14 11:12:41,731 [trainer.py] => fixed_memory: False
2025-01-14 11:12:41,731 [trainer.py] => shuffle: False
2025-01-14 11:12:41,731 [trainer.py] => top_k: 5
2025-01-14 11:12:41,731 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-14 11:12:41,731 [trainer.py] => prefix: asp
2025-01-14 11:12:41,731 [trainer.py] => model_prefix: asp
2025-01-14 11:12:43,045 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-14 11:12:43,045 [trainer.py] => model_name: asp
2025-01-14 11:12:43,045 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-14 11:12:43,045 [trainer.py] => device: ['cuda']
2025-01-14 11:12:43,045 [trainer.py] => seed: 2024
2025-01-14 11:12:43,045 [trainer.py] => dataset: cifar224
2025-01-14 11:12:43,045 [trainer.py] => init_cls: 5
2025-01-14 11:12:43,045 [trainer.py] => increment: 5
2025-01-14 11:12:43,045 [trainer.py] => kshot: 5
2025-01-14 11:12:43,045 [trainer.py] => generator_model: CIFAR_GEN
2025-01-14 11:12:43,045 [trainer.py] => z_dim: 1000
2025-01-14 11:12:43,045 [trainer.py] => conv_dim: 64
2025-01-14 11:12:43,045 [trainer.py] => img_size: 224
2025-01-14 11:12:43,046 [trainer.py] => generator_lr: 0.005
2025-01-14 11:12:43,046 [trainer.py] => pi: 100
2025-01-14 11:12:43,046 [trainer.py] => w_bn: 50.0
2025-01-14 11:12:43,046 [trainer.py] => w_noise: 0.001
2025-01-14 11:12:43,046 [trainer.py] => server_ss: 32
2025-01-14 11:12:43,046 [trainer.py] => bn_loss: 1
2025-01-14 11:12:43,046 [trainer.py] => noise: 1
2025-01-14 11:12:43,046 [trainer.py] => ie_loss: 1
2025-01-14 11:12:43,046 [trainer.py] => act_loss: 0
2025-01-14 11:12:43,046 [trainer.py] => w_ie: 1.0
2025-01-14 11:12:43,047 [trainer.py] => w_act: 0.1
2025-01-14 11:12:43,047 [trainer.py] => syn_size: 32
2025-01-14 11:12:43,047 [trainer.py] => need_syn_imgs: True
2025-01-14 11:12:43,047 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-14 11:12:43,047 [trainer.py] => g_local_train_steps: 5
2025-01-14 11:12:43,047 [trainer.py] => dataset_syn: cifar100
2025-01-14 11:12:43,047 [trainer.py] => com_round_gen: 20
2025-01-14 11:12:43,047 [trainer.py] => g_sigma: 0
2025-01-14 11:12:43,047 [trainer.py] => save_cls_embeds: False
2025-01-14 11:12:43,047 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot5_b5_2
2025-01-14 11:12:43,047 [trainer.py] => save_dir: outputs
2025-01-14 11:12:43,047 [trainer.py] => n_iter: 5
2025-01-14 11:12:43,047 [trainer.py] => num_users: 1
2025-01-14 11:12:43,047 [trainer.py] => cur_size: 5
2025-01-14 11:12:43,047 [trainer.py] => g_local_bs: 5
2025-01-14 11:12:43,047 [trainer.py] => local_bs0: 5
2025-01-14 11:12:43,047 [trainer.py] => local_bs1: 5
2025-01-14 11:12:43,047 [trainer.py] => pre_size: 48
2025-01-14 11:12:43,047 [trainer.py] => w_ce_pre: 0.5
2025-01-14 11:12:43,047 [trainer.py] => vpt_type: Deep
2025-01-14 11:12:43,048 [trainer.py] => prompt_token_num: 6
2025-01-14 11:12:43,048 [trainer.py] => avg_alpha: 0.8
2025-01-14 11:12:43,048 [trainer.py] => perturb_var: 1
2025-01-14 11:12:43,048 [trainer.py] => EMA_beta: 0.99
2025-01-14 11:12:43,048 [trainer.py] => anchor_lambda: 0.1
2025-01-14 11:12:43,048 [trainer.py] => kl_weight: 0.001
2025-01-14 11:12:43,048 [trainer.py] => TIP_init: zero
2025-01-14 11:12:43,048 [trainer.py] => tuned_epoch: 10
2025-01-14 11:12:43,048 [trainer.py] => fs_epoch: 0
2025-01-14 11:12:43,048 [trainer.py] => init_lr: 0.01
2025-01-14 11:12:43,048 [trainer.py] => fs_lr: 0.001
2025-01-14 11:12:43,048 [trainer.py] => batch_size: 48
2025-01-14 11:12:43,048 [trainer.py] => fs_batch_size: 16
2025-01-14 11:12:43,048 [trainer.py] => weight_decay: 0.0005
2025-01-14 11:12:43,048 [trainer.py] => min_lr: 0
2025-01-14 11:12:43,048 [trainer.py] => optimizer: sgd
2025-01-14 11:12:43,048 [trainer.py] => memory_size: 0
2025-01-14 11:12:43,048 [trainer.py] => memory_per_class: 0
2025-01-14 11:12:43,048 [trainer.py] => fixed_memory: False
2025-01-14 11:12:43,048 [trainer.py] => shuffle: False
2025-01-14 11:12:43,048 [trainer.py] => top_k: 5
2025-01-14 11:12:43,048 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-14 11:12:43,048 [trainer.py] => prefix: asp
2025-01-14 11:12:43,048 [trainer.py] => model_prefix: asp
2025-01-14 11:12:44,720 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-14 11:12:44,766 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-14 11:12:57,311 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-14 11:12:57,311 [trainer.py] => model_name: asp
2025-01-14 11:12:57,311 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-14 11:12:57,311 [trainer.py] => device: ['cuda']
2025-01-14 11:12:57,311 [trainer.py] => seed: 2024
2025-01-14 11:12:57,311 [trainer.py] => dataset: cifar224
2025-01-14 11:12:57,312 [trainer.py] => init_cls: 5
2025-01-14 11:12:57,312 [trainer.py] => increment: 5
2025-01-14 11:12:57,312 [trainer.py] => kshot: 5
2025-01-14 11:12:57,312 [trainer.py] => generator_model: CIFAR_GEN
2025-01-14 11:12:57,312 [trainer.py] => z_dim: 1000
2025-01-14 11:12:57,312 [trainer.py] => conv_dim: 64
2025-01-14 11:12:57,312 [trainer.py] => img_size: 224
2025-01-14 11:12:57,312 [trainer.py] => generator_lr: 0.005
2025-01-14 11:12:57,312 [trainer.py] => pi: 100
2025-01-14 11:12:57,312 [trainer.py] => w_bn: 50.0
2025-01-14 11:12:57,312 [trainer.py] => w_noise: 0.001
2025-01-14 11:12:57,312 [trainer.py] => server_ss: 32
2025-01-14 11:12:57,312 [trainer.py] => bn_loss: 1
2025-01-14 11:12:57,312 [trainer.py] => noise: 1
2025-01-14 11:12:57,312 [trainer.py] => ie_loss: 1
2025-01-14 11:12:57,312 [trainer.py] => act_loss: 0
2025-01-14 11:12:57,312 [trainer.py] => w_ie: 1.0
2025-01-14 11:12:57,312 [trainer.py] => w_act: 0.1
2025-01-14 11:12:57,312 [trainer.py] => syn_size: 32
2025-01-14 11:12:57,312 [trainer.py] => need_syn_imgs: True
2025-01-14 11:12:57,312 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-14 11:12:57,312 [trainer.py] => g_local_train_steps: 5
2025-01-14 11:12:57,312 [trainer.py] => dataset_syn: cifar100
2025-01-14 11:12:57,312 [trainer.py] => com_round_gen: 20
2025-01-14 11:12:57,313 [trainer.py] => g_sigma: 0
2025-01-14 11:12:57,313 [trainer.py] => save_cls_embeds: False
2025-01-14 11:12:57,313 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot5_b5_2
2025-01-14 11:12:57,313 [trainer.py] => save_dir: outputs
2025-01-14 11:12:57,313 [trainer.py] => n_iter: 5
2025-01-14 11:12:57,313 [trainer.py] => num_users: 1
2025-01-14 11:12:57,313 [trainer.py] => cur_size: 5
2025-01-14 11:12:57,313 [trainer.py] => g_local_bs: 5
2025-01-14 11:12:57,313 [trainer.py] => local_bs0: 5
2025-01-14 11:12:57,313 [trainer.py] => local_bs1: 5
2025-01-14 11:12:57,313 [trainer.py] => pre_size: 48
2025-01-14 11:12:57,313 [trainer.py] => w_ce_pre: 0.5
2025-01-14 11:12:57,313 [trainer.py] => vpt_type: Deep
2025-01-14 11:12:57,313 [trainer.py] => prompt_token_num: 6
2025-01-14 11:12:57,313 [trainer.py] => avg_alpha: 0.8
2025-01-14 11:12:57,313 [trainer.py] => perturb_var: 1
2025-01-14 11:12:57,313 [trainer.py] => EMA_beta: 0.99
2025-01-14 11:12:57,313 [trainer.py] => anchor_lambda: 0.1
2025-01-14 11:12:57,313 [trainer.py] => kl_weight: 0.001
2025-01-14 11:12:57,313 [trainer.py] => TIP_init: zero
2025-01-14 11:12:57,313 [trainer.py] => tuned_epoch: 10
2025-01-14 11:12:57,313 [trainer.py] => fs_epoch: 0
2025-01-14 11:12:57,313 [trainer.py] => init_lr: 0.01
2025-01-14 11:12:57,313 [trainer.py] => fs_lr: 0.001
2025-01-14 11:12:57,313 [trainer.py] => batch_size: 48
2025-01-14 11:12:57,313 [trainer.py] => fs_batch_size: 16
2025-01-14 11:12:57,313 [trainer.py] => weight_decay: 0.0005
2025-01-14 11:12:57,313 [trainer.py] => min_lr: 0
2025-01-14 11:12:57,313 [trainer.py] => optimizer: sgd
2025-01-14 11:12:57,314 [trainer.py] => memory_size: 0
2025-01-14 11:12:57,314 [trainer.py] => memory_per_class: 0
2025-01-14 11:12:57,314 [trainer.py] => fixed_memory: False
2025-01-14 11:12:57,314 [trainer.py] => shuffle: False
2025-01-14 11:12:57,314 [trainer.py] => top_k: 5
2025-01-14 11:12:57,314 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-14 11:12:57,314 [trainer.py] => prefix: asp
2025-01-14 11:12:57,314 [trainer.py] => model_prefix: asp
2025-01-14 11:12:59,032 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-14 11:13:28,028 [trainer.py] => All params: 173596160
2025-01-14 11:13:28,029 [trainer.py] => Trainable params: 1998848
2025-01-14 11:13:28,228 [trainer.py] => All params: 173596160
2025-01-14 11:13:28,229 [trainer.py] => Trainable params: 1998848
2025-01-14 11:13:46,622 [asp.py] => Learning on 0-5
2025-01-14 11:13:46,628 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-14 11:13:46,699 [asp.py] => Learning on 0-5
2025-01-14 11:13:46,704 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-14 11:29:51,636 [asp.py] => total parameters: 173600001
2025-01-14 11:29:51,637 [asp.py] => trainable parameters: 2002689
2025-01-14 11:30:01,283 [asp.py] => total parameters: 173600001
2025-01-14 11:30:01,284 [asp.py] => trainable parameters: 2002689
2025-01-14 11:30:56,677 [asp.py] => Task 0, Epoch 1 => Loss 1.239, Train_accy 83.17, Test_curr_accy 99.00, Test_accy 99.00
2025-01-14 11:31:07,188 [asp.py] => Task 0, Epoch 1 => Loss 1.419, Train_accy 75.56, Test_curr_accy 98.80, Test_accy 98.80
2025-01-14 11:31:59,594 [asp.py] => Task 0, Epoch 2 => Loss 0.491, Train_accy 91.64, Test_curr_accy 99.00, Test_accy 99.00
2025-01-14 11:32:10,852 [asp.py] => Task 0, Epoch 2 => Loss 0.539, Train_accy 90.93, Test_curr_accy 98.80, Test_accy 98.80
2025-01-14 11:33:02,426 [asp.py] => Task 0, Epoch 3 => Loss 0.383, Train_accy 92.36, Test_curr_accy 99.00, Test_accy 99.00
2025-01-14 11:33:13,833 [asp.py] => Task 0, Epoch 3 => Loss 0.435, Train_accy 91.76, Test_curr_accy 96.60, Test_accy 96.60
2025-01-14 11:34:06,798 [asp.py] => Task 0, Epoch 4 => Loss 0.429, Train_accy 92.04, Test_curr_accy 99.20, Test_accy 99.20
2025-01-14 11:34:18,378 [asp.py] => Task 0, Epoch 4 => Loss 0.422, Train_accy 91.88, Test_curr_accy 95.00, Test_accy 95.00
2025-01-14 11:35:10,076 [asp.py] => Task 0, Epoch 5 => Loss 0.383, Train_accy 93.43, Test_curr_accy 99.20, Test_accy 99.20
2025-01-14 11:35:20,693 [asp.py] => Task 0, Epoch 5 => Loss 0.415, Train_accy 92.67, Test_curr_accy 98.60, Test_accy 98.60
2025-01-14 11:36:13,109 [asp.py] => Task 0, Epoch 6 => Loss 0.349, Train_accy 93.54, Test_curr_accy 99.60, Test_accy 99.60
2025-01-14 11:36:25,464 [asp.py] => Task 0, Epoch 6 => Loss 0.351, Train_accy 92.83, Test_curr_accy 98.60, Test_accy 98.60
2025-01-14 11:37:16,802 [asp.py] => Task 0, Epoch 7 => Loss 0.315, Train_accy 93.19, Test_curr_accy 99.40, Test_accy 99.40
2025-01-14 11:37:27,501 [asp.py] => Task 0, Epoch 7 => Loss 0.291, Train_accy 93.74, Test_curr_accy 99.20, Test_accy 99.20
2025-01-14 11:38:21,389 [asp.py] => Task 0, Epoch 8 => Loss 0.259, Train_accy 93.94, Test_curr_accy 99.40, Test_accy 99.40
2025-01-14 11:38:30,079 [asp.py] => Task 0, Epoch 8 => Loss 0.262, Train_accy 93.94, Test_curr_accy 99.20, Test_accy 99.20
2025-01-14 11:39:25,208 [asp.py] => Task 0, Epoch 9 => Loss 0.244, Train_accy 94.50, Test_curr_accy 99.40, Test_accy 99.40
2025-01-14 11:39:31,640 [asp.py] => Task 0, Epoch 9 => Loss 0.240, Train_accy 94.53, Test_curr_accy 99.00, Test_accy 99.00
2025-01-14 11:40:32,683 [asp.py] => Task 0, Epoch 10 => Loss 0.226, Train_accy 95.13, Test_curr_accy 99.60, Test_accy 99.60
2025-01-14 11:40:39,970 [asp.py] => Task 0, Epoch 10 => Loss 0.262, Train_accy 95.21, Test_curr_accy 98.60, Test_accy 98.60
2025-01-14 11:41:14,927 [trainer.py] => Top1 curve: [99.2]
2025-01-14 11:41:14,928 [trainer.py] => Average Accuracy (Top1): 99.2   (Harmonic Accuracy): None (Old Acc): 99.2 (New Acc): [] 

2025-01-14 11:41:14,930 [trainer.py] => All params: 173600001
2025-01-14 11:41:14,931 [trainer.py] => Trainable params: 2002689
2025-01-14 11:41:19,733 [trainer.py] => Top1 curve: [99.0]
2025-01-14 11:41:19,734 [trainer.py] => Average Accuracy (Top1): 99.0   (Harmonic Accuracy): None (Old Acc): 99.0 (New Acc): [] 

2025-01-14 11:41:19,736 [trainer.py] => All params: 173600001
2025-01-14 11:41:19,737 [trainer.py] => Trainable params: 2002689
2025-01-14 11:42:03,043 [asp.py] => Learning on 5-10
2025-01-14 11:42:03,058 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 11:42:07,782 [asp.py] => Learning on 5-10
2025-01-14 11:42:07,793 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 11:58:03,732 [asp.py] => total parameters: 173603841
2025-01-14 11:58:03,733 [asp.py] => trainable parameters: 2006529
2025-01-14 11:58:10,631 [trainer.py] => Top1 curve: [99.0, 96.5]
2025-01-14 11:58:10,632 [trainer.py] => Average Accuracy (Top1): 97.75   (Harmonic Accuracy): 96.44518134715025 (Old Acc): 98.8 (New Acc): 94.2 

2025-01-14 11:58:10,633 [trainer.py] => All params: 173603841
2025-01-14 11:58:10,634 [trainer.py] => Trainable params: 2006529
2025-01-14 11:58:16,663 [asp.py] => total parameters: 173603841
2025-01-14 11:58:16,664 [asp.py] => trainable parameters: 2006529
2025-01-14 11:58:23,126 [trainer.py] => Top1 curve: [99.2, 98.4]
2025-01-14 11:58:23,126 [trainer.py] => Average Accuracy (Top1): 98.80000000000001   (Harmonic Accuracy): 98.39837398373983 (Old Acc): 98.8 (New Acc): 98.0 

2025-01-14 11:58:23,127 [trainer.py] => All params: 173603841
2025-01-14 11:58:23,128 [trainer.py] => Trainable params: 2006529
2025-01-14 11:58:34,064 [asp.py] => Learning on 10-15
2025-01-14 11:58:34,078 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 11:58:44,057 [asp.py] => Learning on 10-15
2025-01-14 11:58:44,065 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 12:15:00,698 [asp.py] => total parameters: 173607681
2025-01-14 12:15:00,700 [asp.py] => trainable parameters: 2010369
2025-01-14 12:15:05,110 [asp.py] => total parameters: 173607681
2025-01-14 12:15:05,111 [asp.py] => trainable parameters: 2010369
2025-01-14 12:15:11,907 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67]
2025-01-14 12:15:11,908 [trainer.py] => Average Accuracy (Top1): 95.39   (Harmonic Accuracy): 92.07384948565243 (Old Acc): 97.4 (New Acc): 87.30000000000001 

2025-01-14 12:15:11,909 [trainer.py] => All params: 173607681
2025-01-14 12:15:11,910 [trainer.py] => Trainable params: 2010369
2025-01-14 12:15:15,229 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07]
2025-01-14 12:15:15,230 [trainer.py] => Average Accuracy (Top1): 96.89   (Harmonic Accuracy): 93.83343982960596 (Old Acc): 96.4 (New Acc): 91.4 

2025-01-14 12:15:15,231 [trainer.py] => All params: 173607681
2025-01-14 12:15:15,232 [trainer.py] => Trainable params: 2010369
2025-01-14 12:15:35,065 [asp.py] => Learning on 15-20
2025-01-14 12:15:35,077 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 12:15:36,289 [asp.py] => Learning on 15-20
2025-01-14 12:15:36,305 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 12:31:34,988 [asp.py] => total parameters: 173611521
2025-01-14 12:31:34,989 [asp.py] => trainable parameters: 2014209
2025-01-14 12:31:46,358 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35]
2025-01-14 12:31:46,358 [trainer.py] => Average Accuracy (Top1): 93.63   (Harmonic Accuracy): 90.96825975921196 (Old Acc): 97.4 (New Acc): 85.33333333333333 

2025-01-14 12:31:46,359 [trainer.py] => All params: 173611521
2025-01-14 12:31:46,360 [trainer.py] => Trainable params: 2014209
2025-01-14 12:31:53,066 [asp.py] => total parameters: 173611521
2025-01-14 12:31:53,068 [asp.py] => trainable parameters: 2014209
2025-01-14 12:32:04,495 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25]
2025-01-14 12:32:04,496 [trainer.py] => Average Accuracy (Top1): 95.23   (Harmonic Accuracy): 92.11787648970748 (Old Acc): 96.4 (New Acc): 88.2 

2025-01-14 12:32:04,497 [trainer.py] => All params: 173611521
2025-01-14 12:32:04,497 [trainer.py] => Trainable params: 2014209
2025-01-14 12:32:06,647 [asp.py] => Learning on 20-25
2025-01-14 12:32:06,658 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 12:32:28,186 [asp.py] => Learning on 20-25
2025-01-14 12:32:28,203 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 12:48:00,767 [asp.py] => total parameters: 173615361
2025-01-14 12:48:00,768 [asp.py] => trainable parameters: 2018049
2025-01-14 12:48:14,971 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72]
2025-01-14 12:48:14,971 [trainer.py] => Average Accuracy (Top1): 92.44800000000001   (Harmonic Accuracy): 90.65149766419347 (Old Acc): 96.4 (New Acc): 85.55 

2025-01-14 12:48:14,972 [trainer.py] => All params: 173615361
2025-01-14 12:48:14,973 [trainer.py] => Trainable params: 2018049
2025-01-14 12:48:38,757 [asp.py] => Learning on 25-30
2025-01-14 12:48:38,779 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 12:48:41,353 [asp.py] => total parameters: 173615361
2025-01-14 12:48:41,357 [asp.py] => trainable parameters: 2018049
2025-01-14 12:48:55,268 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4]
2025-01-14 12:48:55,269 [trainer.py] => Average Accuracy (Top1): 94.06400000000001   (Harmonic Accuracy): 91.56129735622785 (Old Acc): 95.6 (New Acc): 87.85 

2025-01-14 12:48:55,270 [trainer.py] => All params: 173615361
2025-01-14 12:48:55,270 [trainer.py] => Trainable params: 2018049
2025-01-14 12:49:13,952 [asp.py] => Learning on 25-30
2025-01-14 12:49:13,970 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 13:04:31,282 [asp.py] => total parameters: 173619201
2025-01-14 13:04:31,284 [asp.py] => trainable parameters: 2021889
2025-01-14 13:04:47,073 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2]
2025-01-14 13:04:47,073 [trainer.py] => Average Accuracy (Top1): 91.07333333333334   (Harmonic Accuracy): 88.41752808988765 (Old Acc): 96.2 (New Acc): 81.80000000000001 

2025-01-14 13:04:47,074 [trainer.py] => All params: 173619201
2025-01-14 13:04:47,074 [trainer.py] => Trainable params: 2021889
2025-01-14 13:05:07,441 [asp.py] => Learning on 30-35
2025-01-14 13:05:07,475 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 13:05:27,028 [asp.py] => total parameters: 173619201
2025-01-14 13:05:27,029 [asp.py] => trainable parameters: 2021889
2025-01-14 13:05:43,511 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3]
2025-01-14 13:05:43,512 [trainer.py] => Average Accuracy (Top1): 92.77   (Harmonic Accuracy): 89.67411686291935 (Old Acc): 95.6 (New Acc): 84.44 

2025-01-14 13:05:43,513 [trainer.py] => All params: 173619201
2025-01-14 13:05:43,513 [trainer.py] => Trainable params: 2021889
2025-01-14 13:06:29,101 [asp.py] => Learning on 30-35
2025-01-14 13:06:29,118 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 13:21:01,615 [asp.py] => total parameters: 173623041
2025-01-14 13:21:01,615 [asp.py] => trainable parameters: 2025729
2025-01-14 13:21:19,608 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63]
2025-01-14 13:21:19,608 [trainer.py] => Average Accuracy (Top1): 89.86714285714287   (Harmonic Accuracy): 87.51020408163266 (Old Acc): 96.0 (New Acc): 80.39999999999999 

2025-01-14 13:21:19,609 [trainer.py] => All params: 173623041
2025-01-14 13:21:19,609 [trainer.py] => Trainable params: 2025729
2025-01-14 13:21:51,564 [asp.py] => Learning on 35-40
2025-01-14 13:21:51,580 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 13:22:41,571 [asp.py] => total parameters: 173623041
2025-01-14 13:22:41,572 [asp.py] => trainable parameters: 2025729
2025-01-14 13:23:00,102 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0]
2025-01-14 13:23:00,103 [trainer.py] => Average Accuracy (Top1): 91.66   (Harmonic Accuracy): 88.85333333333332 (Old Acc): 95.2 (New Acc): 83.3 

2025-01-14 13:23:00,104 [trainer.py] => All params: 173623041
2025-01-14 13:23:00,104 [trainer.py] => Trainable params: 2025729
2025-01-14 13:23:19,089 [asp.py] => Learning on 35-40
2025-01-14 13:23:19,106 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 13:37:44,185 [asp.py] => total parameters: 173626881
2025-01-14 13:37:44,186 [asp.py] => trainable parameters: 2029569
2025-01-14 13:38:04,697 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45]
2025-01-14 13:38:04,698 [trainer.py] => Average Accuracy (Top1): 88.81500000000001   (Harmonic Accuracy): 86.70176470588235 (Old Acc): 95.4 (New Acc): 79.45714285714287 

2025-01-14 13:38:04,700 [trainer.py] => All params: 173626881
2025-01-14 13:38:04,700 [trainer.py] => Trainable params: 2029569
2025-01-14 13:38:24,613 [asp.py] => Learning on 40-45
2025-01-14 13:38:24,633 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 13:39:33,202 [asp.py] => total parameters: 173626881
2025-01-14 13:39:33,203 [asp.py] => trainable parameters: 2029569
2025-01-14 13:39:53,915 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62]
2025-01-14 13:39:53,916 [trainer.py] => Average Accuracy (Top1): 90.655   (Harmonic Accuracy): 87.67234387672343 (Old Acc): 94.0 (New Acc): 82.14285714285714 

2025-01-14 13:39:53,916 [trainer.py] => All params: 173626881
2025-01-14 13:39:53,917 [trainer.py] => Trainable params: 2029569
2025-01-14 13:40:13,397 [asp.py] => Learning on 40-45
2025-01-14 13:40:13,419 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 13:54:18,046 [asp.py] => total parameters: 173630721
2025-01-14 13:54:18,048 [asp.py] => trainable parameters: 2033409
2025-01-14 13:54:40,963 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51]
2025-01-14 13:54:40,963 [trainer.py] => Average Accuracy (Top1): 87.89222222222223   (Harmonic Accuracy): 86.08520437535982 (Old Acc): 95.0 (New Acc): 78.7 

2025-01-14 13:54:40,964 [trainer.py] => All params: 173630721
2025-01-14 13:54:40,965 [trainer.py] => Trainable params: 2033409
2025-01-14 13:55:00,893 [asp.py] => Learning on 45-50
2025-01-14 13:55:00,937 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 13:56:26,812 [asp.py] => total parameters: 173630721
2025-01-14 13:56:26,813 [asp.py] => trainable parameters: 2033409
2025-01-14 13:56:49,770 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02]
2025-01-14 13:56:49,770 [trainer.py] => Average Accuracy (Top1): 89.80666666666667   (Harmonic Accuracy): 87.3908340449758 (Old Acc): 94.0 (New Acc): 81.64999999999999 

2025-01-14 13:56:49,771 [trainer.py] => All params: 173630721
2025-01-14 13:56:49,771 [trainer.py] => Trainable params: 2033409
2025-01-14 13:57:10,787 [asp.py] => Learning on 45-50
2025-01-14 13:57:10,803 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 14:11:13,723 [asp.py] => total parameters: 173634561
2025-01-14 14:11:13,725 [asp.py] => trainable parameters: 2037249
2025-01-14 14:11:53,679 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51, 78.82]
2025-01-14 14:11:53,681 [trainer.py] => Average Accuracy (Top1): 86.98500000000001   (Harmonic Accuracy): 85.07169616328639 (Old Acc): 95.0 (New Acc): 77.02222222222223 

2025-01-14 14:11:53,682 [trainer.py] => All params: 173634561
2025-01-14 14:11:53,683 [trainer.py] => Trainable params: 2037249
2025-01-14 14:13:31,826 [asp.py] => total parameters: 173634561
2025-01-14 14:13:31,827 [asp.py] => trainable parameters: 2037249
2025-01-14 14:13:34,577 [asp.py] => Learning on 50-55
2025-01-14 14:13:34,612 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 14:14:17,391 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02, 81.68]
2025-01-14 14:14:17,395 [trainer.py] => Average Accuracy (Top1): 88.994   (Harmonic Accuracy): 86.61805201427842 (Old Acc): 94.0 (New Acc): 80.3111111111111 

2025-01-14 14:14:17,396 [trainer.py] => All params: 173634561
2025-01-14 14:14:17,397 [trainer.py] => Trainable params: 2037249
2025-01-14 14:15:08,421 [asp.py] => Learning on 50-55
2025-01-14 14:15:08,457 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 14:29:49,930 [asp.py] => total parameters: 173638401
2025-01-14 14:29:49,938 [asp.py] => trainable parameters: 2041089
2025-01-14 14:30:40,916 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51, 78.82, 78.29]
2025-01-14 14:30:40,917 [trainer.py] => Average Accuracy (Top1): 86.19454545454546   (Harmonic Accuracy): 84.75818945403641 (Old Acc): 94.8 (New Acc): 76.64000000000001 

2025-01-14 14:30:40,919 [trainer.py] => All params: 173638401
2025-01-14 14:30:40,920 [trainer.py] => Trainable params: 2041089
2025-01-14 14:31:37,329 [asp.py] => Learning on 55-60
2025-01-14 14:31:37,357 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 14:31:39,404 [asp.py] => total parameters: 173638401
2025-01-14 14:31:39,405 [asp.py] => trainable parameters: 2041089
2025-01-14 14:32:10,431 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02, 81.68, 81.31]
2025-01-14 14:32:10,432 [trainer.py] => Average Accuracy (Top1): 88.29545454545455   (Harmonic Accuracy): 86.46012410940014 (Old Acc): 94.0 (New Acc): 80.03999999999999 

2025-01-14 14:32:10,433 [trainer.py] => All params: 173638401
2025-01-14 14:32:10,434 [trainer.py] => Trainable params: 2041089
2025-01-14 14:32:29,450 [asp.py] => Learning on 55-60
2025-01-14 14:32:29,473 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 14:47:36,866 [asp.py] => total parameters: 173642241
2025-01-14 14:47:36,867 [asp.py] => trainable parameters: 2044929
2025-01-14 14:48:06,785 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51, 78.82, 78.29, 77.1]
2025-01-14 14:48:06,785 [trainer.py] => Average Accuracy (Top1): 85.43666666666667   (Harmonic Accuracy): 83.84768637532132 (Old Acc): 94.2 (New Acc): 75.54545454545453 

2025-01-14 14:48:06,786 [trainer.py] => All params: 173642241
2025-01-14 14:48:06,787 [trainer.py] => Trainable params: 2044929
2025-01-14 14:48:27,217 [asp.py] => Learning on 60-65
2025-01-14 14:48:27,242 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 14:49:47,633 [asp.py] => total parameters: 173642241
2025-01-14 14:49:47,634 [asp.py] => trainable parameters: 2044929
2025-01-14 14:50:32,671 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02, 81.68, 81.31, 80.45]
2025-01-14 14:50:32,673 [trainer.py] => Average Accuracy (Top1): 87.64166666666667   (Harmonic Accuracy): 85.97837724362338 (Old Acc): 94.0 (New Acc): 79.21818181818182 

2025-01-14 14:50:32,675 [trainer.py] => All params: 173642241
2025-01-14 14:50:32,676 [trainer.py] => Trainable params: 2044929
2025-01-14 14:51:16,498 [asp.py] => Learning on 60-65
2025-01-14 14:51:16,533 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 15:04:35,858 [asp.py] => total parameters: 173646081
2025-01-14 15:04:35,859 [asp.py] => trainable parameters: 2048769
2025-01-14 15:05:32,241 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51, 78.82, 78.29, 77.1, 75.05]
2025-01-14 15:05:32,243 [trainer.py] => Average Accuracy (Top1): 84.6376923076923   (Harmonic Accuracy): 82.54088875633761 (Old Acc): 94.2 (New Acc): 73.45 

2025-01-14 15:05:32,244 [trainer.py] => All params: 173646081
2025-01-14 15:05:32,245 [trainer.py] => Trainable params: 2048769
2025-01-14 15:06:25,292 [asp.py] => Learning on 65-70
2025-01-14 15:06:25,326 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 15:07:51,251 [asp.py] => total parameters: 173646081
2025-01-14 15:07:51,254 [asp.py] => trainable parameters: 2048769
2025-01-14 15:08:29,885 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02, 81.68, 81.31, 80.45, 78.77]
2025-01-14 15:08:29,886 [trainer.py] => Average Accuracy (Top1): 86.95923076923077   (Harmonic Accuracy): 84.88448292635469 (Old Acc): 93.8 (New Acc): 77.51666666666667 

2025-01-14 15:08:29,891 [trainer.py] => All params: 173646081
2025-01-14 15:08:29,893 [trainer.py] => Trainable params: 2048769
2025-01-14 15:08:52,968 [asp.py] => Learning on 65-70
2025-01-14 15:08:52,996 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 15:22:24,218 [asp.py] => total parameters: 173649921
2025-01-14 15:22:24,219 [asp.py] => trainable parameters: 2052609
2025-01-14 15:22:59,196 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51, 78.82, 78.29, 77.1, 75.05, 74.6]
2025-01-14 15:22:59,196 [trainer.py] => Average Accuracy (Top1): 83.92071428571428   (Harmonic Accuracy): 82.31454846422659 (Old Acc): 94.2 (New Acc): 73.0923076923077 

2025-01-14 15:22:59,197 [trainer.py] => All params: 173649921
2025-01-14 15:22:59,198 [trainer.py] => Trainable params: 2052609
2025-01-14 15:23:20,524 [asp.py] => Learning on 70-75
2025-01-14 15:23:20,554 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 15:25:07,987 [asp.py] => total parameters: 173649921
2025-01-14 15:25:07,988 [asp.py] => trainable parameters: 2052609
2025-01-14 15:25:43,510 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02, 81.68, 81.31, 80.45, 78.77, 78.01]
2025-01-14 15:25:43,510 [trainer.py] => Average Accuracy (Top1): 86.32000000000001   (Harmonic Accuracy): 84.38111402004152 (Old Acc): 93.6 (New Acc): 76.8153846153846 

2025-01-14 15:25:43,511 [trainer.py] => All params: 173649921
2025-01-14 15:25:43,512 [trainer.py] => Trainable params: 2052609
2025-01-14 15:26:03,835 [asp.py] => Learning on 70-75
2025-01-14 15:26:03,863 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 15:39:16,232 [asp.py] => total parameters: 173653761
2025-01-14 15:39:16,233 [asp.py] => trainable parameters: 2056449
2025-01-14 15:39:53,505 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51, 78.82, 78.29, 77.1, 75.05, 74.6, 73.23]
2025-01-14 15:39:53,506 [trainer.py] => Average Accuracy (Top1): 83.208   (Harmonic Accuracy): 81.37700396483366 (Old Acc): 94.0 (New Acc): 71.74285714285715 

2025-01-14 15:39:53,507 [trainer.py] => All params: 173653761
2025-01-14 15:39:53,507 [trainer.py] => Trainable params: 2056449
2025-01-14 15:40:16,029 [asp.py] => Learning on 75-80
2025-01-14 15:40:16,054 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 15:42:32,215 [asp.py] => total parameters: 173653761
2025-01-14 15:42:32,216 [asp.py] => trainable parameters: 2056449
2025-01-14 15:43:09,112 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02, 81.68, 81.31, 80.45, 78.77, 78.01, 76.53]
2025-01-14 15:43:09,112 [trainer.py] => Average Accuracy (Top1): 85.66733333333333   (Harmonic Accuracy): 83.39652865972398 (Old Acc): 93.4 (New Acc): 75.32857142857144 

2025-01-14 15:43:09,114 [trainer.py] => All params: 173653761
2025-01-14 15:43:09,114 [trainer.py] => Trainable params: 2056449
2025-01-14 15:43:28,706 [asp.py] => Learning on 75-80
2025-01-14 15:43:28,729 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 15:56:12,314 [asp.py] => total parameters: 173657601
2025-01-14 15:56:12,315 [asp.py] => trainable parameters: 2060289
2025-01-14 15:56:51,730 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51, 78.82, 78.29, 77.1, 75.05, 74.6, 73.23, 73.62]
2025-01-14 15:56:51,730 [trainer.py] => Average Accuracy (Top1): 82.60874999999999   (Harmonic Accuracy): 81.71291098636729 (Old Acc): 94.0 (New Acc): 72.26666666666667 

2025-01-14 15:56:51,731 [trainer.py] => All params: 173657601
2025-01-14 15:56:51,732 [trainer.py] => Trainable params: 2060289
2025-01-14 15:57:13,670 [asp.py] => Learning on 80-85
2025-01-14 15:57:13,712 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 15:59:56,622 [asp.py] => total parameters: 173657601
2025-01-14 15:59:56,623 [asp.py] => trainable parameters: 2060289
2025-01-14 16:00:47,197 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02, 81.68, 81.31, 80.45, 78.77, 78.01, 76.53, 76.99]
2025-01-14 16:00:47,197 [trainer.py] => Average Accuracy (Top1): 85.125   (Harmonic Accuracy): 83.7414822398992 (Old Acc): 93.4 (New Acc): 75.89333333333335 

2025-01-14 16:00:47,198 [trainer.py] => All params: 173657601
2025-01-14 16:00:47,199 [trainer.py] => Trainable params: 2060289
2025-01-14 16:01:06,598 [asp.py] => Learning on 80-85
2025-01-14 16:01:06,622 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 16:13:10,285 [asp.py] => total parameters: 173661441
2025-01-14 16:13:10,286 [asp.py] => trainable parameters: 2064129
2025-01-14 16:13:51,804 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51, 78.82, 78.29, 77.1, 75.05, 74.6, 73.23, 73.62, 73.45]
2025-01-14 16:13:51,805 [trainer.py] => Average Accuracy (Top1): 82.07   (Harmonic Accuracy): 81.6462799969909 (Old Acc): 94.0 (New Acc): 72.1625 

2025-01-14 16:13:51,806 [trainer.py] => All params: 173661441
2025-01-14 16:13:51,806 [trainer.py] => Trainable params: 2064129
2025-01-14 16:14:12,301 [asp.py] => Learning on 85-90
2025-01-14 16:14:12,329 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 16:17:23,287 [asp.py] => total parameters: 173661441
2025-01-14 16:17:23,288 [asp.py] => trainable parameters: 2064129
2025-01-14 16:18:06,416 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02, 81.68, 81.31, 80.45, 78.77, 78.01, 76.53, 76.99, 76.79]
2025-01-14 16:18:06,416 [trainer.py] => Average Accuracy (Top1): 84.63470588235293   (Harmonic Accuracy): 83.65415311853384 (Old Acc): 93.4 (New Acc): 75.75 

2025-01-14 16:18:06,417 [trainer.py] => All params: 173661441
2025-01-14 16:18:06,418 [trainer.py] => Trainable params: 2064129
2025-01-14 16:18:27,664 [asp.py] => Learning on 85-90
2025-01-14 16:18:27,695 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 16:30:08,226 [asp.py] => total parameters: 173665281
2025-01-14 16:30:08,227 [asp.py] => trainable parameters: 2067969
2025-01-14 16:30:52,734 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51, 78.82, 78.29, 77.1, 75.05, 74.6, 73.23, 73.62, 73.45, 73.94]
2025-01-14 16:30:52,735 [trainer.py] => Average Accuracy (Top1): 81.61833333333333   (Harmonic Accuracy): 82.03033509700177 (Old Acc): 94.0 (New Acc): 72.76470588235294 

2025-01-14 16:30:52,736 [trainer.py] => All params: 173665281
2025-01-14 16:30:52,737 [trainer.py] => Trainable params: 2067969
2025-01-14 16:31:13,122 [asp.py] => Learning on 90-95
2025-01-14 16:31:13,158 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 16:34:41,885 [asp.py] => total parameters: 173665281
2025-01-14 16:34:41,886 [asp.py] => trainable parameters: 2067969
2025-01-14 16:35:26,733 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02, 81.68, 81.31, 80.45, 78.77, 78.01, 76.53, 76.99, 76.79, 77.26]
2025-01-14 16:35:26,734 [trainer.py] => Average Accuracy (Top1): 84.225   (Harmonic Accuracy): 83.99201386481803 (Old Acc): 93.4 (New Acc): 76.30588235294118 

2025-01-14 16:35:26,735 [trainer.py] => All params: 173665281
2025-01-14 16:35:26,736 [trainer.py] => Trainable params: 2067969
2025-01-14 16:35:45,533 [asp.py] => Learning on 90-95
2025-01-14 16:35:45,566 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 16:47:09,117 [asp.py] => total parameters: 173669121
2025-01-14 16:47:09,118 [asp.py] => trainable parameters: 2071809
2025-01-14 16:47:55,921 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51, 78.82, 78.29, 77.1, 75.05, 74.6, 73.23, 73.62, 73.45, 73.94, 73.16]
2025-01-14 16:47:55,922 [trainer.py] => Average Accuracy (Top1): 81.17315789473685   (Harmonic Accuracy): 81.5421686746988 (Old Acc): 94.0 (New Acc): 72.0 

2025-01-14 16:47:55,924 [trainer.py] => All params: 173669121
2025-01-14 16:47:55,924 [trainer.py] => Trainable params: 2071809
2025-01-14 16:48:16,444 [asp.py] => Learning on 95-100
2025-01-14 16:48:16,484 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 16:52:00,590 [asp.py] => total parameters: 173669121
2025-01-14 16:52:00,591 [asp.py] => trainable parameters: 2071809
2025-01-14 16:52:47,607 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02, 81.68, 81.31, 80.45, 78.77, 78.01, 76.53, 76.99, 76.79, 77.26, 76.12]
2025-01-14 16:52:47,607 [trainer.py] => Average Accuracy (Top1): 83.79842105263158   (Harmonic Accuracy): 83.29038892551088 (Old Acc): 93.4 (New Acc): 75.15555555555555 

2025-01-14 16:52:47,609 [trainer.py] => All params: 173669121
2025-01-14 16:52:47,609 [trainer.py] => Trainable params: 2071809
2025-01-14 16:53:09,022 [asp.py] => Learning on 95-100
2025-01-14 16:53:09,062 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-14 17:04:13,381 [asp.py] => total parameters: 173672961
2025-01-14 17:04:13,382 [asp.py] => trainable parameters: 2075649
2025-01-14 17:05:02,353 [trainer.py] => Top1 curve: [99.0, 96.5, 90.67, 88.35, 87.72, 84.2, 82.63, 81.45, 80.51, 78.82, 78.29, 77.1, 75.05, 74.6, 73.23, 73.62, 73.45, 73.94, 73.16, 72.18]
2025-01-14 17:05:02,354 [trainer.py] => Average Accuracy (Top1): 80.7235   (Harmonic Accuracy): 80.91746396224009 (Old Acc): 94.0 (New Acc): 71.03157894736843 

2025-01-14 17:05:02,354 [trainer.py] => 

2025-01-14 17:09:25,389 [asp.py] => total parameters: 173672961
2025-01-14 17:09:25,390 [asp.py] => trainable parameters: 2075649
2025-01-14 17:10:14,821 [trainer.py] => Top1 curve: [99.2, 98.4, 93.07, 90.25, 89.4, 86.3, 85.0, 83.62, 83.02, 81.68, 81.31, 80.45, 78.77, 78.01, 76.53, 76.99, 76.79, 77.26, 76.12, 75.16]
2025-01-14 17:10:14,821 [trainer.py] => Average Accuracy (Top1): 83.3665   (Harmonic Accuracy): 82.70023866348448 (Old Acc): 93.4 (New Acc): 74.2 

2025-01-14 17:10:14,821 [trainer.py] => 

2025-01-15 20:49:37,829 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-15 20:49:37,829 [trainer.py] => model_name: asp
2025-01-15 20:49:37,829 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-15 20:49:37,829 [trainer.py] => device: ['cuda']
2025-01-15 20:49:37,829 [trainer.py] => seed: 2024
2025-01-15 20:49:37,829 [trainer.py] => dataset: cifar224
2025-01-15 20:49:37,829 [trainer.py] => init_cls: 5
2025-01-15 20:49:37,829 [trainer.py] => increment: 5
2025-01-15 20:49:37,829 [trainer.py] => kshot: 5
2025-01-15 20:49:37,829 [trainer.py] => generator_model: CIFAR_GEN
2025-01-15 20:49:37,830 [trainer.py] => z_dim: 1000
2025-01-15 20:49:37,830 [trainer.py] => conv_dim: 64
2025-01-15 20:49:37,830 [trainer.py] => img_size: 224
2025-01-15 20:49:37,830 [trainer.py] => generator_lr: 0.005
2025-01-15 20:49:37,830 [trainer.py] => pi: 100
2025-01-15 20:49:37,830 [trainer.py] => w_bn: 50.0
2025-01-15 20:49:37,830 [trainer.py] => w_noise: 0.001
2025-01-15 20:49:37,830 [trainer.py] => server_ss: 32
2025-01-15 20:49:37,830 [trainer.py] => bn_loss: 1
2025-01-15 20:49:37,830 [trainer.py] => noise: 1
2025-01-15 20:49:37,830 [trainer.py] => ie_loss: 1
2025-01-15 20:49:37,830 [trainer.py] => act_loss: 0
2025-01-15 20:49:37,830 [trainer.py] => w_ie: 1.0
2025-01-15 20:49:37,830 [trainer.py] => w_act: 0.1
2025-01-15 20:49:37,830 [trainer.py] => syn_size: 32
2025-01-15 20:49:37,830 [trainer.py] => need_syn_imgs: True
2025-01-15 20:49:37,830 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-15 20:49:37,830 [trainer.py] => g_local_train_steps: 5
2025-01-15 20:49:37,830 [trainer.py] => dataset_syn: cifar100
2025-01-15 20:49:37,830 [trainer.py] => com_round_gen: 20
2025-01-15 20:49:37,830 [trainer.py] => g_sigma: 0
2025-01-15 20:49:37,830 [trainer.py] => save_cls_embeds: False
2025-01-15 20:49:37,830 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_b5_2_continualgene
2025-01-15 20:49:37,830 [trainer.py] => save_dir: outputs
2025-01-15 20:49:37,830 [trainer.py] => n_iter: 5
2025-01-15 20:49:37,830 [trainer.py] => num_users: 1
2025-01-15 20:49:37,830 [trainer.py] => cur_size: 5
2025-01-15 20:49:37,830 [trainer.py] => g_local_bs: 5
2025-01-15 20:49:37,830 [trainer.py] => local_bs0: 5
2025-01-15 20:49:37,830 [trainer.py] => local_bs1: 5
2025-01-15 20:49:37,830 [trainer.py] => pre_size: 48
2025-01-15 20:49:37,830 [trainer.py] => w_ce_pre: 0.5
2025-01-15 20:49:37,831 [trainer.py] => vpt_type: Deep
2025-01-15 20:49:37,831 [trainer.py] => prompt_token_num: 6
2025-01-15 20:49:37,831 [trainer.py] => avg_alpha: 0.8
2025-01-15 20:49:37,831 [trainer.py] => perturb_var: 1
2025-01-15 20:49:37,831 [trainer.py] => EMA_beta: 0.99
2025-01-15 20:49:37,831 [trainer.py] => anchor_lambda: 0.1
2025-01-15 20:49:37,831 [trainer.py] => kl_weight: 0.001
2025-01-15 20:49:37,831 [trainer.py] => TIP_init: zero
2025-01-15 20:49:37,831 [trainer.py] => tuned_epoch: 10
2025-01-15 20:49:37,831 [trainer.py] => fs_epoch: 0
2025-01-15 20:49:37,831 [trainer.py] => init_lr: 0.01
2025-01-15 20:49:37,831 [trainer.py] => fs_lr: 0.001
2025-01-15 20:49:37,831 [trainer.py] => batch_size: 48
2025-01-15 20:49:37,831 [trainer.py] => fs_batch_size: 16
2025-01-15 20:49:37,831 [trainer.py] => weight_decay: 0.0005
2025-01-15 20:49:37,831 [trainer.py] => min_lr: 0
2025-01-15 20:49:37,831 [trainer.py] => optimizer: sgd
2025-01-15 20:49:37,831 [trainer.py] => memory_size: 0
2025-01-15 20:49:37,831 [trainer.py] => memory_per_class: 0
2025-01-15 20:49:37,831 [trainer.py] => fixed_memory: False
2025-01-15 20:49:37,831 [trainer.py] => shuffle: False
2025-01-15 20:49:37,831 [trainer.py] => top_k: 5
2025-01-15 20:49:37,831 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-15 20:49:37,831 [trainer.py] => prefix: asp
2025-01-15 20:49:37,831 [trainer.py] => model_prefix: asp
2025-01-15 20:49:40,237 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-15 20:49:44,830 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-15 20:49:44,830 [trainer.py] => model_name: asp
2025-01-15 20:49:44,830 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-15 20:49:44,830 [trainer.py] => device: ['cuda']
2025-01-15 20:49:44,830 [trainer.py] => seed: 2024
2025-01-15 20:49:44,830 [trainer.py] => dataset: cifar224
2025-01-15 20:49:44,830 [trainer.py] => init_cls: 5
2025-01-15 20:49:44,830 [trainer.py] => increment: 5
2025-01-15 20:49:44,830 [trainer.py] => kshot: 5
2025-01-15 20:49:44,830 [trainer.py] => generator_model: CIFAR_GEN
2025-01-15 20:49:44,830 [trainer.py] => z_dim: 1000
2025-01-15 20:49:44,831 [trainer.py] => conv_dim: 64
2025-01-15 20:49:44,831 [trainer.py] => img_size: 224
2025-01-15 20:49:44,831 [trainer.py] => generator_lr: 0.005
2025-01-15 20:49:44,831 [trainer.py] => pi: 100
2025-01-15 20:49:44,831 [trainer.py] => w_bn: 50.0
2025-01-15 20:49:44,831 [trainer.py] => w_noise: 0.001
2025-01-15 20:49:44,831 [trainer.py] => server_ss: 32
2025-01-15 20:49:44,831 [trainer.py] => bn_loss: 1
2025-01-15 20:49:44,831 [trainer.py] => noise: 1
2025-01-15 20:49:44,831 [trainer.py] => ie_loss: 1
2025-01-15 20:49:44,831 [trainer.py] => act_loss: 0
2025-01-15 20:49:44,831 [trainer.py] => w_ie: 1.0
2025-01-15 20:49:44,831 [trainer.py] => w_act: 0.1
2025-01-15 20:49:44,831 [trainer.py] => syn_size: 32
2025-01-15 20:49:44,831 [trainer.py] => need_syn_imgs: True
2025-01-15 20:49:44,831 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-15 20:49:44,831 [trainer.py] => g_local_train_steps: 5
2025-01-15 20:49:44,831 [trainer.py] => dataset_syn: cifar100
2025-01-15 20:49:44,831 [trainer.py] => com_round_gen: 20
2025-01-15 20:49:44,831 [trainer.py] => g_sigma: 0
2025-01-15 20:49:44,831 [trainer.py] => save_cls_embeds: False
2025-01-15 20:49:44,831 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_b5_2_continualgene
2025-01-15 20:49:44,831 [trainer.py] => save_dir: outputs
2025-01-15 20:49:44,831 [trainer.py] => n_iter: 5
2025-01-15 20:49:44,831 [trainer.py] => num_users: 1
2025-01-15 20:49:44,831 [trainer.py] => cur_size: 5
2025-01-15 20:49:44,831 [trainer.py] => g_local_bs: 5
2025-01-15 20:49:44,831 [trainer.py] => local_bs0: 5
2025-01-15 20:49:44,831 [trainer.py] => local_bs1: 5
2025-01-15 20:49:44,831 [trainer.py] => pre_size: 48
2025-01-15 20:49:44,831 [trainer.py] => w_ce_pre: 0.5
2025-01-15 20:49:44,831 [trainer.py] => vpt_type: Deep
2025-01-15 20:49:44,832 [trainer.py] => prompt_token_num: 6
2025-01-15 20:49:44,832 [trainer.py] => avg_alpha: 0.8
2025-01-15 20:49:44,832 [trainer.py] => perturb_var: 1
2025-01-15 20:49:44,832 [trainer.py] => EMA_beta: 0.99
2025-01-15 20:49:44,832 [trainer.py] => anchor_lambda: 0.1
2025-01-15 20:49:44,832 [trainer.py] => kl_weight: 0.001
2025-01-15 20:49:44,832 [trainer.py] => TIP_init: zero
2025-01-15 20:49:44,832 [trainer.py] => tuned_epoch: 10
2025-01-15 20:49:44,832 [trainer.py] => fs_epoch: 0
2025-01-15 20:49:44,832 [trainer.py] => init_lr: 0.01
2025-01-15 20:49:44,832 [trainer.py] => fs_lr: 0.001
2025-01-15 20:49:44,832 [trainer.py] => batch_size: 48
2025-01-15 20:49:44,832 [trainer.py] => fs_batch_size: 16
2025-01-15 20:49:44,832 [trainer.py] => weight_decay: 0.0005
2025-01-15 20:49:44,832 [trainer.py] => min_lr: 0
2025-01-15 20:49:44,832 [trainer.py] => optimizer: sgd
2025-01-15 20:49:44,832 [trainer.py] => memory_size: 0
2025-01-15 20:49:44,832 [trainer.py] => memory_per_class: 0
2025-01-15 20:49:44,832 [trainer.py] => fixed_memory: False
2025-01-15 20:49:44,832 [trainer.py] => shuffle: False
2025-01-15 20:49:44,832 [trainer.py] => top_k: 5
2025-01-15 20:49:44,832 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-15 20:49:44,832 [trainer.py] => prefix: asp
2025-01-15 20:49:44,832 [trainer.py] => model_prefix: asp
2025-01-15 20:49:46,492 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-15 20:50:14,752 [trainer.py] => All params: 173596160
2025-01-15 20:50:14,753 [trainer.py] => Trainable params: 1998848
2025-01-15 20:50:14,812 [trainer.py] => All params: 173596160
2025-01-15 20:50:14,813 [trainer.py] => Trainable params: 1998848
2025-01-15 20:51:14,013 [asp.py] => Learning on 0-5
2025-01-15 20:51:14,018 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-15 20:51:15,325 [asp.py] => Learning on 0-5
2025-01-15 20:51:15,332 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-15 21:02:48,129 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-15 21:02:48,129 [trainer.py] => model_name: asp
2025-01-15 21:02:48,129 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-15 21:02:48,129 [trainer.py] => device: ['cuda']
2025-01-15 21:02:48,129 [trainer.py] => seed: 2024
2025-01-15 21:02:48,129 [trainer.py] => dataset: cifar224
2025-01-15 21:02:48,129 [trainer.py] => init_cls: 5
2025-01-15 21:02:48,129 [trainer.py] => increment: 5
2025-01-15 21:02:48,129 [trainer.py] => kshot: 5
2025-01-15 21:02:48,129 [trainer.py] => generator_model: CIFAR_GEN
2025-01-15 21:02:48,129 [trainer.py] => z_dim: 1000
2025-01-15 21:02:48,129 [trainer.py] => conv_dim: 64
2025-01-15 21:02:48,130 [trainer.py] => img_size: 224
2025-01-15 21:02:48,130 [trainer.py] => generator_lr: 0.005
2025-01-15 21:02:48,130 [trainer.py] => pi: 100
2025-01-15 21:02:48,130 [trainer.py] => w_bn: 50.0
2025-01-15 21:02:48,130 [trainer.py] => w_noise: 0.001
2025-01-15 21:02:48,130 [trainer.py] => server_ss: 32
2025-01-15 21:02:48,130 [trainer.py] => bn_loss: 1
2025-01-15 21:02:48,130 [trainer.py] => noise: 1
2025-01-15 21:02:48,130 [trainer.py] => ie_loss: 1
2025-01-15 21:02:48,130 [trainer.py] => act_loss: 0
2025-01-15 21:02:48,130 [trainer.py] => w_ie: 1.0
2025-01-15 21:02:48,130 [trainer.py] => w_act: 0.1
2025-01-15 21:02:48,130 [trainer.py] => syn_size: 32
2025-01-15 21:02:48,130 [trainer.py] => need_syn_imgs: True
2025-01-15 21:02:48,130 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-15 21:02:48,130 [trainer.py] => g_local_train_steps: 5
2025-01-15 21:02:48,130 [trainer.py] => dataset_syn: cifar100
2025-01-15 21:02:48,130 [trainer.py] => com_round_gen: 20
2025-01-15 21:02:48,130 [trainer.py] => g_sigma: 0
2025-01-15 21:02:48,130 [trainer.py] => save_cls_embeds: False
2025-01-15 21:02:48,130 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_b5_2_continualgene1
2025-01-15 21:02:48,130 [trainer.py] => save_dir: outputs
2025-01-15 21:02:48,130 [trainer.py] => n_iter: 5
2025-01-15 21:02:48,131 [trainer.py] => num_users: 1
2025-01-15 21:02:48,131 [trainer.py] => cur_size: 5
2025-01-15 21:02:48,131 [trainer.py] => g_local_bs: 5
2025-01-15 21:02:48,131 [trainer.py] => local_bs0: 5
2025-01-15 21:02:48,131 [trainer.py] => local_bs1: 5
2025-01-15 21:02:48,131 [trainer.py] => pre_size: 48
2025-01-15 21:02:48,131 [trainer.py] => w_ce_pre: 0.5
2025-01-15 21:02:48,131 [trainer.py] => vpt_type: Deep
2025-01-15 21:02:48,131 [trainer.py] => prompt_token_num: 6
2025-01-15 21:02:48,131 [trainer.py] => avg_alpha: 0.8
2025-01-15 21:02:48,131 [trainer.py] => perturb_var: 1
2025-01-15 21:02:48,131 [trainer.py] => EMA_beta: 0.99
2025-01-15 21:02:48,131 [trainer.py] => anchor_lambda: 0.1
2025-01-15 21:02:48,131 [trainer.py] => kl_weight: 0.001
2025-01-15 21:02:48,131 [trainer.py] => TIP_init: zero
2025-01-15 21:02:48,131 [trainer.py] => tuned_epoch: 10
2025-01-15 21:02:48,131 [trainer.py] => fs_epoch: 0
2025-01-15 21:02:48,131 [trainer.py] => init_lr: 0.01
2025-01-15 21:02:48,131 [trainer.py] => fs_lr: 0.001
2025-01-15 21:02:48,131 [trainer.py] => batch_size: 48
2025-01-15 21:02:48,131 [trainer.py] => fs_batch_size: 16
2025-01-15 21:02:48,131 [trainer.py] => weight_decay: 0.0005
2025-01-15 21:02:48,131 [trainer.py] => min_lr: 0
2025-01-15 21:02:48,131 [trainer.py] => optimizer: sgd
2025-01-15 21:02:48,132 [trainer.py] => memory_size: 0
2025-01-15 21:02:48,132 [trainer.py] => memory_per_class: 0
2025-01-15 21:02:48,132 [trainer.py] => fixed_memory: False
2025-01-15 21:02:48,132 [trainer.py] => shuffle: False
2025-01-15 21:02:48,132 [trainer.py] => top_k: 5
2025-01-15 21:02:48,132 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-15 21:02:48,132 [trainer.py] => prefix: asp
2025-01-15 21:02:48,132 [trainer.py] => model_prefix: asp
2025-01-15 21:02:49,766 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-15 21:02:58,815 [trainer.py] => All params: 173596160
2025-01-15 21:02:58,816 [trainer.py] => Trainable params: 1998848
2025-01-15 21:03:06,535 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-15 21:03:06,535 [trainer.py] => model_name: asp
2025-01-15 21:03:06,536 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-15 21:03:06,536 [trainer.py] => device: ['cuda']
2025-01-15 21:03:06,536 [trainer.py] => seed: 2024
2025-01-15 21:03:06,536 [trainer.py] => dataset: cifar224
2025-01-15 21:03:06,536 [trainer.py] => init_cls: 5
2025-01-15 21:03:06,536 [trainer.py] => increment: 5
2025-01-15 21:03:06,536 [trainer.py] => kshot: 5
2025-01-15 21:03:06,536 [trainer.py] => generator_model: CIFAR_GEN
2025-01-15 21:03:06,536 [trainer.py] => z_dim: 1000
2025-01-15 21:03:06,536 [trainer.py] => conv_dim: 64
2025-01-15 21:03:06,536 [trainer.py] => img_size: 224
2025-01-15 21:03:06,536 [trainer.py] => generator_lr: 0.005
2025-01-15 21:03:06,536 [trainer.py] => pi: 100
2025-01-15 21:03:06,536 [trainer.py] => w_bn: 50.0
2025-01-15 21:03:06,536 [trainer.py] => w_noise: 0.001
2025-01-15 21:03:06,536 [trainer.py] => server_ss: 32
2025-01-15 21:03:06,536 [trainer.py] => bn_loss: 1
2025-01-15 21:03:06,536 [trainer.py] => noise: 1
2025-01-15 21:03:06,536 [trainer.py] => ie_loss: 1
2025-01-15 21:03:06,536 [trainer.py] => act_loss: 0
2025-01-15 21:03:06,536 [trainer.py] => w_ie: 1.0
2025-01-15 21:03:06,536 [trainer.py] => w_act: 0.1
2025-01-15 21:03:06,536 [trainer.py] => syn_size: 32
2025-01-15 21:03:06,536 [trainer.py] => need_syn_imgs: True
2025-01-15 21:03:06,536 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-15 21:03:06,536 [trainer.py] => g_local_train_steps: 5
2025-01-15 21:03:06,536 [trainer.py] => dataset_syn: cifar100
2025-01-15 21:03:06,536 [trainer.py] => com_round_gen: 20
2025-01-15 21:03:06,536 [trainer.py] => g_sigma: 0
2025-01-15 21:03:06,536 [trainer.py] => save_cls_embeds: False
2025-01-15 21:03:06,536 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_b5_2_continualgene0
2025-01-15 21:03:06,537 [trainer.py] => save_dir: outputs
2025-01-15 21:03:06,537 [trainer.py] => n_iter: 5
2025-01-15 21:03:06,537 [trainer.py] => num_users: 1
2025-01-15 21:03:06,537 [trainer.py] => cur_size: 5
2025-01-15 21:03:06,537 [trainer.py] => g_local_bs: 5
2025-01-15 21:03:06,537 [trainer.py] => local_bs0: 5
2025-01-15 21:03:06,537 [trainer.py] => local_bs1: 5
2025-01-15 21:03:06,537 [trainer.py] => pre_size: 48
2025-01-15 21:03:06,537 [trainer.py] => w_ce_pre: 0.5
2025-01-15 21:03:06,537 [trainer.py] => vpt_type: Deep
2025-01-15 21:03:06,537 [trainer.py] => prompt_token_num: 6
2025-01-15 21:03:06,537 [trainer.py] => avg_alpha: 0.8
2025-01-15 21:03:06,537 [trainer.py] => perturb_var: 1
2025-01-15 21:03:06,537 [trainer.py] => EMA_beta: 0.99
2025-01-15 21:03:06,537 [trainer.py] => anchor_lambda: 0.1
2025-01-15 21:03:06,537 [trainer.py] => kl_weight: 0.001
2025-01-15 21:03:06,537 [trainer.py] => TIP_init: zero
2025-01-15 21:03:06,537 [trainer.py] => tuned_epoch: 10
2025-01-15 21:03:06,537 [trainer.py] => fs_epoch: 0
2025-01-15 21:03:06,537 [trainer.py] => init_lr: 0.01
2025-01-15 21:03:06,537 [trainer.py] => fs_lr: 0.001
2025-01-15 21:03:06,537 [trainer.py] => batch_size: 48
2025-01-15 21:03:06,537 [trainer.py] => fs_batch_size: 16
2025-01-15 21:03:06,537 [trainer.py] => weight_decay: 0.0005
2025-01-15 21:03:06,537 [trainer.py] => min_lr: 0
2025-01-15 21:03:06,537 [trainer.py] => optimizer: sgd
2025-01-15 21:03:06,537 [trainer.py] => memory_size: 0
2025-01-15 21:03:06,537 [trainer.py] => memory_per_class: 0
2025-01-15 21:03:06,537 [trainer.py] => fixed_memory: False
2025-01-15 21:03:06,537 [trainer.py] => shuffle: False
2025-01-15 21:03:06,537 [trainer.py] => top_k: 5
2025-01-15 21:03:06,537 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-15 21:03:06,538 [trainer.py] => prefix: asp
2025-01-15 21:03:06,538 [trainer.py] => model_prefix: asp
2025-01-15 21:03:08,074 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-15 21:03:20,544 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-15 21:03:20,545 [trainer.py] => model_name: asp
2025-01-15 21:03:20,545 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-15 21:03:20,545 [trainer.py] => device: ['cuda']
2025-01-15 21:03:20,545 [trainer.py] => seed: 2024
2025-01-15 21:03:20,545 [trainer.py] => dataset: cifar224
2025-01-15 21:03:20,545 [trainer.py] => init_cls: 5
2025-01-15 21:03:20,545 [trainer.py] => increment: 5
2025-01-15 21:03:20,545 [trainer.py] => kshot: 5
2025-01-15 21:03:20,545 [trainer.py] => generator_model: CIFAR_GEN
2025-01-15 21:03:20,545 [trainer.py] => z_dim: 1000
2025-01-15 21:03:20,545 [trainer.py] => conv_dim: 64
2025-01-15 21:03:20,545 [trainer.py] => img_size: 224
2025-01-15 21:03:20,545 [trainer.py] => generator_lr: 0.005
2025-01-15 21:03:20,545 [trainer.py] => pi: 100
2025-01-15 21:03:20,545 [trainer.py] => w_bn: 50.0
2025-01-15 21:03:20,545 [trainer.py] => w_noise: 0.001
2025-01-15 21:03:20,545 [trainer.py] => server_ss: 32
2025-01-15 21:03:20,545 [trainer.py] => bn_loss: 1
2025-01-15 21:03:20,545 [trainer.py] => noise: 1
2025-01-15 21:03:20,545 [trainer.py] => ie_loss: 1
2025-01-15 21:03:20,545 [trainer.py] => act_loss: 0
2025-01-15 21:03:20,545 [trainer.py] => w_ie: 1.0
2025-01-15 21:03:20,545 [trainer.py] => w_act: 0.1
2025-01-15 21:03:20,545 [trainer.py] => syn_size: 32
2025-01-15 21:03:20,545 [trainer.py] => need_syn_imgs: True
2025-01-15 21:03:20,545 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-15 21:03:20,545 [trainer.py] => g_local_train_steps: 5
2025-01-15 21:03:20,545 [trainer.py] => dataset_syn: cifar100
2025-01-15 21:03:20,546 [trainer.py] => com_round_gen: 20
2025-01-15 21:03:20,546 [trainer.py] => g_sigma: 0
2025-01-15 21:03:20,546 [trainer.py] => save_cls_embeds: False
2025-01-15 21:03:20,546 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_b5_2_continualgene0
2025-01-15 21:03:20,546 [trainer.py] => save_dir: outputs
2025-01-15 21:03:20,546 [trainer.py] => n_iter: 5
2025-01-15 21:03:20,546 [trainer.py] => num_users: 1
2025-01-15 21:03:20,546 [trainer.py] => cur_size: 5
2025-01-15 21:03:20,546 [trainer.py] => g_local_bs: 5
2025-01-15 21:03:20,546 [trainer.py] => local_bs0: 5
2025-01-15 21:03:20,546 [trainer.py] => local_bs1: 5
2025-01-15 21:03:20,546 [trainer.py] => pre_size: 48
2025-01-15 21:03:20,546 [trainer.py] => w_ce_pre: 0.5
2025-01-15 21:03:20,546 [trainer.py] => vpt_type: Deep
2025-01-15 21:03:20,546 [trainer.py] => prompt_token_num: 6
2025-01-15 21:03:20,546 [trainer.py] => avg_alpha: 0.8
2025-01-15 21:03:20,546 [trainer.py] => perturb_var: 1
2025-01-15 21:03:20,546 [trainer.py] => EMA_beta: 0.99
2025-01-15 21:03:20,546 [trainer.py] => anchor_lambda: 0.1
2025-01-15 21:03:20,546 [trainer.py] => kl_weight: 0.001
2025-01-15 21:03:20,546 [trainer.py] => TIP_init: zero
2025-01-15 21:03:20,546 [trainer.py] => tuned_epoch: 10
2025-01-15 21:03:20,546 [trainer.py] => fs_epoch: 0
2025-01-15 21:03:20,546 [trainer.py] => init_lr: 0.01
2025-01-15 21:03:20,546 [trainer.py] => fs_lr: 0.001
2025-01-15 21:03:20,546 [trainer.py] => batch_size: 48
2025-01-15 21:03:20,546 [trainer.py] => fs_batch_size: 16
2025-01-15 21:03:20,546 [trainer.py] => weight_decay: 0.0005
2025-01-15 21:03:20,546 [trainer.py] => min_lr: 0
2025-01-15 21:03:20,546 [trainer.py] => optimizer: sgd
2025-01-15 21:03:20,546 [trainer.py] => memory_size: 0
2025-01-15 21:03:20,546 [trainer.py] => memory_per_class: 0
2025-01-15 21:03:20,547 [trainer.py] => fixed_memory: False
2025-01-15 21:03:20,547 [trainer.py] => shuffle: False
2025-01-15 21:03:20,547 [trainer.py] => top_k: 5
2025-01-15 21:03:20,547 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-15 21:03:20,547 [trainer.py] => prefix: asp
2025-01-15 21:03:20,547 [trainer.py] => model_prefix: asp
2025-01-15 21:03:22,120 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-15 21:03:28,526 [asp.py] => Learning on 0-5
2025-01-15 21:03:28,533 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-15 21:03:31,661 [trainer.py] => All params: 173596160
2025-01-15 21:03:31,662 [trainer.py] => Trainable params: 1998848
2025-01-15 21:03:59,166 [asp.py] => Learning on 0-5
2025-01-15 21:03:59,224 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-15 21:20:01,146 [asp.py] => total parameters: 173600001
2025-01-15 21:20:01,148 [asp.py] => trainable parameters: 2002689
2025-01-15 21:20:14,911 [asp.py] => total parameters: 173600001
2025-01-15 21:20:14,918 [asp.py] => trainable parameters: 2002689
2025-01-15 21:21:35,029 [asp.py] => Task 0, Epoch 1 => Loss 1.722, Train_accy 69.98, Test_curr_accy 88.80, Test_accy 88.80
2025-01-15 21:21:54,339 [asp.py] => Task 0, Epoch 1 => Loss 1.238, Train_accy 81.78, Test_curr_accy 99.00, Test_accy 99.00
2025-01-15 21:23:10,336 [asp.py] => Task 0, Epoch 2 => Loss 0.986, Train_accy 85.31, Test_curr_accy 92.80, Test_accy 92.80
2025-01-15 21:23:31,170 [asp.py] => Task 0, Epoch 2 => Loss 0.474, Train_accy 92.08, Test_curr_accy 98.80, Test_accy 98.80
2025-01-15 21:24:40,659 [asp.py] => Task 0, Epoch 3 => Loss 1.138, Train_accy 84.95, Test_curr_accy 89.80, Test_accy 89.80
2025-01-15 21:25:03,801 [asp.py] => Task 0, Epoch 3 => Loss 0.422, Train_accy 91.80, Test_curr_accy 98.60, Test_accy 98.60
2025-01-15 21:26:08,664 [asp.py] => Task 0, Epoch 4 => Loss 0.879, Train_accy 86.61, Test_curr_accy 95.20, Test_accy 95.20
2025-01-15 21:26:36,451 [asp.py] => Task 0, Epoch 4 => Loss 0.429, Train_accy 92.40, Test_curr_accy 99.40, Test_accy 99.40
2025-01-15 21:27:37,712 [asp.py] => Task 0, Epoch 5 => Loss 0.815, Train_accy 87.72, Test_curr_accy 96.40, Test_accy 96.40
2025-01-15 21:28:09,181 [asp.py] => Task 0, Epoch 5 => Loss 0.392, Train_accy 92.91, Test_curr_accy 99.20, Test_accy 99.20
2025-01-15 21:29:06,992 [asp.py] => Task 0, Epoch 6 => Loss 0.725, Train_accy 88.36, Test_curr_accy 96.40, Test_accy 96.40
2025-01-15 21:29:42,520 [asp.py] => Task 0, Epoch 6 => Loss 0.303, Train_accy 93.86, Test_curr_accy 99.80, Test_accy 99.80
2025-01-15 21:30:36,784 [asp.py] => Task 0, Epoch 7 => Loss 0.621, Train_accy 89.74, Test_curr_accy 94.60, Test_accy 94.60
2025-01-15 21:31:14,815 [asp.py] => Task 0, Epoch 7 => Loss 0.303, Train_accy 93.86, Test_curr_accy 99.40, Test_accy 99.40
2025-01-15 21:32:06,648 [asp.py] => Task 0, Epoch 8 => Loss 0.529, Train_accy 90.42, Test_curr_accy 94.00, Test_accy 94.00
2025-01-15 21:32:47,184 [asp.py] => Task 0, Epoch 8 => Loss 0.259, Train_accy 93.94, Test_curr_accy 99.60, Test_accy 99.60
2025-01-15 21:33:38,484 [asp.py] => Task 0, Epoch 9 => Loss 0.450, Train_accy 91.33, Test_curr_accy 95.40, Test_accy 95.40
2025-01-15 21:34:21,279 [asp.py] => Task 0, Epoch 9 => Loss 0.238, Train_accy 94.42, Test_curr_accy 99.20, Test_accy 99.20
2025-01-15 21:35:06,914 [asp.py] => Task 0, Epoch 10 => Loss 0.424, Train_accy 91.68, Test_curr_accy 92.20, Test_accy 92.20
2025-01-15 21:35:52,508 [trainer.py] => Top1 curve: [82.8]
2025-01-15 21:35:52,509 [trainer.py] => Average Accuracy (Top1): 82.8   (Harmonic Accuracy): None (Old Acc): 82.8 (New Acc): [] 

2025-01-15 21:35:52,511 [trainer.py] => All params: 173600001
2025-01-15 21:35:52,512 [trainer.py] => Trainable params: 2002689
2025-01-15 21:35:57,992 [asp.py] => Task 0, Epoch 10 => Loss 0.224, Train_accy 94.73, Test_curr_accy 99.80, Test_accy 99.80
2025-01-15 21:36:45,284 [trainer.py] => Top1 curve: [99.6]
2025-01-15 21:36:45,324 [trainer.py] => Average Accuracy (Top1): 99.6   (Harmonic Accuracy): None (Old Acc): 99.6 (New Acc): [] 

2025-01-15 21:36:45,325 [trainer.py] => All params: 173600001
2025-01-15 21:36:45,325 [trainer.py] => Trainable params: 2002689
2025-01-15 21:37:43,952 [asp.py] => Learning on 5-10
2025-01-15 21:37:43,991 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-15 21:38:29,054 [asp.py] => Learning on 5-10
2025-01-15 21:38:29,063 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-15 21:54:06,678 [asp.py] => total parameters: 173603841
2025-01-15 21:54:06,679 [asp.py] => trainable parameters: 2006529
2025-01-15 21:54:21,191 [trainer.py] => Top1 curve: [82.8, 56.1]
2025-01-15 21:54:21,192 [trainer.py] => Average Accuracy (Top1): 69.45   (Harmonic Accuracy): 49.04099821746881 (Old Acc): 76.0 (New Acc): 36.2 

2025-01-15 21:54:21,193 [trainer.py] => All params: 173603841
2025-01-15 21:54:21,194 [trainer.py] => Trainable params: 2006529
2025-01-15 21:55:17,228 [asp.py] => total parameters: 173603841
2025-01-15 21:55:17,235 [asp.py] => trainable parameters: 2006529
2025-01-15 21:55:21,190 [asp.py] => Learning on 10-15
2025-01-15 21:55:21,221 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-15 21:55:32,039 [trainer.py] => Top1 curve: [99.6, 97.9]
2025-01-15 21:55:32,041 [trainer.py] => Average Accuracy (Top1): 98.75   (Harmonic Accuracy): 97.87701736465783 (Old Acc): 99.4 (New Acc): 96.4 

2025-01-15 21:55:32,043 [trainer.py] => All params: 173603841
2025-01-15 21:55:32,044 [trainer.py] => Trainable params: 2006529
2025-01-15 21:56:31,965 [asp.py] => Learning on 10-15
2025-01-15 21:56:31,977 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-15 22:11:38,796 [asp.py] => total parameters: 173607681
2025-01-15 22:11:38,797 [asp.py] => trainable parameters: 2010369
2025-01-15 22:11:50,178 [trainer.py] => Top1 curve: [82.8, 56.1, 43.53]
2025-01-15 22:11:50,179 [trainer.py] => Average Accuracy (Top1): 60.81   (Harmonic Accuracy): 41.514088669950745 (Old Acc): 72.4 (New Acc): 29.1 

2025-01-15 22:11:50,180 [trainer.py] => All params: 173607681
2025-01-15 22:11:50,181 [trainer.py] => Trainable params: 2010369
2025-01-15 22:12:33,509 [asp.py] => Learning on 15-20
2025-01-15 22:12:33,529 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-15 22:13:20,123 [asp.py] => total parameters: 173607681
2025-01-15 22:13:20,125 [asp.py] => trainable parameters: 2010369
2025-01-15 22:13:32,951 [trainer.py] => Top1 curve: [99.6, 97.9, 92.73]
2025-01-15 22:13:32,951 [trainer.py] => Average Accuracy (Top1): 96.74333333333334   (Harmonic Accuracy): 93.65077333333332 (Old Acc): 96.8 (New Acc): 90.69999999999999 

2025-01-15 22:13:32,953 [trainer.py] => All params: 173607681
2025-01-15 22:13:32,954 [trainer.py] => Trainable params: 2010369
2025-01-15 22:13:57,330 [asp.py] => Learning on 15-20
2025-01-15 22:13:57,346 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 00:09:12,945 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-16 00:09:12,946 [trainer.py] => model_name: asp
2025-01-16 00:09:12,946 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-16 00:09:12,946 [trainer.py] => device: ['cuda']
2025-01-16 00:09:12,946 [trainer.py] => seed: 2024
2025-01-16 00:09:12,946 [trainer.py] => dataset: cifar224
2025-01-16 00:09:12,946 [trainer.py] => init_cls: 5
2025-01-16 00:09:12,946 [trainer.py] => increment: 5
2025-01-16 00:09:12,946 [trainer.py] => kshot: 5
2025-01-16 00:09:12,946 [trainer.py] => generator_model: CIFAR_GEN
2025-01-16 00:09:12,946 [trainer.py] => z_dim: 1000
2025-01-16 00:09:12,946 [trainer.py] => conv_dim: 64
2025-01-16 00:09:12,946 [trainer.py] => img_size: 224
2025-01-16 00:09:12,946 [trainer.py] => generator_lr: 0.005
2025-01-16 00:09:12,946 [trainer.py] => pi: 100
2025-01-16 00:09:12,946 [trainer.py] => w_bn: 50.0
2025-01-16 00:09:12,946 [trainer.py] => w_noise: 0.001
2025-01-16 00:09:12,946 [trainer.py] => server_ss: 32
2025-01-16 00:09:12,946 [trainer.py] => bn_loss: 1
2025-01-16 00:09:12,946 [trainer.py] => noise: 1
2025-01-16 00:09:12,946 [trainer.py] => ie_loss: 1
2025-01-16 00:09:12,946 [trainer.py] => act_loss: 0
2025-01-16 00:09:12,946 [trainer.py] => w_ie: 1.0
2025-01-16 00:09:12,946 [trainer.py] => w_act: 0.1
2025-01-16 00:09:12,946 [trainer.py] => syn_size: 32
2025-01-16 00:09:12,946 [trainer.py] => need_syn_imgs: True
2025-01-16 00:09:12,946 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-16 00:09:12,946 [trainer.py] => g_local_train_steps: 5
2025-01-16 00:09:12,946 [trainer.py] => dataset_syn: cifar100
2025-01-16 00:09:12,946 [trainer.py] => com_round_gen: 20
2025-01-16 00:09:12,946 [trainer.py] => g_sigma: 0
2025-01-16 00:09:12,947 [trainer.py] => save_cls_embeds: False
2025-01-16 00:09:12,947 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_b5_2_continualgene0
2025-01-16 00:09:12,947 [trainer.py] => save_dir: outputs
2025-01-16 00:09:12,947 [trainer.py] => n_iter: 5
2025-01-16 00:09:12,947 [trainer.py] => num_users: 1
2025-01-16 00:09:12,947 [trainer.py] => cur_size: 5
2025-01-16 00:09:12,947 [trainer.py] => g_local_bs: 5
2025-01-16 00:09:12,947 [trainer.py] => local_bs0: 5
2025-01-16 00:09:12,947 [trainer.py] => local_bs1: 5
2025-01-16 00:09:12,947 [trainer.py] => pre_size: 48
2025-01-16 00:09:12,947 [trainer.py] => w_ce_pre: 0.5
2025-01-16 00:09:12,947 [trainer.py] => vpt_type: Deep
2025-01-16 00:09:12,947 [trainer.py] => prompt_token_num: 6
2025-01-16 00:09:12,947 [trainer.py] => avg_alpha: 0.8
2025-01-16 00:09:12,947 [trainer.py] => perturb_var: 1
2025-01-16 00:09:12,947 [trainer.py] => EMA_beta: 0.99
2025-01-16 00:09:12,947 [trainer.py] => anchor_lambda: 0.1
2025-01-16 00:09:12,947 [trainer.py] => kl_weight: 0.001
2025-01-16 00:09:12,947 [trainer.py] => TIP_init: zero
2025-01-16 00:09:12,947 [trainer.py] => tuned_epoch: 10
2025-01-16 00:09:12,947 [trainer.py] => fs_epoch: 0
2025-01-16 00:09:12,947 [trainer.py] => init_lr: 0.01
2025-01-16 00:09:12,947 [trainer.py] => fs_lr: 0.001
2025-01-16 00:09:12,947 [trainer.py] => batch_size: 48
2025-01-16 00:09:12,947 [trainer.py] => fs_batch_size: 16
2025-01-16 00:09:12,947 [trainer.py] => weight_decay: 0.0005
2025-01-16 00:09:12,947 [trainer.py] => min_lr: 0
2025-01-16 00:09:12,947 [trainer.py] => optimizer: sgd
2025-01-16 00:09:12,947 [trainer.py] => memory_size: 0
2025-01-16 00:09:12,947 [trainer.py] => memory_per_class: 0
2025-01-16 00:09:12,947 [trainer.py] => fixed_memory: False
2025-01-16 00:09:12,947 [trainer.py] => shuffle: False
2025-01-16 00:09:12,948 [trainer.py] => top_k: 5
2025-01-16 00:09:12,948 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-16 00:09:12,948 [trainer.py] => prefix: asp
2025-01-16 00:09:12,948 [trainer.py] => model_prefix: asp
2025-01-16 00:09:14,634 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-16 00:09:27,776 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-16 00:09:27,776 [trainer.py] => model_name: asp
2025-01-16 00:09:27,776 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-16 00:09:27,776 [trainer.py] => device: ['cuda']
2025-01-16 00:09:27,776 [trainer.py] => seed: 2024
2025-01-16 00:09:27,776 [trainer.py] => dataset: cifar224
2025-01-16 00:09:27,776 [trainer.py] => init_cls: 5
2025-01-16 00:09:27,776 [trainer.py] => increment: 5
2025-01-16 00:09:27,776 [trainer.py] => kshot: 5
2025-01-16 00:09:27,776 [trainer.py] => generator_model: CIFAR_GEN
2025-01-16 00:09:27,776 [trainer.py] => z_dim: 1000
2025-01-16 00:09:27,776 [trainer.py] => conv_dim: 64
2025-01-16 00:09:27,776 [trainer.py] => img_size: 224
2025-01-16 00:09:27,776 [trainer.py] => generator_lr: 0.005
2025-01-16 00:09:27,776 [trainer.py] => pi: 100
2025-01-16 00:09:27,776 [trainer.py] => w_bn: 50.0
2025-01-16 00:09:27,777 [trainer.py] => w_noise: 0.001
2025-01-16 00:09:27,777 [trainer.py] => server_ss: 32
2025-01-16 00:09:27,777 [trainer.py] => bn_loss: 1
2025-01-16 00:09:27,777 [trainer.py] => noise: 1
2025-01-16 00:09:27,777 [trainer.py] => ie_loss: 1
2025-01-16 00:09:27,777 [trainer.py] => act_loss: 0
2025-01-16 00:09:27,777 [trainer.py] => w_ie: 1.0
2025-01-16 00:09:27,777 [trainer.py] => w_act: 0.1
2025-01-16 00:09:27,777 [trainer.py] => syn_size: 32
2025-01-16 00:09:27,777 [trainer.py] => need_syn_imgs: True
2025-01-16 00:09:27,777 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-16 00:09:27,777 [trainer.py] => g_local_train_steps: 5
2025-01-16 00:09:27,777 [trainer.py] => dataset_syn: cifar100
2025-01-16 00:09:27,777 [trainer.py] => com_round_gen: 20
2025-01-16 00:09:27,777 [trainer.py] => g_sigma: 0
2025-01-16 00:09:27,777 [trainer.py] => save_cls_embeds: False
2025-01-16 00:09:27,777 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_b5_2_continualgen1
2025-01-16 00:09:27,777 [trainer.py] => save_dir: outputs
2025-01-16 00:09:27,777 [trainer.py] => n_iter: 5
2025-01-16 00:09:27,777 [trainer.py] => num_users: 1
2025-01-16 00:09:27,777 [trainer.py] => cur_size: 5
2025-01-16 00:09:27,777 [trainer.py] => g_local_bs: 5
2025-01-16 00:09:27,777 [trainer.py] => local_bs0: 5
2025-01-16 00:09:27,777 [trainer.py] => local_bs1: 5
2025-01-16 00:09:27,777 [trainer.py] => pre_size: 48
2025-01-16 00:09:27,777 [trainer.py] => w_ce_pre: 0.5
2025-01-16 00:09:27,777 [trainer.py] => vpt_type: Deep
2025-01-16 00:09:27,777 [trainer.py] => prompt_token_num: 6
2025-01-16 00:09:27,777 [trainer.py] => avg_alpha: 0.8
2025-01-16 00:09:27,777 [trainer.py] => perturb_var: 1
2025-01-16 00:09:27,778 [trainer.py] => EMA_beta: 0.99
2025-01-16 00:09:27,778 [trainer.py] => anchor_lambda: 0.1
2025-01-16 00:09:27,778 [trainer.py] => kl_weight: 0.001
2025-01-16 00:09:27,778 [trainer.py] => TIP_init: zero
2025-01-16 00:09:27,778 [trainer.py] => tuned_epoch: 10
2025-01-16 00:09:27,778 [trainer.py] => fs_epoch: 0
2025-01-16 00:09:27,778 [trainer.py] => init_lr: 0.01
2025-01-16 00:09:27,778 [trainer.py] => fs_lr: 0.001
2025-01-16 00:09:27,778 [trainer.py] => batch_size: 48
2025-01-16 00:09:27,778 [trainer.py] => fs_batch_size: 16
2025-01-16 00:09:27,778 [trainer.py] => weight_decay: 0.0005
2025-01-16 00:09:27,778 [trainer.py] => min_lr: 0
2025-01-16 00:09:27,778 [trainer.py] => optimizer: sgd
2025-01-16 00:09:27,778 [trainer.py] => memory_size: 0
2025-01-16 00:09:27,778 [trainer.py] => memory_per_class: 0
2025-01-16 00:09:27,778 [trainer.py] => fixed_memory: False
2025-01-16 00:09:27,778 [trainer.py] => shuffle: False
2025-01-16 00:09:27,778 [trainer.py] => top_k: 5
2025-01-16 00:09:27,778 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-16 00:09:27,778 [trainer.py] => prefix: asp
2025-01-16 00:09:27,778 [trainer.py] => model_prefix: asp
2025-01-16 00:09:28,382 [trainer.py] => All params: 173596160
2025-01-16 00:09:28,382 [trainer.py] => Trainable params: 1998848
2025-01-16 00:09:29,358 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-16 00:09:38,497 [trainer.py] => All params: 173596160
2025-01-16 00:09:38,498 [trainer.py] => Trainable params: 1998848
2025-01-16 00:09:46,914 [asp.py] => Learning on 0-5
2025-01-16 00:09:46,922 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-16 00:10:06,283 [asp.py] => Learning on 0-5
2025-01-16 00:10:06,292 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-16 00:25:40,135 [asp.py] => total parameters: 173600001
2025-01-16 00:25:40,136 [asp.py] => trainable parameters: 2002689
2025-01-16 00:26:42,293 [asp.py] => total parameters: 173600001
2025-01-16 00:26:42,294 [asp.py] => trainable parameters: 2002689
2025-01-16 00:26:43,517 [asp.py] => Task 0, Epoch 1 => Loss 1.232, Train_accy 83.01, Test_curr_accy 98.40, Test_accy 98.40
2025-01-16 00:27:47,307 [asp.py] => Task 0, Epoch 2 => Loss 0.485, Train_accy 90.89, Test_curr_accy 99.20, Test_accy 99.20
2025-01-16 00:27:49,062 [asp.py] => Task 0, Epoch 1 => Loss 1.238, Train_accy 82.73, Test_curr_accy 98.60, Test_accy 98.60
2025-01-16 00:28:50,421 [asp.py] => Task 0, Epoch 3 => Loss 0.437, Train_accy 91.96, Test_curr_accy 99.00, Test_accy 99.00
2025-01-16 00:28:54,962 [asp.py] => Task 0, Epoch 2 => Loss 0.525, Train_accy 90.85, Test_curr_accy 99.00, Test_accy 99.00
2025-01-16 00:29:53,602 [asp.py] => Task 0, Epoch 4 => Loss 0.412, Train_accy 92.28, Test_curr_accy 97.60, Test_accy 97.60
2025-01-16 00:30:00,800 [asp.py] => Task 0, Epoch 3 => Loss 0.395, Train_accy 92.40, Test_curr_accy 99.20, Test_accy 99.20
2025-01-16 00:30:56,987 [asp.py] => Task 0, Epoch 5 => Loss 0.385, Train_accy 93.15, Test_curr_accy 99.00, Test_accy 99.00
2025-01-16 00:31:06,957 [asp.py] => Task 0, Epoch 4 => Loss 0.399, Train_accy 92.75, Test_curr_accy 97.20, Test_accy 97.20
2025-01-16 00:32:01,320 [asp.py] => Task 0, Epoch 6 => Loss 0.312, Train_accy 93.50, Test_curr_accy 99.20, Test_accy 99.20
2025-01-16 00:32:12,869 [asp.py] => Task 0, Epoch 5 => Loss 0.365, Train_accy 93.19, Test_curr_accy 98.60, Test_accy 98.60
2025-01-16 00:33:05,378 [asp.py] => Task 0, Epoch 7 => Loss 0.291, Train_accy 93.66, Test_curr_accy 98.00, Test_accy 98.00
2025-01-16 00:33:19,143 [asp.py] => Task 0, Epoch 6 => Loss 0.299, Train_accy 93.54, Test_curr_accy 99.60, Test_accy 99.60
2025-01-16 00:34:09,491 [asp.py] => Task 0, Epoch 8 => Loss 0.253, Train_accy 94.06, Test_curr_accy 98.20, Test_accy 98.20
2025-01-16 00:34:24,932 [asp.py] => Task 0, Epoch 7 => Loss 0.288, Train_accy 94.02, Test_curr_accy 98.20, Test_accy 98.20
2025-01-16 00:35:14,249 [asp.py] => Task 0, Epoch 9 => Loss 0.237, Train_accy 94.30, Test_curr_accy 98.40, Test_accy 98.40
2025-01-16 00:35:30,536 [asp.py] => Task 0, Epoch 8 => Loss 0.254, Train_accy 94.30, Test_curr_accy 97.60, Test_accy 97.60
2025-01-16 00:36:18,030 [asp.py] => Task 0, Epoch 10 => Loss 0.222, Train_accy 95.41, Test_curr_accy 98.60, Test_accy 98.60
2025-01-16 00:36:38,965 [asp.py] => Task 0, Epoch 9 => Loss 0.233, Train_accy 94.46, Test_curr_accy 99.80, Test_accy 99.80
2025-01-16 00:36:45,184 [trainer.py] => Top1 curve: [98.6]
2025-01-16 00:36:45,184 [trainer.py] => Average Accuracy (Top1): 98.6   (Harmonic Accuracy): None (Old Acc): 98.6 (New Acc): [] 

2025-01-16 00:36:45,185 [trainer.py] => All params: 173600001
2025-01-16 00:36:45,186 [trainer.py] => Trainable params: 2002689
2025-01-16 00:37:11,807 [asp.py] => Learning on 5-10
2025-01-16 00:37:11,821 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 00:37:44,973 [asp.py] => Task 0, Epoch 10 => Loss 0.213, Train_accy 95.17, Test_curr_accy 99.60, Test_accy 99.60
2025-01-16 00:38:11,461 [trainer.py] => Top1 curve: [99.4]
2025-01-16 00:38:11,462 [trainer.py] => Average Accuracy (Top1): 99.4   (Harmonic Accuracy): None (Old Acc): 99.4 (New Acc): [] 

2025-01-16 00:38:11,462 [trainer.py] => All params: 173600001
2025-01-16 00:38:11,463 [trainer.py] => Trainable params: 2002689
2025-01-16 00:38:37,775 [asp.py] => Learning on 5-10
2025-01-16 00:38:37,793 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 00:53:11,501 [asp.py] => total parameters: 173603841
2025-01-16 00:53:11,502 [asp.py] => trainable parameters: 2006529
2025-01-16 00:53:19,052 [trainer.py] => Top1 curve: [98.6, 96.8]
2025-01-16 00:53:19,052 [trainer.py] => Average Accuracy (Top1): 97.69999999999999   (Harmonic Accuracy): 96.79338842975206 (Old Acc): 97.6 (New Acc): 96.0 

2025-01-16 00:53:19,053 [trainer.py] => All params: 173603841
2025-01-16 00:53:19,054 [trainer.py] => Trainable params: 2006529
2025-01-16 00:53:38,066 [asp.py] => Learning on 10-15
2025-01-16 00:53:38,076 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 00:55:19,018 [asp.py] => total parameters: 173603841
2025-01-16 00:55:19,019 [asp.py] => trainable parameters: 2006529
2025-01-16 00:55:26,538 [trainer.py] => Top1 curve: [99.4, 96.9]
2025-01-16 00:55:26,538 [trainer.py] => Average Accuracy (Top1): 98.15   (Harmonic Accuracy): 96.88255933952527 (Old Acc): 98.2 (New Acc): 95.6 

2025-01-16 00:55:26,539 [trainer.py] => All params: 173603841
2025-01-16 00:55:26,539 [trainer.py] => Trainable params: 2006529
2025-01-16 00:56:02,375 [asp.py] => Learning on 10-15
2025-01-16 00:56:02,384 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 01:09:38,772 [asp.py] => total parameters: 173607681
2025-01-16 01:09:38,774 [asp.py] => trainable parameters: 2010369
2025-01-16 01:09:48,239 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8]
2025-01-16 01:09:48,240 [trainer.py] => Average Accuracy (Top1): 95.06666666666666   (Harmonic Accuracy): 91.04263013698629 (Old Acc): 95.6 (New Acc): 86.9 

2025-01-16 01:09:48,240 [trainer.py] => All params: 173607681
2025-01-16 01:09:48,241 [trainer.py] => Trainable params: 2010369
2025-01-16 01:10:11,530 [asp.py] => Learning on 15-20
2025-01-16 01:10:11,543 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 01:12:53,110 [asp.py] => total parameters: 173607681
2025-01-16 01:12:53,111 [asp.py] => trainable parameters: 2010369
2025-01-16 01:13:02,733 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13]
2025-01-16 01:13:02,734 [trainer.py] => Average Accuracy (Top1): 95.47666666666667   (Harmonic Accuracy): 91.56124115405552 (Old Acc): 97.0 (New Acc): 86.69999999999999 

2025-01-16 01:13:02,735 [trainer.py] => All params: 173607681
2025-01-16 01:13:02,735 [trainer.py] => Trainable params: 2010369
2025-01-16 01:13:25,188 [asp.py] => Learning on 15-20
2025-01-16 01:13:25,199 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 01:26:11,073 [asp.py] => total parameters: 173611521
2025-01-16 01:26:11,073 [asp.py] => trainable parameters: 2014209
2025-01-16 01:26:22,775 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45]
2025-01-16 01:26:22,776 [trainer.py] => Average Accuracy (Top1): 93.1625   (Harmonic Accuracy): 89.73683820807109 (Old Acc): 95.2 (New Acc): 84.86666666666667 

2025-01-16 01:26:22,777 [trainer.py] => All params: 173611521
2025-01-16 01:26:22,777 [trainer.py] => Trainable params: 2014209
2025-01-16 01:26:42,453 [asp.py] => Learning on 20-25
2025-01-16 01:26:42,466 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 01:30:12,444 [asp.py] => total parameters: 173611521
2025-01-16 01:30:12,445 [asp.py] => trainable parameters: 2014209
2025-01-16 01:30:24,324 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4]
2025-01-16 01:30:24,324 [trainer.py] => Average Accuracy (Top1): 93.70750000000001   (Harmonic Accuracy): 90.75431918008786 (Old Acc): 96.4 (New Acc): 85.73333333333333 

2025-01-16 01:30:24,325 [trainer.py] => All params: 173611521
2025-01-16 01:30:24,326 [trainer.py] => Trainable params: 2014209
2025-01-16 01:30:43,543 [asp.py] => Learning on 20-25
2025-01-16 01:30:43,557 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 01:42:40,542 [asp.py] => total parameters: 173615361
2025-01-16 01:42:40,544 [asp.py] => trainable parameters: 2018049
2025-01-16 01:42:54,568 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08]
2025-01-16 01:42:54,568 [trainer.py] => Average Accuracy (Top1): 91.946   (Harmonic Accuracy): 89.52935933147633 (Old Acc): 94.2 (New Acc): 85.3 

2025-01-16 01:42:54,569 [trainer.py] => All params: 173615361
2025-01-16 01:42:54,569 [trainer.py] => Trainable params: 2018049
2025-01-16 01:43:13,136 [asp.py] => Learning on 25-30
2025-01-16 01:43:13,153 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 01:47:25,348 [asp.py] => total parameters: 173615361
2025-01-16 01:47:25,349 [asp.py] => trainable parameters: 2018049
2025-01-16 01:47:39,646 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8]
2025-01-16 01:47:39,646 [trainer.py] => Average Accuracy (Top1): 92.52600000000001   (Harmonic Accuracy): 90.52466960352423 (Old Acc): 95.8 (New Acc): 85.8 

2025-01-16 01:47:39,647 [trainer.py] => All params: 173615361
2025-01-16 01:47:39,648 [trainer.py] => Trainable params: 2018049
2025-01-16 01:47:59,358 [asp.py] => Learning on 25-30
2025-01-16 01:47:59,371 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 01:59:12,475 [asp.py] => total parameters: 173619201
2025-01-16 01:59:12,476 [asp.py] => trainable parameters: 2021889
2025-01-16 01:59:28,802 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97]
2025-01-16 01:59:28,802 [trainer.py] => Average Accuracy (Top1): 90.61666666666666   (Harmonic Accuracy): 87.43958096105669 (Old Acc): 93.6 (New Acc): 82.03999999999999 

2025-01-16 01:59:28,803 [trainer.py] => All params: 173619201
2025-01-16 01:59:28,804 [trainer.py] => Trainable params: 2021889
2025-01-16 01:59:47,220 [asp.py] => Learning on 30-35
2025-01-16 01:59:47,237 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 02:04:42,661 [asp.py] => total parameters: 173619201
2025-01-16 02:04:42,662 [asp.py] => trainable parameters: 2021889
2025-01-16 02:04:59,420 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3]
2025-01-16 02:04:59,421 [trainer.py] => Average Accuracy (Top1): 91.15500000000002   (Harmonic Accuracy): 88.36445444319459 (Old Acc): 95.8 (New Acc): 82.0 

2025-01-16 02:04:59,422 [trainer.py] => All params: 173619201
2025-01-16 02:04:59,422 [trainer.py] => Trainable params: 2021889
2025-01-16 02:05:22,816 [asp.py] => Learning on 30-35
2025-01-16 02:05:22,830 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 02:15:50,256 [asp.py] => total parameters: 173623041
2025-01-16 02:15:50,257 [asp.py] => trainable parameters: 2025729
2025-01-16 02:16:08,710 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0]
2025-01-16 02:16:08,710 [trainer.py] => Average Accuracy (Top1): 89.52857142857142   (Harmonic Accuracy): 86.97929456625359 (Old Acc): 93.6 (New Acc): 81.23333333333333 

2025-01-16 02:16:08,712 [trainer.py] => All params: 173623041
2025-01-16 02:16:08,712 [trainer.py] => Trainable params: 2025729
2025-01-16 02:16:27,865 [asp.py] => Learning on 35-40
2025-01-16 02:16:27,884 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 02:22:15,546 [asp.py] => total parameters: 173623041
2025-01-16 02:22:15,547 [asp.py] => trainable parameters: 2025729
2025-01-16 02:22:35,457 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89]
2025-01-16 02:22:35,458 [trainer.py] => Average Accuracy (Top1): 89.97428571428573   (Harmonic Accuracy): 87.49511918274689 (Old Acc): 95.4 (New Acc): 80.8 

2025-01-16 02:22:35,459 [trainer.py] => All params: 173623041
2025-01-16 02:22:35,459 [trainer.py] => Trainable params: 2025729
2025-01-16 02:22:54,720 [asp.py] => Learning on 35-40
2025-01-16 02:22:54,745 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 02:32:29,136 [asp.py] => total parameters: 173626881
2025-01-16 02:32:29,137 [asp.py] => trainable parameters: 2029569
2025-01-16 02:32:50,119 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78]
2025-01-16 02:32:50,119 [trainer.py] => Average Accuracy (Top1): 88.55999999999999   (Harmonic Accuracy): 85.61913939192557 (Old Acc): 91.6 (New Acc): 80.37142857142858 

2025-01-16 02:32:50,120 [trainer.py] => All params: 173626881
2025-01-16 02:32:50,121 [trainer.py] => Trainable params: 2029569
2025-01-16 02:33:09,509 [asp.py] => Learning on 40-45
2025-01-16 02:33:09,530 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 02:39:47,362 [asp.py] => total parameters: 173626881
2025-01-16 02:39:47,364 [asp.py] => trainable parameters: 2029569
2025-01-16 02:40:09,072 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18]
2025-01-16 02:40:09,073 [trainer.py] => Average Accuracy (Top1): 88.875   (Harmonic Accuracy): 86.38346727898967 (Old Acc): 95.0 (New Acc): 79.2 

2025-01-16 02:40:09,074 [trainer.py] => All params: 173626881
2025-01-16 02:40:09,074 [trainer.py] => Trainable params: 2029569
2025-01-16 02:40:27,460 [asp.py] => Learning on 40-45
2025-01-16 02:40:27,478 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 02:49:09,071 [asp.py] => total parameters: 173630721
2025-01-16 02:49:09,072 [asp.py] => trainable parameters: 2033409
2025-01-16 02:49:32,272 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98]
2025-01-16 02:49:32,272 [trainer.py] => Average Accuracy (Top1): 87.71777777777777   (Harmonic Accuracy): 85.28015166982645 (Old Acc): 91.8 (New Acc): 79.625 

2025-01-16 02:49:32,273 [trainer.py] => All params: 173630721
2025-01-16 02:49:32,274 [trainer.py] => Trainable params: 2033409
2025-01-16 02:49:51,564 [asp.py] => Learning on 45-50
2025-01-16 02:49:51,586 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 02:57:21,269 [asp.py] => total parameters: 173630721
2025-01-16 02:57:21,270 [asp.py] => trainable parameters: 2033409
2025-01-16 02:57:45,267 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47]
2025-01-16 02:57:45,267 [trainer.py] => Average Accuracy (Top1): 87.94111111111111   (Harmonic Accuracy): 85.98806744487678 (Old Acc): 94.8 (New Acc): 78.675 

2025-01-16 02:57:45,269 [trainer.py] => All params: 173630721
2025-01-16 02:57:45,270 [trainer.py] => Trainable params: 2033409
2025-01-16 02:58:03,833 [asp.py] => Learning on 45-50
2025-01-16 02:58:03,858 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 03:05:51,425 [asp.py] => total parameters: 173634561
2025-01-16 03:05:51,426 [asp.py] => trainable parameters: 2037249
2025-01-16 03:06:16,737 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98, 79.54]
2025-01-16 03:06:16,737 [trainer.py] => Average Accuracy (Top1): 86.89999999999999   (Harmonic Accuracy): 84.44303830566088 (Old Acc): 91.8 (New Acc): 78.17777777777778 

2025-01-16 03:06:16,738 [trainer.py] => All params: 173634561
2025-01-16 03:06:16,739 [trainer.py] => Trainable params: 2037249
2025-01-16 03:06:35,438 [asp.py] => Learning on 50-55
2025-01-16 03:06:35,463 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 03:14:46,377 [asp.py] => total parameters: 173634561
2025-01-16 03:14:46,378 [asp.py] => trainable parameters: 2037249
2025-01-16 03:15:13,087 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47, 79.12]
2025-01-16 03:15:13,088 [trainer.py] => Average Accuracy (Top1): 87.059   (Harmonic Accuracy): 85.27462609592573 (Old Acc): 95.0 (New Acc): 77.35555555555555 

2025-01-16 03:15:13,089 [trainer.py] => All params: 173634561
2025-01-16 03:15:13,090 [trainer.py] => Trainable params: 2037249
2025-01-16 03:15:32,534 [asp.py] => Learning on 50-55
2025-01-16 03:15:32,558 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 03:22:35,763 [asp.py] => total parameters: 173638401
2025-01-16 03:22:35,765 [asp.py] => trainable parameters: 2041089
2025-01-16 03:23:03,525 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98, 79.54, 79.4]
2025-01-16 03:23:03,525 [trainer.py] => Average Accuracy (Top1): 86.2181818181818   (Harmonic Accuracy): 84.35961832960302 (Old Acc): 91.6 (New Acc): 78.18 

2025-01-16 03:23:03,526 [trainer.py] => All params: 173638401
2025-01-16 03:23:03,526 [trainer.py] => Trainable params: 2041089
2025-01-16 03:23:21,906 [asp.py] => Learning on 55-60
2025-01-16 03:23:21,926 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 03:32:24,312 [asp.py] => total parameters: 173638401
2025-01-16 03:32:24,313 [asp.py] => trainable parameters: 2041089
2025-01-16 03:32:53,126 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47, 79.12, 79.05]
2025-01-16 03:32:53,126 [trainer.py] => Average Accuracy (Top1): 86.33090909090909   (Harmonic Accuracy): 85.20046484601976 (Old Acc): 94.6 (New Acc): 77.5 

2025-01-16 03:32:53,127 [trainer.py] => All params: 173638401
2025-01-16 03:32:53,128 [trainer.py] => Trainable params: 2041089
2025-01-16 03:33:20,733 [asp.py] => Learning on 55-60
2025-01-16 03:33:20,758 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 03:39:23,362 [asp.py] => total parameters: 173642241
2025-01-16 03:39:23,363 [asp.py] => trainable parameters: 2044929
2025-01-16 03:39:53,348 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98, 79.54, 79.4, 78.33]
2025-01-16 03:39:53,349 [trainer.py] => Average Accuracy (Top1): 85.56083333333332   (Harmonic Accuracy): 83.74293103448275 (Old Acc): 91.6 (New Acc): 77.12727272727273 

2025-01-16 03:39:53,350 [trainer.py] => All params: 173642241
2025-01-16 03:39:53,351 [trainer.py] => Trainable params: 2044929
2025-01-16 03:40:11,874 [asp.py] => Learning on 60-65
2025-01-16 03:40:11,894 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 03:50:14,304 [asp.py] => total parameters: 173642241
2025-01-16 03:50:14,306 [asp.py] => trainable parameters: 2044929
2025-01-16 03:50:46,170 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47, 79.12, 79.05, 77.95]
2025-01-16 03:50:46,170 [trainer.py] => Average Accuracy (Top1): 85.6325   (Harmonic Accuracy): 84.415723873442 (Old Acc): 94.2 (New Acc): 76.47272727272728 

2025-01-16 03:50:46,171 [trainer.py] => All params: 173642241
2025-01-16 03:50:46,172 [trainer.py] => Trainable params: 2044929
2025-01-16 03:51:05,415 [asp.py] => Learning on 60-65
2025-01-16 03:51:05,442 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 03:56:13,154 [asp.py] => total parameters: 173646081
2025-01-16 03:56:13,156 [asp.py] => trainable parameters: 2048769
2025-01-16 03:56:45,703 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98, 79.54, 79.4, 78.33, 76.85]
2025-01-16 03:56:45,704 [trainer.py] => Average Accuracy (Top1): 84.89076923076921   (Harmonic Accuracy): 82.84445330409648 (Old Acc): 91.6 (New Acc): 75.61666666666667 

2025-01-16 03:56:45,705 [trainer.py] => All params: 173646081
2025-01-16 03:56:45,706 [trainer.py] => Trainable params: 2048769
2025-01-16 03:57:03,738 [asp.py] => Learning on 65-70
2025-01-16 03:57:03,777 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 04:07:58,413 [asp.py] => total parameters: 173646081
2025-01-16 04:07:58,414 [asp.py] => trainable parameters: 2048769
2025-01-16 04:08:32,484 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47, 79.12, 79.05, 77.95, 75.95]
2025-01-16 04:08:32,484 [trainer.py] => Average Accuracy (Top1): 84.8876923076923   (Harmonic Accuracy): 83.09053131493026 (Old Acc): 94.0 (New Acc): 74.45 

2025-01-16 04:08:32,485 [trainer.py] => All params: 173646081
2025-01-16 04:08:32,486 [trainer.py] => Trainable params: 2048769
2025-01-16 04:08:51,549 [asp.py] => Learning on 65-70
2025-01-16 04:08:51,572 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 04:13:02,389 [asp.py] => total parameters: 173649921
2025-01-16 04:13:02,390 [asp.py] => trainable parameters: 2052609
2025-01-16 04:13:37,350 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98, 79.54, 79.4, 78.33, 76.85, 76.14]
2025-01-16 04:13:37,351 [trainer.py] => Average Accuracy (Top1): 84.26571428571427   (Harmonic Accuracy): 82.44507666728246 (Old Acc): 91.6 (New Acc): 74.95384615384616 

2025-01-16 04:13:37,352 [trainer.py] => All params: 173649921
2025-01-16 04:13:37,352 [trainer.py] => Trainable params: 2052609
2025-01-16 04:13:57,996 [asp.py] => Learning on 70-75
2025-01-16 04:13:58,025 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 04:25:36,464 [asp.py] => total parameters: 173649921
2025-01-16 04:25:36,465 [asp.py] => trainable parameters: 2052609
2025-01-16 04:26:13,296 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47, 79.12, 79.05, 77.95, 75.95, 75.13]
2025-01-16 04:26:13,298 [trainer.py] => Average Accuracy (Top1): 84.1907142857143   (Harmonic Accuracy): 82.60684466464814 (Old Acc): 94.0 (New Acc): 73.67692307692307 

2025-01-16 04:26:13,299 [trainer.py] => All params: 173649921
2025-01-16 04:26:13,299 [trainer.py] => Trainable params: 2052609
2025-01-16 04:26:32,222 [asp.py] => Learning on 70-75
2025-01-16 04:26:32,245 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 04:29:59,614 [asp.py] => total parameters: 173653761
2025-01-16 04:29:59,616 [asp.py] => trainable parameters: 2056449
2025-01-16 04:30:36,716 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98, 79.54, 79.4, 78.33, 76.85, 76.14, 74.55]
2025-01-16 04:30:36,716 [trainer.py] => Average Accuracy (Top1): 83.61799999999998   (Harmonic Accuracy): 81.45219575573842 (Old Acc): 91.6 (New Acc): 73.32857142857144 

2025-01-16 04:30:36,717 [trainer.py] => All params: 173653761
2025-01-16 04:30:36,718 [trainer.py] => Trainable params: 2056449
2025-01-16 04:30:56,359 [asp.py] => Learning on 75-80
2025-01-16 04:30:56,395 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 04:43:17,065 [asp.py] => total parameters: 173653761
2025-01-16 04:43:17,066 [asp.py] => trainable parameters: 2056449
2025-01-16 04:43:56,343 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47, 79.12, 79.05, 77.95, 75.95, 75.13, 73.56]
2025-01-16 04:43:56,344 [trainer.py] => Average Accuracy (Top1): 83.482   (Harmonic Accuracy): 81.4733902249806 (Old Acc): 93.6 (New Acc): 72.12857142857143 

2025-01-16 04:43:56,345 [trainer.py] => All params: 173653761
2025-01-16 04:43:56,346 [trainer.py] => Trainable params: 2056449
2025-01-16 04:44:15,027 [asp.py] => Learning on 75-80
2025-01-16 04:44:15,054 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 04:46:58,170 [asp.py] => total parameters: 173657601
2025-01-16 04:46:58,171 [asp.py] => trainable parameters: 2060289
2025-01-16 04:47:37,586 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98, 79.54, 79.4, 78.33, 76.85, 76.14, 74.55, 74.79]
2025-01-16 04:47:37,587 [trainer.py] => Average Accuracy (Top1): 83.06624999999998   (Harmonic Accuracy): 81.58895081172766 (Old Acc): 91.4 (New Acc): 73.68 

2025-01-16 04:47:37,588 [trainer.py] => All params: 173657601
2025-01-16 04:47:37,588 [trainer.py] => Trainable params: 2060289
2025-01-16 04:47:55,540 [asp.py] => Learning on 80-85
2025-01-16 04:47:55,570 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 05:01:09,160 [asp.py] => total parameters: 173657601
2025-01-16 05:01:09,161 [asp.py] => trainable parameters: 2060289
2025-01-16 05:01:51,452 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47, 79.12, 79.05, 77.95, 75.95, 75.13, 73.56, 73.8]
2025-01-16 05:01:51,453 [trainer.py] => Average Accuracy (Top1): 82.876875   (Harmonic Accuracy): 81.6971098265896 (Old Acc): 93.6 (New Acc): 72.48 

2025-01-16 05:01:51,454 [trainer.py] => All params: 173657601
2025-01-16 05:01:51,455 [trainer.py] => Trainable params: 2060289
2025-01-16 05:02:11,248 [asp.py] => Learning on 80-85
2025-01-16 05:02:11,278 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 05:03:56,668 [asp.py] => total parameters: 173661441
2025-01-16 05:03:56,669 [asp.py] => trainable parameters: 2064129
2025-01-16 05:04:38,424 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98, 79.54, 79.4, 78.33, 76.85, 76.14, 74.55, 74.79, 74.71]
2025-01-16 05:04:38,425 [trainer.py] => Average Accuracy (Top1): 82.57470588235293   (Harmonic Accuracy): 81.57822037107155 (Old Acc): 91.4 (New Acc): 73.6625 

2025-01-16 05:04:38,426 [trainer.py] => All params: 173661441
2025-01-16 05:04:38,426 [trainer.py] => Trainable params: 2064129
2025-01-16 05:04:57,070 [asp.py] => Learning on 85-90
2025-01-16 05:04:57,107 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 05:19:06,843 [asp.py] => total parameters: 173661441
2025-01-16 05:19:06,844 [asp.py] => trainable parameters: 2064129
2025-01-16 05:19:50,687 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47, 79.12, 79.05, 77.95, 75.95, 75.13, 73.56, 73.8, 73.68]
2025-01-16 05:19:50,687 [trainer.py] => Average Accuracy (Top1): 82.33588235294118   (Harmonic Accuracy): 81.60180886343082 (Old Acc): 93.4 (New Acc): 72.45000000000002 

2025-01-16 05:19:50,688 [trainer.py] => All params: 173661441
2025-01-16 05:19:50,689 [trainer.py] => Trainable params: 2064129
2025-01-16 05:20:10,890 [asp.py] => Learning on 85-90
2025-01-16 05:20:10,926 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 05:20:57,796 [asp.py] => total parameters: 173665281
2025-01-16 05:20:57,797 [asp.py] => trainable parameters: 2067969
2025-01-16 05:21:42,372 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98, 79.54, 79.4, 78.33, 76.85, 76.14, 74.55, 74.79, 74.71, 75.17]
2025-01-16 05:21:42,373 [trainer.py] => Average Accuracy (Top1): 82.16333333333333   (Harmonic Accuracy): 81.9139305249698 (Old Acc): 91.4 (New Acc): 74.21176470588235 

2025-01-16 05:21:42,374 [trainer.py] => All params: 173665281
2025-01-16 05:21:42,374 [trainer.py] => Trainable params: 2067969
2025-01-16 05:22:00,476 [asp.py] => Learning on 90-95
2025-01-16 05:22:00,503 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 05:37:02,291 [asp.py] => total parameters: 173665281
2025-01-16 05:37:02,293 [asp.py] => trainable parameters: 2067969
2025-01-16 05:37:48,954 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47, 79.12, 79.05, 77.95, 75.95, 75.13, 73.56, 73.8, 73.68, 73.88]
2025-01-16 05:37:48,955 [trainer.py] => Average Accuracy (Top1): 81.86611111111112   (Harmonic Accuracy): 81.77874088237377 (Old Acc): 93.4 (New Acc): 72.72941176470587 

2025-01-16 05:37:48,957 [trainer.py] => All params: 173665281
2025-01-16 05:37:48,959 [trainer.py] => Trainable params: 2067969
2025-01-16 05:38:00,420 [asp.py] => total parameters: 173669121
2025-01-16 05:38:00,421 [asp.py] => trainable parameters: 2071809
2025-01-16 05:38:08,614 [asp.py] => Learning on 90-95
2025-01-16 05:38:08,640 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 05:38:47,375 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98, 79.54, 79.4, 78.33, 76.85, 76.14, 74.55, 74.79, 74.71, 75.17, 74.28]
2025-01-16 05:38:47,376 [trainer.py] => Average Accuracy (Top1): 81.74842105263157   (Harmonic Accuracy): 81.30342359376056 (Old Acc): 91.2 (New Acc): 73.34444444444445 

2025-01-16 05:38:47,377 [trainer.py] => All params: 173669121
2025-01-16 05:38:47,377 [trainer.py] => Trainable params: 2071809
2025-01-16 05:39:06,052 [asp.py] => Learning on 95-100
2025-01-16 05:39:06,081 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 05:54:53,847 [asp.py] => total parameters: 173669121
2025-01-16 05:54:53,848 [asp.py] => trainable parameters: 2071809
2025-01-16 05:55:08,026 [asp.py] => total parameters: 173672961
2025-01-16 05:55:08,027 [asp.py] => trainable parameters: 2075649
2025-01-16 05:55:43,228 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47, 79.12, 79.05, 77.95, 75.95, 75.13, 73.56, 73.8, 73.68, 73.88, 72.56]
2025-01-16 05:55:43,228 [trainer.py] => Average Accuracy (Top1): 81.3763157894737   (Harmonic Accuracy): 80.93155339805826 (Old Acc): 93.4 (New Acc): 71.4 

2025-01-16 05:55:43,229 [trainer.py] => All params: 173669121
2025-01-16 05:55:43,230 [trainer.py] => Trainable params: 2071809
2025-01-16 05:55:57,230 [trainer.py] => Top1 curve: [98.6, 96.8, 89.8, 87.45, 87.08, 83.97, 83.0, 81.78, 80.98, 79.54, 79.4, 78.33, 76.85, 76.14, 74.55, 74.79, 74.71, 75.17, 74.28, 72.94]
2025-01-16 05:55:57,230 [trainer.py] => Average Accuracy (Top1): 81.30799999999999   (Harmonic Accuracy): 80.3860759493671 (Old Acc): 91.0 (New Acc): 71.98947368421054 

2025-01-16 05:55:57,230 [trainer.py] => 

2025-01-16 05:56:01,879 [asp.py] => Learning on 95-100
2025-01-16 05:56:01,917 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-16 06:12:50,286 [asp.py] => total parameters: 173672961
2025-01-16 06:12:50,287 [asp.py] => trainable parameters: 2075649
2025-01-16 06:13:42,443 [trainer.py] => Top1 curve: [99.4, 96.9, 90.13, 88.4, 87.8, 84.3, 82.89, 81.18, 80.47, 79.12, 79.05, 77.95, 75.95, 75.13, 73.56, 73.8, 73.68, 73.88, 72.56, 71.18]
2025-01-16 06:13:42,444 [trainer.py] => Average Accuracy (Top1): 80.8665   (Harmonic Accuracy): 79.89785640495867 (Old Acc): 93.0 (New Acc): 70.03157894736842 

2025-01-16 06:13:42,444 [trainer.py] => 

2025-01-20 10:42:35,487 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-20 10:42:35,488 [trainer.py] => model_name: asp
2025-01-20 10:42:35,488 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-20 10:42:35,488 [trainer.py] => device: ['cuda']
2025-01-20 10:42:35,488 [trainer.py] => seed: 2024
2025-01-20 10:42:35,488 [trainer.py] => dataset: cifar224
2025-01-20 10:42:35,488 [trainer.py] => init_cls: 5
2025-01-20 10:42:35,488 [trainer.py] => increment: 5
2025-01-20 10:42:35,488 [trainer.py] => kshot: 5
2025-01-20 10:42:35,488 [trainer.py] => generator_model: CIFAR_GEN
2025-01-20 10:42:35,488 [trainer.py] => z_dim: 1000
2025-01-20 10:42:35,488 [trainer.py] => conv_dim: 64
2025-01-20 10:42:35,488 [trainer.py] => img_size: 224
2025-01-20 10:42:35,488 [trainer.py] => generator_lr: 0.005
2025-01-20 10:42:35,488 [trainer.py] => pi: 100
2025-01-20 10:42:35,488 [trainer.py] => w_bn: 50.0
2025-01-20 10:42:35,488 [trainer.py] => w_noise: 0.001
2025-01-20 10:42:35,488 [trainer.py] => server_ss: 32
2025-01-20 10:42:35,488 [trainer.py] => bn_loss: 1
2025-01-20 10:42:35,488 [trainer.py] => noise: 1
2025-01-20 10:42:35,488 [trainer.py] => ie_loss: 1
2025-01-20 10:42:35,488 [trainer.py] => act_loss: 0
2025-01-20 10:42:35,488 [trainer.py] => w_ie: 1.0
2025-01-20 10:42:35,488 [trainer.py] => w_act: 0.1
2025-01-20 10:42:35,488 [trainer.py] => syn_size: 32
2025-01-20 10:42:35,489 [trainer.py] => need_syn_imgs: True
2025-01-20 10:42:35,489 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-20 10:42:35,489 [trainer.py] => g_local_train_steps: 5
2025-01-20 10:42:35,489 [trainer.py] => dataset_syn: cifar100
2025-01-20 10:42:35,489 [trainer.py] => com_round_gen: 20
2025-01-20 10:42:35,489 [trainer.py] => g_sigma: 0
2025-01-20 10:42:35,489 [trainer.py] => save_cls_embeds: False
2025-01-20 10:42:35,489 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_b5_2_continualgen1
2025-01-20 10:42:35,489 [trainer.py] => save_dir: outputs
2025-01-20 10:42:35,489 [trainer.py] => n_iter: 5
2025-01-20 10:42:35,489 [trainer.py] => num_users: 1
2025-01-20 10:42:35,489 [trainer.py] => cur_size: 5
2025-01-20 10:42:35,489 [trainer.py] => g_local_bs: 5
2025-01-20 10:42:35,489 [trainer.py] => local_bs0: 5
2025-01-20 10:42:35,489 [trainer.py] => local_bs1: 5
2025-01-20 10:42:35,489 [trainer.py] => pre_size: 48
2025-01-20 10:42:35,489 [trainer.py] => w_ce_pre: 0.5
2025-01-20 10:42:35,489 [trainer.py] => vpt_type: Deep
2025-01-20 10:42:35,489 [trainer.py] => prompt_token_num: 6
2025-01-20 10:42:35,489 [trainer.py] => avg_alpha: 0.8
2025-01-20 10:42:35,489 [trainer.py] => perturb_var: 1
2025-01-20 10:42:35,489 [trainer.py] => EMA_beta: 0.99
2025-01-20 10:42:35,489 [trainer.py] => anchor_lambda: 0.1
2025-01-20 10:42:35,489 [trainer.py] => kl_weight: 0.001
2025-01-20 10:42:35,489 [trainer.py] => TIP_init: zero
2025-01-20 10:42:35,489 [trainer.py] => tuned_epoch: 10
2025-01-20 10:42:35,489 [trainer.py] => fs_epoch: 0
2025-01-20 10:42:35,489 [trainer.py] => init_lr: 0.01
2025-01-20 10:42:35,489 [trainer.py] => fs_lr: 0.001
2025-01-20 10:42:35,489 [trainer.py] => batch_size: 48
2025-01-20 10:42:35,489 [trainer.py] => fs_batch_size: 16
2025-01-20 10:42:35,489 [trainer.py] => weight_decay: 0.0005
2025-01-20 10:42:35,489 [trainer.py] => min_lr: 0
2025-01-20 10:42:35,489 [trainer.py] => optimizer: sgd
2025-01-20 10:42:35,489 [trainer.py] => memory_size: 0
2025-01-20 10:42:35,490 [trainer.py] => memory_per_class: 0
2025-01-20 10:42:35,490 [trainer.py] => fixed_memory: False
2025-01-20 10:42:35,490 [trainer.py] => shuffle: False
2025-01-20 10:42:35,490 [trainer.py] => top_k: 5
2025-01-20 10:42:35,490 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-20 10:42:35,490 [trainer.py] => prefix: asp
2025-01-20 10:42:35,490 [trainer.py] => model_prefix: asp
2025-01-20 10:42:37,618 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-20 10:43:24,054 [trainer.py] => All params: 173596160
2025-01-20 10:43:24,055 [trainer.py] => Trainable params: 1998848
2025-01-20 10:44:10,286 [asp.py] => Learning on 0-5
2025-01-20 10:44:10,300 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-20 10:56:29,051 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-20 10:56:29,051 [trainer.py] => model_name: asp
2025-01-20 10:56:29,051 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-20 10:56:29,051 [trainer.py] => device: ['cuda']
2025-01-20 10:56:29,051 [trainer.py] => seed: 2024
2025-01-20 10:56:29,051 [trainer.py] => dataset: cifar224
2025-01-20 10:56:29,051 [trainer.py] => init_cls: 5
2025-01-20 10:56:29,051 [trainer.py] => increment: 5
2025-01-20 10:56:29,051 [trainer.py] => kshot: 5
2025-01-20 10:56:29,051 [trainer.py] => generator_model: CIFAR_GEN
2025-01-20 10:56:29,051 [trainer.py] => z_dim: 1000
2025-01-20 10:56:29,051 [trainer.py] => conv_dim: 64
2025-01-20 10:56:29,051 [trainer.py] => img_size: 224
2025-01-20 10:56:29,051 [trainer.py] => generator_lr: 0.005
2025-01-20 10:56:29,051 [trainer.py] => pi: 100
2025-01-20 10:56:29,051 [trainer.py] => w_bn: 50.0
2025-01-20 10:56:29,051 [trainer.py] => w_noise: 0.001
2025-01-20 10:56:29,051 [trainer.py] => server_ss: 32
2025-01-20 10:56:29,052 [trainer.py] => bn_loss: 1
2025-01-20 10:56:29,052 [trainer.py] => noise: 1
2025-01-20 10:56:29,052 [trainer.py] => ie_loss: 1
2025-01-20 10:56:29,052 [trainer.py] => act_loss: 0
2025-01-20 10:56:29,052 [trainer.py] => w_ie: 1.0
2025-01-20 10:56:29,052 [trainer.py] => w_act: 0.1
2025-01-20 10:56:29,052 [trainer.py] => syn_size: 32
2025-01-20 10:56:29,052 [trainer.py] => need_syn_imgs: false
2025-01-20 10:56:29,052 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-20 10:56:29,052 [trainer.py] => g_local_train_steps: 5
2025-01-20 10:56:29,052 [trainer.py] => dataset_syn: cifar100
2025-01-20 10:56:29,052 [trainer.py] => com_round_gen: 20
2025-01-20 10:56:29,052 [trainer.py] => g_sigma: 0
2025-01-20 10:56:29,052 [trainer.py] => save_cls_embeds: False
2025-01-20 10:56:29,052 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_bs5
2025-01-20 10:56:29,052 [trainer.py] => save_dir: outputs
2025-01-20 10:56:29,052 [trainer.py] => n_iter: 5
2025-01-20 10:56:29,052 [trainer.py] => num_users: 1
2025-01-20 10:56:29,052 [trainer.py] => cur_size: 5
2025-01-20 10:56:29,052 [trainer.py] => g_local_bs: 5
2025-01-20 10:56:29,052 [trainer.py] => local_bs0: 5
2025-01-20 10:56:29,052 [trainer.py] => local_bs1: 5
2025-01-20 10:56:29,052 [trainer.py] => pre_size: 48
2025-01-20 10:56:29,052 [trainer.py] => w_ce_pre: 0.5
2025-01-20 10:56:29,052 [trainer.py] => vpt_type: Deep
2025-01-20 10:56:29,052 [trainer.py] => prompt_token_num: 6
2025-01-20 10:56:29,052 [trainer.py] => avg_alpha: 0.8
2025-01-20 10:56:29,052 [trainer.py] => perturb_var: 1
2025-01-20 10:56:29,052 [trainer.py] => EMA_beta: 0.99
2025-01-20 10:56:29,052 [trainer.py] => anchor_lambda: 0.1
2025-01-20 10:56:29,052 [trainer.py] => kl_weight: 0.001
2025-01-20 10:56:29,052 [trainer.py] => TIP_init: zero
2025-01-20 10:56:29,053 [trainer.py] => tuned_epoch: 10
2025-01-20 10:56:29,053 [trainer.py] => fs_epoch: 0
2025-01-20 10:56:29,053 [trainer.py] => init_lr: 0.01
2025-01-20 10:56:29,053 [trainer.py] => fs_lr: 0.001
2025-01-20 10:56:29,053 [trainer.py] => batch_size: 48
2025-01-20 10:56:29,053 [trainer.py] => fs_batch_size: 16
2025-01-20 10:56:29,053 [trainer.py] => weight_decay: 0.0005
2025-01-20 10:56:29,053 [trainer.py] => min_lr: 0
2025-01-20 10:56:29,053 [trainer.py] => optimizer: sgd
2025-01-20 10:56:29,053 [trainer.py] => memory_size: 0
2025-01-20 10:56:29,053 [trainer.py] => memory_per_class: 0
2025-01-20 10:56:29,053 [trainer.py] => fixed_memory: False
2025-01-20 10:56:29,053 [trainer.py] => shuffle: False
2025-01-20 10:56:29,053 [trainer.py] => top_k: 5
2025-01-20 10:56:29,053 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-20 10:56:29,053 [trainer.py] => prefix: asp
2025-01-20 10:56:29,053 [trainer.py] => model_prefix: asp
2025-01-20 10:56:31,174 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-20 10:56:44,029 [trainer.py] => All params: 173596160
2025-01-20 10:56:44,030 [trainer.py] => Trainable params: 1998848
2025-01-20 10:57:07,204 [asp.py] => Learning on 0-5
2025-01-20 10:57:07,211 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-20 10:57:40,245 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-20 10:57:40,246 [trainer.py] => model_name: asp
2025-01-20 10:57:40,246 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-20 10:57:40,246 [trainer.py] => device: ['cuda']
2025-01-20 10:57:40,246 [trainer.py] => seed: 2024
2025-01-20 10:57:40,246 [trainer.py] => dataset: cifar224
2025-01-20 10:57:40,246 [trainer.py] => init_cls: 5
2025-01-20 10:57:40,246 [trainer.py] => increment: 5
2025-01-20 10:57:40,246 [trainer.py] => kshot: 5
2025-01-20 10:57:40,246 [trainer.py] => generator_model: CIFAR_GEN
2025-01-20 10:57:40,246 [trainer.py] => z_dim: 1000
2025-01-20 10:57:40,246 [trainer.py] => conv_dim: 64
2025-01-20 10:57:40,246 [trainer.py] => img_size: 224
2025-01-20 10:57:40,246 [trainer.py] => generator_lr: 0.005
2025-01-20 10:57:40,246 [trainer.py] => pi: 100
2025-01-20 10:57:40,246 [trainer.py] => w_bn: 50.0
2025-01-20 10:57:40,246 [trainer.py] => w_noise: 0.001
2025-01-20 10:57:40,246 [trainer.py] => server_ss: 32
2025-01-20 10:57:40,246 [trainer.py] => bn_loss: 1
2025-01-20 10:57:40,246 [trainer.py] => noise: 1
2025-01-20 10:57:40,246 [trainer.py] => ie_loss: 1
2025-01-20 10:57:40,246 [trainer.py] => act_loss: 0
2025-01-20 10:57:40,246 [trainer.py] => w_ie: 1.0
2025-01-20 10:57:40,246 [trainer.py] => w_act: 0.1
2025-01-20 10:57:40,246 [trainer.py] => syn_size: 32
2025-01-20 10:57:40,246 [trainer.py] => need_syn_imgs: false
2025-01-20 10:57:40,246 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-20 10:57:40,246 [trainer.py] => g_local_train_steps: 5
2025-01-20 10:57:40,247 [trainer.py] => dataset_syn: cifar100
2025-01-20 10:57:40,247 [trainer.py] => com_round_gen: 20
2025-01-20 10:57:40,247 [trainer.py] => g_sigma: 0
2025-01-20 10:57:40,247 [trainer.py] => save_cls_embeds: False
2025-01-20 10:57:40,247 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_bs5
2025-01-20 10:57:40,247 [trainer.py] => save_dir: outputs
2025-01-20 10:57:40,247 [trainer.py] => n_iter: 5
2025-01-20 10:57:40,247 [trainer.py] => num_users: 1
2025-01-20 10:57:40,247 [trainer.py] => cur_size: 5
2025-01-20 10:57:40,247 [trainer.py] => g_local_bs: 5
2025-01-20 10:57:40,247 [trainer.py] => local_bs0: 5
2025-01-20 10:57:40,247 [trainer.py] => local_bs1: 5
2025-01-20 10:57:40,247 [trainer.py] => pre_size: 48
2025-01-20 10:57:40,247 [trainer.py] => w_ce_pre: 0.5
2025-01-20 10:57:40,247 [trainer.py] => vpt_type: Deep
2025-01-20 10:57:40,247 [trainer.py] => prompt_token_num: 6
2025-01-20 10:57:40,247 [trainer.py] => avg_alpha: 0.8
2025-01-20 10:57:40,247 [trainer.py] => perturb_var: 1
2025-01-20 10:57:40,247 [trainer.py] => EMA_beta: 0.99
2025-01-20 10:57:40,247 [trainer.py] => anchor_lambda: 0.1
2025-01-20 10:57:40,247 [trainer.py] => kl_weight: 0.001
2025-01-20 10:57:40,247 [trainer.py] => TIP_init: zero
2025-01-20 10:57:40,247 [trainer.py] => tuned_epoch: 10
2025-01-20 10:57:40,247 [trainer.py] => fs_epoch: 0
2025-01-20 10:57:40,247 [trainer.py] => init_lr: 0.01
2025-01-20 10:57:40,247 [trainer.py] => fs_lr: 0.001
2025-01-20 10:57:40,247 [trainer.py] => batch_size: 48
2025-01-20 10:57:40,247 [trainer.py] => fs_batch_size: 16
2025-01-20 10:57:40,247 [trainer.py] => weight_decay: 0.0005
2025-01-20 10:57:40,247 [trainer.py] => min_lr: 0
2025-01-20 10:57:40,248 [trainer.py] => optimizer: sgd
2025-01-20 10:57:40,248 [trainer.py] => memory_size: 0
2025-01-20 10:57:40,248 [trainer.py] => memory_per_class: 0
2025-01-20 10:57:40,248 [trainer.py] => fixed_memory: False
2025-01-20 10:57:40,248 [trainer.py] => shuffle: False
2025-01-20 10:57:40,248 [trainer.py] => top_k: 5
2025-01-20 10:57:40,248 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-20 10:57:40,248 [trainer.py] => prefix: asp
2025-01-20 10:57:40,248 [trainer.py] => model_prefix: asp
2025-01-20 10:57:41,966 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-20 10:57:50,982 [trainer.py] => All params: 173596160
2025-01-20 10:57:50,983 [trainer.py] => Trainable params: 1998848
2025-01-20 10:58:07,387 [asp.py] => Learning on 0-5
2025-01-20 10:58:07,427 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-20 11:04:06,789 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-20 11:04:06,789 [trainer.py] => model_name: asp
2025-01-20 11:04:06,789 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-20 11:04:06,789 [trainer.py] => device: ['cuda']
2025-01-20 11:04:06,789 [trainer.py] => seed: 2024
2025-01-20 11:04:06,789 [trainer.py] => dataset: cifar224
2025-01-20 11:04:06,789 [trainer.py] => init_cls: 5
2025-01-20 11:04:06,789 [trainer.py] => increment: 5
2025-01-20 11:04:06,789 [trainer.py] => kshot: 5
2025-01-20 11:04:06,789 [trainer.py] => generator_model: CIFAR_GEN
2025-01-20 11:04:06,789 [trainer.py] => z_dim: 1000
2025-01-20 11:04:06,789 [trainer.py] => conv_dim: 64
2025-01-20 11:04:06,789 [trainer.py] => img_size: 224
2025-01-20 11:04:06,789 [trainer.py] => generator_lr: 0.005
2025-01-20 11:04:06,789 [trainer.py] => pi: 100
2025-01-20 11:04:06,789 [trainer.py] => w_bn: 50.0
2025-01-20 11:04:06,790 [trainer.py] => w_noise: 0.001
2025-01-20 11:04:06,790 [trainer.py] => server_ss: 32
2025-01-20 11:04:06,790 [trainer.py] => bn_loss: 1
2025-01-20 11:04:06,790 [trainer.py] => noise: 1
2025-01-20 11:04:06,790 [trainer.py] => ie_loss: 1
2025-01-20 11:04:06,790 [trainer.py] => act_loss: 0
2025-01-20 11:04:06,790 [trainer.py] => w_ie: 1.0
2025-01-20 11:04:06,790 [trainer.py] => w_act: 0.1
2025-01-20 11:04:06,790 [trainer.py] => syn_size: 32
2025-01-20 11:04:06,790 [trainer.py] => need_syn_imgs: false
2025-01-20 11:04:06,790 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-20 11:04:06,790 [trainer.py] => g_local_train_steps: 5
2025-01-20 11:04:06,790 [trainer.py] => dataset_syn: cifar100
2025-01-20 11:04:06,790 [trainer.py] => com_round_gen: 20
2025-01-20 11:04:06,790 [trainer.py] => g_sigma: 0
2025-01-20 11:04:06,790 [trainer.py] => save_cls_embeds: False
2025-01-20 11:04:06,790 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_bs5
2025-01-20 11:04:06,790 [trainer.py] => save_dir: outputs
2025-01-20 11:04:06,790 [trainer.py] => n_iter: 5
2025-01-20 11:04:06,790 [trainer.py] => num_users: 1
2025-01-20 11:04:06,790 [trainer.py] => cur_size: 5
2025-01-20 11:04:06,790 [trainer.py] => g_local_bs: 5
2025-01-20 11:04:06,790 [trainer.py] => local_bs0: 5
2025-01-20 11:04:06,790 [trainer.py] => local_bs1: 5
2025-01-20 11:04:06,790 [trainer.py] => pre_size: 48
2025-01-20 11:04:06,790 [trainer.py] => w_ce_pre: 0.5
2025-01-20 11:04:06,790 [trainer.py] => vpt_type: Deep
2025-01-20 11:04:06,790 [trainer.py] => prompt_token_num: 6
2025-01-20 11:04:06,790 [trainer.py] => avg_alpha: 0.8
2025-01-20 11:04:06,790 [trainer.py] => perturb_var: 1
2025-01-20 11:04:06,790 [trainer.py] => EMA_beta: 0.99
2025-01-20 11:04:06,790 [trainer.py] => anchor_lambda: 0.1
2025-01-20 11:04:06,790 [trainer.py] => kl_weight: 0.001
2025-01-20 11:04:06,790 [trainer.py] => TIP_init: zero
2025-01-20 11:04:06,791 [trainer.py] => tuned_epoch: 10
2025-01-20 11:04:06,791 [trainer.py] => fs_epoch: 0
2025-01-20 11:04:06,791 [trainer.py] => init_lr: 0.01
2025-01-20 11:04:06,791 [trainer.py] => fs_lr: 0.001
2025-01-20 11:04:06,791 [trainer.py] => batch_size: 48
2025-01-20 11:04:06,791 [trainer.py] => fs_batch_size: 16
2025-01-20 11:04:06,791 [trainer.py] => weight_decay: 0.0005
2025-01-20 11:04:06,791 [trainer.py] => min_lr: 0
2025-01-20 11:04:06,791 [trainer.py] => optimizer: sgd
2025-01-20 11:04:06,791 [trainer.py] => memory_size: 0
2025-01-20 11:04:06,791 [trainer.py] => memory_per_class: 0
2025-01-20 11:04:06,791 [trainer.py] => fixed_memory: False
2025-01-20 11:04:06,791 [trainer.py] => shuffle: False
2025-01-20 11:04:06,791 [trainer.py] => top_k: 5
2025-01-20 11:04:06,791 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-20 11:04:06,791 [trainer.py] => prefix: asp
2025-01-20 11:04:06,791 [trainer.py] => model_prefix: asp
2025-01-20 11:04:08,322 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-20 11:04:16,792 [trainer.py] => All params: 173596160
2025-01-20 11:04:16,793 [trainer.py] => Trainable params: 1998848
2025-01-20 11:04:49,479 [asp.py] => Learning on 0-5
2025-01-20 11:04:49,484 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-20 11:14:51,845 [asp.py] => total parameters: 173600001
2025-01-20 11:14:51,846 [asp.py] => trainable parameters: 2002689
2025-01-20 11:15:59,077 [asp.py] => Task 0, Epoch 1 => Loss 1.226, Train_accy 82.97, Test_curr_accy 98.40, Test_accy 98.40
2025-01-20 11:17:04,976 [asp.py] => Task 0, Epoch 2 => Loss 0.470, Train_accy 91.60, Test_curr_accy 98.40, Test_accy 98.40
2025-01-20 11:18:10,418 [asp.py] => Task 0, Epoch 3 => Loss 0.435, Train_accy 92.71, Test_curr_accy 98.40, Test_accy 98.40
2025-01-20 11:19:16,281 [asp.py] => Task 0, Epoch 4 => Loss 0.392, Train_accy 92.24, Test_curr_accy 99.40, Test_accy 99.40
2025-01-20 11:20:21,992 [asp.py] => Task 0, Epoch 5 => Loss 0.417, Train_accy 93.15, Test_curr_accy 98.80, Test_accy 98.80
2025-01-20 11:21:01,996 [asp.py] => total parameters: 173600001
2025-01-20 11:21:01,997 [asp.py] => trainable parameters: 2002689
2025-01-20 11:21:27,164 [asp.py] => Task 0, Epoch 6 => Loss 0.316, Train_accy 93.50, Test_curr_accy 99.00, Test_accy 99.00
2025-01-20 11:22:10,066 [asp.py] => Task 0, Epoch 1 => Loss 1.205, Train_accy 83.45, Test_curr_accy 98.60, Test_accy 98.60
2025-01-20 11:22:32,864 [asp.py] => Task 0, Epoch 7 => Loss 0.291, Train_accy 93.70, Test_curr_accy 99.20, Test_accy 99.20
2025-01-20 11:23:16,690 [asp.py] => Task 0, Epoch 2 => Loss 0.479, Train_accy 91.41, Test_curr_accy 98.60, Test_accy 98.60
2025-01-20 11:23:38,229 [asp.py] => Task 0, Epoch 8 => Loss 0.255, Train_accy 94.34, Test_curr_accy 98.80, Test_accy 98.80
2025-01-20 11:24:22,680 [asp.py] => Task 0, Epoch 3 => Loss 0.436, Train_accy 92.59, Test_curr_accy 98.00, Test_accy 98.00
2025-01-20 11:24:43,920 [asp.py] => Task 0, Epoch 9 => Loss 0.253, Train_accy 94.26, Test_curr_accy 98.40, Test_accy 98.40
2025-01-20 11:25:28,166 [asp.py] => Task 0, Epoch 4 => Loss 0.366, Train_accy 92.87, Test_curr_accy 99.40, Test_accy 99.40
2025-01-20 11:25:49,603 [asp.py] => Task 0, Epoch 10 => Loss 0.233, Train_accy 94.77, Test_curr_accy 99.60, Test_accy 99.60
2025-01-20 11:26:16,606 [trainer.py] => Top1 curve: [98.6]
2025-01-20 11:26:16,606 [trainer.py] => Average Accuracy (Top1): 98.6   (Harmonic Accuracy): None (Old Acc): 98.6 (New Acc): [] 

2025-01-20 11:26:16,607 [trainer.py] => All params: 173600001
2025-01-20 11:26:16,608 [trainer.py] => Trainable params: 2002689
2025-01-20 11:26:36,689 [asp.py] => Task 0, Epoch 5 => Loss 0.344, Train_accy 93.27, Test_curr_accy 99.00, Test_accy 99.00
2025-01-20 11:26:47,160 [asp.py] => Learning on 5-10
2025-01-20 11:26:47,175 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 11:27:43,414 [asp.py] => Task 0, Epoch 6 => Loss 0.318, Train_accy 93.03, Test_curr_accy 99.60, Test_accy 99.60
2025-01-20 11:28:48,664 [asp.py] => Task 0, Epoch 7 => Loss 0.294, Train_accy 93.94, Test_curr_accy 98.80, Test_accy 98.80
2025-01-20 11:29:52,709 [asp.py] => Task 0, Epoch 8 => Loss 0.246, Train_accy 93.86, Test_curr_accy 98.60, Test_accy 98.60
2025-01-20 11:30:57,118 [asp.py] => Task 0, Epoch 9 => Loss 0.234, Train_accy 94.73, Test_curr_accy 98.80, Test_accy 98.80
2025-01-20 11:32:01,191 [asp.py] => Task 0, Epoch 10 => Loss 0.216, Train_accy 95.09, Test_curr_accy 99.60, Test_accy 99.60
2025-01-20 11:32:27,492 [trainer.py] => Top1 curve: [99.4]
2025-01-20 11:32:27,492 [trainer.py] => Average Accuracy (Top1): 99.4   (Harmonic Accuracy): None (Old Acc): 99.4 (New Acc): [] 

2025-01-20 11:32:27,493 [trainer.py] => All params: 173600001
2025-01-20 11:32:27,494 [trainer.py] => Trainable params: 2002689
2025-01-20 11:32:48,429 [asp.py] => Learning on 5-10
2025-01-20 11:32:48,437 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 11:43:29,272 [asp.py] => total parameters: 173603841
2025-01-20 11:43:29,273 [asp.py] => trainable parameters: 2006529
2025-01-20 11:43:36,634 [trainer.py] => Top1 curve: [98.6, 94.8]
2025-01-20 11:43:36,634 [trainer.py] => Average Accuracy (Top1): 96.69999999999999   (Harmonic Accuracy): 94.6632911392405 (Old Acc): 98.4 (New Acc): 91.2 

2025-01-20 11:43:36,635 [trainer.py] => All params: 173603841
2025-01-20 11:43:36,635 [trainer.py] => Trainable params: 2006529
2025-01-20 11:43:58,092 [asp.py] => Learning on 10-15
2025-01-20 11:43:58,101 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 11:50:13,971 [asp.py] => total parameters: 173603841
2025-01-20 11:50:13,972 [asp.py] => trainable parameters: 2006529
2025-01-20 11:50:20,987 [trainer.py] => Top1 curve: [99.4, 97.6]
2025-01-20 11:50:20,987 [trainer.py] => Average Accuracy (Top1): 98.5   (Harmonic Accuracy): 97.56680327868854 (Old Acc): 99.4 (New Acc): 95.8 

2025-01-20 11:50:20,988 [trainer.py] => All params: 173603841
2025-01-20 11:50:20,989 [trainer.py] => Trainable params: 2006529
2025-01-20 11:50:40,483 [asp.py] => Learning on 10-15
2025-01-20 11:50:40,491 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 12:01:05,330 [asp.py] => total parameters: 173607681
2025-01-20 12:01:05,331 [asp.py] => trainable parameters: 2010369
2025-01-20 12:01:15,390 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67]
2025-01-20 12:01:15,391 [trainer.py] => Average Accuracy (Top1): 93.69   (Harmonic Accuracy): 89.53433166943981 (Old Acc): 97.6 (New Acc): 82.7 

2025-01-20 12:01:15,392 [trainer.py] => All params: 173607681
2025-01-20 12:01:15,392 [trainer.py] => Trainable params: 2010369
2025-01-20 12:01:34,508 [asp.py] => Learning on 15-20
2025-01-20 12:01:34,521 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 12:07:51,144 [asp.py] => total parameters: 173607681
2025-01-20 12:07:51,145 [asp.py] => trainable parameters: 2010369
2025-01-20 12:08:00,849 [trainer.py] => Top1 curve: [99.4, 97.6, 92.07]
2025-01-20 12:08:00,850 [trainer.py] => Average Accuracy (Top1): 96.35666666666667   (Harmonic Accuracy): 93.33832175307322 (Old Acc): 98.0 (New Acc): 89.1 

2025-01-20 12:08:00,851 [trainer.py] => All params: 173607681
2025-01-20 12:08:00,852 [trainer.py] => Trainable params: 2010369
2025-01-20 12:08:21,830 [asp.py] => Learning on 15-20
2025-01-20 12:08:21,842 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 12:18:28,711 [asp.py] => total parameters: 173611521
2025-01-20 12:18:28,711 [asp.py] => trainable parameters: 2014209
2025-01-20 12:18:40,691 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15]
2025-01-20 12:18:40,691 [trainer.py] => Average Accuracy (Top1): 91.055   (Harmonic Accuracy): 86.67559954320518 (Old Acc): 96.4 (New Acc): 78.73333333333333 

2025-01-20 12:18:40,692 [trainer.py] => All params: 173611521
2025-01-20 12:18:40,693 [trainer.py] => Trainable params: 2014209
2025-01-20 12:19:01,553 [asp.py] => Learning on 20-25
2025-01-20 12:19:01,565 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 12:21:48,522 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-20 12:21:48,522 [trainer.py] => model_name: asp
2025-01-20 12:21:48,522 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-20 12:21:48,522 [trainer.py] => device: ['cuda']
2025-01-20 12:21:48,522 [trainer.py] => seed: 2024
2025-01-20 12:21:48,522 [trainer.py] => dataset: cifar224
2025-01-20 12:21:48,522 [trainer.py] => init_cls: 5
2025-01-20 12:21:48,522 [trainer.py] => increment: 5
2025-01-20 12:21:48,522 [trainer.py] => kshot: 5
2025-01-20 12:21:48,522 [trainer.py] => generator_model: CIFAR_GEN
2025-01-20 12:21:48,522 [trainer.py] => z_dim: 1000
2025-01-20 12:21:48,523 [trainer.py] => conv_dim: 64
2025-01-20 12:21:48,523 [trainer.py] => img_size: 224
2025-01-20 12:21:48,523 [trainer.py] => generator_lr: 0.005
2025-01-20 12:21:48,523 [trainer.py] => pi: 100
2025-01-20 12:21:48,523 [trainer.py] => w_bn: 50.0
2025-01-20 12:21:48,523 [trainer.py] => w_noise: 0.001
2025-01-20 12:21:48,523 [trainer.py] => server_ss: 32
2025-01-20 12:21:48,523 [trainer.py] => bn_loss: 1
2025-01-20 12:21:48,523 [trainer.py] => noise: 1
2025-01-20 12:21:48,523 [trainer.py] => ie_loss: 1
2025-01-20 12:21:48,523 [trainer.py] => act_loss: 0
2025-01-20 12:21:48,523 [trainer.py] => w_ie: 1.0
2025-01-20 12:21:48,523 [trainer.py] => w_act: 0.1
2025-01-20 12:21:48,523 [trainer.py] => syn_size: 32
2025-01-20 12:21:48,523 [trainer.py] => need_syn_imgs: false
2025-01-20 12:21:48,523 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-20 12:21:48,523 [trainer.py] => g_local_train_steps: 5
2025-01-20 12:21:48,523 [trainer.py] => dataset_syn: cifar100
2025-01-20 12:21:48,523 [trainer.py] => com_round_gen: 20
2025-01-20 12:21:48,523 [trainer.py] => g_sigma: 0
2025-01-20 12:21:48,523 [trainer.py] => save_cls_embeds: False
2025-01-20 12:21:48,523 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_bs5
2025-01-20 12:21:48,523 [trainer.py] => save_dir: outputs
2025-01-20 12:21:48,523 [trainer.py] => n_iter: 5
2025-01-20 12:21:48,523 [trainer.py] => num_users: 1
2025-01-20 12:21:48,523 [trainer.py] => cur_size: 5
2025-01-20 12:21:48,523 [trainer.py] => g_local_bs: 5
2025-01-20 12:21:48,523 [trainer.py] => local_bs0: 5
2025-01-20 12:21:48,523 [trainer.py] => local_bs1: 5
2025-01-20 12:21:48,523 [trainer.py] => pre_size: 48
2025-01-20 12:21:48,523 [trainer.py] => w_ce_pre: 0.5
2025-01-20 12:21:48,523 [trainer.py] => vpt_type: Deep
2025-01-20 12:21:48,524 [trainer.py] => prompt_token_num: 6
2025-01-20 12:21:48,524 [trainer.py] => avg_alpha: 0.8
2025-01-20 12:21:48,524 [trainer.py] => perturb_var: 1
2025-01-20 12:21:48,524 [trainer.py] => EMA_beta: 0.99
2025-01-20 12:21:48,524 [trainer.py] => anchor_lambda: 0.1
2025-01-20 12:21:48,524 [trainer.py] => kl_weight: 0.001
2025-01-20 12:21:48,524 [trainer.py] => TIP_init: zero
2025-01-20 12:21:48,524 [trainer.py] => tuned_epoch: 10
2025-01-20 12:21:48,524 [trainer.py] => fs_epoch: 0
2025-01-20 12:21:48,524 [trainer.py] => init_lr: 0.01
2025-01-20 12:21:48,524 [trainer.py] => fs_lr: 0.001
2025-01-20 12:21:48,524 [trainer.py] => batch_size: 48
2025-01-20 12:21:48,524 [trainer.py] => fs_batch_size: 16
2025-01-20 12:21:48,524 [trainer.py] => weight_decay: 0.0005
2025-01-20 12:21:48,524 [trainer.py] => min_lr: 0
2025-01-20 12:21:48,524 [trainer.py] => optimizer: sgd
2025-01-20 12:21:48,524 [trainer.py] => memory_size: 0
2025-01-20 12:21:48,524 [trainer.py] => memory_per_class: 0
2025-01-20 12:21:48,524 [trainer.py] => fixed_memory: False
2025-01-20 12:21:48,524 [trainer.py] => shuffle: False
2025-01-20 12:21:48,524 [trainer.py] => top_k: 5
2025-01-20 12:21:48,524 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-20 12:21:48,524 [trainer.py] => prefix: asp
2025-01-20 12:21:48,524 [trainer.py] => model_prefix: asp
2025-01-20 12:21:50,233 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-20 12:22:00,258 [trainer.py] => All params: 173596160
2025-01-20 12:22:00,259 [trainer.py] => Trainable params: 1998848
2025-01-20 12:22:17,166 [asp.py] => Learning on 0-5
2025-01-20 12:22:17,172 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-20 12:26:57,858 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-20 12:26:57,858 [trainer.py] => model_name: asp
2025-01-20 12:26:57,858 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-20 12:26:57,858 [trainer.py] => device: ['cuda']
2025-01-20 12:26:57,858 [trainer.py] => seed: 2024
2025-01-20 12:26:57,858 [trainer.py] => dataset: cifar224
2025-01-20 12:26:57,858 [trainer.py] => init_cls: 5
2025-01-20 12:26:57,858 [trainer.py] => increment: 5
2025-01-20 12:26:57,858 [trainer.py] => kshot: 5
2025-01-20 12:26:57,858 [trainer.py] => generator_model: CIFAR_GEN
2025-01-20 12:26:57,858 [trainer.py] => z_dim: 1000
2025-01-20 12:26:57,858 [trainer.py] => conv_dim: 64
2025-01-20 12:26:57,858 [trainer.py] => img_size: 224
2025-01-20 12:26:57,858 [trainer.py] => generator_lr: 0.005
2025-01-20 12:26:57,858 [trainer.py] => pi: 100
2025-01-20 12:26:57,858 [trainer.py] => w_bn: 50.0
2025-01-20 12:26:57,858 [trainer.py] => w_noise: 0.001
2025-01-20 12:26:57,858 [trainer.py] => server_ss: 32
2025-01-20 12:26:57,858 [trainer.py] => bn_loss: 1
2025-01-20 12:26:57,859 [trainer.py] => noise: 1
2025-01-20 12:26:57,859 [trainer.py] => ie_loss: 1
2025-01-20 12:26:57,859 [trainer.py] => act_loss: 0
2025-01-20 12:26:57,859 [trainer.py] => w_ie: 1.0
2025-01-20 12:26:57,859 [trainer.py] => w_act: 0.1
2025-01-20 12:26:57,859 [trainer.py] => syn_size: 32
2025-01-20 12:26:57,859 [trainer.py] => need_syn_imgs: false
2025-01-20 12:26:57,859 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-20 12:26:57,859 [trainer.py] => g_local_train_steps: 5
2025-01-20 12:26:57,859 [trainer.py] => dataset_syn: cifar100
2025-01-20 12:26:57,859 [trainer.py] => com_round_gen: 20
2025-01-20 12:26:57,859 [trainer.py] => g_sigma: 0
2025-01-20 12:26:57,859 [trainer.py] => save_cls_embeds: False
2025-01-20 12:26:57,859 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_bs5
2025-01-20 12:26:57,859 [trainer.py] => save_dir: outputs
2025-01-20 12:26:57,859 [trainer.py] => n_iter: 5
2025-01-20 12:26:57,859 [trainer.py] => num_users: 1
2025-01-20 12:26:57,859 [trainer.py] => cur_size: 5
2025-01-20 12:26:57,859 [trainer.py] => g_local_bs: 5
2025-01-20 12:26:57,859 [trainer.py] => local_bs0: 5
2025-01-20 12:26:57,859 [trainer.py] => local_bs1: 5
2025-01-20 12:26:57,859 [trainer.py] => pre_size: 48
2025-01-20 12:26:57,859 [trainer.py] => w_ce_pre: 0.5
2025-01-20 12:26:57,859 [trainer.py] => vpt_type: Deep
2025-01-20 12:26:57,859 [trainer.py] => prompt_token_num: 6
2025-01-20 12:26:57,859 [trainer.py] => avg_alpha: 0.8
2025-01-20 12:26:57,859 [trainer.py] => perturb_var: 1
2025-01-20 12:26:57,859 [trainer.py] => EMA_beta: 0.99
2025-01-20 12:26:57,859 [trainer.py] => anchor_lambda: 0.1
2025-01-20 12:26:57,859 [trainer.py] => kl_weight: 0.001
2025-01-20 12:26:57,859 [trainer.py] => TIP_init: zero
2025-01-20 12:26:57,859 [trainer.py] => tuned_epoch: 10
2025-01-20 12:26:57,860 [trainer.py] => fs_epoch: 0
2025-01-20 12:26:57,860 [trainer.py] => init_lr: 0.01
2025-01-20 12:26:57,860 [trainer.py] => fs_lr: 0.001
2025-01-20 12:26:57,860 [trainer.py] => batch_size: 48
2025-01-20 12:26:57,860 [trainer.py] => fs_batch_size: 16
2025-01-20 12:26:57,860 [trainer.py] => weight_decay: 0.0005
2025-01-20 12:26:57,860 [trainer.py] => min_lr: 0
2025-01-20 12:26:57,860 [trainer.py] => optimizer: sgd
2025-01-20 12:26:57,860 [trainer.py] => memory_size: 0
2025-01-20 12:26:57,860 [trainer.py] => memory_per_class: 0
2025-01-20 12:26:57,860 [trainer.py] => fixed_memory: False
2025-01-20 12:26:57,860 [trainer.py] => shuffle: False
2025-01-20 12:26:57,860 [trainer.py] => top_k: 5
2025-01-20 12:26:57,860 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-20 12:26:57,860 [trainer.py] => prefix: asp
2025-01-20 12:26:57,860 [trainer.py] => model_prefix: asp
2025-01-20 12:26:59,439 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-20 12:27:12,150 [trainer.py] => All params: 173596160
2025-01-20 12:27:12,152 [trainer.py] => Trainable params: 1998848
2025-01-20 12:27:35,667 [asp.py] => Learning on 0-5
2025-01-20 12:27:35,677 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-20 12:33:16,075 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-20 12:33:16,075 [trainer.py] => model_name: asp
2025-01-20 12:33:16,075 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-20 12:33:16,076 [trainer.py] => device: ['cuda']
2025-01-20 12:33:16,076 [trainer.py] => seed: 2024
2025-01-20 12:33:16,076 [trainer.py] => dataset: cifar224
2025-01-20 12:33:16,076 [trainer.py] => init_cls: 5
2025-01-20 12:33:16,076 [trainer.py] => increment: 5
2025-01-20 12:33:16,076 [trainer.py] => kshot: 5
2025-01-20 12:33:16,076 [trainer.py] => generator_model: CIFAR_GEN
2025-01-20 12:33:16,076 [trainer.py] => z_dim: 1000
2025-01-20 12:33:16,076 [trainer.py] => conv_dim: 64
2025-01-20 12:33:16,076 [trainer.py] => img_size: 224
2025-01-20 12:33:16,076 [trainer.py] => generator_lr: 0.005
2025-01-20 12:33:16,076 [trainer.py] => pi: 100
2025-01-20 12:33:16,076 [trainer.py] => w_bn: 50.0
2025-01-20 12:33:16,076 [trainer.py] => w_noise: 0.001
2025-01-20 12:33:16,076 [trainer.py] => server_ss: 32
2025-01-20 12:33:16,076 [trainer.py] => bn_loss: 1
2025-01-20 12:33:16,076 [trainer.py] => noise: 1
2025-01-20 12:33:16,076 [trainer.py] => ie_loss: 1
2025-01-20 12:33:16,076 [trainer.py] => act_loss: 0
2025-01-20 12:33:16,076 [trainer.py] => w_ie: 1.0
2025-01-20 12:33:16,076 [trainer.py] => w_act: 0.1
2025-01-20 12:33:16,076 [trainer.py] => syn_size: 32
2025-01-20 12:33:16,076 [trainer.py] => need_syn_imgs: false
2025-01-20 12:33:16,076 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-20 12:33:16,076 [trainer.py] => g_local_train_steps: 5
2025-01-20 12:33:16,076 [trainer.py] => dataset_syn: cifar100
2025-01-20 12:33:16,076 [trainer.py] => com_round_gen: 20
2025-01-20 12:33:16,076 [trainer.py] => g_sigma: 0
2025-01-20 12:33:16,076 [trainer.py] => save_cls_embeds: False
2025-01-20 12:33:16,076 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_bs5
2025-01-20 12:33:16,076 [trainer.py] => save_dir: outputs
2025-01-20 12:33:16,076 [trainer.py] => n_iter: 5
2025-01-20 12:33:16,076 [trainer.py] => num_users: 1
2025-01-20 12:33:16,077 [trainer.py] => cur_size: 5
2025-01-20 12:33:16,077 [trainer.py] => g_local_bs: 5
2025-01-20 12:33:16,077 [trainer.py] => local_bs0: 5
2025-01-20 12:33:16,077 [trainer.py] => local_bs1: 5
2025-01-20 12:33:16,077 [trainer.py] => pre_size: 48
2025-01-20 12:33:16,077 [trainer.py] => w_ce_pre: 0.5
2025-01-20 12:33:16,077 [trainer.py] => vpt_type: Deep
2025-01-20 12:33:16,077 [trainer.py] => prompt_token_num: 6
2025-01-20 12:33:16,077 [trainer.py] => avg_alpha: 0.8
2025-01-20 12:33:16,077 [trainer.py] => perturb_var: 1
2025-01-20 12:33:16,077 [trainer.py] => EMA_beta: 0.99
2025-01-20 12:33:16,077 [trainer.py] => anchor_lambda: 0.1
2025-01-20 12:33:16,077 [trainer.py] => kl_weight: 0.001
2025-01-20 12:33:16,077 [trainer.py] => TIP_init: zero
2025-01-20 12:33:16,077 [trainer.py] => tuned_epoch: 10
2025-01-20 12:33:16,077 [trainer.py] => fs_epoch: 0
2025-01-20 12:33:16,077 [trainer.py] => init_lr: 0.01
2025-01-20 12:33:16,077 [trainer.py] => fs_lr: 0.001
2025-01-20 12:33:16,077 [trainer.py] => batch_size: 48
2025-01-20 12:33:16,077 [trainer.py] => fs_batch_size: 16
2025-01-20 12:33:16,077 [trainer.py] => weight_decay: 0.0005
2025-01-20 12:33:16,077 [trainer.py] => min_lr: 0
2025-01-20 12:33:16,077 [trainer.py] => optimizer: sgd
2025-01-20 12:33:16,077 [trainer.py] => memory_size: 0
2025-01-20 12:33:16,077 [trainer.py] => memory_per_class: 0
2025-01-20 12:33:16,077 [trainer.py] => fixed_memory: False
2025-01-20 12:33:16,077 [trainer.py] => shuffle: False
2025-01-20 12:33:16,077 [trainer.py] => top_k: 5
2025-01-20 12:33:16,077 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-20 12:33:16,077 [trainer.py] => prefix: asp
2025-01-20 12:33:16,077 [trainer.py] => model_prefix: asp
2025-01-20 12:33:17,645 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-20 12:33:26,418 [trainer.py] => All params: 173596160
2025-01-20 12:33:26,419 [trainer.py] => Trainable params: 1998848
2025-01-20 12:33:42,830 [asp.py] => Learning on 0-5
2025-01-20 12:33:42,835 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-20 12:35:44,543 [asp.py] => total parameters: 173615361
2025-01-20 12:35:44,544 [asp.py] => trainable parameters: 2018049
2025-01-20 12:35:49,173 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-20 12:35:49,173 [trainer.py] => model_name: asp
2025-01-20 12:35:49,173 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-20 12:35:49,173 [trainer.py] => device: ['cuda']
2025-01-20 12:35:49,173 [trainer.py] => seed: 2024
2025-01-20 12:35:49,173 [trainer.py] => dataset: cifar224
2025-01-20 12:35:49,173 [trainer.py] => init_cls: 5
2025-01-20 12:35:49,173 [trainer.py] => increment: 5
2025-01-20 12:35:49,173 [trainer.py] => kshot: 5
2025-01-20 12:35:49,173 [trainer.py] => generator_model: CIFAR_GEN
2025-01-20 12:35:49,173 [trainer.py] => z_dim: 1000
2025-01-20 12:35:49,173 [trainer.py] => conv_dim: 64
2025-01-20 12:35:49,173 [trainer.py] => img_size: 224
2025-01-20 12:35:49,173 [trainer.py] => generator_lr: 0.005
2025-01-20 12:35:49,173 [trainer.py] => pi: 100
2025-01-20 12:35:49,173 [trainer.py] => w_bn: 50.0
2025-01-20 12:35:49,173 [trainer.py] => w_noise: 0.001
2025-01-20 12:35:49,173 [trainer.py] => server_ss: 32
2025-01-20 12:35:49,173 [trainer.py] => bn_loss: 1
2025-01-20 12:35:49,173 [trainer.py] => noise: 1
2025-01-20 12:35:49,174 [trainer.py] => ie_loss: 1
2025-01-20 12:35:49,174 [trainer.py] => act_loss: 0
2025-01-20 12:35:49,174 [trainer.py] => w_ie: 1.0
2025-01-20 12:35:49,174 [trainer.py] => w_act: 0.1
2025-01-20 12:35:49,174 [trainer.py] => syn_size: 32
2025-01-20 12:35:49,174 [trainer.py] => need_syn_imgs: false
2025-01-20 12:35:49,174 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-20 12:35:49,174 [trainer.py] => g_local_train_steps: 5
2025-01-20 12:35:49,174 [trainer.py] => dataset_syn: cifar100
2025-01-20 12:35:49,174 [trainer.py] => com_round_gen: 20
2025-01-20 12:35:49,174 [trainer.py] => g_sigma: 0
2025-01-20 12:35:49,174 [trainer.py] => save_cls_embeds: False
2025-01-20 12:35:49,174 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_bs5
2025-01-20 12:35:49,174 [trainer.py] => save_dir: outputs
2025-01-20 12:35:49,174 [trainer.py] => n_iter: 5
2025-01-20 12:35:49,174 [trainer.py] => num_users: 1
2025-01-20 12:35:49,174 [trainer.py] => cur_size: 5
2025-01-20 12:35:49,174 [trainer.py] => g_local_bs: 5
2025-01-20 12:35:49,174 [trainer.py] => local_bs0: 5
2025-01-20 12:35:49,174 [trainer.py] => local_bs1: 5
2025-01-20 12:35:49,174 [trainer.py] => pre_size: 48
2025-01-20 12:35:49,174 [trainer.py] => w_ce_pre: 0.5
2025-01-20 12:35:49,174 [trainer.py] => vpt_type: Deep
2025-01-20 12:35:49,174 [trainer.py] => prompt_token_num: 6
2025-01-20 12:35:49,174 [trainer.py] => avg_alpha: 0.8
2025-01-20 12:35:49,174 [trainer.py] => perturb_var: 1
2025-01-20 12:35:49,174 [trainer.py] => EMA_beta: 0.99
2025-01-20 12:35:49,174 [trainer.py] => anchor_lambda: 0.1
2025-01-20 12:35:49,174 [trainer.py] => kl_weight: 0.001
2025-01-20 12:35:49,174 [trainer.py] => TIP_init: zero
2025-01-20 12:35:49,174 [trainer.py] => tuned_epoch: 10
2025-01-20 12:35:49,174 [trainer.py] => fs_epoch: 0
2025-01-20 12:35:49,174 [trainer.py] => init_lr: 0.01
2025-01-20 12:35:49,175 [trainer.py] => fs_lr: 0.001
2025-01-20 12:35:49,175 [trainer.py] => batch_size: 48
2025-01-20 12:35:49,175 [trainer.py] => fs_batch_size: 16
2025-01-20 12:35:49,175 [trainer.py] => weight_decay: 0.0005
2025-01-20 12:35:49,175 [trainer.py] => min_lr: 0
2025-01-20 12:35:49,175 [trainer.py] => optimizer: sgd
2025-01-20 12:35:49,175 [trainer.py] => memory_size: 0
2025-01-20 12:35:49,175 [trainer.py] => memory_per_class: 0
2025-01-20 12:35:49,175 [trainer.py] => fixed_memory: False
2025-01-20 12:35:49,175 [trainer.py] => shuffle: False
2025-01-20 12:35:49,175 [trainer.py] => top_k: 5
2025-01-20 12:35:49,175 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-20 12:35:49,175 [trainer.py] => prefix: asp
2025-01-20 12:35:49,175 [trainer.py] => model_prefix: asp
2025-01-20 12:35:50,719 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-20 12:35:59,303 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36]
2025-01-20 12:35:59,304 [trainer.py] => Average Accuracy (Top1): 89.516   (Harmonic Accuracy): 87.23061166429588 (Old Acc): 95.4 (New Acc): 80.35 

2025-01-20 12:35:59,305 [trainer.py] => All params: 173615361
2025-01-20 12:35:59,306 [trainer.py] => Trainable params: 2018049
2025-01-20 12:35:59,805 [trainer.py] => All params: 173596160
2025-01-20 12:35:59,806 [trainer.py] => Trainable params: 1998848
2025-01-20 12:36:23,456 [asp.py] => Learning on 0-5
2025-01-20 12:36:23,464 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-20 12:36:28,290 [asp.py] => Learning on 25-30
2025-01-20 12:36:28,311 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 12:38:17,061 [asp.py] => total parameters: 173600001
2025-01-20 12:38:17,062 [asp.py] => trainable parameters: 2002689
2025-01-20 12:39:20,715 [asp.py] => Task 0, Epoch 1 => Loss 1.215, Train_accy 83.72, Test_curr_accy 98.60, Test_accy 98.60
2025-01-20 12:40:22,984 [asp.py] => Task 0, Epoch 2 => Loss 0.507, Train_accy 91.49, Test_curr_accy 99.00, Test_accy 99.00
2025-01-20 12:41:24,345 [asp.py] => Task 0, Epoch 3 => Loss 0.421, Train_accy 92.59, Test_curr_accy 98.80, Test_accy 98.80
2025-01-20 12:42:26,507 [asp.py] => Task 0, Epoch 4 => Loss 0.361, Train_accy 92.36, Test_curr_accy 99.40, Test_accy 99.40
2025-01-20 12:43:27,451 [asp.py] => Task 0, Epoch 5 => Loss 0.335, Train_accy 93.74, Test_curr_accy 99.80, Test_accy 99.80
2025-01-20 12:44:29,327 [asp.py] => Task 0, Epoch 6 => Loss 0.326, Train_accy 93.23, Test_curr_accy 99.40, Test_accy 99.40
2025-01-20 12:45:30,727 [asp.py] => Task 0, Epoch 7 => Loss 0.281, Train_accy 93.86, Test_curr_accy 99.80, Test_accy 99.80
2025-01-20 12:46:32,026 [asp.py] => Task 0, Epoch 8 => Loss 0.259, Train_accy 94.14, Test_curr_accy 99.60, Test_accy 99.60
2025-01-20 12:47:33,623 [asp.py] => Task 0, Epoch 9 => Loss 0.247, Train_accy 94.53, Test_curr_accy 99.20, Test_accy 99.20
2025-01-20 12:48:34,596 [asp.py] => Task 0, Epoch 10 => Loss 0.221, Train_accy 95.29, Test_curr_accy 99.60, Test_accy 99.60
2025-01-20 12:48:59,752 [trainer.py] => Top1 curve: [99.6]
2025-01-20 12:48:59,752 [trainer.py] => Average Accuracy (Top1): 99.6   (Harmonic Accuracy): None (Old Acc): 99.6 (New Acc): [] 

2025-01-20 12:48:59,753 [trainer.py] => All params: 173600001
2025-01-20 12:48:59,754 [trainer.py] => Trainable params: 2002689
2025-01-20 12:49:22,844 [asp.py] => Learning on 5-10
2025-01-20 12:49:22,876 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 12:53:09,419 [asp.py] => total parameters: 173619201
2025-01-20 12:53:09,420 [asp.py] => trainable parameters: 2021889
2025-01-20 12:53:26,450 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0]
2025-01-20 12:53:26,451 [trainer.py] => Average Accuracy (Top1): 87.76333333333334   (Harmonic Accuracy): 84.21220084467386 (Old Acc): 94.6 (New Acc): 75.88000000000001 

2025-01-20 12:53:26,451 [trainer.py] => All params: 173619201
2025-01-20 12:53:26,452 [trainer.py] => Trainable params: 2021889
2025-01-20 12:53:47,989 [asp.py] => Learning on 30-35
2025-01-20 12:53:48,010 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 13:05:34,399 [asp.py] => total parameters: 173603841
2025-01-20 13:05:34,400 [asp.py] => trainable parameters: 2006529
2025-01-20 13:05:41,429 [trainer.py] => Top1 curve: [99.6, 97.7]
2025-01-20 13:05:41,430 [trainer.py] => Average Accuracy (Top1): 98.65   (Harmonic Accuracy): 97.67697031729786 (Old Acc): 99.2 (New Acc): 96.2 

2025-01-20 13:05:41,430 [trainer.py] => All params: 173603841
2025-01-20 13:05:41,431 [trainer.py] => Trainable params: 2006529
2025-01-20 13:06:01,792 [asp.py] => Learning on 10-15
2025-01-20 13:06:01,800 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 13:10:32,591 [asp.py] => total parameters: 173623041
2025-01-20 13:10:32,592 [asp.py] => trainable parameters: 2025729
2025-01-20 13:10:52,582 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17]
2025-01-20 13:10:52,582 [trainer.py] => Average Accuracy (Top1): 86.25   (Harmonic Accuracy): 83.20915909988155 (Old Acc): 94.6 (New Acc): 74.26666666666667 

2025-01-20 13:10:52,583 [trainer.py] => All params: 173623041
2025-01-20 13:10:52,584 [trainer.py] => Trainable params: 2025729
2025-01-20 13:11:13,097 [asp.py] => Learning on 35-40
2025-01-20 13:11:13,117 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 13:22:28,382 [asp.py] => total parameters: 173607681
2025-01-20 13:22:28,383 [asp.py] => trainable parameters: 2010369
2025-01-20 13:22:37,576 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47]
2025-01-20 13:22:37,576 [trainer.py] => Average Accuracy (Top1): 96.25666666666666   (Harmonic Accuracy): 92.80752283718431 (Old Acc): 97.8 (New Acc): 88.3 

2025-01-20 13:22:37,577 [trainer.py] => All params: 173607681
2025-01-20 13:22:37,577 [trainer.py] => Trainable params: 2010369
2025-01-20 13:22:58,027 [asp.py] => Learning on 15-20
2025-01-20 13:22:58,038 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 13:27:52,379 [asp.py] => total parameters: 173626881
2025-01-20 13:27:52,380 [asp.py] => trainable parameters: 2029569
2025-01-20 13:28:14,147 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28]
2025-01-20 13:28:14,147 [trainer.py] => Average Accuracy (Top1): 85.00375   (Harmonic Accuracy): 82.3482280431433 (Old Acc): 93.0 (New Acc): 73.88571428571429 

2025-01-20 13:28:14,148 [trainer.py] => All params: 173626881
2025-01-20 13:28:14,149 [trainer.py] => Trainable params: 2029569
2025-01-20 13:28:36,663 [asp.py] => Learning on 40-45
2025-01-20 13:28:36,687 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 13:39:26,391 [asp.py] => total parameters: 173611521
2025-01-20 13:39:26,392 [asp.py] => trainable parameters: 2014209
2025-01-20 13:39:38,069 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45]
2025-01-20 13:39:38,069 [trainer.py] => Average Accuracy (Top1): 94.55499999999999   (Harmonic Accuracy): 91.89736176364293 (Old Acc): 97.8 (New Acc): 86.66666666666667 

2025-01-20 13:39:38,070 [trainer.py] => All params: 173611521
2025-01-20 13:39:38,070 [trainer.py] => Trainable params: 2014209
2025-01-20 13:39:57,488 [asp.py] => Learning on 20-25
2025-01-20 13:39:57,499 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 13:40:06,465 [asp.py] => total parameters: 173600001
2025-01-20 13:40:06,466 [asp.py] => trainable parameters: 2002689
2025-01-20 13:41:05,702 [asp.py] => Task 0, Epoch 1 => Loss 1.217, Train_accy 83.72, Test_curr_accy 98.80, Test_accy 98.80
2025-01-20 13:42:00,022 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-20 13:42:00,023 [trainer.py] => model_name: asp
2025-01-20 13:42:00,023 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-20 13:42:00,023 [trainer.py] => device: ['cuda']
2025-01-20 13:42:00,023 [trainer.py] => seed: 2024
2025-01-20 13:42:00,023 [trainer.py] => dataset: cifar224
2025-01-20 13:42:00,023 [trainer.py] => init_cls: 5
2025-01-20 13:42:00,023 [trainer.py] => increment: 5
2025-01-20 13:42:00,023 [trainer.py] => kshot: 5
2025-01-20 13:42:00,023 [trainer.py] => generator_model: CIFAR_GEN
2025-01-20 13:42:00,023 [trainer.py] => z_dim: 1000
2025-01-20 13:42:00,023 [trainer.py] => conv_dim: 64
2025-01-20 13:42:00,023 [trainer.py] => img_size: 224
2025-01-20 13:42:00,023 [trainer.py] => generator_lr: 0.005
2025-01-20 13:42:00,023 [trainer.py] => pi: 100
2025-01-20 13:42:00,023 [trainer.py] => w_bn: 50.0
2025-01-20 13:42:00,023 [trainer.py] => w_noise: 0.001
2025-01-20 13:42:00,023 [trainer.py] => server_ss: 32
2025-01-20 13:42:00,023 [trainer.py] => bn_loss: 1
2025-01-20 13:42:00,023 [trainer.py] => noise: 1
2025-01-20 13:42:00,023 [trainer.py] => ie_loss: 1
2025-01-20 13:42:00,023 [trainer.py] => act_loss: 0
2025-01-20 13:42:00,023 [trainer.py] => w_ie: 1.0
2025-01-20 13:42:00,023 [trainer.py] => w_act: 0.1
2025-01-20 13:42:00,023 [trainer.py] => syn_size: 32
2025-01-20 13:42:00,023 [trainer.py] => need_syn_imgs: false
2025-01-20 13:42:00,023 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-20 13:42:00,023 [trainer.py] => g_local_train_steps: 5
2025-01-20 13:42:00,024 [trainer.py] => dataset_syn: cifar100
2025-01-20 13:42:00,024 [trainer.py] => com_round_gen: 20
2025-01-20 13:42:00,024 [trainer.py] => g_sigma: 0
2025-01-20 13:42:00,024 [trainer.py] => save_cls_embeds: False
2025-01-20 13:42:00,024 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_bs5
2025-01-20 13:42:00,024 [trainer.py] => save_dir: outputs
2025-01-20 13:42:00,024 [trainer.py] => n_iter: 5
2025-01-20 13:42:00,024 [trainer.py] => num_users: 1
2025-01-20 13:42:00,024 [trainer.py] => cur_size: 5
2025-01-20 13:42:00,024 [trainer.py] => g_local_bs: 5
2025-01-20 13:42:00,024 [trainer.py] => local_bs0: 5
2025-01-20 13:42:00,024 [trainer.py] => local_bs1: 5
2025-01-20 13:42:00,024 [trainer.py] => pre_size: 48
2025-01-20 13:42:00,024 [trainer.py] => w_ce_pre: 0.5
2025-01-20 13:42:00,024 [trainer.py] => vpt_type: Deep
2025-01-20 13:42:00,024 [trainer.py] => prompt_token_num: 6
2025-01-20 13:42:00,024 [trainer.py] => avg_alpha: 0.8
2025-01-20 13:42:00,024 [trainer.py] => perturb_var: 1
2025-01-20 13:42:00,024 [trainer.py] => EMA_beta: 0.99
2025-01-20 13:42:00,024 [trainer.py] => anchor_lambda: 0.1
2025-01-20 13:42:00,024 [trainer.py] => kl_weight: 0.001
2025-01-20 13:42:00,024 [trainer.py] => TIP_init: zero
2025-01-20 13:42:00,024 [trainer.py] => tuned_epoch: 10
2025-01-20 13:42:00,024 [trainer.py] => fs_epoch: 0
2025-01-20 13:42:00,024 [trainer.py] => init_lr: 0.01
2025-01-20 13:42:00,024 [trainer.py] => fs_lr: 0.001
2025-01-20 13:42:00,024 [trainer.py] => batch_size: 48
2025-01-20 13:42:00,024 [trainer.py] => fs_batch_size: 16
2025-01-20 13:42:00,024 [trainer.py] => weight_decay: 0.0005
2025-01-20 13:42:00,024 [trainer.py] => min_lr: 0
2025-01-20 13:42:00,024 [trainer.py] => optimizer: sgd
2025-01-20 13:42:00,024 [trainer.py] => memory_size: 0
2025-01-20 13:42:00,025 [trainer.py] => memory_per_class: 0
2025-01-20 13:42:00,025 [trainer.py] => fixed_memory: False
2025-01-20 13:42:00,025 [trainer.py] => shuffle: False
2025-01-20 13:42:00,025 [trainer.py] => top_k: 5
2025-01-20 13:42:00,025 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-20 13:42:00,025 [trainer.py] => prefix: asp
2025-01-20 13:42:00,025 [trainer.py] => model_prefix: asp
2025-01-20 13:42:01,602 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-20 13:42:12,311 [trainer.py] => All params: 173596160
2025-01-20 13:42:12,312 [trainer.py] => Trainable params: 1998848
2025-01-20 13:42:29,456 [asp.py] => Learning on 0-5
2025-01-20 13:42:29,466 [asp.py] => training set size: 2500, fc construct set size: 2500
2025-01-20 13:45:20,338 [asp.py] => total parameters: 173630721
2025-01-20 13:45:20,339 [asp.py] => trainable parameters: 2033409
2025-01-20 13:45:44,074 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27]
2025-01-20 13:45:44,074 [trainer.py] => Average Accuracy (Top1): 83.92222222222222   (Harmonic Accuracy): 81.8881636336291 (Old Acc): 93.2 (New Acc): 73.025 

2025-01-20 13:45:44,075 [trainer.py] => All params: 173630721
2025-01-20 13:45:44,075 [trainer.py] => Trainable params: 2033409
2025-01-20 13:46:08,233 [asp.py] => Learning on 45-50
2025-01-20 13:46:08,251 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 13:55:51,936 [asp.py] => total parameters: 173615361
2025-01-20 13:55:51,937 [asp.py] => trainable parameters: 2018049
2025-01-20 13:56:05,629 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88]
2025-01-20 13:56:05,629 [trainer.py] => Average Accuracy (Top1): 93.41999999999999   (Harmonic Accuracy): 91.64481914604296 (Old Acc): 97.0 (New Acc): 86.85 

2025-01-20 13:56:05,630 [trainer.py] => All params: 173615361
2025-01-20 13:56:05,631 [trainer.py] => Trainable params: 2018049
2025-01-20 13:56:29,367 [asp.py] => Learning on 25-30
2025-01-20 13:56:29,382 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 14:02:55,765 [asp.py] => total parameters: 173634561
2025-01-20 14:02:55,766 [asp.py] => trainable parameters: 2037249
2025-01-20 14:03:22,321 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27, 72.82]
2025-01-20 14:03:22,321 [trainer.py] => Average Accuracy (Top1): 82.81199999999998   (Harmonic Accuracy): 80.31211833355951 (Old Acc): 93.2 (New Acc): 70.55555555555556 

2025-01-20 14:03:22,322 [trainer.py] => All params: 173634561
2025-01-20 14:03:22,323 [trainer.py] => Trainable params: 2037249
2025-01-20 14:03:42,667 [asp.py] => Learning on 50-55
2025-01-20 14:03:42,687 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 14:12:48,844 [asp.py] => total parameters: 173619201
2025-01-20 14:12:48,846 [asp.py] => trainable parameters: 2021889
2025-01-20 14:13:05,074 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77]
2025-01-20 14:13:05,075 [trainer.py] => Average Accuracy (Top1): 92.145   (Harmonic Accuracy): 89.69403415391439 (Old Acc): 96.8 (New Acc): 83.55999999999999 

2025-01-20 14:13:05,076 [trainer.py] => All params: 173619201
2025-01-20 14:13:05,076 [trainer.py] => Trainable params: 2021889
2025-01-20 14:13:25,349 [asp.py] => Learning on 30-35
2025-01-20 14:13:25,362 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 14:20:25,257 [asp.py] => total parameters: 173638401
2025-01-20 14:20:25,258 [asp.py] => trainable parameters: 2041089
2025-01-20 14:20:53,927 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27, 72.82, 72.96]
2025-01-20 14:20:53,928 [trainer.py] => Average Accuracy (Top1): 81.91636363636363   (Harmonic Accuracy): 80.37408312958435 (Old Acc): 92.6 (New Acc): 71.0 

2025-01-20 14:20:53,928 [trainer.py] => All params: 173638401
2025-01-20 14:20:53,929 [trainer.py] => Trainable params: 2041089
2025-01-20 14:21:12,374 [asp.py] => Learning on 55-60
2025-01-20 14:21:12,398 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 14:30:01,809 [asp.py] => total parameters: 173623041
2025-01-20 14:30:01,811 [asp.py] => trainable parameters: 2025729
2025-01-20 14:30:20,440 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4]
2025-01-20 14:30:20,441 [trainer.py] => Average Accuracy (Top1): 91.03857142857143   (Harmonic Accuracy): 88.85190156599552 (Old Acc): 96.4 (New Acc): 82.39999999999999 

2025-01-20 14:30:20,442 [trainer.py] => All params: 173623041
2025-01-20 14:30:20,442 [trainer.py] => Trainable params: 2025729
2025-01-20 14:30:41,111 [asp.py] => Learning on 35-40
2025-01-20 14:30:41,127 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 14:37:54,618 [asp.py] => total parameters: 173642241
2025-01-20 14:37:54,619 [asp.py] => trainable parameters: 2044929
2025-01-20 14:38:25,794 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27, 72.82, 72.96, 71.98]
2025-01-20 14:38:25,794 [trainer.py] => Average Accuracy (Top1): 81.08833333333332   (Harmonic Accuracy): 79.73750978856695 (Old Acc): 92.4 (New Acc): 70.12727272727273 

2025-01-20 14:38:25,795 [trainer.py] => All params: 173642241
2025-01-20 14:38:25,796 [trainer.py] => Trainable params: 2044929
2025-01-20 14:38:45,858 [asp.py] => Learning on 60-65
2025-01-20 14:38:45,879 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 14:47:03,695 [asp.py] => total parameters: 173626881
2025-01-20 14:47:03,696 [asp.py] => trainable parameters: 2029569
2025-01-20 14:47:24,740 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82]
2025-01-20 14:47:24,740 [trainer.py] => Average Accuracy (Top1): 90.01124999999999   (Harmonic Accuracy): 87.89753185997742 (Old Acc): 96.2 (New Acc): 80.91428571428571 

2025-01-20 14:47:24,741 [trainer.py] => All params: 173626881
2025-01-20 14:47:24,742 [trainer.py] => Trainable params: 2029569
2025-01-20 14:47:44,746 [asp.py] => Learning on 40-45
2025-01-20 14:47:44,764 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 14:55:27,728 [asp.py] => total parameters: 173646081
2025-01-20 14:55:27,729 [asp.py] => trainable parameters: 2048769
2025-01-20 14:56:01,252 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27, 72.82, 72.96, 71.98, 70.62]
2025-01-20 14:56:01,252 [trainer.py] => Average Accuracy (Top1): 80.2830769230769   (Harmonic Accuracy): 78.87245657568239 (Old Acc): 92.4 (New Acc): 68.80000000000001 

2025-01-20 14:56:01,253 [trainer.py] => All params: 173646081
2025-01-20 14:56:01,254 [trainer.py] => Trainable params: 2048769
2025-01-20 14:56:20,708 [asp.py] => Learning on 65-70
2025-01-20 14:56:20,731 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 15:04:13,860 [asp.py] => total parameters: 173630721
2025-01-20 15:04:13,862 [asp.py] => trainable parameters: 2033409
2025-01-20 15:04:37,498 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13]
2025-01-20 15:04:37,498 [trainer.py] => Average Accuracy (Top1): 89.13555555555554   (Harmonic Accuracy): 87.51020408163265 (Old Acc): 96.0 (New Acc): 80.4 

2025-01-20 15:04:37,499 [trainer.py] => All params: 173630721
2025-01-20 15:04:37,500 [trainer.py] => Trainable params: 2033409
2025-01-20 15:04:57,868 [asp.py] => Learning on 45-50
2025-01-20 15:04:57,886 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 15:13:02,718 [asp.py] => total parameters: 173649921
2025-01-20 15:13:02,719 [asp.py] => trainable parameters: 2052609
2025-01-20 15:13:39,282 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27, 72.82, 72.96, 71.98, 70.62, 69.86]
2025-01-20 15:13:39,284 [trainer.py] => Average Accuracy (Top1): 79.53857142857142   (Harmonic Accuracy): 78.42576193214494 (Old Acc): 92.4 (New Acc): 68.12307692307694 

2025-01-20 15:13:39,285 [trainer.py] => All params: 173649921
2025-01-20 15:13:39,285 [trainer.py] => Trainable params: 2052609
2025-01-20 15:13:59,584 [asp.py] => Learning on 70-75
2025-01-20 15:13:59,609 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 15:21:31,835 [asp.py] => total parameters: 173634561
2025-01-20 15:21:31,836 [asp.py] => trainable parameters: 2037249
2025-01-20 15:21:57,530 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26]
2025-01-20 15:21:57,530 [trainer.py] => Average Accuracy (Top1): 88.24799999999999   (Harmonic Accuracy): 86.37921813319751 (Old Acc): 96.0 (New Acc): 78.51111111111112 

2025-01-20 15:21:57,531 [trainer.py] => All params: 173634561
2025-01-20 15:21:57,531 [trainer.py] => Trainable params: 2037249
2025-01-20 15:22:16,975 [asp.py] => Learning on 50-55
2025-01-20 15:22:16,994 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 15:30:40,983 [asp.py] => total parameters: 173653761
2025-01-20 15:30:40,984 [asp.py] => trainable parameters: 2056449
2025-01-20 15:31:19,221 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27, 72.82, 72.96, 71.98, 70.62, 69.86, 67.69]
2025-01-20 15:31:19,222 [trainer.py] => Average Accuracy (Top1): 78.74866666666665   (Harmonic Accuracy): 76.89163504968383 (Old Acc): 92.2 (New Acc): 65.94285714285714 

2025-01-20 15:31:19,223 [trainer.py] => All params: 173653761
2025-01-20 15:31:19,223 [trainer.py] => Trainable params: 2056449
2025-01-20 15:31:39,651 [asp.py] => Learning on 75-80
2025-01-20 15:31:39,677 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 15:38:50,712 [asp.py] => total parameters: 173638401
2025-01-20 15:38:50,713 [asp.py] => trainable parameters: 2041089
2025-01-20 15:39:19,067 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87]
2025-01-20 15:39:19,067 [trainer.py] => Average Accuracy (Top1): 87.48636363636363   (Harmonic Accuracy): 86.08947671075329 (Old Acc): 95.6 (New Acc): 78.29999999999998 

2025-01-20 15:39:19,068 [trainer.py] => All params: 173638401
2025-01-20 15:39:19,069 [trainer.py] => Trainable params: 2041089
2025-01-20 15:39:39,295 [asp.py] => Learning on 55-60
2025-01-20 15:39:39,316 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 15:48:23,823 [asp.py] => total parameters: 173657601
2025-01-20 15:48:23,824 [asp.py] => trainable parameters: 2060289
2025-01-20 15:49:04,724 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27, 72.82, 72.96, 71.98, 70.62, 69.86, 67.69, 67.82]
2025-01-20 15:49:04,724 [trainer.py] => Average Accuracy (Top1): 78.06562499999998   (Harmonic Accuracy): 77.06616161616162 (Old Acc): 92.2 (New Acc): 66.19999999999999 

2025-01-20 15:49:04,725 [trainer.py] => All params: 173657601
2025-01-20 15:49:04,726 [trainer.py] => Trainable params: 2060289
2025-01-20 15:49:24,909 [asp.py] => Learning on 80-85
2025-01-20 15:49:24,934 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 15:56:15,434 [asp.py] => total parameters: 173642241
2025-01-20 15:56:15,436 [asp.py] => trainable parameters: 2044929
2025-01-20 15:56:45,964 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88]
2025-01-20 15:56:45,965 [trainer.py] => Average Accuracy (Top1): 86.76916666666666   (Harmonic Accuracy): 85.38215527230591 (Old Acc): 95.2 (New Acc): 77.39999999999999 

2025-01-20 15:56:45,965 [trainer.py] => All params: 173642241
2025-01-20 15:56:45,966 [trainer.py] => Trainable params: 2044929
2025-01-20 15:57:06,345 [asp.py] => Learning on 60-65
2025-01-20 15:57:06,370 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 16:06:10,157 [asp.py] => total parameters: 173661441
2025-01-20 16:06:10,157 [asp.py] => trainable parameters: 2064129
2025-01-20 16:06:54,002 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27, 72.82, 72.96, 71.98, 70.62, 69.86, 67.69, 67.82, 68.14]
2025-01-20 16:06:54,002 [trainer.py] => Average Accuracy (Top1): 77.48176470588234   (Harmonic Accuracy): 77.3618005823562 (Old Acc): 92.2 (New Acc): 66.6375 

2025-01-20 16:06:54,003 [trainer.py] => All params: 173661441
2025-01-20 16:06:54,004 [trainer.py] => Trainable params: 2064129
2025-01-20 16:07:20,327 [asp.py] => Learning on 85-90
2025-01-20 16:07:20,353 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 16:13:28,143 [asp.py] => total parameters: 173646081
2025-01-20 16:13:28,144 [asp.py] => trainable parameters: 2048769
2025-01-20 16:14:01,159 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22]
2025-01-20 16:14:01,160 [trainer.py] => Average Accuracy (Top1): 86.03461538461539   (Harmonic Accuracy): 84.34784982935155 (Old Acc): 95.2 (New Acc): 75.71666666666668 

2025-01-20 16:14:01,162 [trainer.py] => All params: 173646081
2025-01-20 16:14:01,162 [trainer.py] => Trainable params: 2048769
2025-01-20 16:14:21,936 [asp.py] => Learning on 65-70
2025-01-20 16:14:21,959 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 16:24:06,218 [asp.py] => total parameters: 173665281
2025-01-20 16:24:06,219 [asp.py] => trainable parameters: 2067969
2025-01-20 16:24:53,086 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27, 72.82, 72.96, 71.98, 70.62, 69.86, 67.69, 67.82, 68.14, 68.76]
2025-01-20 16:24:53,087 [trainer.py] => Average Accuracy (Top1): 76.9972222222222   (Harmonic Accuracy): 77.85747567089355 (Old Acc): 92.2 (New Acc): 67.3764705882353 

2025-01-20 16:24:53,088 [trainer.py] => All params: 173665281
2025-01-20 16:24:53,088 [trainer.py] => Trainable params: 2067969
2025-01-20 16:25:15,773 [asp.py] => Learning on 90-95
2025-01-20 16:25:15,815 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 16:30:25,419 [asp.py] => total parameters: 173649921
2025-01-20 16:30:25,420 [asp.py] => trainable parameters: 2052609
2025-01-20 16:31:13,844 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57]
2025-01-20 16:31:13,844 [trainer.py] => Average Accuracy (Top1): 85.35857142857142   (Harmonic Accuracy): 83.9878612716763 (Old Acc): 95.2 (New Acc): 75.13846153846153 

2025-01-20 16:31:13,845 [trainer.py] => All params: 173649921
2025-01-20 16:31:13,847 [trainer.py] => Trainable params: 2052609
2025-01-20 16:31:58,808 [asp.py] => Learning on 70-75
2025-01-20 16:31:58,858 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 16:42:06,190 [asp.py] => total parameters: 173669121
2025-01-20 16:42:06,191 [asp.py] => trainable parameters: 2071809
2025-01-20 16:42:55,390 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27, 72.82, 72.96, 71.98, 70.62, 69.86, 67.69, 67.82, 68.14, 68.76, 67.84]
2025-01-20 16:42:55,392 [trainer.py] => Average Accuracy (Top1): 76.51526315789472   (Harmonic Accuracy): 77.26156000560145 (Old Acc): 92.2 (New Acc): 66.48888888888888 

2025-01-20 16:42:55,394 [trainer.py] => All params: 173669121
2025-01-20 16:42:55,396 [trainer.py] => Trainable params: 2071809
2025-01-20 16:43:17,594 [asp.py] => Learning on 95-100
2025-01-20 16:43:17,634 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 16:48:07,049 [asp.py] => total parameters: 173653761
2025-01-20 16:48:07,050 [asp.py] => trainable parameters: 2056449
2025-01-20 16:48:44,369 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72]
2025-01-20 16:48:44,370 [trainer.py] => Average Accuracy (Top1): 84.64933333333333   (Harmonic Accuracy): 82.46415963161934 (Old Acc): 94.2 (New Acc): 73.32857142857142 

2025-01-20 16:48:44,371 [trainer.py] => All params: 173653761
2025-01-20 16:48:44,372 [trainer.py] => Trainable params: 2056449
2025-01-20 16:49:06,541 [asp.py] => Learning on 75-80
2025-01-20 16:49:06,566 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 17:00:06,460 [asp.py] => total parameters: 173672961
2025-01-20 17:00:06,461 [asp.py] => trainable parameters: 2075649
2025-01-20 17:01:08,516 [trainer.py] => Top1 curve: [98.6, 94.8, 87.67, 83.15, 83.36, 79.0, 77.17, 76.28, 75.27, 72.82, 72.96, 71.98, 70.62, 69.86, 67.69, 67.82, 68.14, 68.76, 67.84, 66.85]
2025-01-20 17:01:08,516 [trainer.py] => Average Accuracy (Top1): 76.03199999999998   (Harmonic Accuracy): 76.66224918338776 (Old Acc): 92.4 (New Acc): 65.50526315789473 

2025-01-20 17:01:08,516 [trainer.py] => 

2025-01-20 17:05:15,569 [asp.py] => total parameters: 173657601
2025-01-20 17:05:15,571 [asp.py] => trainable parameters: 2060289
2025-01-20 17:06:02,980 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72, 74.91]
2025-01-20 17:06:02,981 [trainer.py] => Average Accuracy (Top1): 84.040625   (Harmonic Accuracy): 82.65232382616986 (Old Acc): 94.2 (New Acc): 73.62666666666668 

2025-01-20 17:06:02,983 [trainer.py] => All params: 173657601
2025-01-20 17:06:02,984 [trainer.py] => Trainable params: 2060289
2025-01-20 17:06:31,919 [asp.py] => Learning on 80-85
2025-01-20 17:06:31,985 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 17:22:46,667 [asp.py] => total parameters: 173661441
2025-01-20 17:22:46,668 [asp.py] => trainable parameters: 2064129
2025-01-20 17:23:29,960 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72, 74.91, 74.98]
2025-01-20 17:23:29,960 [trainer.py] => Average Accuracy (Top1): 83.50764705882354   (Harmonic Accuracy): 82.7457062062807 (Old Acc): 94.2 (New Acc): 73.77499999999999 

2025-01-20 17:23:29,961 [trainer.py] => All params: 173661441
2025-01-20 17:23:29,962 [trainer.py] => Trainable params: 2064129
2025-01-20 17:23:51,456 [asp.py] => Learning on 85-90
2025-01-20 17:23:51,485 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 17:40:03,527 [asp.py] => total parameters: 173665281
2025-01-20 17:40:03,528 [asp.py] => trainable parameters: 2067969
2025-01-20 17:40:48,676 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72, 74.91, 74.98, 75.38]
2025-01-20 17:40:48,677 [trainer.py] => Average Accuracy (Top1): 83.05611111111112   (Harmonic Accuracy): 83.05650837988827 (Old Acc): 94.2 (New Acc): 74.27058823529411 

2025-01-20 17:40:48,678 [trainer.py] => All params: 173665281
2025-01-20 17:40:48,679 [trainer.py] => Trainable params: 2067969
2025-01-20 17:41:10,939 [asp.py] => Learning on 90-95
2025-01-20 17:41:10,985 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 17:57:22,118 [asp.py] => total parameters: 173669121
2025-01-20 17:57:22,119 [asp.py] => trainable parameters: 2071809
2025-01-20 17:58:09,255 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72, 74.91, 74.98, 75.38, 74.19]
2025-01-20 17:58:09,256 [trainer.py] => Average Accuracy (Top1): 82.58947368421055   (Harmonic Accuracy): 82.3053337761541 (Old Acc): 94.2 (New Acc): 73.07777777777777 

2025-01-20 17:58:09,257 [trainer.py] => All params: 173669121
2025-01-20 17:58:09,258 [trainer.py] => Trainable params: 2071809
2025-01-20 17:58:29,707 [asp.py] => Learning on 95-100
2025-01-20 17:58:29,742 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-20 18:14:46,536 [asp.py] => total parameters: 173672961
2025-01-20 18:14:46,544 [asp.py] => trainable parameters: 2075649
2025-01-20 18:15:44,465 [trainer.py] => Top1 curve: [99.6, 97.7, 91.47, 89.45, 88.88, 85.77, 84.4, 82.82, 82.13, 80.26, 79.87, 78.88, 77.22, 76.57, 74.72, 74.91, 74.98, 75.38, 74.19, 73.1]
2025-01-20 18:15:44,466 [trainer.py] => Average Accuracy (Top1): 82.11500000000001   (Harmonic Accuracy): 81.61056498606537 (Old Acc): 94.2 (New Acc): 71.98947368421052 

2025-01-20 18:15:44,467 [trainer.py] => 

2025-03-10 10:39:58,364 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-03-10 10:39:58,364 [trainer.py] => model_name: asp
2025-03-10 10:39:58,364 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-03-10 10:39:58,364 [trainer.py] => device: ['cuda']
2025-03-10 10:39:58,364 [trainer.py] => seed: 2024
2025-03-10 10:39:58,364 [trainer.py] => dataset: cifar224
2025-03-10 10:39:58,364 [trainer.py] => init_cls: 5
2025-03-10 10:39:58,364 [trainer.py] => increment: 5
2025-03-10 10:39:58,364 [trainer.py] => kshot: 5
2025-03-10 10:39:58,365 [trainer.py] => generator_model: CIFAR_GEN
2025-03-10 10:39:58,365 [trainer.py] => z_dim: 1000
2025-03-10 10:39:58,365 [trainer.py] => conv_dim: 64
2025-03-10 10:39:58,365 [trainer.py] => img_size: 224
2025-03-10 10:39:58,365 [trainer.py] => generator_lr: 0.005
2025-03-10 10:39:58,365 [trainer.py] => pi: 100
2025-03-10 10:39:58,365 [trainer.py] => w_bn: 50.0
2025-03-10 10:39:58,365 [trainer.py] => w_noise: 0.001
2025-03-10 10:39:58,365 [trainer.py] => server_ss: 32
2025-03-10 10:39:58,365 [trainer.py] => bn_loss: 1
2025-03-10 10:39:58,365 [trainer.py] => noise: 1
2025-03-10 10:39:58,365 [trainer.py] => ie_loss: 1
2025-03-10 10:39:58,365 [trainer.py] => act_loss: 0
2025-03-10 10:39:58,365 [trainer.py] => w_ie: 1.0
2025-03-10 10:39:58,365 [trainer.py] => w_act: 0.1
2025-03-10 10:39:58,365 [trainer.py] => syn_size: 32
2025-03-10 10:39:58,365 [trainer.py] => need_syn_imgs: false
2025-03-10 10:39:58,365 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-03-10 10:39:58,365 [trainer.py] => g_local_train_steps: 5
2025-03-10 10:39:58,365 [trainer.py] => dataset_syn: cifar100
2025-03-10 10:39:58,365 [trainer.py] => com_round_gen: 20
2025-03-10 10:39:58,365 [trainer.py] => g_sigma: 0
2025-03-10 10:39:58,365 [trainer.py] => save_cls_embeds: False
2025-03-10 10:39:58,365 [trainer.py] => syn_image_path: outputs/syn_image_5_5_pre0.5_shot20_bs5
2025-03-10 10:39:58,365 [trainer.py] => save_dir: outputs
2025-03-10 10:39:58,365 [trainer.py] => n_iter: 5
2025-03-10 10:39:58,365 [trainer.py] => num_users: 1
2025-03-10 10:39:58,365 [trainer.py] => cur_size: 5
2025-03-10 10:39:58,365 [trainer.py] => g_local_bs: 5
2025-03-10 10:39:58,365 [trainer.py] => local_bs0: 5
2025-03-10 10:39:58,365 [trainer.py] => local_bs1: 5
2025-03-10 10:39:58,365 [trainer.py] => pre_size: 48
2025-03-10 10:39:58,365 [trainer.py] => w_ce_pre: 0.5
2025-03-10 10:39:58,365 [trainer.py] => vpt_type: Deep
2025-03-10 10:39:58,365 [trainer.py] => prompt_token_num: 6
2025-03-10 10:39:58,366 [trainer.py] => avg_alpha: 0.8
2025-03-10 10:39:58,366 [trainer.py] => perturb_var: 1
2025-03-10 10:39:58,366 [trainer.py] => EMA_beta: 0.99
2025-03-10 10:39:58,366 [trainer.py] => anchor_lambda: 0.1
2025-03-10 10:39:58,366 [trainer.py] => kl_weight: 0.001
2025-03-10 10:39:58,366 [trainer.py] => TIP_init: zero
2025-03-10 10:39:58,366 [trainer.py] => tuned_epoch: 10
2025-03-10 10:39:58,366 [trainer.py] => fs_epoch: 0
2025-03-10 10:39:58,366 [trainer.py] => init_lr: 0.01
2025-03-10 10:39:58,366 [trainer.py] => fs_lr: 0.001
2025-03-10 10:39:58,366 [trainer.py] => batch_size: 48
2025-03-10 10:39:58,366 [trainer.py] => fs_batch_size: 16
2025-03-10 10:39:58,366 [trainer.py] => weight_decay: 0.0005
2025-03-10 10:39:58,366 [trainer.py] => min_lr: 0
2025-03-10 10:39:58,366 [trainer.py] => optimizer: sgd
2025-03-10 10:39:58,366 [trainer.py] => memory_size: 0
2025-03-10 10:39:58,366 [trainer.py] => memory_per_class: 0
2025-03-10 10:39:58,366 [trainer.py] => fixed_memory: False
2025-03-10 10:39:58,366 [trainer.py] => shuffle: False
2025-03-10 10:39:58,366 [trainer.py] => top_k: 5
2025-03-10 10:39:58,366 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-03-10 10:39:58,366 [trainer.py] => prefix: asp
2025-03-10 10:39:58,366 [trainer.py] => model_prefix: asp
2025-03-10 10:40:00,498 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-03-10 10:40:48,230 [trainer.py] => All params: 173596160
2025-03-10 10:40:48,232 [trainer.py] => Trainable params: 1998848
2025-03-10 10:41:31,457 [asp.py] => Learning on 0-5
2025-03-10 10:41:31,463 [asp.py] => training set size: 2500, fc construct set size: 2500
