2024-12-26 16:22:53,303 [trainer.py] => config: ./exps/cifar.json
2024-12-26 16:22:53,304 [trainer.py] => model_name: asp
2024-12-26 16:22:53,304 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-26 16:22:53,304 [trainer.py] => device: [device(type='cuda', index=0)]
2024-12-26 16:22:53,304 [trainer.py] => seed: 2024
2024-12-26 16:22:53,304 [trainer.py] => dataset: cifar224
2024-12-26 16:22:53,304 [trainer.py] => init_cls: 60
2024-12-26 16:22:53,304 [trainer.py] => increment: 5
2024-12-26 16:22:53,304 [trainer.py] => kshot: 5
2024-12-26 16:22:53,304 [trainer.py] => vpt_type: Deep
2024-12-26 16:22:53,304 [trainer.py] => prompt_token_num: 6
2024-12-26 16:22:53,304 [trainer.py] => avg_alpha: 0.8
2024-12-26 16:22:53,304 [trainer.py] => perturb_var: 1
2024-12-26 16:22:53,304 [trainer.py] => EMA_beta: 0.99
2024-12-26 16:22:53,304 [trainer.py] => anchor_lambda: 0.1
2024-12-26 16:22:53,304 [trainer.py] => kl_weight: 0.001
2024-12-26 16:22:53,304 [trainer.py] => TIP_init: zero
2024-12-26 16:22:53,304 [trainer.py] => tuned_epoch: 20
2024-12-26 16:22:53,304 [trainer.py] => fs_epoch: 0
2024-12-26 16:22:53,304 [trainer.py] => init_lr: 0.01
2024-12-26 16:22:53,304 [trainer.py] => fs_lr: 0.001
2024-12-26 16:22:53,304 [trainer.py] => batch_size: 48
2024-12-26 16:22:53,304 [trainer.py] => fs_batch_size: 16
2024-12-26 16:22:53,304 [trainer.py] => weight_decay: 0.0005
2024-12-26 16:22:53,304 [trainer.py] => min_lr: 0
2024-12-26 16:22:53,304 [trainer.py] => optimizer: sgd
2024-12-26 16:22:53,304 [trainer.py] => memory_size: 0
2024-12-26 16:22:53,304 [trainer.py] => memory_per_class: 0
2024-12-26 16:22:53,304 [trainer.py] => fixed_memory: False
2024-12-26 16:22:53,304 [trainer.py] => shuffle: False
2024-12-26 16:22:53,304 [trainer.py] => top_k: 5
2024-12-26 16:22:53,304 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-26 16:22:53,304 [trainer.py] => prefix: asp
2024-12-26 16:22:53,305 [trainer.py] => model_prefix: asp
2024-12-26 16:23:12,562 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-26 16:23:39,003 [trainer.py] => config: ./exps/cifar.json
2024-12-26 16:23:39,003 [trainer.py] => model_name: asp
2024-12-26 16:23:39,003 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-26 16:23:39,003 [trainer.py] => device: [device(type='cuda', index=0)]
2024-12-26 16:23:39,003 [trainer.py] => seed: 2024
2024-12-26 16:23:39,003 [trainer.py] => dataset: cifar224
2024-12-26 16:23:39,003 [trainer.py] => init_cls: 60
2024-12-26 16:23:39,003 [trainer.py] => increment: 5
2024-12-26 16:23:39,003 [trainer.py] => kshot: 5
2024-12-26 16:23:39,003 [trainer.py] => vpt_type: Deep
2024-12-26 16:23:39,003 [trainer.py] => prompt_token_num: 6
2024-12-26 16:23:39,003 [trainer.py] => avg_alpha: 0.8
2024-12-26 16:23:39,003 [trainer.py] => perturb_var: 1
2024-12-26 16:23:39,003 [trainer.py] => EMA_beta: 0.99
2024-12-26 16:23:39,003 [trainer.py] => anchor_lambda: 0.1
2024-12-26 16:23:39,003 [trainer.py] => kl_weight: 0.001
2024-12-26 16:23:39,003 [trainer.py] => TIP_init: zero
2024-12-26 16:23:39,003 [trainer.py] => tuned_epoch: 20
2024-12-26 16:23:39,003 [trainer.py] => fs_epoch: 0
2024-12-26 16:23:39,003 [trainer.py] => init_lr: 0.01
2024-12-26 16:23:39,003 [trainer.py] => fs_lr: 0.001
2024-12-26 16:23:39,003 [trainer.py] => batch_size: 48
2024-12-26 16:23:39,003 [trainer.py] => fs_batch_size: 16
2024-12-26 16:23:39,003 [trainer.py] => weight_decay: 0.0005
2024-12-26 16:23:39,004 [trainer.py] => min_lr: 0
2024-12-26 16:23:39,004 [trainer.py] => optimizer: sgd
2024-12-26 16:23:39,004 [trainer.py] => memory_size: 0
2024-12-26 16:23:39,004 [trainer.py] => memory_per_class: 0
2024-12-26 16:23:39,004 [trainer.py] => fixed_memory: False
2024-12-26 16:23:39,004 [trainer.py] => shuffle: False
2024-12-26 16:23:39,004 [trainer.py] => top_k: 5
2024-12-26 16:23:39,004 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-26 16:23:39,004 [trainer.py] => prefix: asp
2024-12-26 16:23:39,004 [trainer.py] => model_prefix: asp
2024-12-26 16:23:40,528 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-26 16:23:42,421 [hub.py] => Downloading: "https://storage.googleapis.com/vit_models/augreg/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0--imagenet2012-steps_20k-lr_0.01-res_224.npz" to /mnt/share/yinjunhui/.cache/torch/hub/checkpoints/B_16-i21k-300ep-lr_0.001-aug_medium1-wd_0.1-do_0.0-sd_0.0--imagenet2012-steps_20k-lr_0.01-res_224.npz

2024-12-26 16:24:16,151 [trainer.py] => All params: 173596160
2024-12-26 16:24:16,152 [trainer.py] => Trainable params: 1998848
2024-12-26 16:24:16,815 [asp.py] => Learning on 0-60
2024-12-26 16:24:16,904 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-26 16:24:17,445 [asp.py] => total parameters: 173642241
2024-12-26 16:24:17,446 [asp.py] => trainable parameters: 2044929
2024-12-26 16:24:47,564 [trainer.py] => config: ./exps/cifar.json
2024-12-26 16:24:47,565 [trainer.py] => model_name: asp
2024-12-26 16:24:47,565 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-26 16:24:47,565 [trainer.py] => device: [device(type='cuda', index=0)]
2024-12-26 16:24:47,565 [trainer.py] => seed: 2024
2024-12-26 16:24:47,565 [trainer.py] => dataset: cifar224
2024-12-26 16:24:47,565 [trainer.py] => init_cls: 60
2024-12-26 16:24:47,565 [trainer.py] => increment: 5
2024-12-26 16:24:47,565 [trainer.py] => kshot: 5
2024-12-26 16:24:47,565 [trainer.py] => vpt_type: Deep
2024-12-26 16:24:47,565 [trainer.py] => prompt_token_num: 6
2024-12-26 16:24:47,565 [trainer.py] => avg_alpha: 0.8
2024-12-26 16:24:47,565 [trainer.py] => perturb_var: 1
2024-12-26 16:24:47,565 [trainer.py] => EMA_beta: 0.99
2024-12-26 16:24:47,565 [trainer.py] => anchor_lambda: 0.1
2024-12-26 16:24:47,565 [trainer.py] => kl_weight: 0.001
2024-12-26 16:24:47,565 [trainer.py] => TIP_init: zero
2024-12-26 16:24:47,565 [trainer.py] => tuned_epoch: 20
2024-12-26 16:24:47,565 [trainer.py] => fs_epoch: 0
2024-12-26 16:24:47,565 [trainer.py] => init_lr: 0.01
2024-12-26 16:24:47,565 [trainer.py] => fs_lr: 0.001
2024-12-26 16:24:47,565 [trainer.py] => batch_size: 48
2024-12-26 16:24:47,565 [trainer.py] => fs_batch_size: 16
2024-12-26 16:24:47,565 [trainer.py] => weight_decay: 0.0005
2024-12-26 16:24:47,565 [trainer.py] => min_lr: 0
2024-12-26 16:24:47,565 [trainer.py] => optimizer: sgd
2024-12-26 16:24:47,565 [trainer.py] => memory_size: 0
2024-12-26 16:24:47,565 [trainer.py] => memory_per_class: 0
2024-12-26 16:24:47,565 [trainer.py] => fixed_memory: False
2024-12-26 16:24:47,565 [trainer.py] => shuffle: False
2024-12-26 16:24:47,566 [trainer.py] => top_k: 5
2024-12-26 16:24:47,566 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-26 16:24:47,566 [trainer.py] => prefix: asp
2024-12-26 16:24:47,566 [trainer.py] => model_prefix: asp
2024-12-26 16:24:49,284 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-26 16:24:54,042 [trainer.py] => All params: 173596160
2024-12-26 16:24:54,043 [trainer.py] => Trainable params: 1998848
2024-12-26 16:24:54,692 [asp.py] => Learning on 0-60
2024-12-26 16:24:54,790 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-26 16:24:55,347 [asp.py] => total parameters: 173642241
2024-12-26 16:24:55,347 [asp.py] => trainable parameters: 2044929
2024-12-26 16:52:20,918 [asp.py] => Task 0, Epoch 1 => Loss 3.342, Train_accy 39.41, Test_curr_accy 89.22, Test_accy 89.22
2024-12-26 17:02:18,257 [trainer.py] => config: ./exps/cifar.json
2024-12-26 17:02:18,257 [trainer.py] => model_name: asp
2024-12-26 17:02:18,257 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-26 17:02:18,257 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-26 17:02:18,257 [trainer.py] => seed: 2024
2024-12-26 17:02:18,257 [trainer.py] => dataset: cifar224
2024-12-26 17:02:18,257 [trainer.py] => init_cls: 60
2024-12-26 17:02:18,257 [trainer.py] => increment: 5
2024-12-26 17:02:18,257 [trainer.py] => kshot: 5
2024-12-26 17:02:18,257 [trainer.py] => vpt_type: Deep
2024-12-26 17:02:18,257 [trainer.py] => prompt_token_num: 6
2024-12-26 17:02:18,258 [trainer.py] => avg_alpha: 0.8
2024-12-26 17:02:18,258 [trainer.py] => perturb_var: 1
2024-12-26 17:02:18,258 [trainer.py] => EMA_beta: 0.99
2024-12-26 17:02:18,258 [trainer.py] => anchor_lambda: 0.1
2024-12-26 17:02:18,258 [trainer.py] => kl_weight: 0.001
2024-12-26 17:02:18,258 [trainer.py] => TIP_init: zero
2024-12-26 17:02:18,258 [trainer.py] => tuned_epoch: 20
2024-12-26 17:02:18,258 [trainer.py] => fs_epoch: 0
2024-12-26 17:02:18,258 [trainer.py] => init_lr: 0.01
2024-12-26 17:02:18,258 [trainer.py] => fs_lr: 0.001
2024-12-26 17:02:18,258 [trainer.py] => batch_size: 48
2024-12-26 17:02:18,258 [trainer.py] => fs_batch_size: 16
2024-12-26 17:02:18,258 [trainer.py] => weight_decay: 0.0005
2024-12-26 17:02:18,258 [trainer.py] => min_lr: 0
2024-12-26 17:02:18,258 [trainer.py] => optimizer: sgd
2024-12-26 17:02:18,258 [trainer.py] => memory_size: 0
2024-12-26 17:02:18,258 [trainer.py] => memory_per_class: 0
2024-12-26 17:02:18,258 [trainer.py] => fixed_memory: False
2024-12-26 17:02:18,258 [trainer.py] => shuffle: False
2024-12-26 17:02:18,258 [trainer.py] => top_k: 5
2024-12-26 17:02:18,258 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-26 17:02:18,258 [trainer.py] => prefix: asp
2024-12-26 17:02:18,258 [trainer.py] => model_prefix: asp
2024-12-26 17:02:19,765 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-26 17:02:25,068 [trainer.py] => All params: 173596160
2024-12-26 17:02:25,069 [trainer.py] => Trainable params: 1998848
2024-12-26 17:02:25,644 [asp.py] => Learning on 0-60
2024-12-26 17:02:25,729 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-26 17:02:25,818 [asp.py] => total parameters: 173642241
2024-12-26 17:02:25,819 [asp.py] => trainable parameters: 2044929
2024-12-26 17:14:14,965 [asp.py] => Task 0, Epoch 1 => Loss 3.361, Train_accy 38.75, Test_curr_accy 89.63, Test_accy 89.63
2024-12-26 17:26:30,119 [asp.py] => Task 0, Epoch 2 => Loss 1.013, Train_accy 77.84, Test_curr_accy 91.67, Test_accy 91.67
2024-12-26 17:38:46,248 [asp.py] => Task 0, Epoch 3 => Loss 0.869, Train_accy 79.99, Test_curr_accy 92.37, Test_accy 92.37
2024-12-26 17:51:02,669 [asp.py] => Task 0, Epoch 4 => Loss 0.825, Train_accy 80.52, Test_curr_accy 92.40, Test_accy 92.40
2024-12-26 18:03:18,776 [asp.py] => Task 0, Epoch 5 => Loss 0.769, Train_accy 81.63, Test_curr_accy 92.10, Test_accy 92.10
2024-12-26 18:15:35,178 [asp.py] => Task 0, Epoch 6 => Loss 0.752, Train_accy 81.84, Test_curr_accy 92.30, Test_accy 92.30
2024-12-26 18:27:51,430 [asp.py] => Task 0, Epoch 7 => Loss 0.744, Train_accy 81.99, Test_curr_accy 92.35, Test_accy 92.35
2024-12-26 18:40:08,224 [asp.py] => Task 0, Epoch 8 => Loss 0.724, Train_accy 82.33, Test_curr_accy 92.67, Test_accy 92.67
2024-12-26 18:52:26,644 [asp.py] => Task 0, Epoch 9 => Loss 0.727, Train_accy 82.19, Test_curr_accy 92.75, Test_accy 92.75
2024-12-26 19:04:44,179 [asp.py] => Task 0, Epoch 10 => Loss 0.698, Train_accy 82.99, Test_curr_accy 92.88, Test_accy 92.88
2024-12-26 19:16:49,618 [asp.py] => Task 0, Epoch 11 => Loss 0.696, Train_accy 83.11, Test_curr_accy 93.12, Test_accy 93.12
2024-12-26 19:28:51,570 [asp.py] => Task 0, Epoch 12 => Loss 0.694, Train_accy 83.00, Test_curr_accy 93.17, Test_accy 93.17
2024-12-26 19:40:53,451 [asp.py] => Task 0, Epoch 13 => Loss 0.688, Train_accy 83.11, Test_curr_accy 93.12, Test_accy 93.12
2024-12-26 19:52:53,024 [asp.py] => Task 0, Epoch 14 => Loss 0.673, Train_accy 83.28, Test_curr_accy 92.88, Test_accy 92.88
2024-12-26 20:04:50,976 [asp.py] => Task 0, Epoch 15 => Loss 0.673, Train_accy 83.42, Test_curr_accy 93.12, Test_accy 93.12
2024-12-26 20:16:50,611 [asp.py] => Task 0, Epoch 16 => Loss 0.665, Train_accy 83.54, Test_curr_accy 93.28, Test_accy 93.28
2024-12-26 20:28:48,247 [asp.py] => Task 0, Epoch 17 => Loss 0.665, Train_accy 83.64, Test_curr_accy 93.25, Test_accy 93.25
2024-12-26 20:40:47,467 [asp.py] => Task 0, Epoch 18 => Loss 0.658, Train_accy 83.74, Test_curr_accy 93.20, Test_accy 93.20
2024-12-26 20:52:44,594 [asp.py] => Task 0, Epoch 19 => Loss 0.665, Train_accy 83.66, Test_curr_accy 93.13, Test_accy 93.13
2024-12-26 21:04:48,684 [asp.py] => Task 0, Epoch 20 => Loss 0.654, Train_accy 83.90, Test_curr_accy 93.30, Test_accy 93.30
2024-12-26 21:09:14,348 [trainer.py] => Top1 curve: [91.82]
2024-12-26 21:09:14,348 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-26 21:09:14,350 [trainer.py] => All params: 173642241
2024-12-26 21:09:14,351 [trainer.py] => Trainable params: 2044929
2024-12-26 21:09:14,352 [asp.py] => Learning on 60-65
2024-12-26 21:09:14,375 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-26 21:09:14,379 [asp.py] => total parameters: 173646081
2024-12-26 21:09:14,380 [asp.py] => trainable parameters: 2048769
2024-12-26 21:09:50,802 [trainer.py] => Top1 curve: [91.82, 90.09]
2024-12-26 21:09:50,802 [trainer.py] => Average Accuracy (Top1): 90.955   (Harmonic Accuracy): 81.21629014284267 (Old Acc): 91.51666666666667 (New Acc): 73.0 

2024-12-26 21:09:50,803 [trainer.py] => All params: 173646081
2024-12-26 21:09:50,804 [trainer.py] => Trainable params: 2048769
2024-12-26 21:09:50,806 [asp.py] => Learning on 65-70
2024-12-26 21:09:50,832 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-26 21:09:50,837 [asp.py] => total parameters: 173649921
2024-12-26 21:09:50,837 [asp.py] => trainable parameters: 2052609
2024-12-26 21:10:38,631 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5]
2024-12-26 21:10:38,635 [trainer.py] => Average Accuracy (Top1): 90.46999999999998   (Harmonic Accuracy): 84.12586614173229 (Old Acc): 91.43333333333334 (New Acc): 77.9 

2024-12-26 21:10:38,638 [trainer.py] => All params: 173649921
2024-12-26 21:10:38,639 [trainer.py] => Trainable params: 2052609
2024-12-26 21:10:38,640 [asp.py] => Learning on 70-75
2024-12-26 21:10:38,677 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-26 21:10:38,682 [asp.py] => total parameters: 173653761
2024-12-26 21:10:38,682 [asp.py] => trainable parameters: 2056449
2024-12-26 21:11:18,201 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29]
2024-12-26 21:11:18,201 [trainer.py] => Average Accuracy (Top1): 89.925   (Harmonic Accuracy): 83.33658891645989 (Old Acc): 91.18333333333334 (New Acc): 76.73333333333333 

2024-12-26 21:11:18,202 [trainer.py] => All params: 173653761
2024-12-26 21:11:18,203 [trainer.py] => Trainable params: 2056449
2024-12-26 21:11:18,205 [asp.py] => Learning on 75-80
2024-12-26 21:11:18,230 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-26 21:11:18,233 [asp.py] => total parameters: 173657601
2024-12-26 21:11:18,234 [asp.py] => trainable parameters: 2060289
2024-12-26 21:11:59,686 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32]
2024-12-26 21:11:59,686 [trainer.py] => Average Accuracy (Top1): 89.604   (Harmonic Accuracy): 85.14776846618592 (Old Acc): 91.13333333333334 (New Acc): 79.9 

2024-12-26 21:11:59,687 [trainer.py] => All params: 173657601
2024-12-26 21:11:59,688 [trainer.py] => Trainable params: 2060289
2024-12-26 21:11:59,689 [asp.py] => Learning on 80-85
2024-12-26 21:11:59,704 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-26 21:11:59,706 [asp.py] => total parameters: 173661441
2024-12-26 21:11:59,707 [asp.py] => trainable parameters: 2064129
2024-12-26 21:12:43,738 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48]
2024-12-26 21:12:43,738 [trainer.py] => Average Accuracy (Top1): 89.25   (Harmonic Accuracy): 84.56792815404528 (Old Acc): 91.03333333333335 (New Acc): 78.96000000000001 

2024-12-26 21:12:43,739 [trainer.py] => All params: 173661441
2024-12-26 21:12:43,740 [trainer.py] => Trainable params: 2064129
2024-12-26 21:12:43,742 [asp.py] => Learning on 85-90
2024-12-26 21:12:43,758 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-26 21:12:43,762 [asp.py] => total parameters: 173665281
2024-12-26 21:12:43,762 [asp.py] => trainable parameters: 2067969
2024-12-26 21:13:30,270 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48, 87.39]
2024-12-26 21:13:30,270 [trainer.py] => Average Accuracy (Top1): 88.98428571428572   (Harmonic Accuracy): 85.33226957254978 (Old Acc): 90.86666666666666 (New Acc): 80.43333333333334 

2024-12-26 21:13:30,271 [trainer.py] => All params: 173665281
2024-12-26 21:13:30,272 [trainer.py] => Trainable params: 2067969
2024-12-26 21:13:30,274 [asp.py] => Learning on 90-95
2024-12-26 21:13:30,288 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-26 21:13:30,291 [asp.py] => total parameters: 173669121
2024-12-26 21:13:30,291 [asp.py] => trainable parameters: 2071809
2024-12-26 21:14:19,362 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48, 87.39, 87.03]
2024-12-26 21:14:19,363 [trainer.py] => Average Accuracy (Top1): 88.74   (Harmonic Accuracy): 85.4064258032254 (Old Acc): 90.75 (New Acc): 80.65714285714286 

2024-12-26 21:14:19,364 [trainer.py] => All params: 173669121
2024-12-26 21:14:19,365 [trainer.py] => Trainable params: 2071809
2024-12-26 21:14:19,366 [asp.py] => Learning on 95-100
2024-12-26 21:14:19,380 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-26 21:14:19,382 [asp.py] => total parameters: 173672961
2024-12-26 21:14:19,383 [asp.py] => trainable parameters: 2075649
2024-12-26 21:15:11,024 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48, 87.39, 87.03, 85.89]
2024-12-26 21:15:11,024 [trainer.py] => Average Accuracy (Top1): 88.42333333333333   (Harmonic Accuracy): 84.31746422072493 (Old Acc): 90.56666666666666 (New Acc): 78.875 

2024-12-26 21:15:11,024 [trainer.py] => 

2024-12-26 22:22:35,354 [trainer.py] => config: ./exps/cifar.json
2024-12-26 22:22:35,354 [trainer.py] => model_name: asp
2024-12-26 22:22:35,354 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-26 22:22:35,354 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-26 22:22:35,354 [trainer.py] => seed: 2024
2024-12-26 22:22:35,354 [trainer.py] => dataset: cifar224
2024-12-26 22:22:35,354 [trainer.py] => init_cls: 60
2024-12-26 22:22:35,355 [trainer.py] => increment: 5
2024-12-26 22:22:35,355 [trainer.py] => kshot: 5
2024-12-26 22:22:35,355 [trainer.py] => vpt_type: Deep
2024-12-26 22:22:35,355 [trainer.py] => prompt_token_num: 6
2024-12-26 22:22:35,355 [trainer.py] => avg_alpha: 0.8
2024-12-26 22:22:35,355 [trainer.py] => perturb_var: 1
2024-12-26 22:22:35,355 [trainer.py] => EMA_beta: 0.99
2024-12-26 22:22:35,355 [trainer.py] => anchor_lambda: 0.1
2024-12-26 22:22:35,355 [trainer.py] => kl_weight: 0.001
2024-12-26 22:22:35,355 [trainer.py] => TIP_init: zero
2024-12-26 22:22:35,355 [trainer.py] => tuned_epoch: 20
2024-12-26 22:22:35,355 [trainer.py] => fs_epoch: 0
2024-12-26 22:22:35,355 [trainer.py] => init_lr: 0.01
2024-12-26 22:22:35,355 [trainer.py] => fs_lr: 0.001
2024-12-26 22:22:35,355 [trainer.py] => batch_size: 48
2024-12-26 22:22:35,355 [trainer.py] => fs_batch_size: 16
2024-12-26 22:22:35,355 [trainer.py] => weight_decay: 0.0005
2024-12-26 22:22:35,355 [trainer.py] => min_lr: 0
2024-12-26 22:22:35,355 [trainer.py] => optimizer: sgd
2024-12-26 22:22:35,355 [trainer.py] => memory_size: 0
2024-12-26 22:22:35,355 [trainer.py] => memory_per_class: 0
2024-12-26 22:22:35,355 [trainer.py] => fixed_memory: False
2024-12-26 22:22:35,355 [trainer.py] => shuffle: False
2024-12-26 22:22:35,355 [trainer.py] => top_k: 5
2024-12-26 22:22:35,355 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-26 22:22:35,355 [trainer.py] => prefix: asp
2024-12-26 22:22:35,355 [trainer.py] => model_prefix: asp
2024-12-26 22:22:36,835 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 21:16:47,149 [trainer.py] => config: ./exps/cifar.json
2024-12-27 21:16:47,150 [trainer.py] => model_name: asp
2024-12-27 21:16:47,150 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 21:16:47,150 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 21:16:47,150 [trainer.py] => seed: 2024
2024-12-27 21:16:47,150 [trainer.py] => dataset: cifar224
2024-12-27 21:16:47,150 [trainer.py] => init_cls: 60
2024-12-27 21:16:47,150 [trainer.py] => increment: 5
2024-12-27 21:16:47,150 [trainer.py] => kshot: 5
2024-12-27 21:16:47,150 [trainer.py] => vpt_type: Deep
2024-12-27 21:16:47,150 [trainer.py] => prompt_token_num: 6
2024-12-27 21:16:47,150 [trainer.py] => avg_alpha: 0.8
2024-12-27 21:16:47,150 [trainer.py] => perturb_var: 1
2024-12-27 21:16:47,151 [trainer.py] => EMA_beta: 0.99
2024-12-27 21:16:47,151 [trainer.py] => anchor_lambda: 0.1
2024-12-27 21:16:47,151 [trainer.py] => kl_weight: 0.001
2024-12-27 21:16:47,151 [trainer.py] => TIP_init: zero
2024-12-27 21:16:47,151 [trainer.py] => tuned_epoch: 20
2024-12-27 21:16:47,151 [trainer.py] => fs_epoch: 0
2024-12-27 21:16:47,151 [trainer.py] => init_lr: 0.01
2024-12-27 21:16:47,151 [trainer.py] => fs_lr: 0.001
2024-12-27 21:16:47,151 [trainer.py] => batch_size: 48
2024-12-27 21:16:47,151 [trainer.py] => fs_batch_size: 16
2024-12-27 21:16:47,151 [trainer.py] => weight_decay: 0.0005
2024-12-27 21:16:47,151 [trainer.py] => min_lr: 0
2024-12-27 21:16:47,151 [trainer.py] => optimizer: sgd
2024-12-27 21:16:47,152 [trainer.py] => memory_size: 0
2024-12-27 21:16:47,152 [trainer.py] => memory_per_class: 0
2024-12-27 21:16:47,152 [trainer.py] => fixed_memory: False
2024-12-27 21:16:47,152 [trainer.py] => shuffle: False
2024-12-27 21:16:47,152 [trainer.py] => top_k: 5
2024-12-27 21:16:47,152 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 21:16:47,152 [trainer.py] => prefix: asp
2024-12-27 21:16:47,152 [trainer.py] => model_prefix: asp
2024-12-27 21:16:48,662 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 21:17:14,376 [trainer.py] => All params: 173596160
2024-12-27 21:17:14,377 [trainer.py] => Trainable params: 1998848
2024-12-27 21:17:14,959 [asp.py] => Learning on 0-60
2024-12-27 21:17:15,037 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-27 21:17:15,122 [asp.py] => total parameters: 173642241
2024-12-27 21:17:15,123 [asp.py] => trainable parameters: 2044929
2024-12-27 21:17:15,124 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-27 21:35:48,861 [trainer.py] => config: ./exps/cifar.json
2024-12-27 21:35:48,861 [trainer.py] => model_name: asp
2024-12-27 21:35:48,861 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 21:35:48,861 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 21:35:48,861 [trainer.py] => seed: 2024
2024-12-27 21:35:48,861 [trainer.py] => dataset: cifar224
2024-12-27 21:35:48,861 [trainer.py] => init_cls: 60
2024-12-27 21:35:48,861 [trainer.py] => increment: 5
2024-12-27 21:35:48,861 [trainer.py] => kshot: 5
2024-12-27 21:35:48,861 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 21:35:48,861 [trainer.py] => vpt_type: Deep
2024-12-27 21:35:48,861 [trainer.py] => prompt_token_num: 6
2024-12-27 21:35:48,861 [trainer.py] => avg_alpha: 0.8
2024-12-27 21:35:48,861 [trainer.py] => perturb_var: 1
2024-12-27 21:35:48,861 [trainer.py] => EMA_beta: 0.99
2024-12-27 21:35:48,862 [trainer.py] => anchor_lambda: 0.1
2024-12-27 21:35:48,862 [trainer.py] => kl_weight: 0.001
2024-12-27 21:35:48,862 [trainer.py] => TIP_init: zero
2024-12-27 21:35:48,862 [trainer.py] => tuned_epoch: 20
2024-12-27 21:35:48,862 [trainer.py] => fs_epoch: 0
2024-12-27 21:35:48,862 [trainer.py] => init_lr: 0.01
2024-12-27 21:35:48,862 [trainer.py] => fs_lr: 0.001
2024-12-27 21:35:48,862 [trainer.py] => batch_size: 48
2024-12-27 21:35:48,862 [trainer.py] => fs_batch_size: 16
2024-12-27 21:35:48,862 [trainer.py] => weight_decay: 0.0005
2024-12-27 21:35:48,862 [trainer.py] => min_lr: 0
2024-12-27 21:35:48,862 [trainer.py] => optimizer: sgd
2024-12-27 21:35:48,862 [trainer.py] => memory_size: 0
2024-12-27 21:35:48,862 [trainer.py] => memory_per_class: 0
2024-12-27 21:35:48,862 [trainer.py] => fixed_memory: False
2024-12-27 21:35:48,862 [trainer.py] => shuffle: False
2024-12-27 21:35:48,862 [trainer.py] => top_k: 5
2024-12-27 21:35:48,862 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 21:35:48,862 [trainer.py] => prefix: asp
2024-12-27 21:35:48,862 [trainer.py] => model_prefix: asp
2024-12-27 21:35:50,349 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 21:36:56,389 [trainer.py] => config: ./exps/cifar.json
2024-12-27 21:36:56,389 [trainer.py] => model_name: asp
2024-12-27 21:36:56,389 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 21:36:56,389 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 21:36:56,389 [trainer.py] => seed: 2024
2024-12-27 21:36:56,389 [trainer.py] => dataset: cifar224
2024-12-27 21:36:56,389 [trainer.py] => init_cls: 60
2024-12-27 21:36:56,389 [trainer.py] => increment: 5
2024-12-27 21:36:56,389 [trainer.py] => kshot: 5
2024-12-27 21:36:56,389 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 21:36:56,389 [trainer.py] => vpt_type: Deep
2024-12-27 21:36:56,389 [trainer.py] => prompt_token_num: 6
2024-12-27 21:36:56,389 [trainer.py] => avg_alpha: 0.8
2024-12-27 21:36:56,389 [trainer.py] => perturb_var: 1
2024-12-27 21:36:56,389 [trainer.py] => EMA_beta: 0.99
2024-12-27 21:36:56,389 [trainer.py] => anchor_lambda: 0.1
2024-12-27 21:36:56,389 [trainer.py] => kl_weight: 0.001
2024-12-27 21:36:56,389 [trainer.py] => TIP_init: zero
2024-12-27 21:36:56,389 [trainer.py] => tuned_epoch: 20
2024-12-27 21:36:56,389 [trainer.py] => fs_epoch: 0
2024-12-27 21:36:56,389 [trainer.py] => init_lr: 0.01
2024-12-27 21:36:56,389 [trainer.py] => fs_lr: 0.001
2024-12-27 21:36:56,389 [trainer.py] => batch_size: 48
2024-12-27 21:36:56,389 [trainer.py] => fs_batch_size: 16
2024-12-27 21:36:56,389 [trainer.py] => weight_decay: 0.0005
2024-12-27 21:36:56,390 [trainer.py] => min_lr: 0
2024-12-27 21:36:56,390 [trainer.py] => optimizer: sgd
2024-12-27 21:36:56,390 [trainer.py] => memory_size: 0
2024-12-27 21:36:56,390 [trainer.py] => memory_per_class: 0
2024-12-27 21:36:56,390 [trainer.py] => fixed_memory: False
2024-12-27 21:36:56,390 [trainer.py] => shuffle: False
2024-12-27 21:36:56,390 [trainer.py] => top_k: 5
2024-12-27 21:36:56,390 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 21:36:56,390 [trainer.py] => prefix: asp
2024-12-27 21:36:56,390 [trainer.py] => model_prefix: asp
2024-12-27 21:36:57,874 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 21:37:09,898 [trainer.py] => config: ./exps/cifar.json
2024-12-27 21:37:09,898 [trainer.py] => model_name: asp
2024-12-27 21:37:09,898 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 21:37:09,898 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 21:37:09,898 [trainer.py] => seed: 2024
2024-12-27 21:37:09,898 [trainer.py] => dataset: cifar224
2024-12-27 21:37:09,898 [trainer.py] => init_cls: 60
2024-12-27 21:37:09,898 [trainer.py] => increment: 5
2024-12-27 21:37:09,898 [trainer.py] => kshot: 5
2024-12-27 21:37:09,898 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 21:37:09,898 [trainer.py] => vpt_type: Deep
2024-12-27 21:37:09,898 [trainer.py] => prompt_token_num: 6
2024-12-27 21:37:09,898 [trainer.py] => avg_alpha: 0.8
2024-12-27 21:37:09,898 [trainer.py] => perturb_var: 1
2024-12-27 21:37:09,898 [trainer.py] => EMA_beta: 0.99
2024-12-27 21:37:09,898 [trainer.py] => anchor_lambda: 0.1
2024-12-27 21:37:09,898 [trainer.py] => kl_weight: 0.001
2024-12-27 21:37:09,898 [trainer.py] => TIP_init: zero
2024-12-27 21:37:09,898 [trainer.py] => tuned_epoch: 20
2024-12-27 21:37:09,898 [trainer.py] => fs_epoch: 0
2024-12-27 21:37:09,898 [trainer.py] => init_lr: 0.01
2024-12-27 21:37:09,898 [trainer.py] => fs_lr: 0.001
2024-12-27 21:37:09,898 [trainer.py] => batch_size: 48
2024-12-27 21:37:09,899 [trainer.py] => fs_batch_size: 16
2024-12-27 21:37:09,899 [trainer.py] => weight_decay: 0.0005
2024-12-27 21:37:09,899 [trainer.py] => min_lr: 0
2024-12-27 21:37:09,899 [trainer.py] => optimizer: sgd
2024-12-27 21:37:09,899 [trainer.py] => memory_size: 0
2024-12-27 21:37:09,899 [trainer.py] => memory_per_class: 0
2024-12-27 21:37:09,899 [trainer.py] => fixed_memory: False
2024-12-27 21:37:09,899 [trainer.py] => shuffle: False
2024-12-27 21:37:09,899 [trainer.py] => top_k: 5
2024-12-27 21:37:09,899 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 21:37:09,899 [trainer.py] => prefix: asp
2024-12-27 21:37:09,899 [trainer.py] => model_prefix: asp
2024-12-27 21:37:11,381 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 21:37:46,445 [trainer.py] => config: ./exps/cifar.json
2024-12-27 21:37:46,445 [trainer.py] => model_name: asp
2024-12-27 21:37:46,445 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 21:37:46,445 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 21:37:46,445 [trainer.py] => seed: 2024
2024-12-27 21:37:46,445 [trainer.py] => dataset: cifar224
2024-12-27 21:37:46,445 [trainer.py] => init_cls: 60
2024-12-27 21:37:46,446 [trainer.py] => increment: 5
2024-12-27 21:37:46,446 [trainer.py] => kshot: 5
2024-12-27 21:37:46,446 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 21:37:46,446 [trainer.py] => vpt_type: Deep
2024-12-27 21:37:46,446 [trainer.py] => prompt_token_num: 6
2024-12-27 21:37:46,446 [trainer.py] => avg_alpha: 0.8
2024-12-27 21:37:46,446 [trainer.py] => perturb_var: 1
2024-12-27 21:37:46,446 [trainer.py] => EMA_beta: 0.99
2024-12-27 21:37:46,446 [trainer.py] => anchor_lambda: 0.1
2024-12-27 21:37:46,446 [trainer.py] => kl_weight: 0.001
2024-12-27 21:37:46,446 [trainer.py] => TIP_init: zero
2024-12-27 21:37:46,446 [trainer.py] => tuned_epoch: 20
2024-12-27 21:37:46,446 [trainer.py] => fs_epoch: 0
2024-12-27 21:37:46,446 [trainer.py] => init_lr: 0.01
2024-12-27 21:37:46,446 [trainer.py] => fs_lr: 0.001
2024-12-27 21:37:46,446 [trainer.py] => batch_size: 48
2024-12-27 21:37:46,446 [trainer.py] => fs_batch_size: 16
2024-12-27 21:37:46,446 [trainer.py] => weight_decay: 0.0005
2024-12-27 21:37:46,446 [trainer.py] => min_lr: 0
2024-12-27 21:37:46,446 [trainer.py] => optimizer: sgd
2024-12-27 21:37:46,446 [trainer.py] => memory_size: 0
2024-12-27 21:37:46,446 [trainer.py] => memory_per_class: 0
2024-12-27 21:37:46,446 [trainer.py] => fixed_memory: False
2024-12-27 21:37:46,446 [trainer.py] => shuffle: False
2024-12-27 21:37:46,446 [trainer.py] => top_k: 5
2024-12-27 21:37:46,446 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 21:37:46,446 [trainer.py] => prefix: asp
2024-12-27 21:37:46,446 [trainer.py] => model_prefix: asp
2024-12-27 21:37:47,933 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 21:40:02,073 [trainer.py] => config: ./exps/cifar.json
2024-12-27 21:40:02,073 [trainer.py] => model_name: asp
2024-12-27 21:40:02,073 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 21:40:02,073 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 21:40:02,073 [trainer.py] => seed: 2024
2024-12-27 21:40:02,073 [trainer.py] => dataset: cifar224
2024-12-27 21:40:02,073 [trainer.py] => init_cls: 60
2024-12-27 21:40:02,073 [trainer.py] => increment: 5
2024-12-27 21:40:02,073 [trainer.py] => kshot: 5
2024-12-27 21:40:02,073 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 21:40:02,074 [trainer.py] => z_dim: 1000
2024-12-27 21:40:02,074 [trainer.py] => convdim: 64
2024-12-27 21:40:02,074 [trainer.py] => vpt_type: Deep
2024-12-27 21:40:02,074 [trainer.py] => prompt_token_num: 6
2024-12-27 21:40:02,074 [trainer.py] => avg_alpha: 0.8
2024-12-27 21:40:02,074 [trainer.py] => perturb_var: 1
2024-12-27 21:40:02,074 [trainer.py] => EMA_beta: 0.99
2024-12-27 21:40:02,074 [trainer.py] => anchor_lambda: 0.1
2024-12-27 21:40:02,074 [trainer.py] => kl_weight: 0.001
2024-12-27 21:40:02,074 [trainer.py] => TIP_init: zero
2024-12-27 21:40:02,074 [trainer.py] => tuned_epoch: 20
2024-12-27 21:40:02,074 [trainer.py] => fs_epoch: 0
2024-12-27 21:40:02,074 [trainer.py] => init_lr: 0.01
2024-12-27 21:40:02,074 [trainer.py] => fs_lr: 0.001
2024-12-27 21:40:02,074 [trainer.py] => batch_size: 48
2024-12-27 21:40:02,074 [trainer.py] => fs_batch_size: 16
2024-12-27 21:40:02,074 [trainer.py] => weight_decay: 0.0005
2024-12-27 21:40:02,074 [trainer.py] => min_lr: 0
2024-12-27 21:40:02,074 [trainer.py] => optimizer: sgd
2024-12-27 21:40:02,074 [trainer.py] => memory_size: 0
2024-12-27 21:40:02,074 [trainer.py] => memory_per_class: 0
2024-12-27 21:40:02,074 [trainer.py] => fixed_memory: False
2024-12-27 21:40:02,074 [trainer.py] => shuffle: False
2024-12-27 21:40:02,074 [trainer.py] => top_k: 5
2024-12-27 21:40:02,074 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 21:40:02,074 [trainer.py] => prefix: asp
2024-12-27 21:40:02,074 [trainer.py] => model_prefix: asp
2024-12-27 21:40:03,562 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 21:40:49,064 [trainer.py] => config: ./exps/cifar.json
2024-12-27 21:40:49,064 [trainer.py] => model_name: asp
2024-12-27 21:40:49,064 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 21:40:49,064 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 21:40:49,064 [trainer.py] => seed: 2024
2024-12-27 21:40:49,064 [trainer.py] => dataset: cifar224
2024-12-27 21:40:49,065 [trainer.py] => init_cls: 60
2024-12-27 21:40:49,065 [trainer.py] => increment: 5
2024-12-27 21:40:49,065 [trainer.py] => kshot: 5
2024-12-27 21:40:49,065 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 21:40:49,065 [trainer.py] => z_dim: 1000
2024-12-27 21:40:49,065 [trainer.py] => convdim: 64
2024-12-27 21:40:49,065 [trainer.py] => vpt_type: Deep
2024-12-27 21:40:49,065 [trainer.py] => prompt_token_num: 6
2024-12-27 21:40:49,065 [trainer.py] => avg_alpha: 0.8
2024-12-27 21:40:49,065 [trainer.py] => perturb_var: 1
2024-12-27 21:40:49,065 [trainer.py] => EMA_beta: 0.99
2024-12-27 21:40:49,065 [trainer.py] => anchor_lambda: 0.1
2024-12-27 21:40:49,065 [trainer.py] => kl_weight: 0.001
2024-12-27 21:40:49,065 [trainer.py] => TIP_init: zero
2024-12-27 21:40:49,065 [trainer.py] => tuned_epoch: 20
2024-12-27 21:40:49,065 [trainer.py] => fs_epoch: 0
2024-12-27 21:40:49,065 [trainer.py] => init_lr: 0.01
2024-12-27 21:40:49,065 [trainer.py] => fs_lr: 0.001
2024-12-27 21:40:49,065 [trainer.py] => batch_size: 48
2024-12-27 21:40:49,065 [trainer.py] => fs_batch_size: 16
2024-12-27 21:40:49,065 [trainer.py] => weight_decay: 0.0005
2024-12-27 21:40:49,065 [trainer.py] => min_lr: 0
2024-12-27 21:40:49,065 [trainer.py] => optimizer: sgd
2024-12-27 21:40:49,065 [trainer.py] => memory_size: 0
2024-12-27 21:40:49,065 [trainer.py] => memory_per_class: 0
2024-12-27 21:40:49,065 [trainer.py] => fixed_memory: False
2024-12-27 21:40:49,065 [trainer.py] => shuffle: False
2024-12-27 21:40:49,065 [trainer.py] => top_k: 5
2024-12-27 21:40:49,065 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 21:40:49,065 [trainer.py] => prefix: asp
2024-12-27 21:40:49,066 [trainer.py] => model_prefix: asp
2024-12-27 21:40:50,545 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 21:41:07,874 [trainer.py] => config: ./exps/cifar.json
2024-12-27 21:41:07,875 [trainer.py] => model_name: asp
2024-12-27 21:41:07,875 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 21:41:07,875 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 21:41:07,875 [trainer.py] => seed: 2024
2024-12-27 21:41:07,875 [trainer.py] => dataset: cifar224
2024-12-27 21:41:07,875 [trainer.py] => init_cls: 60
2024-12-27 21:41:07,875 [trainer.py] => increment: 5
2024-12-27 21:41:07,875 [trainer.py] => kshot: 5
2024-12-27 21:41:07,875 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 21:41:07,875 [trainer.py] => z_dim: 1000
2024-12-27 21:41:07,875 [trainer.py] => conv_dim: 64
2024-12-27 21:41:07,875 [trainer.py] => vpt_type: Deep
2024-12-27 21:41:07,875 [trainer.py] => prompt_token_num: 6
2024-12-27 21:41:07,875 [trainer.py] => avg_alpha: 0.8
2024-12-27 21:41:07,875 [trainer.py] => perturb_var: 1
2024-12-27 21:41:07,875 [trainer.py] => EMA_beta: 0.99
2024-12-27 21:41:07,875 [trainer.py] => anchor_lambda: 0.1
2024-12-27 21:41:07,875 [trainer.py] => kl_weight: 0.001
2024-12-27 21:41:07,875 [trainer.py] => TIP_init: zero
2024-12-27 21:41:07,875 [trainer.py] => tuned_epoch: 20
2024-12-27 21:41:07,875 [trainer.py] => fs_epoch: 0
2024-12-27 21:41:07,875 [trainer.py] => init_lr: 0.01
2024-12-27 21:41:07,875 [trainer.py] => fs_lr: 0.001
2024-12-27 21:41:07,875 [trainer.py] => batch_size: 48
2024-12-27 21:41:07,875 [trainer.py] => fs_batch_size: 16
2024-12-27 21:41:07,875 [trainer.py] => weight_decay: 0.0005
2024-12-27 21:41:07,876 [trainer.py] => min_lr: 0
2024-12-27 21:41:07,876 [trainer.py] => optimizer: sgd
2024-12-27 21:41:07,876 [trainer.py] => memory_size: 0
2024-12-27 21:41:07,876 [trainer.py] => memory_per_class: 0
2024-12-27 21:41:07,876 [trainer.py] => fixed_memory: False
2024-12-27 21:41:07,876 [trainer.py] => shuffle: False
2024-12-27 21:41:07,876 [trainer.py] => top_k: 5
2024-12-27 21:41:07,876 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 21:41:07,876 [trainer.py] => prefix: asp
2024-12-27 21:41:07,876 [trainer.py] => model_prefix: asp
2024-12-27 21:41:09,373 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 21:41:13,817 [trainer.py] => All params: 173596160
2024-12-27 21:41:13,818 [trainer.py] => Trainable params: 1998848
2024-12-27 21:41:14,482 [asp.py] => Learning on 0-60
2024-12-27 21:41:14,582 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-27 21:41:14,670 [asp.py] => total parameters: 173642241
2024-12-27 21:41:14,670 [asp.py] => trainable parameters: 2044929
2024-12-27 21:41:14,671 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-27 22:03:33,118 [trainer.py] => config: ./exps/cifar.json
2024-12-27 22:03:33,118 [trainer.py] => model_name: asp
2024-12-27 22:03:33,118 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 22:03:33,118 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 22:03:33,118 [trainer.py] => seed: 2024
2024-12-27 22:03:33,118 [trainer.py] => dataset: cifar224
2024-12-27 22:03:33,118 [trainer.py] => init_cls: 60
2024-12-27 22:03:33,118 [trainer.py] => increment: 5
2024-12-27 22:03:33,118 [trainer.py] => kshot: 5
2024-12-27 22:03:33,118 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 22:03:33,118 [trainer.py] => z_dim: 1000
2024-12-27 22:03:33,118 [trainer.py] => conv_dim: 64
2024-12-27 22:03:33,118 [trainer.py] => img_size: 32
2024-12-27 22:03:33,118 [trainer.py] => generator_lr: 0.001
2024-12-27 22:03:33,118 [trainer.py] => w_bn: 50.0
2024-12-27 22:03:33,118 [trainer.py] => w_noise: 0.001
2024-12-27 22:03:33,118 [trainer.py] => server_ss: 128
2024-12-27 22:03:33,119 [trainer.py] => bn_loss: 1
2024-12-27 22:03:33,119 [trainer.py] => noise: 1
2024-12-27 22:03:33,119 [trainer.py] => ie_loss: 1
2024-12-27 22:03:33,119 [trainer.py] => act_loss: 0
2024-12-27 22:03:33,119 [trainer.py] => w_ie: 1.0
2024-12-27 22:03:33,119 [trainer.py] => w_act: 0.1
2024-12-27 22:03:33,119 [trainer.py] => vpt_type: Deep
2024-12-27 22:03:33,119 [trainer.py] => prompt_token_num: 6
2024-12-27 22:03:33,119 [trainer.py] => avg_alpha: 0.8
2024-12-27 22:03:33,119 [trainer.py] => perturb_var: 1
2024-12-27 22:03:33,119 [trainer.py] => EMA_beta: 0.99
2024-12-27 22:03:33,119 [trainer.py] => anchor_lambda: 0.1
2024-12-27 22:03:33,119 [trainer.py] => kl_weight: 0.001
2024-12-27 22:03:33,119 [trainer.py] => TIP_init: zero
2024-12-27 22:03:33,119 [trainer.py] => tuned_epoch: 20
2024-12-27 22:03:33,119 [trainer.py] => fs_epoch: 0
2024-12-27 22:03:33,119 [trainer.py] => init_lr: 0.01
2024-12-27 22:03:33,119 [trainer.py] => fs_lr: 0.001
2024-12-27 22:03:33,119 [trainer.py] => batch_size: 48
2024-12-27 22:03:33,119 [trainer.py] => fs_batch_size: 16
2024-12-27 22:03:33,119 [trainer.py] => weight_decay: 0.0005
2024-12-27 22:03:33,119 [trainer.py] => min_lr: 0
2024-12-27 22:03:33,119 [trainer.py] => optimizer: sgd
2024-12-27 22:03:33,119 [trainer.py] => memory_size: 0
2024-12-27 22:03:33,119 [trainer.py] => memory_per_class: 0
2024-12-27 22:03:33,119 [trainer.py] => fixed_memory: False
2024-12-27 22:03:33,119 [trainer.py] => shuffle: False
2024-12-27 22:03:33,119 [trainer.py] => top_k: 5
2024-12-27 22:03:33,120 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 22:03:33,120 [trainer.py] => prefix: asp
2024-12-27 22:03:33,120 [trainer.py] => model_prefix: asp
2024-12-27 22:03:34,607 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 22:03:41,107 [trainer.py] => All params: 173596160
2024-12-27 22:03:41,107 [trainer.py] => Trainable params: 1998848
2024-12-27 22:03:41,783 [asp.py] => Learning on 0-60
2024-12-27 22:03:41,863 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-27 22:03:41,952 [asp.py] => total parameters: 173642241
2024-12-27 22:03:41,953 [asp.py] => trainable parameters: 2044929
2024-12-27 22:03:41,953 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-27 22:08:59,087 [trainer.py] => config: ./exps/cifar.json
2024-12-27 22:08:59,087 [trainer.py] => model_name: asp
2024-12-27 22:08:59,087 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 22:08:59,087 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 22:08:59,087 [trainer.py] => seed: 2024
2024-12-27 22:08:59,088 [trainer.py] => dataset: cifar224
2024-12-27 22:08:59,088 [trainer.py] => init_cls: 60
2024-12-27 22:08:59,088 [trainer.py] => increment: 5
2024-12-27 22:08:59,088 [trainer.py] => kshot: 5
2024-12-27 22:08:59,088 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 22:08:59,088 [trainer.py] => z_dim: 1000
2024-12-27 22:08:59,088 [trainer.py] => conv_dim: 64
2024-12-27 22:08:59,088 [trainer.py] => img_size: 32
2024-12-27 22:08:59,088 [trainer.py] => generator_lr: 0.001
2024-12-27 22:08:59,088 [trainer.py] => pi: 1
2024-12-27 22:08:59,088 [trainer.py] => w_bn: 50.0
2024-12-27 22:08:59,088 [trainer.py] => w_noise: 0.001
2024-12-27 22:08:59,088 [trainer.py] => server_ss: 128
2024-12-27 22:08:59,088 [trainer.py] => bn_loss: 1
2024-12-27 22:08:59,088 [trainer.py] => noise: 1
2024-12-27 22:08:59,088 [trainer.py] => ie_loss: 1
2024-12-27 22:08:59,088 [trainer.py] => act_loss: 0
2024-12-27 22:08:59,088 [trainer.py] => w_ie: 1.0
2024-12-27 22:08:59,088 [trainer.py] => w_act: 0.1
2024-12-27 22:08:59,088 [trainer.py] => vpt_type: Deep
2024-12-27 22:08:59,088 [trainer.py] => prompt_token_num: 6
2024-12-27 22:08:59,088 [trainer.py] => avg_alpha: 0.8
2024-12-27 22:08:59,088 [trainer.py] => perturb_var: 1
2024-12-27 22:08:59,088 [trainer.py] => EMA_beta: 0.99
2024-12-27 22:08:59,088 [trainer.py] => anchor_lambda: 0.1
2024-12-27 22:08:59,088 [trainer.py] => kl_weight: 0.001
2024-12-27 22:08:59,088 [trainer.py] => TIP_init: zero
2024-12-27 22:08:59,088 [trainer.py] => tuned_epoch: 20
2024-12-27 22:08:59,088 [trainer.py] => fs_epoch: 0
2024-12-27 22:08:59,089 [trainer.py] => init_lr: 0.01
2024-12-27 22:08:59,089 [trainer.py] => fs_lr: 0.001
2024-12-27 22:08:59,089 [trainer.py] => batch_size: 48
2024-12-27 22:08:59,089 [trainer.py] => fs_batch_size: 16
2024-12-27 22:08:59,089 [trainer.py] => weight_decay: 0.0005
2024-12-27 22:08:59,089 [trainer.py] => min_lr: 0
2024-12-27 22:08:59,089 [trainer.py] => optimizer: sgd
2024-12-27 22:08:59,089 [trainer.py] => memory_size: 0
2024-12-27 22:08:59,089 [trainer.py] => memory_per_class: 0
2024-12-27 22:08:59,089 [trainer.py] => fixed_memory: False
2024-12-27 22:08:59,089 [trainer.py] => shuffle: False
2024-12-27 22:08:59,089 [trainer.py] => top_k: 5
2024-12-27 22:08:59,089 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 22:08:59,089 [trainer.py] => prefix: asp
2024-12-27 22:08:59,089 [trainer.py] => model_prefix: asp
2024-12-27 22:09:00,960 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 22:09:05,681 [trainer.py] => All params: 173596160
2024-12-27 22:09:05,682 [trainer.py] => Trainable params: 1998848
2024-12-27 22:09:06,301 [asp.py] => Learning on 0-60
2024-12-27 22:09:06,411 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-27 22:09:06,513 [asp.py] => total parameters: 173642241
2024-12-27 22:09:06,514 [asp.py] => trainable parameters: 2044929
2024-12-27 22:09:06,515 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-27 22:13:23,084 [trainer.py] => config: ./exps/cifar.json
2024-12-27 22:13:23,084 [trainer.py] => model_name: asp
2024-12-27 22:13:23,084 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 22:13:23,084 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 22:13:23,084 [trainer.py] => seed: 2024
2024-12-27 22:13:23,084 [trainer.py] => dataset: cifar224
2024-12-27 22:13:23,084 [trainer.py] => init_cls: 60
2024-12-27 22:13:23,084 [trainer.py] => increment: 5
2024-12-27 22:13:23,084 [trainer.py] => kshot: 5
2024-12-27 22:13:23,084 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 22:13:23,084 [trainer.py] => z_dim: 1000
2024-12-27 22:13:23,084 [trainer.py] => conv_dim: 64
2024-12-27 22:13:23,084 [trainer.py] => img_size: 32
2024-12-27 22:13:23,084 [trainer.py] => generator_lr: 0.001
2024-12-27 22:13:23,084 [trainer.py] => pi: 1
2024-12-27 22:13:23,084 [trainer.py] => w_bn: 50.0
2024-12-27 22:13:23,084 [trainer.py] => w_noise: 0.001
2024-12-27 22:13:23,084 [trainer.py] => server_ss: 128
2024-12-27 22:13:23,084 [trainer.py] => bn_loss: 1
2024-12-27 22:13:23,084 [trainer.py] => noise: 1
2024-12-27 22:13:23,084 [trainer.py] => ie_loss: 1
2024-12-27 22:13:23,085 [trainer.py] => act_loss: 0
2024-12-27 22:13:23,085 [trainer.py] => w_ie: 1.0
2024-12-27 22:13:23,085 [trainer.py] => w_act: 0.1
2024-12-27 22:13:23,085 [trainer.py] => vpt_type: Deep
2024-12-27 22:13:23,085 [trainer.py] => prompt_token_num: 6
2024-12-27 22:13:23,085 [trainer.py] => avg_alpha: 0.8
2024-12-27 22:13:23,085 [trainer.py] => perturb_var: 1
2024-12-27 22:13:23,085 [trainer.py] => EMA_beta: 0.99
2024-12-27 22:13:23,085 [trainer.py] => anchor_lambda: 0.1
2024-12-27 22:13:23,085 [trainer.py] => kl_weight: 0.001
2024-12-27 22:13:23,085 [trainer.py] => TIP_init: zero
2024-12-27 22:13:23,085 [trainer.py] => tuned_epoch: 20
2024-12-27 22:13:23,085 [trainer.py] => fs_epoch: 0
2024-12-27 22:13:23,085 [trainer.py] => init_lr: 0.01
2024-12-27 22:13:23,085 [trainer.py] => fs_lr: 0.001
2024-12-27 22:13:23,085 [trainer.py] => batch_size: 48
2024-12-27 22:13:23,085 [trainer.py] => fs_batch_size: 16
2024-12-27 22:13:23,085 [trainer.py] => weight_decay: 0.0005
2024-12-27 22:13:23,085 [trainer.py] => min_lr: 0
2024-12-27 22:13:23,085 [trainer.py] => optimizer: sgd
2024-12-27 22:13:23,085 [trainer.py] => memory_size: 0
2024-12-27 22:13:23,085 [trainer.py] => memory_per_class: 0
2024-12-27 22:13:23,085 [trainer.py] => fixed_memory: False
2024-12-27 22:13:23,085 [trainer.py] => shuffle: False
2024-12-27 22:13:23,085 [trainer.py] => top_k: 5
2024-12-27 22:13:23,085 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 22:13:23,085 [trainer.py] => prefix: asp
2024-12-27 22:13:23,085 [trainer.py] => model_prefix: asp
2024-12-27 22:13:24,563 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 22:13:29,097 [trainer.py] => All params: 173596160
2024-12-27 22:13:29,098 [trainer.py] => Trainable params: 1998848
2024-12-27 22:13:29,655 [asp.py] => Learning on 0-60
2024-12-27 22:13:29,724 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-27 22:13:29,824 [asp.py] => total parameters: 173642241
2024-12-27 22:13:29,825 [asp.py] => trainable parameters: 2044929
2024-12-27 22:13:29,826 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-27 22:21:25,172 [trainer.py] => config: ./exps/cifar.json
2024-12-27 22:21:25,173 [trainer.py] => model_name: asp
2024-12-27 22:21:25,173 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 22:21:25,173 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 22:21:25,173 [trainer.py] => seed: 2024
2024-12-27 22:21:25,173 [trainer.py] => dataset: cifar224
2024-12-27 22:21:25,173 [trainer.py] => init_cls: 60
2024-12-27 22:21:25,173 [trainer.py] => increment: 5
2024-12-27 22:21:25,173 [trainer.py] => kshot: 5
2024-12-27 22:21:25,173 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 22:21:25,173 [trainer.py] => z_dim: 1000
2024-12-27 22:21:25,173 [trainer.py] => conv_dim: 64
2024-12-27 22:21:25,173 [trainer.py] => img_size: 224
2024-12-27 22:21:25,173 [trainer.py] => generator_lr: 0.001
2024-12-27 22:21:25,173 [trainer.py] => pi: 1
2024-12-27 22:21:25,173 [trainer.py] => w_bn: 50.0
2024-12-27 22:21:25,173 [trainer.py] => w_noise: 0.001
2024-12-27 22:21:25,173 [trainer.py] => server_ss: 128
2024-12-27 22:21:25,173 [trainer.py] => bn_loss: 1
2024-12-27 22:21:25,173 [trainer.py] => noise: 1
2024-12-27 22:21:25,173 [trainer.py] => ie_loss: 1
2024-12-27 22:21:25,173 [trainer.py] => act_loss: 0
2024-12-27 22:21:25,173 [trainer.py] => w_ie: 1.0
2024-12-27 22:21:25,173 [trainer.py] => w_act: 0.1
2024-12-27 22:21:25,173 [trainer.py] => vpt_type: Deep
2024-12-27 22:21:25,173 [trainer.py] => prompt_token_num: 6
2024-12-27 22:21:25,173 [trainer.py] => avg_alpha: 0.8
2024-12-27 22:21:25,174 [trainer.py] => perturb_var: 1
2024-12-27 22:21:25,174 [trainer.py] => EMA_beta: 0.99
2024-12-27 22:21:25,174 [trainer.py] => anchor_lambda: 0.1
2024-12-27 22:21:25,174 [trainer.py] => kl_weight: 0.001
2024-12-27 22:21:25,174 [trainer.py] => TIP_init: zero
2024-12-27 22:21:25,174 [trainer.py] => tuned_epoch: 20
2024-12-27 22:21:25,174 [trainer.py] => fs_epoch: 0
2024-12-27 22:21:25,174 [trainer.py] => init_lr: 0.01
2024-12-27 22:21:25,174 [trainer.py] => fs_lr: 0.001
2024-12-27 22:21:25,174 [trainer.py] => batch_size: 48
2024-12-27 22:21:25,174 [trainer.py] => fs_batch_size: 16
2024-12-27 22:21:25,174 [trainer.py] => weight_decay: 0.0005
2024-12-27 22:21:25,174 [trainer.py] => min_lr: 0
2024-12-27 22:21:25,174 [trainer.py] => optimizer: sgd
2024-12-27 22:21:25,174 [trainer.py] => memory_size: 0
2024-12-27 22:21:25,174 [trainer.py] => memory_per_class: 0
2024-12-27 22:21:25,174 [trainer.py] => fixed_memory: False
2024-12-27 22:21:25,174 [trainer.py] => shuffle: False
2024-12-27 22:21:25,174 [trainer.py] => top_k: 5
2024-12-27 22:21:25,174 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 22:21:25,174 [trainer.py] => prefix: asp
2024-12-27 22:21:25,174 [trainer.py] => model_prefix: asp
2024-12-27 22:21:26,655 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 22:21:30,674 [trainer.py] => All params: 173596160
2024-12-27 22:21:30,675 [trainer.py] => Trainable params: 1998848
2024-12-27 22:21:31,297 [asp.py] => Learning on 0-60
2024-12-27 22:21:31,380 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-27 22:21:31,464 [asp.py] => total parameters: 173642241
2024-12-27 22:21:31,465 [asp.py] => trainable parameters: 2044929
2024-12-27 22:21:31,465 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-27 22:31:45,225 [trainer.py] => config: ./exps/cifar.json
2024-12-27 22:31:45,225 [trainer.py] => model_name: asp
2024-12-27 22:31:45,225 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 22:31:45,225 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 22:31:45,225 [trainer.py] => seed: 2024
2024-12-27 22:31:45,225 [trainer.py] => dataset: cifar224
2024-12-27 22:31:45,225 [trainer.py] => init_cls: 60
2024-12-27 22:31:45,225 [trainer.py] => increment: 5
2024-12-27 22:31:45,225 [trainer.py] => kshot: 5
2024-12-27 22:31:45,225 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 22:31:45,225 [trainer.py] => z_dim: 1000
2024-12-27 22:31:45,225 [trainer.py] => conv_dim: 64
2024-12-27 22:31:45,225 [trainer.py] => img_size: 224
2024-12-27 22:31:45,225 [trainer.py] => generator_lr: 0.001
2024-12-27 22:31:45,225 [trainer.py] => pi: 1
2024-12-27 22:31:45,226 [trainer.py] => w_bn: 50.0
2024-12-27 22:31:45,226 [trainer.py] => w_noise: 0.001
2024-12-27 22:31:45,226 [trainer.py] => server_ss: 128
2024-12-27 22:31:45,226 [trainer.py] => bn_loss: 1
2024-12-27 22:31:45,226 [trainer.py] => noise: 1
2024-12-27 22:31:45,226 [trainer.py] => ie_loss: 1
2024-12-27 22:31:45,226 [trainer.py] => act_loss: 0
2024-12-27 22:31:45,226 [trainer.py] => w_ie: 1.0
2024-12-27 22:31:45,226 [trainer.py] => w_act: 0.1
2024-12-27 22:31:45,226 [trainer.py] => vpt_type: Deep
2024-12-27 22:31:45,226 [trainer.py] => prompt_token_num: 6
2024-12-27 22:31:45,226 [trainer.py] => avg_alpha: 0.8
2024-12-27 22:31:45,226 [trainer.py] => perturb_var: 1
2024-12-27 22:31:45,226 [trainer.py] => EMA_beta: 0.99
2024-12-27 22:31:45,226 [trainer.py] => anchor_lambda: 0.1
2024-12-27 22:31:45,226 [trainer.py] => kl_weight: 0.001
2024-12-27 22:31:45,226 [trainer.py] => TIP_init: zero
2024-12-27 22:31:45,226 [trainer.py] => tuned_epoch: 20
2024-12-27 22:31:45,226 [trainer.py] => fs_epoch: 0
2024-12-27 22:31:45,226 [trainer.py] => init_lr: 0.01
2024-12-27 22:31:45,226 [trainer.py] => fs_lr: 0.001
2024-12-27 22:31:45,226 [trainer.py] => batch_size: 48
2024-12-27 22:31:45,226 [trainer.py] => fs_batch_size: 16
2024-12-27 22:31:45,226 [trainer.py] => weight_decay: 0.0005
2024-12-27 22:31:45,226 [trainer.py] => min_lr: 0
2024-12-27 22:31:45,226 [trainer.py] => optimizer: sgd
2024-12-27 22:31:45,226 [trainer.py] => memory_size: 0
2024-12-27 22:31:45,226 [trainer.py] => memory_per_class: 0
2024-12-27 22:31:45,226 [trainer.py] => fixed_memory: False
2024-12-27 22:31:45,226 [trainer.py] => shuffle: False
2024-12-27 22:31:45,226 [trainer.py] => top_k: 5
2024-12-27 22:31:45,226 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 22:31:45,227 [trainer.py] => prefix: asp
2024-12-27 22:31:45,227 [trainer.py] => model_prefix: asp
2024-12-27 22:31:46,701 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 22:31:53,743 [trainer.py] => All params: 173596160
2024-12-27 22:31:53,744 [trainer.py] => Trainable params: 1998848
2024-12-27 22:31:54,372 [asp.py] => Learning on 0-60
2024-12-27 22:31:54,489 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-27 22:31:54,590 [asp.py] => total parameters: 173642241
2024-12-27 22:31:54,591 [asp.py] => trainable parameters: 2044929
2024-12-27 22:31:54,592 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-27 22:46:51,701 [trainer.py] => config: ./exps/cifar.json
2024-12-27 22:46:51,702 [trainer.py] => model_name: asp
2024-12-27 22:46:51,702 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-27 22:46:51,702 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-27 22:46:51,702 [trainer.py] => seed: 2024
2024-12-27 22:46:51,702 [trainer.py] => dataset: cifar224
2024-12-27 22:46:51,702 [trainer.py] => init_cls: 60
2024-12-27 22:46:51,702 [trainer.py] => increment: 5
2024-12-27 22:46:51,702 [trainer.py] => kshot: 5
2024-12-27 22:46:51,702 [trainer.py] => generator_model: CIFAR_GEN
2024-12-27 22:46:51,702 [trainer.py] => z_dim: 1000
2024-12-27 22:46:51,702 [trainer.py] => conv_dim: 64
2024-12-27 22:46:51,702 [trainer.py] => img_size: 224
2024-12-27 22:46:51,702 [trainer.py] => generator_lr: 0.001
2024-12-27 22:46:51,702 [trainer.py] => pi: 1
2024-12-27 22:46:51,702 [trainer.py] => w_bn: 50.0
2024-12-27 22:46:51,702 [trainer.py] => w_noise: 0.001
2024-12-27 22:46:51,702 [trainer.py] => server_ss: 128
2024-12-27 22:46:51,702 [trainer.py] => bn_loss: 1
2024-12-27 22:46:51,702 [trainer.py] => noise: 1
2024-12-27 22:46:51,702 [trainer.py] => ie_loss: 1
2024-12-27 22:46:51,702 [trainer.py] => act_loss: 0
2024-12-27 22:46:51,702 [trainer.py] => w_ie: 1.0
2024-12-27 22:46:51,702 [trainer.py] => w_act: 0.1
2024-12-27 22:46:51,702 [trainer.py] => vpt_type: Deep
2024-12-27 22:46:51,702 [trainer.py] => prompt_token_num: 6
2024-12-27 22:46:51,703 [trainer.py] => avg_alpha: 0.8
2024-12-27 22:46:51,703 [trainer.py] => perturb_var: 1
2024-12-27 22:46:51,703 [trainer.py] => EMA_beta: 0.99
2024-12-27 22:46:51,703 [trainer.py] => anchor_lambda: 0.1
2024-12-27 22:46:51,703 [trainer.py] => kl_weight: 0.001
2024-12-27 22:46:51,703 [trainer.py] => TIP_init: zero
2024-12-27 22:46:51,703 [trainer.py] => tuned_epoch: 20
2024-12-27 22:46:51,703 [trainer.py] => fs_epoch: 0
2024-12-27 22:46:51,703 [trainer.py] => init_lr: 0.01
2024-12-27 22:46:51,703 [trainer.py] => fs_lr: 0.001
2024-12-27 22:46:51,703 [trainer.py] => batch_size: 48
2024-12-27 22:46:51,703 [trainer.py] => fs_batch_size: 16
2024-12-27 22:46:51,703 [trainer.py] => weight_decay: 0.0005
2024-12-27 22:46:51,703 [trainer.py] => min_lr: 0
2024-12-27 22:46:51,703 [trainer.py] => optimizer: sgd
2024-12-27 22:46:51,703 [trainer.py] => memory_size: 0
2024-12-27 22:46:51,703 [trainer.py] => memory_per_class: 0
2024-12-27 22:46:51,703 [trainer.py] => fixed_memory: False
2024-12-27 22:46:51,703 [trainer.py] => shuffle: False
2024-12-27 22:46:51,703 [trainer.py] => top_k: 5
2024-12-27 22:46:51,703 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-27 22:46:51,703 [trainer.py] => prefix: asp
2024-12-27 22:46:51,703 [trainer.py] => model_prefix: asp
2024-12-27 22:46:53,190 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-27 22:47:01,162 [trainer.py] => All params: 173596160
2024-12-27 22:47:01,163 [trainer.py] => Trainable params: 1998848
2024-12-27 22:47:01,805 [asp.py] => Learning on 0-60
2024-12-27 22:47:01,933 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-27 22:47:02,046 [asp.py] => total parameters: 173642241
2024-12-27 22:47:02,046 [asp.py] => trainable parameters: 2044929
2024-12-27 22:47:02,047 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 16:27:28,913 [trainer.py] => config: ./exps/cifar.json
2024-12-28 16:27:28,913 [trainer.py] => model_name: asp
2024-12-28 16:27:28,913 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 16:27:28,913 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 16:27:28,913 [trainer.py] => seed: 2024
2024-12-28 16:27:28,913 [trainer.py] => dataset: cifar224
2024-12-28 16:27:28,913 [trainer.py] => init_cls: 60
2024-12-28 16:27:28,913 [trainer.py] => increment: 5
2024-12-28 16:27:28,913 [trainer.py] => kshot: 5
2024-12-28 16:27:28,913 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 16:27:28,913 [trainer.py] => z_dim: 1000
2024-12-28 16:27:28,913 [trainer.py] => conv_dim: 64
2024-12-28 16:27:28,913 [trainer.py] => img_size: 224
2024-12-28 16:27:28,913 [trainer.py] => generator_lr: 0.001
2024-12-28 16:27:28,913 [trainer.py] => pi: 1
2024-12-28 16:27:28,913 [trainer.py] => w_bn: 50.0
2024-12-28 16:27:28,913 [trainer.py] => w_noise: 0.001
2024-12-28 16:27:28,913 [trainer.py] => server_ss: 128
2024-12-28 16:27:28,913 [trainer.py] => bn_loss: 1
2024-12-28 16:27:28,914 [trainer.py] => noise: 1
2024-12-28 16:27:28,914 [trainer.py] => ie_loss: 1
2024-12-28 16:27:28,914 [trainer.py] => act_loss: 0
2024-12-28 16:27:28,914 [trainer.py] => w_ie: 1.0
2024-12-28 16:27:28,914 [trainer.py] => w_act: 0.1
2024-12-28 16:27:28,914 [trainer.py] => vpt_type: Deep
2024-12-28 16:27:28,914 [trainer.py] => prompt_token_num: 6
2024-12-28 16:27:28,914 [trainer.py] => avg_alpha: 0.8
2024-12-28 16:27:28,914 [trainer.py] => perturb_var: 1
2024-12-28 16:27:28,914 [trainer.py] => EMA_beta: 0.99
2024-12-28 16:27:28,914 [trainer.py] => anchor_lambda: 0.1
2024-12-28 16:27:28,914 [trainer.py] => kl_weight: 0.001
2024-12-28 16:27:28,914 [trainer.py] => TIP_init: zero
2024-12-28 16:27:28,914 [trainer.py] => tuned_epoch: 20
2024-12-28 16:27:28,914 [trainer.py] => fs_epoch: 0
2024-12-28 16:27:28,914 [trainer.py] => init_lr: 0.01
2024-12-28 16:27:28,914 [trainer.py] => fs_lr: 0.001
2024-12-28 16:27:28,914 [trainer.py] => batch_size: 48
2024-12-28 16:27:28,914 [trainer.py] => fs_batch_size: 16
2024-12-28 16:27:28,914 [trainer.py] => weight_decay: 0.0005
2024-12-28 16:27:28,914 [trainer.py] => min_lr: 0
2024-12-28 16:27:28,914 [trainer.py] => optimizer: sgd
2024-12-28 16:27:28,914 [trainer.py] => memory_size: 0
2024-12-28 16:27:28,914 [trainer.py] => memory_per_class: 0
2024-12-28 16:27:28,914 [trainer.py] => fixed_memory: False
2024-12-28 16:27:28,914 [trainer.py] => shuffle: False
2024-12-28 16:27:28,914 [trainer.py] => top_k: 5
2024-12-28 16:27:28,914 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 16:27:28,914 [trainer.py] => prefix: asp
2024-12-28 16:27:28,914 [trainer.py] => model_prefix: asp
2024-12-28 16:27:30,431 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 16:27:50,342 [trainer.py] => config: ./exps/cifar.json
2024-12-28 16:27:50,342 [trainer.py] => model_name: asp
2024-12-28 16:27:50,342 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 16:27:50,342 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 16:27:50,342 [trainer.py] => seed: 2024
2024-12-28 16:27:50,343 [trainer.py] => dataset: cifar224
2024-12-28 16:27:50,343 [trainer.py] => init_cls: 60
2024-12-28 16:27:50,343 [trainer.py] => increment: 5
2024-12-28 16:27:50,343 [trainer.py] => kshot: 5
2024-12-28 16:27:50,343 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 16:27:50,343 [trainer.py] => z_dim: 1000
2024-12-28 16:27:50,343 [trainer.py] => conv_dim: 64
2024-12-28 16:27:50,343 [trainer.py] => img_size: 224
2024-12-28 16:27:50,343 [trainer.py] => generator_lr: 0.001
2024-12-28 16:27:50,343 [trainer.py] => pi: 1
2024-12-28 16:27:50,343 [trainer.py] => w_bn: 50.0
2024-12-28 16:27:50,343 [trainer.py] => w_noise: 0.001
2024-12-28 16:27:50,343 [trainer.py] => server_ss: 128
2024-12-28 16:27:50,343 [trainer.py] => bn_loss: 1
2024-12-28 16:27:50,343 [trainer.py] => noise: 1
2024-12-28 16:27:50,343 [trainer.py] => ie_loss: 1
2024-12-28 16:27:50,343 [trainer.py] => act_loss: 0
2024-12-28 16:27:50,343 [trainer.py] => w_ie: 1.0
2024-12-28 16:27:50,343 [trainer.py] => w_act: 0.1
2024-12-28 16:27:50,343 [trainer.py] => vpt_type: Deep
2024-12-28 16:27:50,343 [trainer.py] => prompt_token_num: 6
2024-12-28 16:27:50,343 [trainer.py] => avg_alpha: 0.8
2024-12-28 16:27:50,343 [trainer.py] => perturb_var: 1
2024-12-28 16:27:50,343 [trainer.py] => EMA_beta: 0.99
2024-12-28 16:27:50,343 [trainer.py] => anchor_lambda: 0.1
2024-12-28 16:27:50,343 [trainer.py] => kl_weight: 0.001
2024-12-28 16:27:50,343 [trainer.py] => TIP_init: zero
2024-12-28 16:27:50,343 [trainer.py] => tuned_epoch: 20
2024-12-28 16:27:50,343 [trainer.py] => fs_epoch: 0
2024-12-28 16:27:50,343 [trainer.py] => init_lr: 0.01
2024-12-28 16:27:50,343 [trainer.py] => fs_lr: 0.001
2024-12-28 16:27:50,343 [trainer.py] => batch_size: 48
2024-12-28 16:27:50,344 [trainer.py] => fs_batch_size: 16
2024-12-28 16:27:50,344 [trainer.py] => weight_decay: 0.0005
2024-12-28 16:27:50,344 [trainer.py] => min_lr: 0
2024-12-28 16:27:50,344 [trainer.py] => optimizer: sgd
2024-12-28 16:27:50,344 [trainer.py] => memory_size: 0
2024-12-28 16:27:50,344 [trainer.py] => memory_per_class: 0
2024-12-28 16:27:50,344 [trainer.py] => fixed_memory: False
2024-12-28 16:27:50,344 [trainer.py] => shuffle: False
2024-12-28 16:27:50,344 [trainer.py] => top_k: 5
2024-12-28 16:27:50,344 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 16:27:50,344 [trainer.py] => prefix: asp
2024-12-28 16:27:50,344 [trainer.py] => model_prefix: asp
2024-12-28 16:27:51,837 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 16:28:01,018 [trainer.py] => All params: 173596160
2024-12-28 16:28:01,019 [trainer.py] => Trainable params: 1998848
2024-12-28 16:28:01,492 [asp.py] => Learning on 0-60
2024-12-28 16:28:01,613 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 16:28:01,702 [asp.py] => total parameters: 173642241
2024-12-28 16:28:01,702 [asp.py] => trainable parameters: 2044929
2024-12-28 16:28:01,703 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 16:54:22,498 [trainer.py] => config: ./exps/cifar.json
2024-12-28 16:54:22,498 [trainer.py] => model_name: asp
2024-12-28 16:54:22,498 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 16:54:22,498 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 16:54:22,498 [trainer.py] => seed: 2024
2024-12-28 16:54:22,498 [trainer.py] => dataset: cifar224
2024-12-28 16:54:22,498 [trainer.py] => init_cls: 60
2024-12-28 16:54:22,498 [trainer.py] => increment: 5
2024-12-28 16:54:22,498 [trainer.py] => kshot: 5
2024-12-28 16:54:22,498 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 16:54:22,498 [trainer.py] => z_dim: 1000
2024-12-28 16:54:22,498 [trainer.py] => conv_dim: 64
2024-12-28 16:54:22,498 [trainer.py] => img_size: 224
2024-12-28 16:54:22,498 [trainer.py] => generator_lr: 0.001
2024-12-28 16:54:22,498 [trainer.py] => pi: 1
2024-12-28 16:54:22,498 [trainer.py] => w_bn: 50.0
2024-12-28 16:54:22,498 [trainer.py] => w_noise: 0.001
2024-12-28 16:54:22,498 [trainer.py] => server_ss: 128
2024-12-28 16:54:22,498 [trainer.py] => bn_loss: 1
2024-12-28 16:54:22,498 [trainer.py] => noise: 1
2024-12-28 16:54:22,498 [trainer.py] => ie_loss: 1
2024-12-28 16:54:22,498 [trainer.py] => act_loss: 0
2024-12-28 16:54:22,498 [trainer.py] => w_ie: 1.0
2024-12-28 16:54:22,498 [trainer.py] => w_act: 0.1
2024-12-28 16:54:22,498 [trainer.py] => vpt_type: Deep
2024-12-28 16:54:22,498 [trainer.py] => prompt_token_num: 6
2024-12-28 16:54:22,498 [trainer.py] => avg_alpha: 0.8
2024-12-28 16:54:22,499 [trainer.py] => perturb_var: 1
2024-12-28 16:54:22,499 [trainer.py] => EMA_beta: 0.99
2024-12-28 16:54:22,499 [trainer.py] => anchor_lambda: 0.1
2024-12-28 16:54:22,499 [trainer.py] => kl_weight: 0.001
2024-12-28 16:54:22,499 [trainer.py] => TIP_init: zero
2024-12-28 16:54:22,499 [trainer.py] => tuned_epoch: 20
2024-12-28 16:54:22,499 [trainer.py] => fs_epoch: 0
2024-12-28 16:54:22,499 [trainer.py] => init_lr: 0.01
2024-12-28 16:54:22,499 [trainer.py] => fs_lr: 0.001
2024-12-28 16:54:22,499 [trainer.py] => batch_size: 48
2024-12-28 16:54:22,499 [trainer.py] => fs_batch_size: 16
2024-12-28 16:54:22,499 [trainer.py] => weight_decay: 0.0005
2024-12-28 16:54:22,499 [trainer.py] => min_lr: 0
2024-12-28 16:54:22,499 [trainer.py] => optimizer: sgd
2024-12-28 16:54:22,499 [trainer.py] => memory_size: 0
2024-12-28 16:54:22,499 [trainer.py] => memory_per_class: 0
2024-12-28 16:54:22,499 [trainer.py] => fixed_memory: False
2024-12-28 16:54:22,499 [trainer.py] => shuffle: False
2024-12-28 16:54:22,499 [trainer.py] => top_k: 5
2024-12-28 16:54:22,499 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 16:54:22,499 [trainer.py] => prefix: asp
2024-12-28 16:54:22,499 [trainer.py] => model_prefix: asp
2024-12-28 16:54:23,948 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 16:54:30,022 [trainer.py] => All params: 173596160
2024-12-28 16:54:30,023 [trainer.py] => Trainable params: 1998848
2024-12-28 16:54:30,496 [asp.py] => Learning on 0-60
2024-12-28 16:54:30,625 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 16:54:30,936 [asp.py] => total parameters: 173642241
2024-12-28 16:54:30,937 [asp.py] => trainable parameters: 2044929
2024-12-28 16:54:30,937 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 17:03:01,596 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:03:01,596 [trainer.py] => model_name: asp
2024-12-28 17:03:01,596 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:03:01,596 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:03:01,596 [trainer.py] => seed: 2024
2024-12-28 17:03:01,596 [trainer.py] => dataset: cifar224
2024-12-28 17:03:01,596 [trainer.py] => init_cls: 60
2024-12-28 17:03:01,596 [trainer.py] => increment: 5
2024-12-28 17:03:01,597 [trainer.py] => kshot: 5
2024-12-28 17:03:01,597 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:03:01,597 [trainer.py] => z_dim: 1000
2024-12-28 17:03:01,597 [trainer.py] => conv_dim: 64
2024-12-28 17:03:01,597 [trainer.py] => img_size: 224
2024-12-28 17:03:01,597 [trainer.py] => generator_lr: 0.001
2024-12-28 17:03:01,597 [trainer.py] => pi: 1
2024-12-28 17:03:01,597 [trainer.py] => w_bn: 50.0
2024-12-28 17:03:01,597 [trainer.py] => w_noise: 0.001
2024-12-28 17:03:01,597 [trainer.py] => server_ss: 128
2024-12-28 17:03:01,597 [trainer.py] => bn_loss: 1
2024-12-28 17:03:01,597 [trainer.py] => noise: 1
2024-12-28 17:03:01,597 [trainer.py] => ie_loss: 1
2024-12-28 17:03:01,597 [trainer.py] => act_loss: 0
2024-12-28 17:03:01,597 [trainer.py] => w_ie: 1.0
2024-12-28 17:03:01,597 [trainer.py] => w_act: 0.1
2024-12-28 17:03:01,597 [trainer.py] => vpt_type: Deep
2024-12-28 17:03:01,597 [trainer.py] => prompt_token_num: 6
2024-12-28 17:03:01,597 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:03:01,597 [trainer.py] => perturb_var: 1
2024-12-28 17:03:01,597 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:03:01,597 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:03:01,597 [trainer.py] => kl_weight: 0.001
2024-12-28 17:03:01,597 [trainer.py] => TIP_init: zero
2024-12-28 17:03:01,597 [trainer.py] => tuned_epoch: 20
2024-12-28 17:03:01,597 [trainer.py] => fs_epoch: 0
2024-12-28 17:03:01,597 [trainer.py] => init_lr: 0.01
2024-12-28 17:03:01,597 [trainer.py] => fs_lr: 0.001
2024-12-28 17:03:01,597 [trainer.py] => batch_size: 48
2024-12-28 17:03:01,597 [trainer.py] => fs_batch_size: 16
2024-12-28 17:03:01,597 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:03:01,598 [trainer.py] => min_lr: 0
2024-12-28 17:03:01,598 [trainer.py] => optimizer: sgd
2024-12-28 17:03:01,598 [trainer.py] => memory_size: 0
2024-12-28 17:03:01,598 [trainer.py] => memory_per_class: 0
2024-12-28 17:03:01,598 [trainer.py] => fixed_memory: False
2024-12-28 17:03:01,598 [trainer.py] => shuffle: False
2024-12-28 17:03:01,598 [trainer.py] => top_k: 5
2024-12-28 17:03:01,598 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:03:01,598 [trainer.py] => prefix: asp
2024-12-28 17:03:01,598 [trainer.py] => model_prefix: asp
2024-12-28 17:03:03,110 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:03:09,367 [trainer.py] => All params: 173596160
2024-12-28 17:03:09,367 [trainer.py] => Trainable params: 1998848
2024-12-28 17:03:09,845 [asp.py] => Learning on 0-60
2024-12-28 17:03:09,978 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 17:03:10,138 [asp.py] => total parameters: 173642241
2024-12-28 17:03:10,138 [asp.py] => trainable parameters: 2044929
2024-12-28 17:03:10,139 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 17:11:22,395 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:11:22,395 [trainer.py] => model_name: asp
2024-12-28 17:11:22,395 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:11:22,395 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:11:22,395 [trainer.py] => seed: 2024
2024-12-28 17:11:22,395 [trainer.py] => dataset: cifar224
2024-12-28 17:11:22,395 [trainer.py] => init_cls: 60
2024-12-28 17:11:22,395 [trainer.py] => increment: 5
2024-12-28 17:11:22,395 [trainer.py] => kshot: 5
2024-12-28 17:11:22,395 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:11:22,395 [trainer.py] => z_dim: 1000
2024-12-28 17:11:22,395 [trainer.py] => conv_dim: 64
2024-12-28 17:11:22,395 [trainer.py] => img_size: 224
2024-12-28 17:11:22,395 [trainer.py] => generator_lr: 0.001
2024-12-28 17:11:22,395 [trainer.py] => pi: 1
2024-12-28 17:11:22,395 [trainer.py] => w_bn: 50.0
2024-12-28 17:11:22,395 [trainer.py] => w_noise: 0.001
2024-12-28 17:11:22,395 [trainer.py] => server_ss: 128
2024-12-28 17:11:22,395 [trainer.py] => bn_loss: 1
2024-12-28 17:11:22,396 [trainer.py] => noise: 1
2024-12-28 17:11:22,396 [trainer.py] => ie_loss: 1
2024-12-28 17:11:22,396 [trainer.py] => act_loss: 0
2024-12-28 17:11:22,396 [trainer.py] => w_ie: 1.0
2024-12-28 17:11:22,396 [trainer.py] => w_act: 0.1
2024-12-28 17:11:22,396 [trainer.py] => vpt_type: Deep
2024-12-28 17:11:22,396 [trainer.py] => prompt_token_num: 6
2024-12-28 17:11:22,396 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:11:22,396 [trainer.py] => perturb_var: 1
2024-12-28 17:11:22,396 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:11:22,396 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:11:22,396 [trainer.py] => kl_weight: 0.001
2024-12-28 17:11:22,396 [trainer.py] => TIP_init: zero
2024-12-28 17:11:22,396 [trainer.py] => tuned_epoch: 20
2024-12-28 17:11:22,396 [trainer.py] => fs_epoch: 0
2024-12-28 17:11:22,396 [trainer.py] => init_lr: 0.01
2024-12-28 17:11:22,396 [trainer.py] => fs_lr: 0.001
2024-12-28 17:11:22,396 [trainer.py] => batch_size: 48
2024-12-28 17:11:22,396 [trainer.py] => fs_batch_size: 16
2024-12-28 17:11:22,396 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:11:22,396 [trainer.py] => min_lr: 0
2024-12-28 17:11:22,396 [trainer.py] => optimizer: sgd
2024-12-28 17:11:22,396 [trainer.py] => memory_size: 0
2024-12-28 17:11:22,396 [trainer.py] => memory_per_class: 0
2024-12-28 17:11:22,396 [trainer.py] => fixed_memory: False
2024-12-28 17:11:22,396 [trainer.py] => shuffle: False
2024-12-28 17:11:22,396 [trainer.py] => top_k: 5
2024-12-28 17:11:22,396 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:11:22,396 [trainer.py] => prefix: asp
2024-12-28 17:11:22,396 [trainer.py] => model_prefix: asp
2024-12-28 17:11:23,879 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:11:29,994 [trainer.py] => All params: 173596160
2024-12-28 17:11:29,994 [trainer.py] => Trainable params: 1998848
2024-12-28 17:11:30,466 [asp.py] => Learning on 60-120
2024-12-28 17:11:30,581 [asp.py] => training set size: 200, fc construct set size: 200
2024-12-28 17:11:30,662 [asp.py] => total parameters: 173688321
2024-12-28 17:11:30,663 [asp.py] => trainable parameters: 2091009
2024-12-28 17:11:30,664 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 17:13:40,244 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:13:40,244 [trainer.py] => model_name: asp
2024-12-28 17:13:40,244 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:13:40,244 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:13:40,244 [trainer.py] => seed: 2024
2024-12-28 17:13:40,244 [trainer.py] => dataset: cifar224
2024-12-28 17:13:40,244 [trainer.py] => init_cls: 60
2024-12-28 17:13:40,244 [trainer.py] => increment: 5
2024-12-28 17:13:40,244 [trainer.py] => kshot: 5
2024-12-28 17:13:40,244 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:13:40,244 [trainer.py] => z_dim: 1000
2024-12-28 17:13:40,244 [trainer.py] => conv_dim: 64
2024-12-28 17:13:40,244 [trainer.py] => img_size: 224
2024-12-28 17:13:40,244 [trainer.py] => generator_lr: 0.001
2024-12-28 17:13:40,244 [trainer.py] => pi: 1
2024-12-28 17:13:40,244 [trainer.py] => w_bn: 50.0
2024-12-28 17:13:40,245 [trainer.py] => w_noise: 0.001
2024-12-28 17:13:40,245 [trainer.py] => server_ss: 128
2024-12-28 17:13:40,245 [trainer.py] => bn_loss: 1
2024-12-28 17:13:40,245 [trainer.py] => noise: 1
2024-12-28 17:13:40,245 [trainer.py] => ie_loss: 1
2024-12-28 17:13:40,245 [trainer.py] => act_loss: 0
2024-12-28 17:13:40,245 [trainer.py] => w_ie: 1.0
2024-12-28 17:13:40,245 [trainer.py] => w_act: 0.1
2024-12-28 17:13:40,245 [trainer.py] => vpt_type: Deep
2024-12-28 17:13:40,245 [trainer.py] => prompt_token_num: 6
2024-12-28 17:13:40,245 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:13:40,245 [trainer.py] => perturb_var: 1
2024-12-28 17:13:40,245 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:13:40,245 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:13:40,245 [trainer.py] => kl_weight: 0.001
2024-12-28 17:13:40,245 [trainer.py] => TIP_init: zero
2024-12-28 17:13:40,245 [trainer.py] => tuned_epoch: 20
2024-12-28 17:13:40,245 [trainer.py] => fs_epoch: 0
2024-12-28 17:13:40,245 [trainer.py] => init_lr: 0.01
2024-12-28 17:13:40,245 [trainer.py] => fs_lr: 0.001
2024-12-28 17:13:40,245 [trainer.py] => batch_size: 48
2024-12-28 17:13:40,245 [trainer.py] => fs_batch_size: 16
2024-12-28 17:13:40,245 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:13:40,245 [trainer.py] => min_lr: 0
2024-12-28 17:13:40,245 [trainer.py] => optimizer: sgd
2024-12-28 17:13:40,245 [trainer.py] => memory_size: 0
2024-12-28 17:13:40,245 [trainer.py] => memory_per_class: 0
2024-12-28 17:13:40,245 [trainer.py] => fixed_memory: False
2024-12-28 17:13:40,245 [trainer.py] => shuffle: False
2024-12-28 17:13:40,246 [trainer.py] => top_k: 5
2024-12-28 17:13:40,246 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:13:40,246 [trainer.py] => prefix: asp
2024-12-28 17:13:40,246 [trainer.py] => model_prefix: asp
2024-12-28 17:13:41,833 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:13:49,612 [trainer.py] => All params: 173596160
2024-12-28 17:13:49,613 [trainer.py] => Trainable params: 1998848
2024-12-28 17:13:50,086 [asp.py] => Learning on 0-60
2024-12-28 17:13:50,254 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 17:13:50,348 [asp.py] => total parameters: 173642241
2024-12-28 17:13:50,349 [asp.py] => trainable parameters: 2044929
2024-12-28 17:13:50,349 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 17:20:03,345 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:20:03,345 [trainer.py] => model_name: asp
2024-12-28 17:20:03,345 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:20:03,345 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:20:03,345 [trainer.py] => seed: 2024
2024-12-28 17:20:03,345 [trainer.py] => dataset: cifar224
2024-12-28 17:20:03,345 [trainer.py] => init_cls: 60
2024-12-28 17:20:03,345 [trainer.py] => increment: 5
2024-12-28 17:20:03,345 [trainer.py] => kshot: 5
2024-12-28 17:20:03,345 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:20:03,345 [trainer.py] => z_dim: 1000
2024-12-28 17:20:03,345 [trainer.py] => conv_dim: 64
2024-12-28 17:20:03,345 [trainer.py] => img_size: 224
2024-12-28 17:20:03,345 [trainer.py] => generator_lr: 0.001
2024-12-28 17:20:03,345 [trainer.py] => pi: 1
2024-12-28 17:20:03,345 [trainer.py] => w_bn: 50.0
2024-12-28 17:20:03,345 [trainer.py] => w_noise: 0.001
2024-12-28 17:20:03,345 [trainer.py] => server_ss: 128
2024-12-28 17:20:03,346 [trainer.py] => bn_loss: 1
2024-12-28 17:20:03,346 [trainer.py] => noise: 1
2024-12-28 17:20:03,346 [trainer.py] => ie_loss: 1
2024-12-28 17:20:03,346 [trainer.py] => act_loss: 0
2024-12-28 17:20:03,346 [trainer.py] => w_ie: 1.0
2024-12-28 17:20:03,346 [trainer.py] => w_act: 0.1
2024-12-28 17:20:03,346 [trainer.py] => vpt_type: Deep
2024-12-28 17:20:03,346 [trainer.py] => prompt_token_num: 6
2024-12-28 17:20:03,346 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:20:03,346 [trainer.py] => perturb_var: 1
2024-12-28 17:20:03,346 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:20:03,346 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:20:03,346 [trainer.py] => kl_weight: 0.001
2024-12-28 17:20:03,346 [trainer.py] => TIP_init: zero
2024-12-28 17:20:03,346 [trainer.py] => tuned_epoch: 20
2024-12-28 17:20:03,346 [trainer.py] => fs_epoch: 0
2024-12-28 17:20:03,346 [trainer.py] => init_lr: 0.01
2024-12-28 17:20:03,346 [trainer.py] => fs_lr: 0.001
2024-12-28 17:20:03,346 [trainer.py] => batch_size: 48
2024-12-28 17:20:03,346 [trainer.py] => fs_batch_size: 16
2024-12-28 17:20:03,346 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:20:03,346 [trainer.py] => min_lr: 0
2024-12-28 17:20:03,346 [trainer.py] => optimizer: sgd
2024-12-28 17:20:03,346 [trainer.py] => memory_size: 0
2024-12-28 17:20:03,346 [trainer.py] => memory_per_class: 0
2024-12-28 17:20:03,346 [trainer.py] => fixed_memory: False
2024-12-28 17:20:03,346 [trainer.py] => shuffle: False
2024-12-28 17:20:03,346 [trainer.py] => top_k: 5
2024-12-28 17:20:03,346 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:20:03,346 [trainer.py] => prefix: asp
2024-12-28 17:20:03,346 [trainer.py] => model_prefix: asp
2024-12-28 17:20:04,817 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:20:10,848 [trainer.py] => All params: 173596160
2024-12-28 17:20:10,849 [trainer.py] => Trainable params: 1998848
2024-12-28 17:20:11,332 [asp.py] => Learning on 0-60
2024-12-28 17:20:11,518 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 17:20:18,940 [asp.py] => total parameters: 173642241
2024-12-28 17:20:18,941 [asp.py] => trainable parameters: 2044929
2024-12-28 17:20:18,942 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 17:20:26,320 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:20:26,320 [trainer.py] => model_name: asp
2024-12-28 17:20:26,320 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:20:26,321 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:20:26,321 [trainer.py] => seed: 2024
2024-12-28 17:20:26,321 [trainer.py] => dataset: cifar224
2024-12-28 17:20:26,321 [trainer.py] => init_cls: 60
2024-12-28 17:20:26,321 [trainer.py] => increment: 5
2024-12-28 17:20:26,321 [trainer.py] => kshot: 5
2024-12-28 17:20:26,321 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:20:26,321 [trainer.py] => z_dim: 1000
2024-12-28 17:20:26,321 [trainer.py] => conv_dim: 64
2024-12-28 17:20:26,321 [trainer.py] => img_size: 224
2024-12-28 17:20:26,321 [trainer.py] => generator_lr: 0.001
2024-12-28 17:20:26,321 [trainer.py] => pi: 1
2024-12-28 17:20:26,321 [trainer.py] => w_bn: 50.0
2024-12-28 17:20:26,321 [trainer.py] => w_noise: 0.001
2024-12-28 17:20:26,321 [trainer.py] => server_ss: 128
2024-12-28 17:20:26,321 [trainer.py] => bn_loss: 1
2024-12-28 17:20:26,321 [trainer.py] => noise: 1
2024-12-28 17:20:26,321 [trainer.py] => ie_loss: 1
2024-12-28 17:20:26,321 [trainer.py] => act_loss: 0
2024-12-28 17:20:26,321 [trainer.py] => w_ie: 1.0
2024-12-28 17:20:26,321 [trainer.py] => w_act: 0.1
2024-12-28 17:20:26,321 [trainer.py] => vpt_type: Deep
2024-12-28 17:20:26,321 [trainer.py] => prompt_token_num: 6
2024-12-28 17:20:26,321 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:20:26,321 [trainer.py] => perturb_var: 1
2024-12-28 17:20:26,321 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:20:26,321 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:20:26,321 [trainer.py] => kl_weight: 0.001
2024-12-28 17:20:26,321 [trainer.py] => TIP_init: zero
2024-12-28 17:20:26,321 [trainer.py] => tuned_epoch: 20
2024-12-28 17:20:26,321 [trainer.py] => fs_epoch: 0
2024-12-28 17:20:26,322 [trainer.py] => init_lr: 0.01
2024-12-28 17:20:26,322 [trainer.py] => fs_lr: 0.001
2024-12-28 17:20:26,322 [trainer.py] => batch_size: 48
2024-12-28 17:20:26,322 [trainer.py] => fs_batch_size: 16
2024-12-28 17:20:26,322 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:20:26,322 [trainer.py] => min_lr: 0
2024-12-28 17:20:26,322 [trainer.py] => optimizer: sgd
2024-12-28 17:20:26,322 [trainer.py] => memory_size: 0
2024-12-28 17:20:26,322 [trainer.py] => memory_per_class: 0
2024-12-28 17:20:26,322 [trainer.py] => fixed_memory: False
2024-12-28 17:20:26,322 [trainer.py] => shuffle: False
2024-12-28 17:20:26,322 [trainer.py] => top_k: 5
2024-12-28 17:20:26,322 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:20:26,322 [trainer.py] => prefix: asp
2024-12-28 17:20:26,322 [trainer.py] => model_prefix: asp
2024-12-28 17:20:27,840 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:20:34,086 [trainer.py] => All params: 173596160
2024-12-28 17:20:34,087 [trainer.py] => Trainable params: 1998848
2024-12-28 17:20:34,545 [asp.py] => Learning on 0-60
2024-12-28 17:20:34,725 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 17:21:05,414 [asp.py] => total parameters: 173642241
2024-12-28 17:21:05,421 [asp.py] => trainable parameters: 2044929
2024-12-28 17:21:05,428 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 17:21:45,684 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:21:45,685 [trainer.py] => model_name: asp
2024-12-28 17:21:45,685 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:21:45,685 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:21:45,685 [trainer.py] => seed: 2024
2024-12-28 17:21:45,685 [trainer.py] => dataset: cifar224
2024-12-28 17:21:45,685 [trainer.py] => init_cls: 60
2024-12-28 17:21:45,685 [trainer.py] => increment: 5
2024-12-28 17:21:45,685 [trainer.py] => kshot: 5
2024-12-28 17:21:45,685 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:21:45,685 [trainer.py] => z_dim: 1000
2024-12-28 17:21:45,685 [trainer.py] => conv_dim: 64
2024-12-28 17:21:45,685 [trainer.py] => img_size: 224
2024-12-28 17:21:45,685 [trainer.py] => generator_lr: 0.001
2024-12-28 17:21:45,685 [trainer.py] => pi: 1
2024-12-28 17:21:45,685 [trainer.py] => w_bn: 50.0
2024-12-28 17:21:45,685 [trainer.py] => w_noise: 0.001
2024-12-28 17:21:45,685 [trainer.py] => server_ss: 128
2024-12-28 17:21:45,685 [trainer.py] => bn_loss: 1
2024-12-28 17:21:45,685 [trainer.py] => noise: 1
2024-12-28 17:21:45,685 [trainer.py] => ie_loss: 1
2024-12-28 17:21:45,685 [trainer.py] => act_loss: 0
2024-12-28 17:21:45,685 [trainer.py] => w_ie: 1.0
2024-12-28 17:21:45,685 [trainer.py] => w_act: 0.1
2024-12-28 17:21:45,685 [trainer.py] => vpt_type: Deep
2024-12-28 17:21:45,685 [trainer.py] => prompt_token_num: 6
2024-12-28 17:21:45,685 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:21:45,685 [trainer.py] => perturb_var: 1
2024-12-28 17:21:45,685 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:21:45,685 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:21:45,686 [trainer.py] => kl_weight: 0.001
2024-12-28 17:21:45,686 [trainer.py] => TIP_init: zero
2024-12-28 17:21:45,686 [trainer.py] => tuned_epoch: 20
2024-12-28 17:21:45,686 [trainer.py] => fs_epoch: 0
2024-12-28 17:21:45,686 [trainer.py] => init_lr: 0.01
2024-12-28 17:21:45,686 [trainer.py] => fs_lr: 0.001
2024-12-28 17:21:45,686 [trainer.py] => batch_size: 48
2024-12-28 17:21:45,686 [trainer.py] => fs_batch_size: 16
2024-12-28 17:21:45,686 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:21:45,686 [trainer.py] => min_lr: 0
2024-12-28 17:21:45,686 [trainer.py] => optimizer: sgd
2024-12-28 17:21:45,686 [trainer.py] => memory_size: 0
2024-12-28 17:21:45,686 [trainer.py] => memory_per_class: 0
2024-12-28 17:21:45,686 [trainer.py] => fixed_memory: False
2024-12-28 17:21:45,686 [trainer.py] => shuffle: False
2024-12-28 17:21:45,686 [trainer.py] => top_k: 5
2024-12-28 17:21:45,686 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:21:45,686 [trainer.py] => prefix: asp
2024-12-28 17:21:45,686 [trainer.py] => model_prefix: asp
2024-12-28 17:21:47,595 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:21:54,083 [trainer.py] => All params: 173596160
2024-12-28 17:21:54,084 [trainer.py] => Trainable params: 1998848
2024-12-28 17:21:54,561 [asp.py] => Learning on 0-60
2024-12-28 17:21:54,648 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 17:21:56,570 [asp.py] => total parameters: 173642241
2024-12-28 17:21:56,571 [asp.py] => trainable parameters: 2044929
2024-12-28 17:21:56,571 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 17:24:30,925 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:24:30,926 [trainer.py] => model_name: asp
2024-12-28 17:24:30,926 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:24:30,926 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:24:30,926 [trainer.py] => seed: 2024
2024-12-28 17:24:30,926 [trainer.py] => dataset: cifar224
2024-12-28 17:24:30,926 [trainer.py] => init_cls: 60
2024-12-28 17:24:30,926 [trainer.py] => increment: 5
2024-12-28 17:24:30,926 [trainer.py] => kshot: 5
2024-12-28 17:24:30,926 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:24:30,926 [trainer.py] => z_dim: 1000
2024-12-28 17:24:30,926 [trainer.py] => conv_dim: 64
2024-12-28 17:24:30,926 [trainer.py] => img_size: 224
2024-12-28 17:24:30,926 [trainer.py] => generator_lr: 0.001
2024-12-28 17:24:30,926 [trainer.py] => pi: 1
2024-12-28 17:24:30,926 [trainer.py] => w_bn: 50.0
2024-12-28 17:24:30,926 [trainer.py] => w_noise: 0.001
2024-12-28 17:24:30,926 [trainer.py] => server_ss: 128
2024-12-28 17:24:30,926 [trainer.py] => bn_loss: 1
2024-12-28 17:24:30,926 [trainer.py] => noise: 1
2024-12-28 17:24:30,926 [trainer.py] => ie_loss: 1
2024-12-28 17:24:30,926 [trainer.py] => act_loss: 0
2024-12-28 17:24:30,926 [trainer.py] => w_ie: 1.0
2024-12-28 17:24:30,926 [trainer.py] => w_act: 0.1
2024-12-28 17:24:30,926 [trainer.py] => vpt_type: Deep
2024-12-28 17:24:30,926 [trainer.py] => prompt_token_num: 6
2024-12-28 17:24:30,926 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:24:30,926 [trainer.py] => perturb_var: 1
2024-12-28 17:24:30,926 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:24:30,926 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:24:30,926 [trainer.py] => kl_weight: 0.001
2024-12-28 17:24:30,927 [trainer.py] => TIP_init: zero
2024-12-28 17:24:30,927 [trainer.py] => tuned_epoch: 20
2024-12-28 17:24:30,927 [trainer.py] => fs_epoch: 0
2024-12-28 17:24:30,927 [trainer.py] => init_lr: 0.01
2024-12-28 17:24:30,927 [trainer.py] => fs_lr: 0.001
2024-12-28 17:24:30,927 [trainer.py] => batch_size: 48
2024-12-28 17:24:30,927 [trainer.py] => fs_batch_size: 16
2024-12-28 17:24:30,927 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:24:30,927 [trainer.py] => min_lr: 0
2024-12-28 17:24:30,927 [trainer.py] => optimizer: sgd
2024-12-28 17:24:30,927 [trainer.py] => memory_size: 0
2024-12-28 17:24:30,927 [trainer.py] => memory_per_class: 0
2024-12-28 17:24:30,927 [trainer.py] => fixed_memory: False
2024-12-28 17:24:30,927 [trainer.py] => shuffle: False
2024-12-28 17:24:30,927 [trainer.py] => top_k: 5
2024-12-28 17:24:30,927 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:24:30,927 [trainer.py] => prefix: asp
2024-12-28 17:24:30,927 [trainer.py] => model_prefix: asp
2024-12-28 17:24:32,411 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:24:38,413 [trainer.py] => All params: 173596160
2024-12-28 17:24:38,414 [trainer.py] => Trainable params: 1998848
2024-12-28 17:24:38,885 [asp.py] => Learning on 0-60
2024-12-28 17:24:39,035 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 17:25:04,928 [asp.py] => total parameters: 173642241
2024-12-28 17:25:04,929 [asp.py] => trainable parameters: 2044929
2024-12-28 17:25:04,929 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 17:31:27,350 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:31:27,350 [trainer.py] => model_name: asp
2024-12-28 17:31:27,350 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:31:27,350 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:31:27,350 [trainer.py] => seed: 2024
2024-12-28 17:31:27,350 [trainer.py] => dataset: cifar224
2024-12-28 17:31:27,350 [trainer.py] => init_cls: 60
2024-12-28 17:31:27,350 [trainer.py] => increment: 5
2024-12-28 17:31:27,351 [trainer.py] => kshot: 5
2024-12-28 17:31:27,351 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:31:27,351 [trainer.py] => z_dim: 1000
2024-12-28 17:31:27,351 [trainer.py] => conv_dim: 64
2024-12-28 17:31:27,351 [trainer.py] => img_size: 224
2024-12-28 17:31:27,351 [trainer.py] => generator_lr: 0.001
2024-12-28 17:31:27,351 [trainer.py] => pi: 1
2024-12-28 17:31:27,351 [trainer.py] => w_bn: 50.0
2024-12-28 17:31:27,351 [trainer.py] => w_noise: 0.001
2024-12-28 17:31:27,351 [trainer.py] => server_ss: 128
2024-12-28 17:31:27,351 [trainer.py] => bn_loss: 1
2024-12-28 17:31:27,351 [trainer.py] => noise: 1
2024-12-28 17:31:27,351 [trainer.py] => ie_loss: 1
2024-12-28 17:31:27,351 [trainer.py] => act_loss: 0
2024-12-28 17:31:27,351 [trainer.py] => w_ie: 1.0
2024-12-28 17:31:27,351 [trainer.py] => w_act: 0.1
2024-12-28 17:31:27,351 [trainer.py] => vpt_type: Deep
2024-12-28 17:31:27,351 [trainer.py] => prompt_token_num: 6
2024-12-28 17:31:27,351 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:31:27,351 [trainer.py] => perturb_var: 1
2024-12-28 17:31:27,351 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:31:27,351 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:31:27,351 [trainer.py] => kl_weight: 0.001
2024-12-28 17:31:27,351 [trainer.py] => TIP_init: zero
2024-12-28 17:31:27,351 [trainer.py] => tuned_epoch: 20
2024-12-28 17:31:27,351 [trainer.py] => fs_epoch: 0
2024-12-28 17:31:27,351 [trainer.py] => init_lr: 0.01
2024-12-28 17:31:27,351 [trainer.py] => fs_lr: 0.001
2024-12-28 17:31:27,351 [trainer.py] => batch_size: 48
2024-12-28 17:31:27,351 [trainer.py] => fs_batch_size: 16
2024-12-28 17:31:27,352 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:31:27,352 [trainer.py] => min_lr: 0
2024-12-28 17:31:27,352 [trainer.py] => optimizer: sgd
2024-12-28 17:31:27,352 [trainer.py] => memory_size: 0
2024-12-28 17:31:27,352 [trainer.py] => memory_per_class: 0
2024-12-28 17:31:27,352 [trainer.py] => fixed_memory: False
2024-12-28 17:31:27,352 [trainer.py] => shuffle: False
2024-12-28 17:31:27,352 [trainer.py] => top_k: 5
2024-12-28 17:31:27,352 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:31:27,352 [trainer.py] => prefix: asp
2024-12-28 17:31:27,352 [trainer.py] => model_prefix: asp
2024-12-28 17:31:28,850 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:31:35,494 [trainer.py] => All params: 173596160
2024-12-28 17:31:35,495 [trainer.py] => Trainable params: 1998848
2024-12-28 17:31:35,966 [asp.py] => Learning on 0-60
2024-12-28 17:31:36,149 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 17:32:11,400 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:32:11,401 [trainer.py] => model_name: asp
2024-12-28 17:32:11,401 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:32:11,401 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:32:11,401 [trainer.py] => seed: 2024
2024-12-28 17:32:11,401 [trainer.py] => dataset: cifar224
2024-12-28 17:32:11,401 [trainer.py] => init_cls: 60
2024-12-28 17:32:11,401 [trainer.py] => increment: 5
2024-12-28 17:32:11,401 [trainer.py] => kshot: 5
2024-12-28 17:32:11,401 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:32:11,401 [trainer.py] => z_dim: 1000
2024-12-28 17:32:11,401 [trainer.py] => conv_dim: 64
2024-12-28 17:32:11,401 [trainer.py] => img_size: 224
2024-12-28 17:32:11,401 [trainer.py] => generator_lr: 0.001
2024-12-28 17:32:11,401 [trainer.py] => pi: 1
2024-12-28 17:32:11,401 [trainer.py] => w_bn: 50.0
2024-12-28 17:32:11,401 [trainer.py] => w_noise: 0.001
2024-12-28 17:32:11,401 [trainer.py] => server_ss: 128
2024-12-28 17:32:11,401 [trainer.py] => bn_loss: 1
2024-12-28 17:32:11,401 [trainer.py] => noise: 1
2024-12-28 17:32:11,401 [trainer.py] => ie_loss: 1
2024-12-28 17:32:11,401 [trainer.py] => act_loss: 0
2024-12-28 17:32:11,401 [trainer.py] => w_ie: 1.0
2024-12-28 17:32:11,401 [trainer.py] => w_act: 0.1
2024-12-28 17:32:11,402 [trainer.py] => vpt_type: Deep
2024-12-28 17:32:11,402 [trainer.py] => prompt_token_num: 6
2024-12-28 17:32:11,402 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:32:11,402 [trainer.py] => perturb_var: 1
2024-12-28 17:32:11,402 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:32:11,402 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:32:11,402 [trainer.py] => kl_weight: 0.001
2024-12-28 17:32:11,402 [trainer.py] => TIP_init: zero
2024-12-28 17:32:11,402 [trainer.py] => tuned_epoch: 20
2024-12-28 17:32:11,402 [trainer.py] => fs_epoch: 0
2024-12-28 17:32:11,402 [trainer.py] => init_lr: 0.01
2024-12-28 17:32:11,402 [trainer.py] => fs_lr: 0.001
2024-12-28 17:32:11,402 [trainer.py] => batch_size: 48
2024-12-28 17:32:11,402 [trainer.py] => fs_batch_size: 16
2024-12-28 17:32:11,402 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:32:11,402 [trainer.py] => min_lr: 0
2024-12-28 17:32:11,402 [trainer.py] => optimizer: sgd
2024-12-28 17:32:11,402 [trainer.py] => memory_size: 0
2024-12-28 17:32:11,402 [trainer.py] => memory_per_class: 0
2024-12-28 17:32:11,402 [trainer.py] => fixed_memory: False
2024-12-28 17:32:11,402 [trainer.py] => shuffle: False
2024-12-28 17:32:11,402 [trainer.py] => top_k: 5
2024-12-28 17:32:11,402 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:32:11,402 [trainer.py] => prefix: asp
2024-12-28 17:32:11,402 [trainer.py] => model_prefix: asp
2024-12-28 17:32:12,900 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:32:19,272 [trainer.py] => All params: 173596160
2024-12-28 17:32:19,273 [trainer.py] => Trainable params: 1998848
2024-12-28 17:32:19,730 [asp.py] => Learning on 0-60
2024-12-28 17:32:19,896 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 17:32:34,746 [asp.py] => total parameters: 173642241
2024-12-28 17:32:34,746 [asp.py] => trainable parameters: 2044929
2024-12-28 17:32:34,747 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 17:39:20,399 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:39:20,399 [trainer.py] => model_name: asp
2024-12-28 17:39:20,399 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:39:20,399 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:39:20,399 [trainer.py] => seed: 2024
2024-12-28 17:39:20,399 [trainer.py] => dataset: cifar224
2024-12-28 17:39:20,399 [trainer.py] => init_cls: 60
2024-12-28 17:39:20,399 [trainer.py] => increment: 5
2024-12-28 17:39:20,399 [trainer.py] => kshot: 5
2024-12-28 17:39:20,399 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:39:20,399 [trainer.py] => z_dim: 1000
2024-12-28 17:39:20,399 [trainer.py] => conv_dim: 64
2024-12-28 17:39:20,399 [trainer.py] => img_size: 224
2024-12-28 17:39:20,399 [trainer.py] => generator_lr: 0.001
2024-12-28 17:39:20,400 [trainer.py] => pi: 1
2024-12-28 17:39:20,400 [trainer.py] => w_bn: 50.0
2024-12-28 17:39:20,400 [trainer.py] => w_noise: 0.001
2024-12-28 17:39:20,400 [trainer.py] => server_ss: 128
2024-12-28 17:39:20,400 [trainer.py] => bn_loss: 1
2024-12-28 17:39:20,400 [trainer.py] => noise: 1
2024-12-28 17:39:20,400 [trainer.py] => ie_loss: 1
2024-12-28 17:39:20,400 [trainer.py] => act_loss: 0
2024-12-28 17:39:20,400 [trainer.py] => w_ie: 1.0
2024-12-28 17:39:20,400 [trainer.py] => w_act: 0.1
2024-12-28 17:39:20,400 [trainer.py] => vpt_type: Deep
2024-12-28 17:39:20,400 [trainer.py] => prompt_token_num: 6
2024-12-28 17:39:20,400 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:39:20,400 [trainer.py] => perturb_var: 1
2024-12-28 17:39:20,400 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:39:20,400 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:39:20,400 [trainer.py] => kl_weight: 0.001
2024-12-28 17:39:20,400 [trainer.py] => TIP_init: zero
2024-12-28 17:39:20,400 [trainer.py] => tuned_epoch: 20
2024-12-28 17:39:20,400 [trainer.py] => fs_epoch: 0
2024-12-28 17:39:20,400 [trainer.py] => init_lr: 0.01
2024-12-28 17:39:20,400 [trainer.py] => fs_lr: 0.001
2024-12-28 17:39:20,400 [trainer.py] => batch_size: 48
2024-12-28 17:39:20,400 [trainer.py] => fs_batch_size: 16
2024-12-28 17:39:20,400 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:39:20,400 [trainer.py] => min_lr: 0
2024-12-28 17:39:20,400 [trainer.py] => optimizer: sgd
2024-12-28 17:39:20,400 [trainer.py] => memory_size: 0
2024-12-28 17:39:20,400 [trainer.py] => memory_per_class: 0
2024-12-28 17:39:20,400 [trainer.py] => fixed_memory: False
2024-12-28 17:39:20,400 [trainer.py] => shuffle: False
2024-12-28 17:39:20,401 [trainer.py] => top_k: 5
2024-12-28 17:39:20,401 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:39:20,401 [trainer.py] => prefix: asp
2024-12-28 17:39:20,401 [trainer.py] => model_prefix: asp
2024-12-28 17:39:21,898 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:39:29,529 [trainer.py] => All params: 173596160
2024-12-28 17:39:29,530 [trainer.py] => Trainable params: 1998848
2024-12-28 17:39:30,012 [asp.py] => Learning on 0-60
2024-12-28 17:39:30,136 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 17:39:30,229 [asp.py] => total parameters: 173642241
2024-12-28 17:39:30,229 [asp.py] => trainable parameters: 2044929
2024-12-28 17:39:30,230 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 17:44:53,272 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:44:53,272 [trainer.py] => model_name: asp
2024-12-28 17:44:53,272 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:44:53,273 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:44:53,273 [trainer.py] => seed: 2024
2024-12-28 17:44:53,273 [trainer.py] => dataset: cifar224
2024-12-28 17:44:53,273 [trainer.py] => init_cls: 60
2024-12-28 17:44:53,273 [trainer.py] => increment: 5
2024-12-28 17:44:53,273 [trainer.py] => kshot: 5
2024-12-28 17:44:53,273 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:44:53,273 [trainer.py] => z_dim: 1000
2024-12-28 17:44:53,273 [trainer.py] => conv_dim: 64
2024-12-28 17:44:53,273 [trainer.py] => img_size: 224
2024-12-28 17:44:53,273 [trainer.py] => generator_lr: 0.001
2024-12-28 17:44:53,273 [trainer.py] => pi: 1
2024-12-28 17:44:53,273 [trainer.py] => w_bn: 50.0
2024-12-28 17:44:53,273 [trainer.py] => w_noise: 0.001
2024-12-28 17:44:53,273 [trainer.py] => server_ss: 128
2024-12-28 17:44:53,273 [trainer.py] => bn_loss: 1
2024-12-28 17:44:53,273 [trainer.py] => noise: 1
2024-12-28 17:44:53,273 [trainer.py] => ie_loss: 1
2024-12-28 17:44:53,273 [trainer.py] => act_loss: 0
2024-12-28 17:44:53,273 [trainer.py] => w_ie: 1.0
2024-12-28 17:44:53,273 [trainer.py] => w_act: 0.1
2024-12-28 17:44:53,273 [trainer.py] => vpt_type: Deep
2024-12-28 17:44:53,273 [trainer.py] => prompt_token_num: 6
2024-12-28 17:44:53,273 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:44:53,273 [trainer.py] => perturb_var: 1
2024-12-28 17:44:53,273 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:44:53,273 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:44:53,273 [trainer.py] => kl_weight: 0.001
2024-12-28 17:44:53,273 [trainer.py] => TIP_init: zero
2024-12-28 17:44:53,274 [trainer.py] => tuned_epoch: 20
2024-12-28 17:44:53,274 [trainer.py] => fs_epoch: 0
2024-12-28 17:44:53,274 [trainer.py] => init_lr: 0.01
2024-12-28 17:44:53,274 [trainer.py] => fs_lr: 0.001
2024-12-28 17:44:53,274 [trainer.py] => batch_size: 48
2024-12-28 17:44:53,274 [trainer.py] => fs_batch_size: 16
2024-12-28 17:44:53,274 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:44:53,274 [trainer.py] => min_lr: 0
2024-12-28 17:44:53,274 [trainer.py] => optimizer: sgd
2024-12-28 17:44:53,274 [trainer.py] => memory_size: 0
2024-12-28 17:44:53,274 [trainer.py] => memory_per_class: 0
2024-12-28 17:44:53,274 [trainer.py] => fixed_memory: False
2024-12-28 17:44:53,274 [trainer.py] => shuffle: False
2024-12-28 17:44:53,274 [trainer.py] => top_k: 5
2024-12-28 17:44:53,274 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:44:53,274 [trainer.py] => prefix: asp
2024-12-28 17:44:53,274 [trainer.py] => model_prefix: asp
2024-12-28 17:44:54,782 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:45:00,991 [trainer.py] => All params: 173596160
2024-12-28 17:45:00,992 [trainer.py] => Trainable params: 1998848
2024-12-28 17:45:01,474 [asp.py] => Learning on 0-60
2024-12-28 17:45:01,578 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 17:45:01,653 [asp.py] => total parameters: 173642241
2024-12-28 17:45:01,654 [asp.py] => trainable parameters: 2044929
2024-12-28 17:45:01,655 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 17:58:56,464 [trainer.py] => config: ./exps/cifar.json
2024-12-28 17:58:56,464 [trainer.py] => model_name: asp
2024-12-28 17:58:56,464 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 17:58:56,464 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 17:58:56,464 [trainer.py] => seed: 2024
2024-12-28 17:58:56,464 [trainer.py] => dataset: cifar224
2024-12-28 17:58:56,464 [trainer.py] => init_cls: 60
2024-12-28 17:58:56,464 [trainer.py] => increment: 5
2024-12-28 17:58:56,464 [trainer.py] => kshot: 5
2024-12-28 17:58:56,464 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 17:58:56,464 [trainer.py] => z_dim: 1000
2024-12-28 17:58:56,464 [trainer.py] => conv_dim: 64
2024-12-28 17:58:56,464 [trainer.py] => img_size: 224
2024-12-28 17:58:56,465 [trainer.py] => generator_lr: 0.001
2024-12-28 17:58:56,465 [trainer.py] => pi: 1
2024-12-28 17:58:56,465 [trainer.py] => w_bn: 50.0
2024-12-28 17:58:56,465 [trainer.py] => w_noise: 0.001
2024-12-28 17:58:56,465 [trainer.py] => server_ss: 128
2024-12-28 17:58:56,465 [trainer.py] => bn_loss: 1
2024-12-28 17:58:56,465 [trainer.py] => noise: 1
2024-12-28 17:58:56,465 [trainer.py] => ie_loss: 1
2024-12-28 17:58:56,465 [trainer.py] => act_loss: 0
2024-12-28 17:58:56,465 [trainer.py] => w_ie: 1.0
2024-12-28 17:58:56,465 [trainer.py] => w_act: 0.1
2024-12-28 17:58:56,465 [trainer.py] => vpt_type: Deep
2024-12-28 17:58:56,465 [trainer.py] => prompt_token_num: 6
2024-12-28 17:58:56,465 [trainer.py] => avg_alpha: 0.8
2024-12-28 17:58:56,465 [trainer.py] => perturb_var: 1
2024-12-28 17:58:56,465 [trainer.py] => EMA_beta: 0.99
2024-12-28 17:58:56,465 [trainer.py] => anchor_lambda: 0.1
2024-12-28 17:58:56,465 [trainer.py] => kl_weight: 0.001
2024-12-28 17:58:56,465 [trainer.py] => TIP_init: zero
2024-12-28 17:58:56,465 [trainer.py] => tuned_epoch: 20
2024-12-28 17:58:56,465 [trainer.py] => fs_epoch: 0
2024-12-28 17:58:56,465 [trainer.py] => init_lr: 0.01
2024-12-28 17:58:56,465 [trainer.py] => fs_lr: 0.001
2024-12-28 17:58:56,465 [trainer.py] => batch_size: 48
2024-12-28 17:58:56,465 [trainer.py] => fs_batch_size: 16
2024-12-28 17:58:56,465 [trainer.py] => weight_decay: 0.0005
2024-12-28 17:58:56,465 [trainer.py] => min_lr: 0
2024-12-28 17:58:56,465 [trainer.py] => optimizer: sgd
2024-12-28 17:58:56,465 [trainer.py] => memory_size: 0
2024-12-28 17:58:56,465 [trainer.py] => memory_per_class: 0
2024-12-28 17:58:56,465 [trainer.py] => fixed_memory: False
2024-12-28 17:58:56,465 [trainer.py] => shuffle: False
2024-12-28 17:58:56,466 [trainer.py] => top_k: 5
2024-12-28 17:58:56,466 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 17:58:56,466 [trainer.py] => prefix: asp
2024-12-28 17:58:56,466 [trainer.py] => model_prefix: asp
2024-12-28 17:58:57,953 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 17:59:03,813 [trainer.py] => All params: 173596160
2024-12-28 17:59:03,814 [trainer.py] => Trainable params: 1998848
2024-12-28 17:59:04,295 [asp.py] => Learning on 0-60
2024-12-28 17:59:04,454 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 17:59:04,605 [asp.py] => total parameters: 173642241
2024-12-28 17:59:04,606 [asp.py] => trainable parameters: 2044929
2024-12-28 17:59:04,606 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 18:05:14,925 [trainer.py] => config: ./exps/cifar.json
2024-12-28 18:05:14,925 [trainer.py] => model_name: asp
2024-12-28 18:05:14,925 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 18:05:14,925 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 18:05:14,925 [trainer.py] => seed: 2024
2024-12-28 18:05:14,925 [trainer.py] => dataset: cifar224
2024-12-28 18:05:14,925 [trainer.py] => init_cls: 60
2024-12-28 18:05:14,925 [trainer.py] => increment: 5
2024-12-28 18:05:14,925 [trainer.py] => kshot: 5
2024-12-28 18:05:14,926 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 18:05:14,926 [trainer.py] => z_dim: 1000
2024-12-28 18:05:14,926 [trainer.py] => conv_dim: 64
2024-12-28 18:05:14,926 [trainer.py] => img_size: 224
2024-12-28 18:05:14,926 [trainer.py] => generator_lr: 0.001
2024-12-28 18:05:14,926 [trainer.py] => pi: 1
2024-12-28 18:05:14,926 [trainer.py] => w_bn: 50.0
2024-12-28 18:05:14,926 [trainer.py] => w_noise: 0.001
2024-12-28 18:05:14,926 [trainer.py] => server_ss: 128
2024-12-28 18:05:14,926 [trainer.py] => bn_loss: 1
2024-12-28 18:05:14,926 [trainer.py] => noise: 1
2024-12-28 18:05:14,926 [trainer.py] => ie_loss: 1
2024-12-28 18:05:14,926 [trainer.py] => act_loss: 0
2024-12-28 18:05:14,926 [trainer.py] => w_ie: 1.0
2024-12-28 18:05:14,926 [trainer.py] => w_act: 0.1
2024-12-28 18:05:14,926 [trainer.py] => vpt_type: Deep
2024-12-28 18:05:14,926 [trainer.py] => prompt_token_num: 6
2024-12-28 18:05:14,926 [trainer.py] => avg_alpha: 0.8
2024-12-28 18:05:14,926 [trainer.py] => perturb_var: 1
2024-12-28 18:05:14,926 [trainer.py] => EMA_beta: 0.99
2024-12-28 18:05:14,926 [trainer.py] => anchor_lambda: 0.1
2024-12-28 18:05:14,926 [trainer.py] => kl_weight: 0.001
2024-12-28 18:05:14,926 [trainer.py] => TIP_init: zero
2024-12-28 18:05:14,926 [trainer.py] => tuned_epoch: 20
2024-12-28 18:05:14,926 [trainer.py] => fs_epoch: 0
2024-12-28 18:05:14,926 [trainer.py] => init_lr: 0.01
2024-12-28 18:05:14,926 [trainer.py] => fs_lr: 0.001
2024-12-28 18:05:14,926 [trainer.py] => batch_size: 48
2024-12-28 18:05:14,926 [trainer.py] => fs_batch_size: 16
2024-12-28 18:05:14,926 [trainer.py] => weight_decay: 0.0005
2024-12-28 18:05:14,927 [trainer.py] => min_lr: 0
2024-12-28 18:05:14,927 [trainer.py] => optimizer: sgd
2024-12-28 18:05:14,927 [trainer.py] => memory_size: 0
2024-12-28 18:05:14,927 [trainer.py] => memory_per_class: 0
2024-12-28 18:05:14,927 [trainer.py] => fixed_memory: False
2024-12-28 18:05:14,927 [trainer.py] => shuffle: False
2024-12-28 18:05:14,927 [trainer.py] => top_k: 5
2024-12-28 18:05:14,927 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 18:05:14,927 [trainer.py] => prefix: asp
2024-12-28 18:05:14,927 [trainer.py] => model_prefix: asp
2024-12-28 18:05:16,417 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 18:05:22,625 [trainer.py] => All params: 173596160
2024-12-28 18:05:22,626 [trainer.py] => Trainable params: 1998848
2024-12-28 18:05:23,115 [asp.py] => Learning on 0-60
2024-12-28 18:05:23,225 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 18:05:23,310 [asp.py] => total parameters: 173642241
2024-12-28 18:05:23,311 [asp.py] => trainable parameters: 2044929
2024-12-28 18:05:23,311 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 18:10:49,426 [trainer.py] => config: ./exps/cifar.json
2024-12-28 18:10:49,427 [trainer.py] => model_name: asp
2024-12-28 18:10:49,427 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 18:10:49,427 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 18:10:49,427 [trainer.py] => seed: 2024
2024-12-28 18:10:49,427 [trainer.py] => dataset: cifar224
2024-12-28 18:10:49,427 [trainer.py] => init_cls: 60
2024-12-28 18:10:49,427 [trainer.py] => increment: 5
2024-12-28 18:10:49,427 [trainer.py] => kshot: 5
2024-12-28 18:10:49,427 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 18:10:49,427 [trainer.py] => z_dim: 1000
2024-12-28 18:10:49,427 [trainer.py] => conv_dim: 64
2024-12-28 18:10:49,427 [trainer.py] => img_size: 224
2024-12-28 18:10:49,427 [trainer.py] => generator_lr: 0.001
2024-12-28 18:10:49,427 [trainer.py] => pi: 1
2024-12-28 18:10:49,427 [trainer.py] => w_bn: 50.0
2024-12-28 18:10:49,427 [trainer.py] => w_noise: 0.001
2024-12-28 18:10:49,427 [trainer.py] => server_ss: 128
2024-12-28 18:10:49,427 [trainer.py] => bn_loss: 1
2024-12-28 18:10:49,427 [trainer.py] => noise: 1
2024-12-28 18:10:49,427 [trainer.py] => ie_loss: 1
2024-12-28 18:10:49,427 [trainer.py] => act_loss: 0
2024-12-28 18:10:49,427 [trainer.py] => w_ie: 1.0
2024-12-28 18:10:49,427 [trainer.py] => w_act: 0.1
2024-12-28 18:10:49,427 [trainer.py] => vpt_type: Deep
2024-12-28 18:10:49,427 [trainer.py] => prompt_token_num: 6
2024-12-28 18:10:49,427 [trainer.py] => avg_alpha: 0.8
2024-12-28 18:10:49,428 [trainer.py] => perturb_var: 1
2024-12-28 18:10:49,428 [trainer.py] => EMA_beta: 0.99
2024-12-28 18:10:49,428 [trainer.py] => anchor_lambda: 0.1
2024-12-28 18:10:49,428 [trainer.py] => kl_weight: 0.001
2024-12-28 18:10:49,428 [trainer.py] => TIP_init: zero
2024-12-28 18:10:49,428 [trainer.py] => tuned_epoch: 20
2024-12-28 18:10:49,428 [trainer.py] => fs_epoch: 0
2024-12-28 18:10:49,428 [trainer.py] => init_lr: 0.01
2024-12-28 18:10:49,428 [trainer.py] => fs_lr: 0.001
2024-12-28 18:10:49,428 [trainer.py] => batch_size: 48
2024-12-28 18:10:49,428 [trainer.py] => fs_batch_size: 16
2024-12-28 18:10:49,428 [trainer.py] => weight_decay: 0.0005
2024-12-28 18:10:49,428 [trainer.py] => min_lr: 0
2024-12-28 18:10:49,428 [trainer.py] => optimizer: sgd
2024-12-28 18:10:49,428 [trainer.py] => memory_size: 0
2024-12-28 18:10:49,428 [trainer.py] => memory_per_class: 0
2024-12-28 18:10:49,428 [trainer.py] => fixed_memory: False
2024-12-28 18:10:49,428 [trainer.py] => shuffle: False
2024-12-28 18:10:49,428 [trainer.py] => top_k: 5
2024-12-28 18:10:49,428 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 18:10:49,428 [trainer.py] => prefix: asp
2024-12-28 18:10:49,428 [trainer.py] => model_prefix: asp
2024-12-28 18:10:50,932 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 18:10:56,909 [trainer.py] => All params: 173596160
2024-12-28 18:10:56,910 [trainer.py] => Trainable params: 1998848
2024-12-28 18:10:57,389 [asp.py] => Learning on 0-60
2024-12-28 18:10:57,483 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 18:10:57,568 [asp.py] => total parameters: 173642241
2024-12-28 18:10:57,569 [asp.py] => trainable parameters: 2044929
2024-12-28 18:10:57,569 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 18:17:45,227 [trainer.py] => Top1 curve: [91.82]
2024-12-28 18:17:45,227 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-28 18:17:45,228 [trainer.py] => All params: 173642241
2024-12-28 18:17:45,229 [trainer.py] => Trainable params: 2044929
2024-12-28 18:17:45,230 [asp.py] => Learning on 60-65
2024-12-28 18:17:45,242 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-28 18:17:45,245 [asp.py] => total parameters: 173646081
2024-12-28 18:17:45,245 [asp.py] => trainable parameters: 2048769
2024-12-28 18:18:27,275 [trainer.py] => config: ./exps/cifar.json
2024-12-28 18:18:27,276 [trainer.py] => model_name: asp
2024-12-28 18:18:27,276 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 18:18:27,276 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 18:18:27,276 [trainer.py] => seed: 2024
2024-12-28 18:18:27,276 [trainer.py] => dataset: cifar224
2024-12-28 18:18:27,276 [trainer.py] => init_cls: 60
2024-12-28 18:18:27,276 [trainer.py] => increment: 5
2024-12-28 18:18:27,276 [trainer.py] => kshot: 5
2024-12-28 18:18:27,276 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 18:18:27,276 [trainer.py] => z_dim: 1000
2024-12-28 18:18:27,276 [trainer.py] => conv_dim: 64
2024-12-28 18:18:27,276 [trainer.py] => img_size: 224
2024-12-28 18:18:27,276 [trainer.py] => generator_lr: 0.001
2024-12-28 18:18:27,276 [trainer.py] => pi: 1
2024-12-28 18:18:27,276 [trainer.py] => w_bn: 50.0
2024-12-28 18:18:27,276 [trainer.py] => w_noise: 0.001
2024-12-28 18:18:27,276 [trainer.py] => server_ss: 128
2024-12-28 18:18:27,276 [trainer.py] => bn_loss: 1
2024-12-28 18:18:27,276 [trainer.py] => noise: 1
2024-12-28 18:18:27,276 [trainer.py] => ie_loss: 1
2024-12-28 18:18:27,276 [trainer.py] => act_loss: 0
2024-12-28 18:18:27,276 [trainer.py] => w_ie: 1.0
2024-12-28 18:18:27,276 [trainer.py] => w_act: 0.1
2024-12-28 18:18:27,276 [trainer.py] => vpt_type: Deep
2024-12-28 18:18:27,276 [trainer.py] => prompt_token_num: 6
2024-12-28 18:18:27,276 [trainer.py] => avg_alpha: 0.8
2024-12-28 18:18:27,277 [trainer.py] => perturb_var: 1
2024-12-28 18:18:27,277 [trainer.py] => EMA_beta: 0.99
2024-12-28 18:18:27,277 [trainer.py] => anchor_lambda: 0.1
2024-12-28 18:18:27,277 [trainer.py] => kl_weight: 0.001
2024-12-28 18:18:27,277 [trainer.py] => TIP_init: zero
2024-12-28 18:18:27,277 [trainer.py] => tuned_epoch: 20
2024-12-28 18:18:27,277 [trainer.py] => fs_epoch: 0
2024-12-28 18:18:27,277 [trainer.py] => init_lr: 0.01
2024-12-28 18:18:27,277 [trainer.py] => fs_lr: 0.001
2024-12-28 18:18:27,277 [trainer.py] => batch_size: 48
2024-12-28 18:18:27,277 [trainer.py] => fs_batch_size: 16
2024-12-28 18:18:27,277 [trainer.py] => weight_decay: 0.0005
2024-12-28 18:18:27,277 [trainer.py] => min_lr: 0
2024-12-28 18:18:27,277 [trainer.py] => optimizer: sgd
2024-12-28 18:18:27,277 [trainer.py] => memory_size: 0
2024-12-28 18:18:27,277 [trainer.py] => memory_per_class: 0
2024-12-28 18:18:27,277 [trainer.py] => fixed_memory: False
2024-12-28 18:18:27,277 [trainer.py] => shuffle: False
2024-12-28 18:18:27,277 [trainer.py] => top_k: 5
2024-12-28 18:18:27,277 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 18:18:27,277 [trainer.py] => prefix: asp
2024-12-28 18:18:27,277 [trainer.py] => model_prefix: asp
2024-12-28 18:18:28,767 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 18:18:35,089 [trainer.py] => All params: 173596160
2024-12-28 18:18:35,090 [trainer.py] => Trainable params: 1998848
2024-12-28 18:18:35,605 [asp.py] => Learning on 0-60
2024-12-28 18:18:35,737 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 18:18:36,145 [asp.py] => total parameters: 173642241
2024-12-28 18:18:36,146 [asp.py] => trainable parameters: 2044929
2024-12-28 18:18:36,146 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 18:29:27,447 [trainer.py] => Top1 curve: [91.82]
2024-12-28 18:29:27,447 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-28 18:29:27,448 [trainer.py] => All params: 173642241
2024-12-28 18:29:27,448 [trainer.py] => Trainable params: 2044929
2024-12-28 18:29:27,449 [asp.py] => Learning on 60-65
2024-12-28 18:29:27,461 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-28 18:29:27,463 [asp.py] => total parameters: 173646081
2024-12-28 18:29:27,464 [asp.py] => trainable parameters: 2048769
2024-12-28 18:30:06,273 [trainer.py] => config: ./exps/cifar.json
2024-12-28 18:30:06,273 [trainer.py] => model_name: asp
2024-12-28 18:30:06,273 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 18:30:06,273 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 18:30:06,273 [trainer.py] => seed: 2024
2024-12-28 18:30:06,273 [trainer.py] => dataset: cifar224
2024-12-28 18:30:06,273 [trainer.py] => init_cls: 60
2024-12-28 18:30:06,273 [trainer.py] => increment: 5
2024-12-28 18:30:06,273 [trainer.py] => kshot: 5
2024-12-28 18:30:06,273 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 18:30:06,273 [trainer.py] => z_dim: 1000
2024-12-28 18:30:06,273 [trainer.py] => conv_dim: 64
2024-12-28 18:30:06,273 [trainer.py] => img_size: 224
2024-12-28 18:30:06,274 [trainer.py] => generator_lr: 0.001
2024-12-28 18:30:06,274 [trainer.py] => pi: 1
2024-12-28 18:30:06,274 [trainer.py] => w_bn: 50.0
2024-12-28 18:30:06,274 [trainer.py] => w_noise: 0.001
2024-12-28 18:30:06,274 [trainer.py] => server_ss: 128
2024-12-28 18:30:06,274 [trainer.py] => bn_loss: 1
2024-12-28 18:30:06,274 [trainer.py] => noise: 1
2024-12-28 18:30:06,274 [trainer.py] => ie_loss: 1
2024-12-28 18:30:06,274 [trainer.py] => act_loss: 0
2024-12-28 18:30:06,274 [trainer.py] => w_ie: 1.0
2024-12-28 18:30:06,274 [trainer.py] => w_act: 0.1
2024-12-28 18:30:06,274 [trainer.py] => vpt_type: Deep
2024-12-28 18:30:06,274 [trainer.py] => prompt_token_num: 6
2024-12-28 18:30:06,274 [trainer.py] => avg_alpha: 0.8
2024-12-28 18:30:06,274 [trainer.py] => perturb_var: 1
2024-12-28 18:30:06,274 [trainer.py] => EMA_beta: 0.99
2024-12-28 18:30:06,274 [trainer.py] => anchor_lambda: 0.1
2024-12-28 18:30:06,274 [trainer.py] => kl_weight: 0.001
2024-12-28 18:30:06,274 [trainer.py] => TIP_init: zero
2024-12-28 18:30:06,274 [trainer.py] => tuned_epoch: 20
2024-12-28 18:30:06,274 [trainer.py] => fs_epoch: 0
2024-12-28 18:30:06,274 [trainer.py] => init_lr: 0.01
2024-12-28 18:30:06,274 [trainer.py] => fs_lr: 0.001
2024-12-28 18:30:06,274 [trainer.py] => batch_size: 48
2024-12-28 18:30:06,274 [trainer.py] => fs_batch_size: 16
2024-12-28 18:30:06,274 [trainer.py] => weight_decay: 0.0005
2024-12-28 18:30:06,274 [trainer.py] => min_lr: 0
2024-12-28 18:30:06,275 [trainer.py] => optimizer: sgd
2024-12-28 18:30:06,275 [trainer.py] => memory_size: 0
2024-12-28 18:30:06,275 [trainer.py] => memory_per_class: 0
2024-12-28 18:30:06,275 [trainer.py] => fixed_memory: False
2024-12-28 18:30:06,275 [trainer.py] => shuffle: False
2024-12-28 18:30:06,275 [trainer.py] => top_k: 5
2024-12-28 18:30:06,275 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 18:30:06,275 [trainer.py] => prefix: asp
2024-12-28 18:30:06,275 [trainer.py] => model_prefix: asp
2024-12-28 18:30:07,774 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 18:30:14,092 [trainer.py] => All params: 173596160
2024-12-28 18:30:14,093 [trainer.py] => Trainable params: 1998848
2024-12-28 18:30:14,616 [asp.py] => Learning on 0-60
2024-12-28 18:30:14,717 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 18:30:14,807 [asp.py] => total parameters: 173642241
2024-12-28 18:30:14,808 [asp.py] => trainable parameters: 2044929
2024-12-28 18:30:14,808 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 18:34:39,191 [trainer.py] => Top1 curve: [91.82]
2024-12-28 18:34:39,191 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-28 18:34:39,192 [trainer.py] => All params: 173642241
2024-12-28 18:34:39,193 [trainer.py] => Trainable params: 2044929
2024-12-28 18:34:39,194 [asp.py] => Learning on 60-65
2024-12-28 18:34:39,205 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-28 18:34:39,208 [asp.py] => total parameters: 173646081
2024-12-28 18:34:39,209 [asp.py] => trainable parameters: 2048769
2024-12-28 18:35:16,326 [trainer.py] => Top1 curve: [91.82, 90.09]
2024-12-28 18:35:16,326 [trainer.py] => Average Accuracy (Top1): 90.955   (Harmonic Accuracy): 81.21629014284267 (Old Acc): 91.51666666666667 (New Acc): 73.0 

2024-12-28 18:35:16,327 [trainer.py] => All params: 173646081
2024-12-28 18:35:16,328 [trainer.py] => Trainable params: 2048769
2024-12-28 18:35:16,329 [asp.py] => Learning on 65-70
2024-12-28 18:35:16,339 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-28 18:35:16,342 [asp.py] => total parameters: 173649921
2024-12-28 18:35:16,343 [asp.py] => trainable parameters: 2052609
2024-12-28 18:35:56,159 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5]
2024-12-28 18:35:56,159 [trainer.py] => Average Accuracy (Top1): 90.46999999999998   (Harmonic Accuracy): 84.12586614173229 (Old Acc): 91.43333333333334 (New Acc): 77.9 

2024-12-28 18:35:56,160 [trainer.py] => All params: 173649921
2024-12-28 18:35:56,161 [trainer.py] => Trainable params: 2052609
2024-12-28 18:35:56,162 [asp.py] => Learning on 70-75
2024-12-28 18:35:56,178 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-28 18:35:56,181 [asp.py] => total parameters: 173653761
2024-12-28 18:35:56,182 [asp.py] => trainable parameters: 2056449
2024-12-28 18:36:38,463 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29]
2024-12-28 18:36:38,465 [trainer.py] => Average Accuracy (Top1): 89.925   (Harmonic Accuracy): 83.33658891645989 (Old Acc): 91.18333333333334 (New Acc): 76.73333333333333 

2024-12-28 18:36:38,466 [trainer.py] => All params: 173653761
2024-12-28 18:36:38,467 [trainer.py] => Trainable params: 2056449
2024-12-28 18:36:38,468 [asp.py] => Learning on 75-80
2024-12-28 18:36:38,485 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-28 18:36:38,488 [asp.py] => total parameters: 173657601
2024-12-28 18:36:38,489 [asp.py] => trainable parameters: 2060289
2024-12-28 18:37:21,454 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32]
2024-12-28 18:37:21,454 [trainer.py] => Average Accuracy (Top1): 89.604   (Harmonic Accuracy): 85.14776846618592 (Old Acc): 91.13333333333334 (New Acc): 79.9 

2024-12-28 18:37:21,455 [trainer.py] => All params: 173657601
2024-12-28 18:37:21,456 [trainer.py] => Trainable params: 2060289
2024-12-28 18:37:21,457 [asp.py] => Learning on 80-85
2024-12-28 18:37:21,475 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-28 18:37:21,478 [asp.py] => total parameters: 173661441
2024-12-28 18:37:21,479 [asp.py] => trainable parameters: 2064129
2024-12-28 18:38:09,288 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48]
2024-12-28 18:38:09,288 [trainer.py] => Average Accuracy (Top1): 89.25   (Harmonic Accuracy): 84.56792815404528 (Old Acc): 91.03333333333335 (New Acc): 78.96000000000001 

2024-12-28 18:38:09,289 [trainer.py] => All params: 173661441
2024-12-28 18:38:09,290 [trainer.py] => Trainable params: 2064129
2024-12-28 18:38:09,291 [asp.py] => Learning on 85-90
2024-12-28 18:38:09,311 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-28 18:38:09,313 [asp.py] => total parameters: 173665281
2024-12-28 18:38:09,314 [asp.py] => trainable parameters: 2067969
2024-12-28 18:38:59,251 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48, 87.39]
2024-12-28 18:38:59,251 [trainer.py] => Average Accuracy (Top1): 88.98428571428572   (Harmonic Accuracy): 85.33226957254978 (Old Acc): 90.86666666666666 (New Acc): 80.43333333333334 

2024-12-28 18:38:59,252 [trainer.py] => All params: 173665281
2024-12-28 18:38:59,253 [trainer.py] => Trainable params: 2067969
2024-12-28 18:38:59,254 [asp.py] => Learning on 90-95
2024-12-28 18:38:59,267 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-28 18:38:59,269 [asp.py] => total parameters: 173669121
2024-12-28 18:38:59,270 [asp.py] => trainable parameters: 2071809
2024-12-28 18:39:51,982 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48, 87.39, 87.03]
2024-12-28 18:39:51,982 [trainer.py] => Average Accuracy (Top1): 88.74   (Harmonic Accuracy): 85.4064258032254 (Old Acc): 90.75 (New Acc): 80.65714285714286 

2024-12-28 18:39:51,983 [trainer.py] => All params: 173669121
2024-12-28 18:39:51,984 [trainer.py] => Trainable params: 2071809
2024-12-28 18:39:51,985 [asp.py] => Learning on 95-100
2024-12-28 18:39:52,010 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-28 18:39:52,013 [asp.py] => total parameters: 173672961
2024-12-28 18:39:52,014 [asp.py] => trainable parameters: 2075649
2024-12-28 18:40:47,349 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48, 87.39, 87.03, 85.89]
2024-12-28 18:40:47,349 [trainer.py] => Average Accuracy (Top1): 88.42333333333333   (Harmonic Accuracy): 84.31746422072493 (Old Acc): 90.56666666666666 (New Acc): 78.875 

2024-12-28 18:40:47,349 [trainer.py] => 

2024-12-28 22:56:29,375 [trainer.py] => config: ./exps/cifar.json
2024-12-28 22:56:29,375 [trainer.py] => model_name: asp
2024-12-28 22:56:29,375 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 22:56:29,375 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 22:56:29,375 [trainer.py] => seed: 2024
2024-12-28 22:56:29,375 [trainer.py] => dataset: cifar224
2024-12-28 22:56:29,375 [trainer.py] => init_cls: 60
2024-12-28 22:56:29,375 [trainer.py] => increment: 5
2024-12-28 22:56:29,375 [trainer.py] => kshot: 5
2024-12-28 22:56:29,375 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 22:56:29,375 [trainer.py] => z_dim: 1000
2024-12-28 22:56:29,375 [trainer.py] => conv_dim: 64
2024-12-28 22:56:29,375 [trainer.py] => img_size: 224
2024-12-28 22:56:29,375 [trainer.py] => generator_lr: 0.001
2024-12-28 22:56:29,375 [trainer.py] => pi: 1
2024-12-28 22:56:29,375 [trainer.py] => w_bn: 50.0
2024-12-28 22:56:29,375 [trainer.py] => w_noise: 0.001
2024-12-28 22:56:29,375 [trainer.py] => server_ss: 128
2024-12-28 22:56:29,376 [trainer.py] => bn_loss: 1
2024-12-28 22:56:29,376 [trainer.py] => noise: 1
2024-12-28 22:56:29,376 [trainer.py] => ie_loss: 1
2024-12-28 22:56:29,376 [trainer.py] => act_loss: 0
2024-12-28 22:56:29,376 [trainer.py] => w_ie: 1.0
2024-12-28 22:56:29,376 [trainer.py] => w_act: 0.1
2024-12-28 22:56:29,376 [trainer.py] => vpt_type: Deep
2024-12-28 22:56:29,376 [trainer.py] => prompt_token_num: 6
2024-12-28 22:56:29,376 [trainer.py] => avg_alpha: 0.8
2024-12-28 22:56:29,376 [trainer.py] => perturb_var: 1
2024-12-28 22:56:29,376 [trainer.py] => EMA_beta: 0.99
2024-12-28 22:56:29,376 [trainer.py] => anchor_lambda: 0.1
2024-12-28 22:56:29,376 [trainer.py] => kl_weight: 0.001
2024-12-28 22:56:29,376 [trainer.py] => TIP_init: zero
2024-12-28 22:56:29,376 [trainer.py] => tuned_epoch: 20
2024-12-28 22:56:29,376 [trainer.py] => fs_epoch: 0
2024-12-28 22:56:29,376 [trainer.py] => init_lr: 0.01
2024-12-28 22:56:29,376 [trainer.py] => fs_lr: 0.001
2024-12-28 22:56:29,376 [trainer.py] => batch_size: 48
2024-12-28 22:56:29,376 [trainer.py] => fs_batch_size: 16
2024-12-28 22:56:29,376 [trainer.py] => weight_decay: 0.0005
2024-12-28 22:56:29,376 [trainer.py] => min_lr: 0
2024-12-28 22:56:29,376 [trainer.py] => optimizer: sgd
2024-12-28 22:56:29,376 [trainer.py] => memory_size: 0
2024-12-28 22:56:29,376 [trainer.py] => memory_per_class: 0
2024-12-28 22:56:29,376 [trainer.py] => fixed_memory: False
2024-12-28 22:56:29,376 [trainer.py] => shuffle: False
2024-12-28 22:56:29,376 [trainer.py] => top_k: 5
2024-12-28 22:56:29,376 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 22:56:29,376 [trainer.py] => prefix: asp
2024-12-28 22:56:29,376 [trainer.py] => model_prefix: asp
2024-12-28 22:56:30,965 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 22:56:37,059 [trainer.py] => All params: 173596160
2024-12-28 22:56:37,060 [trainer.py] => Trainable params: 1998848
2024-12-28 22:56:37,541 [asp.py] => Learning on 0-60
2024-12-28 22:56:37,625 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 22:56:37,708 [asp.py] => total parameters: 173642241
2024-12-28 22:56:37,709 [asp.py] => trainable parameters: 2044929
2024-12-28 22:56:37,709 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 22:57:01,227 [trainer.py] => config: ./exps/cifar.json
2024-12-28 22:57:01,227 [trainer.py] => model_name: asp
2024-12-28 22:57:01,227 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 22:57:01,227 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 22:57:01,227 [trainer.py] => seed: 2024
2024-12-28 22:57:01,227 [trainer.py] => dataset: cifar224
2024-12-28 22:57:01,227 [trainer.py] => init_cls: 60
2024-12-28 22:57:01,227 [trainer.py] => increment: 5
2024-12-28 22:57:01,228 [trainer.py] => kshot: 5
2024-12-28 22:57:01,228 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 22:57:01,228 [trainer.py] => z_dim: 1000
2024-12-28 22:57:01,228 [trainer.py] => conv_dim: 64
2024-12-28 22:57:01,228 [trainer.py] => img_size: 224
2024-12-28 22:57:01,228 [trainer.py] => generator_lr: 0.001
2024-12-28 22:57:01,228 [trainer.py] => pi: 1
2024-12-28 22:57:01,228 [trainer.py] => w_bn: 50.0
2024-12-28 22:57:01,228 [trainer.py] => w_noise: 0.001
2024-12-28 22:57:01,228 [trainer.py] => server_ss: 128
2024-12-28 22:57:01,228 [trainer.py] => bn_loss: 1
2024-12-28 22:57:01,228 [trainer.py] => noise: 1
2024-12-28 22:57:01,228 [trainer.py] => ie_loss: 1
2024-12-28 22:57:01,228 [trainer.py] => act_loss: 0
2024-12-28 22:57:01,228 [trainer.py] => w_ie: 1.0
2024-12-28 22:57:01,228 [trainer.py] => w_act: 0.1
2024-12-28 22:57:01,228 [trainer.py] => vpt_type: Deep
2024-12-28 22:57:01,228 [trainer.py] => prompt_token_num: 6
2024-12-28 22:57:01,228 [trainer.py] => avg_alpha: 0.8
2024-12-28 22:57:01,228 [trainer.py] => perturb_var: 1
2024-12-28 22:57:01,228 [trainer.py] => EMA_beta: 0.99
2024-12-28 22:57:01,228 [trainer.py] => anchor_lambda: 0.1
2024-12-28 22:57:01,228 [trainer.py] => kl_weight: 0.001
2024-12-28 22:57:01,228 [trainer.py] => TIP_init: zero
2024-12-28 22:57:01,228 [trainer.py] => tuned_epoch: 20
2024-12-28 22:57:01,228 [trainer.py] => fs_epoch: 0
2024-12-28 22:57:01,228 [trainer.py] => init_lr: 0.01
2024-12-28 22:57:01,228 [trainer.py] => fs_lr: 0.001
2024-12-28 22:57:01,228 [trainer.py] => batch_size: 48
2024-12-28 22:57:01,228 [trainer.py] => fs_batch_size: 16
2024-12-28 22:57:01,228 [trainer.py] => weight_decay: 0.0005
2024-12-28 22:57:01,228 [trainer.py] => min_lr: 0
2024-12-28 22:57:01,229 [trainer.py] => optimizer: sgd
2024-12-28 22:57:01,229 [trainer.py] => memory_size: 0
2024-12-28 22:57:01,229 [trainer.py] => memory_per_class: 0
2024-12-28 22:57:01,229 [trainer.py] => fixed_memory: False
2024-12-28 22:57:01,229 [trainer.py] => shuffle: False
2024-12-28 22:57:01,229 [trainer.py] => top_k: 5
2024-12-28 22:57:01,229 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 22:57:01,229 [trainer.py] => prefix: asp
2024-12-28 22:57:01,229 [trainer.py] => model_prefix: asp
2024-12-28 22:57:02,699 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 22:57:08,898 [trainer.py] => All params: 173596160
2024-12-28 22:57:08,899 [trainer.py] => Trainable params: 1998848
2024-12-28 22:57:09,363 [asp.py] => Learning on 0-60
2024-12-28 22:57:09,447 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 22:57:09,531 [asp.py] => total parameters: 173642241
2024-12-28 22:57:09,532 [asp.py] => trainable parameters: 2044929
2024-12-28 22:57:09,532 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 23:22:55,037 [trainer.py] => config: ./exps/cifar.json
2024-12-28 23:22:55,039 [trainer.py] => model_name: asp
2024-12-28 23:22:55,039 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 23:22:55,039 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 23:22:55,039 [trainer.py] => seed: 2024
2024-12-28 23:22:55,039 [trainer.py] => dataset: cifar224
2024-12-28 23:22:55,039 [trainer.py] => init_cls: 60
2024-12-28 23:22:55,039 [trainer.py] => increment: 5
2024-12-28 23:22:55,039 [trainer.py] => kshot: 5
2024-12-28 23:22:55,039 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 23:22:55,039 [trainer.py] => z_dim: 1000
2024-12-28 23:22:55,039 [trainer.py] => conv_dim: 64
2024-12-28 23:22:55,039 [trainer.py] => img_size: 224
2024-12-28 23:22:55,039 [trainer.py] => generator_lr: 0.001
2024-12-28 23:22:55,039 [trainer.py] => pi: 1
2024-12-28 23:22:55,039 [trainer.py] => w_bn: 50.0
2024-12-28 23:22:55,039 [trainer.py] => w_noise: 0.001
2024-12-28 23:22:55,039 [trainer.py] => server_ss: 128
2024-12-28 23:22:55,039 [trainer.py] => bn_loss: 1
2024-12-28 23:22:55,039 [trainer.py] => noise: 1
2024-12-28 23:22:55,039 [trainer.py] => ie_loss: 1
2024-12-28 23:22:55,039 [trainer.py] => act_loss: 0
2024-12-28 23:22:55,039 [trainer.py] => w_ie: 1.0
2024-12-28 23:22:55,039 [trainer.py] => w_act: 0.1
2024-12-28 23:22:55,039 [trainer.py] => vpt_type: Deep
2024-12-28 23:22:55,039 [trainer.py] => prompt_token_num: 6
2024-12-28 23:22:55,039 [trainer.py] => avg_alpha: 0.8
2024-12-28 23:22:55,040 [trainer.py] => perturb_var: 1
2024-12-28 23:22:55,040 [trainer.py] => EMA_beta: 0.99
2024-12-28 23:22:55,040 [trainer.py] => anchor_lambda: 0.1
2024-12-28 23:22:55,040 [trainer.py] => kl_weight: 0.001
2024-12-28 23:22:55,040 [trainer.py] => TIP_init: zero
2024-12-28 23:22:55,040 [trainer.py] => tuned_epoch: 20
2024-12-28 23:22:55,040 [trainer.py] => fs_epoch: 0
2024-12-28 23:22:55,040 [trainer.py] => init_lr: 0.01
2024-12-28 23:22:55,040 [trainer.py] => fs_lr: 0.001
2024-12-28 23:22:55,040 [trainer.py] => batch_size: 48
2024-12-28 23:22:55,040 [trainer.py] => fs_batch_size: 16
2024-12-28 23:22:55,040 [trainer.py] => weight_decay: 0.0005
2024-12-28 23:22:55,040 [trainer.py] => min_lr: 0
2024-12-28 23:22:55,040 [trainer.py] => optimizer: sgd
2024-12-28 23:22:55,040 [trainer.py] => memory_size: 0
2024-12-28 23:22:55,040 [trainer.py] => memory_per_class: 0
2024-12-28 23:22:55,040 [trainer.py] => fixed_memory: False
2024-12-28 23:22:55,040 [trainer.py] => shuffle: False
2024-12-28 23:22:55,040 [trainer.py] => top_k: 5
2024-12-28 23:22:55,040 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 23:22:55,040 [trainer.py] => prefix: asp
2024-12-28 23:22:55,040 [trainer.py] => model_prefix: asp
2024-12-28 23:22:56,542 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 23:23:03,123 [trainer.py] => All params: 173596160
2024-12-28 23:23:03,124 [trainer.py] => Trainable params: 1998848
2024-12-28 23:23:03,601 [asp.py] => Learning on 0-60
2024-12-28 23:23:03,729 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 23:23:03,996 [asp.py] => total parameters: 173642241
2024-12-28 23:23:03,997 [asp.py] => trainable parameters: 2044929
2024-12-28 23:23:03,997 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 23:30:29,294 [trainer.py] => config: ./exps/cifar.json
2024-12-28 23:30:29,294 [trainer.py] => model_name: asp
2024-12-28 23:30:29,294 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 23:30:29,294 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 23:30:29,294 [trainer.py] => seed: 2024
2024-12-28 23:30:29,294 [trainer.py] => dataset: cifar224
2024-12-28 23:30:29,295 [trainer.py] => init_cls: 60
2024-12-28 23:30:29,295 [trainer.py] => increment: 5
2024-12-28 23:30:29,295 [trainer.py] => kshot: 5
2024-12-28 23:30:29,295 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 23:30:29,295 [trainer.py] => z_dim: 1000
2024-12-28 23:30:29,295 [trainer.py] => conv_dim: 64
2024-12-28 23:30:29,295 [trainer.py] => img_size: 224
2024-12-28 23:30:29,295 [trainer.py] => generator_lr: 0.001
2024-12-28 23:30:29,295 [trainer.py] => pi: 1
2024-12-28 23:30:29,295 [trainer.py] => w_bn: 50.0
2024-12-28 23:30:29,295 [trainer.py] => w_noise: 0.001
2024-12-28 23:30:29,295 [trainer.py] => server_ss: 128
2024-12-28 23:30:29,295 [trainer.py] => bn_loss: 1
2024-12-28 23:30:29,295 [trainer.py] => noise: 1
2024-12-28 23:30:29,295 [trainer.py] => ie_loss: 1
2024-12-28 23:30:29,295 [trainer.py] => act_loss: 0
2024-12-28 23:30:29,295 [trainer.py] => w_ie: 1.0
2024-12-28 23:30:29,295 [trainer.py] => w_act: 0.1
2024-12-28 23:30:29,295 [trainer.py] => vpt_type: Deep
2024-12-28 23:30:29,295 [trainer.py] => prompt_token_num: 6
2024-12-28 23:30:29,295 [trainer.py] => avg_alpha: 0.8
2024-12-28 23:30:29,295 [trainer.py] => perturb_var: 1
2024-12-28 23:30:29,295 [trainer.py] => EMA_beta: 0.99
2024-12-28 23:30:29,295 [trainer.py] => anchor_lambda: 0.1
2024-12-28 23:30:29,295 [trainer.py] => kl_weight: 0.001
2024-12-28 23:30:29,295 [trainer.py] => TIP_init: zero
2024-12-28 23:30:29,295 [trainer.py] => tuned_epoch: 20
2024-12-28 23:30:29,295 [trainer.py] => fs_epoch: 0
2024-12-28 23:30:29,295 [trainer.py] => init_lr: 0.01
2024-12-28 23:30:29,296 [trainer.py] => fs_lr: 0.001
2024-12-28 23:30:29,296 [trainer.py] => batch_size: 48
2024-12-28 23:30:29,296 [trainer.py] => fs_batch_size: 16
2024-12-28 23:30:29,296 [trainer.py] => weight_decay: 0.0005
2024-12-28 23:30:29,296 [trainer.py] => min_lr: 0
2024-12-28 23:30:29,296 [trainer.py] => optimizer: sgd
2024-12-28 23:30:29,296 [trainer.py] => memory_size: 0
2024-12-28 23:30:29,296 [trainer.py] => memory_per_class: 0
2024-12-28 23:30:29,296 [trainer.py] => fixed_memory: False
2024-12-28 23:30:29,296 [trainer.py] => shuffle: False
2024-12-28 23:30:29,296 [trainer.py] => top_k: 5
2024-12-28 23:30:29,296 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 23:30:29,296 [trainer.py] => prefix: asp
2024-12-28 23:30:29,296 [trainer.py] => model_prefix: asp
2024-12-28 23:30:30,794 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 23:30:36,933 [trainer.py] => All params: 173596160
2024-12-28 23:30:36,934 [trainer.py] => Trainable params: 1998848
2024-12-28 23:30:37,427 [asp.py] => Learning on 0-60
2024-12-28 23:30:37,502 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 23:30:37,588 [asp.py] => total parameters: 173642241
2024-12-28 23:30:37,588 [asp.py] => trainable parameters: 2044929
2024-12-28 23:30:37,589 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 23:39:38,912 [trainer.py] => config: ./exps/cifar.json
2024-12-28 23:39:38,912 [trainer.py] => model_name: asp
2024-12-28 23:39:38,912 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 23:39:38,912 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 23:39:38,912 [trainer.py] => seed: 2024
2024-12-28 23:39:38,912 [trainer.py] => dataset: cifar224
2024-12-28 23:39:38,912 [trainer.py] => init_cls: 60
2024-12-28 23:39:38,912 [trainer.py] => increment: 5
2024-12-28 23:39:38,912 [trainer.py] => kshot: 5
2024-12-28 23:39:38,912 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 23:39:38,912 [trainer.py] => z_dim: 1000
2024-12-28 23:39:38,912 [trainer.py] => conv_dim: 64
2024-12-28 23:39:38,913 [trainer.py] => img_size: 224
2024-12-28 23:39:38,913 [trainer.py] => generator_lr: 0.001
2024-12-28 23:39:38,913 [trainer.py] => pi: 1
2024-12-28 23:39:38,913 [trainer.py] => w_bn: 50.0
2024-12-28 23:39:38,913 [trainer.py] => w_noise: 0.001
2024-12-28 23:39:38,913 [trainer.py] => server_ss: 128
2024-12-28 23:39:38,913 [trainer.py] => bn_loss: 1
2024-12-28 23:39:38,913 [trainer.py] => noise: 1
2024-12-28 23:39:38,913 [trainer.py] => ie_loss: 1
2024-12-28 23:39:38,913 [trainer.py] => act_loss: 0
2024-12-28 23:39:38,913 [trainer.py] => w_ie: 1.0
2024-12-28 23:39:38,913 [trainer.py] => w_act: 0.1
2024-12-28 23:39:38,913 [trainer.py] => vpt_type: Deep
2024-12-28 23:39:38,913 [trainer.py] => prompt_token_num: 6
2024-12-28 23:39:38,913 [trainer.py] => avg_alpha: 0.8
2024-12-28 23:39:38,913 [trainer.py] => perturb_var: 1
2024-12-28 23:39:38,913 [trainer.py] => EMA_beta: 0.99
2024-12-28 23:39:38,913 [trainer.py] => anchor_lambda: 0.1
2024-12-28 23:39:38,913 [trainer.py] => kl_weight: 0.001
2024-12-28 23:39:38,913 [trainer.py] => TIP_init: zero
2024-12-28 23:39:38,913 [trainer.py] => tuned_epoch: 20
2024-12-28 23:39:38,913 [trainer.py] => fs_epoch: 0
2024-12-28 23:39:38,913 [trainer.py] => init_lr: 0.01
2024-12-28 23:39:38,913 [trainer.py] => fs_lr: 0.001
2024-12-28 23:39:38,913 [trainer.py] => batch_size: 48
2024-12-28 23:39:38,913 [trainer.py] => fs_batch_size: 16
2024-12-28 23:39:38,913 [trainer.py] => weight_decay: 0.0005
2024-12-28 23:39:38,913 [trainer.py] => min_lr: 0
2024-12-28 23:39:38,913 [trainer.py] => optimizer: sgd
2024-12-28 23:39:38,913 [trainer.py] => memory_size: 0
2024-12-28 23:39:38,914 [trainer.py] => memory_per_class: 0
2024-12-28 23:39:38,914 [trainer.py] => fixed_memory: False
2024-12-28 23:39:38,914 [trainer.py] => shuffle: False
2024-12-28 23:39:38,914 [trainer.py] => top_k: 5
2024-12-28 23:39:38,914 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 23:39:38,914 [trainer.py] => prefix: asp
2024-12-28 23:39:38,914 [trainer.py] => model_prefix: asp
2024-12-28 23:39:40,409 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 23:39:46,507 [trainer.py] => All params: 173596160
2024-12-28 23:39:46,508 [trainer.py] => Trainable params: 1998848
2024-12-28 23:39:46,994 [asp.py] => Learning on 0-60
2024-12-28 23:39:47,077 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 23:39:47,175 [asp.py] => total parameters: 173642241
2024-12-28 23:39:47,175 [asp.py] => trainable parameters: 2044929
2024-12-28 23:39:47,176 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 23:48:39,287 [trainer.py] => config: ./exps/cifar.json
2024-12-28 23:48:39,287 [trainer.py] => model_name: asp
2024-12-28 23:48:39,287 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 23:48:39,287 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 23:48:39,287 [trainer.py] => seed: 2024
2024-12-28 23:48:39,287 [trainer.py] => dataset: cifar224
2024-12-28 23:48:39,287 [trainer.py] => init_cls: 60
2024-12-28 23:48:39,288 [trainer.py] => increment: 5
2024-12-28 23:48:39,288 [trainer.py] => kshot: 5
2024-12-28 23:48:39,288 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 23:48:39,288 [trainer.py] => z_dim: 1000
2024-12-28 23:48:39,288 [trainer.py] => conv_dim: 64
2024-12-28 23:48:39,288 [trainer.py] => img_size: 224
2024-12-28 23:48:39,288 [trainer.py] => generator_lr: 0.001
2024-12-28 23:48:39,288 [trainer.py] => pi: 1
2024-12-28 23:48:39,288 [trainer.py] => w_bn: 50.0
2024-12-28 23:48:39,288 [trainer.py] => w_noise: 0.001
2024-12-28 23:48:39,288 [trainer.py] => server_ss: 128
2024-12-28 23:48:39,288 [trainer.py] => bn_loss: 1
2024-12-28 23:48:39,288 [trainer.py] => noise: 1
2024-12-28 23:48:39,288 [trainer.py] => ie_loss: 1
2024-12-28 23:48:39,288 [trainer.py] => act_loss: 0
2024-12-28 23:48:39,288 [trainer.py] => w_ie: 1.0
2024-12-28 23:48:39,288 [trainer.py] => w_act: 0.1
2024-12-28 23:48:39,288 [trainer.py] => vpt_type: Deep
2024-12-28 23:48:39,288 [trainer.py] => prompt_token_num: 6
2024-12-28 23:48:39,288 [trainer.py] => avg_alpha: 0.8
2024-12-28 23:48:39,288 [trainer.py] => perturb_var: 1
2024-12-28 23:48:39,288 [trainer.py] => EMA_beta: 0.99
2024-12-28 23:48:39,288 [trainer.py] => anchor_lambda: 0.1
2024-12-28 23:48:39,288 [trainer.py] => kl_weight: 0.001
2024-12-28 23:48:39,288 [trainer.py] => TIP_init: zero
2024-12-28 23:48:39,288 [trainer.py] => tuned_epoch: 20
2024-12-28 23:48:39,288 [trainer.py] => fs_epoch: 0
2024-12-28 23:48:39,289 [trainer.py] => init_lr: 0.01
2024-12-28 23:48:39,289 [trainer.py] => fs_lr: 0.001
2024-12-28 23:48:39,289 [trainer.py] => batch_size: 48
2024-12-28 23:48:39,289 [trainer.py] => fs_batch_size: 16
2024-12-28 23:48:39,289 [trainer.py] => weight_decay: 0.0005
2024-12-28 23:48:39,289 [trainer.py] => min_lr: 0
2024-12-28 23:48:39,289 [trainer.py] => optimizer: sgd
2024-12-28 23:48:39,289 [trainer.py] => memory_size: 0
2024-12-28 23:48:39,289 [trainer.py] => memory_per_class: 0
2024-12-28 23:48:39,289 [trainer.py] => fixed_memory: False
2024-12-28 23:48:39,289 [trainer.py] => shuffle: False
2024-12-28 23:48:39,289 [trainer.py] => top_k: 5
2024-12-28 23:48:39,289 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 23:48:39,289 [trainer.py] => prefix: asp
2024-12-28 23:48:39,289 [trainer.py] => model_prefix: asp
2024-12-28 23:48:40,774 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 23:48:46,820 [trainer.py] => All params: 173596160
2024-12-28 23:48:46,820 [trainer.py] => Trainable params: 1998848
2024-12-28 23:48:47,310 [asp.py] => Learning on 0-60
2024-12-28 23:48:47,384 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 23:48:47,469 [asp.py] => total parameters: 173642241
2024-12-28 23:48:47,469 [asp.py] => trainable parameters: 2044929
2024-12-28 23:48:47,470 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-28 23:55:30,213 [trainer.py] => config: ./exps/cifar.json
2024-12-28 23:55:30,213 [trainer.py] => model_name: asp
2024-12-28 23:55:30,213 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-28 23:55:30,213 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-28 23:55:30,213 [trainer.py] => seed: 2024
2024-12-28 23:55:30,213 [trainer.py] => dataset: cifar224
2024-12-28 23:55:30,213 [trainer.py] => init_cls: 60
2024-12-28 23:55:30,213 [trainer.py] => increment: 5
2024-12-28 23:55:30,214 [trainer.py] => kshot: 5
2024-12-28 23:55:30,214 [trainer.py] => generator_model: CIFAR_GEN
2024-12-28 23:55:30,214 [trainer.py] => z_dim: 1000
2024-12-28 23:55:30,214 [trainer.py] => conv_dim: 64
2024-12-28 23:55:30,214 [trainer.py] => img_size: 224
2024-12-28 23:55:30,214 [trainer.py] => generator_lr: 0.001
2024-12-28 23:55:30,214 [trainer.py] => pi: 1
2024-12-28 23:55:30,214 [trainer.py] => w_bn: 50.0
2024-12-28 23:55:30,214 [trainer.py] => w_noise: 0.001
2024-12-28 23:55:30,214 [trainer.py] => server_ss: 128
2024-12-28 23:55:30,214 [trainer.py] => bn_loss: 1
2024-12-28 23:55:30,214 [trainer.py] => noise: 1
2024-12-28 23:55:30,214 [trainer.py] => ie_loss: 1
2024-12-28 23:55:30,214 [trainer.py] => act_loss: 0
2024-12-28 23:55:30,214 [trainer.py] => w_ie: 1.0
2024-12-28 23:55:30,214 [trainer.py] => w_act: 0.1
2024-12-28 23:55:30,214 [trainer.py] => vpt_type: Deep
2024-12-28 23:55:30,214 [trainer.py] => prompt_token_num: 6
2024-12-28 23:55:30,214 [trainer.py] => avg_alpha: 0.8
2024-12-28 23:55:30,214 [trainer.py] => perturb_var: 1
2024-12-28 23:55:30,214 [trainer.py] => EMA_beta: 0.99
2024-12-28 23:55:30,214 [trainer.py] => anchor_lambda: 0.1
2024-12-28 23:55:30,214 [trainer.py] => kl_weight: 0.001
2024-12-28 23:55:30,214 [trainer.py] => TIP_init: zero
2024-12-28 23:55:30,214 [trainer.py] => tuned_epoch: 20
2024-12-28 23:55:30,214 [trainer.py] => fs_epoch: 0
2024-12-28 23:55:30,214 [trainer.py] => init_lr: 0.01
2024-12-28 23:55:30,214 [trainer.py] => fs_lr: 0.001
2024-12-28 23:55:30,215 [trainer.py] => batch_size: 48
2024-12-28 23:55:30,215 [trainer.py] => fs_batch_size: 16
2024-12-28 23:55:30,215 [trainer.py] => weight_decay: 0.0005
2024-12-28 23:55:30,215 [trainer.py] => min_lr: 0
2024-12-28 23:55:30,215 [trainer.py] => optimizer: sgd
2024-12-28 23:55:30,215 [trainer.py] => memory_size: 0
2024-12-28 23:55:30,215 [trainer.py] => memory_per_class: 0
2024-12-28 23:55:30,215 [trainer.py] => fixed_memory: False
2024-12-28 23:55:30,215 [trainer.py] => shuffle: False
2024-12-28 23:55:30,215 [trainer.py] => top_k: 5
2024-12-28 23:55:30,215 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-28 23:55:30,215 [trainer.py] => prefix: asp
2024-12-28 23:55:30,215 [trainer.py] => model_prefix: asp
2024-12-28 23:55:31,701 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-28 23:55:37,770 [trainer.py] => All params: 173596160
2024-12-28 23:55:37,771 [trainer.py] => Trainable params: 1998848
2024-12-28 23:55:38,252 [asp.py] => Learning on 0-60
2024-12-28 23:55:38,338 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-28 23:55:38,422 [asp.py] => total parameters: 173642241
2024-12-28 23:55:38,423 [asp.py] => trainable parameters: 2044929
2024-12-28 23:55:38,424 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 00:02:18,689 [trainer.py] => config: ./exps/cifar.json
2024-12-29 00:02:18,689 [trainer.py] => model_name: asp
2024-12-29 00:02:18,689 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 00:02:18,689 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 00:02:18,689 [trainer.py] => seed: 2024
2024-12-29 00:02:18,689 [trainer.py] => dataset: cifar224
2024-12-29 00:02:18,689 [trainer.py] => init_cls: 60
2024-12-29 00:02:18,689 [trainer.py] => increment: 5
2024-12-29 00:02:18,689 [trainer.py] => kshot: 5
2024-12-29 00:02:18,689 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 00:02:18,689 [trainer.py] => z_dim: 1000
2024-12-29 00:02:18,689 [trainer.py] => conv_dim: 64
2024-12-29 00:02:18,689 [trainer.py] => img_size: 224
2024-12-29 00:02:18,689 [trainer.py] => generator_lr: 0.001
2024-12-29 00:02:18,689 [trainer.py] => pi: 1
2024-12-29 00:02:18,690 [trainer.py] => w_bn: 50.0
2024-12-29 00:02:18,690 [trainer.py] => w_noise: 0.001
2024-12-29 00:02:18,690 [trainer.py] => server_ss: 128
2024-12-29 00:02:18,690 [trainer.py] => bn_loss: 1
2024-12-29 00:02:18,690 [trainer.py] => noise: 1
2024-12-29 00:02:18,690 [trainer.py] => ie_loss: 1
2024-12-29 00:02:18,690 [trainer.py] => act_loss: 0
2024-12-29 00:02:18,690 [trainer.py] => w_ie: 1.0
2024-12-29 00:02:18,690 [trainer.py] => w_act: 0.1
2024-12-29 00:02:18,690 [trainer.py] => vpt_type: Deep
2024-12-29 00:02:18,690 [trainer.py] => prompt_token_num: 6
2024-12-29 00:02:18,690 [trainer.py] => avg_alpha: 0.8
2024-12-29 00:02:18,690 [trainer.py] => perturb_var: 1
2024-12-29 00:02:18,690 [trainer.py] => EMA_beta: 0.99
2024-12-29 00:02:18,690 [trainer.py] => anchor_lambda: 0.1
2024-12-29 00:02:18,690 [trainer.py] => kl_weight: 0.001
2024-12-29 00:02:18,690 [trainer.py] => TIP_init: zero
2024-12-29 00:02:18,690 [trainer.py] => tuned_epoch: 20
2024-12-29 00:02:18,690 [trainer.py] => fs_epoch: 0
2024-12-29 00:02:18,690 [trainer.py] => init_lr: 0.01
2024-12-29 00:02:18,690 [trainer.py] => fs_lr: 0.001
2024-12-29 00:02:18,690 [trainer.py] => batch_size: 48
2024-12-29 00:02:18,690 [trainer.py] => fs_batch_size: 16
2024-12-29 00:02:18,690 [trainer.py] => weight_decay: 0.0005
2024-12-29 00:02:18,690 [trainer.py] => min_lr: 0
2024-12-29 00:02:18,690 [trainer.py] => optimizer: sgd
2024-12-29 00:02:18,690 [trainer.py] => memory_size: 0
2024-12-29 00:02:18,690 [trainer.py] => memory_per_class: 0
2024-12-29 00:02:18,690 [trainer.py] => fixed_memory: False
2024-12-29 00:02:18,690 [trainer.py] => shuffle: False
2024-12-29 00:02:18,691 [trainer.py] => top_k: 5
2024-12-29 00:02:18,691 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 00:02:18,691 [trainer.py] => prefix: asp
2024-12-29 00:02:18,691 [trainer.py] => model_prefix: asp
2024-12-29 00:02:20,167 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 00:02:26,258 [trainer.py] => All params: 173596160
2024-12-29 00:02:26,259 [trainer.py] => Trainable params: 1998848
2024-12-29 00:02:26,747 [asp.py] => Learning on 0-60
2024-12-29 00:02:26,817 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 00:02:26,907 [asp.py] => total parameters: 173642241
2024-12-29 00:02:26,908 [asp.py] => trainable parameters: 2044929
2024-12-29 00:02:26,909 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 00:06:23,261 [trainer.py] => config: ./exps/cifar.json
2024-12-29 00:06:23,261 [trainer.py] => model_name: asp
2024-12-29 00:06:23,261 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 00:06:23,261 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 00:06:23,261 [trainer.py] => seed: 2024
2024-12-29 00:06:23,261 [trainer.py] => dataset: cifar224
2024-12-29 00:06:23,261 [trainer.py] => init_cls: 60
2024-12-29 00:06:23,261 [trainer.py] => increment: 5
2024-12-29 00:06:23,261 [trainer.py] => kshot: 5
2024-12-29 00:06:23,261 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 00:06:23,261 [trainer.py] => z_dim: 1000
2024-12-29 00:06:23,261 [trainer.py] => conv_dim: 64
2024-12-29 00:06:23,261 [trainer.py] => img_size: 224
2024-12-29 00:06:23,261 [trainer.py] => generator_lr: 0.001
2024-12-29 00:06:23,261 [trainer.py] => pi: 1
2024-12-29 00:06:23,261 [trainer.py] => w_bn: 50.0
2024-12-29 00:06:23,261 [trainer.py] => w_noise: 0.001
2024-12-29 00:06:23,261 [trainer.py] => server_ss: 128
2024-12-29 00:06:23,261 [trainer.py] => bn_loss: 1
2024-12-29 00:06:23,261 [trainer.py] => noise: 1
2024-12-29 00:06:23,261 [trainer.py] => ie_loss: 1
2024-12-29 00:06:23,261 [trainer.py] => act_loss: 0
2024-12-29 00:06:23,261 [trainer.py] => w_ie: 1.0
2024-12-29 00:06:23,261 [trainer.py] => w_act: 0.1
2024-12-29 00:06:23,262 [trainer.py] => vpt_type: Deep
2024-12-29 00:06:23,262 [trainer.py] => prompt_token_num: 6
2024-12-29 00:06:23,262 [trainer.py] => avg_alpha: 0.8
2024-12-29 00:06:23,262 [trainer.py] => perturb_var: 1
2024-12-29 00:06:23,262 [trainer.py] => EMA_beta: 0.99
2024-12-29 00:06:23,262 [trainer.py] => anchor_lambda: 0.1
2024-12-29 00:06:23,262 [trainer.py] => kl_weight: 0.001
2024-12-29 00:06:23,262 [trainer.py] => TIP_init: zero
2024-12-29 00:06:23,262 [trainer.py] => tuned_epoch: 20
2024-12-29 00:06:23,262 [trainer.py] => fs_epoch: 0
2024-12-29 00:06:23,262 [trainer.py] => init_lr: 0.01
2024-12-29 00:06:23,262 [trainer.py] => fs_lr: 0.001
2024-12-29 00:06:23,262 [trainer.py] => batch_size: 48
2024-12-29 00:06:23,262 [trainer.py] => fs_batch_size: 16
2024-12-29 00:06:23,262 [trainer.py] => weight_decay: 0.0005
2024-12-29 00:06:23,262 [trainer.py] => min_lr: 0
2024-12-29 00:06:23,262 [trainer.py] => optimizer: sgd
2024-12-29 00:06:23,262 [trainer.py] => memory_size: 0
2024-12-29 00:06:23,262 [trainer.py] => memory_per_class: 0
2024-12-29 00:06:23,262 [trainer.py] => fixed_memory: False
2024-12-29 00:06:23,262 [trainer.py] => shuffle: False
2024-12-29 00:06:23,262 [trainer.py] => top_k: 5
2024-12-29 00:06:23,262 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 00:06:23,262 [trainer.py] => prefix: asp
2024-12-29 00:06:23,262 [trainer.py] => model_prefix: asp
2024-12-29 00:06:24,767 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 00:06:30,980 [trainer.py] => All params: 173596160
2024-12-29 00:06:30,981 [trainer.py] => Trainable params: 1998848
2024-12-29 00:06:31,469 [asp.py] => Learning on 0-60
2024-12-29 00:06:31,556 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 00:06:31,635 [asp.py] => total parameters: 173642241
2024-12-29 00:06:31,635 [asp.py] => trainable parameters: 2044929
2024-12-29 00:06:31,636 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 00:09:43,106 [trainer.py] => config: ./exps/cifar.json
2024-12-29 00:09:43,107 [trainer.py] => model_name: asp
2024-12-29 00:09:43,107 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 00:09:43,107 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 00:09:43,107 [trainer.py] => seed: 2024
2024-12-29 00:09:43,107 [trainer.py] => dataset: cifar224
2024-12-29 00:09:43,107 [trainer.py] => init_cls: 60
2024-12-29 00:09:43,107 [trainer.py] => increment: 5
2024-12-29 00:09:43,107 [trainer.py] => kshot: 5
2024-12-29 00:09:43,107 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 00:09:43,107 [trainer.py] => z_dim: 1000
2024-12-29 00:09:43,107 [trainer.py] => conv_dim: 64
2024-12-29 00:09:43,107 [trainer.py] => img_size: 224
2024-12-29 00:09:43,107 [trainer.py] => generator_lr: 0.001
2024-12-29 00:09:43,107 [trainer.py] => pi: 1
2024-12-29 00:09:43,107 [trainer.py] => w_bn: 50.0
2024-12-29 00:09:43,107 [trainer.py] => w_noise: 0.001
2024-12-29 00:09:43,107 [trainer.py] => server_ss: 128
2024-12-29 00:09:43,107 [trainer.py] => bn_loss: 1
2024-12-29 00:09:43,107 [trainer.py] => noise: 1
2024-12-29 00:09:43,107 [trainer.py] => ie_loss: 1
2024-12-29 00:09:43,107 [trainer.py] => act_loss: 0
2024-12-29 00:09:43,107 [trainer.py] => w_ie: 1.0
2024-12-29 00:09:43,107 [trainer.py] => w_act: 0.1
2024-12-29 00:09:43,107 [trainer.py] => vpt_type: Deep
2024-12-29 00:09:43,107 [trainer.py] => prompt_token_num: 6
2024-12-29 00:09:43,108 [trainer.py] => avg_alpha: 0.8
2024-12-29 00:09:43,108 [trainer.py] => perturb_var: 1
2024-12-29 00:09:43,108 [trainer.py] => EMA_beta: 0.99
2024-12-29 00:09:43,108 [trainer.py] => anchor_lambda: 0.1
2024-12-29 00:09:43,108 [trainer.py] => kl_weight: 0.001
2024-12-29 00:09:43,108 [trainer.py] => TIP_init: zero
2024-12-29 00:09:43,108 [trainer.py] => tuned_epoch: 20
2024-12-29 00:09:43,108 [trainer.py] => fs_epoch: 0
2024-12-29 00:09:43,108 [trainer.py] => init_lr: 0.01
2024-12-29 00:09:43,108 [trainer.py] => fs_lr: 0.001
2024-12-29 00:09:43,108 [trainer.py] => batch_size: 48
2024-12-29 00:09:43,108 [trainer.py] => fs_batch_size: 16
2024-12-29 00:09:43,108 [trainer.py] => weight_decay: 0.0005
2024-12-29 00:09:43,108 [trainer.py] => min_lr: 0
2024-12-29 00:09:43,108 [trainer.py] => optimizer: sgd
2024-12-29 00:09:43,108 [trainer.py] => memory_size: 0
2024-12-29 00:09:43,108 [trainer.py] => memory_per_class: 0
2024-12-29 00:09:43,108 [trainer.py] => fixed_memory: False
2024-12-29 00:09:43,108 [trainer.py] => shuffle: False
2024-12-29 00:09:43,108 [trainer.py] => top_k: 5
2024-12-29 00:09:43,108 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 00:09:43,108 [trainer.py] => prefix: asp
2024-12-29 00:09:43,108 [trainer.py] => model_prefix: asp
2024-12-29 00:09:44,623 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 00:09:50,927 [trainer.py] => All params: 173596160
2024-12-29 00:09:50,928 [trainer.py] => Trainable params: 1998848
2024-12-29 00:09:51,427 [asp.py] => Learning on 0-60
2024-12-29 00:09:51,538 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 00:09:51,624 [asp.py] => total parameters: 173642241
2024-12-29 00:09:51,624 [asp.py] => trainable parameters: 2044929
2024-12-29 00:09:51,625 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 00:17:45,142 [trainer.py] => config: ./exps/cifar.json
2024-12-29 00:17:45,142 [trainer.py] => model_name: asp
2024-12-29 00:17:45,142 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 00:17:45,142 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 00:17:45,142 [trainer.py] => seed: 2024
2024-12-29 00:17:45,142 [trainer.py] => dataset: cifar224
2024-12-29 00:17:45,142 [trainer.py] => init_cls: 60
2024-12-29 00:17:45,142 [trainer.py] => increment: 5
2024-12-29 00:17:45,142 [trainer.py] => kshot: 5
2024-12-29 00:17:45,142 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 00:17:45,142 [trainer.py] => z_dim: 1000
2024-12-29 00:17:45,142 [trainer.py] => conv_dim: 64
2024-12-29 00:17:45,142 [trainer.py] => img_size: 224
2024-12-29 00:17:45,142 [trainer.py] => generator_lr: 0.001
2024-12-29 00:17:45,142 [trainer.py] => pi: 1
2024-12-29 00:17:45,142 [trainer.py] => w_bn: 50.0
2024-12-29 00:17:45,142 [trainer.py] => w_noise: 0.001
2024-12-29 00:17:45,143 [trainer.py] => server_ss: 128
2024-12-29 00:17:45,143 [trainer.py] => bn_loss: 1
2024-12-29 00:17:45,143 [trainer.py] => noise: 1
2024-12-29 00:17:45,143 [trainer.py] => ie_loss: 1
2024-12-29 00:17:45,143 [trainer.py] => act_loss: 0
2024-12-29 00:17:45,143 [trainer.py] => w_ie: 1.0
2024-12-29 00:17:45,143 [trainer.py] => w_act: 0.1
2024-12-29 00:17:45,143 [trainer.py] => vpt_type: Deep
2024-12-29 00:17:45,143 [trainer.py] => prompt_token_num: 6
2024-12-29 00:17:45,143 [trainer.py] => avg_alpha: 0.8
2024-12-29 00:17:45,143 [trainer.py] => perturb_var: 1
2024-12-29 00:17:45,143 [trainer.py] => EMA_beta: 0.99
2024-12-29 00:17:45,143 [trainer.py] => anchor_lambda: 0.1
2024-12-29 00:17:45,143 [trainer.py] => kl_weight: 0.001
2024-12-29 00:17:45,143 [trainer.py] => TIP_init: zero
2024-12-29 00:17:45,143 [trainer.py] => tuned_epoch: 20
2024-12-29 00:17:45,143 [trainer.py] => fs_epoch: 0
2024-12-29 00:17:45,143 [trainer.py] => init_lr: 0.01
2024-12-29 00:17:45,143 [trainer.py] => fs_lr: 0.001
2024-12-29 00:17:45,143 [trainer.py] => batch_size: 48
2024-12-29 00:17:45,143 [trainer.py] => fs_batch_size: 16
2024-12-29 00:17:45,143 [trainer.py] => weight_decay: 0.0005
2024-12-29 00:17:45,143 [trainer.py] => min_lr: 0
2024-12-29 00:17:45,143 [trainer.py] => optimizer: sgd
2024-12-29 00:17:45,143 [trainer.py] => memory_size: 0
2024-12-29 00:17:45,143 [trainer.py] => memory_per_class: 0
2024-12-29 00:17:45,143 [trainer.py] => fixed_memory: False
2024-12-29 00:17:45,143 [trainer.py] => shuffle: False
2024-12-29 00:17:45,143 [trainer.py] => top_k: 5
2024-12-29 00:17:45,143 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 00:17:45,143 [trainer.py] => prefix: asp
2024-12-29 00:17:45,144 [trainer.py] => model_prefix: asp
2024-12-29 00:17:46,640 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 00:17:54,156 [trainer.py] => All params: 173596160
2024-12-29 00:17:54,157 [trainer.py] => Trainable params: 1998848
2024-12-29 00:17:54,667 [asp.py] => Learning on 0-60
2024-12-29 00:17:54,813 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 00:17:55,109 [asp.py] => total parameters: 173642241
2024-12-29 00:17:55,110 [asp.py] => trainable parameters: 2044929
2024-12-29 00:17:55,111 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 11:11:05,474 [trainer.py] => config: ./exps/cifar.json
2024-12-29 11:11:05,474 [trainer.py] => model_name: asp
2024-12-29 11:11:05,474 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 11:11:05,474 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 11:11:05,474 [trainer.py] => seed: 2024
2024-12-29 11:11:05,474 [trainer.py] => dataset: cifar224
2024-12-29 11:11:05,474 [trainer.py] => init_cls: 60
2024-12-29 11:11:05,475 [trainer.py] => increment: 5
2024-12-29 11:11:05,475 [trainer.py] => kshot: 5
2024-12-29 11:11:05,475 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 11:11:05,475 [trainer.py] => z_dim: 1000
2024-12-29 11:11:05,475 [trainer.py] => conv_dim: 64
2024-12-29 11:11:05,475 [trainer.py] => img_size: 224
2024-12-29 11:11:05,475 [trainer.py] => generator_lr: 0.001
2024-12-29 11:11:05,475 [trainer.py] => pi: 1
2024-12-29 11:11:05,475 [trainer.py] => w_bn: 50.0
2024-12-29 11:11:05,475 [trainer.py] => w_noise: 0.001
2024-12-29 11:11:05,475 [trainer.py] => server_ss: 128
2024-12-29 11:11:05,475 [trainer.py] => bn_loss: 1
2024-12-29 11:11:05,475 [trainer.py] => noise: 1
2024-12-29 11:11:05,475 [trainer.py] => ie_loss: 1
2024-12-29 11:11:05,475 [trainer.py] => act_loss: 0
2024-12-29 11:11:05,475 [trainer.py] => w_ie: 1.0
2024-12-29 11:11:05,475 [trainer.py] => w_act: 0.1
2024-12-29 11:11:05,475 [trainer.py] => vpt_type: Deep
2024-12-29 11:11:05,476 [trainer.py] => prompt_token_num: 6
2024-12-29 11:11:05,476 [trainer.py] => avg_alpha: 0.8
2024-12-29 11:11:05,476 [trainer.py] => perturb_var: 1
2024-12-29 11:11:05,476 [trainer.py] => EMA_beta: 0.99
2024-12-29 11:11:05,476 [trainer.py] => anchor_lambda: 0.1
2024-12-29 11:11:05,476 [trainer.py] => kl_weight: 0.001
2024-12-29 11:11:05,476 [trainer.py] => TIP_init: zero
2024-12-29 11:11:05,476 [trainer.py] => tuned_epoch: 20
2024-12-29 11:11:05,476 [trainer.py] => fs_epoch: 0
2024-12-29 11:11:05,476 [trainer.py] => init_lr: 0.01
2024-12-29 11:11:05,476 [trainer.py] => fs_lr: 0.001
2024-12-29 11:11:05,476 [trainer.py] => batch_size: 48
2024-12-29 11:11:05,476 [trainer.py] => fs_batch_size: 16
2024-12-29 11:11:05,476 [trainer.py] => weight_decay: 0.0005
2024-12-29 11:11:05,476 [trainer.py] => min_lr: 0
2024-12-29 11:11:05,476 [trainer.py] => optimizer: sgd
2024-12-29 11:11:05,476 [trainer.py] => memory_size: 0
2024-12-29 11:11:05,476 [trainer.py] => memory_per_class: 0
2024-12-29 11:11:05,476 [trainer.py] => fixed_memory: False
2024-12-29 11:11:05,476 [trainer.py] => shuffle: False
2024-12-29 11:11:05,476 [trainer.py] => top_k: 5
2024-12-29 11:11:05,476 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 11:11:05,476 [trainer.py] => prefix: asp
2024-12-29 11:11:05,476 [trainer.py] => model_prefix: asp
2024-12-29 11:11:07,007 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 11:11:17,501 [trainer.py] => All params: 173596160
2024-12-29 11:11:17,502 [trainer.py] => Trainable params: 1998848
2024-12-29 11:11:17,997 [asp.py] => Learning on 0-60
2024-12-29 11:11:18,118 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 11:11:18,206 [asp.py] => total parameters: 173642241
2024-12-29 11:11:18,207 [asp.py] => trainable parameters: 2044929
2024-12-29 11:11:18,208 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 11:22:03,018 [trainer.py] => config: ./exps/cifar.json
2024-12-29 11:22:03,018 [trainer.py] => model_name: asp
2024-12-29 11:22:03,018 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 11:22:03,018 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 11:22:03,018 [trainer.py] => seed: 2024
2024-12-29 11:22:03,018 [trainer.py] => dataset: cifar224
2024-12-29 11:22:03,018 [trainer.py] => init_cls: 60
2024-12-29 11:22:03,018 [trainer.py] => increment: 5
2024-12-29 11:22:03,018 [trainer.py] => kshot: 5
2024-12-29 11:22:03,018 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 11:22:03,018 [trainer.py] => z_dim: 1000
2024-12-29 11:22:03,018 [trainer.py] => conv_dim: 64
2024-12-29 11:22:03,019 [trainer.py] => img_size: 224
2024-12-29 11:22:03,019 [trainer.py] => generator_lr: 0.001
2024-12-29 11:22:03,019 [trainer.py] => pi: 100
2024-12-29 11:22:03,019 [trainer.py] => w_bn: 50.0
2024-12-29 11:22:03,019 [trainer.py] => w_noise: 0.001
2024-12-29 11:22:03,019 [trainer.py] => server_ss: 128
2024-12-29 11:22:03,019 [trainer.py] => bn_loss: 1
2024-12-29 11:22:03,019 [trainer.py] => noise: 1
2024-12-29 11:22:03,019 [trainer.py] => ie_loss: 1
2024-12-29 11:22:03,019 [trainer.py] => act_loss: 0
2024-12-29 11:22:03,019 [trainer.py] => w_ie: 1.0
2024-12-29 11:22:03,019 [trainer.py] => w_act: 0.1
2024-12-29 11:22:03,019 [trainer.py] => vpt_type: Deep
2024-12-29 11:22:03,019 [trainer.py] => prompt_token_num: 6
2024-12-29 11:22:03,019 [trainer.py] => avg_alpha: 0.8
2024-12-29 11:22:03,019 [trainer.py] => perturb_var: 1
2024-12-29 11:22:03,019 [trainer.py] => EMA_beta: 0.99
2024-12-29 11:22:03,019 [trainer.py] => anchor_lambda: 0.1
2024-12-29 11:22:03,019 [trainer.py] => kl_weight: 0.001
2024-12-29 11:22:03,019 [trainer.py] => TIP_init: zero
2024-12-29 11:22:03,019 [trainer.py] => tuned_epoch: 20
2024-12-29 11:22:03,019 [trainer.py] => fs_epoch: 0
2024-12-29 11:22:03,019 [trainer.py] => init_lr: 0.01
2024-12-29 11:22:03,019 [trainer.py] => fs_lr: 0.001
2024-12-29 11:22:03,019 [trainer.py] => batch_size: 48
2024-12-29 11:22:03,019 [trainer.py] => fs_batch_size: 16
2024-12-29 11:22:03,019 [trainer.py] => weight_decay: 0.0005
2024-12-29 11:22:03,019 [trainer.py] => min_lr: 0
2024-12-29 11:22:03,019 [trainer.py] => optimizer: sgd
2024-12-29 11:22:03,020 [trainer.py] => memory_size: 0
2024-12-29 11:22:03,020 [trainer.py] => memory_per_class: 0
2024-12-29 11:22:03,020 [trainer.py] => fixed_memory: False
2024-12-29 11:22:03,020 [trainer.py] => shuffle: False
2024-12-29 11:22:03,020 [trainer.py] => top_k: 5
2024-12-29 11:22:03,020 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 11:22:03,020 [trainer.py] => prefix: asp
2024-12-29 11:22:03,020 [trainer.py] => model_prefix: asp
2024-12-29 11:22:04,521 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 11:22:11,144 [trainer.py] => All params: 173596160
2024-12-29 11:22:11,146 [trainer.py] => Trainable params: 1998848
2024-12-29 11:22:11,628 [asp.py] => Learning on 0-60
2024-12-29 11:22:11,734 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 11:22:11,824 [asp.py] => total parameters: 173642241
2024-12-29 11:22:11,825 [asp.py] => trainable parameters: 2044929
2024-12-29 11:22:11,826 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 11:26:40,732 [trainer.py] => config: ./exps/cifar.json
2024-12-29 11:26:40,732 [trainer.py] => model_name: asp
2024-12-29 11:26:40,732 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 11:26:40,732 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 11:26:40,733 [trainer.py] => seed: 2024
2024-12-29 11:26:40,733 [trainer.py] => dataset: cifar224
2024-12-29 11:26:40,733 [trainer.py] => init_cls: 60
2024-12-29 11:26:40,733 [trainer.py] => increment: 5
2024-12-29 11:26:40,733 [trainer.py] => kshot: 5
2024-12-29 11:26:40,733 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 11:26:40,733 [trainer.py] => z_dim: 1000
2024-12-29 11:26:40,733 [trainer.py] => conv_dim: 64
2024-12-29 11:26:40,733 [trainer.py] => img_size: 224
2024-12-29 11:26:40,733 [trainer.py] => generator_lr: 0.001
2024-12-29 11:26:40,733 [trainer.py] => pi: 100
2024-12-29 11:26:40,733 [trainer.py] => w_bn: 50.0
2024-12-29 11:26:40,733 [trainer.py] => w_noise: 0.001
2024-12-29 11:26:40,733 [trainer.py] => server_ss: 128
2024-12-29 11:26:40,733 [trainer.py] => bn_loss: 1
2024-12-29 11:26:40,733 [trainer.py] => noise: 1
2024-12-29 11:26:40,733 [trainer.py] => ie_loss: 1
2024-12-29 11:26:40,733 [trainer.py] => act_loss: 0
2024-12-29 11:26:40,733 [trainer.py] => w_ie: 1.0
2024-12-29 11:26:40,733 [trainer.py] => w_act: 0.1
2024-12-29 11:26:40,733 [trainer.py] => vpt_type: Deep
2024-12-29 11:26:40,733 [trainer.py] => prompt_token_num: 6
2024-12-29 11:26:40,733 [trainer.py] => avg_alpha: 0.8
2024-12-29 11:26:40,733 [trainer.py] => perturb_var: 1
2024-12-29 11:26:40,733 [trainer.py] => EMA_beta: 0.99
2024-12-29 11:26:40,733 [trainer.py] => anchor_lambda: 0.1
2024-12-29 11:26:40,733 [trainer.py] => kl_weight: 0.001
2024-12-29 11:26:40,733 [trainer.py] => TIP_init: zero
2024-12-29 11:26:40,733 [trainer.py] => tuned_epoch: 20
2024-12-29 11:26:40,733 [trainer.py] => fs_epoch: 0
2024-12-29 11:26:40,734 [trainer.py] => init_lr: 0.01
2024-12-29 11:26:40,734 [trainer.py] => fs_lr: 0.001
2024-12-29 11:26:40,734 [trainer.py] => batch_size: 48
2024-12-29 11:26:40,734 [trainer.py] => fs_batch_size: 16
2024-12-29 11:26:40,734 [trainer.py] => weight_decay: 0.0005
2024-12-29 11:26:40,734 [trainer.py] => min_lr: 0
2024-12-29 11:26:40,734 [trainer.py] => optimizer: sgd
2024-12-29 11:26:40,734 [trainer.py] => memory_size: 0
2024-12-29 11:26:40,734 [trainer.py] => memory_per_class: 0
2024-12-29 11:26:40,734 [trainer.py] => fixed_memory: False
2024-12-29 11:26:40,734 [trainer.py] => shuffle: False
2024-12-29 11:26:40,734 [trainer.py] => top_k: 5
2024-12-29 11:26:40,734 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 11:26:40,734 [trainer.py] => prefix: asp
2024-12-29 11:26:40,734 [trainer.py] => model_prefix: asp
2024-12-29 11:26:42,231 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 11:26:48,750 [trainer.py] => All params: 173596160
2024-12-29 11:26:48,750 [trainer.py] => Trainable params: 1998848
2024-12-29 11:26:49,244 [asp.py] => Learning on 0-60
2024-12-29 11:26:49,393 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 11:26:49,493 [asp.py] => total parameters: 173642241
2024-12-29 11:26:49,494 [asp.py] => trainable parameters: 2044929
2024-12-29 11:26:49,495 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 11:34:21,943 [trainer.py] => Top1 curve: [91.82]
2024-12-29 11:34:21,943 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-29 11:34:21,944 [trainer.py] => All params: 173642241
2024-12-29 11:34:21,945 [trainer.py] => Trainable params: 2044929
2024-12-29 11:34:21,946 [asp.py] => Learning on 60-65
2024-12-29 11:34:21,956 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 11:34:21,958 [asp.py] => total parameters: 173646081
2024-12-29 11:34:21,959 [asp.py] => trainable parameters: 2048769
2024-12-29 11:37:36,760 [trainer.py] => Top1 curve: [91.82, 90.09]
2024-12-29 11:37:36,760 [trainer.py] => Average Accuracy (Top1): 90.955   (Harmonic Accuracy): 81.21629014284267 (Old Acc): 91.51666666666667 (New Acc): 73.0 

2024-12-29 11:37:36,761 [trainer.py] => All params: 173646081
2024-12-29 11:37:36,762 [trainer.py] => Trainable params: 2048769
2024-12-29 11:37:36,764 [asp.py] => Learning on 65-70
2024-12-29 11:37:36,775 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 11:37:36,778 [asp.py] => total parameters: 173649921
2024-12-29 11:37:36,779 [asp.py] => trainable parameters: 2052609
2024-12-29 11:41:56,777 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5]
2024-12-29 11:41:56,778 [trainer.py] => Average Accuracy (Top1): 90.46999999999998   (Harmonic Accuracy): 84.12586614173229 (Old Acc): 91.43333333333334 (New Acc): 77.9 

2024-12-29 11:41:56,779 [trainer.py] => All params: 173649921
2024-12-29 11:41:56,780 [trainer.py] => Trainable params: 2052609
2024-12-29 11:41:56,781 [asp.py] => Learning on 70-75
2024-12-29 11:41:56,796 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 11:41:56,799 [asp.py] => total parameters: 173653761
2024-12-29 11:41:56,799 [asp.py] => trainable parameters: 2056449
2024-12-29 11:45:26,713 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29]
2024-12-29 11:45:26,713 [trainer.py] => Average Accuracy (Top1): 89.925   (Harmonic Accuracy): 83.33658891645989 (Old Acc): 91.18333333333334 (New Acc): 76.73333333333333 

2024-12-29 11:45:26,714 [trainer.py] => All params: 173653761
2024-12-29 11:45:26,715 [trainer.py] => Trainable params: 2056449
2024-12-29 11:45:26,716 [asp.py] => Learning on 75-80
2024-12-29 11:45:26,740 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 11:45:26,742 [asp.py] => total parameters: 173657601
2024-12-29 11:45:26,743 [asp.py] => trainable parameters: 2060289
2024-12-29 11:46:05,816 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32]
2024-12-29 11:46:05,816 [trainer.py] => Average Accuracy (Top1): 89.604   (Harmonic Accuracy): 85.14776846618592 (Old Acc): 91.13333333333334 (New Acc): 79.9 

2024-12-29 11:46:05,817 [trainer.py] => All params: 173657601
2024-12-29 11:46:05,818 [trainer.py] => Trainable params: 2060289
2024-12-29 11:46:05,819 [asp.py] => Learning on 80-85
2024-12-29 11:46:05,833 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 11:46:05,836 [asp.py] => total parameters: 173661441
2024-12-29 11:46:05,837 [asp.py] => trainable parameters: 2064129
2024-12-29 11:50:09,184 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48]
2024-12-29 11:50:09,185 [trainer.py] => Average Accuracy (Top1): 89.25   (Harmonic Accuracy): 84.56792815404528 (Old Acc): 91.03333333333335 (New Acc): 78.96000000000001 

2024-12-29 11:50:09,186 [trainer.py] => All params: 173661441
2024-12-29 11:50:09,187 [trainer.py] => Trainable params: 2064129
2024-12-29 11:50:09,188 [asp.py] => Learning on 85-90
2024-12-29 11:50:09,201 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 11:50:09,204 [asp.py] => total parameters: 173665281
2024-12-29 11:50:09,204 [asp.py] => trainable parameters: 2067969
2024-12-29 11:54:03,229 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48, 87.39]
2024-12-29 11:54:03,230 [trainer.py] => Average Accuracy (Top1): 88.98428571428572   (Harmonic Accuracy): 85.33226957254978 (Old Acc): 90.86666666666666 (New Acc): 80.43333333333334 

2024-12-29 11:54:03,231 [trainer.py] => All params: 173665281
2024-12-29 11:54:03,232 [trainer.py] => Trainable params: 2067969
2024-12-29 11:54:03,233 [asp.py] => Learning on 90-95
2024-12-29 11:54:03,247 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 11:54:03,250 [asp.py] => total parameters: 173669121
2024-12-29 11:54:03,250 [asp.py] => trainable parameters: 2071809
2024-12-29 11:58:10,536 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48, 87.39, 87.03]
2024-12-29 11:58:10,536 [trainer.py] => Average Accuracy (Top1): 88.74   (Harmonic Accuracy): 85.4064258032254 (Old Acc): 90.75 (New Acc): 80.65714285714286 

2024-12-29 11:58:10,537 [trainer.py] => All params: 173669121
2024-12-29 11:58:10,537 [trainer.py] => Trainable params: 2071809
2024-12-29 11:58:10,539 [asp.py] => Learning on 95-100
2024-12-29 11:58:10,553 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 11:58:10,556 [asp.py] => total parameters: 173672961
2024-12-29 11:58:10,557 [asp.py] => trainable parameters: 2075649
2024-12-29 12:14:17,578 [trainer.py] => config: ./exps/cifar.json
2024-12-29 12:14:17,578 [trainer.py] => model_name: asp
2024-12-29 12:14:17,578 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 12:14:17,578 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 12:14:17,578 [trainer.py] => seed: 2024
2024-12-29 12:14:17,578 [trainer.py] => dataset: cifar224
2024-12-29 12:14:17,578 [trainer.py] => init_cls: 60
2024-12-29 12:14:17,578 [trainer.py] => increment: 5
2024-12-29 12:14:17,578 [trainer.py] => kshot: 5
2024-12-29 12:14:17,578 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 12:14:17,578 [trainer.py] => z_dim: 1000
2024-12-29 12:14:17,579 [trainer.py] => conv_dim: 64
2024-12-29 12:14:17,579 [trainer.py] => img_size: 224
2024-12-29 12:14:17,579 [trainer.py] => generator_lr: 0.001
2024-12-29 12:14:17,579 [trainer.py] => pi: 100
2024-12-29 12:14:17,579 [trainer.py] => w_bn: 50.0
2024-12-29 12:14:17,579 [trainer.py] => w_noise: 0.001
2024-12-29 12:14:17,579 [trainer.py] => server_ss: 128
2024-12-29 12:14:17,579 [trainer.py] => bn_loss: 1
2024-12-29 12:14:17,579 [trainer.py] => noise: 1
2024-12-29 12:14:17,579 [trainer.py] => ie_loss: 1
2024-12-29 12:14:17,579 [trainer.py] => act_loss: 0
2024-12-29 12:14:17,579 [trainer.py] => w_ie: 1.0
2024-12-29 12:14:17,579 [trainer.py] => w_act: 0.1
2024-12-29 12:14:17,579 [trainer.py] => syn_size: 224
2024-12-29 12:14:17,579 [trainer.py] => vpt_type: Deep
2024-12-29 12:14:17,579 [trainer.py] => prompt_token_num: 6
2024-12-29 12:14:17,579 [trainer.py] => avg_alpha: 0.8
2024-12-29 12:14:17,579 [trainer.py] => perturb_var: 1
2024-12-29 12:14:17,579 [trainer.py] => EMA_beta: 0.99
2024-12-29 12:14:17,579 [trainer.py] => anchor_lambda: 0.1
2024-12-29 12:14:17,579 [trainer.py] => kl_weight: 0.001
2024-12-29 12:14:17,579 [trainer.py] => TIP_init: zero
2024-12-29 12:14:17,579 [trainer.py] => tuned_epoch: 20
2024-12-29 12:14:17,579 [trainer.py] => fs_epoch: 0
2024-12-29 12:14:17,579 [trainer.py] => init_lr: 0.01
2024-12-29 12:14:17,579 [trainer.py] => fs_lr: 0.001
2024-12-29 12:14:17,579 [trainer.py] => batch_size: 48
2024-12-29 12:14:17,579 [trainer.py] => fs_batch_size: 16
2024-12-29 12:14:17,579 [trainer.py] => weight_decay: 0.0005
2024-12-29 12:14:17,580 [trainer.py] => min_lr: 0
2024-12-29 12:14:17,580 [trainer.py] => optimizer: sgd
2024-12-29 12:14:17,580 [trainer.py] => memory_size: 0
2024-12-29 12:14:17,580 [trainer.py] => memory_per_class: 0
2024-12-29 12:14:17,580 [trainer.py] => fixed_memory: False
2024-12-29 12:14:17,580 [trainer.py] => shuffle: False
2024-12-29 12:14:17,580 [trainer.py] => top_k: 5
2024-12-29 12:14:17,580 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 12:14:17,580 [trainer.py] => prefix: asp
2024-12-29 12:14:17,580 [trainer.py] => model_prefix: asp
2024-12-29 12:14:19,052 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 12:14:24,976 [trainer.py] => All params: 173596160
2024-12-29 12:14:24,977 [trainer.py] => Trainable params: 1998848
2024-12-29 12:14:25,483 [asp.py] => Learning on 0-60
2024-12-29 12:14:25,619 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 12:14:25,720 [asp.py] => total parameters: 173642241
2024-12-29 12:14:25,720 [asp.py] => trainable parameters: 2044929
2024-12-29 12:14:25,721 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 12:19:49,810 [trainer.py] => config: ./exps/cifar.json
2024-12-29 12:19:49,810 [trainer.py] => model_name: asp
2024-12-29 12:19:49,810 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 12:19:49,811 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 12:19:49,811 [trainer.py] => seed: 2024
2024-12-29 12:19:49,811 [trainer.py] => dataset: cifar224
2024-12-29 12:19:49,811 [trainer.py] => init_cls: 60
2024-12-29 12:19:49,811 [trainer.py] => increment: 5
2024-12-29 12:19:49,811 [trainer.py] => kshot: 5
2024-12-29 12:19:49,811 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 12:19:49,811 [trainer.py] => z_dim: 1000
2024-12-29 12:19:49,811 [trainer.py] => conv_dim: 64
2024-12-29 12:19:49,811 [trainer.py] => img_size: 224
2024-12-29 12:19:49,811 [trainer.py] => generator_lr: 0.001
2024-12-29 12:19:49,811 [trainer.py] => pi: 100
2024-12-29 12:19:49,811 [trainer.py] => w_bn: 50.0
2024-12-29 12:19:49,811 [trainer.py] => w_noise: 0.001
2024-12-29 12:19:49,811 [trainer.py] => server_ss: 128
2024-12-29 12:19:49,811 [trainer.py] => bn_loss: 1
2024-12-29 12:19:49,811 [trainer.py] => noise: 1
2024-12-29 12:19:49,811 [trainer.py] => ie_loss: 1
2024-12-29 12:19:49,811 [trainer.py] => act_loss: 0
2024-12-29 12:19:49,811 [trainer.py] => w_ie: 1.0
2024-12-29 12:19:49,811 [trainer.py] => w_act: 0.1
2024-12-29 12:19:49,811 [trainer.py] => syn_size: 224
2024-12-29 12:19:49,811 [trainer.py] => vpt_type: Deep
2024-12-29 12:19:49,811 [trainer.py] => prompt_token_num: 6
2024-12-29 12:19:49,811 [trainer.py] => avg_alpha: 0.8
2024-12-29 12:19:49,811 [trainer.py] => perturb_var: 1
2024-12-29 12:19:49,811 [trainer.py] => EMA_beta: 0.99
2024-12-29 12:19:49,812 [trainer.py] => anchor_lambda: 0.1
2024-12-29 12:19:49,812 [trainer.py] => kl_weight: 0.001
2024-12-29 12:19:49,812 [trainer.py] => TIP_init: zero
2024-12-29 12:19:49,812 [trainer.py] => tuned_epoch: 20
2024-12-29 12:19:49,812 [trainer.py] => fs_epoch: 0
2024-12-29 12:19:49,812 [trainer.py] => init_lr: 0.01
2024-12-29 12:19:49,812 [trainer.py] => fs_lr: 0.001
2024-12-29 12:19:49,812 [trainer.py] => batch_size: 48
2024-12-29 12:19:49,812 [trainer.py] => fs_batch_size: 16
2024-12-29 12:19:49,812 [trainer.py] => weight_decay: 0.0005
2024-12-29 12:19:49,812 [trainer.py] => min_lr: 0
2024-12-29 12:19:49,812 [trainer.py] => optimizer: sgd
2024-12-29 12:19:49,812 [trainer.py] => memory_size: 0
2024-12-29 12:19:49,812 [trainer.py] => memory_per_class: 0
2024-12-29 12:19:49,812 [trainer.py] => fixed_memory: False
2024-12-29 12:19:49,812 [trainer.py] => shuffle: False
2024-12-29 12:19:49,812 [trainer.py] => top_k: 5
2024-12-29 12:19:49,812 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 12:19:49,812 [trainer.py] => prefix: asp
2024-12-29 12:19:49,812 [trainer.py] => model_prefix: asp
2024-12-29 12:19:51,311 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 12:19:57,421 [trainer.py] => All params: 173596160
2024-12-29 12:19:57,422 [trainer.py] => Trainable params: 1998848
2024-12-29 12:19:57,910 [asp.py] => Learning on 0-60
2024-12-29 12:19:57,980 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 12:19:58,069 [asp.py] => total parameters: 173642241
2024-12-29 12:19:58,069 [asp.py] => trainable parameters: 2044929
2024-12-29 12:19:58,070 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 12:20:24,372 [trainer.py] => config: ./exps/cifar.json
2024-12-29 12:20:24,372 [trainer.py] => model_name: asp
2024-12-29 12:20:24,373 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 12:20:24,373 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 12:20:24,373 [trainer.py] => seed: 2024
2024-12-29 12:20:24,373 [trainer.py] => dataset: cifar224
2024-12-29 12:20:24,373 [trainer.py] => init_cls: 60
2024-12-29 12:20:24,373 [trainer.py] => increment: 5
2024-12-29 12:20:24,373 [trainer.py] => kshot: 5
2024-12-29 12:20:24,373 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 12:20:24,373 [trainer.py] => z_dim: 1000
2024-12-29 12:20:24,373 [trainer.py] => conv_dim: 64
2024-12-29 12:20:24,373 [trainer.py] => img_size: 224
2024-12-29 12:20:24,373 [trainer.py] => generator_lr: 0.001
2024-12-29 12:20:24,373 [trainer.py] => pi: 100
2024-12-29 12:20:24,373 [trainer.py] => w_bn: 50.0
2024-12-29 12:20:24,373 [trainer.py] => w_noise: 0.001
2024-12-29 12:20:24,373 [trainer.py] => server_ss: 128
2024-12-29 12:20:24,373 [trainer.py] => bn_loss: 1
2024-12-29 12:20:24,373 [trainer.py] => noise: 1
2024-12-29 12:20:24,373 [trainer.py] => ie_loss: 1
2024-12-29 12:20:24,373 [trainer.py] => act_loss: 0
2024-12-29 12:20:24,373 [trainer.py] => w_ie: 1.0
2024-12-29 12:20:24,373 [trainer.py] => w_act: 0.1
2024-12-29 12:20:24,373 [trainer.py] => syn_size: 224
2024-12-29 12:20:24,373 [trainer.py] => vpt_type: Deep
2024-12-29 12:20:24,373 [trainer.py] => prompt_token_num: 6
2024-12-29 12:20:24,373 [trainer.py] => avg_alpha: 0.8
2024-12-29 12:20:24,373 [trainer.py] => perturb_var: 1
2024-12-29 12:20:24,373 [trainer.py] => EMA_beta: 0.99
2024-12-29 12:20:24,373 [trainer.py] => anchor_lambda: 0.1
2024-12-29 12:20:24,373 [trainer.py] => kl_weight: 0.001
2024-12-29 12:20:24,374 [trainer.py] => TIP_init: zero
2024-12-29 12:20:24,374 [trainer.py] => tuned_epoch: 20
2024-12-29 12:20:24,374 [trainer.py] => fs_epoch: 0
2024-12-29 12:20:24,374 [trainer.py] => init_lr: 0.01
2024-12-29 12:20:24,374 [trainer.py] => fs_lr: 0.001
2024-12-29 12:20:24,374 [trainer.py] => batch_size: 48
2024-12-29 12:20:24,374 [trainer.py] => fs_batch_size: 16
2024-12-29 12:20:24,374 [trainer.py] => weight_decay: 0.0005
2024-12-29 12:20:24,374 [trainer.py] => min_lr: 0
2024-12-29 12:20:24,374 [trainer.py] => optimizer: sgd
2024-12-29 12:20:24,374 [trainer.py] => memory_size: 0
2024-12-29 12:20:24,374 [trainer.py] => memory_per_class: 0
2024-12-29 12:20:24,374 [trainer.py] => fixed_memory: False
2024-12-29 12:20:24,374 [trainer.py] => shuffle: False
2024-12-29 12:20:24,374 [trainer.py] => top_k: 5
2024-12-29 12:20:24,374 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 12:20:24,374 [trainer.py] => prefix: asp
2024-12-29 12:20:24,374 [trainer.py] => model_prefix: asp
2024-12-29 12:20:26,439 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 12:20:50,099 [trainer.py] => config: ./exps/cifar.json
2024-12-29 12:20:50,099 [trainer.py] => model_name: asp
2024-12-29 12:20:50,099 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 12:20:50,099 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 12:20:50,099 [trainer.py] => seed: 2024
2024-12-29 12:20:50,099 [trainer.py] => dataset: cifar224
2024-12-29 12:20:50,099 [trainer.py] => init_cls: 60
2024-12-29 12:20:50,099 [trainer.py] => increment: 5
2024-12-29 12:20:50,099 [trainer.py] => kshot: 5
2024-12-29 12:20:50,099 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 12:20:50,099 [trainer.py] => z_dim: 1000
2024-12-29 12:20:50,099 [trainer.py] => conv_dim: 64
2024-12-29 12:20:50,099 [trainer.py] => img_size: 224
2024-12-29 12:20:50,099 [trainer.py] => generator_lr: 0.001
2024-12-29 12:20:50,099 [trainer.py] => pi: 100
2024-12-29 12:20:50,099 [trainer.py] => w_bn: 50.0
2024-12-29 12:20:50,099 [trainer.py] => w_noise: 0.001
2024-12-29 12:20:50,099 [trainer.py] => server_ss: 128
2024-12-29 12:20:50,099 [trainer.py] => bn_loss: 1
2024-12-29 12:20:50,099 [trainer.py] => noise: 1
2024-12-29 12:20:50,099 [trainer.py] => ie_loss: 1
2024-12-29 12:20:50,099 [trainer.py] => act_loss: 0
2024-12-29 12:20:50,099 [trainer.py] => w_ie: 1.0
2024-12-29 12:20:50,099 [trainer.py] => w_act: 0.1
2024-12-29 12:20:50,099 [trainer.py] => syn_size: 224
2024-12-29 12:20:50,100 [trainer.py] => vpt_type: Deep
2024-12-29 12:20:50,100 [trainer.py] => prompt_token_num: 6
2024-12-29 12:20:50,100 [trainer.py] => avg_alpha: 0.8
2024-12-29 12:20:50,100 [trainer.py] => perturb_var: 1
2024-12-29 12:20:50,100 [trainer.py] => EMA_beta: 0.99
2024-12-29 12:20:50,100 [trainer.py] => anchor_lambda: 0.1
2024-12-29 12:20:50,100 [trainer.py] => kl_weight: 0.001
2024-12-29 12:20:50,100 [trainer.py] => TIP_init: zero
2024-12-29 12:20:50,100 [trainer.py] => tuned_epoch: 20
2024-12-29 12:20:50,100 [trainer.py] => fs_epoch: 0
2024-12-29 12:20:50,100 [trainer.py] => init_lr: 0.01
2024-12-29 12:20:50,100 [trainer.py] => fs_lr: 0.001
2024-12-29 12:20:50,100 [trainer.py] => batch_size: 48
2024-12-29 12:20:50,100 [trainer.py] => fs_batch_size: 16
2024-12-29 12:20:50,100 [trainer.py] => weight_decay: 0.0005
2024-12-29 12:20:50,100 [trainer.py] => min_lr: 0
2024-12-29 12:20:50,100 [trainer.py] => optimizer: sgd
2024-12-29 12:20:50,100 [trainer.py] => memory_size: 0
2024-12-29 12:20:50,100 [trainer.py] => memory_per_class: 0
2024-12-29 12:20:50,100 [trainer.py] => fixed_memory: False
2024-12-29 12:20:50,100 [trainer.py] => shuffle: False
2024-12-29 12:20:50,100 [trainer.py] => top_k: 5
2024-12-29 12:20:50,100 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 12:20:50,100 [trainer.py] => prefix: asp
2024-12-29 12:20:50,100 [trainer.py] => model_prefix: asp
2024-12-29 12:20:52,618 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 12:20:58,856 [trainer.py] => All params: 173596160
2024-12-29 12:20:58,857 [trainer.py] => Trainable params: 1998848
2024-12-29 12:21:23,574 [trainer.py] => config: ./exps/cifar.json
2024-12-29 12:21:23,574 [trainer.py] => model_name: asp
2024-12-29 12:21:23,574 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 12:21:23,574 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 12:21:23,574 [trainer.py] => seed: 2024
2024-12-29 12:21:23,574 [trainer.py] => dataset: cifar224
2024-12-29 12:21:23,574 [trainer.py] => init_cls: 60
2024-12-29 12:21:23,574 [trainer.py] => increment: 5
2024-12-29 12:21:23,574 [trainer.py] => kshot: 5
2024-12-29 12:21:23,574 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 12:21:23,574 [trainer.py] => z_dim: 1000
2024-12-29 12:21:23,574 [trainer.py] => conv_dim: 64
2024-12-29 12:21:23,575 [trainer.py] => img_size: 224
2024-12-29 12:21:23,575 [trainer.py] => generator_lr: 0.001
2024-12-29 12:21:23,575 [trainer.py] => pi: 100
2024-12-29 12:21:23,575 [trainer.py] => w_bn: 50.0
2024-12-29 12:21:23,575 [trainer.py] => w_noise: 0.001
2024-12-29 12:21:23,575 [trainer.py] => server_ss: 128
2024-12-29 12:21:23,575 [trainer.py] => bn_loss: 1
2024-12-29 12:21:23,575 [trainer.py] => noise: 1
2024-12-29 12:21:23,575 [trainer.py] => ie_loss: 1
2024-12-29 12:21:23,575 [trainer.py] => act_loss: 0
2024-12-29 12:21:23,575 [trainer.py] => w_ie: 1.0
2024-12-29 12:21:23,575 [trainer.py] => w_act: 0.1
2024-12-29 12:21:23,575 [trainer.py] => syn_size: 224
2024-12-29 12:21:23,575 [trainer.py] => vpt_type: Deep
2024-12-29 12:21:23,575 [trainer.py] => prompt_token_num: 6
2024-12-29 12:21:23,575 [trainer.py] => avg_alpha: 0.8
2024-12-29 12:21:23,575 [trainer.py] => perturb_var: 1
2024-12-29 12:21:23,575 [trainer.py] => EMA_beta: 0.99
2024-12-29 12:21:23,575 [trainer.py] => anchor_lambda: 0.1
2024-12-29 12:21:23,575 [trainer.py] => kl_weight: 0.001
2024-12-29 12:21:23,575 [trainer.py] => TIP_init: zero
2024-12-29 12:21:23,575 [trainer.py] => tuned_epoch: 20
2024-12-29 12:21:23,575 [trainer.py] => fs_epoch: 0
2024-12-29 12:21:23,575 [trainer.py] => init_lr: 0.01
2024-12-29 12:21:23,575 [trainer.py] => fs_lr: 0.001
2024-12-29 12:21:23,575 [trainer.py] => batch_size: 48
2024-12-29 12:21:23,575 [trainer.py] => fs_batch_size: 16
2024-12-29 12:21:23,575 [trainer.py] => weight_decay: 0.0005
2024-12-29 12:21:23,576 [trainer.py] => min_lr: 0
2024-12-29 12:21:23,576 [trainer.py] => optimizer: sgd
2024-12-29 12:21:23,576 [trainer.py] => memory_size: 0
2024-12-29 12:21:23,576 [trainer.py] => memory_per_class: 0
2024-12-29 12:21:23,576 [trainer.py] => fixed_memory: False
2024-12-29 12:21:23,576 [trainer.py] => shuffle: False
2024-12-29 12:21:23,576 [trainer.py] => top_k: 5
2024-12-29 12:21:23,576 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 12:21:23,576 [trainer.py] => prefix: asp
2024-12-29 12:21:23,576 [trainer.py] => model_prefix: asp
2024-12-29 12:21:25,213 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 12:21:32,141 [trainer.py] => All params: 173596160
2024-12-29 12:21:32,142 [trainer.py] => Trainable params: 1998848
2024-12-29 12:21:32,523 [asp.py] => Learning on 0-60
2024-12-29 12:21:34,297 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 12:21:34,920 [asp.py] => total parameters: 173642241
2024-12-29 12:21:34,921 [asp.py] => trainable parameters: 2044929
2024-12-29 12:21:34,922 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 12:29:51,114 [trainer.py] => Top1 curve: [91.82]
2024-12-29 12:29:51,115 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-29 12:29:51,116 [trainer.py] => All params: 173642241
2024-12-29 12:29:51,116 [trainer.py] => Trainable params: 2044929
2024-12-29 12:29:51,117 [asp.py] => Learning on 60-65
2024-12-29 12:29:51,129 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 12:29:51,132 [asp.py] => total parameters: 173646081
2024-12-29 12:29:51,133 [asp.py] => trainable parameters: 2048769
2024-12-29 12:32:45,049 [trainer.py] => config: ./exps/cifar.json
2024-12-29 12:32:45,049 [trainer.py] => model_name: asp
2024-12-29 12:32:45,049 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 12:32:45,049 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 12:32:45,049 [trainer.py] => seed: 2024
2024-12-29 12:32:45,049 [trainer.py] => dataset: cifar224
2024-12-29 12:32:45,049 [trainer.py] => init_cls: 60
2024-12-29 12:32:45,049 [trainer.py] => increment: 5
2024-12-29 12:32:45,049 [trainer.py] => kshot: 5
2024-12-29 12:32:45,049 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 12:32:45,049 [trainer.py] => z_dim: 1000
2024-12-29 12:32:45,049 [trainer.py] => conv_dim: 64
2024-12-29 12:32:45,049 [trainer.py] => img_size: 224
2024-12-29 12:32:45,049 [trainer.py] => generator_lr: 0.001
2024-12-29 12:32:45,049 [trainer.py] => pi: 100
2024-12-29 12:32:45,049 [trainer.py] => w_bn: 50.0
2024-12-29 12:32:45,049 [trainer.py] => w_noise: 0.001
2024-12-29 12:32:45,049 [trainer.py] => server_ss: 128
2024-12-29 12:32:45,049 [trainer.py] => bn_loss: 1
2024-12-29 12:32:45,049 [trainer.py] => noise: 1
2024-12-29 12:32:45,049 [trainer.py] => ie_loss: 1
2024-12-29 12:32:45,049 [trainer.py] => act_loss: 0
2024-12-29 12:32:45,050 [trainer.py] => w_ie: 1.0
2024-12-29 12:32:45,050 [trainer.py] => w_act: 0.1
2024-12-29 12:32:45,050 [trainer.py] => syn_size: 224
2024-12-29 12:32:45,050 [trainer.py] => vpt_type: Deep
2024-12-29 12:32:45,050 [trainer.py] => prompt_token_num: 6
2024-12-29 12:32:45,050 [trainer.py] => avg_alpha: 0.8
2024-12-29 12:32:45,050 [trainer.py] => perturb_var: 1
2024-12-29 12:32:45,050 [trainer.py] => EMA_beta: 0.99
2024-12-29 12:32:45,050 [trainer.py] => anchor_lambda: 0.1
2024-12-29 12:32:45,050 [trainer.py] => kl_weight: 0.001
2024-12-29 12:32:45,050 [trainer.py] => TIP_init: zero
2024-12-29 12:32:45,050 [trainer.py] => tuned_epoch: 20
2024-12-29 12:32:45,050 [trainer.py] => fs_epoch: 0
2024-12-29 12:32:45,050 [trainer.py] => init_lr: 0.01
2024-12-29 12:32:45,050 [trainer.py] => fs_lr: 0.001
2024-12-29 12:32:45,050 [trainer.py] => batch_size: 48
2024-12-29 12:32:45,050 [trainer.py] => fs_batch_size: 16
2024-12-29 12:32:45,050 [trainer.py] => weight_decay: 0.0005
2024-12-29 12:32:45,050 [trainer.py] => min_lr: 0
2024-12-29 12:32:45,050 [trainer.py] => optimizer: sgd
2024-12-29 12:32:45,050 [trainer.py] => memory_size: 0
2024-12-29 12:32:45,050 [trainer.py] => memory_per_class: 0
2024-12-29 12:32:45,050 [trainer.py] => fixed_memory: False
2024-12-29 12:32:45,050 [trainer.py] => shuffle: False
2024-12-29 12:32:45,050 [trainer.py] => top_k: 5
2024-12-29 12:32:45,050 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 12:32:45,050 [trainer.py] => prefix: asp
2024-12-29 12:32:45,050 [trainer.py] => model_prefix: asp
2024-12-29 12:32:46,658 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 12:32:53,182 [trainer.py] => All params: 173596160
2024-12-29 12:32:53,183 [trainer.py] => Trainable params: 1998848
2024-12-29 12:32:53,682 [asp.py] => Learning on 0-60
2024-12-29 12:32:53,815 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 12:32:53,906 [asp.py] => total parameters: 173642241
2024-12-29 12:32:53,906 [asp.py] => trainable parameters: 2044929
2024-12-29 12:32:53,907 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 12:40:05,725 [trainer.py] => Top1 curve: [91.82]
2024-12-29 12:40:05,725 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-29 12:40:05,726 [trainer.py] => All params: 173642241
2024-12-29 12:40:05,727 [trainer.py] => Trainable params: 2044929
2024-12-29 12:40:05,728 [asp.py] => Learning on 60-65
2024-12-29 12:40:05,746 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 12:40:05,749 [asp.py] => total parameters: 173646081
2024-12-29 12:40:05,749 [asp.py] => trainable parameters: 2048769
2024-12-29 14:33:40,702 [trainer.py] => config: ./exps/cifar.json
2024-12-29 14:33:40,702 [trainer.py] => model_name: asp
2024-12-29 14:33:40,702 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 14:33:40,702 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 14:33:40,702 [trainer.py] => seed: 2024
2024-12-29 14:33:40,702 [trainer.py] => dataset: cifar224
2024-12-29 14:33:40,702 [trainer.py] => init_cls: 60
2024-12-29 14:33:40,702 [trainer.py] => increment: 5
2024-12-29 14:33:40,702 [trainer.py] => kshot: 5
2024-12-29 14:33:40,702 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 14:33:40,702 [trainer.py] => z_dim: 1000
2024-12-29 14:33:40,702 [trainer.py] => conv_dim: 64
2024-12-29 14:33:40,702 [trainer.py] => img_size: 224
2024-12-29 14:33:40,702 [trainer.py] => generator_lr: 0.001
2024-12-29 14:33:40,702 [trainer.py] => pi: 100
2024-12-29 14:33:40,702 [trainer.py] => w_bn: 50.0
2024-12-29 14:33:40,702 [trainer.py] => w_noise: 0.001
2024-12-29 14:33:40,702 [trainer.py] => server_ss: 128
2024-12-29 14:33:40,703 [trainer.py] => bn_loss: 1
2024-12-29 14:33:40,703 [trainer.py] => noise: 1
2024-12-29 14:33:40,703 [trainer.py] => ie_loss: 1
2024-12-29 14:33:40,703 [trainer.py] => act_loss: 0
2024-12-29 14:33:40,703 [trainer.py] => w_ie: 1.0
2024-12-29 14:33:40,703 [trainer.py] => w_act: 0.1
2024-12-29 14:33:40,703 [trainer.py] => syn_size: 224
2024-12-29 14:33:40,703 [trainer.py] => vpt_type: Deep
2024-12-29 14:33:40,703 [trainer.py] => prompt_token_num: 6
2024-12-29 14:33:40,703 [trainer.py] => avg_alpha: 0.8
2024-12-29 14:33:40,703 [trainer.py] => perturb_var: 1
2024-12-29 14:33:40,703 [trainer.py] => EMA_beta: 0.99
2024-12-29 14:33:40,703 [trainer.py] => anchor_lambda: 0.1
2024-12-29 14:33:40,703 [trainer.py] => kl_weight: 0.001
2024-12-29 14:33:40,703 [trainer.py] => TIP_init: zero
2024-12-29 14:33:40,703 [trainer.py] => tuned_epoch: 20
2024-12-29 14:33:40,703 [trainer.py] => fs_epoch: 0
2024-12-29 14:33:40,703 [trainer.py] => init_lr: 0.01
2024-12-29 14:33:40,703 [trainer.py] => fs_lr: 0.001
2024-12-29 14:33:40,703 [trainer.py] => batch_size: 48
2024-12-29 14:33:40,703 [trainer.py] => fs_batch_size: 16
2024-12-29 14:33:40,703 [trainer.py] => weight_decay: 0.0005
2024-12-29 14:33:40,703 [trainer.py] => min_lr: 0
2024-12-29 14:33:40,703 [trainer.py] => optimizer: sgd
2024-12-29 14:33:40,703 [trainer.py] => memory_size: 0
2024-12-29 14:33:40,703 [trainer.py] => memory_per_class: 0
2024-12-29 14:33:40,703 [trainer.py] => fixed_memory: False
2024-12-29 14:33:40,703 [trainer.py] => shuffle: False
2024-12-29 14:33:40,703 [trainer.py] => top_k: 5
2024-12-29 14:33:40,703 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 14:33:40,703 [trainer.py] => prefix: asp
2024-12-29 14:33:40,704 [trainer.py] => model_prefix: asp
2024-12-29 14:33:42,180 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 14:33:48,224 [trainer.py] => All params: 173596160
2024-12-29 14:33:48,225 [trainer.py] => Trainable params: 1998848
2024-12-29 14:33:48,710 [asp.py] => Learning on 0-60
2024-12-29 14:33:48,801 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 14:33:48,889 [asp.py] => total parameters: 173642241
2024-12-29 14:33:48,890 [asp.py] => trainable parameters: 2044929
2024-12-29 14:33:48,891 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 14:44:46,548 [trainer.py] => config: ./exps/cifar.json
2024-12-29 14:44:46,549 [trainer.py] => model_name: asp
2024-12-29 14:44:46,549 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 14:44:46,549 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 14:44:46,549 [trainer.py] => seed: 2024
2024-12-29 14:44:46,549 [trainer.py] => dataset: cifar224
2024-12-29 14:44:46,549 [trainer.py] => init_cls: 60
2024-12-29 14:44:46,549 [trainer.py] => increment: 5
2024-12-29 14:44:46,549 [trainer.py] => kshot: 5
2024-12-29 14:44:46,549 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 14:44:46,549 [trainer.py] => z_dim: 1000
2024-12-29 14:44:46,549 [trainer.py] => conv_dim: 64
2024-12-29 14:44:46,549 [trainer.py] => img_size: 224
2024-12-29 14:44:46,549 [trainer.py] => generator_lr: 0.001
2024-12-29 14:44:46,549 [trainer.py] => pi: 100
2024-12-29 14:44:46,549 [trainer.py] => w_bn: 50.0
2024-12-29 14:44:46,549 [trainer.py] => w_noise: 0.001
2024-12-29 14:44:46,549 [trainer.py] => server_ss: 128
2024-12-29 14:44:46,549 [trainer.py] => bn_loss: 1
2024-12-29 14:44:46,549 [trainer.py] => noise: 1
2024-12-29 14:44:46,549 [trainer.py] => ie_loss: 1
2024-12-29 14:44:46,549 [trainer.py] => act_loss: 0
2024-12-29 14:44:46,549 [trainer.py] => w_ie: 1.0
2024-12-29 14:44:46,549 [trainer.py] => w_act: 0.1
2024-12-29 14:44:46,549 [trainer.py] => syn_size: 224
2024-12-29 14:44:46,549 [trainer.py] => vpt_type: Deep
2024-12-29 14:44:46,549 [trainer.py] => prompt_token_num: 6
2024-12-29 14:44:46,549 [trainer.py] => avg_alpha: 0.8
2024-12-29 14:44:46,550 [trainer.py] => perturb_var: 1
2024-12-29 14:44:46,550 [trainer.py] => EMA_beta: 0.99
2024-12-29 14:44:46,550 [trainer.py] => anchor_lambda: 0.1
2024-12-29 14:44:46,550 [trainer.py] => kl_weight: 0.001
2024-12-29 14:44:46,550 [trainer.py] => TIP_init: zero
2024-12-29 14:44:46,550 [trainer.py] => tuned_epoch: 20
2024-12-29 14:44:46,550 [trainer.py] => fs_epoch: 0
2024-12-29 14:44:46,550 [trainer.py] => init_lr: 0.01
2024-12-29 14:44:46,550 [trainer.py] => fs_lr: 0.001
2024-12-29 14:44:46,550 [trainer.py] => batch_size: 48
2024-12-29 14:44:46,550 [trainer.py] => fs_batch_size: 16
2024-12-29 14:44:46,550 [trainer.py] => weight_decay: 0.0005
2024-12-29 14:44:46,550 [trainer.py] => min_lr: 0
2024-12-29 14:44:46,550 [trainer.py] => optimizer: sgd
2024-12-29 14:44:46,550 [trainer.py] => memory_size: 0
2024-12-29 14:44:46,550 [trainer.py] => memory_per_class: 0
2024-12-29 14:44:46,550 [trainer.py] => fixed_memory: False
2024-12-29 14:44:46,550 [trainer.py] => shuffle: False
2024-12-29 14:44:46,550 [trainer.py] => top_k: 5
2024-12-29 14:44:46,550 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 14:44:46,550 [trainer.py] => prefix: asp
2024-12-29 14:44:46,550 [trainer.py] => model_prefix: asp
2024-12-29 14:44:48,024 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 14:44:54,191 [trainer.py] => All params: 173596160
2024-12-29 14:44:54,192 [trainer.py] => Trainable params: 1998848
2024-12-29 14:44:54,665 [asp.py] => Learning on 0-60
2024-12-29 14:44:54,759 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 14:44:54,849 [asp.py] => total parameters: 173642241
2024-12-29 14:44:54,850 [asp.py] => trainable parameters: 2044929
2024-12-29 14:44:54,850 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 14:51:47,928 [trainer.py] => Top1 curve: [91.82]
2024-12-29 14:51:47,929 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-29 14:51:47,930 [trainer.py] => All params: 173642241
2024-12-29 14:51:47,930 [trainer.py] => Trainable params: 2044929
2024-12-29 14:51:47,931 [asp.py] => Learning on 60-65
2024-12-29 14:51:47,951 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 14:51:47,954 [asp.py] => total parameters: 173646081
2024-12-29 14:51:47,955 [asp.py] => trainable parameters: 2048769
2024-12-29 14:58:13,508 [trainer.py] => config: ./exps/cifar.json
2024-12-29 14:58:13,508 [trainer.py] => model_name: asp
2024-12-29 14:58:13,508 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 14:58:13,508 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 14:58:13,508 [trainer.py] => seed: 2024
2024-12-29 14:58:13,508 [trainer.py] => dataset: cifar224
2024-12-29 14:58:13,508 [trainer.py] => init_cls: 60
2024-12-29 14:58:13,508 [trainer.py] => increment: 5
2024-12-29 14:58:13,508 [trainer.py] => kshot: 5
2024-12-29 14:58:13,508 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 14:58:13,508 [trainer.py] => z_dim: 1000
2024-12-29 14:58:13,508 [trainer.py] => conv_dim: 64
2024-12-29 14:58:13,508 [trainer.py] => img_size: 224
2024-12-29 14:58:13,508 [trainer.py] => generator_lr: 0.001
2024-12-29 14:58:13,508 [trainer.py] => pi: 100
2024-12-29 14:58:13,508 [trainer.py] => w_bn: 50.0
2024-12-29 14:58:13,508 [trainer.py] => w_noise: 0.001
2024-12-29 14:58:13,508 [trainer.py] => server_ss: 32
2024-12-29 14:58:13,508 [trainer.py] => bn_loss: 1
2024-12-29 14:58:13,508 [trainer.py] => noise: 1
2024-12-29 14:58:13,509 [trainer.py] => ie_loss: 1
2024-12-29 14:58:13,509 [trainer.py] => act_loss: 0
2024-12-29 14:58:13,509 [trainer.py] => w_ie: 1.0
2024-12-29 14:58:13,509 [trainer.py] => w_act: 0.1
2024-12-29 14:58:13,509 [trainer.py] => syn_size: 224
2024-12-29 14:58:13,509 [trainer.py] => vpt_type: Deep
2024-12-29 14:58:13,509 [trainer.py] => prompt_token_num: 6
2024-12-29 14:58:13,509 [trainer.py] => avg_alpha: 0.8
2024-12-29 14:58:13,509 [trainer.py] => perturb_var: 1
2024-12-29 14:58:13,509 [trainer.py] => EMA_beta: 0.99
2024-12-29 14:58:13,509 [trainer.py] => anchor_lambda: 0.1
2024-12-29 14:58:13,509 [trainer.py] => kl_weight: 0.001
2024-12-29 14:58:13,509 [trainer.py] => TIP_init: zero
2024-12-29 14:58:13,509 [trainer.py] => tuned_epoch: 20
2024-12-29 14:58:13,509 [trainer.py] => fs_epoch: 0
2024-12-29 14:58:13,509 [trainer.py] => init_lr: 0.01
2024-12-29 14:58:13,509 [trainer.py] => fs_lr: 0.001
2024-12-29 14:58:13,509 [trainer.py] => batch_size: 48
2024-12-29 14:58:13,509 [trainer.py] => fs_batch_size: 16
2024-12-29 14:58:13,509 [trainer.py] => weight_decay: 0.0005
2024-12-29 14:58:13,509 [trainer.py] => min_lr: 0
2024-12-29 14:58:13,509 [trainer.py] => optimizer: sgd
2024-12-29 14:58:13,509 [trainer.py] => memory_size: 0
2024-12-29 14:58:13,509 [trainer.py] => memory_per_class: 0
2024-12-29 14:58:13,509 [trainer.py] => fixed_memory: False
2024-12-29 14:58:13,509 [trainer.py] => shuffle: False
2024-12-29 14:58:13,509 [trainer.py] => top_k: 5
2024-12-29 14:58:13,509 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 14:58:13,509 [trainer.py] => prefix: asp
2024-12-29 14:58:13,509 [trainer.py] => model_prefix: asp
2024-12-29 14:58:15,013 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 14:58:21,627 [trainer.py] => All params: 173596160
2024-12-29 14:58:21,628 [trainer.py] => Trainable params: 1998848
2024-12-29 14:58:22,135 [asp.py] => Learning on 0-60
2024-12-29 14:58:22,229 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 14:58:22,324 [asp.py] => total parameters: 173642241
2024-12-29 14:58:22,325 [asp.py] => trainable parameters: 2044929
2024-12-29 14:58:22,326 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 15:03:18,656 [trainer.py] => Top1 curve: [91.82]
2024-12-29 15:03:18,656 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-29 15:03:18,657 [trainer.py] => All params: 173642241
2024-12-29 15:03:18,658 [trainer.py] => Trainable params: 2044929
2024-12-29 15:03:18,659 [asp.py] => Learning on 60-65
2024-12-29 15:03:18,672 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:03:18,675 [asp.py] => total parameters: 173646081
2024-12-29 15:03:18,676 [asp.py] => trainable parameters: 2048769
2024-12-29 15:04:54,395 [trainer.py] => config: ./exps/cifar.json
2024-12-29 15:04:54,395 [trainer.py] => model_name: asp
2024-12-29 15:04:54,395 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 15:04:54,395 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 15:04:54,395 [trainer.py] => seed: 2024
2024-12-29 15:04:54,395 [trainer.py] => dataset: cifar224
2024-12-29 15:04:54,395 [trainer.py] => init_cls: 60
2024-12-29 15:04:54,395 [trainer.py] => increment: 5
2024-12-29 15:04:54,395 [trainer.py] => kshot: 5
2024-12-29 15:04:54,395 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 15:04:54,395 [trainer.py] => z_dim: 1000
2024-12-29 15:04:54,395 [trainer.py] => conv_dim: 64
2024-12-29 15:04:54,395 [trainer.py] => img_size: 224
2024-12-29 15:04:54,395 [trainer.py] => generator_lr: 0.001
2024-12-29 15:04:54,395 [trainer.py] => pi: 100
2024-12-29 15:04:54,395 [trainer.py] => w_bn: 50.0
2024-12-29 15:04:54,395 [trainer.py] => w_noise: 0.001
2024-12-29 15:04:54,395 [trainer.py] => server_ss: 32
2024-12-29 15:04:54,395 [trainer.py] => bn_loss: 1
2024-12-29 15:04:54,395 [trainer.py] => noise: 1
2024-12-29 15:04:54,395 [trainer.py] => ie_loss: 1
2024-12-29 15:04:54,395 [trainer.py] => act_loss: 0
2024-12-29 15:04:54,395 [trainer.py] => w_ie: 1.0
2024-12-29 15:04:54,396 [trainer.py] => w_act: 0.1
2024-12-29 15:04:54,396 [trainer.py] => syn_size: 224
2024-12-29 15:04:54,396 [trainer.py] => vpt_type: Deep
2024-12-29 15:04:54,396 [trainer.py] => prompt_token_num: 6
2024-12-29 15:04:54,396 [trainer.py] => avg_alpha: 0.8
2024-12-29 15:04:54,396 [trainer.py] => perturb_var: 1
2024-12-29 15:04:54,396 [trainer.py] => EMA_beta: 0.99
2024-12-29 15:04:54,396 [trainer.py] => anchor_lambda: 0.1
2024-12-29 15:04:54,396 [trainer.py] => kl_weight: 0.001
2024-12-29 15:04:54,396 [trainer.py] => TIP_init: zero
2024-12-29 15:04:54,396 [trainer.py] => tuned_epoch: 20
2024-12-29 15:04:54,396 [trainer.py] => fs_epoch: 0
2024-12-29 15:04:54,396 [trainer.py] => init_lr: 0.01
2024-12-29 15:04:54,396 [trainer.py] => fs_lr: 0.001
2024-12-29 15:04:54,396 [trainer.py] => batch_size: 48
2024-12-29 15:04:54,396 [trainer.py] => fs_batch_size: 16
2024-12-29 15:04:54,396 [trainer.py] => weight_decay: 0.0005
2024-12-29 15:04:54,396 [trainer.py] => min_lr: 0
2024-12-29 15:04:54,396 [trainer.py] => optimizer: sgd
2024-12-29 15:04:54,396 [trainer.py] => memory_size: 0
2024-12-29 15:04:54,396 [trainer.py] => memory_per_class: 0
2024-12-29 15:04:54,396 [trainer.py] => fixed_memory: False
2024-12-29 15:04:54,396 [trainer.py] => shuffle: False
2024-12-29 15:04:54,396 [trainer.py] => top_k: 5
2024-12-29 15:04:54,396 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 15:04:54,396 [trainer.py] => prefix: asp
2024-12-29 15:04:54,396 [trainer.py] => model_prefix: asp
2024-12-29 15:04:55,885 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 15:05:01,984 [trainer.py] => All params: 173596160
2024-12-29 15:05:01,985 [trainer.py] => Trainable params: 1998848
2024-12-29 15:05:02,467 [asp.py] => Learning on 0-60
2024-12-29 15:05:02,543 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 15:05:02,626 [asp.py] => total parameters: 173642241
2024-12-29 15:05:02,627 [asp.py] => trainable parameters: 2044929
2024-12-29 15:05:02,628 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 15:10:01,999 [trainer.py] => Top1 curve: [91.82]
2024-12-29 15:10:02,000 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-29 15:10:02,001 [trainer.py] => All params: 173642241
2024-12-29 15:10:02,001 [trainer.py] => Trainable params: 2044929
2024-12-29 15:10:02,002 [asp.py] => Learning on 60-65
2024-12-29 15:10:02,022 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:10:02,024 [asp.py] => total parameters: 173646081
2024-12-29 15:10:02,025 [asp.py] => trainable parameters: 2048769
2024-12-29 15:11:16,774 [trainer.py] => Top1 curve: [91.82, 90.09]
2024-12-29 15:11:16,775 [trainer.py] => Average Accuracy (Top1): 90.955   (Harmonic Accuracy): 81.21629014284267 (Old Acc): 91.51666666666667 (New Acc): 73.0 

2024-12-29 15:11:16,776 [trainer.py] => All params: 173646081
2024-12-29 15:11:16,776 [trainer.py] => Trainable params: 2048769
2024-12-29 15:11:16,777 [asp.py] => Learning on 65-70
2024-12-29 15:11:16,787 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:11:16,790 [asp.py] => total parameters: 173649921
2024-12-29 15:11:16,790 [asp.py] => trainable parameters: 2052609
2024-12-29 15:12:34,482 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5]
2024-12-29 15:12:34,482 [trainer.py] => Average Accuracy (Top1): 90.46999999999998   (Harmonic Accuracy): 84.12586614173229 (Old Acc): 91.43333333333334 (New Acc): 77.9 

2024-12-29 15:12:34,483 [trainer.py] => All params: 173649921
2024-12-29 15:12:34,484 [trainer.py] => Trainable params: 2052609
2024-12-29 15:12:34,485 [asp.py] => Learning on 70-75
2024-12-29 15:12:34,504 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:12:34,507 [asp.py] => total parameters: 173653761
2024-12-29 15:12:34,508 [asp.py] => trainable parameters: 2056449
2024-12-29 15:13:54,739 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29]
2024-12-29 15:13:54,739 [trainer.py] => Average Accuracy (Top1): 89.925   (Harmonic Accuracy): 83.33658891645989 (Old Acc): 91.18333333333334 (New Acc): 76.73333333333333 

2024-12-29 15:13:54,740 [trainer.py] => All params: 173653761
2024-12-29 15:13:54,741 [trainer.py] => Trainable params: 2056449
2024-12-29 15:13:54,742 [asp.py] => Learning on 75-80
2024-12-29 15:13:54,765 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:13:54,768 [asp.py] => total parameters: 173657601
2024-12-29 15:13:54,769 [asp.py] => trainable parameters: 2060289
2024-12-29 15:14:35,667 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32]
2024-12-29 15:14:35,667 [trainer.py] => Average Accuracy (Top1): 89.604   (Harmonic Accuracy): 85.14776846618592 (Old Acc): 91.13333333333334 (New Acc): 79.9 

2024-12-29 15:14:35,668 [trainer.py] => All params: 173657601
2024-12-29 15:14:35,669 [trainer.py] => Trainable params: 2060289
2024-12-29 15:14:35,670 [asp.py] => Learning on 80-85
2024-12-29 15:14:35,685 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:14:35,688 [asp.py] => total parameters: 173661441
2024-12-29 15:14:35,689 [asp.py] => trainable parameters: 2064129
2024-12-29 15:15:53,668 [trainer.py] => config: ./exps/cifar.json
2024-12-29 15:15:53,668 [trainer.py] => model_name: asp
2024-12-29 15:15:53,668 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 15:15:53,669 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 15:15:53,669 [trainer.py] => seed: 2024
2024-12-29 15:15:53,669 [trainer.py] => dataset: cifar224
2024-12-29 15:15:53,669 [trainer.py] => init_cls: 60
2024-12-29 15:15:53,669 [trainer.py] => increment: 5
2024-12-29 15:15:53,669 [trainer.py] => kshot: 5
2024-12-29 15:15:53,669 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 15:15:53,669 [trainer.py] => z_dim: 1000
2024-12-29 15:15:53,669 [trainer.py] => conv_dim: 64
2024-12-29 15:15:53,669 [trainer.py] => img_size: 224
2024-12-29 15:15:53,669 [trainer.py] => generator_lr: 0.001
2024-12-29 15:15:53,669 [trainer.py] => pi: 100
2024-12-29 15:15:53,669 [trainer.py] => w_bn: 50.0
2024-12-29 15:15:53,669 [trainer.py] => w_noise: 0.001
2024-12-29 15:15:53,669 [trainer.py] => server_ss: 32
2024-12-29 15:15:53,669 [trainer.py] => bn_loss: 1
2024-12-29 15:15:53,669 [trainer.py] => noise: 1
2024-12-29 15:15:53,669 [trainer.py] => ie_loss: 1
2024-12-29 15:15:53,669 [trainer.py] => act_loss: 0
2024-12-29 15:15:53,669 [trainer.py] => w_ie: 1.0
2024-12-29 15:15:53,669 [trainer.py] => w_act: 0.1
2024-12-29 15:15:53,669 [trainer.py] => syn_size: 224
2024-12-29 15:15:53,669 [trainer.py] => vpt_type: Deep
2024-12-29 15:15:53,669 [trainer.py] => prompt_token_num: 6
2024-12-29 15:15:53,669 [trainer.py] => avg_alpha: 0.8
2024-12-29 15:15:53,669 [trainer.py] => perturb_var: 1
2024-12-29 15:15:53,670 [trainer.py] => EMA_beta: 0.99
2024-12-29 15:15:53,670 [trainer.py] => anchor_lambda: 0.1
2024-12-29 15:15:53,670 [trainer.py] => kl_weight: 0.001
2024-12-29 15:15:53,670 [trainer.py] => TIP_init: zero
2024-12-29 15:15:53,670 [trainer.py] => tuned_epoch: 20
2024-12-29 15:15:53,670 [trainer.py] => fs_epoch: 0
2024-12-29 15:15:53,670 [trainer.py] => init_lr: 0.01
2024-12-29 15:15:53,670 [trainer.py] => fs_lr: 0.001
2024-12-29 15:15:53,670 [trainer.py] => batch_size: 48
2024-12-29 15:15:53,670 [trainer.py] => fs_batch_size: 16
2024-12-29 15:15:53,670 [trainer.py] => weight_decay: 0.0005
2024-12-29 15:15:53,670 [trainer.py] => min_lr: 0
2024-12-29 15:15:53,670 [trainer.py] => optimizer: sgd
2024-12-29 15:15:53,670 [trainer.py] => memory_size: 0
2024-12-29 15:15:53,670 [trainer.py] => memory_per_class: 0
2024-12-29 15:15:53,670 [trainer.py] => fixed_memory: False
2024-12-29 15:15:53,670 [trainer.py] => shuffle: False
2024-12-29 15:15:53,670 [trainer.py] => top_k: 5
2024-12-29 15:15:53,670 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 15:15:53,670 [trainer.py] => prefix: asp
2024-12-29 15:15:53,670 [trainer.py] => model_prefix: asp
2024-12-29 15:15:55,183 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 15:16:00,555 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32, 87.48]
2024-12-29 15:16:00,556 [trainer.py] => Average Accuracy (Top1): 89.25   (Harmonic Accuracy): 84.56792815404528 (Old Acc): 91.03333333333335 (New Acc): 78.96000000000001 

2024-12-29 15:16:00,557 [trainer.py] => All params: 173661441
2024-12-29 15:16:00,557 [trainer.py] => Trainable params: 2064129
2024-12-29 15:16:00,559 [asp.py] => Learning on 85-90
2024-12-29 15:16:00,592 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:16:00,595 [asp.py] => total parameters: 173665281
2024-12-29 15:16:00,596 [asp.py] => trainable parameters: 2067969
2024-12-29 15:16:01,963 [trainer.py] => All params: 173596160
2024-12-29 15:16:01,964 [trainer.py] => Trainable params: 1998848
2024-12-29 15:16:27,143 [trainer.py] => config: ./exps/cifar.json
2024-12-29 15:16:27,144 [trainer.py] => model_name: asp
2024-12-29 15:16:27,144 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 15:16:27,144 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 15:16:27,144 [trainer.py] => seed: 2024
2024-12-29 15:16:27,144 [trainer.py] => dataset: cifar224
2024-12-29 15:16:27,144 [trainer.py] => init_cls: 60
2024-12-29 15:16:27,144 [trainer.py] => increment: 5
2024-12-29 15:16:27,144 [trainer.py] => kshot: 5
2024-12-29 15:16:27,144 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 15:16:27,144 [trainer.py] => z_dim: 1000
2024-12-29 15:16:27,144 [trainer.py] => conv_dim: 64
2024-12-29 15:16:27,144 [trainer.py] => img_size: 224
2024-12-29 15:16:27,144 [trainer.py] => generator_lr: 0.001
2024-12-29 15:16:27,144 [trainer.py] => pi: 100
2024-12-29 15:16:27,145 [trainer.py] => w_bn: 50.0
2024-12-29 15:16:27,145 [trainer.py] => w_noise: 0.001
2024-12-29 15:16:27,145 [trainer.py] => server_ss: 32
2024-12-29 15:16:27,145 [trainer.py] => bn_loss: 1
2024-12-29 15:16:27,145 [trainer.py] => noise: 1
2024-12-29 15:16:27,145 [trainer.py] => ie_loss: 1
2024-12-29 15:16:27,145 [trainer.py] => act_loss: 0
2024-12-29 15:16:27,145 [trainer.py] => w_ie: 1.0
2024-12-29 15:16:27,145 [trainer.py] => w_act: 0.1
2024-12-29 15:16:27,145 [trainer.py] => syn_size: 224
2024-12-29 15:16:27,145 [trainer.py] => vpt_type: Deep
2024-12-29 15:16:27,145 [trainer.py] => prompt_token_num: 6
2024-12-29 15:16:27,145 [trainer.py] => avg_alpha: 0.8
2024-12-29 15:16:27,145 [trainer.py] => perturb_var: 1
2024-12-29 15:16:27,145 [trainer.py] => EMA_beta: 0.99
2024-12-29 15:16:27,145 [trainer.py] => anchor_lambda: 0.1
2024-12-29 15:16:27,145 [trainer.py] => kl_weight: 0.001
2024-12-29 15:16:27,145 [trainer.py] => TIP_init: zero
2024-12-29 15:16:27,145 [trainer.py] => tuned_epoch: 20
2024-12-29 15:16:27,145 [trainer.py] => fs_epoch: 0
2024-12-29 15:16:27,145 [trainer.py] => init_lr: 0.01
2024-12-29 15:16:27,145 [trainer.py] => fs_lr: 0.001
2024-12-29 15:16:27,145 [trainer.py] => batch_size: 48
2024-12-29 15:16:27,145 [trainer.py] => fs_batch_size: 16
2024-12-29 15:16:27,145 [trainer.py] => weight_decay: 0.0005
2024-12-29 15:16:27,145 [trainer.py] => min_lr: 0
2024-12-29 15:16:27,145 [trainer.py] => optimizer: sgd
2024-12-29 15:16:27,145 [trainer.py] => memory_size: 0
2024-12-29 15:16:27,145 [trainer.py] => memory_per_class: 0
2024-12-29 15:16:27,145 [trainer.py] => fixed_memory: False
2024-12-29 15:16:27,145 [trainer.py] => shuffle: False
2024-12-29 15:16:27,145 [trainer.py] => top_k: 5
2024-12-29 15:16:27,146 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 15:16:27,146 [trainer.py] => prefix: asp
2024-12-29 15:16:27,146 [trainer.py] => model_prefix: asp
2024-12-29 15:16:28,649 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 15:16:35,463 [trainer.py] => All params: 173596160
2024-12-29 15:16:35,464 [trainer.py] => Trainable params: 1998848
2024-12-29 15:16:35,988 [asp.py] => Learning on 0-60
2024-12-29 15:16:36,114 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 15:16:36,206 [asp.py] => total parameters: 173642241
2024-12-29 15:16:36,207 [asp.py] => trainable parameters: 2044929
2024-12-29 15:16:36,207 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 15:21:36,909 [trainer.py] => Top1 curve: [91.82]
2024-12-29 15:21:36,909 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-29 15:21:36,910 [trainer.py] => All params: 173642241
2024-12-29 15:21:36,911 [trainer.py] => Trainable params: 2044929
2024-12-29 15:21:36,912 [asp.py] => Learning on 60-65
2024-12-29 15:21:36,923 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:21:36,927 [asp.py] => total parameters: 173646081
2024-12-29 15:21:36,927 [asp.py] => trainable parameters: 2048769
2024-12-29 15:22:33,786 [trainer.py] => config: ./exps/cifar.json
2024-12-29 15:22:33,786 [trainer.py] => model_name: asp
2024-12-29 15:22:33,787 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 15:22:33,787 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 15:22:33,787 [trainer.py] => seed: 2024
2024-12-29 15:22:33,787 [trainer.py] => dataset: cifar224
2024-12-29 15:22:33,787 [trainer.py] => init_cls: 60
2024-12-29 15:22:33,787 [trainer.py] => increment: 5
2024-12-29 15:22:33,787 [trainer.py] => kshot: 5
2024-12-29 15:22:33,787 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 15:22:33,787 [trainer.py] => z_dim: 1000
2024-12-29 15:22:33,787 [trainer.py] => conv_dim: 64
2024-12-29 15:22:33,787 [trainer.py] => img_size: 224
2024-12-29 15:22:33,787 [trainer.py] => generator_lr: 0.001
2024-12-29 15:22:33,787 [trainer.py] => pi: 100
2024-12-29 15:22:33,787 [trainer.py] => w_bn: 50.0
2024-12-29 15:22:33,787 [trainer.py] => w_noise: 0.001
2024-12-29 15:22:33,787 [trainer.py] => server_ss: 32
2024-12-29 15:22:33,787 [trainer.py] => bn_loss: 1
2024-12-29 15:22:33,787 [trainer.py] => noise: 1
2024-12-29 15:22:33,787 [trainer.py] => ie_loss: 1
2024-12-29 15:22:33,787 [trainer.py] => act_loss: 0
2024-12-29 15:22:33,787 [trainer.py] => w_ie: 1.0
2024-12-29 15:22:33,787 [trainer.py] => w_act: 0.1
2024-12-29 15:22:33,787 [trainer.py] => syn_size: 224
2024-12-29 15:22:33,787 [trainer.py] => vpt_type: Deep
2024-12-29 15:22:33,787 [trainer.py] => prompt_token_num: 6
2024-12-29 15:22:33,787 [trainer.py] => avg_alpha: 0.8
2024-12-29 15:22:33,787 [trainer.py] => perturb_var: 1
2024-12-29 15:22:33,787 [trainer.py] => EMA_beta: 0.99
2024-12-29 15:22:33,787 [trainer.py] => anchor_lambda: 0.1
2024-12-29 15:22:33,787 [trainer.py] => kl_weight: 0.001
2024-12-29 15:22:33,787 [trainer.py] => TIP_init: zero
2024-12-29 15:22:33,788 [trainer.py] => tuned_epoch: 20
2024-12-29 15:22:33,788 [trainer.py] => fs_epoch: 0
2024-12-29 15:22:33,788 [trainer.py] => init_lr: 0.01
2024-12-29 15:22:33,788 [trainer.py] => fs_lr: 0.001
2024-12-29 15:22:33,788 [trainer.py] => batch_size: 48
2024-12-29 15:22:33,788 [trainer.py] => fs_batch_size: 16
2024-12-29 15:22:33,788 [trainer.py] => weight_decay: 0.0005
2024-12-29 15:22:33,788 [trainer.py] => min_lr: 0
2024-12-29 15:22:33,788 [trainer.py] => optimizer: sgd
2024-12-29 15:22:33,788 [trainer.py] => memory_size: 0
2024-12-29 15:22:33,788 [trainer.py] => memory_per_class: 0
2024-12-29 15:22:33,788 [trainer.py] => fixed_memory: False
2024-12-29 15:22:33,788 [trainer.py] => shuffle: False
2024-12-29 15:22:33,788 [trainer.py] => top_k: 5
2024-12-29 15:22:33,788 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 15:22:33,788 [trainer.py] => prefix: asp
2024-12-29 15:22:33,788 [trainer.py] => model_prefix: asp
2024-12-29 15:22:35,279 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 15:22:41,515 [trainer.py] => All params: 173596160
2024-12-29 15:22:41,517 [trainer.py] => Trainable params: 1998848
2024-12-29 15:22:42,011 [asp.py] => Learning on 0-60
2024-12-29 15:22:42,125 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 15:22:42,217 [asp.py] => total parameters: 173642241
2024-12-29 15:22:42,217 [asp.py] => trainable parameters: 2044929
2024-12-29 15:22:42,218 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 15:34:20,656 [trainer.py] => config: ./exps/cifar.json
2024-12-29 15:34:20,656 [trainer.py] => model_name: asp
2024-12-29 15:34:20,656 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 15:34:20,656 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 15:34:20,656 [trainer.py] => seed: 2024
2024-12-29 15:34:20,656 [trainer.py] => dataset: cifar224
2024-12-29 15:34:20,656 [trainer.py] => init_cls: 60
2024-12-29 15:34:20,656 [trainer.py] => increment: 5
2024-12-29 15:34:20,656 [trainer.py] => kshot: 5
2024-12-29 15:34:20,656 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 15:34:20,656 [trainer.py] => z_dim: 1000
2024-12-29 15:34:20,656 [trainer.py] => conv_dim: 64
2024-12-29 15:34:20,656 [trainer.py] => img_size: 224
2024-12-29 15:34:20,657 [trainer.py] => generator_lr: 0.001
2024-12-29 15:34:20,657 [trainer.py] => pi: 100
2024-12-29 15:34:20,657 [trainer.py] => w_bn: 50.0
2024-12-29 15:34:20,657 [trainer.py] => w_noise: 0.001
2024-12-29 15:34:20,657 [trainer.py] => server_ss: 32
2024-12-29 15:34:20,657 [trainer.py] => bn_loss: 1
2024-12-29 15:34:20,657 [trainer.py] => noise: 1
2024-12-29 15:34:20,657 [trainer.py] => ie_loss: 1
2024-12-29 15:34:20,657 [trainer.py] => act_loss: 0
2024-12-29 15:34:20,657 [trainer.py] => w_ie: 1.0
2024-12-29 15:34:20,657 [trainer.py] => w_act: 0.1
2024-12-29 15:34:20,657 [trainer.py] => syn_size: 224
2024-12-29 15:34:20,657 [trainer.py] => vpt_type: Deep
2024-12-29 15:34:20,657 [trainer.py] => prompt_token_num: 6
2024-12-29 15:34:20,657 [trainer.py] => avg_alpha: 0.8
2024-12-29 15:34:20,657 [trainer.py] => perturb_var: 1
2024-12-29 15:34:20,657 [trainer.py] => EMA_beta: 0.99
2024-12-29 15:34:20,657 [trainer.py] => anchor_lambda: 0.1
2024-12-29 15:34:20,657 [trainer.py] => kl_weight: 0.001
2024-12-29 15:34:20,657 [trainer.py] => TIP_init: zero
2024-12-29 15:34:20,657 [trainer.py] => tuned_epoch: 20
2024-12-29 15:34:20,657 [trainer.py] => fs_epoch: 0
2024-12-29 15:34:20,657 [trainer.py] => init_lr: 0.01
2024-12-29 15:34:20,657 [trainer.py] => fs_lr: 0.001
2024-12-29 15:34:20,657 [trainer.py] => batch_size: 48
2024-12-29 15:34:20,657 [trainer.py] => fs_batch_size: 16
2024-12-29 15:34:20,657 [trainer.py] => weight_decay: 0.0005
2024-12-29 15:34:20,657 [trainer.py] => min_lr: 0
2024-12-29 15:34:20,657 [trainer.py] => optimizer: sgd
2024-12-29 15:34:20,657 [trainer.py] => memory_size: 0
2024-12-29 15:34:20,657 [trainer.py] => memory_per_class: 0
2024-12-29 15:34:20,657 [trainer.py] => fixed_memory: False
2024-12-29 15:34:20,658 [trainer.py] => shuffle: False
2024-12-29 15:34:20,658 [trainer.py] => top_k: 5
2024-12-29 15:34:20,658 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 15:34:20,658 [trainer.py] => prefix: asp
2024-12-29 15:34:20,658 [trainer.py] => model_prefix: asp
2024-12-29 15:34:22,176 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 15:34:28,744 [trainer.py] => All params: 173596160
2024-12-29 15:34:28,745 [trainer.py] => Trainable params: 1998848
2024-12-29 15:34:29,088 [asp.py] => Learning on 0-60
2024-12-29 15:34:29,191 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 15:34:29,355 [asp.py] => total parameters: 173642241
2024-12-29 15:34:29,356 [asp.py] => trainable parameters: 2044929
2024-12-29 15:34:29,357 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 15:40:18,428 [trainer.py] => Top1 curve: [91.82]
2024-12-29 15:40:18,428 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-29 15:40:18,429 [trainer.py] => All params: 173642241
2024-12-29 15:40:18,430 [trainer.py] => Trainable params: 2044929
2024-12-29 15:40:18,431 [asp.py] => Learning on 60-65
2024-12-29 15:40:18,443 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:40:18,446 [asp.py] => total parameters: 173646081
2024-12-29 15:40:18,446 [asp.py] => trainable parameters: 2048769
2024-12-29 15:41:53,163 [trainer.py] => Top1 curve: [91.82, 90.09]
2024-12-29 15:41:53,164 [trainer.py] => Average Accuracy (Top1): 90.955   (Harmonic Accuracy): 81.21629014284267 (Old Acc): 91.51666666666667 (New Acc): 73.0 

2024-12-29 15:41:53,165 [trainer.py] => All params: 173646081
2024-12-29 15:41:53,166 [trainer.py] => Trainable params: 2048769
2024-12-29 15:41:53,168 [asp.py] => Learning on 65-70
2024-12-29 15:41:53,181 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:41:53,185 [asp.py] => total parameters: 173649921
2024-12-29 15:41:53,186 [asp.py] => trainable parameters: 2052609
2024-12-29 15:45:12,675 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5]
2024-12-29 15:45:12,676 [trainer.py] => Average Accuracy (Top1): 90.46999999999998   (Harmonic Accuracy): 84.12586614173229 (Old Acc): 91.43333333333334 (New Acc): 77.9 

2024-12-29 15:45:12,677 [trainer.py] => All params: 173649921
2024-12-29 15:45:12,677 [trainer.py] => Trainable params: 2052609
2024-12-29 15:45:12,678 [asp.py] => Learning on 70-75
2024-12-29 15:45:12,690 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:45:12,693 [asp.py] => total parameters: 173653761
2024-12-29 15:45:12,693 [asp.py] => trainable parameters: 2056449
2024-12-29 15:47:51,833 [trainer.py] => config: ./exps/cifar.json
2024-12-29 15:47:51,834 [trainer.py] => model_name: asp
2024-12-29 15:47:51,834 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 15:47:51,834 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 15:47:51,834 [trainer.py] => seed: 2024
2024-12-29 15:47:51,834 [trainer.py] => dataset: cifar224
2024-12-29 15:47:51,834 [trainer.py] => init_cls: 60
2024-12-29 15:47:51,834 [trainer.py] => increment: 5
2024-12-29 15:47:51,834 [trainer.py] => kshot: 5
2024-12-29 15:47:51,834 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 15:47:51,834 [trainer.py] => z_dim: 1000
2024-12-29 15:47:51,834 [trainer.py] => conv_dim: 64
2024-12-29 15:47:51,834 [trainer.py] => img_size: 224
2024-12-29 15:47:51,834 [trainer.py] => generator_lr: 0.001
2024-12-29 15:47:51,834 [trainer.py] => pi: 100
2024-12-29 15:47:51,834 [trainer.py] => w_bn: 50.0
2024-12-29 15:47:51,834 [trainer.py] => w_noise: 0.001
2024-12-29 15:47:51,834 [trainer.py] => server_ss: 32
2024-12-29 15:47:51,834 [trainer.py] => bn_loss: 1
2024-12-29 15:47:51,834 [trainer.py] => noise: 1
2024-12-29 15:47:51,834 [trainer.py] => ie_loss: 1
2024-12-29 15:47:51,834 [trainer.py] => act_loss: 0
2024-12-29 15:47:51,834 [trainer.py] => w_ie: 1.0
2024-12-29 15:47:51,834 [trainer.py] => w_act: 0.1
2024-12-29 15:47:51,834 [trainer.py] => syn_size: 224
2024-12-29 15:47:51,834 [trainer.py] => vpt_type: Deep
2024-12-29 15:47:51,835 [trainer.py] => prompt_token_num: 6
2024-12-29 15:47:51,835 [trainer.py] => avg_alpha: 0.8
2024-12-29 15:47:51,835 [trainer.py] => perturb_var: 1
2024-12-29 15:47:51,835 [trainer.py] => EMA_beta: 0.99
2024-12-29 15:47:51,835 [trainer.py] => anchor_lambda: 0.1
2024-12-29 15:47:51,835 [trainer.py] => kl_weight: 0.001
2024-12-29 15:47:51,835 [trainer.py] => TIP_init: zero
2024-12-29 15:47:51,835 [trainer.py] => tuned_epoch: 20
2024-12-29 15:47:51,835 [trainer.py] => fs_epoch: 0
2024-12-29 15:47:51,835 [trainer.py] => init_lr: 0.01
2024-12-29 15:47:51,835 [trainer.py] => fs_lr: 0.001
2024-12-29 15:47:51,835 [trainer.py] => batch_size: 48
2024-12-29 15:47:51,835 [trainer.py] => fs_batch_size: 16
2024-12-29 15:47:51,835 [trainer.py] => weight_decay: 0.0005
2024-12-29 15:47:51,835 [trainer.py] => min_lr: 0
2024-12-29 15:47:51,835 [trainer.py] => optimizer: sgd
2024-12-29 15:47:51,835 [trainer.py] => memory_size: 0
2024-12-29 15:47:51,835 [trainer.py] => memory_per_class: 0
2024-12-29 15:47:51,835 [trainer.py] => fixed_memory: False
2024-12-29 15:47:51,835 [trainer.py] => shuffle: False
2024-12-29 15:47:51,835 [trainer.py] => top_k: 5
2024-12-29 15:47:51,835 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 15:47:51,835 [trainer.py] => prefix: asp
2024-12-29 15:47:51,835 [trainer.py] => model_prefix: asp
2024-12-29 15:47:53,324 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 15:47:59,551 [trainer.py] => All params: 173596160
2024-12-29 15:47:59,552 [trainer.py] => Trainable params: 1998848
2024-12-29 15:48:00,042 [asp.py] => Learning on 0-60
2024-12-29 15:48:00,125 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 15:48:43,142 [asp.py] => total parameters: 173642241
2024-12-29 15:48:43,143 [asp.py] => trainable parameters: 2044929
2024-12-29 15:48:43,144 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 15:52:59,355 [trainer.py] => Top1 curve: [91.82]
2024-12-29 15:52:59,355 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-29 15:52:59,357 [trainer.py] => All params: 173642241
2024-12-29 15:52:59,357 [trainer.py] => Trainable params: 2044929
2024-12-29 15:52:59,358 [asp.py] => Learning on 60-65
2024-12-29 15:52:59,380 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:53:40,816 [asp.py] => total parameters: 173646081
2024-12-29 15:53:40,817 [asp.py] => trainable parameters: 2048769
2024-12-29 15:54:19,623 [trainer.py] => Top1 curve: [91.82, 90.09]
2024-12-29 15:54:19,624 [trainer.py] => Average Accuracy (Top1): 90.955   (Harmonic Accuracy): 81.21629014284267 (Old Acc): 91.51666666666667 (New Acc): 73.0 

2024-12-29 15:54:19,625 [trainer.py] => All params: 173646081
2024-12-29 15:54:19,626 [trainer.py] => Trainable params: 2048769
2024-12-29 15:54:19,627 [asp.py] => Learning on 65-70
2024-12-29 15:54:19,639 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:55:02,191 [asp.py] => total parameters: 173649921
2024-12-29 15:55:02,191 [asp.py] => trainable parameters: 2052609
2024-12-29 15:55:39,784 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5]
2024-12-29 15:55:39,784 [trainer.py] => Average Accuracy (Top1): 90.46999999999998   (Harmonic Accuracy): 84.12586614173229 (Old Acc): 91.43333333333334 (New Acc): 77.9 

2024-12-29 15:55:39,785 [trainer.py] => All params: 173649921
2024-12-29 15:55:39,786 [trainer.py] => Trainable params: 2052609
2024-12-29 15:55:39,788 [asp.py] => Learning on 70-75
2024-12-29 15:55:39,798 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 15:56:22,601 [asp.py] => total parameters: 173653761
2024-12-29 15:56:22,601 [asp.py] => trainable parameters: 2056449
2024-12-29 15:57:56,188 [trainer.py] => config: ./exps/cifar.json
2024-12-29 15:57:56,188 [trainer.py] => model_name: asp
2024-12-29 15:57:56,188 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 15:57:56,188 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 15:57:56,188 [trainer.py] => seed: 2024
2024-12-29 15:57:56,188 [trainer.py] => dataset: cifar224
2024-12-29 15:57:56,188 [trainer.py] => init_cls: 60
2024-12-29 15:57:56,188 [trainer.py] => increment: 5
2024-12-29 15:57:56,188 [trainer.py] => kshot: 5
2024-12-29 15:57:56,188 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 15:57:56,188 [trainer.py] => z_dim: 1000
2024-12-29 15:57:56,188 [trainer.py] => conv_dim: 64
2024-12-29 15:57:56,188 [trainer.py] => img_size: 224
2024-12-29 15:57:56,188 [trainer.py] => generator_lr: 0.001
2024-12-29 15:57:56,188 [trainer.py] => pi: 100
2024-12-29 15:57:56,188 [trainer.py] => w_bn: 50.0
2024-12-29 15:57:56,188 [trainer.py] => w_noise: 0.001
2024-12-29 15:57:56,188 [trainer.py] => server_ss: 32
2024-12-29 15:57:56,189 [trainer.py] => bn_loss: 1
2024-12-29 15:57:56,189 [trainer.py] => noise: 1
2024-12-29 15:57:56,189 [trainer.py] => ie_loss: 1
2024-12-29 15:57:56,189 [trainer.py] => act_loss: 0
2024-12-29 15:57:56,189 [trainer.py] => w_ie: 1.0
2024-12-29 15:57:56,189 [trainer.py] => w_act: 0.1
2024-12-29 15:57:56,189 [trainer.py] => syn_size: 224
2024-12-29 15:57:56,189 [trainer.py] => vpt_type: Deep
2024-12-29 15:57:56,189 [trainer.py] => prompt_token_num: 6
2024-12-29 15:57:56,189 [trainer.py] => avg_alpha: 0.8
2024-12-29 15:57:56,189 [trainer.py] => perturb_var: 1
2024-12-29 15:57:56,189 [trainer.py] => EMA_beta: 0.99
2024-12-29 15:57:56,189 [trainer.py] => anchor_lambda: 0.1
2024-12-29 15:57:56,189 [trainer.py] => kl_weight: 0.001
2024-12-29 15:57:56,189 [trainer.py] => TIP_init: zero
2024-12-29 15:57:56,189 [trainer.py] => tuned_epoch: 20
2024-12-29 15:57:56,189 [trainer.py] => fs_epoch: 0
2024-12-29 15:57:56,189 [trainer.py] => init_lr: 0.01
2024-12-29 15:57:56,189 [trainer.py] => fs_lr: 0.001
2024-12-29 15:57:56,189 [trainer.py] => batch_size: 48
2024-12-29 15:57:56,189 [trainer.py] => fs_batch_size: 16
2024-12-29 15:57:56,189 [trainer.py] => weight_decay: 0.0005
2024-12-29 15:57:56,189 [trainer.py] => min_lr: 0
2024-12-29 15:57:56,189 [trainer.py] => optimizer: sgd
2024-12-29 15:57:56,189 [trainer.py] => memory_size: 0
2024-12-29 15:57:56,189 [trainer.py] => memory_per_class: 0
2024-12-29 15:57:56,189 [trainer.py] => fixed_memory: False
2024-12-29 15:57:56,189 [trainer.py] => shuffle: False
2024-12-29 15:57:56,189 [trainer.py] => top_k: 5
2024-12-29 15:57:56,189 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 15:57:56,189 [trainer.py] => prefix: asp
2024-12-29 15:57:56,189 [trainer.py] => model_prefix: asp
2024-12-29 15:57:57,688 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 15:58:04,006 [trainer.py] => All params: 173596160
2024-12-29 15:58:04,007 [trainer.py] => Trainable params: 1998848
2024-12-29 15:58:04,490 [asp.py] => Learning on 0-60
2024-12-29 15:58:04,622 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 15:58:48,212 [asp.py] => total parameters: 173642241
2024-12-29 15:58:48,213 [asp.py] => trainable parameters: 2044929
2024-12-29 15:58:48,214 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 16:03:05,559 [trainer.py] => Top1 curve: [91.82]
2024-12-29 16:03:05,559 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-29 16:03:05,560 [trainer.py] => All params: 173642241
2024-12-29 16:03:05,561 [trainer.py] => Trainable params: 2044929
2024-12-29 16:03:05,562 [asp.py] => Learning on 60-65
2024-12-29 16:03:05,577 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 16:03:46,908 [asp.py] => total parameters: 173646081
2024-12-29 16:03:46,909 [asp.py] => trainable parameters: 2048769
2024-12-29 16:04:20,089 [trainer.py] => Top1 curve: [91.82, 90.09]
2024-12-29 16:04:20,089 [trainer.py] => Average Accuracy (Top1): 90.955   (Harmonic Accuracy): 81.21629014284267 (Old Acc): 91.51666666666667 (New Acc): 73.0 

2024-12-29 16:04:20,090 [trainer.py] => All params: 173646081
2024-12-29 16:04:20,091 [trainer.py] => Trainable params: 2048769
2024-12-29 16:04:20,092 [asp.py] => Learning on 65-70
2024-12-29 16:04:20,104 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 16:05:02,754 [asp.py] => total parameters: 173649921
2024-12-29 16:05:02,755 [asp.py] => trainable parameters: 2052609
2024-12-29 16:05:37,816 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5]
2024-12-29 16:05:37,816 [trainer.py] => Average Accuracy (Top1): 90.46999999999998   (Harmonic Accuracy): 84.12586614173229 (Old Acc): 91.43333333333334 (New Acc): 77.9 

2024-12-29 16:05:37,817 [trainer.py] => All params: 173649921
2024-12-29 16:05:37,818 [trainer.py] => Trainable params: 2052609
2024-12-29 16:05:37,819 [asp.py] => Learning on 70-75
2024-12-29 16:05:37,832 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 16:06:20,977 [asp.py] => total parameters: 173653761
2024-12-29 16:06:20,978 [asp.py] => trainable parameters: 2056449
2024-12-29 16:06:58,059 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29]
2024-12-29 16:06:58,059 [trainer.py] => Average Accuracy (Top1): 89.925   (Harmonic Accuracy): 83.33658891645989 (Old Acc): 91.18333333333334 (New Acc): 76.73333333333333 

2024-12-29 16:06:58,060 [trainer.py] => All params: 173653761
2024-12-29 16:06:58,061 [trainer.py] => Trainable params: 2056449
2024-12-29 16:06:58,062 [asp.py] => Learning on 75-80
2024-12-29 16:06:58,077 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 16:07:41,423 [asp.py] => total parameters: 173657601
2024-12-29 16:07:41,424 [asp.py] => trainable parameters: 2060289
2024-12-29 16:08:20,916 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32]
2024-12-29 16:08:20,917 [trainer.py] => Average Accuracy (Top1): 89.604   (Harmonic Accuracy): 85.14776846618592 (Old Acc): 91.13333333333334 (New Acc): 79.9 

2024-12-29 16:08:20,918 [trainer.py] => All params: 173657601
2024-12-29 16:08:20,918 [trainer.py] => Trainable params: 2060289
2024-12-29 16:08:20,919 [asp.py] => Learning on 80-85
2024-12-29 16:08:20,933 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 16:09:00,718 [trainer.py] => config: ./exps/cifar.json
2024-12-29 16:09:00,718 [trainer.py] => model_name: asp
2024-12-29 16:09:00,718 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 16:09:00,718 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 16:09:00,718 [trainer.py] => seed: 2024
2024-12-29 16:09:00,718 [trainer.py] => dataset: cifar224
2024-12-29 16:09:00,718 [trainer.py] => init_cls: 60
2024-12-29 16:09:00,718 [trainer.py] => increment: 5
2024-12-29 16:09:00,718 [trainer.py] => kshot: 5
2024-12-29 16:09:00,718 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 16:09:00,718 [trainer.py] => z_dim: 1000
2024-12-29 16:09:00,718 [trainer.py] => conv_dim: 64
2024-12-29 16:09:00,719 [trainer.py] => img_size: 224
2024-12-29 16:09:00,719 [trainer.py] => generator_lr: 0.001
2024-12-29 16:09:00,719 [trainer.py] => pi: 100
2024-12-29 16:09:00,719 [trainer.py] => w_bn: 50.0
2024-12-29 16:09:00,719 [trainer.py] => w_noise: 0.001
2024-12-29 16:09:00,719 [trainer.py] => server_ss: 32
2024-12-29 16:09:00,719 [trainer.py] => bn_loss: 1
2024-12-29 16:09:00,719 [trainer.py] => noise: 1
2024-12-29 16:09:00,719 [trainer.py] => ie_loss: 1
2024-12-29 16:09:00,719 [trainer.py] => act_loss: 0
2024-12-29 16:09:00,719 [trainer.py] => w_ie: 1.0
2024-12-29 16:09:00,719 [trainer.py] => w_act: 0.1
2024-12-29 16:09:00,719 [trainer.py] => syn_size: 224
2024-12-29 16:09:00,719 [trainer.py] => vpt_type: Deep
2024-12-29 16:09:00,719 [trainer.py] => prompt_token_num: 6
2024-12-29 16:09:00,719 [trainer.py] => avg_alpha: 0.8
2024-12-29 16:09:00,719 [trainer.py] => perturb_var: 1
2024-12-29 16:09:00,719 [trainer.py] => EMA_beta: 0.99
2024-12-29 16:09:00,719 [trainer.py] => anchor_lambda: 0.1
2024-12-29 16:09:00,719 [trainer.py] => kl_weight: 0.001
2024-12-29 16:09:00,719 [trainer.py] => TIP_init: zero
2024-12-29 16:09:00,719 [trainer.py] => tuned_epoch: 20
2024-12-29 16:09:00,719 [trainer.py] => fs_epoch: 0
2024-12-29 16:09:00,719 [trainer.py] => init_lr: 0.01
2024-12-29 16:09:00,719 [trainer.py] => fs_lr: 0.001
2024-12-29 16:09:00,719 [trainer.py] => batch_size: 48
2024-12-29 16:09:00,719 [trainer.py] => fs_batch_size: 16
2024-12-29 16:09:00,719 [trainer.py] => weight_decay: 0.0005
2024-12-29 16:09:00,719 [trainer.py] => min_lr: 0
2024-12-29 16:09:00,719 [trainer.py] => optimizer: sgd
2024-12-29 16:09:00,719 [trainer.py] => memory_size: 0
2024-12-29 16:09:00,720 [trainer.py] => memory_per_class: 0
2024-12-29 16:09:00,720 [trainer.py] => fixed_memory: False
2024-12-29 16:09:00,720 [trainer.py] => shuffle: False
2024-12-29 16:09:00,720 [trainer.py] => top_k: 5
2024-12-29 16:09:00,720 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 16:09:00,720 [trainer.py] => prefix: asp
2024-12-29 16:09:00,720 [trainer.py] => model_prefix: asp
2024-12-29 16:09:02,206 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 16:09:08,439 [trainer.py] => All params: 173596160
2024-12-29 16:09:08,440 [trainer.py] => Trainable params: 1998848
2024-12-29 16:09:08,935 [asp.py] => Learning on 0-60
2024-12-29 16:09:09,022 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 16:09:54,234 [asp.py] => total parameters: 173642241
2024-12-29 16:09:54,235 [asp.py] => trainable parameters: 2044929
2024-12-29 16:09:54,236 [asp.py] => ================= load base model from: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth =================
2024-12-29 16:14:10,804 [trainer.py] => Top1 curve: [91.82]
2024-12-29 16:14:10,804 [trainer.py] => Average Accuracy (Top1): 91.82   (Harmonic Accuracy): None (Old Acc): 91.81666666666666 (New Acc): [] 

2024-12-29 16:14:10,805 [trainer.py] => All params: 173642241
2024-12-29 16:14:10,806 [trainer.py] => Trainable params: 2044929
2024-12-29 16:14:10,807 [asp.py] => Learning on 60-65
2024-12-29 16:14:10,823 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 16:14:52,222 [asp.py] => total parameters: 173646081
2024-12-29 16:14:52,223 [asp.py] => trainable parameters: 2048769
2024-12-29 16:15:25,460 [trainer.py] => Top1 curve: [91.82, 90.09]
2024-12-29 16:15:25,460 [trainer.py] => Average Accuracy (Top1): 90.955   (Harmonic Accuracy): 81.21629014284267 (Old Acc): 91.51666666666667 (New Acc): 73.0 

2024-12-29 16:15:25,461 [trainer.py] => All params: 173646081
2024-12-29 16:15:25,462 [trainer.py] => Trainable params: 2048769
2024-12-29 16:15:25,463 [asp.py] => Learning on 65-70
2024-12-29 16:15:25,483 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 16:16:08,106 [asp.py] => total parameters: 173649921
2024-12-29 16:16:08,107 [asp.py] => trainable parameters: 2052609
2024-12-29 16:16:43,180 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5]
2024-12-29 16:16:43,180 [trainer.py] => Average Accuracy (Top1): 90.46999999999998   (Harmonic Accuracy): 84.12586614173229 (Old Acc): 91.43333333333334 (New Acc): 77.9 

2024-12-29 16:16:43,181 [trainer.py] => All params: 173649921
2024-12-29 16:16:43,182 [trainer.py] => Trainable params: 2052609
2024-12-29 16:16:43,183 [asp.py] => Learning on 70-75
2024-12-29 16:16:43,195 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 16:17:26,374 [asp.py] => total parameters: 173653761
2024-12-29 16:17:26,375 [asp.py] => trainable parameters: 2056449
2024-12-29 16:18:03,041 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29]
2024-12-29 16:18:03,042 [trainer.py] => Average Accuracy (Top1): 89.925   (Harmonic Accuracy): 83.33658891645989 (Old Acc): 91.18333333333334 (New Acc): 76.73333333333333 

2024-12-29 16:18:03,043 [trainer.py] => All params: 173653761
2024-12-29 16:18:03,043 [trainer.py] => Trainable params: 2056449
2024-12-29 16:18:03,044 [asp.py] => Learning on 75-80
2024-12-29 16:18:03,070 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 16:18:46,296 [asp.py] => total parameters: 173657601
2024-12-29 16:18:46,297 [asp.py] => trainable parameters: 2060289
2024-12-29 16:19:25,877 [trainer.py] => Top1 curve: [91.82, 90.09, 89.5, 88.29, 88.32]
2024-12-29 16:19:25,877 [trainer.py] => Average Accuracy (Top1): 89.604   (Harmonic Accuracy): 85.14776846618592 (Old Acc): 91.13333333333334 (New Acc): 79.9 

2024-12-29 16:19:25,878 [trainer.py] => All params: 173657601
2024-12-29 16:19:25,879 [trainer.py] => Trainable params: 2060289
2024-12-29 16:19:25,880 [asp.py] => Learning on 80-85
2024-12-29 16:19:25,896 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-29 16:20:09,710 [trainer.py] => config: ./exps/cifar.json
2024-12-29 16:20:09,710 [trainer.py] => model_name: asp
2024-12-29 16:20:09,710 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 16:20:09,710 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 16:20:09,710 [trainer.py] => seed: 2024
2024-12-29 16:20:09,710 [trainer.py] => dataset: cifar224
2024-12-29 16:20:09,710 [trainer.py] => init_cls: 60
2024-12-29 16:20:09,710 [trainer.py] => increment: 5
2024-12-29 16:20:09,711 [trainer.py] => kshot: 5
2024-12-29 16:20:09,711 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 16:20:09,711 [trainer.py] => z_dim: 1000
2024-12-29 16:20:09,711 [trainer.py] => conv_dim: 64
2024-12-29 16:20:09,711 [trainer.py] => img_size: 224
2024-12-29 16:20:09,711 [trainer.py] => generator_lr: 0.001
2024-12-29 16:20:09,711 [trainer.py] => pi: 100
2024-12-29 16:20:09,711 [trainer.py] => w_bn: 50.0
2024-12-29 16:20:09,711 [trainer.py] => w_noise: 0.001
2024-12-29 16:20:09,711 [trainer.py] => server_ss: 32
2024-12-29 16:20:09,711 [trainer.py] => bn_loss: 1
2024-12-29 16:20:09,711 [trainer.py] => noise: 1
2024-12-29 16:20:09,711 [trainer.py] => ie_loss: 1
2024-12-29 16:20:09,711 [trainer.py] => act_loss: 0
2024-12-29 16:20:09,711 [trainer.py] => w_ie: 1.0
2024-12-29 16:20:09,711 [trainer.py] => w_act: 0.1
2024-12-29 16:20:09,711 [trainer.py] => syn_size: 224
2024-12-29 16:20:09,711 [trainer.py] => vpt_type: Deep
2024-12-29 16:20:09,711 [trainer.py] => prompt_token_num: 6
2024-12-29 16:20:09,711 [trainer.py] => avg_alpha: 0.8
2024-12-29 16:20:09,711 [trainer.py] => perturb_var: 1
2024-12-29 16:20:09,711 [trainer.py] => EMA_beta: 0.99
2024-12-29 16:20:09,711 [trainer.py] => anchor_lambda: 0.1
2024-12-29 16:20:09,711 [trainer.py] => kl_weight: 0.001
2024-12-29 16:20:09,711 [trainer.py] => TIP_init: zero
2024-12-29 16:20:09,711 [trainer.py] => tuned_epoch: 20
2024-12-29 16:20:09,711 [trainer.py] => fs_epoch: 0
2024-12-29 16:20:09,711 [trainer.py] => init_lr: 0.01
2024-12-29 16:20:09,711 [trainer.py] => fs_lr: 0.001
2024-12-29 16:20:09,711 [trainer.py] => batch_size: 48
2024-12-29 16:20:09,711 [trainer.py] => fs_batch_size: 16
2024-12-29 16:20:09,711 [trainer.py] => weight_decay: 0.0005
2024-12-29 16:20:09,712 [trainer.py] => min_lr: 0
2024-12-29 16:20:09,712 [trainer.py] => optimizer: sgd
2024-12-29 16:20:09,712 [trainer.py] => memory_size: 0
2024-12-29 16:20:09,712 [trainer.py] => memory_per_class: 0
2024-12-29 16:20:09,712 [trainer.py] => fixed_memory: False
2024-12-29 16:20:09,712 [trainer.py] => shuffle: False
2024-12-29 16:20:09,712 [trainer.py] => top_k: 5
2024-12-29 16:20:09,712 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 16:20:09,712 [trainer.py] => prefix: asp
2024-12-29 16:20:09,712 [trainer.py] => model_prefix: asp
2024-12-29 16:20:11,191 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 16:20:17,309 [trainer.py] => All params: 173596160
2024-12-29 16:20:17,309 [trainer.py] => Trainable params: 1998848
2024-12-29 16:20:17,794 [asp.py] => Learning on 0-60
2024-12-29 16:20:17,882 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 16:21:03,203 [asp.py] => total parameters: 173642241
2024-12-29 16:21:03,204 [asp.py] => trainable parameters: 2044929
2024-12-29 16:24:40,645 [trainer.py] => config: ./exps/cifar.json
2024-12-29 16:24:40,646 [trainer.py] => model_name: asp
2024-12-29 16:24:40,646 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 16:24:40,646 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 16:24:40,646 [trainer.py] => seed: 2024
2024-12-29 16:24:40,646 [trainer.py] => dataset: cifar224
2024-12-29 16:24:40,646 [trainer.py] => init_cls: 60
2024-12-29 16:24:40,646 [trainer.py] => increment: 5
2024-12-29 16:24:40,646 [trainer.py] => kshot: 5
2024-12-29 16:24:40,646 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 16:24:40,646 [trainer.py] => z_dim: 1000
2024-12-29 16:24:40,646 [trainer.py] => conv_dim: 64
2024-12-29 16:24:40,646 [trainer.py] => img_size: 224
2024-12-29 16:24:40,646 [trainer.py] => generator_lr: 0.001
2024-12-29 16:24:40,646 [trainer.py] => pi: 100
2024-12-29 16:24:40,646 [trainer.py] => w_bn: 50.0
2024-12-29 16:24:40,646 [trainer.py] => w_noise: 0.001
2024-12-29 16:24:40,646 [trainer.py] => server_ss: 32
2024-12-29 16:24:40,646 [trainer.py] => bn_loss: 1
2024-12-29 16:24:40,646 [trainer.py] => noise: 1
2024-12-29 16:24:40,646 [trainer.py] => ie_loss: 1
2024-12-29 16:24:40,646 [trainer.py] => act_loss: 0
2024-12-29 16:24:40,646 [trainer.py] => w_ie: 1.0
2024-12-29 16:24:40,646 [trainer.py] => w_act: 0.1
2024-12-29 16:24:40,646 [trainer.py] => syn_size: 224
2024-12-29 16:24:40,646 [trainer.py] => vpt_type: Deep
2024-12-29 16:24:40,646 [trainer.py] => prompt_token_num: 6
2024-12-29 16:24:40,646 [trainer.py] => avg_alpha: 0.8
2024-12-29 16:24:40,646 [trainer.py] => perturb_var: 1
2024-12-29 16:24:40,647 [trainer.py] => EMA_beta: 0.99
2024-12-29 16:24:40,647 [trainer.py] => anchor_lambda: 0.1
2024-12-29 16:24:40,647 [trainer.py] => kl_weight: 0.001
2024-12-29 16:24:40,647 [trainer.py] => TIP_init: zero
2024-12-29 16:24:40,647 [trainer.py] => tuned_epoch: 20
2024-12-29 16:24:40,647 [trainer.py] => fs_epoch: 0
2024-12-29 16:24:40,647 [trainer.py] => init_lr: 0.01
2024-12-29 16:24:40,647 [trainer.py] => fs_lr: 0.001
2024-12-29 16:24:40,647 [trainer.py] => batch_size: 48
2024-12-29 16:24:40,647 [trainer.py] => fs_batch_size: 16
2024-12-29 16:24:40,647 [trainer.py] => weight_decay: 0.0005
2024-12-29 16:24:40,647 [trainer.py] => min_lr: 0
2024-12-29 16:24:40,647 [trainer.py] => optimizer: sgd
2024-12-29 16:24:40,647 [trainer.py] => memory_size: 0
2024-12-29 16:24:40,647 [trainer.py] => memory_per_class: 0
2024-12-29 16:24:40,647 [trainer.py] => fixed_memory: False
2024-12-29 16:24:40,647 [trainer.py] => shuffle: False
2024-12-29 16:24:40,647 [trainer.py] => top_k: 5
2024-12-29 16:24:40,647 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 16:24:40,647 [trainer.py] => prefix: asp
2024-12-29 16:24:40,647 [trainer.py] => model_prefix: asp
2024-12-29 16:24:42,143 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 16:24:48,163 [trainer.py] => All params: 173596160
2024-12-29 16:24:48,164 [trainer.py] => Trainable params: 1998848
2024-12-29 16:24:48,636 [asp.py] => Learning on 0-60
2024-12-29 16:24:48,714 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 16:25:31,860 [asp.py] => total parameters: 173642241
2024-12-29 16:25:31,861 [asp.py] => trainable parameters: 2044929
2024-12-29 16:26:24,735 [trainer.py] => config: ./exps/cifar.json
2024-12-29 16:26:24,735 [trainer.py] => model_name: asp
2024-12-29 16:26:24,735 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 16:26:24,735 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 16:26:24,735 [trainer.py] => seed: 2024
2024-12-29 16:26:24,735 [trainer.py] => dataset: cifar224
2024-12-29 16:26:24,735 [trainer.py] => init_cls: 60
2024-12-29 16:26:24,735 [trainer.py] => increment: 5
2024-12-29 16:26:24,735 [trainer.py] => kshot: 5
2024-12-29 16:26:24,735 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 16:26:24,736 [trainer.py] => z_dim: 1000
2024-12-29 16:26:24,736 [trainer.py] => conv_dim: 64
2024-12-29 16:26:24,736 [trainer.py] => img_size: 224
2024-12-29 16:26:24,736 [trainer.py] => generator_lr: 0.001
2024-12-29 16:26:24,736 [trainer.py] => pi: 100
2024-12-29 16:26:24,736 [trainer.py] => w_bn: 50.0
2024-12-29 16:26:24,736 [trainer.py] => w_noise: 0.001
2024-12-29 16:26:24,736 [trainer.py] => server_ss: 32
2024-12-29 16:26:24,736 [trainer.py] => bn_loss: 1
2024-12-29 16:26:24,736 [trainer.py] => noise: 1
2024-12-29 16:26:24,736 [trainer.py] => ie_loss: 1
2024-12-29 16:26:24,736 [trainer.py] => act_loss: 0
2024-12-29 16:26:24,736 [trainer.py] => w_ie: 1.0
2024-12-29 16:26:24,736 [trainer.py] => w_act: 0.1
2024-12-29 16:26:24,736 [trainer.py] => syn_size: 224
2024-12-29 16:26:24,736 [trainer.py] => vpt_type: Deep
2024-12-29 16:26:24,736 [trainer.py] => prompt_token_num: 6
2024-12-29 16:26:24,736 [trainer.py] => avg_alpha: 0.8
2024-12-29 16:26:24,736 [trainer.py] => perturb_var: 1
2024-12-29 16:26:24,736 [trainer.py] => EMA_beta: 0.99
2024-12-29 16:26:24,736 [trainer.py] => anchor_lambda: 0.1
2024-12-29 16:26:24,736 [trainer.py] => kl_weight: 0.001
2024-12-29 16:26:24,736 [trainer.py] => TIP_init: zero
2024-12-29 16:26:24,736 [trainer.py] => tuned_epoch: 20
2024-12-29 16:26:24,736 [trainer.py] => fs_epoch: 0
2024-12-29 16:26:24,736 [trainer.py] => init_lr: 0.01
2024-12-29 16:26:24,736 [trainer.py] => fs_lr: 0.001
2024-12-29 16:26:24,736 [trainer.py] => batch_size: 48
2024-12-29 16:26:24,736 [trainer.py] => fs_batch_size: 16
2024-12-29 16:26:24,736 [trainer.py] => weight_decay: 0.0005
2024-12-29 16:26:24,737 [trainer.py] => min_lr: 0
2024-12-29 16:26:24,737 [trainer.py] => optimizer: sgd
2024-12-29 16:26:24,737 [trainer.py] => memory_size: 0
2024-12-29 16:26:24,737 [trainer.py] => memory_per_class: 0
2024-12-29 16:26:24,737 [trainer.py] => fixed_memory: False
2024-12-29 16:26:24,737 [trainer.py] => shuffle: False
2024-12-29 16:26:24,737 [trainer.py] => top_k: 5
2024-12-29 16:26:24,737 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 16:26:24,737 [trainer.py] => prefix: asp
2024-12-29 16:26:24,737 [trainer.py] => model_prefix: asp
2024-12-29 16:26:26,246 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 16:26:32,577 [trainer.py] => All params: 173596160
2024-12-29 16:26:32,578 [trainer.py] => Trainable params: 1998848
2024-12-29 16:26:33,083 [asp.py] => Learning on 0-60
2024-12-29 16:26:33,203 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 16:27:17,024 [asp.py] => total parameters: 173642241
2024-12-29 16:27:17,025 [asp.py] => trainable parameters: 2044929
2024-12-29 16:28:11,672 [trainer.py] => config: ./exps/cifar.json
2024-12-29 16:28:11,672 [trainer.py] => model_name: asp
2024-12-29 16:28:11,672 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 16:28:11,673 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 16:28:11,673 [trainer.py] => seed: 2024
2024-12-29 16:28:11,673 [trainer.py] => dataset: cifar224
2024-12-29 16:28:11,673 [trainer.py] => init_cls: 60
2024-12-29 16:28:11,673 [trainer.py] => increment: 5
2024-12-29 16:28:11,673 [trainer.py] => kshot: 5
2024-12-29 16:28:11,673 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 16:28:11,673 [trainer.py] => z_dim: 1000
2024-12-29 16:28:11,673 [trainer.py] => conv_dim: 64
2024-12-29 16:28:11,673 [trainer.py] => img_size: 224
2024-12-29 16:28:11,673 [trainer.py] => generator_lr: 0.001
2024-12-29 16:28:11,673 [trainer.py] => pi: 100
2024-12-29 16:28:11,673 [trainer.py] => w_bn: 50.0
2024-12-29 16:28:11,673 [trainer.py] => w_noise: 0.001
2024-12-29 16:28:11,673 [trainer.py] => server_ss: 32
2024-12-29 16:28:11,673 [trainer.py] => bn_loss: 1
2024-12-29 16:28:11,673 [trainer.py] => noise: 1
2024-12-29 16:28:11,673 [trainer.py] => ie_loss: 1
2024-12-29 16:28:11,673 [trainer.py] => act_loss: 0
2024-12-29 16:28:11,673 [trainer.py] => w_ie: 1.0
2024-12-29 16:28:11,673 [trainer.py] => w_act: 0.1
2024-12-29 16:28:11,673 [trainer.py] => syn_size: 224
2024-12-29 16:28:11,673 [trainer.py] => vpt_type: Deep
2024-12-29 16:28:11,673 [trainer.py] => prompt_token_num: 6
2024-12-29 16:28:11,673 [trainer.py] => avg_alpha: 0.8
2024-12-29 16:28:11,673 [trainer.py] => perturb_var: 1
2024-12-29 16:28:11,673 [trainer.py] => EMA_beta: 0.99
2024-12-29 16:28:11,673 [trainer.py] => anchor_lambda: 0.1
2024-12-29 16:28:11,673 [trainer.py] => kl_weight: 0.001
2024-12-29 16:28:11,673 [trainer.py] => TIP_init: zero
2024-12-29 16:28:11,674 [trainer.py] => tuned_epoch: 20
2024-12-29 16:28:11,674 [trainer.py] => fs_epoch: 0
2024-12-29 16:28:11,674 [trainer.py] => init_lr: 0.01
2024-12-29 16:28:11,674 [trainer.py] => fs_lr: 0.001
2024-12-29 16:28:11,674 [trainer.py] => batch_size: 48
2024-12-29 16:28:11,674 [trainer.py] => fs_batch_size: 16
2024-12-29 16:28:11,674 [trainer.py] => weight_decay: 0.0005
2024-12-29 16:28:11,674 [trainer.py] => min_lr: 0
2024-12-29 16:28:11,674 [trainer.py] => optimizer: sgd
2024-12-29 16:28:11,674 [trainer.py] => memory_size: 0
2024-12-29 16:28:11,674 [trainer.py] => memory_per_class: 0
2024-12-29 16:28:11,674 [trainer.py] => fixed_memory: False
2024-12-29 16:28:11,674 [trainer.py] => shuffle: False
2024-12-29 16:28:11,674 [trainer.py] => top_k: 5
2024-12-29 16:28:11,674 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 16:28:11,674 [trainer.py] => prefix: asp
2024-12-29 16:28:11,674 [trainer.py] => model_prefix: asp
2024-12-29 16:28:13,154 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 16:28:19,525 [trainer.py] => All params: 173596160
2024-12-29 16:28:19,527 [trainer.py] => Trainable params: 1998848
2024-12-29 16:28:19,877 [asp.py] => Learning on 0-60
2024-12-29 16:28:19,962 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 16:29:04,056 [asp.py] => total parameters: 173642241
2024-12-29 16:29:04,057 [asp.py] => trainable parameters: 2044929
2024-12-29 16:30:57,758 [trainer.py] => config: ./exps/cifar.json
2024-12-29 16:30:57,759 [trainer.py] => model_name: asp
2024-12-29 16:30:57,759 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 16:30:57,759 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 16:30:57,759 [trainer.py] => seed: 2024
2024-12-29 16:30:57,759 [trainer.py] => dataset: cifar224
2024-12-29 16:30:57,759 [trainer.py] => init_cls: 60
2024-12-29 16:30:57,759 [trainer.py] => increment: 5
2024-12-29 16:30:57,759 [trainer.py] => kshot: 5
2024-12-29 16:30:57,759 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 16:30:57,759 [trainer.py] => z_dim: 1000
2024-12-29 16:30:57,759 [trainer.py] => conv_dim: 64
2024-12-29 16:30:57,759 [trainer.py] => img_size: 224
2024-12-29 16:30:57,759 [trainer.py] => generator_lr: 0.001
2024-12-29 16:30:57,759 [trainer.py] => pi: 100
2024-12-29 16:30:57,759 [trainer.py] => w_bn: 50.0
2024-12-29 16:30:57,759 [trainer.py] => w_noise: 0.001
2024-12-29 16:30:57,759 [trainer.py] => server_ss: 32
2024-12-29 16:30:57,759 [trainer.py] => bn_loss: 1
2024-12-29 16:30:57,759 [trainer.py] => noise: 1
2024-12-29 16:30:57,759 [trainer.py] => ie_loss: 1
2024-12-29 16:30:57,759 [trainer.py] => act_loss: 0
2024-12-29 16:30:57,759 [trainer.py] => w_ie: 1.0
2024-12-29 16:30:57,759 [trainer.py] => w_act: 0.1
2024-12-29 16:30:57,759 [trainer.py] => syn_size: 224
2024-12-29 16:30:57,759 [trainer.py] => vpt_type: Deep
2024-12-29 16:30:57,759 [trainer.py] => prompt_token_num: 6
2024-12-29 16:30:57,759 [trainer.py] => avg_alpha: 0.8
2024-12-29 16:30:57,759 [trainer.py] => perturb_var: 1
2024-12-29 16:30:57,759 [trainer.py] => EMA_beta: 0.99
2024-12-29 16:30:57,760 [trainer.py] => anchor_lambda: 0.1
2024-12-29 16:30:57,760 [trainer.py] => kl_weight: 0.001
2024-12-29 16:30:57,760 [trainer.py] => TIP_init: zero
2024-12-29 16:30:57,760 [trainer.py] => tuned_epoch: 20
2024-12-29 16:30:57,760 [trainer.py] => fs_epoch: 0
2024-12-29 16:30:57,760 [trainer.py] => init_lr: 0.01
2024-12-29 16:30:57,760 [trainer.py] => fs_lr: 0.001
2024-12-29 16:30:57,760 [trainer.py] => batch_size: 48
2024-12-29 16:30:57,760 [trainer.py] => fs_batch_size: 16
2024-12-29 16:30:57,760 [trainer.py] => weight_decay: 0.0005
2024-12-29 16:30:57,760 [trainer.py] => min_lr: 0
2024-12-29 16:30:57,760 [trainer.py] => optimizer: sgd
2024-12-29 16:30:57,760 [trainer.py] => memory_size: 0
2024-12-29 16:30:57,760 [trainer.py] => memory_per_class: 0
2024-12-29 16:30:57,760 [trainer.py] => fixed_memory: False
2024-12-29 16:30:57,760 [trainer.py] => shuffle: False
2024-12-29 16:30:57,760 [trainer.py] => top_k: 5
2024-12-29 16:30:57,760 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 16:30:57,760 [trainer.py] => prefix: asp
2024-12-29 16:30:57,760 [trainer.py] => model_prefix: asp
2024-12-29 16:30:59,254 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 16:31:05,308 [trainer.py] => All params: 173596160
2024-12-29 16:31:05,309 [trainer.py] => Trainable params: 1998848
2024-12-29 16:31:05,796 [asp.py] => Learning on 0-60
2024-12-29 16:31:05,880 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 16:31:49,098 [asp.py] => total parameters: 173642241
2024-12-29 16:31:49,099 [asp.py] => trainable parameters: 2044929
2024-12-29 20:40:19,957 [trainer.py] => config: ./exps/cifar.json
2024-12-29 20:40:19,957 [trainer.py] => model_name: asp
2024-12-29 20:40:19,957 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 20:40:19,957 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 20:40:19,957 [trainer.py] => seed: 2024
2024-12-29 20:40:19,957 [trainer.py] => dataset: cifar224
2024-12-29 20:40:19,957 [trainer.py] => init_cls: 60
2024-12-29 20:40:19,957 [trainer.py] => increment: 5
2024-12-29 20:40:19,957 [trainer.py] => kshot: 5
2024-12-29 20:40:19,957 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 20:40:19,957 [trainer.py] => z_dim: 1000
2024-12-29 20:40:19,957 [trainer.py] => conv_dim: 64
2024-12-29 20:40:19,957 [trainer.py] => img_size: 224
2024-12-29 20:40:19,957 [trainer.py] => generator_lr: 0.001
2024-12-29 20:40:19,958 [trainer.py] => pi: 100
2024-12-29 20:40:19,958 [trainer.py] => w_bn: 50.0
2024-12-29 20:40:19,958 [trainer.py] => w_noise: 0.001
2024-12-29 20:40:19,958 [trainer.py] => server_ss: 32
2024-12-29 20:40:19,958 [trainer.py] => bn_loss: 1
2024-12-29 20:40:19,958 [trainer.py] => noise: 1
2024-12-29 20:40:19,958 [trainer.py] => ie_loss: 1
2024-12-29 20:40:19,958 [trainer.py] => act_loss: 0
2024-12-29 20:40:19,958 [trainer.py] => w_ie: 1.0
2024-12-29 20:40:19,958 [trainer.py] => w_act: 0.1
2024-12-29 20:40:19,958 [trainer.py] => syn_size: 224
2024-12-29 20:40:19,958 [trainer.py] => vpt_type: Deep
2024-12-29 20:40:19,958 [trainer.py] => prompt_token_num: 6
2024-12-29 20:40:19,958 [trainer.py] => avg_alpha: 0.8
2024-12-29 20:40:19,958 [trainer.py] => perturb_var: 1
2024-12-29 20:40:19,958 [trainer.py] => EMA_beta: 0.99
2024-12-29 20:40:19,958 [trainer.py] => anchor_lambda: 0.1
2024-12-29 20:40:19,958 [trainer.py] => kl_weight: 0.001
2024-12-29 20:40:19,958 [trainer.py] => TIP_init: zero
2024-12-29 20:40:19,958 [trainer.py] => tuned_epoch: 20
2024-12-29 20:40:19,958 [trainer.py] => fs_epoch: 0
2024-12-29 20:40:19,958 [trainer.py] => init_lr: 0.01
2024-12-29 20:40:19,958 [trainer.py] => fs_lr: 0.001
2024-12-29 20:40:19,958 [trainer.py] => batch_size: 48
2024-12-29 20:40:19,958 [trainer.py] => fs_batch_size: 16
2024-12-29 20:40:19,958 [trainer.py] => weight_decay: 0.0005
2024-12-29 20:40:19,958 [trainer.py] => min_lr: 0
2024-12-29 20:40:19,958 [trainer.py] => optimizer: sgd
2024-12-29 20:40:19,958 [trainer.py] => memory_size: 0
2024-12-29 20:40:19,958 [trainer.py] => memory_per_class: 0
2024-12-29 20:40:19,958 [trainer.py] => fixed_memory: False
2024-12-29 20:40:19,958 [trainer.py] => shuffle: False
2024-12-29 20:40:19,958 [trainer.py] => top_k: 5
2024-12-29 20:40:19,958 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 20:40:19,959 [trainer.py] => prefix: asp
2024-12-29 20:40:19,959 [trainer.py] => model_prefix: asp
2024-12-29 20:40:21,468 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 20:40:37,269 [trainer.py] => config: ./exps/cifar.json
2024-12-29 20:40:37,270 [trainer.py] => model_name: asp
2024-12-29 20:40:37,270 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 20:40:37,270 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 20:40:37,270 [trainer.py] => seed: 2024
2024-12-29 20:40:37,270 [trainer.py] => dataset: cifar224
2024-12-29 20:40:37,270 [trainer.py] => init_cls: 60
2024-12-29 20:40:37,271 [trainer.py] => increment: 5
2024-12-29 20:40:37,271 [trainer.py] => kshot: 5
2024-12-29 20:40:37,271 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 20:40:37,271 [trainer.py] => z_dim: 1000
2024-12-29 20:40:37,271 [trainer.py] => conv_dim: 64
2024-12-29 20:40:37,271 [trainer.py] => img_size: 224
2024-12-29 20:40:37,271 [trainer.py] => generator_lr: 0.001
2024-12-29 20:40:37,271 [trainer.py] => pi: 100
2024-12-29 20:40:37,271 [trainer.py] => w_bn: 50.0
2024-12-29 20:40:37,271 [trainer.py] => w_noise: 0.001
2024-12-29 20:40:37,271 [trainer.py] => server_ss: 32
2024-12-29 20:40:37,271 [trainer.py] => bn_loss: 1
2024-12-29 20:40:37,271 [trainer.py] => noise: 1
2024-12-29 20:40:37,271 [trainer.py] => ie_loss: 1
2024-12-29 20:40:37,271 [trainer.py] => act_loss: 0
2024-12-29 20:40:37,271 [trainer.py] => w_ie: 1.0
2024-12-29 20:40:37,271 [trainer.py] => w_act: 0.1
2024-12-29 20:40:37,271 [trainer.py] => syn_size: 224
2024-12-29 20:40:37,271 [trainer.py] => vpt_type: Deep
2024-12-29 20:40:37,271 [trainer.py] => prompt_token_num: 6
2024-12-29 20:40:37,271 [trainer.py] => avg_alpha: 0.8
2024-12-29 20:40:37,271 [trainer.py] => perturb_var: 1
2024-12-29 20:40:37,271 [trainer.py] => EMA_beta: 0.99
2024-12-29 20:40:37,271 [trainer.py] => anchor_lambda: 0.1
2024-12-29 20:40:37,271 [trainer.py] => kl_weight: 0.001
2024-12-29 20:40:37,271 [trainer.py] => TIP_init: zero
2024-12-29 20:40:37,272 [trainer.py] => tuned_epoch: 20
2024-12-29 20:40:37,272 [trainer.py] => fs_epoch: 0
2024-12-29 20:40:37,272 [trainer.py] => init_lr: 0.01
2024-12-29 20:40:37,272 [trainer.py] => fs_lr: 0.001
2024-12-29 20:40:37,272 [trainer.py] => batch_size: 48
2024-12-29 20:40:37,272 [trainer.py] => fs_batch_size: 16
2024-12-29 20:40:37,272 [trainer.py] => weight_decay: 0.0005
2024-12-29 20:40:37,272 [trainer.py] => min_lr: 0
2024-12-29 20:40:37,272 [trainer.py] => optimizer: sgd
2024-12-29 20:40:37,272 [trainer.py] => memory_size: 0
2024-12-29 20:40:37,272 [trainer.py] => memory_per_class: 0
2024-12-29 20:40:37,272 [trainer.py] => fixed_memory: False
2024-12-29 20:40:37,272 [trainer.py] => shuffle: False
2024-12-29 20:40:37,272 [trainer.py] => top_k: 5
2024-12-29 20:40:37,272 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 20:40:37,272 [trainer.py] => prefix: asp
2024-12-29 20:40:37,272 [trainer.py] => model_prefix: asp
2024-12-29 20:40:38,714 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 20:40:46,027 [trainer.py] => All params: 173596160
2024-12-29 20:40:46,028 [trainer.py] => Trainable params: 1998848
2024-12-29 20:40:46,620 [asp.py] => Learning on 0-60
2024-12-29 20:40:46,730 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 20:41:28,074 [asp.py] => total parameters: 173642241
2024-12-29 20:41:28,074 [asp.py] => trainable parameters: 2044929
2024-12-29 20:46:00,492 [trainer.py] => config: ./exps/cifar.json
2024-12-29 20:46:00,492 [trainer.py] => model_name: asp
2024-12-29 20:46:00,492 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 20:46:00,492 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 20:46:00,492 [trainer.py] => seed: 2024
2024-12-29 20:46:00,492 [trainer.py] => dataset: cifar224
2024-12-29 20:46:00,492 [trainer.py] => init_cls: 60
2024-12-29 20:46:00,492 [trainer.py] => increment: 5
2024-12-29 20:46:00,492 [trainer.py] => kshot: 5
2024-12-29 20:46:00,492 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 20:46:00,492 [trainer.py] => z_dim: 1000
2024-12-29 20:46:00,492 [trainer.py] => conv_dim: 64
2024-12-29 20:46:00,492 [trainer.py] => img_size: 224
2024-12-29 20:46:00,492 [trainer.py] => generator_lr: 0.001
2024-12-29 20:46:00,492 [trainer.py] => pi: 100
2024-12-29 20:46:00,493 [trainer.py] => w_bn: 50.0
2024-12-29 20:46:00,493 [trainer.py] => w_noise: 0.001
2024-12-29 20:46:00,493 [trainer.py] => server_ss: 32
2024-12-29 20:46:00,493 [trainer.py] => bn_loss: 1
2024-12-29 20:46:00,493 [trainer.py] => noise: 1
2024-12-29 20:46:00,493 [trainer.py] => ie_loss: 1
2024-12-29 20:46:00,493 [trainer.py] => act_loss: 0
2024-12-29 20:46:00,493 [trainer.py] => w_ie: 1.0
2024-12-29 20:46:00,493 [trainer.py] => w_act: 0.1
2024-12-29 20:46:00,493 [trainer.py] => syn_size: 224
2024-12-29 20:46:00,493 [trainer.py] => vpt_type: Deep
2024-12-29 20:46:00,493 [trainer.py] => prompt_token_num: 6
2024-12-29 20:46:00,493 [trainer.py] => avg_alpha: 0.8
2024-12-29 20:46:00,493 [trainer.py] => perturb_var: 1
2024-12-29 20:46:00,493 [trainer.py] => EMA_beta: 0.99
2024-12-29 20:46:00,493 [trainer.py] => anchor_lambda: 0.1
2024-12-29 20:46:00,493 [trainer.py] => kl_weight: 0.001
2024-12-29 20:46:00,493 [trainer.py] => TIP_init: zero
2024-12-29 20:46:00,493 [trainer.py] => tuned_epoch: 20
2024-12-29 20:46:00,493 [trainer.py] => fs_epoch: 0
2024-12-29 20:46:00,493 [trainer.py] => init_lr: 0.01
2024-12-29 20:46:00,493 [trainer.py] => fs_lr: 0.001
2024-12-29 20:46:00,493 [trainer.py] => batch_size: 48
2024-12-29 20:46:00,493 [trainer.py] => fs_batch_size: 16
2024-12-29 20:46:00,493 [trainer.py] => weight_decay: 0.0005
2024-12-29 20:46:00,493 [trainer.py] => min_lr: 0
2024-12-29 20:46:00,493 [trainer.py] => optimizer: sgd
2024-12-29 20:46:00,494 [trainer.py] => memory_size: 0
2024-12-29 20:46:00,494 [trainer.py] => memory_per_class: 0
2024-12-29 20:46:00,494 [trainer.py] => fixed_memory: False
2024-12-29 20:46:00,494 [trainer.py] => shuffle: False
2024-12-29 20:46:00,494 [trainer.py] => top_k: 5
2024-12-29 20:46:00,494 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 20:46:00,494 [trainer.py] => prefix: asp
2024-12-29 20:46:00,494 [trainer.py] => model_prefix: asp
2024-12-29 20:46:01,961 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 20:46:08,154 [trainer.py] => All params: 173596160
2024-12-29 20:46:08,156 [trainer.py] => Trainable params: 1998848
2024-12-29 20:46:08,706 [asp.py] => Learning on 0-60
2024-12-29 20:46:08,830 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 20:46:51,002 [asp.py] => total parameters: 173642241
2024-12-29 20:46:51,003 [asp.py] => trainable parameters: 2044929
2024-12-29 20:49:41,503 [trainer.py] => config: ./exps/cifar.json
2024-12-29 20:49:41,503 [trainer.py] => model_name: asp
2024-12-29 20:49:41,503 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 20:49:41,503 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 20:49:41,503 [trainer.py] => seed: 2024
2024-12-29 20:49:41,503 [trainer.py] => dataset: cifar224
2024-12-29 20:49:41,503 [trainer.py] => init_cls: 60
2024-12-29 20:49:41,503 [trainer.py] => increment: 5
2024-12-29 20:49:41,503 [trainer.py] => kshot: 5
2024-12-29 20:49:41,503 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 20:49:41,503 [trainer.py] => z_dim: 1000
2024-12-29 20:49:41,503 [trainer.py] => conv_dim: 64
2024-12-29 20:49:41,503 [trainer.py] => img_size: 224
2024-12-29 20:49:41,503 [trainer.py] => generator_lr: 0.001
2024-12-29 20:49:41,504 [trainer.py] => pi: 100
2024-12-29 20:49:41,504 [trainer.py] => w_bn: 50.0
2024-12-29 20:49:41,504 [trainer.py] => w_noise: 0.001
2024-12-29 20:49:41,504 [trainer.py] => server_ss: 32
2024-12-29 20:49:41,504 [trainer.py] => bn_loss: 1
2024-12-29 20:49:41,504 [trainer.py] => noise: 1
2024-12-29 20:49:41,504 [trainer.py] => ie_loss: 1
2024-12-29 20:49:41,504 [trainer.py] => act_loss: 0
2024-12-29 20:49:41,504 [trainer.py] => w_ie: 1.0
2024-12-29 20:49:41,504 [trainer.py] => w_act: 0.1
2024-12-29 20:49:41,504 [trainer.py] => syn_size: 224
2024-12-29 20:49:41,504 [trainer.py] => vpt_type: Deep
2024-12-29 20:49:41,504 [trainer.py] => prompt_token_num: 6
2024-12-29 20:49:41,504 [trainer.py] => avg_alpha: 0.8
2024-12-29 20:49:41,504 [trainer.py] => perturb_var: 1
2024-12-29 20:49:41,504 [trainer.py] => EMA_beta: 0.99
2024-12-29 20:49:41,504 [trainer.py] => anchor_lambda: 0.1
2024-12-29 20:49:41,504 [trainer.py] => kl_weight: 0.001
2024-12-29 20:49:41,504 [trainer.py] => TIP_init: zero
2024-12-29 20:49:41,504 [trainer.py] => tuned_epoch: 20
2024-12-29 20:49:41,504 [trainer.py] => fs_epoch: 0
2024-12-29 20:49:41,504 [trainer.py] => init_lr: 0.01
2024-12-29 20:49:41,504 [trainer.py] => fs_lr: 0.001
2024-12-29 20:49:41,504 [trainer.py] => batch_size: 48
2024-12-29 20:49:41,504 [trainer.py] => fs_batch_size: 16
2024-12-29 20:49:41,504 [trainer.py] => weight_decay: 0.0005
2024-12-29 20:49:41,504 [trainer.py] => min_lr: 0
2024-12-29 20:49:41,504 [trainer.py] => optimizer: sgd
2024-12-29 20:49:41,504 [trainer.py] => memory_size: 0
2024-12-29 20:49:41,504 [trainer.py] => memory_per_class: 0
2024-12-29 20:49:41,504 [trainer.py] => fixed_memory: False
2024-12-29 20:49:41,505 [trainer.py] => shuffle: False
2024-12-29 20:49:41,505 [trainer.py] => top_k: 5
2024-12-29 20:49:41,505 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 20:49:41,505 [trainer.py] => prefix: asp
2024-12-29 20:49:41,505 [trainer.py] => model_prefix: asp
2024-12-29 20:49:42,989 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 20:49:49,331 [trainer.py] => All params: 173596160
2024-12-29 20:49:49,332 [trainer.py] => Trainable params: 1998848
2024-12-29 20:49:49,685 [asp.py] => Learning on 0-60
2024-12-29 20:49:50,547 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 20:50:25,390 [trainer.py] => config: ./exps/cifar.json
2024-12-29 20:50:25,390 [trainer.py] => model_name: asp
2024-12-29 20:50:25,390 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 20:50:25,390 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 20:50:25,390 [trainer.py] => seed: 2024
2024-12-29 20:50:25,390 [trainer.py] => dataset: cifar224
2024-12-29 20:50:25,390 [trainer.py] => init_cls: 60
2024-12-29 20:50:25,390 [trainer.py] => increment: 5
2024-12-29 20:50:25,390 [trainer.py] => kshot: 5
2024-12-29 20:50:25,390 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 20:50:25,390 [trainer.py] => z_dim: 1000
2024-12-29 20:50:25,390 [trainer.py] => conv_dim: 64
2024-12-29 20:50:25,390 [trainer.py] => img_size: 224
2024-12-29 20:50:25,390 [trainer.py] => generator_lr: 0.001
2024-12-29 20:50:25,390 [trainer.py] => pi: 100
2024-12-29 20:50:25,390 [trainer.py] => w_bn: 50.0
2024-12-29 20:50:25,390 [trainer.py] => w_noise: 0.001
2024-12-29 20:50:25,391 [trainer.py] => server_ss: 32
2024-12-29 20:50:25,391 [trainer.py] => bn_loss: 1
2024-12-29 20:50:25,391 [trainer.py] => noise: 1
2024-12-29 20:50:25,391 [trainer.py] => ie_loss: 1
2024-12-29 20:50:25,391 [trainer.py] => act_loss: 0
2024-12-29 20:50:25,391 [trainer.py] => w_ie: 1.0
2024-12-29 20:50:25,391 [trainer.py] => w_act: 0.1
2024-12-29 20:50:25,391 [trainer.py] => syn_size: 224
2024-12-29 20:50:25,391 [trainer.py] => vpt_type: Deep
2024-12-29 20:50:25,391 [trainer.py] => prompt_token_num: 6
2024-12-29 20:50:25,391 [trainer.py] => avg_alpha: 0.8
2024-12-29 20:50:25,391 [trainer.py] => perturb_var: 1
2024-12-29 20:50:25,391 [trainer.py] => EMA_beta: 0.99
2024-12-29 20:50:25,391 [trainer.py] => anchor_lambda: 0.1
2024-12-29 20:50:25,391 [trainer.py] => kl_weight: 0.001
2024-12-29 20:50:25,391 [trainer.py] => TIP_init: zero
2024-12-29 20:50:25,391 [trainer.py] => tuned_epoch: 20
2024-12-29 20:50:25,391 [trainer.py] => fs_epoch: 0
2024-12-29 20:50:25,391 [trainer.py] => init_lr: 0.01
2024-12-29 20:50:25,391 [trainer.py] => fs_lr: 0.001
2024-12-29 20:50:25,391 [trainer.py] => batch_size: 48
2024-12-29 20:50:25,391 [trainer.py] => fs_batch_size: 16
2024-12-29 20:50:25,391 [trainer.py] => weight_decay: 0.0005
2024-12-29 20:50:25,391 [trainer.py] => min_lr: 0
2024-12-29 20:50:25,391 [trainer.py] => optimizer: sgd
2024-12-29 20:50:25,391 [trainer.py] => memory_size: 0
2024-12-29 20:50:25,391 [trainer.py] => memory_per_class: 0
2024-12-29 20:50:25,391 [trainer.py] => fixed_memory: False
2024-12-29 20:50:25,391 [trainer.py] => shuffle: False
2024-12-29 20:50:25,391 [trainer.py] => top_k: 5
2024-12-29 20:50:25,391 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 20:50:25,391 [trainer.py] => prefix: asp
2024-12-29 20:50:25,391 [trainer.py] => model_prefix: asp
2024-12-29 20:50:26,842 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 20:50:32,900 [trainer.py] => All params: 173596160
2024-12-29 20:50:32,901 [trainer.py] => Trainable params: 1998848
2024-12-29 20:50:33,447 [asp.py] => Learning on 0-60
2024-12-29 20:50:33,520 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 20:51:15,923 [asp.py] => total parameters: 173642241
2024-12-29 20:51:15,924 [asp.py] => trainable parameters: 2044929
2024-12-29 21:13:17,792 [trainer.py] => config: ./exps/cifar.json
2024-12-29 21:13:17,792 [trainer.py] => model_name: asp
2024-12-29 21:13:17,792 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-29 21:13:17,793 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-29 21:13:17,793 [trainer.py] => seed: 2024
2024-12-29 21:13:17,793 [trainer.py] => dataset: cifar224
2024-12-29 21:13:17,793 [trainer.py] => init_cls: 60
2024-12-29 21:13:17,793 [trainer.py] => increment: 5
2024-12-29 21:13:17,793 [trainer.py] => kshot: 5
2024-12-29 21:13:17,793 [trainer.py] => generator_model: CIFAR_GEN
2024-12-29 21:13:17,793 [trainer.py] => z_dim: 1000
2024-12-29 21:13:17,793 [trainer.py] => conv_dim: 64
2024-12-29 21:13:17,793 [trainer.py] => img_size: 224
2024-12-29 21:13:17,793 [trainer.py] => generator_lr: 0.001
2024-12-29 21:13:17,793 [trainer.py] => pi: 100
2024-12-29 21:13:17,793 [trainer.py] => w_bn: 50.0
2024-12-29 21:13:17,793 [trainer.py] => w_noise: 0.001
2024-12-29 21:13:17,793 [trainer.py] => server_ss: 32
2024-12-29 21:13:17,793 [trainer.py] => bn_loss: 1
2024-12-29 21:13:17,793 [trainer.py] => noise: 1
2024-12-29 21:13:17,793 [trainer.py] => ie_loss: 1
2024-12-29 21:13:17,793 [trainer.py] => act_loss: 0
2024-12-29 21:13:17,793 [trainer.py] => w_ie: 1.0
2024-12-29 21:13:17,793 [trainer.py] => w_act: 0.1
2024-12-29 21:13:17,793 [trainer.py] => syn_size: 224
2024-12-29 21:13:17,793 [trainer.py] => vpt_type: Deep
2024-12-29 21:13:17,793 [trainer.py] => prompt_token_num: 6
2024-12-29 21:13:17,793 [trainer.py] => avg_alpha: 0.8
2024-12-29 21:13:17,793 [trainer.py] => perturb_var: 1
2024-12-29 21:13:17,793 [trainer.py] => EMA_beta: 0.99
2024-12-29 21:13:17,793 [trainer.py] => anchor_lambda: 0.1
2024-12-29 21:13:17,793 [trainer.py] => kl_weight: 0.001
2024-12-29 21:13:17,793 [trainer.py] => TIP_init: zero
2024-12-29 21:13:17,793 [trainer.py] => tuned_epoch: 20
2024-12-29 21:13:17,794 [trainer.py] => fs_epoch: 0
2024-12-29 21:13:17,794 [trainer.py] => init_lr: 0.01
2024-12-29 21:13:17,794 [trainer.py] => fs_lr: 0.001
2024-12-29 21:13:17,794 [trainer.py] => batch_size: 48
2024-12-29 21:13:17,794 [trainer.py] => fs_batch_size: 16
2024-12-29 21:13:17,794 [trainer.py] => weight_decay: 0.0005
2024-12-29 21:13:17,794 [trainer.py] => min_lr: 0
2024-12-29 21:13:17,794 [trainer.py] => optimizer: sgd
2024-12-29 21:13:17,794 [trainer.py] => memory_size: 0
2024-12-29 21:13:17,794 [trainer.py] => memory_per_class: 0
2024-12-29 21:13:17,794 [trainer.py] => fixed_memory: False
2024-12-29 21:13:17,794 [trainer.py] => shuffle: False
2024-12-29 21:13:17,794 [trainer.py] => top_k: 5
2024-12-29 21:13:17,794 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-29 21:13:17,794 [trainer.py] => prefix: asp
2024-12-29 21:13:17,794 [trainer.py] => model_prefix: asp
2024-12-29 21:13:19,295 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-29 21:13:25,610 [trainer.py] => All params: 173596160
2024-12-29 21:13:25,611 [trainer.py] => Trainable params: 1998848
2024-12-29 21:13:26,181 [asp.py] => Learning on 0-60
2024-12-29 21:13:26,285 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-29 21:14:07,732 [asp.py] => total parameters: 173642241
2024-12-29 21:14:07,733 [asp.py] => trainable parameters: 2044929
2024-12-29 21:31:41,071 [asp.py] => Task 0, Epoch 1 => Loss 2.923, Train_accy 46.74, Test_curr_accy 41.80, Test_accy 41.80
2024-12-29 21:49:31,568 [asp.py] => Task 0, Epoch 2 => Loss 1.378, Train_accy 75.22, Test_curr_accy 79.53, Test_accy 79.53
2024-12-29 22:07:20,744 [asp.py] => Task 0, Epoch 3 => Loss 0.835, Train_accy 84.48, Test_curr_accy 90.67, Test_accy 90.67
2024-12-29 22:25:13,456 [asp.py] => Task 0, Epoch 4 => Loss 0.616, Train_accy 87.10, Test_curr_accy 88.52, Test_accy 88.52
2024-12-29 22:43:05,430 [asp.py] => Task 0, Epoch 5 => Loss 0.543, Train_accy 87.88, Test_curr_accy 92.10, Test_accy 92.10
2024-12-29 23:00:57,745 [asp.py] => Task 0, Epoch 6 => Loss 0.503, Train_accy 88.45, Test_curr_accy 92.08, Test_accy 92.08
2024-12-29 23:18:50,543 [asp.py] => Task 0, Epoch 7 => Loss 0.485, Train_accy 88.57, Test_curr_accy 92.35, Test_accy 92.35
2024-12-29 23:36:44,336 [asp.py] => Task 0, Epoch 8 => Loss 0.475, Train_accy 88.88, Test_curr_accy 92.48, Test_accy 92.48
2024-12-29 23:54:38,404 [asp.py] => Task 0, Epoch 9 => Loss 0.458, Train_accy 89.15, Test_curr_accy 92.62, Test_accy 92.62
2024-12-30 00:12:33,713 [asp.py] => Task 0, Epoch 10 => Loss 0.498, Train_accy 88.26, Test_curr_accy 89.55, Test_accy 89.55
2024-12-30 00:30:28,649 [asp.py] => Task 0, Epoch 11 => Loss 0.462, Train_accy 89.26, Test_curr_accy 92.63, Test_accy 92.63
2024-12-30 12:09:00,375 [trainer.py] => config: ./exps/cifar.json
2024-12-30 12:09:00,375 [trainer.py] => model_name: asp
2024-12-30 12:09:00,375 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 12:09:00,375 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-30 12:09:00,375 [trainer.py] => seed: 2024
2024-12-30 12:09:00,375 [trainer.py] => dataset: cifar224
2024-12-30 12:09:00,375 [trainer.py] => init_cls: 60
2024-12-30 12:09:00,375 [trainer.py] => increment: 5
2024-12-30 12:09:00,375 [trainer.py] => kshot: 5
2024-12-30 12:09:00,375 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 12:09:00,375 [trainer.py] => z_dim: 1000
2024-12-30 12:09:00,376 [trainer.py] => conv_dim: 64
2024-12-30 12:09:00,376 [trainer.py] => img_size: 224
2024-12-30 12:09:00,376 [trainer.py] => generator_lr: 0.001
2024-12-30 12:09:00,376 [trainer.py] => pi: 100
2024-12-30 12:09:00,376 [trainer.py] => w_bn: 50.0
2024-12-30 12:09:00,376 [trainer.py] => w_noise: 0.001
2024-12-30 12:09:00,376 [trainer.py] => server_ss: 32
2024-12-30 12:09:00,376 [trainer.py] => bn_loss: 1
2024-12-30 12:09:00,376 [trainer.py] => noise: 1
2024-12-30 12:09:00,376 [trainer.py] => ie_loss: 1
2024-12-30 12:09:00,376 [trainer.py] => act_loss: 0
2024-12-30 12:09:00,376 [trainer.py] => w_ie: 1.0
2024-12-30 12:09:00,376 [trainer.py] => w_act: 0.1
2024-12-30 12:09:00,376 [trainer.py] => syn_size: 32
2024-12-30 12:09:00,376 [trainer.py] => vpt_type: Deep
2024-12-30 12:09:00,376 [trainer.py] => prompt_token_num: 6
2024-12-30 12:09:00,376 [trainer.py] => avg_alpha: 0.8
2024-12-30 12:09:00,376 [trainer.py] => perturb_var: 1
2024-12-30 12:09:00,376 [trainer.py] => EMA_beta: 0.99
2024-12-30 12:09:00,376 [trainer.py] => anchor_lambda: 0.1
2024-12-30 12:09:00,376 [trainer.py] => kl_weight: 0.001
2024-12-30 12:09:00,376 [trainer.py] => TIP_init: zero
2024-12-30 12:09:00,376 [trainer.py] => tuned_epoch: 20
2024-12-30 12:09:00,376 [trainer.py] => fs_epoch: 0
2024-12-30 12:09:00,376 [trainer.py] => init_lr: 0.01
2024-12-30 12:09:00,376 [trainer.py] => fs_lr: 0.001
2024-12-30 12:09:00,376 [trainer.py] => batch_size: 48
2024-12-30 12:09:00,376 [trainer.py] => fs_batch_size: 16
2024-12-30 12:09:00,376 [trainer.py] => weight_decay: 0.0005
2024-12-30 12:09:00,376 [trainer.py] => min_lr: 0
2024-12-30 12:09:00,377 [trainer.py] => optimizer: sgd
2024-12-30 12:09:00,377 [trainer.py] => memory_size: 0
2024-12-30 12:09:00,377 [trainer.py] => memory_per_class: 0
2024-12-30 12:09:00,377 [trainer.py] => fixed_memory: False
2024-12-30 12:09:00,377 [trainer.py] => shuffle: False
2024-12-30 12:09:00,377 [trainer.py] => top_k: 5
2024-12-30 12:09:00,377 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 12:09:00,377 [trainer.py] => prefix: asp
2024-12-30 12:09:00,377 [trainer.py] => model_prefix: asp
2024-12-30 12:09:01,900 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 12:09:11,938 [trainer.py] => All params: 173596160
2024-12-30 12:09:11,939 [trainer.py] => Trainable params: 1998848
2024-12-30 12:09:12,465 [asp.py] => Learning on 0-60
2024-12-30 12:09:12,566 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 12:10:01,228 [asp.py] => total parameters: 173642241
2024-12-30 12:10:01,230 [asp.py] => trainable parameters: 2044929
2024-12-30 12:11:25,524 [trainer.py] => config: ./exps/cifar.json
2024-12-30 12:11:25,524 [trainer.py] => model_name: asp
2024-12-30 12:11:25,524 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 12:11:25,524 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-30 12:11:25,524 [trainer.py] => seed: 2024
2024-12-30 12:11:25,524 [trainer.py] => dataset: cifar224
2024-12-30 12:11:25,524 [trainer.py] => init_cls: 60
2024-12-30 12:11:25,524 [trainer.py] => increment: 5
2024-12-30 12:11:25,524 [trainer.py] => kshot: 5
2024-12-30 12:11:25,524 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 12:11:25,524 [trainer.py] => z_dim: 1000
2024-12-30 12:11:25,524 [trainer.py] => conv_dim: 64
2024-12-30 12:11:25,524 [trainer.py] => img_size: 224
2024-12-30 12:11:25,524 [trainer.py] => generator_lr: 0.001
2024-12-30 12:11:25,524 [trainer.py] => pi: 100
2024-12-30 12:11:25,524 [trainer.py] => w_bn: 50.0
2024-12-30 12:11:25,524 [trainer.py] => w_noise: 0.001
2024-12-30 12:11:25,524 [trainer.py] => server_ss: 32
2024-12-30 12:11:25,524 [trainer.py] => bn_loss: 1
2024-12-30 12:11:25,524 [trainer.py] => noise: 1
2024-12-30 12:11:25,525 [trainer.py] => ie_loss: 1
2024-12-30 12:11:25,525 [trainer.py] => act_loss: 0
2024-12-30 12:11:25,525 [trainer.py] => w_ie: 1.0
2024-12-30 12:11:25,525 [trainer.py] => w_act: 0.1
2024-12-30 12:11:25,525 [trainer.py] => syn_size: 32
2024-12-30 12:11:25,525 [trainer.py] => vpt_type: Deep
2024-12-30 12:11:25,525 [trainer.py] => prompt_token_num: 6
2024-12-30 12:11:25,525 [trainer.py] => avg_alpha: 0.8
2024-12-30 12:11:25,525 [trainer.py] => perturb_var: 1
2024-12-30 12:11:25,525 [trainer.py] => EMA_beta: 0.99
2024-12-30 12:11:25,525 [trainer.py] => anchor_lambda: 0.1
2024-12-30 12:11:25,525 [trainer.py] => kl_weight: 0.001
2024-12-30 12:11:25,525 [trainer.py] => TIP_init: zero
2024-12-30 12:11:25,525 [trainer.py] => tuned_epoch: 20
2024-12-30 12:11:25,525 [trainer.py] => fs_epoch: 0
2024-12-30 12:11:25,525 [trainer.py] => init_lr: 0.01
2024-12-30 12:11:25,525 [trainer.py] => fs_lr: 0.001
2024-12-30 12:11:25,525 [trainer.py] => batch_size: 48
2024-12-30 12:11:25,525 [trainer.py] => fs_batch_size: 16
2024-12-30 12:11:25,525 [trainer.py] => weight_decay: 0.0005
2024-12-30 12:11:25,525 [trainer.py] => min_lr: 0
2024-12-30 12:11:25,525 [trainer.py] => optimizer: sgd
2024-12-30 12:11:25,525 [trainer.py] => memory_size: 0
2024-12-30 12:11:25,525 [trainer.py] => memory_per_class: 0
2024-12-30 12:11:25,525 [trainer.py] => fixed_memory: False
2024-12-30 12:11:25,525 [trainer.py] => shuffle: False
2024-12-30 12:11:25,525 [trainer.py] => top_k: 5
2024-12-30 12:11:25,525 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 12:11:25,525 [trainer.py] => prefix: asp
2024-12-30 12:11:25,525 [trainer.py] => model_prefix: asp
2024-12-30 12:11:27,049 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 12:11:33,217 [trainer.py] => All params: 173596160
2024-12-30 12:11:33,218 [trainer.py] => Trainable params: 1998848
2024-12-30 12:11:33,758 [asp.py] => Learning on 0-60
2024-12-30 12:11:33,850 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 12:12:16,361 [asp.py] => total parameters: 173642241
2024-12-30 12:12:16,362 [asp.py] => trainable parameters: 2044929
2024-12-30 12:29:48,903 [asp.py] => Task 0, Epoch 1 => Loss 2.006, Train_accy 71.02, Test_curr_accy 90.00, Test_accy 90.00
2024-12-30 12:47:37,259 [asp.py] => Task 0, Epoch 2 => Loss 0.863, Train_accy 85.83, Test_curr_accy 90.63, Test_accy 90.63
2024-12-30 13:05:22,060 [asp.py] => Task 0, Epoch 3 => Loss 0.797, Train_accy 86.78, Test_curr_accy 91.02, Test_accy 91.02
2024-12-30 13:23:11,438 [asp.py] => Task 0, Epoch 4 => Loss 0.624, Train_accy 87.75, Test_curr_accy 91.72, Test_accy 91.72
2024-12-30 13:41:00,788 [asp.py] => Task 0, Epoch 5 => Loss 0.633, Train_accy 88.09, Test_curr_accy 92.05, Test_accy 92.05
2024-12-30 13:58:49,956 [asp.py] => Task 0, Epoch 6 => Loss 0.534, Train_accy 88.58, Test_curr_accy 92.23, Test_accy 92.23
2024-12-30 14:16:40,646 [asp.py] => Task 0, Epoch 7 => Loss 0.572, Train_accy 88.14, Test_curr_accy 90.55, Test_accy 90.55
2024-12-30 14:34:30,198 [asp.py] => Task 0, Epoch 8 => Loss 0.518, Train_accy 88.77, Test_curr_accy 92.43, Test_accy 92.43
2024-12-30 14:52:30,653 [asp.py] => Task 0, Epoch 9 => Loss 0.493, Train_accy 88.94, Test_curr_accy 92.33, Test_accy 92.33
2024-12-30 15:00:54,129 [trainer.py] => config: ./exps/cifar.json
2024-12-30 15:00:54,129 [trainer.py] => model_name: asp
2024-12-30 15:00:54,129 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 15:00:54,129 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-30 15:00:54,129 [trainer.py] => seed: 2024
2024-12-30 15:00:54,129 [trainer.py] => dataset: cifar224
2024-12-30 15:00:54,129 [trainer.py] => init_cls: 60
2024-12-30 15:00:54,129 [trainer.py] => increment: 5
2024-12-30 15:00:54,129 [trainer.py] => kshot: 5
2024-12-30 15:00:54,129 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 15:00:54,129 [trainer.py] => z_dim: 1000
2024-12-30 15:00:54,129 [trainer.py] => conv_dim: 64
2024-12-30 15:00:54,129 [trainer.py] => img_size: 224
2024-12-30 15:00:54,129 [trainer.py] => generator_lr: 0.001
2024-12-30 15:00:54,129 [trainer.py] => pi: 100
2024-12-30 15:00:54,129 [trainer.py] => w_bn: 50.0
2024-12-30 15:00:54,129 [trainer.py] => w_noise: 0.001
2024-12-30 15:00:54,129 [trainer.py] => server_ss: 32
2024-12-30 15:00:54,129 [trainer.py] => bn_loss: 1
2024-12-30 15:00:54,129 [trainer.py] => noise: 1
2024-12-30 15:00:54,129 [trainer.py] => ie_loss: 1
2024-12-30 15:00:54,129 [trainer.py] => act_loss: 0
2024-12-30 15:00:54,129 [trainer.py] => w_ie: 1.0
2024-12-30 15:00:54,129 [trainer.py] => w_act: 0.1
2024-12-30 15:00:54,129 [trainer.py] => syn_size: 32
2024-12-30 15:00:54,129 [trainer.py] => vpt_type: Deep
2024-12-30 15:00:54,129 [trainer.py] => prompt_token_num: 6
2024-12-30 15:00:54,130 [trainer.py] => avg_alpha: 0.8
2024-12-30 15:00:54,130 [trainer.py] => perturb_var: 1
2024-12-30 15:00:54,130 [trainer.py] => EMA_beta: 0.99
2024-12-30 15:00:54,130 [trainer.py] => anchor_lambda: 0.1
2024-12-30 15:00:54,130 [trainer.py] => kl_weight: 0.001
2024-12-30 15:00:54,130 [trainer.py] => TIP_init: zero
2024-12-30 15:00:54,130 [trainer.py] => tuned_epoch: 20
2024-12-30 15:00:54,130 [trainer.py] => fs_epoch: 0
2024-12-30 15:00:54,130 [trainer.py] => init_lr: 0.01
2024-12-30 15:00:54,130 [trainer.py] => fs_lr: 0.001
2024-12-30 15:00:54,130 [trainer.py] => batch_size: 48
2024-12-30 15:00:54,130 [trainer.py] => fs_batch_size: 16
2024-12-30 15:00:54,130 [trainer.py] => weight_decay: 0.0005
2024-12-30 15:00:54,130 [trainer.py] => min_lr: 0
2024-12-30 15:00:54,130 [trainer.py] => optimizer: sgd
2024-12-30 15:00:54,130 [trainer.py] => memory_size: 0
2024-12-30 15:00:54,130 [trainer.py] => memory_per_class: 0
2024-12-30 15:00:54,130 [trainer.py] => fixed_memory: False
2024-12-30 15:00:54,130 [trainer.py] => shuffle: False
2024-12-30 15:00:54,130 [trainer.py] => top_k: 5
2024-12-30 15:00:54,130 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 15:00:54,130 [trainer.py] => prefix: asp
2024-12-30 15:00:54,130 [trainer.py] => model_prefix: asp
2024-12-30 15:00:55,647 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 15:01:02,009 [trainer.py] => All params: 173596160
2024-12-30 15:01:02,010 [trainer.py] => Trainable params: 1998848
2024-12-30 15:01:02,427 [asp.py] => Learning on 0-60
2024-12-30 15:01:02,570 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 15:01:45,460 [asp.py] => total parameters: 173642241
2024-12-30 15:01:45,461 [asp.py] => trainable parameters: 2044929
2024-12-30 15:14:48,254 [trainer.py] => config: ./exps/cifar.json
2024-12-30 15:14:48,254 [trainer.py] => model_name: asp
2024-12-30 15:14:48,254 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 15:14:48,254 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-30 15:14:48,254 [trainer.py] => seed: 2024
2024-12-30 15:14:48,254 [trainer.py] => dataset: cifar224
2024-12-30 15:14:48,254 [trainer.py] => init_cls: 60
2024-12-30 15:14:48,254 [trainer.py] => increment: 5
2024-12-30 15:14:48,254 [trainer.py] => kshot: 5
2024-12-30 15:14:48,254 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 15:14:48,254 [trainer.py] => z_dim: 1000
2024-12-30 15:14:48,254 [trainer.py] => conv_dim: 64
2024-12-30 15:14:48,254 [trainer.py] => img_size: 224
2024-12-30 15:14:48,254 [trainer.py] => generator_lr: 0.001
2024-12-30 15:14:48,254 [trainer.py] => pi: 100
2024-12-30 15:14:48,255 [trainer.py] => w_bn: 50.0
2024-12-30 15:14:48,255 [trainer.py] => w_noise: 0.001
2024-12-30 15:14:48,255 [trainer.py] => server_ss: 32
2024-12-30 15:14:48,255 [trainer.py] => bn_loss: 1
2024-12-30 15:14:48,255 [trainer.py] => noise: 1
2024-12-30 15:14:48,255 [trainer.py] => ie_loss: 1
2024-12-30 15:14:48,255 [trainer.py] => act_loss: 0
2024-12-30 15:14:48,255 [trainer.py] => w_ie: 1.0
2024-12-30 15:14:48,255 [trainer.py] => w_act: 0.1
2024-12-30 15:14:48,255 [trainer.py] => syn_size: 32
2024-12-30 15:14:48,255 [trainer.py] => vpt_type: Deep
2024-12-30 15:14:48,255 [trainer.py] => prompt_token_num: 6
2024-12-30 15:14:48,255 [trainer.py] => avg_alpha: 0.8
2024-12-30 15:14:48,255 [trainer.py] => perturb_var: 1
2024-12-30 15:14:48,255 [trainer.py] => EMA_beta: 0.99
2024-12-30 15:14:48,255 [trainer.py] => anchor_lambda: 0.1
2024-12-30 15:14:48,255 [trainer.py] => kl_weight: 0.001
2024-12-30 15:14:48,255 [trainer.py] => TIP_init: zero
2024-12-30 15:14:48,255 [trainer.py] => tuned_epoch: 20
2024-12-30 15:14:48,255 [trainer.py] => fs_epoch: 0
2024-12-30 15:14:48,255 [trainer.py] => init_lr: 0.01
2024-12-30 15:14:48,255 [trainer.py] => fs_lr: 0.001
2024-12-30 15:14:48,255 [trainer.py] => batch_size: 48
2024-12-30 15:14:48,255 [trainer.py] => fs_batch_size: 16
2024-12-30 15:14:48,255 [trainer.py] => weight_decay: 0.0005
2024-12-30 15:14:48,255 [trainer.py] => min_lr: 0
2024-12-30 15:14:48,255 [trainer.py] => optimizer: sgd
2024-12-30 15:14:48,255 [trainer.py] => memory_size: 0
2024-12-30 15:14:48,255 [trainer.py] => memory_per_class: 0
2024-12-30 15:14:48,255 [trainer.py] => fixed_memory: False
2024-12-30 15:14:48,255 [trainer.py] => shuffle: False
2024-12-30 15:14:48,256 [trainer.py] => top_k: 5
2024-12-30 15:14:48,256 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 15:14:48,256 [trainer.py] => prefix: asp
2024-12-30 15:14:48,256 [trainer.py] => model_prefix: asp
2024-12-30 15:14:49,750 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 15:14:56,000 [trainer.py] => All params: 173596160
2024-12-30 15:14:56,001 [trainer.py] => Trainable params: 1998848
2024-12-30 15:14:56,399 [asp.py] => Learning on 0-60
2024-12-30 15:14:56,539 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 15:15:39,422 [asp.py] => total parameters: 173642241
2024-12-30 15:15:39,423 [asp.py] => trainable parameters: 2044929
2024-12-30 15:20:11,168 [asp.py] => Task 0, Epoch 10 => Loss 0.545, Train_accy 88.88, Test_curr_accy 91.55, Test_accy 91.55
2024-12-30 15:28:52,253 [trainer.py] => config: ./exps/cifar.json
2024-12-30 15:28:52,253 [trainer.py] => model_name: asp
2024-12-30 15:28:52,253 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 15:28:52,253 [trainer.py] => device: [device(type='cuda', index=1)]
2024-12-30 15:28:52,253 [trainer.py] => seed: 2024
2024-12-30 15:28:52,253 [trainer.py] => dataset: cifar224
2024-12-30 15:28:52,253 [trainer.py] => init_cls: 60
2024-12-30 15:28:52,253 [trainer.py] => increment: 5
2024-12-30 15:28:52,253 [trainer.py] => kshot: 5
2024-12-30 15:28:52,253 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 15:28:52,253 [trainer.py] => z_dim: 1000
2024-12-30 15:28:52,253 [trainer.py] => conv_dim: 64
2024-12-30 15:28:52,253 [trainer.py] => img_size: 224
2024-12-30 15:28:52,253 [trainer.py] => generator_lr: 0.001
2024-12-30 15:28:52,253 [trainer.py] => pi: 100
2024-12-30 15:28:52,253 [trainer.py] => w_bn: 50.0
2024-12-30 15:28:52,253 [trainer.py] => w_noise: 0.001
2024-12-30 15:28:52,253 [trainer.py] => server_ss: 32
2024-12-30 15:28:52,254 [trainer.py] => bn_loss: 1
2024-12-30 15:28:52,254 [trainer.py] => noise: 1
2024-12-30 15:28:52,254 [trainer.py] => ie_loss: 1
2024-12-30 15:28:52,254 [trainer.py] => act_loss: 0
2024-12-30 15:28:52,254 [trainer.py] => w_ie: 1.0
2024-12-30 15:28:52,254 [trainer.py] => w_act: 0.1
2024-12-30 15:28:52,254 [trainer.py] => syn_size: 32
2024-12-30 15:28:52,254 [trainer.py] => vpt_type: Deep
2024-12-30 15:28:52,254 [trainer.py] => prompt_token_num: 6
2024-12-30 15:28:52,254 [trainer.py] => avg_alpha: 0.8
2024-12-30 15:28:52,254 [trainer.py] => perturb_var: 1
2024-12-30 15:28:52,254 [trainer.py] => EMA_beta: 0.99
2024-12-30 15:28:52,254 [trainer.py] => anchor_lambda: 0.1
2024-12-30 15:28:52,254 [trainer.py] => kl_weight: 0.001
2024-12-30 15:28:52,254 [trainer.py] => TIP_init: zero
2024-12-30 15:28:52,254 [trainer.py] => tuned_epoch: 20
2024-12-30 15:28:52,254 [trainer.py] => fs_epoch: 0
2024-12-30 15:28:52,254 [trainer.py] => init_lr: 0.01
2024-12-30 15:28:52,254 [trainer.py] => fs_lr: 0.001
2024-12-30 15:28:52,254 [trainer.py] => batch_size: 48
2024-12-30 15:28:52,254 [trainer.py] => fs_batch_size: 16
2024-12-30 15:28:52,254 [trainer.py] => weight_decay: 0.0005
2024-12-30 15:28:52,254 [trainer.py] => min_lr: 0
2024-12-30 15:28:52,254 [trainer.py] => optimizer: sgd
2024-12-30 15:28:52,254 [trainer.py] => memory_size: 0
2024-12-30 15:28:52,254 [trainer.py] => memory_per_class: 0
2024-12-30 15:28:52,254 [trainer.py] => fixed_memory: False
2024-12-30 15:28:52,254 [trainer.py] => shuffle: False
2024-12-30 15:28:52,254 [trainer.py] => top_k: 5
2024-12-30 15:28:52,254 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 15:28:52,255 [trainer.py] => prefix: asp
2024-12-30 15:28:52,255 [trainer.py] => model_prefix: asp
2024-12-30 15:28:53,759 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 15:29:00,026 [trainer.py] => All params: 173596160
2024-12-30 15:29:00,027 [trainer.py] => Trainable params: 1998848
2024-12-30 15:29:00,360 [asp.py] => Learning on 0-60
2024-12-30 15:29:00,450 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 15:29:43,048 [asp.py] => total parameters: 173642241
2024-12-30 15:29:43,049 [asp.py] => trainable parameters: 2044929
2024-12-30 15:30:19,294 [trainer.py] => config: ./exps/cifar.json
2024-12-30 15:30:19,294 [trainer.py] => model_name: asp
2024-12-30 15:30:19,294 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 15:30:19,294 [trainer.py] => device: [device(type='cuda', index=1)]
2024-12-30 15:30:19,294 [trainer.py] => seed: 2024
2024-12-30 15:30:19,295 [trainer.py] => dataset: cifar224
2024-12-30 15:30:19,295 [trainer.py] => init_cls: 60
2024-12-30 15:30:19,295 [trainer.py] => increment: 5
2024-12-30 15:30:19,295 [trainer.py] => kshot: 5
2024-12-30 15:30:19,295 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 15:30:19,295 [trainer.py] => z_dim: 1000
2024-12-30 15:30:19,295 [trainer.py] => conv_dim: 64
2024-12-30 15:30:19,295 [trainer.py] => img_size: 224
2024-12-30 15:30:19,295 [trainer.py] => generator_lr: 0.001
2024-12-30 15:30:19,295 [trainer.py] => pi: 100
2024-12-30 15:30:19,295 [trainer.py] => w_bn: 50.0
2024-12-30 15:30:19,295 [trainer.py] => w_noise: 0.001
2024-12-30 15:30:19,295 [trainer.py] => server_ss: 32
2024-12-30 15:30:19,295 [trainer.py] => bn_loss: 1
2024-12-30 15:30:19,295 [trainer.py] => noise: 1
2024-12-30 15:30:19,295 [trainer.py] => ie_loss: 1
2024-12-30 15:30:19,295 [trainer.py] => act_loss: 0
2024-12-30 15:30:19,295 [trainer.py] => w_ie: 1.0
2024-12-30 15:30:19,295 [trainer.py] => w_act: 0.1
2024-12-30 15:30:19,295 [trainer.py] => syn_size: 32
2024-12-30 15:30:19,295 [trainer.py] => vpt_type: Deep
2024-12-30 15:30:19,295 [trainer.py] => prompt_token_num: 6
2024-12-30 15:30:19,295 [trainer.py] => avg_alpha: 0.8
2024-12-30 15:30:19,295 [trainer.py] => perturb_var: 1
2024-12-30 15:30:19,295 [trainer.py] => EMA_beta: 0.99
2024-12-30 15:30:19,295 [trainer.py] => anchor_lambda: 0.1
2024-12-30 15:30:19,295 [trainer.py] => kl_weight: 0.001
2024-12-30 15:30:19,295 [trainer.py] => TIP_init: zero
2024-12-30 15:30:19,295 [trainer.py] => tuned_epoch: 20
2024-12-30 15:30:19,296 [trainer.py] => fs_epoch: 0
2024-12-30 15:30:19,296 [trainer.py] => init_lr: 0.01
2024-12-30 15:30:19,296 [trainer.py] => fs_lr: 0.001
2024-12-30 15:30:19,296 [trainer.py] => batch_size: 48
2024-12-30 15:30:19,296 [trainer.py] => fs_batch_size: 16
2024-12-30 15:30:19,296 [trainer.py] => weight_decay: 0.0005
2024-12-30 15:30:19,296 [trainer.py] => min_lr: 0
2024-12-30 15:30:19,296 [trainer.py] => optimizer: sgd
2024-12-30 15:30:19,296 [trainer.py] => memory_size: 0
2024-12-30 15:30:19,296 [trainer.py] => memory_per_class: 0
2024-12-30 15:30:19,296 [trainer.py] => fixed_memory: False
2024-12-30 15:30:19,296 [trainer.py] => shuffle: False
2024-12-30 15:30:19,296 [trainer.py] => top_k: 5
2024-12-30 15:30:19,296 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 15:30:19,296 [trainer.py] => prefix: asp
2024-12-30 15:30:19,296 [trainer.py] => model_prefix: asp
2024-12-30 15:30:20,818 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 15:30:27,317 [trainer.py] => All params: 173596160
2024-12-30 15:30:27,318 [trainer.py] => Trainable params: 1998848
2024-12-30 15:30:27,627 [asp.py] => Learning on 0-60
2024-12-30 15:30:27,738 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 15:31:11,275 [asp.py] => total parameters: 173642241
2024-12-30 15:31:11,276 [asp.py] => trainable parameters: 2044929
2024-12-30 15:41:40,734 [asp.py] => Task 0, Epoch 11 => Loss 0.491, Train_accy 89.06, Test_curr_accy 92.93, Test_accy 92.93
2024-12-30 15:49:30,846 [asp.py] => Task 0, Epoch 1 => Loss 2.303, Train_accy 62.71, Test_curr_accy 88.92, Test_accy 88.92
2024-12-30 15:58:45,542 [asp.py] => Task 0, Epoch 12 => Loss 0.530, Train_accy 88.71, Test_curr_accy 81.85, Test_accy 81.85
2024-12-30 16:07:56,132 [asp.py] => Task 0, Epoch 2 => Loss 0.690, Train_accy 86.45, Test_curr_accy 90.57, Test_accy 90.57
2024-12-30 16:15:50,401 [asp.py] => Task 0, Epoch 13 => Loss 0.511, Train_accy 88.91, Test_curr_accy 92.37, Test_accy 92.37
2024-12-30 16:26:21,031 [asp.py] => Task 0, Epoch 3 => Loss 0.617, Train_accy 87.27, Test_curr_accy 91.50, Test_accy 91.50
2024-12-30 16:32:55,043 [asp.py] => Task 0, Epoch 14 => Loss 0.568, Train_accy 89.24, Test_curr_accy 81.63, Test_accy 81.63
2024-12-30 16:44:49,384 [asp.py] => Task 0, Epoch 4 => Loss 0.532, Train_accy 88.43, Test_curr_accy 89.75, Test_accy 89.75
2024-12-30 16:49:59,315 [asp.py] => Task 0, Epoch 15 => Loss 0.476, Train_accy 89.38, Test_curr_accy 90.98, Test_accy 90.98
2024-12-30 17:03:13,965 [asp.py] => Task 0, Epoch 5 => Loss 0.544, Train_accy 88.22, Test_curr_accy 79.87, Test_accy 79.87
2024-12-30 17:07:03,705 [asp.py] => Task 0, Epoch 16 => Loss 0.458, Train_accy 89.35, Test_curr_accy 82.68, Test_accy 82.68
2024-12-30 17:21:36,646 [asp.py] => Task 0, Epoch 6 => Loss 0.510, Train_accy 88.61, Test_curr_accy 91.47, Test_accy 91.47
2024-12-30 17:24:08,176 [asp.py] => Task 0, Epoch 17 => Loss 0.467, Train_accy 89.31, Test_curr_accy 91.78, Test_accy 91.78
2024-12-30 17:39:57,882 [asp.py] => Task 0, Epoch 7 => Loss 0.490, Train_accy 88.90, Test_curr_accy 84.25, Test_accy 84.25
2024-12-30 17:41:09,059 [trainer.py] => config: ./exps/cifar.json
2024-12-30 17:41:09,059 [trainer.py] => model_name: asp
2024-12-30 17:41:09,059 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 17:41:09,059 [trainer.py] => device: [device(type='cuda', index=1)]
2024-12-30 17:41:09,059 [trainer.py] => seed: 2024
2024-12-30 17:41:09,059 [trainer.py] => dataset: cifar224
2024-12-30 17:41:09,059 [trainer.py] => init_cls: 60
2024-12-30 17:41:09,059 [trainer.py] => increment: 5
2024-12-30 17:41:09,059 [trainer.py] => kshot: 5
2024-12-30 17:41:09,059 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 17:41:09,059 [trainer.py] => z_dim: 1000
2024-12-30 17:41:09,059 [trainer.py] => conv_dim: 64
2024-12-30 17:41:09,059 [trainer.py] => img_size: 224
2024-12-30 17:41:09,059 [trainer.py] => generator_lr: 0.001
2024-12-30 17:41:09,059 [trainer.py] => pi: 100
2024-12-30 17:41:09,059 [trainer.py] => w_bn: 50.0
2024-12-30 17:41:09,059 [trainer.py] => w_noise: 0.001
2024-12-30 17:41:09,059 [trainer.py] => server_ss: 32
2024-12-30 17:41:09,060 [trainer.py] => bn_loss: 1
2024-12-30 17:41:09,060 [trainer.py] => noise: 1
2024-12-30 17:41:09,060 [trainer.py] => ie_loss: 1
2024-12-30 17:41:09,060 [trainer.py] => act_loss: 0
2024-12-30 17:41:09,060 [trainer.py] => w_ie: 1.0
2024-12-30 17:41:09,060 [trainer.py] => w_act: 0.1
2024-12-30 17:41:09,060 [trainer.py] => syn_size: 32
2024-12-30 17:41:09,060 [trainer.py] => vpt_type: Deep
2024-12-30 17:41:09,060 [trainer.py] => prompt_token_num: 6
2024-12-30 17:41:09,060 [trainer.py] => avg_alpha: 0.8
2024-12-30 17:41:09,060 [trainer.py] => perturb_var: 1
2024-12-30 17:41:09,060 [trainer.py] => EMA_beta: 0.99
2024-12-30 17:41:09,060 [trainer.py] => anchor_lambda: 0.1
2024-12-30 17:41:09,060 [trainer.py] => kl_weight: 0.001
2024-12-30 17:41:09,060 [trainer.py] => TIP_init: zero
2024-12-30 17:41:09,060 [trainer.py] => tuned_epoch: 20
2024-12-30 17:41:09,060 [trainer.py] => fs_epoch: 0
2024-12-30 17:41:09,060 [trainer.py] => init_lr: 0.01
2024-12-30 17:41:09,060 [trainer.py] => fs_lr: 0.001
2024-12-30 17:41:09,060 [trainer.py] => batch_size: 48
2024-12-30 17:41:09,060 [trainer.py] => fs_batch_size: 16
2024-12-30 17:41:09,060 [trainer.py] => weight_decay: 0.0005
2024-12-30 17:41:09,060 [trainer.py] => min_lr: 0
2024-12-30 17:41:09,060 [trainer.py] => optimizer: sgd
2024-12-30 17:41:09,060 [trainer.py] => memory_size: 0
2024-12-30 17:41:09,060 [trainer.py] => memory_per_class: 0
2024-12-30 17:41:09,060 [trainer.py] => fixed_memory: False
2024-12-30 17:41:09,060 [trainer.py] => shuffle: False
2024-12-30 17:41:09,061 [trainer.py] => top_k: 5
2024-12-30 17:41:09,061 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 17:41:09,061 [trainer.py] => prefix: asp
2024-12-30 17:41:09,061 [trainer.py] => model_prefix: asp
2024-12-30 17:41:10,843 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 17:41:12,456 [asp.py] => Task 0, Epoch 18 => Loss 0.466, Train_accy 89.05, Test_curr_accy 90.50, Test_accy 90.50
2024-12-30 17:41:18,138 [trainer.py] => All params: 173596160
2024-12-30 17:41:18,139 [trainer.py] => Trainable params: 1998848
2024-12-30 17:41:18,562 [asp.py] => Learning on 0-60
2024-12-30 17:41:18,645 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 17:41:45,649 [trainer.py] => config: ./exps/cifar.json
2024-12-30 17:41:45,649 [trainer.py] => model_name: asp
2024-12-30 17:41:45,649 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 17:41:45,649 [trainer.py] => device: [device(type='cuda', index=1)]
2024-12-30 17:41:45,649 [trainer.py] => seed: 2024
2024-12-30 17:41:45,649 [trainer.py] => dataset: cifar224
2024-12-30 17:41:45,649 [trainer.py] => init_cls: 60
2024-12-30 17:41:45,649 [trainer.py] => increment: 5
2024-12-30 17:41:45,649 [trainer.py] => kshot: 5
2024-12-30 17:41:45,649 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 17:41:45,649 [trainer.py] => z_dim: 1000
2024-12-30 17:41:45,649 [trainer.py] => conv_dim: 64
2024-12-30 17:41:45,649 [trainer.py] => img_size: 224
2024-12-30 17:41:45,649 [trainer.py] => generator_lr: 0.001
2024-12-30 17:41:45,649 [trainer.py] => pi: 100
2024-12-30 17:41:45,649 [trainer.py] => w_bn: 50.0
2024-12-30 17:41:45,649 [trainer.py] => w_noise: 0.001
2024-12-30 17:41:45,649 [trainer.py] => server_ss: 32
2024-12-30 17:41:45,649 [trainer.py] => bn_loss: 1
2024-12-30 17:41:45,649 [trainer.py] => noise: 1
2024-12-30 17:41:45,649 [trainer.py] => ie_loss: 1
2024-12-30 17:41:45,650 [trainer.py] => act_loss: 0
2024-12-30 17:41:45,650 [trainer.py] => w_ie: 1.0
2024-12-30 17:41:45,650 [trainer.py] => w_act: 0.1
2024-12-30 17:41:45,650 [trainer.py] => syn_size: 32
2024-12-30 17:41:45,650 [trainer.py] => vpt_type: Deep
2024-12-30 17:41:45,650 [trainer.py] => prompt_token_num: 6
2024-12-30 17:41:45,650 [trainer.py] => avg_alpha: 0.8
2024-12-30 17:41:45,650 [trainer.py] => perturb_var: 1
2024-12-30 17:41:45,650 [trainer.py] => EMA_beta: 0.99
2024-12-30 17:41:45,650 [trainer.py] => anchor_lambda: 0.1
2024-12-30 17:41:45,650 [trainer.py] => kl_weight: 0.001
2024-12-30 17:41:45,650 [trainer.py] => TIP_init: zero
2024-12-30 17:41:45,650 [trainer.py] => tuned_epoch: 20
2024-12-30 17:41:45,650 [trainer.py] => fs_epoch: 0
2024-12-30 17:41:45,650 [trainer.py] => init_lr: 0.01
2024-12-30 17:41:45,650 [trainer.py] => fs_lr: 0.001
2024-12-30 17:41:45,650 [trainer.py] => batch_size: 48
2024-12-30 17:41:45,650 [trainer.py] => fs_batch_size: 16
2024-12-30 17:41:45,650 [trainer.py] => weight_decay: 0.0005
2024-12-30 17:41:45,650 [trainer.py] => min_lr: 0
2024-12-30 17:41:45,650 [trainer.py] => optimizer: sgd
2024-12-30 17:41:45,650 [trainer.py] => memory_size: 0
2024-12-30 17:41:45,650 [trainer.py] => memory_per_class: 0
2024-12-30 17:41:45,650 [trainer.py] => fixed_memory: False
2024-12-30 17:41:45,650 [trainer.py] => shuffle: False
2024-12-30 17:41:45,650 [trainer.py] => top_k: 5
2024-12-30 17:41:45,650 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 17:41:45,650 [trainer.py] => prefix: asp
2024-12-30 17:41:45,650 [trainer.py] => model_prefix: asp
2024-12-30 17:41:47,150 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 17:41:54,144 [trainer.py] => All params: 173596160
2024-12-30 17:41:54,145 [trainer.py] => Trainable params: 1998848
2024-12-30 17:41:54,541 [asp.py] => Learning on 0-60
2024-12-30 17:41:54,628 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 17:42:17,421 [trainer.py] => config: ./exps/cifar.json
2024-12-30 17:42:17,421 [trainer.py] => model_name: asp
2024-12-30 17:42:17,421 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 17:42:17,422 [trainer.py] => device: [device(type='cuda', index=1)]
2024-12-30 17:42:17,422 [trainer.py] => seed: 2024
2024-12-30 17:42:17,422 [trainer.py] => dataset: cifar224
2024-12-30 17:42:17,422 [trainer.py] => init_cls: 60
2024-12-30 17:42:17,422 [trainer.py] => increment: 5
2024-12-30 17:42:17,422 [trainer.py] => kshot: 5
2024-12-30 17:42:17,422 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 17:42:17,422 [trainer.py] => z_dim: 1000
2024-12-30 17:42:17,422 [trainer.py] => conv_dim: 64
2024-12-30 17:42:17,422 [trainer.py] => img_size: 224
2024-12-30 17:42:17,422 [trainer.py] => generator_lr: 0.001
2024-12-30 17:42:17,422 [trainer.py] => pi: 100
2024-12-30 17:42:17,422 [trainer.py] => w_bn: 50.0
2024-12-30 17:42:17,422 [trainer.py] => w_noise: 0.001
2024-12-30 17:42:17,422 [trainer.py] => server_ss: 32
2024-12-30 17:42:17,422 [trainer.py] => bn_loss: 1
2024-12-30 17:42:17,422 [trainer.py] => noise: 1
2024-12-30 17:42:17,422 [trainer.py] => ie_loss: 1
2024-12-30 17:42:17,422 [trainer.py] => act_loss: 0
2024-12-30 17:42:17,422 [trainer.py] => w_ie: 1.0
2024-12-30 17:42:17,422 [trainer.py] => w_act: 0.1
2024-12-30 17:42:17,422 [trainer.py] => syn_size: 32
2024-12-30 17:42:17,422 [trainer.py] => vpt_type: Deep
2024-12-30 17:42:17,422 [trainer.py] => prompt_token_num: 6
2024-12-30 17:42:17,422 [trainer.py] => avg_alpha: 0.8
2024-12-30 17:42:17,422 [trainer.py] => perturb_var: 1
2024-12-30 17:42:17,422 [trainer.py] => EMA_beta: 0.99
2024-12-30 17:42:17,422 [trainer.py] => anchor_lambda: 0.1
2024-12-30 17:42:17,422 [trainer.py] => kl_weight: 0.001
2024-12-30 17:42:17,422 [trainer.py] => TIP_init: zero
2024-12-30 17:42:17,422 [trainer.py] => tuned_epoch: 20
2024-12-30 17:42:17,423 [trainer.py] => fs_epoch: 0
2024-12-30 17:42:17,423 [trainer.py] => init_lr: 0.01
2024-12-30 17:42:17,423 [trainer.py] => fs_lr: 0.001
2024-12-30 17:42:17,423 [trainer.py] => batch_size: 48
2024-12-30 17:42:17,423 [trainer.py] => fs_batch_size: 16
2024-12-30 17:42:17,423 [trainer.py] => weight_decay: 0.0005
2024-12-30 17:42:17,423 [trainer.py] => min_lr: 0
2024-12-30 17:42:17,423 [trainer.py] => optimizer: sgd
2024-12-30 17:42:17,423 [trainer.py] => memory_size: 0
2024-12-30 17:42:17,423 [trainer.py] => memory_per_class: 0
2024-12-30 17:42:17,423 [trainer.py] => fixed_memory: False
2024-12-30 17:42:17,423 [trainer.py] => shuffle: False
2024-12-30 17:42:17,423 [trainer.py] => top_k: 5
2024-12-30 17:42:17,423 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_20_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 17:42:17,423 [trainer.py] => prefix: asp
2024-12-30 17:42:17,423 [trainer.py] => model_prefix: asp
2024-12-30 17:42:18,867 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 17:42:25,823 [trainer.py] => All params: 173596160
2024-12-30 17:42:25,824 [trainer.py] => Trainable params: 1998848
2024-12-30 17:42:26,218 [asp.py] => Learning on 0-60
2024-12-30 17:42:26,326 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 17:42:26,839 [asp.py] => total parameters: 173642241
2024-12-30 17:42:26,840 [asp.py] => trainable parameters: 2044929
2024-12-30 17:58:17,046 [asp.py] => Task 0, Epoch 19 => Loss 0.507, Train_accy 88.38, Test_curr_accy 92.28, Test_accy 92.28
2024-12-30 18:08:54,541 [asp.py] => Task 0, Epoch 1 => Loss 3.842, Train_accy 25.77, Test_curr_accy 87.03, Test_accy 87.03
2024-12-30 18:15:20,708 [asp.py] => Task 0, Epoch 20 => Loss 0.493, Train_accy 88.28, Test_curr_accy 82.65, Test_accy 82.65
2024-12-30 18:17:30,984 [asp.py] => Task 0, Epoch 8 => Loss 0.482, Train_accy 89.08, Test_curr_accy 84.52, Test_accy 84.52
2024-12-30 18:19:41,072 [trainer.py] => Top1 curve: [83.57]
2024-12-30 18:19:41,072 [trainer.py] => Average Accuracy (Top1): 83.57   (Harmonic Accuracy): None (Old Acc): 83.56666666666666 (New Acc): [] 

2024-12-30 18:19:41,073 [trainer.py] => All params: 173642241
2024-12-30 18:19:41,074 [trainer.py] => Trainable params: 2044929
2024-12-30 18:19:41,075 [asp.py] => Learning on 60-65
2024-12-30 18:19:41,110 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 18:20:21,027 [asp.py] => total parameters: 173646081
2024-12-30 18:20:21,027 [asp.py] => trainable parameters: 2048769
2024-12-30 18:20:52,724 [trainer.py] => Top1 curve: [83.57, 82.6]
2024-12-30 18:20:52,725 [trainer.py] => Average Accuracy (Top1): 83.085   (Harmonic Accuracy): 76.33014084507042 (Old Acc): 83.63333333333334 (New Acc): 70.2 

2024-12-30 18:20:52,726 [trainer.py] => All params: 173646081
2024-12-30 18:20:52,727 [trainer.py] => Trainable params: 2048769
2024-12-30 18:20:52,729 [asp.py] => Learning on 65-70
2024-12-30 18:20:52,751 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 18:21:33,456 [asp.py] => total parameters: 173649921
2024-12-30 18:21:33,457 [asp.py] => trainable parameters: 2052609
2024-12-30 18:22:07,036 [trainer.py] => Top1 curve: [83.57, 82.6, 82.06]
2024-12-30 18:22:07,036 [trainer.py] => Average Accuracy (Top1): 82.74333333333333   (Harmonic Accuracy): 77.47530217135521 (Old Acc): 83.71666666666665 (New Acc): 72.1 

2024-12-30 18:22:07,038 [trainer.py] => All params: 173649921
2024-12-30 18:22:07,039 [trainer.py] => Trainable params: 2052609
2024-12-30 18:22:07,040 [asp.py] => Learning on 70-75
2024-12-30 18:22:07,058 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 18:22:48,479 [asp.py] => total parameters: 173653761
2024-12-30 18:22:48,480 [asp.py] => trainable parameters: 2056449
2024-12-30 18:23:24,241 [trainer.py] => Top1 curve: [83.57, 82.6, 82.06, 79.8]
2024-12-30 18:23:24,242 [trainer.py] => Average Accuracy (Top1): 82.0075   (Harmonic Accuracy): 74.28294126350052 (Old Acc): 82.93333333333332 (New Acc): 67.26666666666667 

2024-12-30 18:23:24,244 [trainer.py] => All params: 173653761
2024-12-30 18:23:24,245 [trainer.py] => Trainable params: 2056449
2024-12-30 18:23:24,246 [asp.py] => Learning on 75-80
2024-12-30 18:23:24,267 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 18:24:05,750 [asp.py] => total parameters: 173657601
2024-12-30 18:24:05,751 [asp.py] => trainable parameters: 2060289
2024-12-30 18:24:43,977 [trainer.py] => Top1 curve: [83.57, 82.6, 82.06, 79.8, 80.24]
2024-12-30 18:24:43,978 [trainer.py] => Average Accuracy (Top1): 81.654   (Harmonic Accuracy): 76.90796250404051 (Old Acc): 83.13333333333333 (New Acc): 71.55 

2024-12-30 18:24:43,979 [trainer.py] => All params: 173657601
2024-12-30 18:24:43,980 [trainer.py] => Trainable params: 2060289
2024-12-30 18:24:43,981 [asp.py] => Learning on 80-85
2024-12-30 18:24:43,996 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 18:25:25,372 [asp.py] => total parameters: 173661441
2024-12-30 18:25:25,372 [asp.py] => trainable parameters: 2064129
2024-12-30 18:26:05,939 [trainer.py] => Top1 curve: [83.57, 82.6, 82.06, 79.8, 80.24, 78.34]
2024-12-30 18:26:05,939 [trainer.py] => Average Accuracy (Top1): 81.10166666666667   (Harmonic Accuracy): 74.62995442679527 (Old Acc): 82.63333333333333 (New Acc): 68.03999999999999 

2024-12-30 18:26:05,940 [trainer.py] => All params: 173661441
2024-12-30 18:26:05,941 [trainer.py] => Trainable params: 2064129
2024-12-30 18:26:05,942 [asp.py] => Learning on 85-90
2024-12-30 18:26:05,962 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 18:26:47,456 [asp.py] => total parameters: 173665281
2024-12-30 18:26:47,456 [asp.py] => trainable parameters: 2067969
2024-12-30 18:27:30,281 [trainer.py] => Top1 curve: [83.57, 82.6, 82.06, 79.8, 80.24, 78.34, 77.62]
2024-12-30 18:27:30,282 [trainer.py] => Average Accuracy (Top1): 80.60428571428572   (Harmonic Accuracy): 74.52426323953026 (Old Acc): 82.43333333333332 (New Acc): 68.00000000000001 

2024-12-30 18:27:30,283 [trainer.py] => All params: 173665281
2024-12-30 18:27:30,285 [trainer.py] => Trainable params: 2067969
2024-12-30 18:27:30,286 [asp.py] => Learning on 90-95
2024-12-30 18:27:30,303 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 18:28:11,639 [asp.py] => total parameters: 173669121
2024-12-30 18:28:11,640 [asp.py] => trainable parameters: 2071809
2024-12-30 18:28:57,040 [trainer.py] => Top1 curve: [83.57, 82.6, 82.06, 79.8, 80.24, 78.34, 77.62, 76.92]
2024-12-30 18:28:57,041 [trainer.py] => Average Accuracy (Top1): 80.14375   (Harmonic Accuracy): 74.26000254032769 (Old Acc): 82.33333333333333 (New Acc): 67.62857142857142 

2024-12-30 18:28:57,042 [trainer.py] => All params: 173669121
2024-12-30 18:28:57,043 [trainer.py] => Trainable params: 2071809
2024-12-30 18:28:57,045 [asp.py] => Learning on 95-100
2024-12-30 18:28:57,064 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 18:36:39,196 [asp.py] => Task 0, Epoch 2 => Loss 1.069, Train_accy 77.25, Test_curr_accy 90.87, Test_accy 90.87
2024-12-30 18:48:57,998 [trainer.py] => config: ./exps/cifar.json
2024-12-30 18:48:57,998 [trainer.py] => model_name: asp
2024-12-30 18:48:57,998 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 18:48:57,998 [trainer.py] => device: [device(type='cuda', index=1)]
2024-12-30 18:48:57,998 [trainer.py] => seed: 2024
2024-12-30 18:48:57,998 [trainer.py] => dataset: cifar224
2024-12-30 18:48:57,998 [trainer.py] => init_cls: 60
2024-12-30 18:48:57,998 [trainer.py] => increment: 5
2024-12-30 18:48:57,998 [trainer.py] => kshot: 5
2024-12-30 18:48:57,998 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 18:48:57,998 [trainer.py] => z_dim: 1000
2024-12-30 18:48:57,998 [trainer.py] => conv_dim: 64
2024-12-30 18:48:57,998 [trainer.py] => img_size: 224
2024-12-30 18:48:57,998 [trainer.py] => generator_lr: 0.001
2024-12-30 18:48:57,998 [trainer.py] => pi: 100
2024-12-30 18:48:57,998 [trainer.py] => w_bn: 50.0
2024-12-30 18:48:57,998 [trainer.py] => w_noise: 0.001
2024-12-30 18:48:57,998 [trainer.py] => server_ss: 32
2024-12-30 18:48:57,998 [trainer.py] => bn_loss: 1
2024-12-30 18:48:57,998 [trainer.py] => noise: 1
2024-12-30 18:48:57,998 [trainer.py] => ie_loss: 1
2024-12-30 18:48:57,998 [trainer.py] => act_loss: 0
2024-12-30 18:48:57,999 [trainer.py] => w_ie: 1.0
2024-12-30 18:48:57,999 [trainer.py] => w_act: 0.1
2024-12-30 18:48:57,999 [trainer.py] => syn_size: 32
2024-12-30 18:48:57,999 [trainer.py] => vpt_type: Deep
2024-12-30 18:48:57,999 [trainer.py] => prompt_token_num: 6
2024-12-30 18:48:57,999 [trainer.py] => avg_alpha: 0.8
2024-12-30 18:48:57,999 [trainer.py] => perturb_var: 1
2024-12-30 18:48:57,999 [trainer.py] => EMA_beta: 0.99
2024-12-30 18:48:57,999 [trainer.py] => anchor_lambda: 0.1
2024-12-30 18:48:57,999 [trainer.py] => kl_weight: 0.001
2024-12-30 18:48:57,999 [trainer.py] => TIP_init: zero
2024-12-30 18:48:57,999 [trainer.py] => tuned_epoch: 10
2024-12-30 18:48:57,999 [trainer.py] => fs_epoch: 0
2024-12-30 18:48:57,999 [trainer.py] => init_lr: 0.01
2024-12-30 18:48:57,999 [trainer.py] => fs_lr: 0.001
2024-12-30 18:48:57,999 [trainer.py] => batch_size: 48
2024-12-30 18:48:57,999 [trainer.py] => fs_batch_size: 16
2024-12-30 18:48:57,999 [trainer.py] => weight_decay: 0.0005
2024-12-30 18:48:57,999 [trainer.py] => min_lr: 0
2024-12-30 18:48:57,999 [trainer.py] => optimizer: sgd
2024-12-30 18:48:57,999 [trainer.py] => memory_size: 0
2024-12-30 18:48:57,999 [trainer.py] => memory_per_class: 0
2024-12-30 18:48:57,999 [trainer.py] => fixed_memory: False
2024-12-30 18:48:57,999 [trainer.py] => shuffle: False
2024-12-30 18:48:57,999 [trainer.py] => top_k: 5
2024-12-30 18:48:57,999 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 18:48:57,999 [trainer.py] => prefix: asp
2024-12-30 18:48:57,999 [trainer.py] => model_prefix: asp
2024-12-30 18:48:59,496 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 18:49:05,893 [trainer.py] => All params: 173596160
2024-12-30 18:49:05,894 [trainer.py] => Trainable params: 1998848
2024-12-30 18:49:06,304 [asp.py] => Learning on 0-60
2024-12-30 18:49:06,410 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 18:49:07,020 [asp.py] => total parameters: 173642241
2024-12-30 18:49:07,021 [asp.py] => trainable parameters: 2044929
2024-12-30 18:49:25,512 [trainer.py] => config: ./exps/cifar.json
2024-12-30 18:49:25,512 [trainer.py] => model_name: asp
2024-12-30 18:49:25,512 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 18:49:25,512 [trainer.py] => device: [device(type='cuda', index=2)]
2024-12-30 18:49:25,512 [trainer.py] => seed: 2024
2024-12-30 18:49:25,513 [trainer.py] => dataset: cifar224
2024-12-30 18:49:25,513 [trainer.py] => init_cls: 60
2024-12-30 18:49:25,513 [trainer.py] => increment: 5
2024-12-30 18:49:25,513 [trainer.py] => kshot: 5
2024-12-30 18:49:25,513 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 18:49:25,513 [trainer.py] => z_dim: 1000
2024-12-30 18:49:25,513 [trainer.py] => conv_dim: 64
2024-12-30 18:49:25,513 [trainer.py] => img_size: 224
2024-12-30 18:49:25,513 [trainer.py] => generator_lr: 0.001
2024-12-30 18:49:25,513 [trainer.py] => pi: 100
2024-12-30 18:49:25,513 [trainer.py] => w_bn: 50.0
2024-12-30 18:49:25,513 [trainer.py] => w_noise: 0.001
2024-12-30 18:49:25,513 [trainer.py] => server_ss: 32
2024-12-30 18:49:25,513 [trainer.py] => bn_loss: 1
2024-12-30 18:49:25,513 [trainer.py] => noise: 1
2024-12-30 18:49:25,513 [trainer.py] => ie_loss: 1
2024-12-30 18:49:25,513 [trainer.py] => act_loss: 0
2024-12-30 18:49:25,513 [trainer.py] => w_ie: 1.0
2024-12-30 18:49:25,513 [trainer.py] => w_act: 0.1
2024-12-30 18:49:25,513 [trainer.py] => syn_size: 32
2024-12-30 18:49:25,513 [trainer.py] => vpt_type: Deep
2024-12-30 18:49:25,513 [trainer.py] => prompt_token_num: 6
2024-12-30 18:49:25,513 [trainer.py] => avg_alpha: 0.8
2024-12-30 18:49:25,513 [trainer.py] => perturb_var: 1
2024-12-30 18:49:25,513 [trainer.py] => EMA_beta: 0.99
2024-12-30 18:49:25,514 [trainer.py] => anchor_lambda: 0.1
2024-12-30 18:49:25,514 [trainer.py] => kl_weight: 0.001
2024-12-30 18:49:25,514 [trainer.py] => TIP_init: zero
2024-12-30 18:49:25,514 [trainer.py] => tuned_epoch: 10
2024-12-30 18:49:25,514 [trainer.py] => fs_epoch: 0
2024-12-30 18:49:25,514 [trainer.py] => init_lr: 0.01
2024-12-30 18:49:25,514 [trainer.py] => fs_lr: 0.001
2024-12-30 18:49:25,514 [trainer.py] => batch_size: 48
2024-12-30 18:49:25,514 [trainer.py] => fs_batch_size: 16
2024-12-30 18:49:25,514 [trainer.py] => weight_decay: 0.0005
2024-12-30 18:49:25,514 [trainer.py] => min_lr: 0
2024-12-30 18:49:25,514 [trainer.py] => optimizer: sgd
2024-12-30 18:49:25,514 [trainer.py] => memory_size: 0
2024-12-30 18:49:25,514 [trainer.py] => memory_per_class: 0
2024-12-30 18:49:25,514 [trainer.py] => fixed_memory: False
2024-12-30 18:49:25,514 [trainer.py] => shuffle: False
2024-12-30 18:49:25,514 [trainer.py] => top_k: 5
2024-12-30 18:49:25,514 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 18:49:25,514 [trainer.py] => prefix: asp
2024-12-30 18:49:25,514 [trainer.py] => model_prefix: asp
2024-12-30 18:49:27,287 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 18:49:33,889 [trainer.py] => All params: 173596160
2024-12-30 18:49:33,890 [trainer.py] => Trainable params: 1998848
2024-12-30 18:49:34,191 [asp.py] => Learning on 0-60
2024-12-30 18:49:34,295 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 18:49:34,389 [asp.py] => total parameters: 173642241
2024-12-30 18:49:34,389 [asp.py] => trainable parameters: 2044929
2024-12-30 18:50:14,672 [trainer.py] => config: ./exps/cifar.json
2024-12-30 18:50:14,672 [trainer.py] => model_name: asp
2024-12-30 18:50:14,672 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 18:50:14,672 [trainer.py] => device: [device(type='cuda', index=0)]
2024-12-30 18:50:14,672 [trainer.py] => seed: 2024
2024-12-30 18:50:14,672 [trainer.py] => dataset: cifar224
2024-12-30 18:50:14,672 [trainer.py] => init_cls: 60
2024-12-30 18:50:14,672 [trainer.py] => increment: 5
2024-12-30 18:50:14,672 [trainer.py] => kshot: 5
2024-12-30 18:50:14,672 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 18:50:14,672 [trainer.py] => z_dim: 1000
2024-12-30 18:50:14,672 [trainer.py] => conv_dim: 64
2024-12-30 18:50:14,672 [trainer.py] => img_size: 224
2024-12-30 18:50:14,672 [trainer.py] => generator_lr: 0.001
2024-12-30 18:50:14,672 [trainer.py] => pi: 100
2024-12-30 18:50:14,672 [trainer.py] => w_bn: 50.0
2024-12-30 18:50:14,672 [trainer.py] => w_noise: 0.001
2024-12-30 18:50:14,673 [trainer.py] => server_ss: 32
2024-12-30 18:50:14,673 [trainer.py] => bn_loss: 1
2024-12-30 18:50:14,673 [trainer.py] => noise: 1
2024-12-30 18:50:14,673 [trainer.py] => ie_loss: 1
2024-12-30 18:50:14,673 [trainer.py] => act_loss: 0
2024-12-30 18:50:14,673 [trainer.py] => w_ie: 1.0
2024-12-30 18:50:14,673 [trainer.py] => w_act: 0.1
2024-12-30 18:50:14,673 [trainer.py] => syn_size: 32
2024-12-30 18:50:14,673 [trainer.py] => vpt_type: Deep
2024-12-30 18:50:14,673 [trainer.py] => prompt_token_num: 6
2024-12-30 18:50:14,673 [trainer.py] => avg_alpha: 0.8
2024-12-30 18:50:14,673 [trainer.py] => perturb_var: 1
2024-12-30 18:50:14,673 [trainer.py] => EMA_beta: 0.99
2024-12-30 18:50:14,673 [trainer.py] => anchor_lambda: 0.1
2024-12-30 18:50:14,673 [trainer.py] => kl_weight: 0.001
2024-12-30 18:50:14,673 [trainer.py] => TIP_init: zero
2024-12-30 18:50:14,673 [trainer.py] => tuned_epoch: 10
2024-12-30 18:50:14,673 [trainer.py] => fs_epoch: 0
2024-12-30 18:50:14,673 [trainer.py] => init_lr: 0.01
2024-12-30 18:50:14,673 [trainer.py] => fs_lr: 0.001
2024-12-30 18:50:14,673 [trainer.py] => batch_size: 48
2024-12-30 18:50:14,673 [trainer.py] => fs_batch_size: 16
2024-12-30 18:50:14,673 [trainer.py] => weight_decay: 0.0005
2024-12-30 18:50:14,673 [trainer.py] => min_lr: 0
2024-12-30 18:50:14,674 [trainer.py] => optimizer: sgd
2024-12-30 18:50:14,674 [trainer.py] => memory_size: 0
2024-12-30 18:50:14,674 [trainer.py] => memory_per_class: 0
2024-12-30 18:50:14,674 [trainer.py] => fixed_memory: False
2024-12-30 18:50:14,674 [trainer.py] => shuffle: False
2024-12-30 18:50:14,674 [trainer.py] => top_k: 5
2024-12-30 18:50:14,674 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 18:50:14,674 [trainer.py] => prefix: asp
2024-12-30 18:50:14,674 [trainer.py] => model_prefix: asp
2024-12-30 18:50:16,410 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 18:50:16,795 [asp.py] => Task 0, Epoch 9 => Loss 0.479, Train_accy 89.01, Test_curr_accy 88.27, Test_accy 88.27
2024-12-30 18:50:23,860 [trainer.py] => All params: 173596160
2024-12-30 18:50:23,861 [trainer.py] => Trainable params: 1998848
2024-12-30 18:50:24,173 [asp.py] => Learning on 0-60
2024-12-30 18:50:24,299 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 18:50:24,561 [asp.py] => total parameters: 173642241
2024-12-30 18:50:24,563 [asp.py] => trainable parameters: 2044929
2024-12-30 19:01:22,459 [asp.py] => Task 0, Epoch 1 => Loss 3.678, Train_accy 30.48, Test_curr_accy 88.47, Test_accy 88.47
2024-12-30 19:02:18,060 [asp.py] => Task 0, Epoch 1 => Loss 3.591, Train_accy 32.37, Test_curr_accy 88.93, Test_accy 88.93
2024-12-30 19:08:38,887 [asp.py] => Task 0, Epoch 10 => Loss 0.469, Train_accy 89.31, Test_curr_accy 88.73, Test_accy 88.73
2024-12-30 19:13:21,128 [asp.py] => Task 0, Epoch 2 => Loss 1.042, Train_accy 77.59, Test_curr_accy 90.92, Test_accy 90.92
2024-12-30 19:14:31,050 [asp.py] => Task 0, Epoch 2 => Loss 1.021, Train_accy 78.22, Test_curr_accy 91.42, Test_accy 91.42
2024-12-30 19:25:23,289 [asp.py] => Task 0, Epoch 3 => Loss 0.866, Train_accy 79.82, Test_curr_accy 91.93, Test_accy 91.93
2024-12-30 19:26:38,397 [asp.py] => Task 0, Epoch 3 => Loss 0.863, Train_accy 80.23, Test_curr_accy 92.10, Test_accy 92.10
2024-12-30 19:27:04,378 [asp.py] => Task 0, Epoch 11 => Loss 0.459, Train_accy 89.31, Test_curr_accy 90.38, Test_accy 90.38
2024-12-30 19:37:25,689 [asp.py] => Task 0, Epoch 4 => Loss 0.812, Train_accy 80.97, Test_curr_accy 92.00, Test_accy 92.00
2024-12-30 19:38:48,005 [asp.py] => Task 0, Epoch 4 => Loss 0.808, Train_accy 81.29, Test_curr_accy 92.05, Test_accy 92.05
2024-12-30 19:45:26,011 [asp.py] => Task 0, Epoch 12 => Loss 0.453, Train_accy 89.40, Test_curr_accy 87.07, Test_accy 87.07
2024-12-30 19:49:27,743 [asp.py] => Task 0, Epoch 5 => Loss 0.783, Train_accy 81.29, Test_curr_accy 92.62, Test_accy 92.62
2024-12-30 19:50:56,798 [asp.py] => Task 0, Epoch 5 => Loss 0.775, Train_accy 81.36, Test_curr_accy 92.70, Test_accy 92.70
2024-12-30 20:01:31,395 [asp.py] => Task 0, Epoch 6 => Loss 0.765, Train_accy 81.53, Test_curr_accy 92.60, Test_accy 92.60
2024-12-30 20:03:10,078 [asp.py] => Task 0, Epoch 6 => Loss 0.751, Train_accy 81.88, Test_curr_accy 92.50, Test_accy 92.50
2024-12-30 20:03:46,507 [asp.py] => Task 0, Epoch 13 => Loss 0.452, Train_accy 89.47, Test_curr_accy 90.65, Test_accy 90.65
2024-12-30 20:13:33,730 [asp.py] => Task 0, Epoch 7 => Loss 0.729, Train_accy 82.30, Test_curr_accy 92.98, Test_accy 92.98
2024-12-30 20:15:25,988 [asp.py] => Task 0, Epoch 7 => Loss 0.721, Train_accy 82.34, Test_curr_accy 92.77, Test_accy 92.77
2024-12-30 20:22:05,931 [asp.py] => Task 0, Epoch 14 => Loss 0.443, Train_accy 89.70, Test_curr_accy 79.72, Test_accy 79.72
2024-12-30 20:25:36,374 [asp.py] => Task 0, Epoch 8 => Loss 0.729, Train_accy 82.22, Test_curr_accy 92.90, Test_accy 92.90
2024-12-30 20:27:33,633 [asp.py] => Task 0, Epoch 8 => Loss 0.723, Train_accy 82.40, Test_curr_accy 92.65, Test_accy 92.65
2024-12-30 20:37:39,255 [asp.py] => Task 0, Epoch 9 => Loss 0.713, Train_accy 82.59, Test_curr_accy 92.92, Test_accy 92.92
2024-12-30 20:39:42,863 [asp.py] => Task 0, Epoch 9 => Loss 0.711, Train_accy 82.70, Test_curr_accy 92.80, Test_accy 92.80
2024-12-30 20:40:23,460 [asp.py] => Task 0, Epoch 15 => Loss 0.448, Train_accy 89.61, Test_curr_accy 84.45, Test_accy 84.45
2024-12-30 20:49:42,441 [asp.py] => Task 0, Epoch 10 => Loss 0.702, Train_accy 82.96, Test_curr_accy 93.05, Test_accy 93.05
2024-12-30 20:51:54,245 [asp.py] => Task 0, Epoch 10 => Loss 0.701, Train_accy 83.07, Test_curr_accy 92.85, Test_accy 92.85
2024-12-30 20:54:02,968 [trainer.py] => Top1 curve: [91.7]
2024-12-30 20:54:02,968 [trainer.py] => Average Accuracy (Top1): 91.7   (Harmonic Accuracy): None (Old Acc): 91.7 (New Acc): [] 

2024-12-30 20:54:02,969 [trainer.py] => All params: 173642241
2024-12-30 20:54:02,971 [trainer.py] => Trainable params: 2044929
2024-12-30 20:54:02,972 [asp.py] => Learning on 60-65
2024-12-30 20:54:02,983 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 20:55:44,677 [asp.py] => total parameters: 173646081
2024-12-30 20:55:44,678 [asp.py] => trainable parameters: 2048769
2024-12-30 20:56:15,689 [trainer.py] => Top1 curve: [91.7, 90.25]
2024-12-30 20:56:15,690 [trainer.py] => Average Accuracy (Top1): 90.975   (Harmonic Accuracy): 82.8927952167414 (Old Acc): 91.45 (New Acc): 75.8 

2024-12-30 20:56:15,691 [trainer.py] => All params: 173646081
2024-12-30 20:56:15,692 [trainer.py] => Trainable params: 2048769
2024-12-30 20:56:15,693 [asp.py] => Learning on 65-70
2024-12-30 20:56:15,715 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 20:57:57,461 [asp.py] => total parameters: 173649921
2024-12-30 20:57:57,462 [asp.py] => trainable parameters: 2052609
2024-12-30 20:57:58,361 [trainer.py] => Top1 curve: [91.83]
2024-12-30 20:57:58,363 [trainer.py] => Average Accuracy (Top1): 91.83   (Harmonic Accuracy): None (Old Acc): 91.83333333333333 (New Acc): [] 

2024-12-30 20:57:58,364 [trainer.py] => All params: 173642241
2024-12-30 20:57:58,365 [trainer.py] => Trainable params: 2044929
2024-12-30 20:57:58,376 [asp.py] => Learning on 60-65
2024-12-30 20:57:58,411 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 20:58:30,536 [trainer.py] => Top1 curve: [91.7, 90.25, 89.64]
2024-12-30 20:58:30,537 [trainer.py] => Average Accuracy (Top1): 90.52999999999999   (Harmonic Accuracy): 84.80633431085045 (Old Acc): 91.40000000000002 (New Acc): 79.1 

2024-12-30 20:58:30,538 [trainer.py] => All params: 173649921
2024-12-30 20:58:30,539 [trainer.py] => Trainable params: 2052609
2024-12-30 20:58:30,540 [asp.py] => Learning on 70-75
2024-12-30 20:58:30,552 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 20:58:49,979 [asp.py] => Task 0, Epoch 16 => Loss 0.438, Train_accy 89.73, Test_curr_accy 81.77, Test_accy 81.77
2024-12-30 20:59:01,878 [asp.py] => total parameters: 173646081
2024-12-30 20:59:01,881 [asp.py] => trainable parameters: 2048769
2024-12-30 21:00:11,880 [trainer.py] => Top1 curve: [91.83, 90.31]
2024-12-30 21:00:11,881 [trainer.py] => Average Accuracy (Top1): 91.07   (Harmonic Accuracy): 82.46623311655829 (Old Acc): 91.58333333333333 (New Acc): 75.0 

2024-12-30 21:00:11,883 [trainer.py] => All params: 173646081
2024-12-30 21:00:11,884 [trainer.py] => Trainable params: 2048769
2024-12-30 21:00:11,888 [asp.py] => Learning on 65-70
2024-12-30 21:00:11,915 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 21:00:11,915 [asp.py] => total parameters: 173653761
2024-12-30 21:00:11,916 [asp.py] => trainable parameters: 2056449
2024-12-30 21:00:47,110 [trainer.py] => Top1 curve: [91.7, 90.25, 89.64, 88.39]
2024-12-30 21:00:47,110 [trainer.py] => Average Accuracy (Top1): 89.99499999999999   (Harmonic Accuracy): 83.73905420991927 (Old Acc): 91.11666666666667 (New Acc): 77.46666666666667 

2024-12-30 21:00:47,112 [trainer.py] => All params: 173653761
2024-12-30 21:00:47,112 [trainer.py] => Trainable params: 2056449
2024-12-30 21:00:47,114 [asp.py] => Learning on 75-80
2024-12-30 21:00:47,132 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 21:01:09,314 [asp.py] => total parameters: 173649921
2024-12-30 21:01:09,315 [asp.py] => trainable parameters: 2052609
2024-12-30 21:02:22,159 [trainer.py] => Top1 curve: [91.83, 90.31, 89.84]
2024-12-30 21:02:22,160 [trainer.py] => Average Accuracy (Top1): 90.66000000000001   (Harmonic Accuracy): 85.20778664590229 (Old Acc): 91.53333333333335 (New Acc): 79.7 

2024-12-30 21:02:22,162 [trainer.py] => All params: 173649921
2024-12-30 21:02:22,163 [trainer.py] => Trainable params: 2052609
2024-12-30 21:02:22,168 [asp.py] => Learning on 70-75
2024-12-30 21:02:22,187 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 21:02:28,565 [asp.py] => total parameters: 173657601
2024-12-30 21:02:28,565 [asp.py] => trainable parameters: 2060289
2024-12-30 21:03:17,317 [asp.py] => total parameters: 173653761
2024-12-30 21:03:17,318 [asp.py] => trainable parameters: 2056449
2024-12-30 21:03:58,390 [trainer.py] => Top1 curve: [91.83, 90.31, 89.84, 88.56]
2024-12-30 21:03:58,391 [trainer.py] => Average Accuracy (Top1): 90.135   (Harmonic Accuracy): 84.05343055145006 (Old Acc): 91.21666666666665 (New Acc): 77.93333333333334 

2024-12-30 21:03:58,392 [trainer.py] => All params: 173653761
2024-12-30 21:03:58,392 [trainer.py] => Trainable params: 2056449
2024-12-30 21:03:58,394 [asp.py] => Learning on 75-80
2024-12-30 21:03:58,420 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 21:04:44,716 [asp.py] => total parameters: 173657601
2024-12-30 21:04:44,717 [asp.py] => trainable parameters: 2060289
2024-12-30 21:05:30,151 [trainer.py] => Top1 curve: [91.83, 90.31, 89.84, 88.56, 88.64]
2024-12-30 21:05:30,152 [trainer.py] => Average Accuracy (Top1): 89.836   (Harmonic Accuracy): 85.85241365966915 (Old Acc): 91.13333333333334 (New Acc): 81.15 

2024-12-30 21:05:30,154 [trainer.py] => All params: 173657601
2024-12-30 21:05:30,155 [trainer.py] => Trainable params: 2060289
2024-12-30 21:05:30,156 [asp.py] => Learning on 80-85
2024-12-30 21:05:30,181 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 21:06:23,603 [asp.py] => total parameters: 173661441
2024-12-30 21:06:23,604 [asp.py] => trainable parameters: 2064129
2024-12-30 21:07:08,934 [trainer.py] => Top1 curve: [91.83, 90.31, 89.84, 88.56, 88.64, 87.87]
2024-12-30 21:07:08,935 [trainer.py] => Average Accuracy (Top1): 89.50833333333333   (Harmonic Accuracy): 85.38009412313795 (Old Acc): 90.96666666666665 (New Acc): 80.44 

2024-12-30 21:07:08,936 [trainer.py] => All params: 173661441
2024-12-30 21:07:08,937 [trainer.py] => Trainable params: 2064129
2024-12-30 21:07:08,938 [asp.py] => Learning on 85-90
2024-12-30 21:07:08,970 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 21:07:56,397 [asp.py] => total parameters: 173665281
2024-12-30 21:07:56,398 [asp.py] => trainable parameters: 2067969
2024-12-30 21:08:45,309 [trainer.py] => Top1 curve: [91.83, 90.31, 89.84, 88.56, 88.64, 87.87, 87.8]
2024-12-30 21:08:45,310 [trainer.py] => Average Accuracy (Top1): 89.2642857142857   (Harmonic Accuracy): 86.0433970768141 (Old Acc): 90.83333333333333 (New Acc): 81.73333333333333 

2024-12-30 21:08:45,311 [trainer.py] => All params: 173665281
2024-12-30 21:08:45,312 [trainer.py] => Trainable params: 2067969
2024-12-30 21:08:45,313 [asp.py] => Learning on 90-95
2024-12-30 21:08:45,342 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 21:09:34,688 [asp.py] => total parameters: 173669121
2024-12-30 21:09:34,689 [asp.py] => trainable parameters: 2071809
2024-12-30 21:10:26,642 [trainer.py] => Top1 curve: [91.83, 90.31, 89.84, 88.56, 88.64, 87.87, 87.8, 87.44]
2024-12-30 21:10:26,642 [trainer.py] => Average Accuracy (Top1): 89.03625   (Harmonic Accuracy): 86.0353941267388 (Old Acc): 90.73333333333333 (New Acc): 81.79999999999998 

2024-12-30 21:10:26,644 [trainer.py] => All params: 173669121
2024-12-30 21:10:26,645 [trainer.py] => Trainable params: 2071809
2024-12-30 21:10:26,647 [asp.py] => Learning on 95-100
2024-12-30 21:10:26,671 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 21:10:26,675 [asp.py] => total parameters: 173672961
2024-12-30 21:10:26,676 [asp.py] => trainable parameters: 2075649
2024-12-30 21:11:22,952 [trainer.py] => Top1 curve: [91.83, 90.31, 89.84, 88.56, 88.64, 87.87, 87.8, 87.44, 86.36]
2024-12-30 21:11:22,952 [trainer.py] => Average Accuracy (Top1): 88.73888888888888   (Harmonic Accuracy): 84.99769486227777 (Old Acc): 90.53333333333332 (New Acc): 80.1 

2024-12-30 21:11:22,952 [trainer.py] => 

2024-12-30 21:17:14,126 [asp.py] => Task 0, Epoch 17 => Loss 0.432, Train_accy 89.99, Test_curr_accy 83.65, Test_accy 83.65
2024-12-30 21:22:44,062 [trainer.py] => config: ./exps/cifar.json
2024-12-30 21:22:44,062 [trainer.py] => model_name: asp
2024-12-30 21:22:44,062 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 21:22:44,062 [trainer.py] => device: [device(type='cuda', index=0)]
2024-12-30 21:22:44,062 [trainer.py] => seed: 2024
2024-12-30 21:22:44,062 [trainer.py] => dataset: cifar224
2024-12-30 21:22:44,062 [trainer.py] => init_cls: 60
2024-12-30 21:22:44,062 [trainer.py] => increment: 5
2024-12-30 21:22:44,062 [trainer.py] => kshot: 5
2024-12-30 21:22:44,062 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 21:22:44,062 [trainer.py] => z_dim: 1000
2024-12-30 21:22:44,062 [trainer.py] => conv_dim: 64
2024-12-30 21:22:44,062 [trainer.py] => img_size: 224
2024-12-30 21:22:44,062 [trainer.py] => generator_lr: 0.001
2024-12-30 21:22:44,062 [trainer.py] => pi: 100
2024-12-30 21:22:44,062 [trainer.py] => w_bn: 50.0
2024-12-30 21:22:44,062 [trainer.py] => w_noise: 0.001
2024-12-30 21:22:44,062 [trainer.py] => server_ss: 32
2024-12-30 21:22:44,062 [trainer.py] => bn_loss: 1
2024-12-30 21:22:44,063 [trainer.py] => noise: 1
2024-12-30 21:22:44,063 [trainer.py] => ie_loss: 1
2024-12-30 21:22:44,063 [trainer.py] => act_loss: 0
2024-12-30 21:22:44,063 [trainer.py] => w_ie: 1.0
2024-12-30 21:22:44,063 [trainer.py] => w_act: 0.1
2024-12-30 21:22:44,063 [trainer.py] => syn_size: 32
2024-12-30 21:22:44,063 [trainer.py] => vpt_type: Deep
2024-12-30 21:22:44,063 [trainer.py] => prompt_token_num: 6
2024-12-30 21:22:44,063 [trainer.py] => avg_alpha: 0.8
2024-12-30 21:22:44,063 [trainer.py] => perturb_var: 1
2024-12-30 21:22:44,063 [trainer.py] => EMA_beta: 0.99
2024-12-30 21:22:44,063 [trainer.py] => anchor_lambda: 0.1
2024-12-30 21:22:44,063 [trainer.py] => kl_weight: 0.001
2024-12-30 21:22:44,063 [trainer.py] => TIP_init: zero
2024-12-30 21:22:44,063 [trainer.py] => tuned_epoch: 10
2024-12-30 21:22:44,063 [trainer.py] => fs_epoch: 0
2024-12-30 21:22:44,063 [trainer.py] => init_lr: 0.01
2024-12-30 21:22:44,063 [trainer.py] => fs_lr: 0.001
2024-12-30 21:22:44,063 [trainer.py] => batch_size: 48
2024-12-30 21:22:44,063 [trainer.py] => fs_batch_size: 16
2024-12-30 21:22:44,063 [trainer.py] => weight_decay: 0.0005
2024-12-30 21:22:44,063 [trainer.py] => min_lr: 0
2024-12-30 21:22:44,063 [trainer.py] => optimizer: sgd
2024-12-30 21:22:44,063 [trainer.py] => memory_size: 0
2024-12-30 21:22:44,063 [trainer.py] => memory_per_class: 0
2024-12-30 21:22:44,063 [trainer.py] => fixed_memory: False
2024-12-30 21:22:44,063 [trainer.py] => shuffle: False
2024-12-30 21:22:44,063 [trainer.py] => top_k: 5
2024-12-30 21:22:44,063 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 21:22:44,063 [trainer.py] => prefix: asp
2024-12-30 21:22:44,064 [trainer.py] => model_prefix: asp
2024-12-30 21:22:45,935 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 21:22:52,984 [trainer.py] => All params: 173596160
2024-12-30 21:22:52,985 [trainer.py] => Trainable params: 1998848
2024-12-30 21:22:53,297 [asp.py] => Learning on 0-60
2024-12-30 21:22:53,393 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 21:23:05,275 [asp.py] => total parameters: 173642241
2024-12-30 21:23:05,276 [asp.py] => trainable parameters: 2044929
2024-12-30 21:35:32,867 [asp.py] => Task 0, Epoch 18 => Loss 0.431, Train_accy 89.91, Test_curr_accy 80.00, Test_accy 80.00
2024-12-30 21:35:42,555 [asp.py] => Task 0, Epoch 1 => Loss 3.578, Train_accy 32.63, Test_curr_accy 89.37, Test_accy 89.37
2024-12-30 21:47:01,122 [trainer.py] => config: ./exps/cifar.json
2024-12-30 21:47:01,122 [trainer.py] => model_name: asp
2024-12-30 21:47:01,123 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2024-12-30 21:47:01,123 [trainer.py] => device: [device(type='cuda', index=0)]
2024-12-30 21:47:01,123 [trainer.py] => seed: 2024
2024-12-30 21:47:01,123 [trainer.py] => dataset: cifar224
2024-12-30 21:47:01,123 [trainer.py] => init_cls: 60
2024-12-30 21:47:01,123 [trainer.py] => increment: 5
2024-12-30 21:47:01,123 [trainer.py] => kshot: 5
2024-12-30 21:47:01,123 [trainer.py] => generator_model: CIFAR_GEN
2024-12-30 21:47:01,123 [trainer.py] => z_dim: 1000
2024-12-30 21:47:01,123 [trainer.py] => conv_dim: 64
2024-12-30 21:47:01,123 [trainer.py] => img_size: 224
2024-12-30 21:47:01,123 [trainer.py] => generator_lr: 0.001
2024-12-30 21:47:01,123 [trainer.py] => pi: 300
2024-12-30 21:47:01,123 [trainer.py] => w_bn: 50.0
2024-12-30 21:47:01,123 [trainer.py] => w_noise: 0.001
2024-12-30 21:47:01,123 [trainer.py] => server_ss: 32
2024-12-30 21:47:01,123 [trainer.py] => bn_loss: 1
2024-12-30 21:47:01,123 [trainer.py] => noise: 1
2024-12-30 21:47:01,123 [trainer.py] => ie_loss: 1
2024-12-30 21:47:01,123 [trainer.py] => act_loss: 0
2024-12-30 21:47:01,123 [trainer.py] => w_ie: 1.0
2024-12-30 21:47:01,123 [trainer.py] => w_act: 0.1
2024-12-30 21:47:01,123 [trainer.py] => syn_size: 32
2024-12-30 21:47:01,123 [trainer.py] => vpt_type: Deep
2024-12-30 21:47:01,123 [trainer.py] => prompt_token_num: 6
2024-12-30 21:47:01,123 [trainer.py] => avg_alpha: 0.8
2024-12-30 21:47:01,123 [trainer.py] => perturb_var: 1
2024-12-30 21:47:01,124 [trainer.py] => EMA_beta: 0.99
2024-12-30 21:47:01,124 [trainer.py] => anchor_lambda: 0.1
2024-12-30 21:47:01,124 [trainer.py] => kl_weight: 0.001
2024-12-30 21:47:01,124 [trainer.py] => TIP_init: zero
2024-12-30 21:47:01,124 [trainer.py] => tuned_epoch: 10
2024-12-30 21:47:01,124 [trainer.py] => fs_epoch: 0
2024-12-30 21:47:01,124 [trainer.py] => init_lr: 0.01
2024-12-30 21:47:01,124 [trainer.py] => fs_lr: 0.001
2024-12-30 21:47:01,124 [trainer.py] => batch_size: 48
2024-12-30 21:47:01,124 [trainer.py] => fs_batch_size: 16
2024-12-30 21:47:01,124 [trainer.py] => weight_decay: 0.0005
2024-12-30 21:47:01,124 [trainer.py] => min_lr: 0
2024-12-30 21:47:01,124 [trainer.py] => optimizer: sgd
2024-12-30 21:47:01,124 [trainer.py] => memory_size: 0
2024-12-30 21:47:01,124 [trainer.py] => memory_per_class: 0
2024-12-30 21:47:01,124 [trainer.py] => fixed_memory: False
2024-12-30 21:47:01,124 [trainer.py] => shuffle: False
2024-12-30 21:47:01,124 [trainer.py] => top_k: 5
2024-12-30 21:47:01,124 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2024-12-30 21:47:01,124 [trainer.py] => prefix: asp
2024-12-30 21:47:01,124 [trainer.py] => model_prefix: asp
2024-12-30 21:47:02,824 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2024-12-30 21:47:09,676 [trainer.py] => All params: 173596160
2024-12-30 21:47:09,687 [trainer.py] => Trainable params: 1998848
2024-12-30 21:47:10,322 [asp.py] => Learning on 0-60
2024-12-30 21:47:10,448 [asp.py] => training set size: 30000, fc construct set size: 30000
2024-12-30 21:47:10,708 [asp.py] => total parameters: 173642241
2024-12-30 21:47:10,709 [asp.py] => trainable parameters: 2044929
2024-12-30 21:59:42,685 [asp.py] => Task 0, Epoch 1 => Loss 3.597, Train_accy 32.01, Test_curr_accy 89.15, Test_accy 89.15
2024-12-30 22:12:26,884 [asp.py] => Task 0, Epoch 2 => Loss 1.028, Train_accy 77.72, Test_curr_accy 90.92, Test_accy 90.92
2024-12-30 22:24:57,106 [asp.py] => Task 0, Epoch 3 => Loss 0.874, Train_accy 79.86, Test_curr_accy 91.95, Test_accy 91.95
2024-12-30 22:37:14,030 [asp.py] => Task 0, Epoch 4 => Loss 0.814, Train_accy 80.89, Test_curr_accy 92.18, Test_accy 92.18
2024-12-30 22:49:30,262 [asp.py] => Task 0, Epoch 5 => Loss 0.782, Train_accy 81.18, Test_curr_accy 92.65, Test_accy 92.65
2024-12-30 23:01:47,243 [asp.py] => Task 0, Epoch 6 => Loss 0.765, Train_accy 81.43, Test_curr_accy 92.65, Test_accy 92.65
2024-12-30 23:14:03,425 [asp.py] => Task 0, Epoch 7 => Loss 0.728, Train_accy 82.26, Test_curr_accy 92.50, Test_accy 92.50
2024-12-30 23:26:19,769 [asp.py] => Task 0, Epoch 8 => Loss 0.727, Train_accy 82.33, Test_curr_accy 92.60, Test_accy 92.60
2024-12-30 23:38:35,405 [asp.py] => Task 0, Epoch 9 => Loss 0.717, Train_accy 82.67, Test_curr_accy 92.67, Test_accy 92.67
2024-12-30 23:50:51,771 [asp.py] => Task 0, Epoch 10 => Loss 0.704, Train_accy 82.95, Test_curr_accy 92.80, Test_accy 92.80
2024-12-30 23:55:22,849 [trainer.py] => Top1 curve: [91.57]
2024-12-30 23:55:22,849 [trainer.py] => Average Accuracy (Top1): 91.57   (Harmonic Accuracy): None (Old Acc): 91.56666666666666 (New Acc): [] 

2024-12-30 23:55:22,850 [trainer.py] => All params: 173642241
2024-12-30 23:55:22,851 [trainer.py] => Trainable params: 2044929
2024-12-30 23:55:22,852 [asp.py] => Learning on 60-65
2024-12-30 23:55:22,863 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-30 23:57:39,944 [asp.py] => total parameters: 173646081
2024-12-30 23:57:39,945 [asp.py] => trainable parameters: 2048769
2024-12-30 23:58:16,504 [trainer.py] => Top1 curve: [91.57, 89.97]
2024-12-30 23:58:16,504 [trainer.py] => Average Accuracy (Top1): 90.77   (Harmonic Accuracy): 81.74470659407139 (Old Acc): 91.30000000000001 (New Acc): 74.0 

2024-12-30 23:58:16,505 [trainer.py] => All params: 173646081
2024-12-30 23:58:16,506 [trainer.py] => Trainable params: 2048769
2024-12-30 23:58:16,507 [asp.py] => Learning on 65-70
2024-12-30 23:58:16,530 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-31 00:00:31,968 [asp.py] => total parameters: 173649921
2024-12-31 00:00:31,969 [asp.py] => trainable parameters: 2052609
2024-12-31 00:01:09,940 [trainer.py] => Top1 curve: [91.57, 89.97, 89.41]
2024-12-31 00:01:09,940 [trainer.py] => Average Accuracy (Top1): 90.31666666666666   (Harmonic Accuracy): 84.38904163393558 (Old Acc): 91.23333333333333 (New Acc): 78.5 

2024-12-31 00:01:09,941 [trainer.py] => All params: 173649921
2024-12-31 00:01:09,942 [trainer.py] => Trainable params: 2052609
2024-12-31 00:01:09,944 [asp.py] => Learning on 70-75
2024-12-31 00:01:09,961 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-31 00:03:25,151 [asp.py] => total parameters: 173653761
2024-12-31 00:03:25,152 [asp.py] => trainable parameters: 2056449
2024-12-31 00:04:06,229 [trainer.py] => Top1 curve: [91.57, 89.97, 89.41, 88.19]
2024-12-31 00:04:06,229 [trainer.py] => Average Accuracy (Top1): 89.785   (Harmonic Accuracy): 83.40966365710884 (Old Acc): 90.98333333333333 (New Acc): 77.0 

2024-12-31 00:04:06,230 [trainer.py] => All params: 173653761
2024-12-31 00:04:06,230 [trainer.py] => Trainable params: 2056449
2024-12-31 00:04:06,232 [asp.py] => Learning on 75-80
2024-12-31 00:04:06,246 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-31 00:06:22,116 [asp.py] => total parameters: 173657601
2024-12-31 00:06:22,117 [asp.py] => trainable parameters: 2060289
2024-12-31 00:07:07,370 [trainer.py] => Top1 curve: [91.57, 89.97, 89.41, 88.19, 88.28]
2024-12-31 00:07:07,370 [trainer.py] => Average Accuracy (Top1): 89.484   (Harmonic Accuracy): 85.36977241781754 (Old Acc): 90.86666666666667 (New Acc): 80.5 

2024-12-31 00:07:07,372 [trainer.py] => All params: 173657601
2024-12-31 00:07:07,372 [trainer.py] => Trainable params: 2060289
2024-12-31 00:07:07,373 [asp.py] => Learning on 80-85
2024-12-31 00:07:07,389 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-31 00:09:24,456 [asp.py] => total parameters: 173661441
2024-12-31 00:09:24,457 [asp.py] => trainable parameters: 2064129
2024-12-31 00:10:11,046 [trainer.py] => Top1 curve: [91.57, 89.97, 89.41, 88.19, 88.28, 87.48]
2024-12-31 00:10:11,047 [trainer.py] => Average Accuracy (Top1): 89.14999999999999   (Harmonic Accuracy): 84.84819654174164 (Old Acc): 90.73333333333333 (New Acc): 79.67999999999999 

2024-12-31 00:10:11,048 [trainer.py] => All params: 173661441
2024-12-31 00:10:11,049 [trainer.py] => Trainable params: 2064129
2024-12-31 00:10:11,050 [asp.py] => Learning on 85-90
2024-12-31 00:10:11,078 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-31 00:12:28,037 [asp.py] => total parameters: 173665281
2024-12-31 00:12:28,038 [asp.py] => trainable parameters: 2067969
2024-12-31 00:13:16,515 [trainer.py] => Top1 curve: [91.57, 89.97, 89.41, 88.19, 88.28, 87.48, 87.39]
2024-12-31 00:13:16,515 [trainer.py] => Average Accuracy (Top1): 88.89857142857143   (Harmonic Accuracy): 85.54631446052248 (Old Acc): 90.55 (New Acc): 81.06666666666668 

2024-12-31 00:13:16,516 [trainer.py] => All params: 173665281
2024-12-31 00:13:16,517 [trainer.py] => Trainable params: 2067969
2024-12-31 00:13:16,518 [asp.py] => Learning on 90-95
2024-12-31 00:13:16,534 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-31 00:15:33,495 [asp.py] => total parameters: 173669121
2024-12-31 00:15:33,496 [asp.py] => trainable parameters: 2071809
2024-12-31 00:16:25,360 [trainer.py] => Top1 curve: [91.57, 89.97, 89.41, 88.19, 88.28, 87.48, 87.39, 87.13]
2024-12-31 00:16:25,360 [trainer.py] => Average Accuracy (Top1): 88.6775   (Harmonic Accuracy): 85.69418153607447 (Old Acc): 90.46666666666665 (New Acc): 81.4 

2024-12-31 00:16:25,361 [trainer.py] => All params: 173669121
2024-12-31 00:16:25,362 [trainer.py] => Trainable params: 2071809
2024-12-31 00:16:25,363 [asp.py] => Learning on 95-100
2024-12-31 00:16:25,395 [asp.py] => training set size: 25, fc construct set size: 25
2024-12-31 00:16:25,398 [asp.py] => total parameters: 173672961
2024-12-31 00:16:25,399 [asp.py] => trainable parameters: 2075649
2024-12-31 00:17:19,097 [trainer.py] => Top1 curve: [91.57, 89.97, 89.41, 88.19, 88.28, 87.48, 87.39, 87.13, 86.06]
2024-12-31 00:17:19,098 [trainer.py] => Average Accuracy (Top1): 88.38666666666667   (Harmonic Accuracy): 84.6695294117647 (Old Acc): 90.3 (New Acc): 79.7 

2024-12-31 00:17:19,098 [trainer.py] => 

2025-01-03 21:41:39,260 [trainer.py] => config: ./exps/cifar.json
2025-01-03 21:41:39,261 [trainer.py] => model_name: asp
2025-01-03 21:41:39,261 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 21:41:39,261 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-03 21:41:39,261 [trainer.py] => seed: 2024
2025-01-03 21:41:39,261 [trainer.py] => dataset: cifar224
2025-01-03 21:41:39,261 [trainer.py] => init_cls: 60
2025-01-03 21:41:39,261 [trainer.py] => increment: 5
2025-01-03 21:41:39,261 [trainer.py] => kshot: 5
2025-01-03 21:41:39,261 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 21:41:39,261 [trainer.py] => z_dim: 1000
2025-01-03 21:41:39,261 [trainer.py] => conv_dim: 64
2025-01-03 21:41:39,261 [trainer.py] => img_size: 224
2025-01-03 21:41:39,261 [trainer.py] => generator_lr: 0.001
2025-01-03 21:41:39,261 [trainer.py] => pi: 300
2025-01-03 21:41:39,261 [trainer.py] => w_bn: 50.0
2025-01-03 21:41:39,261 [trainer.py] => w_noise: 0.001
2025-01-03 21:41:39,261 [trainer.py] => server_ss: 32
2025-01-03 21:41:39,261 [trainer.py] => bn_loss: 1
2025-01-03 21:41:39,261 [trainer.py] => noise: 1
2025-01-03 21:41:39,261 [trainer.py] => ie_loss: 1
2025-01-03 21:41:39,261 [trainer.py] => act_loss: 0
2025-01-03 21:41:39,261 [trainer.py] => w_ie: 1.0
2025-01-03 21:41:39,261 [trainer.py] => w_act: 0.1
2025-01-03 21:41:39,261 [trainer.py] => syn_size: 32
2025-01-03 21:41:39,262 [trainer.py] => vpt_type: Deep
2025-01-03 21:41:39,262 [trainer.py] => prompt_token_num: 6
2025-01-03 21:41:39,262 [trainer.py] => avg_alpha: 0.8
2025-01-03 21:41:39,262 [trainer.py] => perturb_var: 1
2025-01-03 21:41:39,262 [trainer.py] => EMA_beta: 0.99
2025-01-03 21:41:39,262 [trainer.py] => anchor_lambda: 0.1
2025-01-03 21:41:39,262 [trainer.py] => kl_weight: 0.001
2025-01-03 21:41:39,262 [trainer.py] => TIP_init: zero
2025-01-03 21:41:39,262 [trainer.py] => tuned_epoch: 10
2025-01-03 21:41:39,262 [trainer.py] => fs_epoch: 0
2025-01-03 21:41:39,262 [trainer.py] => init_lr: 0.01
2025-01-03 21:41:39,262 [trainer.py] => fs_lr: 0.001
2025-01-03 21:41:39,262 [trainer.py] => batch_size: 48
2025-01-03 21:41:39,262 [trainer.py] => fs_batch_size: 16
2025-01-03 21:41:39,262 [trainer.py] => weight_decay: 0.0005
2025-01-03 21:41:39,262 [trainer.py] => min_lr: 0
2025-01-03 21:41:39,262 [trainer.py] => optimizer: sgd
2025-01-03 21:41:39,262 [trainer.py] => memory_size: 0
2025-01-03 21:41:39,262 [trainer.py] => memory_per_class: 0
2025-01-03 21:41:39,262 [trainer.py] => fixed_memory: False
2025-01-03 21:41:39,262 [trainer.py] => shuffle: False
2025-01-03 21:41:39,262 [trainer.py] => top_k: 5
2025-01-03 21:41:39,262 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 21:41:39,262 [trainer.py] => prefix: asp
2025-01-03 21:41:39,262 [trainer.py] => model_prefix: asp
2025-01-03 21:41:43,157 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 21:42:10,058 [trainer.py] => All params: 173596160
2025-01-03 21:42:10,059 [trainer.py] => Trainable params: 1998848
2025-01-03 21:42:10,466 [asp.py] => Learning on 0-60
2025-01-03 21:42:10,609 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 21:42:10,911 [asp.py] => total parameters: 173642241
2025-01-03 21:42:10,914 [asp.py] => trainable parameters: 2044929
2025-01-03 21:54:41,574 [asp.py] => Task 0, Epoch 1 => Loss 3.690, Train_accy 29.68, Test_curr_accy 88.27, Test_accy 88.27
2025-01-03 22:10:26,654 [trainer.py] => config: ./exps/cifar.json
2025-01-03 22:10:26,654 [trainer.py] => model_name: asp
2025-01-03 22:10:26,654 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 22:10:26,654 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-03 22:10:26,654 [trainer.py] => seed: 2024
2025-01-03 22:10:26,654 [trainer.py] => dataset: cifar224
2025-01-03 22:10:26,654 [trainer.py] => init_cls: 60
2025-01-03 22:10:26,654 [trainer.py] => increment: 5
2025-01-03 22:10:26,654 [trainer.py] => kshot: 5
2025-01-03 22:10:26,654 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 22:10:26,654 [trainer.py] => z_dim: 1000
2025-01-03 22:10:26,654 [trainer.py] => conv_dim: 64
2025-01-03 22:10:26,654 [trainer.py] => img_size: 224
2025-01-03 22:10:26,654 [trainer.py] => generator_lr: 0.001
2025-01-03 22:10:26,654 [trainer.py] => pi: 300
2025-01-03 22:10:26,655 [trainer.py] => w_bn: 50.0
2025-01-03 22:10:26,655 [trainer.py] => w_noise: 0.001
2025-01-03 22:10:26,655 [trainer.py] => server_ss: 32
2025-01-03 22:10:26,655 [trainer.py] => bn_loss: 1
2025-01-03 22:10:26,655 [trainer.py] => noise: 1
2025-01-03 22:10:26,655 [trainer.py] => ie_loss: 1
2025-01-03 22:10:26,655 [trainer.py] => act_loss: 0
2025-01-03 22:10:26,655 [trainer.py] => w_ie: 1.0
2025-01-03 22:10:26,655 [trainer.py] => w_act: 0.1
2025-01-03 22:10:26,655 [trainer.py] => syn_size: 32
2025-01-03 22:10:26,655 [trainer.py] => vpt_type: Deep
2025-01-03 22:10:26,655 [trainer.py] => prompt_token_num: 6
2025-01-03 22:10:26,655 [trainer.py] => avg_alpha: 0.8
2025-01-03 22:10:26,655 [trainer.py] => perturb_var: 1
2025-01-03 22:10:26,655 [trainer.py] => EMA_beta: 0.99
2025-01-03 22:10:26,655 [trainer.py] => anchor_lambda: 0.1
2025-01-03 22:10:26,655 [trainer.py] => kl_weight: 0.001
2025-01-03 22:10:26,655 [trainer.py] => TIP_init: zero
2025-01-03 22:10:26,655 [trainer.py] => tuned_epoch: 10
2025-01-03 22:10:26,655 [trainer.py] => fs_epoch: 0
2025-01-03 22:10:26,655 [trainer.py] => init_lr: 0.01
2025-01-03 22:10:26,655 [trainer.py] => fs_lr: 0.001
2025-01-03 22:10:26,655 [trainer.py] => batch_size: 48
2025-01-03 22:10:26,655 [trainer.py] => fs_batch_size: 16
2025-01-03 22:10:26,655 [trainer.py] => weight_decay: 0.0005
2025-01-03 22:10:26,655 [trainer.py] => min_lr: 0
2025-01-03 22:10:26,655 [trainer.py] => optimizer: sgd
2025-01-03 22:10:26,656 [trainer.py] => memory_size: 0
2025-01-03 22:10:26,656 [trainer.py] => memory_per_class: 0
2025-01-03 22:10:26,656 [trainer.py] => fixed_memory: False
2025-01-03 22:10:26,656 [trainer.py] => shuffle: False
2025-01-03 22:10:26,656 [trainer.py] => top_k: 5
2025-01-03 22:10:26,656 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 22:10:26,656 [trainer.py] => prefix: asp
2025-01-03 22:10:26,656 [trainer.py] => model_prefix: asp
2025-01-03 22:10:28,489 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 22:10:39,297 [trainer.py] => All params: 173596160
2025-01-03 22:10:39,298 [trainer.py] => Trainable params: 1998848
2025-01-03 22:10:39,674 [asp.py] => Learning on 0-60
2025-01-03 22:10:39,747 [trainer.py] => config: ./exps/cifar.json
2025-01-03 22:10:39,747 [trainer.py] => model_name: asp
2025-01-03 22:10:39,747 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 22:10:39,747 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-03 22:10:39,747 [trainer.py] => seed: 2024
2025-01-03 22:10:39,747 [trainer.py] => dataset: cifar224
2025-01-03 22:10:39,747 [trainer.py] => init_cls: 60
2025-01-03 22:10:39,747 [trainer.py] => increment: 5
2025-01-03 22:10:39,747 [trainer.py] => kshot: 5
2025-01-03 22:10:39,747 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 22:10:39,747 [trainer.py] => z_dim: 1000
2025-01-03 22:10:39,747 [trainer.py] => conv_dim: 64
2025-01-03 22:10:39,747 [trainer.py] => img_size: 224
2025-01-03 22:10:39,747 [trainer.py] => generator_lr: 0.001
2025-01-03 22:10:39,747 [trainer.py] => pi: 100
2025-01-03 22:10:39,747 [trainer.py] => w_bn: 50.0
2025-01-03 22:10:39,747 [trainer.py] => w_noise: 0.001
2025-01-03 22:10:39,747 [trainer.py] => server_ss: 32
2025-01-03 22:10:39,747 [trainer.py] => bn_loss: 1
2025-01-03 22:10:39,747 [trainer.py] => noise: 1
2025-01-03 22:10:39,747 [trainer.py] => ie_loss: 1
2025-01-03 22:10:39,747 [trainer.py] => act_loss: 0
2025-01-03 22:10:39,748 [trainer.py] => w_ie: 1.0
2025-01-03 22:10:39,748 [trainer.py] => w_act: 0.1
2025-01-03 22:10:39,748 [trainer.py] => syn_size: 32
2025-01-03 22:10:39,748 [trainer.py] => vpt_type: Deep
2025-01-03 22:10:39,748 [trainer.py] => prompt_token_num: 6
2025-01-03 22:10:39,748 [trainer.py] => avg_alpha: 0.8
2025-01-03 22:10:39,748 [trainer.py] => perturb_var: 1
2025-01-03 22:10:39,748 [trainer.py] => EMA_beta: 0.99
2025-01-03 22:10:39,748 [trainer.py] => anchor_lambda: 0.1
2025-01-03 22:10:39,748 [trainer.py] => kl_weight: 0.001
2025-01-03 22:10:39,748 [trainer.py] => TIP_init: zero
2025-01-03 22:10:39,748 [trainer.py] => tuned_epoch: 10
2025-01-03 22:10:39,748 [trainer.py] => fs_epoch: 0
2025-01-03 22:10:39,748 [trainer.py] => init_lr: 0.01
2025-01-03 22:10:39,748 [trainer.py] => fs_lr: 0.001
2025-01-03 22:10:39,748 [trainer.py] => batch_size: 48
2025-01-03 22:10:39,748 [trainer.py] => fs_batch_size: 16
2025-01-03 22:10:39,748 [trainer.py] => weight_decay: 0.0005
2025-01-03 22:10:39,748 [trainer.py] => min_lr: 0
2025-01-03 22:10:39,748 [trainer.py] => optimizer: sgd
2025-01-03 22:10:39,748 [trainer.py] => memory_size: 0
2025-01-03 22:10:39,748 [trainer.py] => memory_per_class: 0
2025-01-03 22:10:39,748 [trainer.py] => fixed_memory: False
2025-01-03 22:10:39,748 [trainer.py] => shuffle: False
2025-01-03 22:10:39,749 [trainer.py] => top_k: 5
2025-01-03 22:10:39,749 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 22:10:39,749 [trainer.py] => prefix: asp
2025-01-03 22:10:39,749 [trainer.py] => model_prefix: asp
2025-01-03 22:10:39,793 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 22:10:40,057 [asp.py] => total parameters: 173642241
2025-01-03 22:10:40,058 [asp.py] => trainable parameters: 2044929
2025-01-03 22:10:43,141 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 22:10:50,546 [trainer.py] => All params: 173596160
2025-01-03 22:10:50,547 [trainer.py] => Trainable params: 1998848
2025-01-03 22:10:50,996 [asp.py] => Learning on 0-60
2025-01-03 22:10:53,759 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 22:10:54,408 [asp.py] => total parameters: 173642241
2025-01-03 22:10:54,409 [asp.py] => trainable parameters: 2044929
2025-01-03 22:16:23,650 [trainer.py] => config: ./exps/cifar.json
2025-01-03 22:16:23,650 [trainer.py] => model_name: asp
2025-01-03 22:16:23,650 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 22:16:23,651 [trainer.py] => device: [device(type='cuda', index=3)]
2025-01-03 22:16:23,651 [trainer.py] => seed: 2024
2025-01-03 22:16:23,651 [trainer.py] => dataset: cifar224
2025-01-03 22:16:23,651 [trainer.py] => init_cls: 60
2025-01-03 22:16:23,651 [trainer.py] => increment: 5
2025-01-03 22:16:23,651 [trainer.py] => kshot: 5
2025-01-03 22:16:23,651 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 22:16:23,651 [trainer.py] => z_dim: 1000
2025-01-03 22:16:23,651 [trainer.py] => conv_dim: 64
2025-01-03 22:16:23,651 [trainer.py] => img_size: 224
2025-01-03 22:16:23,651 [trainer.py] => generator_lr: 0.001
2025-01-03 22:16:23,651 [trainer.py] => pi: 100
2025-01-03 22:16:23,651 [trainer.py] => w_bn: 50.0
2025-01-03 22:16:23,651 [trainer.py] => w_noise: 0.001
2025-01-03 22:16:23,651 [trainer.py] => server_ss: 32
2025-01-03 22:16:23,651 [trainer.py] => bn_loss: 1
2025-01-03 22:16:23,651 [trainer.py] => noise: 1
2025-01-03 22:16:23,651 [trainer.py] => ie_loss: 1
2025-01-03 22:16:23,651 [trainer.py] => act_loss: 0
2025-01-03 22:16:23,651 [trainer.py] => w_ie: 1.0
2025-01-03 22:16:23,651 [trainer.py] => w_act: 0.1
2025-01-03 22:16:23,651 [trainer.py] => syn_size: 32
2025-01-03 22:16:23,651 [trainer.py] => vpt_type: Deep
2025-01-03 22:16:23,651 [trainer.py] => prompt_token_num: 6
2025-01-03 22:16:23,651 [trainer.py] => avg_alpha: 0.8
2025-01-03 22:16:23,652 [trainer.py] => perturb_var: 1
2025-01-03 22:16:23,652 [trainer.py] => EMA_beta: 0.99
2025-01-03 22:16:23,652 [trainer.py] => anchor_lambda: 0.1
2025-01-03 22:16:23,652 [trainer.py] => kl_weight: 0.001
2025-01-03 22:16:23,652 [trainer.py] => TIP_init: zero
2025-01-03 22:16:23,652 [trainer.py] => tuned_epoch: 10
2025-01-03 22:16:23,652 [trainer.py] => fs_epoch: 0
2025-01-03 22:16:23,652 [trainer.py] => init_lr: 0.01
2025-01-03 22:16:23,652 [trainer.py] => fs_lr: 0.001
2025-01-03 22:16:23,652 [trainer.py] => batch_size: 48
2025-01-03 22:16:23,652 [trainer.py] => fs_batch_size: 16
2025-01-03 22:16:23,652 [trainer.py] => weight_decay: 0.0005
2025-01-03 22:16:23,652 [trainer.py] => min_lr: 0
2025-01-03 22:16:23,652 [trainer.py] => optimizer: sgd
2025-01-03 22:16:23,652 [trainer.py] => memory_size: 0
2025-01-03 22:16:23,652 [trainer.py] => memory_per_class: 0
2025-01-03 22:16:23,652 [trainer.py] => fixed_memory: False
2025-01-03 22:16:23,652 [trainer.py] => shuffle: False
2025-01-03 22:16:23,652 [trainer.py] => top_k: 5
2025-01-03 22:16:23,652 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 22:16:23,652 [trainer.py] => prefix: asp
2025-01-03 22:16:23,652 [trainer.py] => model_prefix: asp
2025-01-03 22:16:25,397 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 22:16:39,663 [trainer.py] => config: ./exps/cifar.json
2025-01-03 22:16:39,663 [trainer.py] => model_name: asp
2025-01-03 22:16:39,664 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 22:16:39,664 [trainer.py] => device: [device(type='cuda', index=3)]
2025-01-03 22:16:39,664 [trainer.py] => seed: 2024
2025-01-03 22:16:39,664 [trainer.py] => dataset: cifar224
2025-01-03 22:16:39,664 [trainer.py] => init_cls: 60
2025-01-03 22:16:39,664 [trainer.py] => increment: 5
2025-01-03 22:16:39,664 [trainer.py] => kshot: 5
2025-01-03 22:16:39,664 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 22:16:39,664 [trainer.py] => z_dim: 1000
2025-01-03 22:16:39,664 [trainer.py] => conv_dim: 64
2025-01-03 22:16:39,664 [trainer.py] => img_size: 224
2025-01-03 22:16:39,664 [trainer.py] => generator_lr: 0.001
2025-01-03 22:16:39,664 [trainer.py] => pi: 300
2025-01-03 22:16:39,664 [trainer.py] => w_bn: 50.0
2025-01-03 22:16:39,664 [trainer.py] => w_noise: 0.001
2025-01-03 22:16:39,664 [trainer.py] => server_ss: 32
2025-01-03 22:16:39,664 [trainer.py] => bn_loss: 1
2025-01-03 22:16:39,664 [trainer.py] => noise: 1
2025-01-03 22:16:39,664 [trainer.py] => ie_loss: 1
2025-01-03 22:16:39,664 [trainer.py] => act_loss: 0
2025-01-03 22:16:39,664 [trainer.py] => w_ie: 1.0
2025-01-03 22:16:39,664 [trainer.py] => w_act: 0.1
2025-01-03 22:16:39,664 [trainer.py] => syn_size: 32
2025-01-03 22:16:39,664 [trainer.py] => vpt_type: Deep
2025-01-03 22:16:39,664 [trainer.py] => prompt_token_num: 6
2025-01-03 22:16:39,665 [trainer.py] => avg_alpha: 0.8
2025-01-03 22:16:39,665 [trainer.py] => perturb_var: 1
2025-01-03 22:16:39,665 [trainer.py] => EMA_beta: 0.99
2025-01-03 22:16:39,665 [trainer.py] => anchor_lambda: 0.1
2025-01-03 22:16:39,665 [trainer.py] => kl_weight: 0.001
2025-01-03 22:16:39,665 [trainer.py] => TIP_init: zero
2025-01-03 22:16:39,665 [trainer.py] => tuned_epoch: 10
2025-01-03 22:16:39,665 [trainer.py] => fs_epoch: 0
2025-01-03 22:16:39,665 [trainer.py] => init_lr: 0.01
2025-01-03 22:16:39,665 [trainer.py] => fs_lr: 0.001
2025-01-03 22:16:39,665 [trainer.py] => batch_size: 48
2025-01-03 22:16:39,665 [trainer.py] => fs_batch_size: 16
2025-01-03 22:16:39,665 [trainer.py] => weight_decay: 0.0005
2025-01-03 22:16:39,665 [trainer.py] => min_lr: 0
2025-01-03 22:16:39,665 [trainer.py] => optimizer: sgd
2025-01-03 22:16:39,665 [trainer.py] => memory_size: 0
2025-01-03 22:16:39,665 [trainer.py] => memory_per_class: 0
2025-01-03 22:16:39,665 [trainer.py] => fixed_memory: False
2025-01-03 22:16:39,665 [trainer.py] => shuffle: False
2025-01-03 22:16:39,665 [trainer.py] => top_k: 5
2025-01-03 22:16:39,665 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 22:16:39,665 [trainer.py] => prefix: asp
2025-01-03 22:16:39,665 [trainer.py] => model_prefix: asp
2025-01-03 22:16:40,727 [trainer.py] => All params: 173596160
2025-01-03 22:16:40,729 [trainer.py] => Trainable params: 1998848
2025-01-03 22:16:41,091 [asp.py] => Learning on 0-60
2025-01-03 22:16:41,725 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 22:16:42,464 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 22:16:42,740 [asp.py] => total parameters: 173642241
2025-01-03 22:16:42,740 [asp.py] => trainable parameters: 2044929
2025-01-03 22:16:54,852 [trainer.py] => All params: 173596160
2025-01-03 22:16:54,853 [trainer.py] => Trainable params: 1998848
2025-01-03 22:16:55,292 [asp.py] => Learning on 0-60
2025-01-03 22:16:55,681 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 22:16:56,173 [asp.py] => total parameters: 173642241
2025-01-03 22:16:56,174 [asp.py] => trainable parameters: 2044929
2025-01-03 22:24:44,680 [trainer.py] => config: ./exps/cifar.json
2025-01-03 22:24:44,680 [trainer.py] => model_name: asp
2025-01-03 22:24:44,680 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 22:24:44,680 [trainer.py] => device: [device(type='cuda', index=4)]
2025-01-03 22:24:44,680 [trainer.py] => seed: 2024
2025-01-03 22:24:44,680 [trainer.py] => dataset: cifar224
2025-01-03 22:24:44,680 [trainer.py] => init_cls: 60
2025-01-03 22:24:44,680 [trainer.py] => increment: 5
2025-01-03 22:24:44,680 [trainer.py] => kshot: 5
2025-01-03 22:24:44,680 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 22:24:44,680 [trainer.py] => z_dim: 1000
2025-01-03 22:24:44,680 [trainer.py] => conv_dim: 64
2025-01-03 22:24:44,680 [trainer.py] => img_size: 224
2025-01-03 22:24:44,681 [trainer.py] => generator_lr: 0.001
2025-01-03 22:24:44,681 [trainer.py] => pi: 100
2025-01-03 22:24:44,681 [trainer.py] => w_bn: 50.0
2025-01-03 22:24:44,681 [trainer.py] => w_noise: 0.001
2025-01-03 22:24:44,681 [trainer.py] => server_ss: 32
2025-01-03 22:24:44,681 [trainer.py] => bn_loss: 1
2025-01-03 22:24:44,681 [trainer.py] => noise: 1
2025-01-03 22:24:44,681 [trainer.py] => ie_loss: 1
2025-01-03 22:24:44,681 [trainer.py] => act_loss: 0
2025-01-03 22:24:44,681 [trainer.py] => w_ie: 1.0
2025-01-03 22:24:44,681 [trainer.py] => w_act: 0.1
2025-01-03 22:24:44,681 [trainer.py] => syn_size: 32
2025-01-03 22:24:44,681 [trainer.py] => vpt_type: Deep
2025-01-03 22:24:44,681 [trainer.py] => prompt_token_num: 6
2025-01-03 22:24:44,681 [trainer.py] => avg_alpha: 0.8
2025-01-03 22:24:44,681 [trainer.py] => perturb_var: 1
2025-01-03 22:24:44,681 [trainer.py] => EMA_beta: 0.99
2025-01-03 22:24:44,681 [trainer.py] => anchor_lambda: 0.1
2025-01-03 22:24:44,681 [trainer.py] => kl_weight: 0.001
2025-01-03 22:24:44,681 [trainer.py] => TIP_init: zero
2025-01-03 22:24:44,681 [trainer.py] => tuned_epoch: 10
2025-01-03 22:24:44,681 [trainer.py] => fs_epoch: 0
2025-01-03 22:24:44,681 [trainer.py] => init_lr: 0.01
2025-01-03 22:24:44,681 [trainer.py] => fs_lr: 0.001
2025-01-03 22:24:44,681 [trainer.py] => batch_size: 48
2025-01-03 22:24:44,681 [trainer.py] => fs_batch_size: 16
2025-01-03 22:24:44,682 [trainer.py] => weight_decay: 0.0005
2025-01-03 22:24:44,682 [trainer.py] => min_lr: 0
2025-01-03 22:24:44,682 [trainer.py] => optimizer: sgd
2025-01-03 22:24:44,682 [trainer.py] => memory_size: 0
2025-01-03 22:24:44,682 [trainer.py] => memory_per_class: 0
2025-01-03 22:24:44,682 [trainer.py] => fixed_memory: False
2025-01-03 22:24:44,682 [trainer.py] => shuffle: False
2025-01-03 22:24:44,682 [trainer.py] => top_k: 5
2025-01-03 22:24:44,682 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 22:24:44,682 [trainer.py] => prefix: asp
2025-01-03 22:24:44,682 [trainer.py] => model_prefix: asp
2025-01-03 22:24:47,899 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 22:25:09,519 [trainer.py] => All params: 173596160
2025-01-03 22:25:09,520 [trainer.py] => Trainable params: 1998848
2025-01-03 22:25:09,963 [asp.py] => Learning on 0-60
2025-01-03 22:25:10,388 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 22:25:10,666 [asp.py] => total parameters: 173642241
2025-01-03 22:25:10,682 [asp.py] => trainable parameters: 2044929
2025-01-03 22:27:22,693 [asp.py] => Task 0, Epoch 1 => Loss 3.600, Train_accy 32.11, Test_curr_accy 89.13, Test_accy 89.13
2025-01-03 22:37:47,504 [asp.py] => Task 0, Epoch 1 => Loss 3.643, Train_accy 30.98, Test_curr_accy 88.62, Test_accy 88.62
2025-01-03 22:37:56,351 [trainer.py] => config: ./exps/cifar.json
2025-01-03 22:37:56,351 [trainer.py] => model_name: asp
2025-01-03 22:37:56,351 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 22:37:56,352 [trainer.py] => device: [device(type='cuda', index=4)]
2025-01-03 22:37:56,352 [trainer.py] => seed: 2024
2025-01-03 22:37:56,352 [trainer.py] => dataset: cifar224
2025-01-03 22:37:56,352 [trainer.py] => init_cls: 60
2025-01-03 22:37:56,352 [trainer.py] => increment: 5
2025-01-03 22:37:56,352 [trainer.py] => kshot: 5
2025-01-03 22:37:56,352 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 22:37:56,352 [trainer.py] => z_dim: 1000
2025-01-03 22:37:56,352 [trainer.py] => conv_dim: 64
2025-01-03 22:37:56,352 [trainer.py] => img_size: 224
2025-01-03 22:37:56,352 [trainer.py] => generator_lr: 0.001
2025-01-03 22:37:56,352 [trainer.py] => pi: 100
2025-01-03 22:37:56,352 [trainer.py] => w_bn: 50.0
2025-01-03 22:37:56,352 [trainer.py] => w_noise: 0.001
2025-01-03 22:37:56,352 [trainer.py] => server_ss: 32
2025-01-03 22:37:56,352 [trainer.py] => bn_loss: 1
2025-01-03 22:37:56,352 [trainer.py] => noise: 1
2025-01-03 22:37:56,352 [trainer.py] => ie_loss: 1
2025-01-03 22:37:56,352 [trainer.py] => act_loss: 0
2025-01-03 22:37:56,352 [trainer.py] => w_ie: 1.0
2025-01-03 22:37:56,352 [trainer.py] => w_act: 0.1
2025-01-03 22:37:56,352 [trainer.py] => syn_size: 32
2025-01-03 22:37:56,352 [trainer.py] => vpt_type: Deep
2025-01-03 22:37:56,352 [trainer.py] => prompt_token_num: 6
2025-01-03 22:37:56,352 [trainer.py] => avg_alpha: 0.8
2025-01-03 22:37:56,352 [trainer.py] => perturb_var: 1
2025-01-03 22:37:56,352 [trainer.py] => EMA_beta: 0.99
2025-01-03 22:37:56,352 [trainer.py] => anchor_lambda: 0.1
2025-01-03 22:37:56,352 [trainer.py] => kl_weight: 0.001
2025-01-03 22:37:56,352 [trainer.py] => TIP_init: zero
2025-01-03 22:37:56,352 [trainer.py] => tuned_epoch: 10
2025-01-03 22:37:56,352 [trainer.py] => fs_epoch: 0
2025-01-03 22:37:56,352 [trainer.py] => init_lr: 0.01
2025-01-03 22:37:56,352 [trainer.py] => fs_lr: 0.001
2025-01-03 22:37:56,353 [trainer.py] => batch_size: 48
2025-01-03 22:37:56,353 [trainer.py] => fs_batch_size: 16
2025-01-03 22:37:56,353 [trainer.py] => weight_decay: 0.0005
2025-01-03 22:37:56,353 [trainer.py] => min_lr: 0
2025-01-03 22:37:56,353 [trainer.py] => optimizer: sgd
2025-01-03 22:37:56,353 [trainer.py] => memory_size: 0
2025-01-03 22:37:56,353 [trainer.py] => memory_per_class: 0
2025-01-03 22:37:56,353 [trainer.py] => fixed_memory: False
2025-01-03 22:37:56,353 [trainer.py] => shuffle: False
2025-01-03 22:37:56,353 [trainer.py] => top_k: 5
2025-01-03 22:37:56,353 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 22:37:56,353 [trainer.py] => prefix: asp
2025-01-03 22:37:56,353 [trainer.py] => model_prefix: asp
2025-01-03 22:37:58,552 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 22:38:17,107 [trainer.py] => All params: 173596160
2025-01-03 22:38:17,108 [trainer.py] => Trainable params: 1998848
2025-01-03 22:38:17,512 [asp.py] => Learning on 0-60
2025-01-03 22:38:17,587 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 22:38:18,056 [asp.py] => total parameters: 173642241
2025-01-03 22:38:18,148 [asp.py] => trainable parameters: 2044929
2025-01-03 22:40:01,785 [asp.py] => Task 0, Epoch 2 => Loss 1.029, Train_accy 77.93, Test_curr_accy 91.28, Test_accy 91.28
2025-01-03 22:40:42,983 [trainer.py] => config: ./exps/cifar.json
2025-01-03 22:40:42,984 [trainer.py] => model_name: asp
2025-01-03 22:40:42,984 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 22:40:42,984 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-03 22:40:42,984 [trainer.py] => seed: 2024
2025-01-03 22:40:42,984 [trainer.py] => dataset: cifar224
2025-01-03 22:40:42,984 [trainer.py] => init_cls: 60
2025-01-03 22:40:42,984 [trainer.py] => increment: 5
2025-01-03 22:40:42,984 [trainer.py] => kshot: 5
2025-01-03 22:40:42,984 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 22:40:42,984 [trainer.py] => z_dim: 1000
2025-01-03 22:40:42,984 [trainer.py] => conv_dim: 64
2025-01-03 22:40:42,984 [trainer.py] => img_size: 224
2025-01-03 22:40:42,984 [trainer.py] => generator_lr: 0.001
2025-01-03 22:40:42,984 [trainer.py] => pi: 100
2025-01-03 22:40:42,984 [trainer.py] => w_bn: 50.0
2025-01-03 22:40:42,984 [trainer.py] => w_noise: 0.001
2025-01-03 22:40:42,984 [trainer.py] => server_ss: 32
2025-01-03 22:40:42,984 [trainer.py] => bn_loss: 1
2025-01-03 22:40:42,984 [trainer.py] => noise: 1
2025-01-03 22:40:42,984 [trainer.py] => ie_loss: 1
2025-01-03 22:40:42,984 [trainer.py] => act_loss: 0
2025-01-03 22:40:42,984 [trainer.py] => w_ie: 1.0
2025-01-03 22:40:42,985 [trainer.py] => w_act: 0.1
2025-01-03 22:40:42,985 [trainer.py] => syn_size: 32
2025-01-03 22:40:42,985 [trainer.py] => vpt_type: Deep
2025-01-03 22:40:42,985 [trainer.py] => prompt_token_num: 6
2025-01-03 22:40:42,985 [trainer.py] => avg_alpha: 0.8
2025-01-03 22:40:42,985 [trainer.py] => perturb_var: 1
2025-01-03 22:40:42,985 [trainer.py] => EMA_beta: 0.99
2025-01-03 22:40:42,985 [trainer.py] => anchor_lambda: 0.1
2025-01-03 22:40:42,985 [trainer.py] => kl_weight: 0.001
2025-01-03 22:40:42,985 [trainer.py] => TIP_init: zero
2025-01-03 22:40:42,985 [trainer.py] => tuned_epoch: 10
2025-01-03 22:40:42,985 [trainer.py] => fs_epoch: 0
2025-01-03 22:40:42,985 [trainer.py] => init_lr: 0.05
2025-01-03 22:40:42,985 [trainer.py] => fs_lr: 0.001
2025-01-03 22:40:42,985 [trainer.py] => batch_size: 48
2025-01-03 22:40:42,985 [trainer.py] => fs_batch_size: 16
2025-01-03 22:40:42,985 [trainer.py] => weight_decay: 0.0005
2025-01-03 22:40:42,985 [trainer.py] => min_lr: 0
2025-01-03 22:40:42,985 [trainer.py] => optimizer: sgd
2025-01-03 22:40:42,985 [trainer.py] => memory_size: 0
2025-01-03 22:40:42,985 [trainer.py] => memory_per_class: 0
2025-01-03 22:40:42,985 [trainer.py] => fixed_memory: False
2025-01-03 22:40:42,985 [trainer.py] => shuffle: False
2025-01-03 22:40:42,985 [trainer.py] => top_k: 5
2025-01-03 22:40:42,985 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 22:40:42,985 [trainer.py] => prefix: asp
2025-01-03 22:40:42,985 [trainer.py] => model_prefix: asp
2025-01-03 22:40:44,607 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 22:40:55,571 [trainer.py] => All params: 173596160
2025-01-03 22:40:55,572 [trainer.py] => Trainable params: 1998848
2025-01-03 22:40:55,935 [asp.py] => Learning on 0-60
2025-01-03 22:40:56,452 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 22:40:56,594 [asp.py] => total parameters: 173642241
2025-01-03 22:40:56,595 [asp.py] => trainable parameters: 2044929
2025-01-03 22:41:14,409 [trainer.py] => config: ./exps/cifar.json
2025-01-03 22:41:14,409 [trainer.py] => model_name: asp
2025-01-03 22:41:14,409 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 22:41:14,409 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-03 22:41:14,409 [trainer.py] => seed: 2024
2025-01-03 22:41:14,409 [trainer.py] => dataset: cifar224
2025-01-03 22:41:14,409 [trainer.py] => init_cls: 60
2025-01-03 22:41:14,409 [trainer.py] => increment: 5
2025-01-03 22:41:14,409 [trainer.py] => kshot: 5
2025-01-03 22:41:14,409 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 22:41:14,409 [trainer.py] => z_dim: 1000
2025-01-03 22:41:14,409 [trainer.py] => conv_dim: 64
2025-01-03 22:41:14,409 [trainer.py] => img_size: 224
2025-01-03 22:41:14,409 [trainer.py] => generator_lr: 0.001
2025-01-03 22:41:14,409 [trainer.py] => pi: 100
2025-01-03 22:41:14,410 [trainer.py] => w_bn: 50.0
2025-01-03 22:41:14,410 [trainer.py] => w_noise: 0.001
2025-01-03 22:41:14,410 [trainer.py] => server_ss: 32
2025-01-03 22:41:14,410 [trainer.py] => bn_loss: 1
2025-01-03 22:41:14,410 [trainer.py] => noise: 1
2025-01-03 22:41:14,410 [trainer.py] => ie_loss: 1
2025-01-03 22:41:14,410 [trainer.py] => act_loss: 0
2025-01-03 22:41:14,410 [trainer.py] => w_ie: 1.0
2025-01-03 22:41:14,410 [trainer.py] => w_act: 0.1
2025-01-03 22:41:14,410 [trainer.py] => syn_size: 32
2025-01-03 22:41:14,410 [trainer.py] => vpt_type: Deep
2025-01-03 22:41:14,410 [trainer.py] => prompt_token_num: 6
2025-01-03 22:41:14,410 [trainer.py] => avg_alpha: 0.8
2025-01-03 22:41:14,410 [trainer.py] => perturb_var: 1
2025-01-03 22:41:14,410 [trainer.py] => EMA_beta: 0.99
2025-01-03 22:41:14,410 [trainer.py] => anchor_lambda: 0.1
2025-01-03 22:41:14,410 [trainer.py] => kl_weight: 0.001
2025-01-03 22:41:14,410 [trainer.py] => TIP_init: zero
2025-01-03 22:41:14,410 [trainer.py] => tuned_epoch: 10
2025-01-03 22:41:14,410 [trainer.py] => fs_epoch: 0
2025-01-03 22:41:14,410 [trainer.py] => init_lr: 0.05
2025-01-03 22:41:14,410 [trainer.py] => fs_lr: 0.001
2025-01-03 22:41:14,410 [trainer.py] => batch_size: 48
2025-01-03 22:41:14,410 [trainer.py] => fs_batch_size: 16
2025-01-03 22:41:14,410 [trainer.py] => weight_decay: 0.0005
2025-01-03 22:41:14,410 [trainer.py] => min_lr: 0
2025-01-03 22:41:14,410 [trainer.py] => optimizer: sgd
2025-01-03 22:41:14,410 [trainer.py] => memory_size: 0
2025-01-03 22:41:14,410 [trainer.py] => memory_per_class: 0
2025-01-03 22:41:14,410 [trainer.py] => fixed_memory: False
2025-01-03 22:41:14,410 [trainer.py] => shuffle: False
2025-01-03 22:41:14,410 [trainer.py] => top_k: 5
2025-01-03 22:41:14,410 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 22:41:14,411 [trainer.py] => prefix: asp
2025-01-03 22:41:14,411 [trainer.py] => model_prefix: asp
2025-01-03 22:41:16,223 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 22:41:33,660 [trainer.py] => All params: 173596160
2025-01-03 22:41:33,661 [trainer.py] => Trainable params: 1998848
2025-01-03 22:41:34,000 [asp.py] => Learning on 0-60
2025-01-03 22:41:34,224 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 22:41:34,704 [asp.py] => total parameters: 173642241
2025-01-03 22:41:34,705 [asp.py] => trainable parameters: 2044929
2025-01-03 22:42:26,602 [asp.py] => Task 0, Epoch 1 => Loss 3.548, Train_accy 33.10, Test_curr_accy 88.72, Test_accy 88.72
2025-01-03 22:42:34,007 [asp.py] => Task 0, Epoch 1 => Loss 3.577, Train_accy 32.74, Test_curr_accy 88.93, Test_accy 88.93
2025-01-03 22:42:43,641 [trainer.py] => config: ./exps/cifar.json
2025-01-03 22:42:43,641 [trainer.py] => model_name: asp
2025-01-03 22:42:43,641 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 22:42:43,641 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-03 22:42:43,641 [trainer.py] => seed: 2024
2025-01-03 22:42:43,641 [trainer.py] => dataset: cifar224
2025-01-03 22:42:43,641 [trainer.py] => init_cls: 60
2025-01-03 22:42:43,641 [trainer.py] => increment: 5
2025-01-03 22:42:43,641 [trainer.py] => kshot: 5
2025-01-03 22:42:43,641 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 22:42:43,641 [trainer.py] => z_dim: 1000
2025-01-03 22:42:43,641 [trainer.py] => conv_dim: 64
2025-01-03 22:42:43,641 [trainer.py] => img_size: 224
2025-01-03 22:42:43,641 [trainer.py] => generator_lr: 0.001
2025-01-03 22:42:43,641 [trainer.py] => pi: 100
2025-01-03 22:42:43,641 [trainer.py] => w_bn: 50.0
2025-01-03 22:42:43,641 [trainer.py] => w_noise: 0.001
2025-01-03 22:42:43,641 [trainer.py] => server_ss: 32
2025-01-03 22:42:43,641 [trainer.py] => bn_loss: 1
2025-01-03 22:42:43,642 [trainer.py] => noise: 1
2025-01-03 22:42:43,642 [trainer.py] => ie_loss: 1
2025-01-03 22:42:43,642 [trainer.py] => act_loss: 0
2025-01-03 22:42:43,642 [trainer.py] => w_ie: 1.0
2025-01-03 22:42:43,642 [trainer.py] => w_act: 0.1
2025-01-03 22:42:43,642 [trainer.py] => syn_size: 32
2025-01-03 22:42:43,642 [trainer.py] => vpt_type: Deep
2025-01-03 22:42:43,642 [trainer.py] => prompt_token_num: 6
2025-01-03 22:42:43,642 [trainer.py] => avg_alpha: 0.8
2025-01-03 22:42:43,642 [trainer.py] => perturb_var: 1
2025-01-03 22:42:43,642 [trainer.py] => EMA_beta: 0.99
2025-01-03 22:42:43,642 [trainer.py] => anchor_lambda: 0.1
2025-01-03 22:42:43,642 [trainer.py] => kl_weight: 0.001
2025-01-03 22:42:43,642 [trainer.py] => TIP_init: zero
2025-01-03 22:42:43,642 [trainer.py] => tuned_epoch: 10
2025-01-03 22:42:43,642 [trainer.py] => fs_epoch: 0
2025-01-03 22:42:43,642 [trainer.py] => init_lr: 0.005
2025-01-03 22:42:43,642 [trainer.py] => fs_lr: 0.001
2025-01-03 22:42:43,642 [trainer.py] => batch_size: 48
2025-01-03 22:42:43,642 [trainer.py] => fs_batch_size: 16
2025-01-03 22:42:43,642 [trainer.py] => weight_decay: 0.0005
2025-01-03 22:42:43,642 [trainer.py] => min_lr: 0
2025-01-03 22:42:43,642 [trainer.py] => optimizer: sgd
2025-01-03 22:42:43,642 [trainer.py] => memory_size: 0
2025-01-03 22:42:43,642 [trainer.py] => memory_per_class: 0
2025-01-03 22:42:43,642 [trainer.py] => fixed_memory: False
2025-01-03 22:42:43,642 [trainer.py] => shuffle: False
2025-01-03 22:42:43,642 [trainer.py] => top_k: 5
2025-01-03 22:42:43,642 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 22:42:43,642 [trainer.py] => prefix: asp
2025-01-03 22:42:43,642 [trainer.py] => model_prefix: asp
2025-01-03 22:42:46,680 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 22:43:06,120 [trainer.py] => All params: 173596160
2025-01-03 22:43:06,121 [trainer.py] => Trainable params: 1998848
2025-01-03 22:43:06,540 [asp.py] => Learning on 0-60
2025-01-03 22:43:06,720 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 22:43:07,280 [asp.py] => total parameters: 173642241
2025-01-03 22:43:07,281 [asp.py] => trainable parameters: 2044929
2025-01-03 22:46:00,688 [trainer.py] => config: ./exps/cifar.json
2025-01-03 22:46:00,688 [trainer.py] => model_name: asp
2025-01-03 22:46:00,688 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 22:46:00,688 [trainer.py] => device: [device(type='cuda', index=1)]
2025-01-03 22:46:00,689 [trainer.py] => seed: 2024
2025-01-03 22:46:00,689 [trainer.py] => dataset: cifar224
2025-01-03 22:46:00,689 [trainer.py] => init_cls: 60
2025-01-03 22:46:00,689 [trainer.py] => increment: 5
2025-01-03 22:46:00,689 [trainer.py] => kshot: 5
2025-01-03 22:46:00,689 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 22:46:00,689 [trainer.py] => z_dim: 1000
2025-01-03 22:46:00,689 [trainer.py] => conv_dim: 64
2025-01-03 22:46:00,689 [trainer.py] => img_size: 224
2025-01-03 22:46:00,689 [trainer.py] => generator_lr: 0.001
2025-01-03 22:46:00,689 [trainer.py] => pi: 100
2025-01-03 22:46:00,689 [trainer.py] => w_bn: 50.0
2025-01-03 22:46:00,689 [trainer.py] => w_noise: 0.001
2025-01-03 22:46:00,689 [trainer.py] => server_ss: 32
2025-01-03 22:46:00,689 [trainer.py] => bn_loss: 1
2025-01-03 22:46:00,689 [trainer.py] => noise: 1
2025-01-03 22:46:00,689 [trainer.py] => ie_loss: 1
2025-01-03 22:46:00,689 [trainer.py] => act_loss: 0
2025-01-03 22:46:00,689 [trainer.py] => w_ie: 1.0
2025-01-03 22:46:00,689 [trainer.py] => w_act: 0.1
2025-01-03 22:46:00,689 [trainer.py] => syn_size: 32
2025-01-03 22:46:00,689 [trainer.py] => vpt_type: Deep
2025-01-03 22:46:00,689 [trainer.py] => prompt_token_num: 6
2025-01-03 22:46:00,689 [trainer.py] => avg_alpha: 0.8
2025-01-03 22:46:00,689 [trainer.py] => perturb_var: 1
2025-01-03 22:46:00,689 [trainer.py] => EMA_beta: 0.99
2025-01-03 22:46:00,689 [trainer.py] => anchor_lambda: 0.1
2025-01-03 22:46:00,689 [trainer.py] => kl_weight: 0.001
2025-01-03 22:46:00,689 [trainer.py] => TIP_init: zero
2025-01-03 22:46:00,689 [trainer.py] => tuned_epoch: 10
2025-01-03 22:46:00,689 [trainer.py] => fs_epoch: 0
2025-01-03 22:46:00,689 [trainer.py] => init_lr: 0.01
2025-01-03 22:46:00,689 [trainer.py] => fs_lr: 0.001
2025-01-03 22:46:00,689 [trainer.py] => batch_size: 48
2025-01-03 22:46:00,690 [trainer.py] => fs_batch_size: 16
2025-01-03 22:46:00,690 [trainer.py] => weight_decay: 0.0005
2025-01-03 22:46:00,690 [trainer.py] => min_lr: 0
2025-01-03 22:46:00,690 [trainer.py] => optimizer: sgd
2025-01-03 22:46:00,690 [trainer.py] => memory_size: 0
2025-01-03 22:46:00,690 [trainer.py] => memory_per_class: 0
2025-01-03 22:46:00,690 [trainer.py] => fixed_memory: False
2025-01-03 22:46:00,690 [trainer.py] => shuffle: False
2025-01-03 22:46:00,690 [trainer.py] => top_k: 5
2025-01-03 22:46:00,690 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 22:46:00,690 [trainer.py] => prefix: asp
2025-01-03 22:46:00,690 [trainer.py] => model_prefix: asp
2025-01-03 22:46:03,978 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 22:46:17,535 [trainer.py] => All params: 173596160
2025-01-03 22:46:17,536 [trainer.py] => Trainable params: 1998848
2025-01-03 22:46:17,910 [asp.py] => Learning on 0-60
2025-01-03 22:46:18,037 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 22:46:18,302 [asp.py] => total parameters: 173642241
2025-01-03 22:46:18,303 [asp.py] => trainable parameters: 2044929
2025-01-03 22:53:09,486 [asp.py] => Task 0, Epoch 3 => Loss 0.868, Train_accy 80.02, Test_curr_accy 91.93, Test_accy 91.93
2025-01-03 23:04:04,304 [asp.py] => Task 0, Epoch 1 => Loss nan, Train_accy 1.63, Test_curr_accy 1.67, Test_accy 1.67
2025-01-03 23:06:30,635 [asp.py] => Task 0, Epoch 4 => Loss 0.811, Train_accy 80.96, Test_curr_accy 92.10, Test_accy 92.10
2025-01-03 23:06:38,514 [asp.py] => Task 0, Epoch 1 => Loss 3.520, Train_accy 33.59, Test_curr_accy 89.17, Test_accy 89.17
2025-01-03 23:08:40,218 [asp.py] => Task 0, Epoch 1 => Loss 4.822, Train_accy 1.79, Test_curr_accy 3.20, Test_accy 3.20
2025-01-03 23:09:09,340 [asp.py] => Task 0, Epoch 2 => Loss 1.024, Train_accy 78.00, Test_curr_accy 91.28, Test_accy 91.28
2025-01-03 23:09:28,351 [asp.py] => Task 0, Epoch 2 => Loss 1.025, Train_accy 77.99, Test_curr_accy 91.03, Test_accy 91.03
2025-01-03 23:21:45,174 [asp.py] => Task 0, Epoch 5 => Loss 0.784, Train_accy 81.29, Test_curr_accy 92.83, Test_accy 92.83
2025-01-03 23:28:44,981 [asp.py] => Task 0, Epoch 2 => Loss 1.018, Train_accy 77.94, Test_curr_accy 91.15, Test_accy 91.15
2025-01-03 23:28:54,634 [asp.py] => Task 0, Epoch 2 => Loss nan, Train_accy 1.67, Test_curr_accy 1.67, Test_accy 1.67
2025-01-03 23:32:43,308 [trainer.py] => config: ./exps/cifar.json
2025-01-03 23:32:43,308 [trainer.py] => model_name: asp
2025-01-03 23:32:43,308 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 23:32:43,308 [trainer.py] => device: [device(type='cuda', index=6)]
2025-01-03 23:32:43,308 [trainer.py] => seed: 2024
2025-01-03 23:32:43,308 [trainer.py] => dataset: cifar224
2025-01-03 23:32:43,308 [trainer.py] => init_cls: 60
2025-01-03 23:32:43,308 [trainer.py] => increment: 5
2025-01-03 23:32:43,308 [trainer.py] => kshot: 5
2025-01-03 23:32:43,308 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 23:32:43,308 [trainer.py] => z_dim: 1000
2025-01-03 23:32:43,308 [trainer.py] => conv_dim: 64
2025-01-03 23:32:43,308 [trainer.py] => img_size: 224
2025-01-03 23:32:43,309 [trainer.py] => generator_lr: 0.001
2025-01-03 23:32:43,309 [trainer.py] => pi: 100
2025-01-03 23:32:43,309 [trainer.py] => w_bn: 50.0
2025-01-03 23:32:43,309 [trainer.py] => w_noise: 0.001
2025-01-03 23:32:43,309 [trainer.py] => server_ss: 32
2025-01-03 23:32:43,309 [trainer.py] => bn_loss: 1
2025-01-03 23:32:43,309 [trainer.py] => noise: 1
2025-01-03 23:32:43,309 [trainer.py] => ie_loss: 1
2025-01-03 23:32:43,309 [trainer.py] => act_loss: 0
2025-01-03 23:32:43,309 [trainer.py] => w_ie: 1.0
2025-01-03 23:32:43,309 [trainer.py] => w_act: 0.1
2025-01-03 23:32:43,309 [trainer.py] => syn_size: 32
2025-01-03 23:32:43,309 [trainer.py] => vpt_type: Deep
2025-01-03 23:32:43,309 [trainer.py] => prompt_token_num: 6
2025-01-03 23:32:43,309 [trainer.py] => avg_alpha: 0.8
2025-01-03 23:32:43,309 [trainer.py] => perturb_var: 1
2025-01-03 23:32:43,309 [trainer.py] => EMA_beta: 0.99
2025-01-03 23:32:43,309 [trainer.py] => anchor_lambda: 0.1
2025-01-03 23:32:43,309 [trainer.py] => kl_weight: 0.001
2025-01-03 23:32:43,309 [trainer.py] => TIP_init: zero
2025-01-03 23:32:43,309 [trainer.py] => tuned_epoch: 10
2025-01-03 23:32:43,309 [trainer.py] => fs_epoch: 0
2025-01-03 23:32:43,309 [trainer.py] => init_lr: 0.02
2025-01-03 23:32:43,309 [trainer.py] => fs_lr: 0.001
2025-01-03 23:32:43,309 [trainer.py] => batch_size: 48
2025-01-03 23:32:43,309 [trainer.py] => fs_batch_size: 16
2025-01-03 23:32:43,309 [trainer.py] => weight_decay: 0.0005
2025-01-03 23:32:43,309 [trainer.py] => min_lr: 0
2025-01-03 23:32:43,309 [trainer.py] => optimizer: sgd
2025-01-03 23:32:43,309 [trainer.py] => memory_size: 0
2025-01-03 23:32:43,309 [trainer.py] => memory_per_class: 0
2025-01-03 23:32:43,310 [trainer.py] => fixed_memory: False
2025-01-03 23:32:43,310 [trainer.py] => shuffle: False
2025-01-03 23:32:43,310 [trainer.py] => top_k: 5
2025-01-03 23:32:43,310 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 23:32:43,310 [trainer.py] => prefix: asp
2025-01-03 23:32:43,310 [trainer.py] => model_prefix: asp
2025-01-03 23:32:47,674 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 23:33:38,265 [trainer.py] => All params: 173596160
2025-01-03 23:33:38,266 [trainer.py] => Trainable params: 1998848
2025-01-03 23:33:38,894 [asp.py] => Learning on 0-60
2025-01-03 23:33:39,073 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 23:33:39,461 [asp.py] => total parameters: 173642241
2025-01-03 23:33:39,462 [asp.py] => trainable parameters: 2044929
2025-01-03 23:33:47,578 [trainer.py] => config: ./exps/cifar.json
2025-01-03 23:33:47,584 [trainer.py] => model_name: asp
2025-01-03 23:33:47,585 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 23:33:47,585 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-03 23:33:47,585 [trainer.py] => seed: 2024
2025-01-03 23:33:47,585 [trainer.py] => dataset: cifar224
2025-01-03 23:33:47,585 [trainer.py] => init_cls: 60
2025-01-03 23:33:47,586 [trainer.py] => increment: 5
2025-01-03 23:33:47,586 [trainer.py] => kshot: 5
2025-01-03 23:33:47,586 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 23:33:47,586 [trainer.py] => z_dim: 1000
2025-01-03 23:33:47,586 [trainer.py] => conv_dim: 64
2025-01-03 23:33:47,586 [trainer.py] => img_size: 224
2025-01-03 23:33:47,587 [trainer.py] => generator_lr: 0.001
2025-01-03 23:33:47,587 [trainer.py] => pi: 100
2025-01-03 23:33:47,587 [trainer.py] => w_bn: 50.0
2025-01-03 23:33:47,587 [trainer.py] => w_noise: 0.001
2025-01-03 23:33:47,587 [trainer.py] => server_ss: 32
2025-01-03 23:33:47,587 [trainer.py] => bn_loss: 1
2025-01-03 23:33:47,588 [trainer.py] => noise: 1
2025-01-03 23:33:47,588 [trainer.py] => ie_loss: 1
2025-01-03 23:33:47,588 [trainer.py] => act_loss: 0
2025-01-03 23:33:47,588 [trainer.py] => w_ie: 1.0
2025-01-03 23:33:47,588 [trainer.py] => w_act: 0.1
2025-01-03 23:33:47,589 [trainer.py] => syn_size: 32
2025-01-03 23:33:47,589 [trainer.py] => vpt_type: Deep
2025-01-03 23:33:47,589 [trainer.py] => prompt_token_num: 6
2025-01-03 23:33:47,589 [trainer.py] => avg_alpha: 0.8
2025-01-03 23:33:47,589 [trainer.py] => perturb_var: 1
2025-01-03 23:33:47,590 [trainer.py] => EMA_beta: 0.99
2025-01-03 23:33:47,590 [trainer.py] => anchor_lambda: 0.1
2025-01-03 23:33:47,590 [trainer.py] => kl_weight: 0.001
2025-01-03 23:33:47,590 [trainer.py] => TIP_init: zero
2025-01-03 23:33:47,590 [trainer.py] => tuned_epoch: 10
2025-01-03 23:33:47,590 [trainer.py] => fs_epoch: 0
2025-01-03 23:33:47,590 [trainer.py] => init_lr: 0.007
2025-01-03 23:33:47,590 [trainer.py] => fs_lr: 0.001
2025-01-03 23:33:47,590 [trainer.py] => batch_size: 48
2025-01-03 23:33:47,590 [trainer.py] => fs_batch_size: 16
2025-01-03 23:33:47,590 [trainer.py] => weight_decay: 0.0005
2025-01-03 23:33:47,590 [trainer.py] => min_lr: 0
2025-01-03 23:33:47,590 [trainer.py] => optimizer: sgd
2025-01-03 23:33:47,590 [trainer.py] => memory_size: 0
2025-01-03 23:33:47,590 [trainer.py] => memory_per_class: 0
2025-01-03 23:33:47,590 [trainer.py] => fixed_memory: False
2025-01-03 23:33:47,590 [trainer.py] => shuffle: False
2025-01-03 23:33:47,590 [trainer.py] => top_k: 5
2025-01-03 23:33:47,590 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 23:33:47,590 [trainer.py] => prefix: asp
2025-01-03 23:33:47,590 [trainer.py] => model_prefix: asp
2025-01-03 23:33:48,095 [asp.py] => Task 0, Epoch 2 => Loss 4.235, Train_accy 3.77, Test_curr_accy 4.23, Test_accy 4.23
2025-01-03 23:33:49,625 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 23:34:29,160 [trainer.py] => All params: 173596160
2025-01-03 23:34:29,161 [trainer.py] => Trainable params: 1998848
2025-01-03 23:34:29,616 [asp.py] => Learning on 0-60
2025-01-03 23:34:29,795 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 23:34:30,107 [asp.py] => total parameters: 173642241
2025-01-03 23:34:30,108 [asp.py] => trainable parameters: 2044929
2025-01-03 23:34:58,442 [asp.py] => Task 0, Epoch 3 => Loss 0.863, Train_accy 79.98, Test_curr_accy 92.13, Test_accy 92.13
2025-01-03 23:35:03,131 [asp.py] => Task 0, Epoch 6 => Loss 0.764, Train_accy 81.49, Test_curr_accy 92.67, Test_accy 92.67
2025-01-03 23:35:26,802 [asp.py] => Task 0, Epoch 3 => Loss 0.873, Train_accy 80.06, Test_curr_accy 91.88, Test_accy 91.88
2025-01-03 23:37:02,110 [trainer.py] => config: ./exps/cifar.json
2025-01-03 23:37:02,111 [trainer.py] => model_name: asp
2025-01-03 23:37:02,111 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 23:37:02,111 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-03 23:37:02,111 [trainer.py] => seed: 2024
2025-01-03 23:37:02,111 [trainer.py] => dataset: cifar224
2025-01-03 23:37:02,111 [trainer.py] => init_cls: 60
2025-01-03 23:37:02,112 [trainer.py] => increment: 5
2025-01-03 23:37:02,112 [trainer.py] => kshot: 5
2025-01-03 23:37:02,112 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 23:37:02,112 [trainer.py] => z_dim: 1000
2025-01-03 23:37:02,112 [trainer.py] => conv_dim: 64
2025-01-03 23:37:02,112 [trainer.py] => img_size: 224
2025-01-03 23:37:02,113 [trainer.py] => generator_lr: 0.001
2025-01-03 23:37:02,113 [trainer.py] => pi: 100
2025-01-03 23:37:02,113 [trainer.py] => w_bn: 50.0
2025-01-03 23:37:02,113 [trainer.py] => w_noise: 0.001
2025-01-03 23:37:02,113 [trainer.py] => server_ss: 32
2025-01-03 23:37:02,113 [trainer.py] => bn_loss: 1
2025-01-03 23:37:02,114 [trainer.py] => noise: 1
2025-01-03 23:37:02,114 [trainer.py] => ie_loss: 1
2025-01-03 23:37:02,114 [trainer.py] => act_loss: 0
2025-01-03 23:37:02,114 [trainer.py] => w_ie: 1.0
2025-01-03 23:37:02,114 [trainer.py] => w_act: 0.1
2025-01-03 23:37:02,114 [trainer.py] => syn_size: 32
2025-01-03 23:37:02,115 [trainer.py] => vpt_type: Deep
2025-01-03 23:37:02,115 [trainer.py] => prompt_token_num: 6
2025-01-03 23:37:02,115 [trainer.py] => avg_alpha: 0.8
2025-01-03 23:37:02,115 [trainer.py] => perturb_var: 1
2025-01-03 23:37:02,115 [trainer.py] => EMA_beta: 0.99
2025-01-03 23:37:02,115 [trainer.py] => anchor_lambda: 0.1
2025-01-03 23:37:02,116 [trainer.py] => kl_weight: 0.001
2025-01-03 23:37:02,117 [trainer.py] => TIP_init: zero
2025-01-03 23:37:02,117 [trainer.py] => tuned_epoch: 10
2025-01-03 23:37:02,117 [trainer.py] => fs_epoch: 0
2025-01-03 23:37:02,117 [trainer.py] => init_lr: 0.007
2025-01-03 23:37:02,117 [trainer.py] => fs_lr: 0.001
2025-01-03 23:37:02,117 [trainer.py] => batch_size: 48
2025-01-03 23:37:02,117 [trainer.py] => fs_batch_size: 16
2025-01-03 23:37:02,117 [trainer.py] => weight_decay: 0.0005
2025-01-03 23:37:02,117 [trainer.py] => min_lr: 0
2025-01-03 23:37:02,117 [trainer.py] => optimizer: sgd
2025-01-03 23:37:02,117 [trainer.py] => memory_size: 0
2025-01-03 23:37:02,117 [trainer.py] => memory_per_class: 0
2025-01-03 23:37:02,117 [trainer.py] => fixed_memory: False
2025-01-03 23:37:02,117 [trainer.py] => shuffle: False
2025-01-03 23:37:02,117 [trainer.py] => top_k: 5
2025-01-03 23:37:02,117 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 23:37:02,117 [trainer.py] => prefix: asp
2025-01-03 23:37:02,117 [trainer.py] => model_prefix: asp
2025-01-03 23:37:11,919 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 23:37:44,539 [trainer.py] => All params: 173596160
2025-01-03 23:37:44,540 [trainer.py] => Trainable params: 1998848
2025-01-03 23:37:45,242 [asp.py] => Learning on 0-60
2025-01-03 23:37:45,953 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 23:41:34,092 [trainer.py] => config: ./exps/cifar.json
2025-01-03 23:41:34,092 [trainer.py] => model_name: asp
2025-01-03 23:41:34,092 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 23:41:34,092 [trainer.py] => device: [device(type='cuda', index=5)]
2025-01-03 23:41:34,093 [trainer.py] => seed: 2024
2025-01-03 23:41:34,093 [trainer.py] => dataset: cifar224
2025-01-03 23:41:34,093 [trainer.py] => init_cls: 60
2025-01-03 23:41:34,093 [trainer.py] => increment: 5
2025-01-03 23:41:34,093 [trainer.py] => kshot: 5
2025-01-03 23:41:34,093 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 23:41:34,093 [trainer.py] => z_dim: 1000
2025-01-03 23:41:34,093 [trainer.py] => conv_dim: 64
2025-01-03 23:41:34,093 [trainer.py] => img_size: 224
2025-01-03 23:41:34,093 [trainer.py] => generator_lr: 0.001
2025-01-03 23:41:34,093 [trainer.py] => pi: 100
2025-01-03 23:41:34,093 [trainer.py] => w_bn: 50.0
2025-01-03 23:41:34,093 [trainer.py] => w_noise: 0.001
2025-01-03 23:41:34,093 [trainer.py] => server_ss: 32
2025-01-03 23:41:34,093 [trainer.py] => bn_loss: 1
2025-01-03 23:41:34,093 [trainer.py] => noise: 1
2025-01-03 23:41:34,093 [trainer.py] => ie_loss: 1
2025-01-03 23:41:34,093 [trainer.py] => act_loss: 0
2025-01-03 23:41:34,093 [trainer.py] => w_ie: 1.0
2025-01-03 23:41:34,093 [trainer.py] => w_act: 0.1
2025-01-03 23:41:34,093 [trainer.py] => syn_size: 32
2025-01-03 23:41:34,093 [trainer.py] => vpt_type: Deep
2025-01-03 23:41:34,093 [trainer.py] => prompt_token_num: 6
2025-01-03 23:41:34,093 [trainer.py] => avg_alpha: 0.8
2025-01-03 23:41:34,093 [trainer.py] => perturb_var: 1
2025-01-03 23:41:34,093 [trainer.py] => EMA_beta: 0.99
2025-01-03 23:41:34,093 [trainer.py] => anchor_lambda: 0.1
2025-01-03 23:41:34,094 [trainer.py] => kl_weight: 0.001
2025-01-03 23:41:34,094 [trainer.py] => TIP_init: zero
2025-01-03 23:41:34,094 [trainer.py] => tuned_epoch: 10
2025-01-03 23:41:34,094 [trainer.py] => fs_epoch: 0
2025-01-03 23:41:34,094 [trainer.py] => init_lr: 0.01
2025-01-03 23:41:34,094 [trainer.py] => fs_lr: 0.001
2025-01-03 23:41:34,094 [trainer.py] => batch_size: 48
2025-01-03 23:41:34,094 [trainer.py] => fs_batch_size: 16
2025-01-03 23:41:34,094 [trainer.py] => weight_decay: 0.0005
2025-01-03 23:41:34,094 [trainer.py] => min_lr: 0
2025-01-03 23:41:34,094 [trainer.py] => optimizer: sgd
2025-01-03 23:41:34,094 [trainer.py] => memory_size: 0
2025-01-03 23:41:34,094 [trainer.py] => memory_per_class: 0
2025-01-03 23:41:34,094 [trainer.py] => fixed_memory: False
2025-01-03 23:41:34,094 [trainer.py] => shuffle: False
2025-01-03 23:41:34,094 [trainer.py] => top_k: 5
2025-01-03 23:41:34,094 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 23:41:34,094 [trainer.py] => prefix: asp
2025-01-03 23:41:34,094 [trainer.py] => model_prefix: asp
2025-01-03 23:41:37,626 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 23:42:22,869 [trainer.py] => All params: 173596160
2025-01-03 23:42:22,870 [trainer.py] => Trainable params: 1998848
2025-01-03 23:42:23,449 [asp.py] => Learning on 0-60
2025-01-03 23:42:23,896 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 23:48:23,611 [asp.py] => Task 0, Epoch 3 => Loss 0.871, Train_accy 79.85, Test_curr_accy 91.70, Test_accy 91.70
2025-01-03 23:52:42,020 [asp.py] => Task 0, Epoch 7 => Loss 0.728, Train_accy 82.31, Test_curr_accy 92.68, Test_accy 92.68
2025-01-03 23:53:31,585 [asp.py] => Task 0, Epoch 3 => Loss nan, Train_accy 1.67, Test_curr_accy 1.67, Test_accy 1.67
2025-01-03 23:54:41,322 [asp.py] => Task 0, Epoch 1 => Loss 3.373, Train_accy 31.36, Test_curr_accy 89.47, Test_accy 89.47
2025-01-03 23:56:07,825 [asp.py] => Task 0, Epoch 1 => Loss 4.689, Train_accy 2.89, Test_curr_accy 6.28, Test_accy 6.28
2025-01-03 23:56:25,375 [trainer.py] => config: ./exps/cifar.json
2025-01-03 23:56:25,375 [trainer.py] => model_name: asp
2025-01-03 23:56:25,375 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-03 23:56:25,375 [trainer.py] => device: [device(type='cuda', index=4)]
2025-01-03 23:56:25,375 [trainer.py] => seed: 2024
2025-01-03 23:56:25,375 [trainer.py] => dataset: cifar224
2025-01-03 23:56:25,375 [trainer.py] => init_cls: 60
2025-01-03 23:56:25,375 [trainer.py] => increment: 5
2025-01-03 23:56:25,375 [trainer.py] => kshot: 5
2025-01-03 23:56:25,375 [trainer.py] => generator_model: CIFAR_GEN
2025-01-03 23:56:25,375 [trainer.py] => z_dim: 1000
2025-01-03 23:56:25,375 [trainer.py] => conv_dim: 64
2025-01-03 23:56:25,375 [trainer.py] => img_size: 224
2025-01-03 23:56:25,375 [trainer.py] => generator_lr: 0.001
2025-01-03 23:56:25,375 [trainer.py] => pi: 100
2025-01-03 23:56:25,375 [trainer.py] => w_bn: 50.0
2025-01-03 23:56:25,375 [trainer.py] => w_noise: 0.001
2025-01-03 23:56:25,375 [trainer.py] => server_ss: 32
2025-01-03 23:56:25,375 [trainer.py] => bn_loss: 1
2025-01-03 23:56:25,376 [trainer.py] => noise: 1
2025-01-03 23:56:25,376 [trainer.py] => ie_loss: 1
2025-01-03 23:56:25,376 [trainer.py] => act_loss: 0
2025-01-03 23:56:25,376 [trainer.py] => w_ie: 1.0
2025-01-03 23:56:25,376 [trainer.py] => w_act: 0.1
2025-01-03 23:56:25,376 [trainer.py] => syn_size: 32
2025-01-03 23:56:25,376 [trainer.py] => vpt_type: Deep
2025-01-03 23:56:25,376 [trainer.py] => prompt_token_num: 6
2025-01-03 23:56:25,376 [trainer.py] => avg_alpha: 0.8
2025-01-03 23:56:25,376 [trainer.py] => perturb_var: 1
2025-01-03 23:56:25,376 [trainer.py] => EMA_beta: 0.99
2025-01-03 23:56:25,376 [trainer.py] => anchor_lambda: 0.1
2025-01-03 23:56:25,376 [trainer.py] => kl_weight: 0.001
2025-01-03 23:56:25,376 [trainer.py] => TIP_init: zero
2025-01-03 23:56:25,376 [trainer.py] => tuned_epoch: 10
2025-01-03 23:56:25,376 [trainer.py] => fs_epoch: 0
2025-01-03 23:56:25,376 [trainer.py] => init_lr: 0.01
2025-01-03 23:56:25,376 [trainer.py] => fs_lr: 0.001
2025-01-03 23:56:25,376 [trainer.py] => batch_size: 48
2025-01-03 23:56:25,376 [trainer.py] => fs_batch_size: 16
2025-01-03 23:56:25,376 [trainer.py] => weight_decay: 0.0005
2025-01-03 23:56:25,376 [trainer.py] => min_lr: 0
2025-01-03 23:56:25,376 [trainer.py] => optimizer: sgd
2025-01-03 23:56:25,376 [trainer.py] => memory_size: 0
2025-01-03 23:56:25,376 [trainer.py] => memory_per_class: 0
2025-01-03 23:56:25,376 [trainer.py] => fixed_memory: False
2025-01-03 23:56:25,376 [trainer.py] => shuffle: False
2025-01-03 23:56:25,377 [trainer.py] => top_k: 5
2025-01-03 23:56:25,377 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-03 23:56:25,377 [trainer.py] => prefix: asp
2025-01-03 23:56:25,377 [trainer.py] => model_prefix: asp
2025-01-03 23:56:28,211 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-03 23:57:09,028 [trainer.py] => All params: 173596160
2025-01-03 23:57:09,030 [trainer.py] => Trainable params: 1998848
2025-01-03 23:57:09,583 [asp.py] => Learning on 0-60
2025-01-03 23:57:09,916 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-03 23:59:09,009 [asp.py] => total parameters: 173642241
2025-01-03 23:59:09,073 [asp.py] => trainable parameters: 2044929
2025-01-03 23:59:53,275 [asp.py] => Task 0, Epoch 3 => Loss 3.939, Train_accy 9.80, Test_curr_accy 20.80, Test_accy 20.80
2025-01-04 00:02:36,384 [asp.py] => Task 0, Epoch 4 => Loss 0.800, Train_accy 81.13, Test_curr_accy 92.03, Test_accy 92.03
2025-01-04 00:02:57,173 [asp.py] => Task 0, Epoch 4 => Loss 0.807, Train_accy 80.94, Test_curr_accy 92.35, Test_accy 92.35
2025-01-04 00:09:13,271 [asp.py] => Task 0, Epoch 4 => Loss 0.809, Train_accy 80.92, Test_curr_accy 92.10, Test_accy 92.10
2025-01-04 00:11:20,046 [asp.py] => Task 0, Epoch 8 => Loss 0.733, Train_accy 82.26, Test_curr_accy 92.78, Test_accy 92.78
2025-01-04 00:13:34,730 [asp.py] => Task 0, Epoch 2 => Loss 0.999, Train_accy 77.85, Test_curr_accy 90.98, Test_accy 90.98
2025-01-04 00:15:13,686 [asp.py] => Task 0, Epoch 2 => Loss 2.557, Train_accy 48.10, Test_curr_accy 89.18, Test_accy 89.18
2025-01-04 00:16:26,047 [asp.py] => Task 0, Epoch 1 => Loss 3.941, Train_accy 22.20, Test_curr_accy 86.40, Test_accy 86.40
2025-01-04 00:20:40,193 [asp.py] => Task 0, Epoch 4 => Loss nan, Train_accy 1.67, Test_curr_accy 1.67, Test_accy 1.67
2025-01-04 00:25:25,366 [asp.py] => Task 0, Epoch 4 => Loss 3.043, Train_accy 32.00, Test_curr_accy 59.17, Test_accy 59.17
2025-01-04 00:29:36,450 [asp.py] => Task 0, Epoch 5 => Loss 0.780, Train_accy 81.39, Test_curr_accy 92.50, Test_accy 92.50
2025-01-04 00:29:55,032 [asp.py] => Task 0, Epoch 5 => Loss 0.778, Train_accy 81.31, Test_curr_accy 92.50, Test_accy 92.50
2025-01-04 00:31:11,999 [asp.py] => Task 0, Epoch 9 => Loss 0.716, Train_accy 82.63, Test_curr_accy 93.05, Test_accy 93.05
2025-01-04 00:31:22,328 [asp.py] => Task 0, Epoch 5 => Loss 0.785, Train_accy 81.17, Test_curr_accy 92.63, Test_accy 92.63
2025-01-04 00:35:13,471 [asp.py] => Task 0, Epoch 3 => Loss 0.855, Train_accy 79.85, Test_curr_accy 91.62, Test_accy 91.62
2025-01-04 00:37:09,253 [asp.py] => Task 0, Epoch 2 => Loss 1.076, Train_accy 77.36, Test_curr_accy 91.62, Test_accy 91.62
2025-01-04 00:38:41,782 [asp.py] => Task 0, Epoch 3 => Loss 1.002, Train_accy 78.44, Test_curr_accy 91.62, Test_accy 91.62
2025-01-04 00:47:33,011 [asp.py] => Task 0, Epoch 5 => Loss nan, Train_accy 1.67, Test_curr_accy 1.67, Test_accy 1.67
2025-01-04 00:52:07,673 [asp.py] => Task 0, Epoch 10 => Loss 0.703, Train_accy 82.85, Test_curr_accy 93.07, Test_accy 93.07
2025-01-04 00:52:07,705 [asp.py] => Task 0, Epoch 5 => Loss 2.165, Train_accy 55.71, Test_curr_accy 73.82, Test_accy 73.82
2025-01-04 00:55:23,434 [asp.py] => Task 0, Epoch 6 => Loss 0.760, Train_accy 81.53, Test_curr_accy 92.72, Test_accy 92.72
2025-01-04 00:58:05,814 [asp.py] => Task 0, Epoch 3 => Loss 0.871, Train_accy 80.03, Test_curr_accy 92.25, Test_accy 92.25
2025-01-04 00:58:10,495 [asp.py] => Task 0, Epoch 4 => Loss 0.817, Train_accy 80.83, Test_curr_accy 91.85, Test_accy 91.85
2025-01-04 00:58:58,106 [asp.py] => Task 0, Epoch 6 => Loss 0.756, Train_accy 81.74, Test_curr_accy 92.42, Test_accy 92.42
2025-01-04 00:59:14,791 [asp.py] => Task 0, Epoch 6 => Loss 0.756, Train_accy 81.81, Test_curr_accy 92.53, Test_accy 92.53
2025-01-04 01:01:45,481 [trainer.py] => Top1 curve: [91.8]
2025-01-04 01:01:45,488 [trainer.py] => Average Accuracy (Top1): 91.8   (Harmonic Accuracy): None (Old Acc): 91.8 (New Acc): [] 

2025-01-04 01:01:45,490 [trainer.py] => All params: 173642241
2025-01-04 01:01:45,496 [trainer.py] => Trainable params: 2044929
2025-01-04 01:01:45,574 [asp.py] => Learning on 60-65
2025-01-04 01:01:45,682 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 01:03:02,442 [asp.py] => Task 0, Epoch 4 => Loss 0.867, Train_accy 80.36, Test_curr_accy 91.93, Test_accy 91.93
2025-01-04 01:06:31,656 [asp.py] => total parameters: 173646081
2025-01-04 01:06:31,663 [asp.py] => trainable parameters: 2048769
2025-01-04 01:08:16,839 [trainer.py] => Top1 curve: [91.8, 90.31]
2025-01-04 01:08:16,850 [trainer.py] => Average Accuracy (Top1): 91.055   (Harmonic Accuracy): 82.92017133180596 (Old Acc): 91.51666666666667 (New Acc): 75.8 

2025-01-04 01:08:16,874 [trainer.py] => All params: 173646081
2025-01-04 01:08:16,875 [trainer.py] => Trainable params: 2048769
2025-01-04 01:08:16,883 [asp.py] => Learning on 65-70
2025-01-04 01:08:16,933 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 01:12:23,939 [asp.py] => total parameters: 173649921
2025-01-04 01:12:23,940 [asp.py] => trainable parameters: 2052609
2025-01-04 01:14:00,653 [trainer.py] => Top1 curve: [91.8, 90.31, 89.77]
2025-01-04 01:14:00,653 [trainer.py] => Average Accuracy (Top1): 90.62666666666667   (Harmonic Accuracy): 85.07174188517399 (Old Acc): 91.48333333333335 (New Acc): 79.5 

2025-01-04 01:14:00,655 [trainer.py] => All params: 173649921
2025-01-04 01:14:00,656 [trainer.py] => Trainable params: 2052609
2025-01-04 01:14:00,657 [asp.py] => Learning on 70-75
2025-01-04 01:14:00,745 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 01:14:46,982 [asp.py] => Task 0, Epoch 6 => Loss nan, Train_accy 1.67, Test_curr_accy 1.67, Test_accy 1.67
2025-01-04 01:17:34,567 [asp.py] => total parameters: 173653761
2025-01-04 01:17:34,569 [asp.py] => trainable parameters: 2056449
2025-01-04 01:19:10,990 [trainer.py] => Top1 curve: [91.8, 90.31, 89.77, 88.43]
2025-01-04 01:19:10,990 [trainer.py] => Average Accuracy (Top1): 90.0775   (Harmonic Accuracy): 83.63206016227986 (Old Acc): 91.23333333333335 (New Acc): 77.2 

2025-01-04 01:19:10,992 [trainer.py] => All params: 173653761
2025-01-04 01:19:11,001 [trainer.py] => Trainable params: 2056449
2025-01-04 01:19:11,008 [asp.py] => Learning on 75-80
2025-01-04 01:19:11,069 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 01:19:58,061 [asp.py] => Task 0, Epoch 6 => Loss 1.817, Train_accy 62.88, Test_curr_accy 71.63, Test_accy 71.63
2025-01-04 01:20:12,931 [asp.py] => Task 0, Epoch 4 => Loss 0.805, Train_accy 81.19, Test_curr_accy 92.27, Test_accy 92.27
2025-01-04 01:22:09,541 [asp.py] => Task 0, Epoch 7 => Loss 0.728, Train_accy 82.39, Test_curr_accy 92.68, Test_accy 92.68
2025-01-04 01:22:56,186 [asp.py] => Task 0, Epoch 5 => Loss 0.784, Train_accy 81.32, Test_curr_accy 92.30, Test_accy 92.30
2025-01-04 01:23:33,604 [asp.py] => total parameters: 173657601
2025-01-04 01:23:33,605 [asp.py] => trainable parameters: 2060289
2025-01-04 01:25:39,514 [trainer.py] => Top1 curve: [91.8, 90.31, 89.77, 88.43, 88.52]
2025-01-04 01:25:39,515 [trainer.py] => Average Accuracy (Top1): 89.76599999999999   (Harmonic Accuracy): 85.53747088509316 (Old Acc): 91.18333333333334 (New Acc): 80.55 

2025-01-04 01:25:39,524 [trainer.py] => All params: 173657601
2025-01-04 01:25:39,538 [trainer.py] => Trainable params: 2060289
2025-01-04 01:25:39,546 [asp.py] => Learning on 80-85
2025-01-04 01:25:39,639 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 01:28:45,419 [asp.py] => Task 0, Epoch 7 => Loss 0.725, Train_accy 82.45, Test_curr_accy 92.57, Test_accy 92.57
2025-01-04 01:28:51,750 [asp.py] => Task 0, Epoch 5 => Loss 0.819, Train_accy 80.80, Test_curr_accy 92.37, Test_accy 92.37
2025-01-04 01:28:52,061 [asp.py] => Task 0, Epoch 7 => Loss 0.728, Train_accy 82.35, Test_curr_accy 92.55, Test_accy 92.55
2025-01-04 01:30:21,480 [asp.py] => total parameters: 173661441
2025-01-04 01:30:21,485 [asp.py] => trainable parameters: 2064129
2025-01-04 01:32:37,944 [trainer.py] => Top1 curve: [91.8, 90.31, 89.77, 88.43, 88.52, 87.66]
2025-01-04 01:32:37,945 [trainer.py] => Average Accuracy (Top1): 89.415   (Harmonic Accuracy): 84.89530398077038 (Old Acc): 91.05000000000001 (New Acc): 79.52000000000001 

2025-01-04 01:32:37,947 [trainer.py] => All params: 173661441
2025-01-04 01:32:37,949 [trainer.py] => Trainable params: 2064129
2025-01-04 01:32:37,951 [asp.py] => Learning on 85-90
2025-01-04 01:32:38,010 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 01:36:43,963 [asp.py] => total parameters: 173665281
2025-01-04 01:36:43,968 [asp.py] => trainable parameters: 2067969
2025-01-04 01:38:46,066 [trainer.py] => Top1 curve: [91.8, 90.31, 89.77, 88.43, 88.52, 87.66, 87.59]
2025-01-04 01:38:46,123 [trainer.py] => Average Accuracy (Top1): 89.15428571428572   (Harmonic Accuracy): 85.67996122152206 (Old Acc): 90.85000000000001 (New Acc): 81.06666666666668 

2025-01-04 01:38:46,125 [trainer.py] => All params: 173665281
2025-01-04 01:38:46,126 [trainer.py] => Trainable params: 2067969
2025-01-04 01:38:46,127 [asp.py] => Learning on 90-95
2025-01-04 01:38:46,160 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 01:41:17,283 [asp.py] => Task 0, Epoch 7 => Loss nan, Train_accy 1.67, Test_curr_accy 1.67, Test_accy 1.67
2025-01-04 01:41:50,773 [asp.py] => total parameters: 173669121
2025-01-04 01:41:50,775 [asp.py] => trainable parameters: 2071809
2025-01-04 01:42:22,563 [asp.py] => Task 0, Epoch 5 => Loss 0.784, Train_accy 81.28, Test_curr_accy 92.62, Test_accy 92.62
2025-01-04 01:43:58,865 [trainer.py] => Top1 curve: [91.8, 90.31, 89.77, 88.43, 88.52, 87.66, 87.59, 87.26]
2025-01-04 01:43:58,866 [trainer.py] => Average Accuracy (Top1): 88.9175   (Harmonic Accuracy): 85.76597841129256 (Old Acc): 90.73333333333333 (New Acc): 81.31428571428572 

2025-01-04 01:43:58,881 [trainer.py] => All params: 173669121
2025-01-04 01:43:58,883 [trainer.py] => Trainable params: 2071809
2025-01-04 01:43:58,885 [asp.py] => Learning on 95-100
2025-01-04 01:43:58,933 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 01:43:58,950 [asp.py] => total parameters: 173672961
2025-01-04 01:43:58,957 [asp.py] => trainable parameters: 2075649
2025-01-04 01:46:22,566 [trainer.py] => Top1 curve: [91.8, 90.31, 89.77, 88.43, 88.52, 87.66, 87.59, 87.26, 86.23]
2025-01-04 01:46:22,567 [trainer.py] => Average Accuracy (Top1): 88.61888888888889   (Harmonic Accuracy): 84.82117624033661 (Old Acc): 90.51666666666665 (New Acc): 79.8 

2025-01-04 01:46:22,567 [trainer.py] => 

2025-01-04 01:47:33,901 [asp.py] => Task 0, Epoch 6 => Loss 0.758, Train_accy 81.58, Test_curr_accy 92.47, Test_accy 92.47
2025-01-04 01:48:36,570 [asp.py] => Task 0, Epoch 8 => Loss 0.728, Train_accy 82.24, Test_curr_accy 92.65, Test_accy 92.65
2025-01-04 01:48:40,633 [asp.py] => Task 0, Epoch 7 => Loss 1.667, Train_accy 65.59, Test_curr_accy 78.33, Test_accy 78.33
2025-01-04 01:53:15,261 [asp.py] => Task 0, Epoch 6 => Loss 0.791, Train_accy 81.31, Test_curr_accy 92.53, Test_accy 92.53
2025-01-04 01:57:26,198 [asp.py] => Task 0, Epoch 8 => Loss 0.729, Train_accy 82.40, Test_curr_accy 92.73, Test_accy 92.73
2025-01-04 01:57:30,555 [asp.py] => Task 0, Epoch 8 => Loss 0.725, Train_accy 82.41, Test_curr_accy 92.55, Test_accy 92.55
2025-01-04 02:01:46,978 [asp.py] => Task 0, Epoch 6 => Loss 0.746, Train_accy 81.98, Test_curr_accy 92.75, Test_accy 92.75
2025-01-04 02:08:04,049 [asp.py] => Task 0, Epoch 8 => Loss nan, Train_accy 1.67, Test_curr_accy 1.67, Test_accy 1.67
2025-01-04 02:09:07,584 [asp.py] => Task 0, Epoch 7 => Loss 0.728, Train_accy 82.22, Test_curr_accy 92.67, Test_accy 92.67
2025-01-04 02:11:25,437 [asp.py] => Task 0, Epoch 9 => Loss 0.715, Train_accy 82.64, Test_curr_accy 92.60, Test_accy 92.60
2025-01-04 02:13:40,942 [asp.py] => Task 0, Epoch 7 => Loss 0.754, Train_accy 82.04, Test_curr_accy 92.40, Test_accy 92.40
2025-01-04 02:14:57,711 [asp.py] => Task 0, Epoch 8 => Loss 1.591, Train_accy 67.13, Test_curr_accy 78.48, Test_accy 78.48
2025-01-04 02:18:26,793 [asp.py] => Task 0, Epoch 7 => Loss 0.727, Train_accy 82.28, Test_curr_accy 92.67, Test_accy 92.67
2025-01-04 02:24:30,229 [asp.py] => Task 0, Epoch 9 => Loss 0.708, Train_accy 82.72, Test_curr_accy 92.77, Test_accy 92.77
2025-01-04 02:24:33,305 [asp.py] => Task 0, Epoch 9 => Loss 0.711, Train_accy 82.72, Test_curr_accy 92.62, Test_accy 92.62
2025-01-04 02:31:16,625 [asp.py] => Task 0, Epoch 8 => Loss 0.729, Train_accy 82.26, Test_curr_accy 92.90, Test_accy 92.90
2025-01-04 02:34:00,207 [asp.py] => Task 0, Epoch 9 => Loss nan, Train_accy 1.67, Test_curr_accy 1.67, Test_accy 1.67
2025-01-04 02:34:51,298 [asp.py] => Task 0, Epoch 10 => Loss 0.705, Train_accy 82.97, Test_curr_accy 92.67, Test_accy 92.67
2025-01-04 02:35:44,651 [asp.py] => Task 0, Epoch 8 => Loss 0.751, Train_accy 82.05, Test_curr_accy 92.58, Test_accy 92.58
2025-01-04 02:35:46,239 [asp.py] => Task 0, Epoch 8 => Loss 0.719, Train_accy 82.27, Test_curr_accy 92.78, Test_accy 92.78
2025-01-04 02:40:31,925 [asp.py] => Task 0, Epoch 9 => Loss 1.565, Train_accy 67.90, Test_curr_accy 74.87, Test_accy 74.87
2025-01-04 02:44:41,877 [trainer.py] => Top1 curve: [91.57]
2025-01-04 02:44:41,878 [trainer.py] => Average Accuracy (Top1): 91.57   (Harmonic Accuracy): None (Old Acc): 91.56666666666666 (New Acc): [] 

2025-01-04 02:44:41,881 [trainer.py] => All params: 173642241
2025-01-04 02:44:41,882 [trainer.py] => Trainable params: 2044929
2025-01-04 02:44:41,887 [asp.py] => Learning on 60-65
2025-01-04 02:44:41,919 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 02:51:46,980 [asp.py] => Task 0, Epoch 10 => Loss 0.706, Train_accy 82.94, Test_curr_accy 92.83, Test_accy 92.83
2025-01-04 02:51:48,486 [asp.py] => Task 0, Epoch 10 => Loss 0.702, Train_accy 83.00, Test_curr_accy 92.78, Test_accy 92.78
2025-01-04 02:52:25,405 [asp.py] => Task 0, Epoch 9 => Loss 0.692, Train_accy 83.03, Test_curr_accy 93.17, Test_accy 93.17
2025-01-04 02:53:54,632 [asp.py] => Task 0, Epoch 9 => Loss 0.710, Train_accy 82.90, Test_curr_accy 93.08, Test_accy 93.08
2025-01-04 02:58:58,892 [asp.py] => Task 0, Epoch 9 => Loss 0.733, Train_accy 82.61, Test_curr_accy 92.87, Test_accy 92.87
2025-01-04 03:00:29,689 [asp.py] => Task 0, Epoch 10 => Loss nan, Train_accy 1.67, Test_curr_accy 1.67, Test_accy 1.67
2025-01-04 03:02:08,084 [trainer.py] => Top1 curve: [91.52]
2025-01-04 03:02:08,085 [trainer.py] => Average Accuracy (Top1): 91.52   (Harmonic Accuracy): None (Old Acc): 91.5166666666667 (New Acc): [] 

2025-01-04 03:02:08,086 [trainer.py] => All params: 173642241
2025-01-04 03:02:08,087 [trainer.py] => Trainable params: 2044929
2025-01-04 03:02:08,095 [asp.py] => Learning on 60-65
2025-01-04 03:02:08,180 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:02:15,306 [trainer.py] => Top1 curve: [91.53]
2025-01-04 03:02:15,307 [trainer.py] => Average Accuracy (Top1): 91.53   (Harmonic Accuracy): None (Old Acc): 91.53333333333335 (New Acc): [] 

2025-01-04 03:02:15,309 [trainer.py] => All params: 173642241
2025-01-04 03:02:15,311 [trainer.py] => Trainable params: 2044929
2025-01-04 03:02:15,313 [asp.py] => Learning on 60-65
2025-01-04 03:02:15,358 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:05:02,194 [asp.py] => Task 0, Epoch 10 => Loss 1.663, Train_accy 66.51, Test_curr_accy 76.65, Test_accy 76.65
2025-01-04 03:08:25,106 [asp.py] => Task 0, Epoch 10 => Loss 0.695, Train_accy 83.09, Test_curr_accy 93.28, Test_accy 93.28
2025-01-04 03:09:08,039 [trainer.py] => Top1 curve: [1.67]
2025-01-04 03:09:08,039 [trainer.py] => Average Accuracy (Top1): 1.67   (Harmonic Accuracy): None (Old Acc): 1.6666666666666667 (New Acc): [] 

2025-01-04 03:09:08,040 [trainer.py] => All params: 173642241
2025-01-04 03:09:08,041 [trainer.py] => Trainable params: 2044929
2025-01-04 03:09:08,047 [asp.py] => Learning on 60-65
2025-01-04 03:09:08,066 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:12:06,662 [trainer.py] => Top1 curve: [77.0]
2025-01-04 03:12:06,662 [trainer.py] => Average Accuracy (Top1): 77.0   (Harmonic Accuracy): None (Old Acc): 77.0 (New Acc): [] 

2025-01-04 03:12:06,663 [trainer.py] => All params: 173642241
2025-01-04 03:12:06,664 [trainer.py] => Trainable params: 2044929
2025-01-04 03:12:06,666 [asp.py] => Learning on 60-65
2025-01-04 03:12:06,709 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:13:27,231 [trainer.py] => Top1 curve: [91.93]
2025-01-04 03:13:27,232 [trainer.py] => Average Accuracy (Top1): 91.93   (Harmonic Accuracy): None (Old Acc): 91.93333333333335 (New Acc): [] 

2025-01-04 03:13:27,234 [trainer.py] => All params: 173642241
2025-01-04 03:13:27,235 [trainer.py] => Trainable params: 2044929
2025-01-04 03:13:27,236 [asp.py] => Learning on 60-65
2025-01-04 03:13:27,255 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:14:10,025 [asp.py] => total parameters: 173646081
2025-01-04 03:14:10,026 [asp.py] => trainable parameters: 2048769
2025-01-04 03:14:47,104 [trainer.py] => Top1 curve: [91.93, 90.4]
2025-01-04 03:14:47,104 [trainer.py] => Average Accuracy (Top1): 91.165   (Harmonic Accuracy): 82.39231231231231 (Old Acc): 91.7 (New Acc): 74.8 

2025-01-04 03:14:47,106 [trainer.py] => All params: 173646081
2025-01-04 03:14:47,106 [trainer.py] => Trainable params: 2048769
2025-01-04 03:14:47,108 [asp.py] => Learning on 65-70
2025-01-04 03:14:47,124 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:15:33,158 [asp.py] => total parameters: 173649921
2025-01-04 03:15:33,158 [asp.py] => trainable parameters: 2052609
2025-01-04 03:16:11,945 [trainer.py] => Top1 curve: [91.93, 90.4, 89.81]
2025-01-04 03:16:11,945 [trainer.py] => Average Accuracy (Top1): 90.71333333333332   (Harmonic Accuracy): 84.68988456270789 (Old Acc): 91.66666666666667 (New Acc): 78.7 

2025-01-04 03:16:11,947 [trainer.py] => All params: 173649921
2025-01-04 03:16:11,948 [trainer.py] => Trainable params: 2052609
2025-01-04 03:16:11,949 [asp.py] => Learning on 70-75
2025-01-04 03:16:11,964 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:16:25,588 [asp.py] => Task 0, Epoch 10 => Loss 0.699, Train_accy 82.99, Test_curr_accy 92.58, Test_accy 92.58
2025-01-04 03:16:56,114 [asp.py] => total parameters: 173653761
2025-01-04 03:16:56,115 [asp.py] => trainable parameters: 2056449
2025-01-04 03:17:34,858 [trainer.py] => Top1 curve: [91.93, 90.4, 89.81, 88.53]
2025-01-04 03:17:34,859 [trainer.py] => Average Accuracy (Top1): 90.16749999999999   (Harmonic Accuracy): 83.6558335805888 (Old Acc): 91.38333333333333 (New Acc): 77.13333333333334 

2025-01-04 03:17:34,860 [trainer.py] => All params: 173653761
2025-01-04 03:17:34,862 [trainer.py] => Trainable params: 2056449
2025-01-04 03:17:34,864 [asp.py] => Learning on 75-80
2025-01-04 03:17:34,888 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:18:18,219 [asp.py] => total parameters: 173657601
2025-01-04 03:18:18,221 [asp.py] => trainable parameters: 2060289
2025-01-04 03:19:03,825 [trainer.py] => Top1 curve: [91.93, 90.4, 89.81, 88.53, 88.66]
2025-01-04 03:19:03,825 [trainer.py] => Average Accuracy (Top1): 89.86599999999999   (Harmonic Accuracy): 85.6807092336014 (Old Acc): 91.31666666666666 (New Acc): 80.7 

2025-01-04 03:19:03,827 [trainer.py] => All params: 173657601
2025-01-04 03:19:03,828 [trainer.py] => Trainable params: 2060289
2025-01-04 03:19:03,830 [asp.py] => Learning on 80-85
2025-01-04 03:19:03,857 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:19:49,659 [asp.py] => total parameters: 173661441
2025-01-04 03:19:49,669 [asp.py] => trainable parameters: 2064129
2025-01-04 03:20:41,435 [trainer.py] => Top1 curve: [91.93, 90.4, 89.81, 88.53, 88.66, 87.87]
2025-01-04 03:20:41,437 [trainer.py] => Average Accuracy (Top1): 89.53333333333332   (Harmonic Accuracy): 85.16548982931963 (Old Acc): 91.2 (New Acc): 79.88 

2025-01-04 03:20:41,438 [trainer.py] => All params: 173661441
2025-01-04 03:20:41,439 [trainer.py] => Trainable params: 2064129
2025-01-04 03:20:41,441 [asp.py] => Learning on 85-90
2025-01-04 03:20:41,469 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:21:30,288 [asp.py] => total parameters: 173665281
2025-01-04 03:21:30,289 [asp.py] => trainable parameters: 2067969
2025-01-04 03:21:57,344 [asp.py] => Task 0, Epoch 10 => Loss 0.724, Train_accy 82.77, Test_curr_accy 92.82, Test_accy 92.82
2025-01-04 03:22:25,888 [trainer.py] => Top1 curve: [91.93, 90.4, 89.81, 88.53, 88.66, 87.87, 87.87]
2025-01-04 03:22:25,889 [trainer.py] => Average Accuracy (Top1): 89.29571428571428   (Harmonic Accuracy): 86.02184019058656 (Old Acc): 91.03333333333332 (New Acc): 81.53333333333333 

2025-01-04 03:22:25,890 [trainer.py] => All params: 173665281
2025-01-04 03:22:25,892 [trainer.py] => Trainable params: 2067969
2025-01-04 03:22:25,894 [asp.py] => Learning on 90-95
2025-01-04 03:22:25,914 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:23:10,656 [asp.py] => total parameters: 173669121
2025-01-04 03:23:10,657 [asp.py] => trainable parameters: 2071809
2025-01-04 03:23:59,170 [trainer.py] => Top1 curve: [91.55]
2025-01-04 03:23:59,171 [trainer.py] => Average Accuracy (Top1): 91.55   (Harmonic Accuracy): None (Old Acc): 91.55000000000001 (New Acc): [] 

2025-01-04 03:23:59,172 [trainer.py] => All params: 173642241
2025-01-04 03:23:59,173 [trainer.py] => Trainable params: 2044929
2025-01-04 03:23:59,177 [asp.py] => Learning on 60-65
2025-01-04 03:23:59,199 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:24:02,264 [trainer.py] => Top1 curve: [91.93, 90.4, 89.81, 88.53, 88.66, 87.87, 87.87, 87.52]
2025-01-04 03:24:02,265 [trainer.py] => Average Accuracy (Top1): 89.07374999999999   (Harmonic Accuracy): 86.02069736315593 (Old Acc): 90.98333333333333 (New Acc): 81.57142857142857 

2025-01-04 03:24:02,267 [trainer.py] => All params: 173669121
2025-01-04 03:24:02,268 [trainer.py] => Trainable params: 2071809
2025-01-04 03:24:02,269 [asp.py] => Learning on 95-100
2025-01-04 03:24:02,290 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:24:02,293 [asp.py] => total parameters: 173672961
2025-01-04 03:24:02,294 [asp.py] => trainable parameters: 2075649
2025-01-04 03:24:55,348 [trainer.py] => Top1 curve: [91.93, 90.4, 89.81, 88.53, 88.66, 87.87, 87.87, 87.52, 86.39]
2025-01-04 03:24:55,348 [trainer.py] => Average Accuracy (Top1): 88.77555555555554   (Harmonic Accuracy): 84.93120328301335 (Old Acc): 90.8 (New Acc): 79.775 

2025-01-04 03:24:55,348 [trainer.py] => 

2025-01-04 03:29:18,202 [trainer.py] => Top1 curve: [91.88]
2025-01-04 03:29:18,203 [trainer.py] => Average Accuracy (Top1): 91.88   (Harmonic Accuracy): None (Old Acc): 91.88333333333334 (New Acc): [] 

2025-01-04 03:29:18,204 [trainer.py] => All params: 173642241
2025-01-04 03:29:18,205 [trainer.py] => Trainable params: 2044929
2025-01-04 03:29:18,209 [asp.py] => Learning on 60-65
2025-01-04 03:29:18,220 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:30:01,085 [asp.py] => total parameters: 173646081
2025-01-04 03:30:01,085 [asp.py] => trainable parameters: 2048769
2025-01-04 03:30:56,664 [trainer.py] => Top1 curve: [91.88, 90.37]
2025-01-04 03:30:56,665 [trainer.py] => Average Accuracy (Top1): 91.125   (Harmonic Accuracy): 82.60731268731269 (Old Acc): 91.63333333333333 (New Acc): 75.2 

2025-01-04 03:30:56,666 [trainer.py] => All params: 173646081
2025-01-04 03:30:56,666 [trainer.py] => Trainable params: 2048769
2025-01-04 03:30:56,672 [asp.py] => Learning on 65-70
2025-01-04 03:30:56,692 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:31:39,240 [asp.py] => total parameters: 173649921
2025-01-04 03:31:39,241 [asp.py] => trainable parameters: 2052609
2025-01-04 03:32:38,741 [trainer.py] => Top1 curve: [91.88, 90.37, 89.83]
2025-01-04 03:32:38,741 [trainer.py] => Average Accuracy (Top1): 90.69333333333333   (Harmonic Accuracy): 85.05041918502631 (Old Acc): 91.56666666666666 (New Acc): 79.4 

2025-01-04 03:32:38,742 [trainer.py] => All params: 173649921
2025-01-04 03:32:38,743 [trainer.py] => Trainable params: 2052609
2025-01-04 03:32:38,747 [asp.py] => Learning on 70-75
2025-01-04 03:32:38,770 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:33:21,219 [asp.py] => total parameters: 173653761
2025-01-04 03:33:21,220 [asp.py] => trainable parameters: 2056449
2025-01-04 03:34:24,270 [trainer.py] => Top1 curve: [91.88, 90.37, 89.83, 88.71]
2025-01-04 03:34:24,270 [trainer.py] => Average Accuracy (Top1): 90.19749999999999   (Harmonic Accuracy): 84.38402723225975 (Old Acc): 91.26666666666667 (New Acc): 78.46666666666665 

2025-01-04 03:34:24,272 [trainer.py] => All params: 173653761
2025-01-04 03:34:24,272 [trainer.py] => Trainable params: 2056449
2025-01-04 03:34:24,277 [asp.py] => Learning on 75-80
2025-01-04 03:34:24,295 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:35:07,388 [asp.py] => total parameters: 173657601
2025-01-04 03:35:07,389 [asp.py] => trainable parameters: 2060289
2025-01-04 03:36:15,674 [trainer.py] => Top1 curve: [91.88, 90.37, 89.83, 88.71, 88.81]
2025-01-04 03:36:15,674 [trainer.py] => Average Accuracy (Top1): 89.91999999999999   (Harmonic Accuracy): 86.18156753109032 (Old Acc): 91.18333333333334 (New Acc): 81.69999999999999 

2025-01-04 03:36:15,676 [trainer.py] => All params: 173657601
2025-01-04 03:36:15,677 [trainer.py] => Trainable params: 2060289
2025-01-04 03:36:15,681 [asp.py] => Learning on 80-85
2025-01-04 03:36:15,694 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:36:58,193 [asp.py] => total parameters: 173661441
2025-01-04 03:36:58,194 [asp.py] => trainable parameters: 2064129
2025-01-04 03:38:10,186 [trainer.py] => Top1 curve: [91.88, 90.37, 89.83, 88.71, 88.81, 88.16]
2025-01-04 03:38:10,186 [trainer.py] => Average Accuracy (Top1): 89.62666666666667   (Harmonic Accuracy): 85.82083381721054 (Old Acc): 91.10000000000001 (New Acc): 81.11999999999999 

2025-01-04 03:38:10,188 [trainer.py] => All params: 173661441
2025-01-04 03:38:10,188 [trainer.py] => Trainable params: 2064129
2025-01-04 03:38:10,193 [asp.py] => Learning on 85-90
2025-01-04 03:38:10,222 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:38:53,256 [asp.py] => total parameters: 173665281
2025-01-04 03:38:53,259 [asp.py] => trainable parameters: 2067969
2025-01-04 03:40:09,978 [trainer.py] => Top1 curve: [91.88, 90.37, 89.83, 88.71, 88.81, 88.16, 88.07]
2025-01-04 03:40:09,979 [trainer.py] => Average Accuracy (Top1): 89.4042857142857   (Harmonic Accuracy): 86.44154645124065 (Old Acc): 90.90000000000002 (New Acc): 82.4 

2025-01-04 03:40:09,980 [trainer.py] => All params: 173665281
2025-01-04 03:40:09,981 [trainer.py] => Trainable params: 2067969
2025-01-04 03:40:09,986 [asp.py] => Learning on 90-95
2025-01-04 03:40:10,003 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:40:52,417 [asp.py] => total parameters: 173669121
2025-01-04 03:40:52,418 [asp.py] => trainable parameters: 2071809
2025-01-04 03:42:11,715 [trainer.py] => Top1 curve: [91.88, 90.37, 89.83, 88.71, 88.81, 88.16, 88.07, 87.76]
2025-01-04 03:42:11,716 [trainer.py] => Average Accuracy (Top1): 89.19874999999999   (Harmonic Accuracy): 86.46663827799831 (Old Acc): 90.81666666666666 (New Acc): 82.5142857142857 

2025-01-04 03:42:11,717 [trainer.py] => All params: 173669121
2025-01-04 03:42:11,718 [trainer.py] => Trainable params: 2071809
2025-01-04 03:42:11,722 [asp.py] => Learning on 95-100
2025-01-04 03:42:11,742 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 03:42:11,745 [asp.py] => total parameters: 173672961
2025-01-04 03:42:11,745 [asp.py] => trainable parameters: 2075649
2025-01-04 03:43:36,148 [trainer.py] => Top1 curve: [91.88, 90.37, 89.83, 88.71, 88.81, 88.16, 88.07, 87.76, 86.61]
2025-01-04 03:43:36,149 [trainer.py] => Average Accuracy (Top1): 88.9111111111111   (Harmonic Accuracy): 85.32194480946123 (Old Acc): 90.59999999999998 (New Acc): 80.625 

2025-01-04 03:43:36,149 [trainer.py] => 

2025-01-04 11:12:05,225 [trainer.py] => config: ./exps/cifar.json
2025-01-04 11:12:05,225 [trainer.py] => model_name: asp
2025-01-04 11:12:05,225 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 11:12:05,225 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-04 11:12:05,226 [trainer.py] => seed: 2024
2025-01-04 11:12:05,226 [trainer.py] => dataset: cifar224
2025-01-04 11:12:05,226 [trainer.py] => init_cls: 60
2025-01-04 11:12:05,226 [trainer.py] => increment: 5
2025-01-04 11:12:05,226 [trainer.py] => kshot: 5
2025-01-04 11:12:05,226 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 11:12:05,226 [trainer.py] => z_dim: 1000
2025-01-04 11:12:05,226 [trainer.py] => conv_dim: 64
2025-01-04 11:12:05,226 [trainer.py] => img_size: 224
2025-01-04 11:12:05,226 [trainer.py] => generator_lr: 0.001
2025-01-04 11:12:05,226 [trainer.py] => pi: 100
2025-01-04 11:12:05,226 [trainer.py] => w_bn: 50.0
2025-01-04 11:12:05,226 [trainer.py] => w_noise: 0.001
2025-01-04 11:12:05,226 [trainer.py] => server_ss: 32
2025-01-04 11:12:05,226 [trainer.py] => bn_loss: 1
2025-01-04 11:12:05,226 [trainer.py] => noise: 1
2025-01-04 11:12:05,226 [trainer.py] => ie_loss: 1
2025-01-04 11:12:05,226 [trainer.py] => act_loss: 0
2025-01-04 11:12:05,226 [trainer.py] => w_ie: 1.0
2025-01-04 11:12:05,226 [trainer.py] => w_act: 0.1
2025-01-04 11:12:05,226 [trainer.py] => syn_size: 32
2025-01-04 11:12:05,226 [trainer.py] => vpt_type: Deep
2025-01-04 11:12:05,226 [trainer.py] => prompt_token_num: 6
2025-01-04 11:12:05,226 [trainer.py] => avg_alpha: 0.8
2025-01-04 11:12:05,226 [trainer.py] => perturb_var: 1
2025-01-04 11:12:05,226 [trainer.py] => EMA_beta: 0.99
2025-01-04 11:12:05,227 [trainer.py] => anchor_lambda: 0.1
2025-01-04 11:12:05,227 [trainer.py] => kl_weight: 0.001
2025-01-04 11:12:05,227 [trainer.py] => TIP_init: zero
2025-01-04 11:12:05,227 [trainer.py] => tuned_epoch: 10
2025-01-04 11:12:05,227 [trainer.py] => fs_epoch: 0
2025-01-04 11:12:05,227 [trainer.py] => init_lr: 0.005
2025-01-04 11:12:05,227 [trainer.py] => fs_lr: 0.001
2025-01-04 11:12:05,227 [trainer.py] => batch_size: 48
2025-01-04 11:12:05,227 [trainer.py] => fs_batch_size: 16
2025-01-04 11:12:05,227 [trainer.py] => weight_decay: 0.0005
2025-01-04 11:12:05,227 [trainer.py] => min_lr: 0
2025-01-04 11:12:05,227 [trainer.py] => optimizer: sgd
2025-01-04 11:12:05,227 [trainer.py] => memory_size: 0
2025-01-04 11:12:05,227 [trainer.py] => memory_per_class: 0
2025-01-04 11:12:05,227 [trainer.py] => fixed_memory: False
2025-01-04 11:12:05,227 [trainer.py] => shuffle: False
2025-01-04 11:12:05,227 [trainer.py] => top_k: 5
2025-01-04 11:12:05,227 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 11:12:05,227 [trainer.py] => prefix: asp
2025-01-04 11:12:05,227 [trainer.py] => model_prefix: asp
2025-01-04 11:12:09,160 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 11:12:17,910 [trainer.py] => config: ./exps/cifar.json
2025-01-04 11:12:17,910 [trainer.py] => model_name: asp
2025-01-04 11:12:17,910 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 11:12:17,910 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-04 11:12:17,910 [trainer.py] => seed: 2024
2025-01-04 11:12:17,910 [trainer.py] => dataset: cifar224
2025-01-04 11:12:17,910 [trainer.py] => init_cls: 60
2025-01-04 11:12:17,910 [trainer.py] => increment: 5
2025-01-04 11:12:17,910 [trainer.py] => kshot: 5
2025-01-04 11:12:17,910 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 11:12:17,910 [trainer.py] => z_dim: 1000
2025-01-04 11:12:17,910 [trainer.py] => conv_dim: 64
2025-01-04 11:12:17,910 [trainer.py] => img_size: 224
2025-01-04 11:12:17,910 [trainer.py] => generator_lr: 0.001
2025-01-04 11:12:17,910 [trainer.py] => pi: 100
2025-01-04 11:12:17,910 [trainer.py] => w_bn: 50.0
2025-01-04 11:12:17,910 [trainer.py] => w_noise: 0.001
2025-01-04 11:12:17,910 [trainer.py] => server_ss: 32
2025-01-04 11:12:17,910 [trainer.py] => bn_loss: 1
2025-01-04 11:12:17,911 [trainer.py] => noise: 1
2025-01-04 11:12:17,911 [trainer.py] => ie_loss: 1
2025-01-04 11:12:17,911 [trainer.py] => act_loss: 0
2025-01-04 11:12:17,911 [trainer.py] => w_ie: 1.0
2025-01-04 11:12:17,911 [trainer.py] => w_act: 0.1
2025-01-04 11:12:17,911 [trainer.py] => syn_size: 32
2025-01-04 11:12:17,911 [trainer.py] => vpt_type: Deep
2025-01-04 11:12:17,911 [trainer.py] => prompt_token_num: 6
2025-01-04 11:12:17,911 [trainer.py] => avg_alpha: 0.8
2025-01-04 11:12:17,911 [trainer.py] => perturb_var: 1
2025-01-04 11:12:17,911 [trainer.py] => EMA_beta: 0.99
2025-01-04 11:12:17,911 [trainer.py] => anchor_lambda: 0.1
2025-01-04 11:12:17,911 [trainer.py] => kl_weight: 0.001
2025-01-04 11:12:17,911 [trainer.py] => TIP_init: zero
2025-01-04 11:12:17,911 [trainer.py] => tuned_epoch: 10
2025-01-04 11:12:17,911 [trainer.py] => fs_epoch: 0
2025-01-04 11:12:17,911 [trainer.py] => init_lr: 0.005
2025-01-04 11:12:17,911 [trainer.py] => fs_lr: 0.001
2025-01-04 11:12:17,911 [trainer.py] => batch_size: 48
2025-01-04 11:12:17,911 [trainer.py] => fs_batch_size: 16
2025-01-04 11:12:17,911 [trainer.py] => weight_decay: 0.0005
2025-01-04 11:12:17,911 [trainer.py] => min_lr: 0
2025-01-04 11:12:17,911 [trainer.py] => optimizer: sgd
2025-01-04 11:12:17,911 [trainer.py] => memory_size: 0
2025-01-04 11:12:17,911 [trainer.py] => memory_per_class: 0
2025-01-04 11:12:17,911 [trainer.py] => fixed_memory: False
2025-01-04 11:12:17,911 [trainer.py] => shuffle: False
2025-01-04 11:12:17,911 [trainer.py] => top_k: 5
2025-01-04 11:12:17,911 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 11:12:17,911 [trainer.py] => prefix: asp
2025-01-04 11:12:17,911 [trainer.py] => model_prefix: asp
2025-01-04 11:12:19,951 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 11:12:33,669 [trainer.py] => All params: 173596160
2025-01-04 11:12:33,670 [trainer.py] => Trainable params: 1998848
2025-01-04 11:12:34,004 [asp.py] => Learning on 0-60
2025-01-04 11:12:34,516 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 11:12:42,589 [trainer.py] => All params: 173596160
2025-01-04 11:12:42,590 [trainer.py] => Trainable params: 1998848
2025-01-04 11:12:42,972 [asp.py] => Learning on 0-60
2025-01-04 11:12:43,179 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 11:13:54,317 [trainer.py] => config: ./exps/cifar.json
2025-01-04 11:13:54,321 [trainer.py] => model_name: asp
2025-01-04 11:13:54,321 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 11:13:54,321 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 11:13:54,321 [trainer.py] => seed: 2024
2025-01-04 11:13:54,322 [trainer.py] => dataset: cifar224
2025-01-04 11:13:54,322 [trainer.py] => init_cls: 60
2025-01-04 11:13:54,322 [trainer.py] => increment: 5
2025-01-04 11:13:54,322 [trainer.py] => kshot: 5
2025-01-04 11:13:54,322 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 11:13:54,322 [trainer.py] => z_dim: 1000
2025-01-04 11:13:54,322 [trainer.py] => conv_dim: 64
2025-01-04 11:13:54,322 [trainer.py] => img_size: 224
2025-01-04 11:13:54,322 [trainer.py] => generator_lr: 0.001
2025-01-04 11:13:54,322 [trainer.py] => pi: 100
2025-01-04 11:13:54,322 [trainer.py] => w_bn: 50.0
2025-01-04 11:13:54,322 [trainer.py] => w_noise: 0.001
2025-01-04 11:13:54,322 [trainer.py] => server_ss: 32
2025-01-04 11:13:54,322 [trainer.py] => bn_loss: 1
2025-01-04 11:13:54,322 [trainer.py] => noise: 1
2025-01-04 11:13:54,322 [trainer.py] => ie_loss: 1
2025-01-04 11:13:54,323 [trainer.py] => act_loss: 0
2025-01-04 11:13:54,323 [trainer.py] => w_ie: 1.0
2025-01-04 11:13:54,323 [trainer.py] => w_act: 0.1
2025-01-04 11:13:54,323 [trainer.py] => syn_size: 32
2025-01-04 11:13:54,323 [trainer.py] => vpt_type: Deep
2025-01-04 11:13:54,323 [trainer.py] => prompt_token_num: 6
2025-01-04 11:13:54,323 [trainer.py] => avg_alpha: 0.8
2025-01-04 11:13:54,323 [trainer.py] => perturb_var: 1
2025-01-04 11:13:54,323 [trainer.py] => EMA_beta: 0.99
2025-01-04 11:13:54,323 [trainer.py] => anchor_lambda: 0.1
2025-01-04 11:13:54,323 [trainer.py] => kl_weight: 0.001
2025-01-04 11:13:54,323 [trainer.py] => TIP_init: zero
2025-01-04 11:13:54,323 [trainer.py] => tuned_epoch: 10
2025-01-04 11:13:54,323 [trainer.py] => fs_epoch: 0
2025-01-04 11:13:54,324 [trainer.py] => init_lr: 0.015
2025-01-04 11:13:54,324 [trainer.py] => fs_lr: 0.001
2025-01-04 11:13:54,324 [trainer.py] => batch_size: 48
2025-01-04 11:13:54,324 [trainer.py] => fs_batch_size: 16
2025-01-04 11:13:54,324 [trainer.py] => weight_decay: 0.0005
2025-01-04 11:13:54,324 [trainer.py] => min_lr: 0
2025-01-04 11:13:54,324 [trainer.py] => optimizer: sgd
2025-01-04 11:13:54,324 [trainer.py] => memory_size: 0
2025-01-04 11:13:54,324 [trainer.py] => memory_per_class: 0
2025-01-04 11:13:54,324 [trainer.py] => fixed_memory: False
2025-01-04 11:13:54,324 [trainer.py] => shuffle: False
2025-01-04 11:13:54,324 [trainer.py] => top_k: 5
2025-01-04 11:13:54,324 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 11:13:54,324 [trainer.py] => prefix: asp
2025-01-04 11:13:54,324 [trainer.py] => model_prefix: asp
2025-01-04 11:13:56,577 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 11:14:16,418 [asp.py] => total parameters: 173642241
2025-01-04 11:14:16,419 [asp.py] => trainable parameters: 2044929
2025-01-04 11:14:17,287 [trainer.py] => All params: 173596160
2025-01-04 11:14:17,289 [trainer.py] => Trainable params: 1998848
2025-01-04 11:14:19,582 [asp.py] => Learning on 0-60
2025-01-04 11:14:19,745 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 11:14:24,588 [asp.py] => total parameters: 173642241
2025-01-04 11:14:24,590 [asp.py] => trainable parameters: 2044929
2025-01-04 11:17:11,688 [asp.py] => total parameters: 173642241
2025-01-04 11:17:11,689 [asp.py] => trainable parameters: 2044929
2025-01-04 11:30:09,473 [asp.py] => Task 0, Epoch 1 => Loss 3.085, Train_accy 41.00, Test_curr_accy 89.88, Test_accy 89.88
2025-01-04 11:41:01,018 [asp.py] => Task 0, Epoch 1 => Loss 4.487, Train_accy 16.41, Test_curr_accy 70.10, Test_accy 70.10
2025-01-04 11:41:09,695 [asp.py] => Task 0, Epoch 1 => Loss 4.822, Train_accy 1.72, Test_curr_accy 2.10, Test_accy 2.10
2025-01-04 11:42:47,006 [asp.py] => Task 0, Epoch 2 => Loss 0.950, Train_accy 78.66, Test_curr_accy 91.42, Test_accy 91.42
2025-01-04 11:55:36,350 [asp.py] => Task 0, Epoch 3 => Loss 0.825, Train_accy 80.49, Test_curr_accy 92.32, Test_accy 92.32
2025-01-04 12:06:49,659 [asp.py] => Task 0, Epoch 2 => Loss 1.537, Train_accy 73.58, Test_curr_accy 90.15, Test_accy 90.15
2025-01-04 12:06:58,800 [asp.py] => Task 0, Epoch 2 => Loss 4.233, Train_accy 3.56, Test_curr_accy 6.02, Test_accy 6.02
2025-01-04 12:08:18,023 [asp.py] => Task 0, Epoch 4 => Loss 0.788, Train_accy 81.46, Test_curr_accy 92.25, Test_accy 92.25
2025-01-04 12:21:04,970 [asp.py] => Task 0, Epoch 5 => Loss 0.764, Train_accy 81.44, Test_curr_accy 92.62, Test_accy 92.62
2025-01-04 12:32:26,986 [asp.py] => Task 0, Epoch 3 => Loss 0.977, Train_accy 78.98, Test_curr_accy 91.53, Test_accy 91.53
2025-01-04 12:32:44,528 [asp.py] => Task 0, Epoch 3 => Loss 4.014, Train_accy 7.54, Test_curr_accy 10.17, Test_accy 10.17
2025-01-04 12:33:35,162 [asp.py] => Task 0, Epoch 6 => Loss 0.736, Train_accy 82.34, Test_curr_accy 92.58, Test_accy 92.58
2025-01-04 12:46:25,226 [asp.py] => Task 0, Epoch 7 => Loss 0.715, Train_accy 82.35, Test_curr_accy 92.53, Test_accy 92.53
2025-01-04 12:58:03,194 [asp.py] => Task 0, Epoch 4 => Loss 0.884, Train_accy 80.25, Test_curr_accy 91.68, Test_accy 91.68
2025-01-04 12:58:30,525 [asp.py] => Task 0, Epoch 4 => Loss 3.341, Train_accy 20.66, Test_curr_accy 35.10, Test_accy 35.10
2025-01-04 12:59:16,054 [asp.py] => Task 0, Epoch 8 => Loss 0.707, Train_accy 82.59, Test_curr_accy 92.82, Test_accy 92.82
2025-01-04 13:12:20,083 [asp.py] => Task 0, Epoch 9 => Loss 0.677, Train_accy 83.27, Test_curr_accy 92.92, Test_accy 92.92
2025-01-04 13:23:36,432 [asp.py] => Task 0, Epoch 5 => Loss 0.847, Train_accy 80.49, Test_curr_accy 91.92, Test_accy 91.92
2025-01-04 13:24:20,595 [asp.py] => Task 0, Epoch 5 => Loss 2.667, Train_accy 39.22, Test_curr_accy 55.47, Test_accy 55.47
2025-01-04 13:25:01,455 [asp.py] => Task 0, Epoch 10 => Loss 0.686, Train_accy 83.21, Test_curr_accy 92.95, Test_accy 92.95
2025-01-04 13:30:04,236 [trainer.py] => Top1 curve: [91.48]
2025-01-04 13:30:04,237 [trainer.py] => Average Accuracy (Top1): 91.48   (Harmonic Accuracy): None (Old Acc): 91.48333333333333 (New Acc): [] 

2025-01-04 13:30:04,239 [trainer.py] => All params: 173642241
2025-01-04 13:30:04,240 [trainer.py] => Trainable params: 2044929
2025-01-04 13:30:04,241 [asp.py] => Learning on 60-65
2025-01-04 13:30:04,266 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 13:32:40,017 [asp.py] => total parameters: 173646081
2025-01-04 13:32:40,024 [asp.py] => trainable parameters: 2048769
2025-01-04 13:33:22,226 [trainer.py] => Top1 curve: [91.48, 89.92]
2025-01-04 13:33:22,227 [trainer.py] => Average Accuracy (Top1): 90.7   (Harmonic Accuracy): 81.72465960665659 (Old Acc): 91.25 (New Acc): 74.0 

2025-01-04 13:33:22,228 [trainer.py] => All params: 173646081
2025-01-04 13:33:22,230 [trainer.py] => Trainable params: 2048769
2025-01-04 13:33:22,231 [asp.py] => Learning on 65-70
2025-01-04 13:33:22,279 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 13:35:21,433 [asp.py] => total parameters: 173649921
2025-01-04 13:35:21,434 [asp.py] => trainable parameters: 2052609
2025-01-04 13:35:59,295 [trainer.py] => Top1 curve: [91.48, 89.92, 89.41]
2025-01-04 13:35:59,296 [trainer.py] => Average Accuracy (Top1): 90.27   (Harmonic Accuracy): 84.69136479342079 (Old Acc): 91.13333333333334 (New Acc): 79.1 

2025-01-04 13:35:59,297 [trainer.py] => All params: 173649921
2025-01-04 13:35:59,298 [trainer.py] => Trainable params: 2052609
2025-01-04 13:35:59,299 [asp.py] => Learning on 70-75
2025-01-04 13:35:59,312 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 13:37:59,740 [asp.py] => total parameters: 173653761
2025-01-04 13:37:59,741 [asp.py] => trainable parameters: 2056449
2025-01-04 13:38:42,243 [trainer.py] => Top1 curve: [91.48, 89.92, 89.41, 88.25]
2025-01-04 13:38:42,243 [trainer.py] => Average Accuracy (Top1): 89.765   (Harmonic Accuracy): 83.82719367588932 (Old Acc): 90.86666666666667 (New Acc): 77.8 

2025-01-04 13:38:42,244 [trainer.py] => All params: 173653761
2025-01-04 13:38:42,245 [trainer.py] => Trainable params: 2056449
2025-01-04 13:38:42,246 [asp.py] => Learning on 75-80
2025-01-04 13:38:42,278 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 13:40:44,709 [asp.py] => total parameters: 173657601
2025-01-04 13:40:44,710 [asp.py] => trainable parameters: 2060289
2025-01-04 13:41:28,073 [trainer.py] => Top1 curve: [91.48, 89.92, 89.41, 88.25, 88.32]
2025-01-04 13:41:28,074 [trainer.py] => Average Accuracy (Top1): 89.476   (Harmonic Accuracy): 85.56458940011649 (Old Acc): 90.8 (New Acc): 80.9 

2025-01-04 13:41:28,076 [trainer.py] => All params: 173657601
2025-01-04 13:41:28,077 [trainer.py] => Trainable params: 2060289
2025-01-04 13:41:28,079 [asp.py] => Learning on 80-85
2025-01-04 13:41:28,104 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 13:43:30,181 [asp.py] => total parameters: 173661441
2025-01-04 13:43:30,182 [asp.py] => trainable parameters: 2064129
2025-01-04 13:44:16,650 [trainer.py] => Top1 curve: [91.48, 89.92, 89.41, 88.25, 88.32, 87.72]
2025-01-04 13:44:16,651 [trainer.py] => Average Accuracy (Top1): 89.18333333333334   (Harmonic Accuracy): 85.31474178038195 (Old Acc): 90.71666666666668 (New Acc): 80.52000000000001 

2025-01-04 13:44:16,653 [trainer.py] => All params: 173661441
2025-01-04 13:44:16,653 [trainer.py] => Trainable params: 2064129
2025-01-04 13:44:16,655 [asp.py] => Learning on 85-90
2025-01-04 13:44:16,697 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 13:46:18,806 [asp.py] => total parameters: 173665281
2025-01-04 13:46:18,807 [asp.py] => trainable parameters: 2067969
2025-01-04 13:47:09,317 [trainer.py] => Top1 curve: [91.48, 89.92, 89.41, 88.25, 88.32, 87.72, 87.67]
2025-01-04 13:47:09,318 [trainer.py] => Average Accuracy (Top1): 88.96714285714286   (Harmonic Accuracy): 85.9971905406276 (Old Acc): 90.56666666666666 (New Acc): 81.86666666666666 

2025-01-04 13:47:09,319 [trainer.py] => All params: 173665281
2025-01-04 13:47:09,320 [trainer.py] => Trainable params: 2067969
2025-01-04 13:47:09,321 [asp.py] => Learning on 90-95
2025-01-04 13:47:09,341 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 13:49:08,883 [asp.py] => total parameters: 173669121
2025-01-04 13:49:08,884 [asp.py] => trainable parameters: 2071809
2025-01-04 13:49:59,694 [trainer.py] => Top1 curve: [91.48, 89.92, 89.41, 88.25, 88.32, 87.72, 87.67, 87.36]
2025-01-04 13:49:59,694 [trainer.py] => Average Accuracy (Top1): 88.76625   (Harmonic Accuracy): 86.04123233215546 (Old Acc): 90.46666666666665 (New Acc): 82.02857142857144 

2025-01-04 13:49:59,695 [trainer.py] => All params: 173669121
2025-01-04 13:49:59,696 [trainer.py] => Trainable params: 2071809
2025-01-04 13:49:59,698 [asp.py] => Learning on 95-100
2025-01-04 13:49:59,725 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-04 13:49:59,729 [asp.py] => total parameters: 173672961
2025-01-04 13:49:59,729 [asp.py] => trainable parameters: 2075649
2025-01-04 13:50:54,339 [trainer.py] => Top1 curve: [91.48, 89.92, 89.41, 88.25, 88.32, 87.72, 87.67, 87.36, 86.22]
2025-01-04 13:50:54,339 [trainer.py] => Average Accuracy (Top1): 88.48333333333333   (Harmonic Accuracy): 84.90138882096923 (Old Acc): 90.28333333333332 (New Acc): 80.125 

2025-01-04 13:50:54,339 [trainer.py] => 

2025-01-04 13:54:33,106 [asp.py] => Task 0, Epoch 6 => Loss 0.800, Train_accy 81.28, Test_curr_accy 92.22, Test_accy 92.22
2025-01-04 13:55:56,095 [asp.py] => Task 0, Epoch 6 => Loss 2.153, Train_accy 54.65, Test_curr_accy 66.93, Test_accy 66.93
2025-01-04 13:59:01,454 [trainer.py] => config: ./exps/cifar.json
2025-01-04 13:59:01,454 [trainer.py] => model_name: asp
2025-01-04 13:59:01,454 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 13:59:01,454 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 13:59:01,454 [trainer.py] => seed: 2024
2025-01-04 13:59:01,454 [trainer.py] => dataset: cifar224
2025-01-04 13:59:01,454 [trainer.py] => init_cls: 60
2025-01-04 13:59:01,454 [trainer.py] => increment: 5
2025-01-04 13:59:01,454 [trainer.py] => kshot: 5
2025-01-04 13:59:01,454 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 13:59:01,455 [trainer.py] => z_dim: 1000
2025-01-04 13:59:01,455 [trainer.py] => conv_dim: 64
2025-01-04 13:59:01,455 [trainer.py] => img_size: 224
2025-01-04 13:59:01,455 [trainer.py] => generator_lr: 0.001
2025-01-04 13:59:01,455 [trainer.py] => pi: 100
2025-01-04 13:59:01,455 [trainer.py] => w_bn: 50.0
2025-01-04 13:59:01,455 [trainer.py] => w_noise: 0.001
2025-01-04 13:59:01,455 [trainer.py] => server_ss: 32
2025-01-04 13:59:01,455 [trainer.py] => bn_loss: 1
2025-01-04 13:59:01,455 [trainer.py] => noise: 1
2025-01-04 13:59:01,455 [trainer.py] => ie_loss: 1
2025-01-04 13:59:01,455 [trainer.py] => act_loss: 0
2025-01-04 13:59:01,455 [trainer.py] => w_ie: 1.0
2025-01-04 13:59:01,455 [trainer.py] => w_act: 0.1
2025-01-04 13:59:01,455 [trainer.py] => syn_size: 32
2025-01-04 13:59:01,455 [trainer.py] => vpt_type: Deep
2025-01-04 13:59:01,455 [trainer.py] => prompt_token_num: 6
2025-01-04 13:59:01,455 [trainer.py] => avg_alpha: 0.8
2025-01-04 13:59:01,455 [trainer.py] => perturb_var: 1
2025-01-04 13:59:01,455 [trainer.py] => EMA_beta: 0.99
2025-01-04 13:59:01,455 [trainer.py] => anchor_lambda: 0.1
2025-01-04 13:59:01,455 [trainer.py] => kl_weight: 0.001
2025-01-04 13:59:01,455 [trainer.py] => TIP_init: zero
2025-01-04 13:59:01,455 [trainer.py] => tuned_epoch: 10
2025-01-04 13:59:01,455 [trainer.py] => fs_epoch: 0
2025-01-04 13:59:01,455 [trainer.py] => init_lr: 0.015
2025-01-04 13:59:01,455 [trainer.py] => fs_lr: 0.001
2025-01-04 13:59:01,455 [trainer.py] => batch_size: 48
2025-01-04 13:59:01,455 [trainer.py] => fs_batch_size: 16
2025-01-04 13:59:01,455 [trainer.py] => weight_decay: 0.0005
2025-01-04 13:59:01,455 [trainer.py] => min_lr: 0
2025-01-04 13:59:01,456 [trainer.py] => optimizer: sgd
2025-01-04 13:59:01,456 [trainer.py] => memory_size: 0
2025-01-04 13:59:01,456 [trainer.py] => memory_per_class: 0
2025-01-04 13:59:01,456 [trainer.py] => fixed_memory: False
2025-01-04 13:59:01,456 [trainer.py] => shuffle: False
2025-01-04 13:59:01,456 [trainer.py] => top_k: 5
2025-01-04 13:59:01,456 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 13:59:01,456 [trainer.py] => prefix: asp
2025-01-04 13:59:01,456 [trainer.py] => model_prefix: asp
2025-01-04 13:59:04,131 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:07:07,305 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:07:07,305 [trainer.py] => model_name: asp
2025-01-04 14:07:07,305 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:07:07,305 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:07:07,305 [trainer.py] => seed: 2024
2025-01-04 14:07:07,306 [trainer.py] => dataset: cifar224
2025-01-04 14:07:07,306 [trainer.py] => init_cls: 60
2025-01-04 14:07:07,306 [trainer.py] => increment: 5
2025-01-04 14:07:07,306 [trainer.py] => kshot: 5
2025-01-04 14:07:07,306 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:07:07,306 [trainer.py] => z_dim: 1000
2025-01-04 14:07:07,306 [trainer.py] => conv_dim: 64
2025-01-04 14:07:07,306 [trainer.py] => img_size: 224
2025-01-04 14:07:07,306 [trainer.py] => generator_lr: 0.001
2025-01-04 14:07:07,307 [trainer.py] => pi: 100
2025-01-04 14:07:07,307 [trainer.py] => w_bn: 50.0
2025-01-04 14:07:07,307 [trainer.py] => w_noise: 0.001
2025-01-04 14:07:07,307 [trainer.py] => server_ss: 32
2025-01-04 14:07:07,307 [trainer.py] => bn_loss: 1
2025-01-04 14:07:07,307 [trainer.py] => noise: 1
2025-01-04 14:07:07,307 [trainer.py] => ie_loss: 1
2025-01-04 14:07:07,307 [trainer.py] => act_loss: 0
2025-01-04 14:07:07,307 [trainer.py] => w_ie: 1.0
2025-01-04 14:07:07,307 [trainer.py] => w_act: 0.1
2025-01-04 14:07:07,308 [trainer.py] => syn_size: 32
2025-01-04 14:07:07,308 [trainer.py] => vpt_type: Deep
2025-01-04 14:07:07,308 [trainer.py] => prompt_token_num: 6
2025-01-04 14:07:07,308 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:07:07,308 [trainer.py] => perturb_var: 1
2025-01-04 14:07:07,308 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:07:07,308 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:07:07,308 [trainer.py] => kl_weight: 0.001
2025-01-04 14:07:07,308 [trainer.py] => TIP_init: zero
2025-01-04 14:07:07,309 [trainer.py] => tuned_epoch: 10
2025-01-04 14:07:07,309 [trainer.py] => fs_epoch: 0
2025-01-04 14:07:07,309 [trainer.py] => init_lr: 0.015
2025-01-04 14:07:07,309 [trainer.py] => fs_lr: 0.001
2025-01-04 14:07:07,309 [trainer.py] => batch_size: 48
2025-01-04 14:07:07,309 [trainer.py] => fs_batch_size: 16
2025-01-04 14:07:07,309 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:07:07,309 [trainer.py] => min_lr: 0
2025-01-04 14:07:07,309 [trainer.py] => optimizer: sgd
2025-01-04 14:07:07,309 [trainer.py] => memory_size: 0
2025-01-04 14:07:07,309 [trainer.py] => memory_per_class: 0
2025-01-04 14:07:07,309 [trainer.py] => fixed_memory: False
2025-01-04 14:07:07,309 [trainer.py] => shuffle: False
2025-01-04 14:07:07,309 [trainer.py] => top_k: 5
2025-01-04 14:07:07,309 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:07:07,309 [trainer.py] => prefix: asp
2025-01-04 14:07:07,309 [trainer.py] => model_prefix: asp
2025-01-04 14:07:09,059 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:13:24,279 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:13:24,280 [trainer.py] => model_name: asp
2025-01-04 14:13:24,280 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:13:24,280 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:13:24,280 [trainer.py] => seed: 2024
2025-01-04 14:13:24,280 [trainer.py] => dataset: cifar224
2025-01-04 14:13:24,280 [trainer.py] => init_cls: 60
2025-01-04 14:13:24,280 [trainer.py] => increment: 5
2025-01-04 14:13:24,280 [trainer.py] => kshot: 5
2025-01-04 14:13:24,280 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:13:24,280 [trainer.py] => z_dim: 1000
2025-01-04 14:13:24,280 [trainer.py] => conv_dim: 64
2025-01-04 14:13:24,280 [trainer.py] => img_size: 224
2025-01-04 14:13:24,280 [trainer.py] => generator_lr: 0.001
2025-01-04 14:13:24,280 [trainer.py] => pi: 100
2025-01-04 14:13:24,280 [trainer.py] => w_bn: 50.0
2025-01-04 14:13:24,280 [trainer.py] => w_noise: 0.001
2025-01-04 14:13:24,280 [trainer.py] => server_ss: 32
2025-01-04 14:13:24,280 [trainer.py] => bn_loss: 1
2025-01-04 14:13:24,280 [trainer.py] => noise: 1
2025-01-04 14:13:24,280 [trainer.py] => ie_loss: 1
2025-01-04 14:13:24,280 [trainer.py] => act_loss: 0
2025-01-04 14:13:24,280 [trainer.py] => w_ie: 1.0
2025-01-04 14:13:24,280 [trainer.py] => w_act: 0.1
2025-01-04 14:13:24,280 [trainer.py] => syn_size: 32
2025-01-04 14:13:24,280 [trainer.py] => vpt_type: Deep
2025-01-04 14:13:24,280 [trainer.py] => prompt_token_num: 6
2025-01-04 14:13:24,280 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:13:24,281 [trainer.py] => perturb_var: 1
2025-01-04 14:13:24,281 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:13:24,281 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:13:24,281 [trainer.py] => kl_weight: 0.001
2025-01-04 14:13:24,281 [trainer.py] => TIP_init: zero
2025-01-04 14:13:24,281 [trainer.py] => tuned_epoch: 10
2025-01-04 14:13:24,281 [trainer.py] => fs_epoch: 0
2025-01-04 14:13:24,281 [trainer.py] => init_lr: 0.015
2025-01-04 14:13:24,281 [trainer.py] => fs_lr: 0.001
2025-01-04 14:13:24,281 [trainer.py] => batch_size: 48
2025-01-04 14:13:24,281 [trainer.py] => fs_batch_size: 16
2025-01-04 14:13:24,281 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:13:24,281 [trainer.py] => min_lr: 0
2025-01-04 14:13:24,281 [trainer.py] => optimizer: sgd
2025-01-04 14:13:24,281 [trainer.py] => memory_size: 0
2025-01-04 14:13:24,281 [trainer.py] => memory_per_class: 0
2025-01-04 14:13:24,281 [trainer.py] => fixed_memory: False
2025-01-04 14:13:24,281 [trainer.py] => shuffle: False
2025-01-04 14:13:24,281 [trainer.py] => top_k: 5
2025-01-04 14:13:24,281 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:13:24,281 [trainer.py] => prefix: asp
2025-01-04 14:13:24,281 [trainer.py] => model_prefix: asp
2025-01-04 14:13:26,114 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:13:35,751 [trainer.py] => All params: 173596160
2025-01-04 14:13:35,752 [trainer.py] => Trainable params: 1998848
2025-01-04 14:14:41,983 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:14:41,983 [trainer.py] => model_name: asp
2025-01-04 14:14:41,983 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:14:41,983 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:14:41,983 [trainer.py] => seed: 2024
2025-01-04 14:14:41,983 [trainer.py] => dataset: cifar224
2025-01-04 14:14:41,983 [trainer.py] => init_cls: 60
2025-01-04 14:14:41,983 [trainer.py] => increment: 5
2025-01-04 14:14:41,983 [trainer.py] => kshot: 5
2025-01-04 14:14:41,983 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:14:41,983 [trainer.py] => z_dim: 1000
2025-01-04 14:14:41,983 [trainer.py] => conv_dim: 64
2025-01-04 14:14:41,983 [trainer.py] => img_size: 224
2025-01-04 14:14:41,983 [trainer.py] => generator_lr: 0.001
2025-01-04 14:14:41,983 [trainer.py] => pi: 100
2025-01-04 14:14:41,984 [trainer.py] => w_bn: 50.0
2025-01-04 14:14:41,984 [trainer.py] => w_noise: 0.001
2025-01-04 14:14:41,984 [trainer.py] => server_ss: 32
2025-01-04 14:14:41,984 [trainer.py] => bn_loss: 1
2025-01-04 14:14:41,984 [trainer.py] => noise: 1
2025-01-04 14:14:41,984 [trainer.py] => ie_loss: 1
2025-01-04 14:14:41,984 [trainer.py] => act_loss: 0
2025-01-04 14:14:41,984 [trainer.py] => w_ie: 1.0
2025-01-04 14:14:41,984 [trainer.py] => w_act: 0.1
2025-01-04 14:14:41,984 [trainer.py] => syn_size: 32
2025-01-04 14:14:41,984 [trainer.py] => vpt_type: Deep
2025-01-04 14:14:41,984 [trainer.py] => prompt_token_num: 6
2025-01-04 14:14:41,984 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:14:41,984 [trainer.py] => perturb_var: 1
2025-01-04 14:14:41,984 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:14:41,984 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:14:41,984 [trainer.py] => kl_weight: 0.001
2025-01-04 14:14:41,984 [trainer.py] => TIP_init: zero
2025-01-04 14:14:41,984 [trainer.py] => tuned_epoch: 10
2025-01-04 14:14:41,984 [trainer.py] => fs_epoch: 0
2025-01-04 14:14:41,984 [trainer.py] => init_lr: 0.015
2025-01-04 14:14:41,984 [trainer.py] => fs_lr: 0.001
2025-01-04 14:14:41,984 [trainer.py] => batch_size: 48
2025-01-04 14:14:41,985 [trainer.py] => fs_batch_size: 16
2025-01-04 14:14:41,985 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:14:41,985 [trainer.py] => min_lr: 0
2025-01-04 14:14:41,985 [trainer.py] => optimizer: sgd
2025-01-04 14:14:41,985 [trainer.py] => memory_size: 0
2025-01-04 14:14:41,985 [trainer.py] => memory_per_class: 0
2025-01-04 14:14:41,985 [trainer.py] => fixed_memory: False
2025-01-04 14:14:41,985 [trainer.py] => shuffle: False
2025-01-04 14:14:41,985 [trainer.py] => top_k: 5
2025-01-04 14:14:41,985 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:14:41,985 [trainer.py] => prefix: asp
2025-01-04 14:14:41,985 [trainer.py] => model_prefix: asp
2025-01-04 14:14:43,790 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:15:35,783 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:15:35,784 [trainer.py] => model_name: asp
2025-01-04 14:15:35,784 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:15:35,784 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:15:35,785 [trainer.py] => seed: 2024
2025-01-04 14:15:35,785 [trainer.py] => dataset: cifar224
2025-01-04 14:15:35,785 [trainer.py] => init_cls: 60
2025-01-04 14:15:35,785 [trainer.py] => increment: 5
2025-01-04 14:15:35,785 [trainer.py] => kshot: 5
2025-01-04 14:15:35,785 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:15:35,785 [trainer.py] => z_dim: 1000
2025-01-04 14:15:35,785 [trainer.py] => conv_dim: 64
2025-01-04 14:15:35,785 [trainer.py] => img_size: 224
2025-01-04 14:15:35,785 [trainer.py] => generator_lr: 0.001
2025-01-04 14:15:35,785 [trainer.py] => pi: 100
2025-01-04 14:15:35,785 [trainer.py] => w_bn: 50.0
2025-01-04 14:15:35,785 [trainer.py] => w_noise: 0.001
2025-01-04 14:15:35,786 [trainer.py] => server_ss: 32
2025-01-04 14:15:35,786 [trainer.py] => bn_loss: 1
2025-01-04 14:15:35,786 [trainer.py] => noise: 1
2025-01-04 14:15:35,786 [trainer.py] => ie_loss: 1
2025-01-04 14:15:35,786 [trainer.py] => act_loss: 0
2025-01-04 14:15:35,786 [trainer.py] => w_ie: 1.0
2025-01-04 14:15:35,786 [trainer.py] => w_act: 0.1
2025-01-04 14:15:35,786 [trainer.py] => syn_size: 32
2025-01-04 14:15:35,786 [trainer.py] => vpt_type: Deep
2025-01-04 14:15:35,786 [trainer.py] => prompt_token_num: 6
2025-01-04 14:15:35,786 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:15:35,786 [trainer.py] => perturb_var: 1
2025-01-04 14:15:35,786 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:15:35,786 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:15:35,786 [trainer.py] => kl_weight: 0.001
2025-01-04 14:15:35,786 [trainer.py] => TIP_init: zero
2025-01-04 14:15:35,786 [trainer.py] => tuned_epoch: 10
2025-01-04 14:15:35,786 [trainer.py] => fs_epoch: 0
2025-01-04 14:15:35,787 [trainer.py] => init_lr: 0.015
2025-01-04 14:15:35,787 [trainer.py] => fs_lr: 0.001
2025-01-04 14:15:35,787 [trainer.py] => batch_size: 48
2025-01-04 14:15:35,787 [trainer.py] => fs_batch_size: 16
2025-01-04 14:15:35,787 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:15:35,787 [trainer.py] => min_lr: 0
2025-01-04 14:15:35,787 [trainer.py] => optimizer: sgd
2025-01-04 14:15:35,787 [trainer.py] => memory_size: 0
2025-01-04 14:15:35,787 [trainer.py] => memory_per_class: 0
2025-01-04 14:15:35,787 [trainer.py] => fixed_memory: False
2025-01-04 14:15:35,787 [trainer.py] => shuffle: False
2025-01-04 14:15:35,787 [trainer.py] => top_k: 5
2025-01-04 14:15:35,787 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:15:35,787 [trainer.py] => prefix: asp
2025-01-04 14:15:35,787 [trainer.py] => model_prefix: asp
2025-01-04 14:15:37,797 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:17:40,069 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:17:40,069 [trainer.py] => model_name: asp
2025-01-04 14:17:40,069 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:17:40,069 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:17:40,069 [trainer.py] => seed: 2024
2025-01-04 14:17:40,069 [trainer.py] => dataset: cifar224
2025-01-04 14:17:40,069 [trainer.py] => init_cls: 60
2025-01-04 14:17:40,069 [trainer.py] => increment: 5
2025-01-04 14:17:40,069 [trainer.py] => kshot: 5
2025-01-04 14:17:40,069 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:17:40,069 [trainer.py] => z_dim: 1000
2025-01-04 14:17:40,069 [trainer.py] => conv_dim: 64
2025-01-04 14:17:40,069 [trainer.py] => img_size: 224
2025-01-04 14:17:40,069 [trainer.py] => generator_lr: 0.001
2025-01-04 14:17:40,069 [trainer.py] => pi: 100
2025-01-04 14:17:40,069 [trainer.py] => w_bn: 50.0
2025-01-04 14:17:40,069 [trainer.py] => w_noise: 0.001
2025-01-04 14:17:40,069 [trainer.py] => server_ss: 32
2025-01-04 14:17:40,069 [trainer.py] => bn_loss: 1
2025-01-04 14:17:40,069 [trainer.py] => noise: 1
2025-01-04 14:17:40,069 [trainer.py] => ie_loss: 1
2025-01-04 14:17:40,069 [trainer.py] => act_loss: 0
2025-01-04 14:17:40,070 [trainer.py] => w_ie: 1.0
2025-01-04 14:17:40,070 [trainer.py] => w_act: 0.1
2025-01-04 14:17:40,070 [trainer.py] => syn_size: 32
2025-01-04 14:17:40,070 [trainer.py] => vpt_type: Deep
2025-01-04 14:17:40,070 [trainer.py] => prompt_token_num: 6
2025-01-04 14:17:40,070 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:17:40,070 [trainer.py] => perturb_var: 1
2025-01-04 14:17:40,070 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:17:40,070 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:17:40,070 [trainer.py] => kl_weight: 0.001
2025-01-04 14:17:40,070 [trainer.py] => TIP_init: zero
2025-01-04 14:17:40,070 [trainer.py] => tuned_epoch: 10
2025-01-04 14:17:40,070 [trainer.py] => fs_epoch: 0
2025-01-04 14:17:40,070 [trainer.py] => init_lr: 0.015
2025-01-04 14:17:40,070 [trainer.py] => fs_lr: 0.001
2025-01-04 14:17:40,070 [trainer.py] => batch_size: 48
2025-01-04 14:17:40,070 [trainer.py] => fs_batch_size: 16
2025-01-04 14:17:40,070 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:17:40,070 [trainer.py] => min_lr: 0
2025-01-04 14:17:40,070 [trainer.py] => optimizer: sgd
2025-01-04 14:17:40,070 [trainer.py] => memory_size: 0
2025-01-04 14:17:40,070 [trainer.py] => memory_per_class: 0
2025-01-04 14:17:40,070 [trainer.py] => fixed_memory: False
2025-01-04 14:17:40,070 [trainer.py] => shuffle: False
2025-01-04 14:17:40,070 [trainer.py] => top_k: 5
2025-01-04 14:17:40,070 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:17:40,070 [trainer.py] => prefix: asp
2025-01-04 14:17:40,070 [trainer.py] => model_prefix: asp
2025-01-04 14:17:41,966 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:17:57,102 [trainer.py] => All params: 173596160
2025-01-04 14:17:57,104 [trainer.py] => Trainable params: 1998848
2025-01-04 14:18:05,733 [asp.py] => Learning on 0-60
2025-01-04 14:18:05,918 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:18:56,394 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:18:56,394 [trainer.py] => model_name: asp
2025-01-04 14:18:56,394 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:18:56,394 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:18:56,394 [trainer.py] => seed: 2024
2025-01-04 14:18:56,394 [trainer.py] => dataset: cifar224
2025-01-04 14:18:56,394 [trainer.py] => init_cls: 60
2025-01-04 14:18:56,394 [trainer.py] => increment: 5
2025-01-04 14:18:56,394 [trainer.py] => kshot: 5
2025-01-04 14:18:56,394 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:18:56,394 [trainer.py] => z_dim: 1000
2025-01-04 14:18:56,394 [trainer.py] => conv_dim: 64
2025-01-04 14:18:56,394 [trainer.py] => img_size: 224
2025-01-04 14:18:56,395 [trainer.py] => generator_lr: 0.001
2025-01-04 14:18:56,395 [trainer.py] => pi: 100
2025-01-04 14:18:56,395 [trainer.py] => w_bn: 50.0
2025-01-04 14:18:56,395 [trainer.py] => w_noise: 0.001
2025-01-04 14:18:56,395 [trainer.py] => server_ss: 32
2025-01-04 14:18:56,395 [trainer.py] => bn_loss: 1
2025-01-04 14:18:56,395 [trainer.py] => noise: 1
2025-01-04 14:18:56,395 [trainer.py] => ie_loss: 1
2025-01-04 14:18:56,395 [trainer.py] => act_loss: 0
2025-01-04 14:18:56,395 [trainer.py] => w_ie: 1.0
2025-01-04 14:18:56,395 [trainer.py] => w_act: 0.1
2025-01-04 14:18:56,395 [trainer.py] => syn_size: 32
2025-01-04 14:18:56,395 [trainer.py] => vpt_type: Deep
2025-01-04 14:18:56,395 [trainer.py] => prompt_token_num: 6
2025-01-04 14:18:56,395 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:18:56,395 [trainer.py] => perturb_var: 1
2025-01-04 14:18:56,395 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:18:56,395 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:18:56,395 [trainer.py] => kl_weight: 0.001
2025-01-04 14:18:56,395 [trainer.py] => TIP_init: zero
2025-01-04 14:18:56,395 [trainer.py] => tuned_epoch: 10
2025-01-04 14:18:56,395 [trainer.py] => fs_epoch: 0
2025-01-04 14:18:56,395 [trainer.py] => init_lr: 0.015
2025-01-04 14:18:56,395 [trainer.py] => fs_lr: 0.001
2025-01-04 14:18:56,395 [trainer.py] => batch_size: 48
2025-01-04 14:18:56,395 [trainer.py] => fs_batch_size: 16
2025-01-04 14:18:56,395 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:18:56,395 [trainer.py] => min_lr: 0
2025-01-04 14:18:56,395 [trainer.py] => optimizer: sgd
2025-01-04 14:18:56,395 [trainer.py] => memory_size: 0
2025-01-04 14:18:56,395 [trainer.py] => memory_per_class: 0
2025-01-04 14:18:56,396 [trainer.py] => fixed_memory: False
2025-01-04 14:18:56,396 [trainer.py] => shuffle: False
2025-01-04 14:18:56,396 [trainer.py] => top_k: 5
2025-01-04 14:18:56,396 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:18:56,396 [trainer.py] => prefix: asp
2025-01-04 14:18:56,396 [trainer.py] => model_prefix: asp
2025-01-04 14:18:58,470 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:19:09,360 [trainer.py] => All params: 173596160
2025-01-04 14:19:09,361 [trainer.py] => Trainable params: 1998848
2025-01-04 14:19:29,489 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:19:29,490 [trainer.py] => model_name: asp
2025-01-04 14:19:29,490 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:19:29,490 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:19:29,490 [trainer.py] => seed: 2024
2025-01-04 14:19:29,490 [trainer.py] => dataset: cifar224
2025-01-04 14:19:29,490 [trainer.py] => init_cls: 60
2025-01-04 14:19:29,490 [trainer.py] => increment: 5
2025-01-04 14:19:29,490 [trainer.py] => kshot: 5
2025-01-04 14:19:29,490 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:19:29,490 [trainer.py] => z_dim: 1000
2025-01-04 14:19:29,490 [trainer.py] => conv_dim: 64
2025-01-04 14:19:29,490 [trainer.py] => img_size: 224
2025-01-04 14:19:29,490 [trainer.py] => generator_lr: 0.001
2025-01-04 14:19:29,490 [trainer.py] => pi: 100
2025-01-04 14:19:29,490 [trainer.py] => w_bn: 50.0
2025-01-04 14:19:29,490 [trainer.py] => w_noise: 0.001
2025-01-04 14:19:29,490 [trainer.py] => server_ss: 32
2025-01-04 14:19:29,491 [trainer.py] => bn_loss: 1
2025-01-04 14:19:29,491 [trainer.py] => noise: 1
2025-01-04 14:19:29,491 [trainer.py] => ie_loss: 1
2025-01-04 14:19:29,491 [trainer.py] => act_loss: 0
2025-01-04 14:19:29,491 [trainer.py] => w_ie: 1.0
2025-01-04 14:19:29,491 [trainer.py] => w_act: 0.1
2025-01-04 14:19:29,491 [trainer.py] => syn_size: 32
2025-01-04 14:19:29,491 [trainer.py] => vpt_type: Deep
2025-01-04 14:19:29,491 [trainer.py] => prompt_token_num: 6
2025-01-04 14:19:29,491 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:19:29,491 [trainer.py] => perturb_var: 1
2025-01-04 14:19:29,492 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:19:29,492 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:19:29,492 [trainer.py] => kl_weight: 0.001
2025-01-04 14:19:29,492 [trainer.py] => TIP_init: zero
2025-01-04 14:19:29,492 [trainer.py] => tuned_epoch: 10
2025-01-04 14:19:29,492 [trainer.py] => fs_epoch: 0
2025-01-04 14:19:29,493 [trainer.py] => init_lr: 0.015
2025-01-04 14:19:29,494 [trainer.py] => fs_lr: 0.001
2025-01-04 14:19:29,494 [trainer.py] => batch_size: 48
2025-01-04 14:19:29,494 [trainer.py] => fs_batch_size: 16
2025-01-04 14:19:29,494 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:19:29,494 [trainer.py] => min_lr: 0
2025-01-04 14:19:29,495 [trainer.py] => optimizer: sgd
2025-01-04 14:19:29,495 [trainer.py] => memory_size: 0
2025-01-04 14:19:29,495 [trainer.py] => memory_per_class: 0
2025-01-04 14:19:29,495 [trainer.py] => fixed_memory: False
2025-01-04 14:19:29,495 [trainer.py] => shuffle: False
2025-01-04 14:19:29,495 [trainer.py] => top_k: 5
2025-01-04 14:19:29,496 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:19:29,496 [trainer.py] => prefix: asp
2025-01-04 14:19:29,496 [trainer.py] => model_prefix: asp
2025-01-04 14:19:31,529 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:19:47,717 [trainer.py] => All params: 173596160
2025-01-04 14:19:47,719 [trainer.py] => Trainable params: 1998848
2025-01-04 14:19:48,190 [asp.py] => Learning on 0-60
2025-01-04 14:19:48,579 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:20:15,080 [asp.py] => Task 0, Epoch 7 => Loss 0.777, Train_accy 81.65, Test_curr_accy 92.42, Test_accy 92.42
2025-01-04 14:21:35,761 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:21:35,761 [trainer.py] => model_name: asp
2025-01-04 14:21:35,761 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:21:35,762 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:21:35,762 [trainer.py] => seed: 2024
2025-01-04 14:21:35,762 [trainer.py] => dataset: cifar224
2025-01-04 14:21:35,762 [trainer.py] => init_cls: 60
2025-01-04 14:21:35,762 [trainer.py] => increment: 5
2025-01-04 14:21:35,762 [trainer.py] => kshot: 5
2025-01-04 14:21:35,762 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:21:35,762 [trainer.py] => z_dim: 1000
2025-01-04 14:21:35,762 [trainer.py] => conv_dim: 64
2025-01-04 14:21:35,762 [trainer.py] => img_size: 224
2025-01-04 14:21:35,762 [trainer.py] => generator_lr: 0.001
2025-01-04 14:21:35,762 [trainer.py] => pi: 100
2025-01-04 14:21:35,762 [trainer.py] => w_bn: 50.0
2025-01-04 14:21:35,762 [trainer.py] => w_noise: 0.001
2025-01-04 14:21:35,762 [trainer.py] => server_ss: 32
2025-01-04 14:21:35,762 [trainer.py] => bn_loss: 1
2025-01-04 14:21:35,762 [trainer.py] => noise: 1
2025-01-04 14:21:35,762 [trainer.py] => ie_loss: 1
2025-01-04 14:21:35,762 [trainer.py] => act_loss: 0
2025-01-04 14:21:35,762 [trainer.py] => w_ie: 1.0
2025-01-04 14:21:35,762 [trainer.py] => w_act: 0.1
2025-01-04 14:21:35,762 [trainer.py] => syn_size: 32
2025-01-04 14:21:35,762 [trainer.py] => vpt_type: Deep
2025-01-04 14:21:35,762 [trainer.py] => prompt_token_num: 6
2025-01-04 14:21:35,762 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:21:35,762 [trainer.py] => perturb_var: 1
2025-01-04 14:21:35,762 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:21:35,762 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:21:35,762 [trainer.py] => kl_weight: 0.001
2025-01-04 14:21:35,762 [trainer.py] => TIP_init: zero
2025-01-04 14:21:35,763 [trainer.py] => tuned_epoch: 10
2025-01-04 14:21:35,763 [trainer.py] => fs_epoch: 0
2025-01-04 14:21:35,763 [trainer.py] => init_lr: 0.015
2025-01-04 14:21:35,763 [trainer.py] => fs_lr: 0.001
2025-01-04 14:21:35,763 [trainer.py] => batch_size: 48
2025-01-04 14:21:35,763 [trainer.py] => fs_batch_size: 16
2025-01-04 14:21:35,763 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:21:35,763 [trainer.py] => min_lr: 0
2025-01-04 14:21:35,763 [trainer.py] => optimizer: sgd
2025-01-04 14:21:35,763 [trainer.py] => memory_size: 0
2025-01-04 14:21:35,763 [trainer.py] => memory_per_class: 0
2025-01-04 14:21:35,763 [trainer.py] => fixed_memory: False
2025-01-04 14:21:35,763 [trainer.py] => shuffle: False
2025-01-04 14:21:35,763 [trainer.py] => top_k: 5
2025-01-04 14:21:35,763 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:21:35,763 [trainer.py] => prefix: asp
2025-01-04 14:21:35,763 [trainer.py] => model_prefix: asp
2025-01-04 14:21:37,653 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:21:39,937 [asp.py] => Task 0, Epoch 7 => Loss 2.007, Train_accy 59.15, Test_curr_accy 66.28, Test_accy 66.28
2025-01-04 14:21:51,207 [trainer.py] => All params: 173596160
2025-01-04 14:21:51,209 [trainer.py] => Trainable params: 1998848
2025-01-04 14:21:51,590 [asp.py] => Learning on 0-60
2025-01-04 14:21:51,731 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:24:32,478 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:24:32,478 [trainer.py] => model_name: asp
2025-01-04 14:24:32,478 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:24:32,478 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:24:32,478 [trainer.py] => seed: 2024
2025-01-04 14:24:32,478 [trainer.py] => dataset: cifar224
2025-01-04 14:24:32,478 [trainer.py] => init_cls: 60
2025-01-04 14:24:32,478 [trainer.py] => increment: 5
2025-01-04 14:24:32,478 [trainer.py] => kshot: 5
2025-01-04 14:24:32,478 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:24:32,478 [trainer.py] => z_dim: 1000
2025-01-04 14:24:32,478 [trainer.py] => conv_dim: 64
2025-01-04 14:24:32,478 [trainer.py] => img_size: 224
2025-01-04 14:24:32,478 [trainer.py] => generator_lr: 0.001
2025-01-04 14:24:32,478 [trainer.py] => pi: 100
2025-01-04 14:24:32,478 [trainer.py] => w_bn: 50.0
2025-01-04 14:24:32,478 [trainer.py] => w_noise: 0.001
2025-01-04 14:24:32,478 [trainer.py] => server_ss: 32
2025-01-04 14:24:32,479 [trainer.py] => bn_loss: 1
2025-01-04 14:24:32,479 [trainer.py] => noise: 1
2025-01-04 14:24:32,479 [trainer.py] => ie_loss: 1
2025-01-04 14:24:32,479 [trainer.py] => act_loss: 0
2025-01-04 14:24:32,479 [trainer.py] => w_ie: 1.0
2025-01-04 14:24:32,479 [trainer.py] => w_act: 0.1
2025-01-04 14:24:32,479 [trainer.py] => syn_size: 32
2025-01-04 14:24:32,479 [trainer.py] => vpt_type: Deep
2025-01-04 14:24:32,479 [trainer.py] => prompt_token_num: 6
2025-01-04 14:24:32,479 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:24:32,479 [trainer.py] => perturb_var: 1
2025-01-04 14:24:32,479 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:24:32,479 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:24:32,479 [trainer.py] => kl_weight: 0.001
2025-01-04 14:24:32,479 [trainer.py] => TIP_init: zero
2025-01-04 14:24:32,479 [trainer.py] => tuned_epoch: 10
2025-01-04 14:24:32,479 [trainer.py] => fs_epoch: 0
2025-01-04 14:24:32,479 [trainer.py] => init_lr: 0.015
2025-01-04 14:24:32,479 [trainer.py] => fs_lr: 0.001
2025-01-04 14:24:32,479 [trainer.py] => batch_size: 48
2025-01-04 14:24:32,479 [trainer.py] => fs_batch_size: 16
2025-01-04 14:24:32,479 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:24:32,479 [trainer.py] => min_lr: 0
2025-01-04 14:24:32,479 [trainer.py] => optimizer: sgd
2025-01-04 14:24:32,479 [trainer.py] => memory_size: 0
2025-01-04 14:24:32,479 [trainer.py] => memory_per_class: 0
2025-01-04 14:24:32,480 [trainer.py] => fixed_memory: False
2025-01-04 14:24:32,480 [trainer.py] => shuffle: False
2025-01-04 14:24:32,480 [trainer.py] => top_k: 5
2025-01-04 14:24:32,480 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:24:32,480 [trainer.py] => prefix: asp
2025-01-04 14:24:32,480 [trainer.py] => model_prefix: asp
2025-01-04 14:24:34,386 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:24:48,726 [trainer.py] => All params: 173596160
2025-01-04 14:24:48,731 [trainer.py] => Trainable params: 1998848
2025-01-04 14:24:49,198 [asp.py] => Learning on 0-60
2025-01-04 14:24:49,405 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:27:34,538 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:27:34,539 [trainer.py] => model_name: asp
2025-01-04 14:27:34,539 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:27:34,539 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:27:34,539 [trainer.py] => seed: 2024
2025-01-04 14:27:34,539 [trainer.py] => dataset: cifar224
2025-01-04 14:27:34,539 [trainer.py] => init_cls: 60
2025-01-04 14:27:34,539 [trainer.py] => increment: 5
2025-01-04 14:27:34,539 [trainer.py] => kshot: 5
2025-01-04 14:27:34,539 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:27:34,539 [trainer.py] => z_dim: 1000
2025-01-04 14:27:34,539 [trainer.py] => conv_dim: 64
2025-01-04 14:27:34,539 [trainer.py] => img_size: 224
2025-01-04 14:27:34,539 [trainer.py] => generator_lr: 0.001
2025-01-04 14:27:34,539 [trainer.py] => pi: 100
2025-01-04 14:27:34,539 [trainer.py] => w_bn: 50.0
2025-01-04 14:27:34,539 [trainer.py] => w_noise: 0.001
2025-01-04 14:27:34,539 [trainer.py] => server_ss: 32
2025-01-04 14:27:34,539 [trainer.py] => bn_loss: 1
2025-01-04 14:27:34,539 [trainer.py] => noise: 1
2025-01-04 14:27:34,540 [trainer.py] => ie_loss: 1
2025-01-04 14:27:34,540 [trainer.py] => act_loss: 0
2025-01-04 14:27:34,540 [trainer.py] => w_ie: 1.0
2025-01-04 14:27:34,540 [trainer.py] => w_act: 0.1
2025-01-04 14:27:34,540 [trainer.py] => syn_size: 32
2025-01-04 14:27:34,540 [trainer.py] => vpt_type: Deep
2025-01-04 14:27:34,540 [trainer.py] => prompt_token_num: 6
2025-01-04 14:27:34,540 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:27:34,540 [trainer.py] => perturb_var: 1
2025-01-04 14:27:34,540 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:27:34,540 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:27:34,540 [trainer.py] => kl_weight: 0.001
2025-01-04 14:27:34,540 [trainer.py] => TIP_init: zero
2025-01-04 14:27:34,540 [trainer.py] => tuned_epoch: 10
2025-01-04 14:27:34,540 [trainer.py] => fs_epoch: 0
2025-01-04 14:27:34,540 [trainer.py] => init_lr: 0.015
2025-01-04 14:27:34,540 [trainer.py] => fs_lr: 0.001
2025-01-04 14:27:34,540 [trainer.py] => batch_size: 48
2025-01-04 14:27:34,540 [trainer.py] => fs_batch_size: 16
2025-01-04 14:27:34,540 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:27:34,540 [trainer.py] => min_lr: 0
2025-01-04 14:27:34,540 [trainer.py] => optimizer: sgd
2025-01-04 14:27:34,540 [trainer.py] => memory_size: 0
2025-01-04 14:27:34,540 [trainer.py] => memory_per_class: 0
2025-01-04 14:27:34,540 [trainer.py] => fixed_memory: False
2025-01-04 14:27:34,540 [trainer.py] => shuffle: False
2025-01-04 14:27:34,540 [trainer.py] => top_k: 5
2025-01-04 14:27:34,540 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:27:34,541 [trainer.py] => prefix: asp
2025-01-04 14:27:34,541 [trainer.py] => model_prefix: asp
2025-01-04 14:27:36,334 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:27:49,176 [trainer.py] => All params: 173596160
2025-01-04 14:27:49,177 [trainer.py] => Trainable params: 1998848
2025-01-04 14:27:49,637 [asp.py] => Learning on 0-60
2025-01-04 14:27:49,847 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:33:28,558 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:33:28,558 [trainer.py] => model_name: asp
2025-01-04 14:33:28,558 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:33:28,558 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:33:28,558 [trainer.py] => seed: 2024
2025-01-04 14:33:28,558 [trainer.py] => dataset: cifar224
2025-01-04 14:33:28,558 [trainer.py] => init_cls: 60
2025-01-04 14:33:28,558 [trainer.py] => increment: 5
2025-01-04 14:33:28,558 [trainer.py] => kshot: 5
2025-01-04 14:33:28,558 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:33:28,558 [trainer.py] => z_dim: 1000
2025-01-04 14:33:28,558 [trainer.py] => conv_dim: 64
2025-01-04 14:33:28,559 [trainer.py] => img_size: 224
2025-01-04 14:33:28,559 [trainer.py] => generator_lr: 0.001
2025-01-04 14:33:28,559 [trainer.py] => pi: 100
2025-01-04 14:33:28,559 [trainer.py] => w_bn: 50.0
2025-01-04 14:33:28,559 [trainer.py] => w_noise: 0.001
2025-01-04 14:33:28,559 [trainer.py] => server_ss: 32
2025-01-04 14:33:28,559 [trainer.py] => bn_loss: 1
2025-01-04 14:33:28,559 [trainer.py] => noise: 1
2025-01-04 14:33:28,559 [trainer.py] => ie_loss: 1
2025-01-04 14:33:28,559 [trainer.py] => act_loss: 0
2025-01-04 14:33:28,559 [trainer.py] => w_ie: 1.0
2025-01-04 14:33:28,559 [trainer.py] => w_act: 0.1
2025-01-04 14:33:28,559 [trainer.py] => syn_size: 32
2025-01-04 14:33:28,559 [trainer.py] => vpt_type: Deep
2025-01-04 14:33:28,559 [trainer.py] => prompt_token_num: 6
2025-01-04 14:33:28,559 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:33:28,559 [trainer.py] => perturb_var: 1
2025-01-04 14:33:28,559 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:33:28,559 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:33:28,559 [trainer.py] => kl_weight: 0.001
2025-01-04 14:33:28,559 [trainer.py] => TIP_init: zero
2025-01-04 14:33:28,559 [trainer.py] => tuned_epoch: 10
2025-01-04 14:33:28,559 [trainer.py] => fs_epoch: 0
2025-01-04 14:33:28,559 [trainer.py] => init_lr: 0.015
2025-01-04 14:33:28,559 [trainer.py] => fs_lr: 0.001
2025-01-04 14:33:28,559 [trainer.py] => batch_size: 48
2025-01-04 14:33:28,559 [trainer.py] => fs_batch_size: 16
2025-01-04 14:33:28,559 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:33:28,559 [trainer.py] => min_lr: 0
2025-01-04 14:33:28,559 [trainer.py] => optimizer: sgd
2025-01-04 14:33:28,559 [trainer.py] => memory_size: 0
2025-01-04 14:33:28,560 [trainer.py] => memory_per_class: 0
2025-01-04 14:33:28,560 [trainer.py] => fixed_memory: False
2025-01-04 14:33:28,560 [trainer.py] => shuffle: False
2025-01-04 14:33:28,560 [trainer.py] => top_k: 5
2025-01-04 14:33:28,560 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:33:28,560 [trainer.py] => prefix: asp
2025-01-04 14:33:28,560 [trainer.py] => model_prefix: asp
2025-01-04 14:33:30,395 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:33:41,241 [trainer.py] => All params: 173596160
2025-01-04 14:33:41,242 [trainer.py] => Trainable params: 1998848
2025-01-04 14:33:41,643 [asp.py] => Learning on 0-60
2025-01-04 14:33:41,848 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:35:21,226 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:35:21,226 [trainer.py] => model_name: asp
2025-01-04 14:35:21,226 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:35:21,226 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:35:21,226 [trainer.py] => seed: 2024
2025-01-04 14:35:21,226 [trainer.py] => dataset: cifar224
2025-01-04 14:35:21,226 [trainer.py] => init_cls: 60
2025-01-04 14:35:21,226 [trainer.py] => increment: 5
2025-01-04 14:35:21,226 [trainer.py] => kshot: 5
2025-01-04 14:35:21,226 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:35:21,226 [trainer.py] => z_dim: 1000
2025-01-04 14:35:21,227 [trainer.py] => conv_dim: 64
2025-01-04 14:35:21,227 [trainer.py] => img_size: 224
2025-01-04 14:35:21,227 [trainer.py] => generator_lr: 0.001
2025-01-04 14:35:21,227 [trainer.py] => pi: 100
2025-01-04 14:35:21,227 [trainer.py] => w_bn: 50.0
2025-01-04 14:35:21,227 [trainer.py] => w_noise: 0.001
2025-01-04 14:35:21,227 [trainer.py] => server_ss: 32
2025-01-04 14:35:21,227 [trainer.py] => bn_loss: 1
2025-01-04 14:35:21,227 [trainer.py] => noise: 1
2025-01-04 14:35:21,227 [trainer.py] => ie_loss: 1
2025-01-04 14:35:21,227 [trainer.py] => act_loss: 0
2025-01-04 14:35:21,227 [trainer.py] => w_ie: 1.0
2025-01-04 14:35:21,227 [trainer.py] => w_act: 0.1
2025-01-04 14:35:21,227 [trainer.py] => syn_size: 32
2025-01-04 14:35:21,227 [trainer.py] => vpt_type: Deep
2025-01-04 14:35:21,227 [trainer.py] => prompt_token_num: 6
2025-01-04 14:35:21,227 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:35:21,227 [trainer.py] => perturb_var: 1
2025-01-04 14:35:21,227 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:35:21,227 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:35:21,227 [trainer.py] => kl_weight: 0.001
2025-01-04 14:35:21,227 [trainer.py] => TIP_init: zero
2025-01-04 14:35:21,227 [trainer.py] => tuned_epoch: 10
2025-01-04 14:35:21,227 [trainer.py] => fs_epoch: 0
2025-01-04 14:35:21,227 [trainer.py] => init_lr: 0.015
2025-01-04 14:35:21,227 [trainer.py] => fs_lr: 0.001
2025-01-04 14:35:21,227 [trainer.py] => batch_size: 48
2025-01-04 14:35:21,227 [trainer.py] => fs_batch_size: 16
2025-01-04 14:35:21,227 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:35:21,227 [trainer.py] => min_lr: 0
2025-01-04 14:35:21,227 [trainer.py] => optimizer: sgd
2025-01-04 14:35:21,227 [trainer.py] => memory_size: 0
2025-01-04 14:35:21,228 [trainer.py] => memory_per_class: 0
2025-01-04 14:35:21,228 [trainer.py] => fixed_memory: False
2025-01-04 14:35:21,228 [trainer.py] => shuffle: False
2025-01-04 14:35:21,228 [trainer.py] => top_k: 5
2025-01-04 14:35:21,228 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:35:21,228 [trainer.py] => prefix: asp
2025-01-04 14:35:21,228 [trainer.py] => model_prefix: asp
2025-01-04 14:35:23,212 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:35:34,868 [trainer.py] => All params: 173596160
2025-01-04 14:35:34,869 [trainer.py] => Trainable params: 1998848
2025-01-04 14:35:35,284 [asp.py] => Learning on 0-60
2025-01-04 14:35:35,559 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:36:22,063 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:36:22,064 [trainer.py] => model_name: asp
2025-01-04 14:36:22,064 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:36:22,064 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:36:22,065 [trainer.py] => seed: 2024
2025-01-04 14:36:22,065 [trainer.py] => dataset: cifar224
2025-01-04 14:36:22,065 [trainer.py] => init_cls: 60
2025-01-04 14:36:22,065 [trainer.py] => increment: 5
2025-01-04 14:36:22,065 [trainer.py] => kshot: 5
2025-01-04 14:36:22,066 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:36:22,066 [trainer.py] => z_dim: 1000
2025-01-04 14:36:22,066 [trainer.py] => conv_dim: 64
2025-01-04 14:36:22,066 [trainer.py] => img_size: 224
2025-01-04 14:36:22,066 [trainer.py] => generator_lr: 0.001
2025-01-04 14:36:22,066 [trainer.py] => pi: 100
2025-01-04 14:36:22,067 [trainer.py] => w_bn: 50.0
2025-01-04 14:36:22,067 [trainer.py] => w_noise: 0.001
2025-01-04 14:36:22,067 [trainer.py] => server_ss: 32
2025-01-04 14:36:22,067 [trainer.py] => bn_loss: 1
2025-01-04 14:36:22,067 [trainer.py] => noise: 1
2025-01-04 14:36:22,068 [trainer.py] => ie_loss: 1
2025-01-04 14:36:22,068 [trainer.py] => act_loss: 0
2025-01-04 14:36:22,068 [trainer.py] => w_ie: 1.0
2025-01-04 14:36:22,068 [trainer.py] => w_act: 0.1
2025-01-04 14:36:22,069 [trainer.py] => syn_size: 32
2025-01-04 14:36:22,070 [trainer.py] => vpt_type: Deep
2025-01-04 14:36:22,070 [trainer.py] => prompt_token_num: 6
2025-01-04 14:36:22,070 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:36:22,070 [trainer.py] => perturb_var: 1
2025-01-04 14:36:22,071 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:36:22,071 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:36:22,071 [trainer.py] => kl_weight: 0.001
2025-01-04 14:36:22,071 [trainer.py] => TIP_init: zero
2025-01-04 14:36:22,071 [trainer.py] => tuned_epoch: 10
2025-01-04 14:36:22,072 [trainer.py] => fs_epoch: 0
2025-01-04 14:36:22,072 [trainer.py] => init_lr: 0.015
2025-01-04 14:36:22,072 [trainer.py] => fs_lr: 0.001
2025-01-04 14:36:22,072 [trainer.py] => batch_size: 48
2025-01-04 14:36:22,073 [trainer.py] => fs_batch_size: 16
2025-01-04 14:36:22,087 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:36:22,088 [trainer.py] => min_lr: 0
2025-01-04 14:36:22,088 [trainer.py] => optimizer: sgd
2025-01-04 14:36:22,088 [trainer.py] => memory_size: 0
2025-01-04 14:36:22,088 [trainer.py] => memory_per_class: 0
2025-01-04 14:36:22,088 [trainer.py] => fixed_memory: False
2025-01-04 14:36:22,089 [trainer.py] => shuffle: False
2025-01-04 14:36:22,089 [trainer.py] => top_k: 5
2025-01-04 14:36:22,089 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:36:22,089 [trainer.py] => prefix: asp
2025-01-04 14:36:22,089 [trainer.py] => model_prefix: asp
2025-01-04 14:36:23,948 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:36:35,366 [trainer.py] => All params: 173596160
2025-01-04 14:36:35,367 [trainer.py] => Trainable params: 1998848
2025-01-04 14:36:35,772 [asp.py] => Learning on 0-60
2025-01-04 14:36:35,936 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:36:58,403 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:36:58,403 [trainer.py] => model_name: asp
2025-01-04 14:36:58,403 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:36:58,403 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:36:58,403 [trainer.py] => seed: 2024
2025-01-04 14:36:58,403 [trainer.py] => dataset: cifar224
2025-01-04 14:36:58,403 [trainer.py] => init_cls: 60
2025-01-04 14:36:58,403 [trainer.py] => increment: 5
2025-01-04 14:36:58,403 [trainer.py] => kshot: 5
2025-01-04 14:36:58,403 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:36:58,403 [trainer.py] => z_dim: 1000
2025-01-04 14:36:58,403 [trainer.py] => conv_dim: 64
2025-01-04 14:36:58,403 [trainer.py] => img_size: 224
2025-01-04 14:36:58,403 [trainer.py] => generator_lr: 0.001
2025-01-04 14:36:58,403 [trainer.py] => pi: 100
2025-01-04 14:36:58,404 [trainer.py] => w_bn: 50.0
2025-01-04 14:36:58,404 [trainer.py] => w_noise: 0.001
2025-01-04 14:36:58,404 [trainer.py] => server_ss: 32
2025-01-04 14:36:58,404 [trainer.py] => bn_loss: 1
2025-01-04 14:36:58,404 [trainer.py] => noise: 1
2025-01-04 14:36:58,404 [trainer.py] => ie_loss: 1
2025-01-04 14:36:58,404 [trainer.py] => act_loss: 0
2025-01-04 14:36:58,404 [trainer.py] => w_ie: 1.0
2025-01-04 14:36:58,404 [trainer.py] => w_act: 0.1
2025-01-04 14:36:58,404 [trainer.py] => syn_size: 32
2025-01-04 14:36:58,404 [trainer.py] => vpt_type: Deep
2025-01-04 14:36:58,404 [trainer.py] => prompt_token_num: 6
2025-01-04 14:36:58,404 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:36:58,404 [trainer.py] => perturb_var: 1
2025-01-04 14:36:58,404 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:36:58,404 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:36:58,404 [trainer.py] => kl_weight: 0.001
2025-01-04 14:36:58,404 [trainer.py] => TIP_init: zero
2025-01-04 14:36:58,404 [trainer.py] => tuned_epoch: 10
2025-01-04 14:36:58,404 [trainer.py] => fs_epoch: 0
2025-01-04 14:36:58,404 [trainer.py] => init_lr: 0.015
2025-01-04 14:36:58,404 [trainer.py] => fs_lr: 0.001
2025-01-04 14:36:58,404 [trainer.py] => batch_size: 48
2025-01-04 14:36:58,404 [trainer.py] => fs_batch_size: 16
2025-01-04 14:36:58,405 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:36:58,405 [trainer.py] => min_lr: 0
2025-01-04 14:36:58,405 [trainer.py] => optimizer: sgd
2025-01-04 14:36:58,405 [trainer.py] => memory_size: 0
2025-01-04 14:36:58,405 [trainer.py] => memory_per_class: 0
2025-01-04 14:36:58,405 [trainer.py] => fixed_memory: False
2025-01-04 14:36:58,405 [trainer.py] => shuffle: False
2025-01-04 14:36:58,405 [trainer.py] => top_k: 5
2025-01-04 14:36:58,405 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:36:58,405 [trainer.py] => prefix: asp
2025-01-04 14:36:58,405 [trainer.py] => model_prefix: asp
2025-01-04 14:37:00,340 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:37:12,105 [trainer.py] => All params: 173596160
2025-01-04 14:37:12,106 [trainer.py] => Trainable params: 1998848
2025-01-04 14:37:12,514 [asp.py] => Learning on 0-60
2025-01-04 14:37:12,718 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:37:55,923 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:37:55,924 [trainer.py] => model_name: asp
2025-01-04 14:37:55,925 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:37:55,925 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:37:55,925 [trainer.py] => seed: 2024
2025-01-04 14:37:55,926 [trainer.py] => dataset: cifar224
2025-01-04 14:37:55,926 [trainer.py] => init_cls: 60
2025-01-04 14:37:55,926 [trainer.py] => increment: 5
2025-01-04 14:37:55,926 [trainer.py] => kshot: 5
2025-01-04 14:37:55,927 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:37:55,927 [trainer.py] => z_dim: 1000
2025-01-04 14:37:55,927 [trainer.py] => conv_dim: 64
2025-01-04 14:37:55,928 [trainer.py] => img_size: 224
2025-01-04 14:37:55,928 [trainer.py] => generator_lr: 0.001
2025-01-04 14:37:55,928 [trainer.py] => pi: 100
2025-01-04 14:37:55,929 [trainer.py] => w_bn: 50.0
2025-01-04 14:37:55,930 [trainer.py] => w_noise: 0.001
2025-01-04 14:37:55,930 [trainer.py] => server_ss: 32
2025-01-04 14:37:55,930 [trainer.py] => bn_loss: 1
2025-01-04 14:37:55,931 [trainer.py] => noise: 1
2025-01-04 14:37:55,931 [trainer.py] => ie_loss: 1
2025-01-04 14:37:55,931 [trainer.py] => act_loss: 0
2025-01-04 14:37:55,931 [trainer.py] => w_ie: 1.0
2025-01-04 14:37:55,932 [trainer.py] => w_act: 0.1
2025-01-04 14:37:55,932 [trainer.py] => syn_size: 32
2025-01-04 14:37:55,932 [trainer.py] => vpt_type: Deep
2025-01-04 14:37:55,933 [trainer.py] => prompt_token_num: 6
2025-01-04 14:37:55,933 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:37:55,933 [trainer.py] => perturb_var: 1
2025-01-04 14:37:55,934 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:37:55,934 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:37:55,935 [trainer.py] => kl_weight: 0.001
2025-01-04 14:37:55,935 [trainer.py] => TIP_init: zero
2025-01-04 14:37:55,935 [trainer.py] => tuned_epoch: 10
2025-01-04 14:37:55,935 [trainer.py] => fs_epoch: 0
2025-01-04 14:37:55,935 [trainer.py] => init_lr: 0.015
2025-01-04 14:37:55,935 [trainer.py] => fs_lr: 0.001
2025-01-04 14:37:55,935 [trainer.py] => batch_size: 48
2025-01-04 14:37:55,935 [trainer.py] => fs_batch_size: 16
2025-01-04 14:37:55,935 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:37:55,935 [trainer.py] => min_lr: 0
2025-01-04 14:37:55,935 [trainer.py] => optimizer: sgd
2025-01-04 14:37:55,935 [trainer.py] => memory_size: 0
2025-01-04 14:37:55,935 [trainer.py] => memory_per_class: 0
2025-01-04 14:37:55,936 [trainer.py] => fixed_memory: False
2025-01-04 14:37:55,936 [trainer.py] => shuffle: False
2025-01-04 14:37:55,936 [trainer.py] => top_k: 5
2025-01-04 14:37:55,936 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:37:55,936 [trainer.py] => prefix: asp
2025-01-04 14:37:55,936 [trainer.py] => model_prefix: asp
2025-01-04 14:37:57,791 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:38:09,266 [trainer.py] => All params: 173596160
2025-01-04 14:38:09,267 [trainer.py] => Trainable params: 1998848
2025-01-04 14:38:09,666 [asp.py] => Learning on 0-60
2025-01-04 14:38:09,817 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:39:04,557 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:39:04,557 [trainer.py] => model_name: asp
2025-01-04 14:39:04,557 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:39:04,557 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:39:04,558 [trainer.py] => seed: 2024
2025-01-04 14:39:04,558 [trainer.py] => dataset: cifar224
2025-01-04 14:39:04,558 [trainer.py] => init_cls: 60
2025-01-04 14:39:04,558 [trainer.py] => increment: 5
2025-01-04 14:39:04,558 [trainer.py] => kshot: 5
2025-01-04 14:39:04,558 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:39:04,558 [trainer.py] => z_dim: 1000
2025-01-04 14:39:04,558 [trainer.py] => conv_dim: 64
2025-01-04 14:39:04,558 [trainer.py] => img_size: 224
2025-01-04 14:39:04,558 [trainer.py] => generator_lr: 0.001
2025-01-04 14:39:04,558 [trainer.py] => pi: 100
2025-01-04 14:39:04,558 [trainer.py] => w_bn: 50.0
2025-01-04 14:39:04,558 [trainer.py] => w_noise: 0.001
2025-01-04 14:39:04,558 [trainer.py] => server_ss: 32
2025-01-04 14:39:04,558 [trainer.py] => bn_loss: 1
2025-01-04 14:39:04,558 [trainer.py] => noise: 1
2025-01-04 14:39:04,558 [trainer.py] => ie_loss: 1
2025-01-04 14:39:04,558 [trainer.py] => act_loss: 0
2025-01-04 14:39:04,558 [trainer.py] => w_ie: 1.0
2025-01-04 14:39:04,558 [trainer.py] => w_act: 0.1
2025-01-04 14:39:04,558 [trainer.py] => syn_size: 32
2025-01-04 14:39:04,558 [trainer.py] => vpt_type: Deep
2025-01-04 14:39:04,558 [trainer.py] => prompt_token_num: 6
2025-01-04 14:39:04,558 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:39:04,558 [trainer.py] => perturb_var: 1
2025-01-04 14:39:04,558 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:39:04,558 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:39:04,559 [trainer.py] => kl_weight: 0.001
2025-01-04 14:39:04,559 [trainer.py] => TIP_init: zero
2025-01-04 14:39:04,559 [trainer.py] => tuned_epoch: 10
2025-01-04 14:39:04,559 [trainer.py] => fs_epoch: 0
2025-01-04 14:39:04,559 [trainer.py] => init_lr: 0.015
2025-01-04 14:39:04,559 [trainer.py] => fs_lr: 0.001
2025-01-04 14:39:04,559 [trainer.py] => batch_size: 48
2025-01-04 14:39:04,559 [trainer.py] => fs_batch_size: 16
2025-01-04 14:39:04,559 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:39:04,559 [trainer.py] => min_lr: 0
2025-01-04 14:39:04,559 [trainer.py] => optimizer: sgd
2025-01-04 14:39:04,559 [trainer.py] => memory_size: 0
2025-01-04 14:39:04,559 [trainer.py] => memory_per_class: 0
2025-01-04 14:39:04,559 [trainer.py] => fixed_memory: False
2025-01-04 14:39:04,559 [trainer.py] => shuffle: False
2025-01-04 14:39:04,559 [trainer.py] => top_k: 5
2025-01-04 14:39:04,559 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:39:04,559 [trainer.py] => prefix: asp
2025-01-04 14:39:04,559 [trainer.py] => model_prefix: asp
2025-01-04 14:39:06,227 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:39:17,001 [trainer.py] => All params: 173596160
2025-01-04 14:39:17,002 [trainer.py] => Trainable params: 1998848
2025-01-04 14:39:17,461 [asp.py] => Learning on 0-60
2025-01-04 14:39:17,703 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:39:31,124 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:39:31,124 [trainer.py] => model_name: asp
2025-01-04 14:39:31,124 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:39:31,124 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:39:31,124 [trainer.py] => seed: 2024
2025-01-04 14:39:31,125 [trainer.py] => dataset: cifar224
2025-01-04 14:39:31,125 [trainer.py] => init_cls: 60
2025-01-04 14:39:31,125 [trainer.py] => increment: 5
2025-01-04 14:39:31,125 [trainer.py] => kshot: 5
2025-01-04 14:39:31,125 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:39:31,125 [trainer.py] => z_dim: 1000
2025-01-04 14:39:31,125 [trainer.py] => conv_dim: 64
2025-01-04 14:39:31,126 [trainer.py] => img_size: 224
2025-01-04 14:39:31,126 [trainer.py] => generator_lr: 0.001
2025-01-04 14:39:31,126 [trainer.py] => pi: 100
2025-01-04 14:39:31,126 [trainer.py] => w_bn: 50.0
2025-01-04 14:39:31,126 [trainer.py] => w_noise: 0.001
2025-01-04 14:39:31,126 [trainer.py] => server_ss: 32
2025-01-04 14:39:31,126 [trainer.py] => bn_loss: 1
2025-01-04 14:39:31,126 [trainer.py] => noise: 1
2025-01-04 14:39:31,126 [trainer.py] => ie_loss: 1
2025-01-04 14:39:31,126 [trainer.py] => act_loss: 0
2025-01-04 14:39:31,126 [trainer.py] => w_ie: 1.0
2025-01-04 14:39:31,126 [trainer.py] => w_act: 0.1
2025-01-04 14:39:31,126 [trainer.py] => syn_size: 32
2025-01-04 14:39:31,126 [trainer.py] => vpt_type: Deep
2025-01-04 14:39:31,127 [trainer.py] => prompt_token_num: 6
2025-01-04 14:39:31,127 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:39:31,127 [trainer.py] => perturb_var: 1
2025-01-04 14:39:31,127 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:39:31,127 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:39:31,127 [trainer.py] => kl_weight: 0.001
2025-01-04 14:39:31,127 [trainer.py] => TIP_init: zero
2025-01-04 14:39:31,127 [trainer.py] => tuned_epoch: 10
2025-01-04 14:39:31,127 [trainer.py] => fs_epoch: 0
2025-01-04 14:39:31,127 [trainer.py] => init_lr: 0.015
2025-01-04 14:39:31,127 [trainer.py] => fs_lr: 0.001
2025-01-04 14:39:31,127 [trainer.py] => batch_size: 48
2025-01-04 14:39:31,127 [trainer.py] => fs_batch_size: 16
2025-01-04 14:39:31,127 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:39:31,128 [trainer.py] => min_lr: 0
2025-01-04 14:39:31,128 [trainer.py] => optimizer: sgd
2025-01-04 14:39:31,128 [trainer.py] => memory_size: 0
2025-01-04 14:39:31,128 [trainer.py] => memory_per_class: 0
2025-01-04 14:39:31,128 [trainer.py] => fixed_memory: False
2025-01-04 14:39:31,128 [trainer.py] => shuffle: False
2025-01-04 14:39:31,128 [trainer.py] => top_k: 5
2025-01-04 14:39:31,128 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:39:31,128 [trainer.py] => prefix: asp
2025-01-04 14:39:31,128 [trainer.py] => model_prefix: asp
2025-01-04 14:39:32,959 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:39:44,752 [trainer.py] => All params: 173596160
2025-01-04 14:39:44,753 [trainer.py] => Trainable params: 1998848
2025-01-04 14:39:45,281 [asp.py] => Learning on 0-60
2025-01-04 14:39:45,639 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:40:06,266 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:40:06,267 [trainer.py] => model_name: asp
2025-01-04 14:40:06,267 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:40:06,267 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:40:06,267 [trainer.py] => seed: 2024
2025-01-04 14:40:06,267 [trainer.py] => dataset: cifar224
2025-01-04 14:40:06,267 [trainer.py] => init_cls: 60
2025-01-04 14:40:06,267 [trainer.py] => increment: 5
2025-01-04 14:40:06,267 [trainer.py] => kshot: 5
2025-01-04 14:40:06,267 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:40:06,267 [trainer.py] => z_dim: 1000
2025-01-04 14:40:06,267 [trainer.py] => conv_dim: 64
2025-01-04 14:40:06,267 [trainer.py] => img_size: 224
2025-01-04 14:40:06,267 [trainer.py] => generator_lr: 0.001
2025-01-04 14:40:06,267 [trainer.py] => pi: 100
2025-01-04 14:40:06,267 [trainer.py] => w_bn: 50.0
2025-01-04 14:40:06,267 [trainer.py] => w_noise: 0.001
2025-01-04 14:40:06,267 [trainer.py] => server_ss: 32
2025-01-04 14:40:06,267 [trainer.py] => bn_loss: 1
2025-01-04 14:40:06,267 [trainer.py] => noise: 1
2025-01-04 14:40:06,267 [trainer.py] => ie_loss: 1
2025-01-04 14:40:06,267 [trainer.py] => act_loss: 0
2025-01-04 14:40:06,267 [trainer.py] => w_ie: 1.0
2025-01-04 14:40:06,267 [trainer.py] => w_act: 0.1
2025-01-04 14:40:06,267 [trainer.py] => syn_size: 32
2025-01-04 14:40:06,268 [trainer.py] => vpt_type: Deep
2025-01-04 14:40:06,268 [trainer.py] => prompt_token_num: 6
2025-01-04 14:40:06,268 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:40:06,268 [trainer.py] => perturb_var: 1
2025-01-04 14:40:06,268 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:40:06,268 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:40:06,268 [trainer.py] => kl_weight: 0.001
2025-01-04 14:40:06,268 [trainer.py] => TIP_init: zero
2025-01-04 14:40:06,268 [trainer.py] => tuned_epoch: 10
2025-01-04 14:40:06,268 [trainer.py] => fs_epoch: 0
2025-01-04 14:40:06,268 [trainer.py] => init_lr: 0.015
2025-01-04 14:40:06,268 [trainer.py] => fs_lr: 0.001
2025-01-04 14:40:06,268 [trainer.py] => batch_size: 48
2025-01-04 14:40:06,268 [trainer.py] => fs_batch_size: 16
2025-01-04 14:40:06,268 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:40:06,268 [trainer.py] => min_lr: 0
2025-01-04 14:40:06,268 [trainer.py] => optimizer: sgd
2025-01-04 14:40:06,268 [trainer.py] => memory_size: 0
2025-01-04 14:40:06,268 [trainer.py] => memory_per_class: 0
2025-01-04 14:40:06,268 [trainer.py] => fixed_memory: False
2025-01-04 14:40:06,268 [trainer.py] => shuffle: False
2025-01-04 14:40:06,268 [trainer.py] => top_k: 5
2025-01-04 14:40:06,268 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:40:06,268 [trainer.py] => prefix: asp
2025-01-04 14:40:06,268 [trainer.py] => model_prefix: asp
2025-01-04 14:40:08,108 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:40:17,694 [trainer.py] => All params: 173596160
2025-01-04 14:40:17,695 [trainer.py] => Trainable params: 1998848
2025-01-04 14:40:18,071 [asp.py] => Learning on 0-60
2025-01-04 14:40:18,226 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:40:56,840 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:40:56,840 [trainer.py] => model_name: asp
2025-01-04 14:40:56,840 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:40:56,840 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:40:56,840 [trainer.py] => seed: 2024
2025-01-04 14:40:56,840 [trainer.py] => dataset: cifar224
2025-01-04 14:40:56,840 [trainer.py] => init_cls: 60
2025-01-04 14:40:56,840 [trainer.py] => increment: 5
2025-01-04 14:40:56,840 [trainer.py] => kshot: 5
2025-01-04 14:40:56,840 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:40:56,840 [trainer.py] => z_dim: 1000
2025-01-04 14:40:56,840 [trainer.py] => conv_dim: 64
2025-01-04 14:40:56,841 [trainer.py] => img_size: 224
2025-01-04 14:40:56,841 [trainer.py] => generator_lr: 0.001
2025-01-04 14:40:56,841 [trainer.py] => pi: 100
2025-01-04 14:40:56,841 [trainer.py] => w_bn: 50.0
2025-01-04 14:40:56,841 [trainer.py] => w_noise: 0.001
2025-01-04 14:40:56,841 [trainer.py] => server_ss: 32
2025-01-04 14:40:56,841 [trainer.py] => bn_loss: 1
2025-01-04 14:40:56,841 [trainer.py] => noise: 1
2025-01-04 14:40:56,841 [trainer.py] => ie_loss: 1
2025-01-04 14:40:56,841 [trainer.py] => act_loss: 0
2025-01-04 14:40:56,841 [trainer.py] => w_ie: 1.0
2025-01-04 14:40:56,841 [trainer.py] => w_act: 0.1
2025-01-04 14:40:56,841 [trainer.py] => syn_size: 32
2025-01-04 14:40:56,841 [trainer.py] => vpt_type: Deep
2025-01-04 14:40:56,841 [trainer.py] => prompt_token_num: 6
2025-01-04 14:40:56,841 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:40:56,841 [trainer.py] => perturb_var: 1
2025-01-04 14:40:56,841 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:40:56,841 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:40:56,841 [trainer.py] => kl_weight: 0.001
2025-01-04 14:40:56,841 [trainer.py] => TIP_init: zero
2025-01-04 14:40:56,841 [trainer.py] => tuned_epoch: 10
2025-01-04 14:40:56,841 [trainer.py] => fs_epoch: 0
2025-01-04 14:40:56,841 [trainer.py] => init_lr: 0.015
2025-01-04 14:40:56,841 [trainer.py] => fs_lr: 0.001
2025-01-04 14:40:56,841 [trainer.py] => batch_size: 48
2025-01-04 14:40:56,842 [trainer.py] => fs_batch_size: 16
2025-01-04 14:40:56,842 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:40:56,842 [trainer.py] => min_lr: 0
2025-01-04 14:40:56,842 [trainer.py] => optimizer: sgd
2025-01-04 14:40:56,842 [trainer.py] => memory_size: 0
2025-01-04 14:40:56,842 [trainer.py] => memory_per_class: 0
2025-01-04 14:40:56,842 [trainer.py] => fixed_memory: False
2025-01-04 14:40:56,842 [trainer.py] => shuffle: False
2025-01-04 14:40:56,842 [trainer.py] => top_k: 5
2025-01-04 14:40:56,842 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:40:56,842 [trainer.py] => prefix: asp
2025-01-04 14:40:56,842 [trainer.py] => model_prefix: asp
2025-01-04 14:40:58,576 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:41:09,673 [trainer.py] => All params: 173596160
2025-01-04 14:41:09,674 [trainer.py] => Trainable params: 1998848
2025-01-04 14:41:10,145 [asp.py] => Learning on 0-60
2025-01-04 14:41:10,390 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:41:55,591 [asp.py] => total parameters: 173642241
2025-01-04 14:41:55,592 [asp.py] => trainable parameters: 2044929
2025-01-04 14:43:30,264 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:43:30,264 [trainer.py] => model_name: asp
2025-01-04 14:43:30,265 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:43:30,265 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:43:30,265 [trainer.py] => seed: 2024
2025-01-04 14:43:30,266 [trainer.py] => dataset: cifar224
2025-01-04 14:43:30,266 [trainer.py] => init_cls: 60
2025-01-04 14:43:30,266 [trainer.py] => increment: 5
2025-01-04 14:43:30,266 [trainer.py] => kshot: 5
2025-01-04 14:43:30,267 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:43:30,267 [trainer.py] => z_dim: 1000
2025-01-04 14:43:30,267 [trainer.py] => conv_dim: 64
2025-01-04 14:43:30,267 [trainer.py] => img_size: 224
2025-01-04 14:43:30,268 [trainer.py] => generator_lr: 0.005
2025-01-04 14:43:30,268 [trainer.py] => pi: 100
2025-01-04 14:43:30,268 [trainer.py] => w_bn: 50.0
2025-01-04 14:43:30,268 [trainer.py] => w_noise: 0.001
2025-01-04 14:43:30,268 [trainer.py] => server_ss: 32
2025-01-04 14:43:30,269 [trainer.py] => bn_loss: 1
2025-01-04 14:43:30,269 [trainer.py] => noise: 1
2025-01-04 14:43:30,269 [trainer.py] => ie_loss: 1
2025-01-04 14:43:30,269 [trainer.py] => act_loss: 0
2025-01-04 14:43:30,269 [trainer.py] => w_ie: 1.0
2025-01-04 14:43:30,270 [trainer.py] => w_act: 0.1
2025-01-04 14:43:30,270 [trainer.py] => syn_size: 32
2025-01-04 14:43:30,270 [trainer.py] => vpt_type: Deep
2025-01-04 14:43:30,270 [trainer.py] => prompt_token_num: 6
2025-01-04 14:43:30,270 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:43:30,270 [trainer.py] => perturb_var: 1
2025-01-04 14:43:30,271 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:43:30,271 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:43:30,271 [trainer.py] => kl_weight: 0.001
2025-01-04 14:43:30,271 [trainer.py] => TIP_init: zero
2025-01-04 14:43:30,271 [trainer.py] => tuned_epoch: 10
2025-01-04 14:43:30,272 [trainer.py] => fs_epoch: 0
2025-01-04 14:43:30,272 [trainer.py] => init_lr: 0.015
2025-01-04 14:43:30,272 [trainer.py] => fs_lr: 0.001
2025-01-04 14:43:30,272 [trainer.py] => batch_size: 48
2025-01-04 14:43:30,273 [trainer.py] => fs_batch_size: 16
2025-01-04 14:43:30,273 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:43:30,273 [trainer.py] => min_lr: 0
2025-01-04 14:43:30,273 [trainer.py] => optimizer: sgd
2025-01-04 14:43:30,274 [trainer.py] => memory_size: 0
2025-01-04 14:43:30,274 [trainer.py] => memory_per_class: 0
2025-01-04 14:43:30,274 [trainer.py] => fixed_memory: False
2025-01-04 14:43:30,274 [trainer.py] => shuffle: False
2025-01-04 14:43:30,274 [trainer.py] => top_k: 5
2025-01-04 14:43:30,275 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:43:30,275 [trainer.py] => prefix: asp
2025-01-04 14:43:30,275 [trainer.py] => model_prefix: asp
2025-01-04 14:43:32,047 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:43:54,166 [trainer.py] => All params: 173596160
2025-01-04 14:43:54,167 [trainer.py] => Trainable params: 1998848
2025-01-04 14:43:54,648 [asp.py] => Learning on 0-60
2025-01-04 14:43:54,745 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:44:50,727 [asp.py] => total parameters: 173642241
2025-01-04 14:44:50,728 [asp.py] => trainable parameters: 2044929
2025-01-04 14:45:57,761 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:45:57,761 [trainer.py] => model_name: asp
2025-01-04 14:45:57,761 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:45:57,761 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:45:57,761 [trainer.py] => seed: 2024
2025-01-04 14:45:57,761 [trainer.py] => dataset: cifar224
2025-01-04 14:45:57,761 [trainer.py] => init_cls: 60
2025-01-04 14:45:57,761 [trainer.py] => increment: 5
2025-01-04 14:45:57,761 [trainer.py] => kshot: 5
2025-01-04 14:45:57,762 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:45:57,762 [trainer.py] => z_dim: 1000
2025-01-04 14:45:57,762 [trainer.py] => conv_dim: 64
2025-01-04 14:45:57,762 [trainer.py] => img_size: 224
2025-01-04 14:45:57,762 [trainer.py] => generator_lr: 0.0005
2025-01-04 14:45:57,762 [trainer.py] => pi: 100
2025-01-04 14:45:57,762 [trainer.py] => w_bn: 50.0
2025-01-04 14:45:57,762 [trainer.py] => w_noise: 0.001
2025-01-04 14:45:57,762 [trainer.py] => server_ss: 32
2025-01-04 14:45:57,762 [trainer.py] => bn_loss: 1
2025-01-04 14:45:57,762 [trainer.py] => noise: 1
2025-01-04 14:45:57,762 [trainer.py] => ie_loss: 1
2025-01-04 14:45:57,762 [trainer.py] => act_loss: 0
2025-01-04 14:45:57,762 [trainer.py] => w_ie: 1.0
2025-01-04 14:45:57,762 [trainer.py] => w_act: 0.1
2025-01-04 14:45:57,762 [trainer.py] => syn_size: 32
2025-01-04 14:45:57,762 [trainer.py] => vpt_type: Deep
2025-01-04 14:45:57,762 [trainer.py] => prompt_token_num: 6
2025-01-04 14:45:57,762 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:45:57,762 [trainer.py] => perturb_var: 1
2025-01-04 14:45:57,762 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:45:57,762 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:45:57,762 [trainer.py] => kl_weight: 0.001
2025-01-04 14:45:57,762 [trainer.py] => TIP_init: zero
2025-01-04 14:45:57,762 [trainer.py] => tuned_epoch: 10
2025-01-04 14:45:57,762 [trainer.py] => fs_epoch: 0
2025-01-04 14:45:57,763 [trainer.py] => init_lr: 0.015
2025-01-04 14:45:57,763 [trainer.py] => fs_lr: 0.001
2025-01-04 14:45:57,763 [trainer.py] => batch_size: 48
2025-01-04 14:45:57,763 [trainer.py] => fs_batch_size: 16
2025-01-04 14:45:57,763 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:45:57,763 [trainer.py] => min_lr: 0
2025-01-04 14:45:57,763 [trainer.py] => optimizer: sgd
2025-01-04 14:45:57,763 [trainer.py] => memory_size: 0
2025-01-04 14:45:57,763 [trainer.py] => memory_per_class: 0
2025-01-04 14:45:57,763 [trainer.py] => fixed_memory: False
2025-01-04 14:45:57,763 [trainer.py] => shuffle: False
2025-01-04 14:45:57,763 [trainer.py] => top_k: 5
2025-01-04 14:45:57,763 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:45:57,763 [trainer.py] => prefix: asp
2025-01-04 14:45:57,763 [trainer.py] => model_prefix: asp
2025-01-04 14:45:59,759 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:46:02,658 [asp.py] => Task 0, Epoch 8 => Loss 0.771, Train_accy 81.60, Test_curr_accy 92.58, Test_accy 92.58
2025-01-04 14:46:15,207 [trainer.py] => All params: 173596160
2025-01-04 14:46:15,208 [trainer.py] => Trainable params: 1998848
2025-01-04 14:46:15,527 [asp.py] => Learning on 0-60
2025-01-04 14:46:15,704 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:47:02,787 [asp.py] => total parameters: 173642241
2025-01-04 14:47:02,788 [asp.py] => trainable parameters: 2044929
2025-01-04 14:47:20,601 [asp.py] => Task 0, Epoch 8 => Loss 1.938, Train_accy 60.62, Test_curr_accy 62.97, Test_accy 62.97
2025-01-04 14:48:48,611 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:48:48,611 [trainer.py] => model_name: asp
2025-01-04 14:48:48,611 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:48:48,611 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:48:48,611 [trainer.py] => seed: 2024
2025-01-04 14:48:48,611 [trainer.py] => dataset: cifar224
2025-01-04 14:48:48,611 [trainer.py] => init_cls: 60
2025-01-04 14:48:48,611 [trainer.py] => increment: 5
2025-01-04 14:48:48,611 [trainer.py] => kshot: 5
2025-01-04 14:48:48,611 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:48:48,611 [trainer.py] => z_dim: 1000
2025-01-04 14:48:48,611 [trainer.py] => conv_dim: 64
2025-01-04 14:48:48,611 [trainer.py] => img_size: 224
2025-01-04 14:48:48,611 [trainer.py] => generator_lr: 0.001
2025-01-04 14:48:48,611 [trainer.py] => pi: 100
2025-01-04 14:48:48,611 [trainer.py] => w_bn: 50.0
2025-01-04 14:48:48,611 [trainer.py] => w_noise: 0.001
2025-01-04 14:48:48,611 [trainer.py] => server_ss: 32
2025-01-04 14:48:48,612 [trainer.py] => bn_loss: 1
2025-01-04 14:48:48,612 [trainer.py] => noise: 1
2025-01-04 14:48:48,612 [trainer.py] => ie_loss: 1
2025-01-04 14:48:48,612 [trainer.py] => act_loss: 0
2025-01-04 14:48:48,612 [trainer.py] => w_ie: 1.0
2025-01-04 14:48:48,612 [trainer.py] => w_act: 0.1
2025-01-04 14:48:48,612 [trainer.py] => syn_size: 32
2025-01-04 14:48:48,612 [trainer.py] => vpt_type: Deep
2025-01-04 14:48:48,612 [trainer.py] => prompt_token_num: 6
2025-01-04 14:48:48,612 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:48:48,612 [trainer.py] => perturb_var: 1
2025-01-04 14:48:48,612 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:48:48,612 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:48:48,612 [trainer.py] => kl_weight: 0.001
2025-01-04 14:48:48,612 [trainer.py] => TIP_init: zero
2025-01-04 14:48:48,612 [trainer.py] => tuned_epoch: 10
2025-01-04 14:48:48,612 [trainer.py] => fs_epoch: 0
2025-01-04 14:48:48,612 [trainer.py] => init_lr: 0.007
2025-01-04 14:48:48,612 [trainer.py] => fs_lr: 0.001
2025-01-04 14:48:48,612 [trainer.py] => batch_size: 48
2025-01-04 14:48:48,612 [trainer.py] => fs_batch_size: 16
2025-01-04 14:48:48,612 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:48:48,612 [trainer.py] => min_lr: 0
2025-01-04 14:48:48,612 [trainer.py] => optimizer: sgd
2025-01-04 14:48:48,612 [trainer.py] => memory_size: 0
2025-01-04 14:48:48,612 [trainer.py] => memory_per_class: 0
2025-01-04 14:48:48,612 [trainer.py] => fixed_memory: False
2025-01-04 14:48:48,612 [trainer.py] => shuffle: False
2025-01-04 14:48:48,612 [trainer.py] => top_k: 5
2025-01-04 14:48:48,612 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:48:48,612 [trainer.py] => prefix: asp
2025-01-04 14:48:48,612 [trainer.py] => model_prefix: asp
2025-01-04 14:48:50,400 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:48:59,291 [trainer.py] => All params: 173596160
2025-01-04 14:48:59,292 [trainer.py] => Trainable params: 1998848
2025-01-04 14:48:59,615 [asp.py] => Learning on 0-60
2025-01-04 14:48:59,774 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:49:17,168 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:49:17,168 [trainer.py] => model_name: asp
2025-01-04 14:49:17,168 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:49:17,168 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:49:17,168 [trainer.py] => seed: 2024
2025-01-04 14:49:17,168 [trainer.py] => dataset: cifar224
2025-01-04 14:49:17,168 [trainer.py] => init_cls: 60
2025-01-04 14:49:17,168 [trainer.py] => increment: 5
2025-01-04 14:49:17,168 [trainer.py] => kshot: 5
2025-01-04 14:49:17,169 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:49:17,169 [trainer.py] => z_dim: 1000
2025-01-04 14:49:17,169 [trainer.py] => conv_dim: 64
2025-01-04 14:49:17,169 [trainer.py] => img_size: 224
2025-01-04 14:49:17,169 [trainer.py] => generator_lr: 0.005
2025-01-04 14:49:17,169 [trainer.py] => pi: 100
2025-01-04 14:49:17,169 [trainer.py] => w_bn: 50.0
2025-01-04 14:49:17,169 [trainer.py] => w_noise: 0.001
2025-01-04 14:49:17,169 [trainer.py] => server_ss: 32
2025-01-04 14:49:17,169 [trainer.py] => bn_loss: 1
2025-01-04 14:49:17,169 [trainer.py] => noise: 1
2025-01-04 14:49:17,169 [trainer.py] => ie_loss: 1
2025-01-04 14:49:17,169 [trainer.py] => act_loss: 0
2025-01-04 14:49:17,169 [trainer.py] => w_ie: 1.0
2025-01-04 14:49:17,169 [trainer.py] => w_act: 0.1
2025-01-04 14:49:17,169 [trainer.py] => syn_size: 32
2025-01-04 14:49:17,169 [trainer.py] => vpt_type: Deep
2025-01-04 14:49:17,169 [trainer.py] => prompt_token_num: 6
2025-01-04 14:49:17,169 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:49:17,169 [trainer.py] => perturb_var: 1
2025-01-04 14:49:17,169 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:49:17,169 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:49:17,169 [trainer.py] => kl_weight: 0.001
2025-01-04 14:49:17,169 [trainer.py] => TIP_init: zero
2025-01-04 14:49:17,169 [trainer.py] => tuned_epoch: 10
2025-01-04 14:49:17,169 [trainer.py] => fs_epoch: 0
2025-01-04 14:49:17,169 [trainer.py] => init_lr: 0.007
2025-01-04 14:49:17,169 [trainer.py] => fs_lr: 0.001
2025-01-04 14:49:17,169 [trainer.py] => batch_size: 48
2025-01-04 14:49:17,169 [trainer.py] => fs_batch_size: 16
2025-01-04 14:49:17,169 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:49:17,170 [trainer.py] => min_lr: 0
2025-01-04 14:49:17,170 [trainer.py] => optimizer: sgd
2025-01-04 14:49:17,170 [trainer.py] => memory_size: 0
2025-01-04 14:49:17,170 [trainer.py] => memory_per_class: 0
2025-01-04 14:49:17,170 [trainer.py] => fixed_memory: False
2025-01-04 14:49:17,170 [trainer.py] => shuffle: False
2025-01-04 14:49:17,170 [trainer.py] => top_k: 5
2025-01-04 14:49:17,170 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:49:17,170 [trainer.py] => prefix: asp
2025-01-04 14:49:17,170 [trainer.py] => model_prefix: asp
2025-01-04 14:49:18,759 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:49:35,719 [trainer.py] => All params: 173596160
2025-01-04 14:49:35,721 [trainer.py] => Trainable params: 1998848
2025-01-04 14:49:36,261 [asp.py] => Learning on 0-60
2025-01-04 14:49:36,607 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:49:53,735 [asp.py] => total parameters: 173642241
2025-01-04 14:49:53,738 [asp.py] => trainable parameters: 2044929
2025-01-04 14:51:17,245 [asp.py] => total parameters: 173642241
2025-01-04 14:51:17,247 [asp.py] => trainable parameters: 2044929
2025-01-04 14:55:58,957 [trainer.py] => config: ./exps/cifar.json
2025-01-04 14:55:58,958 [trainer.py] => model_name: asp
2025-01-04 14:55:58,958 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 14:55:58,958 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-04 14:55:58,958 [trainer.py] => seed: 2024
2025-01-04 14:55:58,958 [trainer.py] => dataset: cifar224
2025-01-04 14:55:58,958 [trainer.py] => init_cls: 60
2025-01-04 14:55:58,958 [trainer.py] => increment: 5
2025-01-04 14:55:58,958 [trainer.py] => kshot: 5
2025-01-04 14:55:58,958 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 14:55:58,958 [trainer.py] => z_dim: 1000
2025-01-04 14:55:58,958 [trainer.py] => conv_dim: 64
2025-01-04 14:55:58,958 [trainer.py] => img_size: 224
2025-01-04 14:55:58,958 [trainer.py] => generator_lr: 0.005
2025-01-04 14:55:58,958 [trainer.py] => pi: 100
2025-01-04 14:55:58,958 [trainer.py] => w_bn: 50.0
2025-01-04 14:55:58,958 [trainer.py] => w_noise: 0.001
2025-01-04 14:55:58,958 [trainer.py] => server_ss: 32
2025-01-04 14:55:58,958 [trainer.py] => bn_loss: 1
2025-01-04 14:55:58,958 [trainer.py] => noise: 1
2025-01-04 14:55:58,958 [trainer.py] => ie_loss: 1
2025-01-04 14:55:58,958 [trainer.py] => act_loss: 0
2025-01-04 14:55:58,959 [trainer.py] => w_ie: 1.0
2025-01-04 14:55:58,959 [trainer.py] => w_act: 0.1
2025-01-04 14:55:58,959 [trainer.py] => syn_size: 32
2025-01-04 14:55:58,959 [trainer.py] => vpt_type: Deep
2025-01-04 14:55:58,959 [trainer.py] => prompt_token_num: 6
2025-01-04 14:55:58,959 [trainer.py] => avg_alpha: 0.8
2025-01-04 14:55:58,959 [trainer.py] => perturb_var: 1
2025-01-04 14:55:58,959 [trainer.py] => EMA_beta: 0.99
2025-01-04 14:55:58,959 [trainer.py] => anchor_lambda: 0.1
2025-01-04 14:55:58,959 [trainer.py] => kl_weight: 0.001
2025-01-04 14:55:58,959 [trainer.py] => TIP_init: zero
2025-01-04 14:55:58,959 [trainer.py] => tuned_epoch: 10
2025-01-04 14:55:58,959 [trainer.py] => fs_epoch: 0
2025-01-04 14:55:58,959 [trainer.py] => init_lr: 0.01
2025-01-04 14:55:58,959 [trainer.py] => fs_lr: 0.001
2025-01-04 14:55:58,959 [trainer.py] => batch_size: 48
2025-01-04 14:55:58,959 [trainer.py] => fs_batch_size: 16
2025-01-04 14:55:58,959 [trainer.py] => weight_decay: 0.0005
2025-01-04 14:55:58,959 [trainer.py] => min_lr: 0
2025-01-04 14:55:58,959 [trainer.py] => optimizer: sgd
2025-01-04 14:55:58,959 [trainer.py] => memory_size: 0
2025-01-04 14:55:58,959 [trainer.py] => memory_per_class: 0
2025-01-04 14:55:58,959 [trainer.py] => fixed_memory: False
2025-01-04 14:55:58,959 [trainer.py] => shuffle: False
2025-01-04 14:55:58,959 [trainer.py] => top_k: 5
2025-01-04 14:55:58,960 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 14:55:58,960 [trainer.py] => prefix: asp
2025-01-04 14:55:58,960 [trainer.py] => model_prefix: asp
2025-01-04 14:56:00,841 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 14:56:19,662 [trainer.py] => All params: 173596160
2025-01-04 14:56:19,664 [trainer.py] => Trainable params: 1998848
2025-01-04 14:56:20,256 [asp.py] => Learning on 0-60
2025-01-04 14:56:20,440 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 14:58:49,351 [asp.py] => total parameters: 173642241
2025-01-04 14:58:49,352 [asp.py] => trainable parameters: 2044929
2025-01-04 15:11:41,851 [asp.py] => Task 0, Epoch 9 => Loss 0.742, Train_accy 82.22, Test_curr_accy 92.83, Test_accy 92.83
2025-01-04 15:13:20,663 [asp.py] => Task 0, Epoch 9 => Loss 1.960, Train_accy 59.99, Test_curr_accy 72.85, Test_accy 72.85
2025-01-04 15:25:16,049 [asp.py] => Task 0, Epoch 1 => Loss 4.282, Train_accy 16.73, Test_curr_accy 75.07, Test_accy 75.07
2025-01-04 15:27:10,034 [asp.py] => Task 0, Epoch 1 => Loss 4.290, Train_accy 17.28, Test_curr_accy 74.88, Test_accy 74.88
2025-01-04 15:47:40,482 [trainer.py] => config: ./exps/cifar.json
2025-01-04 15:47:40,482 [trainer.py] => model_name: asp
2025-01-04 15:47:40,482 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 15:47:40,482 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 15:47:40,482 [trainer.py] => seed: 2024
2025-01-04 15:47:40,482 [trainer.py] => dataset: cifar224
2025-01-04 15:47:40,483 [trainer.py] => init_cls: 60
2025-01-04 15:47:40,483 [trainer.py] => increment: 5
2025-01-04 15:47:40,483 [trainer.py] => kshot: 5
2025-01-04 15:47:40,483 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 15:47:40,483 [trainer.py] => z_dim: 1000
2025-01-04 15:47:40,483 [trainer.py] => conv_dim: 64
2025-01-04 15:47:40,483 [trainer.py] => img_size: 224
2025-01-04 15:47:40,483 [trainer.py] => generator_lr: 0.005
2025-01-04 15:47:40,483 [trainer.py] => pi: 100
2025-01-04 15:47:40,483 [trainer.py] => w_bn: 50.0
2025-01-04 15:47:40,483 [trainer.py] => w_noise: 0.001
2025-01-04 15:47:40,483 [trainer.py] => server_ss: 32
2025-01-04 15:47:40,483 [trainer.py] => bn_loss: 1
2025-01-04 15:47:40,483 [trainer.py] => noise: 1
2025-01-04 15:47:40,483 [trainer.py] => ie_loss: 1
2025-01-04 15:47:40,483 [trainer.py] => act_loss: 0
2025-01-04 15:47:40,483 [trainer.py] => w_ie: 1.0
2025-01-04 15:47:40,483 [trainer.py] => w_act: 0.1
2025-01-04 15:47:40,483 [trainer.py] => syn_size: 32
2025-01-04 15:47:40,483 [trainer.py] => vpt_type: Deep
2025-01-04 15:47:40,483 [trainer.py] => prompt_token_num: 6
2025-01-04 15:47:40,483 [trainer.py] => avg_alpha: 0.8
2025-01-04 15:47:40,483 [trainer.py] => perturb_var: 1
2025-01-04 15:47:40,483 [trainer.py] => EMA_beta: 0.99
2025-01-04 15:47:40,483 [trainer.py] => anchor_lambda: 0.1
2025-01-04 15:47:40,483 [trainer.py] => kl_weight: 0.001
2025-01-04 15:47:40,484 [trainer.py] => TIP_init: zero
2025-01-04 15:47:40,484 [trainer.py] => tuned_epoch: 10
2025-01-04 15:47:40,484 [trainer.py] => fs_epoch: 0
2025-01-04 15:47:40,484 [trainer.py] => init_lr: 0.01
2025-01-04 15:47:40,484 [trainer.py] => fs_lr: 0.001
2025-01-04 15:47:40,484 [trainer.py] => batch_size: 48
2025-01-04 15:47:40,484 [trainer.py] => fs_batch_size: 16
2025-01-04 15:47:40,484 [trainer.py] => weight_decay: 0.0005
2025-01-04 15:47:40,484 [trainer.py] => min_lr: 0
2025-01-04 15:47:40,484 [trainer.py] => optimizer: sgd
2025-01-04 15:47:40,484 [trainer.py] => memory_size: 0
2025-01-04 15:47:40,484 [trainer.py] => memory_per_class: 0
2025-01-04 15:47:40,484 [trainer.py] => fixed_memory: False
2025-01-04 15:47:40,484 [trainer.py] => shuffle: False
2025-01-04 15:47:40,484 [trainer.py] => top_k: 5
2025-01-04 15:47:40,484 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 15:47:40,484 [trainer.py] => prefix: asp
2025-01-04 15:47:40,484 [trainer.py] => model_prefix: asp
2025-01-04 15:47:42,790 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 15:48:10,244 [trainer.py] => All params: 173596160
2025-01-04 15:48:10,246 [trainer.py] => Trainable params: 1998848
2025-01-04 15:48:10,751 [asp.py] => Learning on 0-60
2025-01-04 15:48:10,946 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 15:48:46,296 [trainer.py] => config: ./exps/cifar.json
2025-01-04 15:48:46,296 [trainer.py] => model_name: asp
2025-01-04 15:48:46,296 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 15:48:46,296 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 15:48:46,296 [trainer.py] => seed: 2024
2025-01-04 15:48:46,297 [trainer.py] => dataset: cifar224
2025-01-04 15:48:46,297 [trainer.py] => init_cls: 60
2025-01-04 15:48:46,297 [trainer.py] => increment: 5
2025-01-04 15:48:46,297 [trainer.py] => kshot: 5
2025-01-04 15:48:46,297 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 15:48:46,297 [trainer.py] => z_dim: 1000
2025-01-04 15:48:46,297 [trainer.py] => conv_dim: 64
2025-01-04 15:48:46,297 [trainer.py] => img_size: 224
2025-01-04 15:48:46,297 [trainer.py] => generator_lr: 0.005
2025-01-04 15:48:46,298 [trainer.py] => pi: 100
2025-01-04 15:48:46,298 [trainer.py] => w_bn: 50.0
2025-01-04 15:48:46,298 [trainer.py] => w_noise: 0.001
2025-01-04 15:48:46,298 [trainer.py] => server_ss: 32
2025-01-04 15:48:46,298 [trainer.py] => bn_loss: 1
2025-01-04 15:48:46,298 [trainer.py] => noise: 1
2025-01-04 15:48:46,298 [trainer.py] => ie_loss: 1
2025-01-04 15:48:46,298 [trainer.py] => act_loss: 0
2025-01-04 15:48:46,299 [trainer.py] => w_ie: 1.0
2025-01-04 15:48:46,299 [trainer.py] => w_act: 0.1
2025-01-04 15:48:46,299 [trainer.py] => syn_size: 32
2025-01-04 15:48:46,299 [trainer.py] => vpt_type: Deep
2025-01-04 15:48:46,299 [trainer.py] => prompt_token_num: 6
2025-01-04 15:48:46,299 [trainer.py] => avg_alpha: 0.8
2025-01-04 15:48:46,299 [trainer.py] => perturb_var: 1
2025-01-04 15:48:46,299 [trainer.py] => EMA_beta: 0.99
2025-01-04 15:48:46,300 [trainer.py] => anchor_lambda: 0.1
2025-01-04 15:48:46,300 [trainer.py] => kl_weight: 0.001
2025-01-04 15:48:46,300 [trainer.py] => TIP_init: zero
2025-01-04 15:48:46,300 [trainer.py] => tuned_epoch: 10
2025-01-04 15:48:46,300 [trainer.py] => fs_epoch: 0
2025-01-04 15:48:46,300 [trainer.py] => init_lr: 0.01
2025-01-04 15:48:46,300 [trainer.py] => fs_lr: 0.001
2025-01-04 15:48:46,300 [trainer.py] => batch_size: 48
2025-01-04 15:48:46,300 [trainer.py] => fs_batch_size: 16
2025-01-04 15:48:46,301 [trainer.py] => weight_decay: 0.0005
2025-01-04 15:48:46,301 [trainer.py] => min_lr: 0
2025-01-04 15:48:46,301 [trainer.py] => optimizer: sgd
2025-01-04 15:48:46,301 [trainer.py] => memory_size: 0
2025-01-04 15:48:46,301 [trainer.py] => memory_per_class: 0
2025-01-04 15:48:46,301 [trainer.py] => fixed_memory: False
2025-01-04 15:48:46,301 [trainer.py] => shuffle: False
2025-01-04 15:48:46,301 [trainer.py] => top_k: 5
2025-01-04 15:48:46,302 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 15:48:46,302 [trainer.py] => prefix: asp
2025-01-04 15:48:46,302 [trainer.py] => model_prefix: asp
2025-01-04 15:48:48,515 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 15:49:05,562 [trainer.py] => All params: 173596160
2025-01-04 15:49:05,563 [trainer.py] => Trainable params: 1998848
2025-01-04 15:49:05,963 [asp.py] => Learning on 0-60
2025-01-04 15:49:08,466 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 15:51:51,739 [trainer.py] => config: ./exps/cifar.json
2025-01-04 15:51:51,739 [trainer.py] => model_name: asp
2025-01-04 15:51:51,739 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 15:51:51,739 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 15:51:51,739 [trainer.py] => seed: 2024
2025-01-04 15:51:51,739 [trainer.py] => dataset: cifar224
2025-01-04 15:51:51,739 [trainer.py] => init_cls: 60
2025-01-04 15:51:51,739 [trainer.py] => increment: 5
2025-01-04 15:51:51,739 [trainer.py] => kshot: 5
2025-01-04 15:51:51,739 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 15:51:51,740 [trainer.py] => z_dim: 1000
2025-01-04 15:51:51,740 [trainer.py] => conv_dim: 64
2025-01-04 15:51:51,740 [trainer.py] => img_size: 224
2025-01-04 15:51:51,740 [trainer.py] => generator_lr: 0.005
2025-01-04 15:51:51,740 [trainer.py] => pi: 100
2025-01-04 15:51:51,740 [trainer.py] => w_bn: 50.0
2025-01-04 15:51:51,740 [trainer.py] => w_noise: 0.001
2025-01-04 15:51:51,740 [trainer.py] => server_ss: 32
2025-01-04 15:51:51,740 [trainer.py] => bn_loss: 1
2025-01-04 15:51:51,740 [trainer.py] => noise: 1
2025-01-04 15:51:51,740 [trainer.py] => ie_loss: 1
2025-01-04 15:51:51,740 [trainer.py] => act_loss: 0
2025-01-04 15:51:51,740 [trainer.py] => w_ie: 1.0
2025-01-04 15:51:51,740 [trainer.py] => w_act: 0.1
2025-01-04 15:51:51,740 [trainer.py] => syn_size: 32
2025-01-04 15:51:51,740 [trainer.py] => vpt_type: Deep
2025-01-04 15:51:51,741 [trainer.py] => prompt_token_num: 6
2025-01-04 15:51:51,741 [trainer.py] => avg_alpha: 0.8
2025-01-04 15:51:51,741 [trainer.py] => perturb_var: 1
2025-01-04 15:51:51,741 [trainer.py] => EMA_beta: 0.99
2025-01-04 15:51:51,741 [trainer.py] => anchor_lambda: 0.1
2025-01-04 15:51:51,741 [trainer.py] => kl_weight: 0.001
2025-01-04 15:51:51,741 [trainer.py] => TIP_init: zero
2025-01-04 15:51:51,741 [trainer.py] => tuned_epoch: 10
2025-01-04 15:51:51,741 [trainer.py] => fs_epoch: 0
2025-01-04 15:51:51,741 [trainer.py] => init_lr: 0.01
2025-01-04 15:51:51,741 [trainer.py] => fs_lr: 0.001
2025-01-04 15:51:51,742 [trainer.py] => batch_size: 48
2025-01-04 15:51:51,742 [trainer.py] => fs_batch_size: 16
2025-01-04 15:51:51,742 [trainer.py] => weight_decay: 0.0005
2025-01-04 15:51:51,742 [trainer.py] => min_lr: 0
2025-01-04 15:51:51,742 [trainer.py] => optimizer: sgd
2025-01-04 15:51:51,742 [trainer.py] => memory_size: 0
2025-01-04 15:51:51,742 [trainer.py] => memory_per_class: 0
2025-01-04 15:51:51,742 [trainer.py] => fixed_memory: False
2025-01-04 15:51:51,742 [trainer.py] => shuffle: False
2025-01-04 15:51:51,742 [trainer.py] => top_k: 5
2025-01-04 15:51:51,742 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 15:51:51,742 [trainer.py] => prefix: asp
2025-01-04 15:51:51,742 [trainer.py] => model_prefix: asp
2025-01-04 15:51:54,035 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 15:52:37,381 [trainer.py] => config: ./exps/cifar.json
2025-01-04 15:52:37,381 [trainer.py] => model_name: asp
2025-01-04 15:52:37,381 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 15:52:37,381 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 15:52:37,381 [trainer.py] => seed: 2024
2025-01-04 15:52:37,381 [trainer.py] => dataset: cifar224
2025-01-04 15:52:37,381 [trainer.py] => init_cls: 60
2025-01-04 15:52:37,381 [trainer.py] => increment: 5
2025-01-04 15:52:37,381 [trainer.py] => kshot: 5
2025-01-04 15:52:37,381 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 15:52:37,381 [trainer.py] => z_dim: 1000
2025-01-04 15:52:37,381 [trainer.py] => conv_dim: 64
2025-01-04 15:52:37,381 [trainer.py] => img_size: 224
2025-01-04 15:52:37,381 [trainer.py] => generator_lr: 0.005
2025-01-04 15:52:37,381 [trainer.py] => pi: 100
2025-01-04 15:52:37,381 [trainer.py] => w_bn: 50.0
2025-01-04 15:52:37,381 [trainer.py] => w_noise: 0.001
2025-01-04 15:52:37,381 [trainer.py] => server_ss: 32
2025-01-04 15:52:37,381 [trainer.py] => bn_loss: 1
2025-01-04 15:52:37,381 [trainer.py] => noise: 1
2025-01-04 15:52:37,381 [trainer.py] => ie_loss: 1
2025-01-04 15:52:37,382 [trainer.py] => act_loss: 0
2025-01-04 15:52:37,382 [trainer.py] => w_ie: 1.0
2025-01-04 15:52:37,382 [trainer.py] => w_act: 0.1
2025-01-04 15:52:37,382 [trainer.py] => syn_size: 32
2025-01-04 15:52:37,382 [trainer.py] => vpt_type: Deep
2025-01-04 15:52:37,382 [trainer.py] => prompt_token_num: 6
2025-01-04 15:52:37,382 [trainer.py] => avg_alpha: 0.8
2025-01-04 15:52:37,382 [trainer.py] => perturb_var: 1
2025-01-04 15:52:37,382 [trainer.py] => EMA_beta: 0.99
2025-01-04 15:52:37,382 [trainer.py] => anchor_lambda: 0.1
2025-01-04 15:52:37,382 [trainer.py] => kl_weight: 0.001
2025-01-04 15:52:37,382 [trainer.py] => TIP_init: zero
2025-01-04 15:52:37,382 [trainer.py] => tuned_epoch: 10
2025-01-04 15:52:37,382 [trainer.py] => fs_epoch: 0
2025-01-04 15:52:37,382 [trainer.py] => init_lr: 0.01
2025-01-04 15:52:37,382 [trainer.py] => fs_lr: 0.001
2025-01-04 15:52:37,382 [trainer.py] => batch_size: 48
2025-01-04 15:52:37,382 [trainer.py] => fs_batch_size: 16
2025-01-04 15:52:37,382 [trainer.py] => weight_decay: 0.0005
2025-01-04 15:52:37,382 [trainer.py] => min_lr: 0
2025-01-04 15:52:37,382 [trainer.py] => optimizer: sgd
2025-01-04 15:52:37,382 [trainer.py] => memory_size: 0
2025-01-04 15:52:37,382 [trainer.py] => memory_per_class: 0
2025-01-04 15:52:37,382 [trainer.py] => fixed_memory: False
2025-01-04 15:52:37,382 [trainer.py] => shuffle: False
2025-01-04 15:52:37,382 [trainer.py] => top_k: 5
2025-01-04 15:52:37,382 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 15:52:37,382 [trainer.py] => prefix: asp
2025-01-04 15:52:37,382 [trainer.py] => model_prefix: asp
2025-01-04 15:52:39,374 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 15:52:54,152 [trainer.py] => All params: 173596160
2025-01-04 15:52:54,154 [trainer.py] => Trainable params: 1998848
2025-01-04 15:52:54,703 [asp.py] => Learning on 0-60
2025-01-04 15:52:54,918 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 15:53:08,468 [trainer.py] => config: ./exps/cifar.json
2025-01-04 15:53:08,468 [trainer.py] => model_name: asp
2025-01-04 15:53:08,468 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 15:53:08,468 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 15:53:08,468 [trainer.py] => seed: 2024
2025-01-04 15:53:08,468 [trainer.py] => dataset: cifar224
2025-01-04 15:53:08,468 [trainer.py] => init_cls: 60
2025-01-04 15:53:08,468 [trainer.py] => increment: 5
2025-01-04 15:53:08,468 [trainer.py] => kshot: 5
2025-01-04 15:53:08,468 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 15:53:08,468 [trainer.py] => z_dim: 1000
2025-01-04 15:53:08,468 [trainer.py] => conv_dim: 64
2025-01-04 15:53:08,468 [trainer.py] => img_size: 224
2025-01-04 15:53:08,468 [trainer.py] => generator_lr: 0.005
2025-01-04 15:53:08,468 [trainer.py] => pi: 100
2025-01-04 15:53:08,468 [trainer.py] => w_bn: 50.0
2025-01-04 15:53:08,468 [trainer.py] => w_noise: 0.001
2025-01-04 15:53:08,468 [trainer.py] => server_ss: 32
2025-01-04 15:53:08,468 [trainer.py] => bn_loss: 1
2025-01-04 15:53:08,468 [trainer.py] => noise: 1
2025-01-04 15:53:08,468 [trainer.py] => ie_loss: 1
2025-01-04 15:53:08,468 [trainer.py] => act_loss: 0
2025-01-04 15:53:08,468 [trainer.py] => w_ie: 1.0
2025-01-04 15:53:08,468 [trainer.py] => w_act: 0.1
2025-01-04 15:53:08,468 [trainer.py] => syn_size: 32
2025-01-04 15:53:08,468 [trainer.py] => vpt_type: Deep
2025-01-04 15:53:08,469 [trainer.py] => prompt_token_num: 6
2025-01-04 15:53:08,469 [trainer.py] => avg_alpha: 0.8
2025-01-04 15:53:08,469 [trainer.py] => perturb_var: 1
2025-01-04 15:53:08,469 [trainer.py] => EMA_beta: 0.99
2025-01-04 15:53:08,469 [trainer.py] => anchor_lambda: 0.1
2025-01-04 15:53:08,469 [trainer.py] => kl_weight: 0.001
2025-01-04 15:53:08,469 [trainer.py] => TIP_init: zero
2025-01-04 15:53:08,469 [trainer.py] => tuned_epoch: 10
2025-01-04 15:53:08,469 [trainer.py] => fs_epoch: 0
2025-01-04 15:53:08,469 [trainer.py] => init_lr: 0.01
2025-01-04 15:53:08,469 [trainer.py] => fs_lr: 0.001
2025-01-04 15:53:08,469 [trainer.py] => batch_size: 48
2025-01-04 15:53:08,469 [trainer.py] => fs_batch_size: 16
2025-01-04 15:53:08,469 [trainer.py] => weight_decay: 0.0005
2025-01-04 15:53:08,469 [trainer.py] => min_lr: 0
2025-01-04 15:53:08,469 [trainer.py] => optimizer: sgd
2025-01-04 15:53:08,469 [trainer.py] => memory_size: 0
2025-01-04 15:53:08,469 [trainer.py] => memory_per_class: 0
2025-01-04 15:53:08,469 [trainer.py] => fixed_memory: False
2025-01-04 15:53:08,469 [trainer.py] => shuffle: False
2025-01-04 15:53:08,469 [trainer.py] => top_k: 5
2025-01-04 15:53:08,469 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 15:53:08,469 [trainer.py] => prefix: asp
2025-01-04 15:53:08,469 [trainer.py] => model_prefix: asp
2025-01-04 15:53:10,693 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 15:53:32,306 [trainer.py] => config: ./exps/cifar.json
2025-01-04 15:53:32,306 [trainer.py] => model_name: asp
2025-01-04 15:53:32,306 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 15:53:32,307 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 15:53:32,307 [trainer.py] => seed: 2024
2025-01-04 15:53:32,307 [trainer.py] => dataset: cifar224
2025-01-04 15:53:32,307 [trainer.py] => init_cls: 60
2025-01-04 15:53:32,307 [trainer.py] => increment: 5
2025-01-04 15:53:32,307 [trainer.py] => kshot: 5
2025-01-04 15:53:32,307 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 15:53:32,307 [trainer.py] => z_dim: 1000
2025-01-04 15:53:32,307 [trainer.py] => conv_dim: 64
2025-01-04 15:53:32,307 [trainer.py] => img_size: 224
2025-01-04 15:53:32,307 [trainer.py] => generator_lr: 0.005
2025-01-04 15:53:32,307 [trainer.py] => pi: 100
2025-01-04 15:53:32,307 [trainer.py] => w_bn: 50.0
2025-01-04 15:53:32,307 [trainer.py] => w_noise: 0.001
2025-01-04 15:53:32,307 [trainer.py] => server_ss: 32
2025-01-04 15:53:32,307 [trainer.py] => bn_loss: 1
2025-01-04 15:53:32,307 [trainer.py] => noise: 1
2025-01-04 15:53:32,307 [trainer.py] => ie_loss: 1
2025-01-04 15:53:32,307 [trainer.py] => act_loss: 0
2025-01-04 15:53:32,307 [trainer.py] => w_ie: 1.0
2025-01-04 15:53:32,307 [trainer.py] => w_act: 0.1
2025-01-04 15:53:32,307 [trainer.py] => syn_size: 32
2025-01-04 15:53:32,307 [trainer.py] => vpt_type: Deep
2025-01-04 15:53:32,307 [trainer.py] => prompt_token_num: 6
2025-01-04 15:53:32,307 [trainer.py] => avg_alpha: 0.8
2025-01-04 15:53:32,307 [trainer.py] => perturb_var: 1
2025-01-04 15:53:32,307 [trainer.py] => EMA_beta: 0.99
2025-01-04 15:53:32,307 [trainer.py] => anchor_lambda: 0.1
2025-01-04 15:53:32,308 [trainer.py] => kl_weight: 0.001
2025-01-04 15:53:32,308 [trainer.py] => TIP_init: zero
2025-01-04 15:53:32,308 [trainer.py] => tuned_epoch: 10
2025-01-04 15:53:32,308 [trainer.py] => fs_epoch: 0
2025-01-04 15:53:32,308 [trainer.py] => init_lr: 0.01
2025-01-04 15:53:32,308 [trainer.py] => fs_lr: 0.001
2025-01-04 15:53:32,308 [trainer.py] => batch_size: 48
2025-01-04 15:53:32,308 [trainer.py] => fs_batch_size: 16
2025-01-04 15:53:32,308 [trainer.py] => weight_decay: 0.0005
2025-01-04 15:53:32,308 [trainer.py] => min_lr: 0
2025-01-04 15:53:32,308 [trainer.py] => optimizer: sgd
2025-01-04 15:53:32,308 [trainer.py] => memory_size: 0
2025-01-04 15:53:32,308 [trainer.py] => memory_per_class: 0
2025-01-04 15:53:32,308 [trainer.py] => fixed_memory: False
2025-01-04 15:53:32,308 [trainer.py] => shuffle: False
2025-01-04 15:53:32,308 [trainer.py] => top_k: 5
2025-01-04 15:53:32,308 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 15:53:32,308 [trainer.py] => prefix: asp
2025-01-04 15:53:32,308 [trainer.py] => model_prefix: asp
2025-01-04 15:53:34,342 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 15:54:02,713 [trainer.py] => config: ./exps/cifar.json
2025-01-04 15:54:02,713 [trainer.py] => model_name: asp
2025-01-04 15:54:02,713 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 15:54:02,713 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 15:54:02,714 [trainer.py] => seed: 2024
2025-01-04 15:54:02,714 [trainer.py] => dataset: cifar224
2025-01-04 15:54:02,714 [trainer.py] => init_cls: 60
2025-01-04 15:54:02,714 [trainer.py] => increment: 5
2025-01-04 15:54:02,714 [trainer.py] => kshot: 5
2025-01-04 15:54:02,714 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 15:54:02,714 [trainer.py] => z_dim: 1000
2025-01-04 15:54:02,714 [trainer.py] => conv_dim: 64
2025-01-04 15:54:02,715 [trainer.py] => img_size: 224
2025-01-04 15:54:02,715 [trainer.py] => generator_lr: 0.005
2025-01-04 15:54:02,715 [trainer.py] => pi: 100
2025-01-04 15:54:02,715 [trainer.py] => w_bn: 50.0
2025-01-04 15:54:02,715 [trainer.py] => w_noise: 0.001
2025-01-04 15:54:02,715 [trainer.py] => server_ss: 32
2025-01-04 15:54:02,715 [trainer.py] => bn_loss: 1
2025-01-04 15:54:02,715 [trainer.py] => noise: 1
2025-01-04 15:54:02,715 [trainer.py] => ie_loss: 1
2025-01-04 15:54:02,716 [trainer.py] => act_loss: 0
2025-01-04 15:54:02,716 [trainer.py] => w_ie: 1.0
2025-01-04 15:54:02,716 [trainer.py] => w_act: 0.1
2025-01-04 15:54:02,716 [trainer.py] => syn_size: 32
2025-01-04 15:54:02,716 [trainer.py] => vpt_type: Deep
2025-01-04 15:54:02,716 [trainer.py] => prompt_token_num: 6
2025-01-04 15:54:02,716 [trainer.py] => avg_alpha: 0.8
2025-01-04 15:54:02,716 [trainer.py] => perturb_var: 1
2025-01-04 15:54:02,716 [trainer.py] => EMA_beta: 0.99
2025-01-04 15:54:02,716 [trainer.py] => anchor_lambda: 0.1
2025-01-04 15:54:02,716 [trainer.py] => kl_weight: 0.001
2025-01-04 15:54:02,716 [trainer.py] => TIP_init: zero
2025-01-04 15:54:02,716 [trainer.py] => tuned_epoch: 10
2025-01-04 15:54:02,716 [trainer.py] => fs_epoch: 0
2025-01-04 15:54:02,716 [trainer.py] => init_lr: 0.01
2025-01-04 15:54:02,716 [trainer.py] => fs_lr: 0.001
2025-01-04 15:54:02,716 [trainer.py] => batch_size: 48
2025-01-04 15:54:02,716 [trainer.py] => fs_batch_size: 16
2025-01-04 15:54:02,716 [trainer.py] => weight_decay: 0.0005
2025-01-04 15:54:02,716 [trainer.py] => min_lr: 0
2025-01-04 15:54:02,716 [trainer.py] => optimizer: sgd
2025-01-04 15:54:02,716 [trainer.py] => memory_size: 0
2025-01-04 15:54:02,716 [trainer.py] => memory_per_class: 0
2025-01-04 15:54:02,716 [trainer.py] => fixed_memory: False
2025-01-04 15:54:02,716 [trainer.py] => shuffle: False
2025-01-04 15:54:02,716 [trainer.py] => top_k: 5
2025-01-04 15:54:02,717 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 15:54:02,717 [trainer.py] => prefix: asp
2025-01-04 15:54:02,717 [trainer.py] => model_prefix: asp
2025-01-04 15:54:04,867 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 15:55:31,527 [trainer.py] => config: ./exps/cifar.json
2025-01-04 15:55:31,527 [trainer.py] => model_name: asp
2025-01-04 15:55:31,527 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 15:55:31,527 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 15:55:31,527 [trainer.py] => seed: 2024
2025-01-04 15:55:31,527 [trainer.py] => dataset: cifar224
2025-01-04 15:55:31,527 [trainer.py] => init_cls: 60
2025-01-04 15:55:31,527 [trainer.py] => increment: 5
2025-01-04 15:55:31,527 [trainer.py] => kshot: 5
2025-01-04 15:55:31,527 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 15:55:31,527 [trainer.py] => z_dim: 1000
2025-01-04 15:55:31,527 [trainer.py] => conv_dim: 64
2025-01-04 15:55:31,527 [trainer.py] => img_size: 224
2025-01-04 15:55:31,527 [trainer.py] => generator_lr: 0.005
2025-01-04 15:55:31,527 [trainer.py] => pi: 100
2025-01-04 15:55:31,527 [trainer.py] => w_bn: 50.0
2025-01-04 15:55:31,527 [trainer.py] => w_noise: 0.001
2025-01-04 15:55:31,527 [trainer.py] => server_ss: 32
2025-01-04 15:55:31,527 [trainer.py] => bn_loss: 1
2025-01-04 15:55:31,528 [trainer.py] => noise: 1
2025-01-04 15:55:31,528 [trainer.py] => ie_loss: 1
2025-01-04 15:55:31,528 [trainer.py] => act_loss: 0
2025-01-04 15:55:31,528 [trainer.py] => w_ie: 1.0
2025-01-04 15:55:31,528 [trainer.py] => w_act: 0.1
2025-01-04 15:55:31,528 [trainer.py] => syn_size: 32
2025-01-04 15:55:31,528 [trainer.py] => vpt_type: Deep
2025-01-04 15:55:31,528 [trainer.py] => prompt_token_num: 6
2025-01-04 15:55:31,528 [trainer.py] => avg_alpha: 0.8
2025-01-04 15:55:31,528 [trainer.py] => perturb_var: 1
2025-01-04 15:55:31,528 [trainer.py] => EMA_beta: 0.99
2025-01-04 15:55:31,528 [trainer.py] => anchor_lambda: 0.1
2025-01-04 15:55:31,528 [trainer.py] => kl_weight: 0.001
2025-01-04 15:55:31,528 [trainer.py] => TIP_init: zero
2025-01-04 15:55:31,528 [trainer.py] => tuned_epoch: 10
2025-01-04 15:55:31,528 [trainer.py] => fs_epoch: 0
2025-01-04 15:55:31,528 [trainer.py] => init_lr: 0.01
2025-01-04 15:55:31,528 [trainer.py] => fs_lr: 0.001
2025-01-04 15:55:31,528 [trainer.py] => batch_size: 48
2025-01-04 15:55:31,528 [trainer.py] => fs_batch_size: 16
2025-01-04 15:55:31,528 [trainer.py] => weight_decay: 0.0005
2025-01-04 15:55:31,528 [trainer.py] => min_lr: 0
2025-01-04 15:55:31,528 [trainer.py] => optimizer: sgd
2025-01-04 15:55:31,528 [trainer.py] => memory_size: 0
2025-01-04 15:55:31,528 [trainer.py] => memory_per_class: 0
2025-01-04 15:55:31,528 [trainer.py] => fixed_memory: False
2025-01-04 15:55:31,528 [trainer.py] => shuffle: False
2025-01-04 15:55:31,529 [trainer.py] => top_k: 5
2025-01-04 15:55:31,529 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 15:55:31,534 [trainer.py] => prefix: asp
2025-01-04 15:55:31,534 [trainer.py] => model_prefix: asp
2025-01-04 15:55:33,519 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 15:55:47,264 [trainer.py] => config: ./exps/cifar.json
2025-01-04 15:55:47,264 [trainer.py] => model_name: asp
2025-01-04 15:55:47,264 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 15:55:47,264 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 15:55:47,264 [trainer.py] => seed: 2024
2025-01-04 15:55:47,264 [trainer.py] => dataset: cifar224
2025-01-04 15:55:47,264 [trainer.py] => init_cls: 60
2025-01-04 15:55:47,264 [trainer.py] => increment: 5
2025-01-04 15:55:47,264 [trainer.py] => kshot: 5
2025-01-04 15:55:47,264 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 15:55:47,264 [trainer.py] => z_dim: 1000
2025-01-04 15:55:47,264 [trainer.py] => conv_dim: 64
2025-01-04 15:55:47,264 [trainer.py] => img_size: 224
2025-01-04 15:55:47,264 [trainer.py] => generator_lr: 0.005
2025-01-04 15:55:47,264 [trainer.py] => pi: 100
2025-01-04 15:55:47,264 [trainer.py] => w_bn: 50.0
2025-01-04 15:55:47,265 [trainer.py] => w_noise: 0.001
2025-01-04 15:55:47,265 [trainer.py] => server_ss: 32
2025-01-04 15:55:47,265 [trainer.py] => bn_loss: 1
2025-01-04 15:55:47,265 [trainer.py] => noise: 1
2025-01-04 15:55:47,265 [trainer.py] => ie_loss: 1
2025-01-04 15:55:47,265 [trainer.py] => act_loss: 0
2025-01-04 15:55:47,265 [trainer.py] => w_ie: 1.0
2025-01-04 15:55:47,265 [trainer.py] => w_act: 0.1
2025-01-04 15:55:47,265 [trainer.py] => syn_size: 32
2025-01-04 15:55:47,265 [trainer.py] => vpt_type: Deep
2025-01-04 15:55:47,265 [trainer.py] => prompt_token_num: 6
2025-01-04 15:55:47,265 [trainer.py] => avg_alpha: 0.8
2025-01-04 15:55:47,265 [trainer.py] => perturb_var: 1
2025-01-04 15:55:47,265 [trainer.py] => EMA_beta: 0.99
2025-01-04 15:55:47,265 [trainer.py] => anchor_lambda: 0.1
2025-01-04 15:55:47,265 [trainer.py] => kl_weight: 0.001
2025-01-04 15:55:47,265 [trainer.py] => TIP_init: zero
2025-01-04 15:55:47,265 [trainer.py] => tuned_epoch: 10
2025-01-04 15:55:47,265 [trainer.py] => fs_epoch: 0
2025-01-04 15:55:47,265 [trainer.py] => init_lr: 0.01
2025-01-04 15:55:47,265 [trainer.py] => fs_lr: 0.001
2025-01-04 15:55:47,265 [trainer.py] => batch_size: 48
2025-01-04 15:55:47,265 [trainer.py] => fs_batch_size: 16
2025-01-04 15:55:47,265 [trainer.py] => weight_decay: 0.0005
2025-01-04 15:55:47,265 [trainer.py] => min_lr: 0
2025-01-04 15:55:47,265 [trainer.py] => optimizer: sgd
2025-01-04 15:55:47,265 [trainer.py] => memory_size: 0
2025-01-04 15:55:47,265 [trainer.py] => memory_per_class: 0
2025-01-04 15:55:47,266 [trainer.py] => fixed_memory: False
2025-01-04 15:55:47,266 [trainer.py] => shuffle: False
2025-01-04 15:55:47,266 [trainer.py] => top_k: 5
2025-01-04 15:55:47,266 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 15:55:47,266 [trainer.py] => prefix: asp
2025-01-04 15:55:47,266 [trainer.py] => model_prefix: asp
2025-01-04 15:55:49,347 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 15:56:07,572 [trainer.py] => All params: 173596160
2025-01-04 15:56:07,573 [trainer.py] => Trainable params: 1998848
2025-01-04 15:56:08,146 [asp.py] => Learning on 0-60
2025-01-04 15:56:08,367 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 16:20:49,379 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:20:49,380 [trainer.py] => model_name: asp
2025-01-04 16:20:49,380 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:20:49,380 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:20:49,380 [trainer.py] => seed: 2024
2025-01-04 16:20:49,380 [trainer.py] => dataset: cifar224
2025-01-04 16:20:49,380 [trainer.py] => init_cls: 60
2025-01-04 16:20:49,380 [trainer.py] => increment: 5
2025-01-04 16:20:49,381 [trainer.py] => kshot: 5
2025-01-04 16:20:49,381 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:20:49,381 [trainer.py] => z_dim: 1000
2025-01-04 16:20:49,381 [trainer.py] => conv_dim: 64
2025-01-04 16:20:49,381 [trainer.py] => img_size: 224
2025-01-04 16:20:49,381 [trainer.py] => generator_lr: 0.005
2025-01-04 16:20:49,381 [trainer.py] => pi: 100
2025-01-04 16:20:49,381 [trainer.py] => w_bn: 50.0
2025-01-04 16:20:49,382 [trainer.py] => w_noise: 0.001
2025-01-04 16:20:49,382 [trainer.py] => server_ss: 32
2025-01-04 16:20:49,382 [trainer.py] => bn_loss: 1
2025-01-04 16:20:49,382 [trainer.py] => noise: 1
2025-01-04 16:20:49,382 [trainer.py] => ie_loss: 1
2025-01-04 16:20:49,382 [trainer.py] => act_loss: 0
2025-01-04 16:20:49,382 [trainer.py] => w_ie: 1.0
2025-01-04 16:20:49,383 [trainer.py] => w_act: 0.1
2025-01-04 16:20:49,383 [trainer.py] => syn_size: 32
2025-01-04 16:20:49,383 [trainer.py] => need_syn_imgs: True
2025-01-04 16:20:49,383 [trainer.py] => g_local_bs: 12
2025-01-04 16:20:49,384 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:20:49,384 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:20:49,384 [trainer.py] => vpt_type: Deep
2025-01-04 16:20:49,384 [trainer.py] => prompt_token_num: 6
2025-01-04 16:20:49,384 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:20:49,384 [trainer.py] => perturb_var: 1
2025-01-04 16:20:49,385 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:20:49,385 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:20:49,385 [trainer.py] => kl_weight: 0.001
2025-01-04 16:20:49,385 [trainer.py] => TIP_init: zero
2025-01-04 16:20:49,385 [trainer.py] => tuned_epoch: 10
2025-01-04 16:20:49,385 [trainer.py] => fs_epoch: 0
2025-01-04 16:20:49,385 [trainer.py] => init_lr: 0.01
2025-01-04 16:20:49,385 [trainer.py] => fs_lr: 0.001
2025-01-04 16:20:49,386 [trainer.py] => batch_size: 48
2025-01-04 16:20:49,386 [trainer.py] => fs_batch_size: 16
2025-01-04 16:20:49,386 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:20:49,386 [trainer.py] => min_lr: 0
2025-01-04 16:20:49,386 [trainer.py] => optimizer: sgd
2025-01-04 16:20:49,387 [trainer.py] => memory_size: 0
2025-01-04 16:20:49,387 [trainer.py] => memory_per_class: 0
2025-01-04 16:20:49,387 [trainer.py] => fixed_memory: False
2025-01-04 16:20:49,393 [trainer.py] => shuffle: False
2025-01-04 16:20:49,393 [trainer.py] => top_k: 5
2025-01-04 16:20:49,394 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:20:49,394 [trainer.py] => prefix: asp
2025-01-04 16:20:49,394 [trainer.py] => model_prefix: asp
2025-01-04 16:20:51,312 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:24:31,996 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:24:31,996 [trainer.py] => model_name: asp
2025-01-04 16:24:31,996 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:24:31,996 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:24:31,996 [trainer.py] => seed: 2024
2025-01-04 16:24:31,996 [trainer.py] => dataset: cifar224
2025-01-04 16:24:31,996 [trainer.py] => init_cls: 60
2025-01-04 16:24:31,996 [trainer.py] => increment: 5
2025-01-04 16:24:31,996 [trainer.py] => kshot: 5
2025-01-04 16:24:31,996 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:24:31,996 [trainer.py] => z_dim: 1000
2025-01-04 16:24:31,996 [trainer.py] => conv_dim: 64
2025-01-04 16:24:31,996 [trainer.py] => img_size: 224
2025-01-04 16:24:31,996 [trainer.py] => generator_lr: 0.005
2025-01-04 16:24:31,996 [trainer.py] => pi: 100
2025-01-04 16:24:31,996 [trainer.py] => w_bn: 50.0
2025-01-04 16:24:31,997 [trainer.py] => w_noise: 0.001
2025-01-04 16:24:31,997 [trainer.py] => server_ss: 32
2025-01-04 16:24:31,997 [trainer.py] => bn_loss: 1
2025-01-04 16:24:31,997 [trainer.py] => noise: 1
2025-01-04 16:24:31,997 [trainer.py] => ie_loss: 1
2025-01-04 16:24:31,997 [trainer.py] => act_loss: 0
2025-01-04 16:24:31,997 [trainer.py] => w_ie: 1.0
2025-01-04 16:24:31,997 [trainer.py] => w_act: 0.1
2025-01-04 16:24:31,997 [trainer.py] => syn_size: 32
2025-01-04 16:24:31,997 [trainer.py] => need_syn_imgs: True
2025-01-04 16:24:31,997 [trainer.py] => g_local_bs: 12
2025-01-04 16:24:31,997 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:24:31,997 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:24:31,997 [trainer.py] => vpt_type: Deep
2025-01-04 16:24:31,997 [trainer.py] => prompt_token_num: 6
2025-01-04 16:24:31,997 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:24:31,997 [trainer.py] => perturb_var: 1
2025-01-04 16:24:31,997 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:24:31,997 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:24:31,997 [trainer.py] => kl_weight: 0.001
2025-01-04 16:24:31,997 [trainer.py] => TIP_init: zero
2025-01-04 16:24:31,997 [trainer.py] => tuned_epoch: 10
2025-01-04 16:24:31,997 [trainer.py] => fs_epoch: 0
2025-01-04 16:24:31,997 [trainer.py] => init_lr: 0.01
2025-01-04 16:24:31,997 [trainer.py] => fs_lr: 0.001
2025-01-04 16:24:31,997 [trainer.py] => batch_size: 48
2025-01-04 16:24:31,997 [trainer.py] => fs_batch_size: 16
2025-01-04 16:24:31,997 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:24:31,997 [trainer.py] => min_lr: 0
2025-01-04 16:24:31,997 [trainer.py] => optimizer: sgd
2025-01-04 16:24:31,997 [trainer.py] => memory_size: 0
2025-01-04 16:24:31,997 [trainer.py] => memory_per_class: 0
2025-01-04 16:24:31,998 [trainer.py] => fixed_memory: False
2025-01-04 16:24:31,998 [trainer.py] => shuffle: False
2025-01-04 16:24:31,998 [trainer.py] => top_k: 5
2025-01-04 16:24:31,998 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:24:31,998 [trainer.py] => prefix: asp
2025-01-04 16:24:31,998 [trainer.py] => model_prefix: asp
2025-01-04 16:24:33,837 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:24:55,663 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:24:55,663 [trainer.py] => model_name: asp
2025-01-04 16:24:55,664 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:24:55,664 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:24:55,664 [trainer.py] => seed: 2024
2025-01-04 16:24:55,664 [trainer.py] => dataset: cifar224
2025-01-04 16:24:55,664 [trainer.py] => init_cls: 60
2025-01-04 16:24:55,664 [trainer.py] => increment: 5
2025-01-04 16:24:55,664 [trainer.py] => kshot: 5
2025-01-04 16:24:55,664 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:24:55,664 [trainer.py] => z_dim: 1000
2025-01-04 16:24:55,664 [trainer.py] => conv_dim: 64
2025-01-04 16:24:55,664 [trainer.py] => img_size: 224
2025-01-04 16:24:55,664 [trainer.py] => generator_lr: 0.005
2025-01-04 16:24:55,664 [trainer.py] => pi: 100
2025-01-04 16:24:55,664 [trainer.py] => w_bn: 50.0
2025-01-04 16:24:55,664 [trainer.py] => w_noise: 0.001
2025-01-04 16:24:55,664 [trainer.py] => server_ss: 32
2025-01-04 16:24:55,664 [trainer.py] => bn_loss: 1
2025-01-04 16:24:55,664 [trainer.py] => noise: 1
2025-01-04 16:24:55,664 [trainer.py] => ie_loss: 1
2025-01-04 16:24:55,664 [trainer.py] => act_loss: 0
2025-01-04 16:24:55,664 [trainer.py] => w_ie: 1.0
2025-01-04 16:24:55,664 [trainer.py] => w_act: 0.1
2025-01-04 16:24:55,664 [trainer.py] => syn_size: 32
2025-01-04 16:24:55,664 [trainer.py] => need_syn_imgs: True
2025-01-04 16:24:55,664 [trainer.py] => g_local_bs: 12
2025-01-04 16:24:55,664 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:24:55,664 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:24:55,664 [trainer.py] => vpt_type: Deep
2025-01-04 16:24:55,664 [trainer.py] => prompt_token_num: 6
2025-01-04 16:24:55,664 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:24:55,664 [trainer.py] => perturb_var: 1
2025-01-04 16:24:55,665 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:24:55,665 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:24:55,665 [trainer.py] => kl_weight: 0.001
2025-01-04 16:24:55,665 [trainer.py] => TIP_init: zero
2025-01-04 16:24:55,665 [trainer.py] => tuned_epoch: 10
2025-01-04 16:24:55,665 [trainer.py] => fs_epoch: 0
2025-01-04 16:24:55,665 [trainer.py] => init_lr: 0.01
2025-01-04 16:24:55,665 [trainer.py] => fs_lr: 0.001
2025-01-04 16:24:55,665 [trainer.py] => batch_size: 48
2025-01-04 16:24:55,665 [trainer.py] => fs_batch_size: 16
2025-01-04 16:24:55,665 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:24:55,665 [trainer.py] => min_lr: 0
2025-01-04 16:24:55,665 [trainer.py] => optimizer: sgd
2025-01-04 16:24:55,665 [trainer.py] => memory_size: 0
2025-01-04 16:24:55,665 [trainer.py] => memory_per_class: 0
2025-01-04 16:24:55,665 [trainer.py] => fixed_memory: False
2025-01-04 16:24:55,665 [trainer.py] => shuffle: False
2025-01-04 16:24:55,665 [trainer.py] => top_k: 5
2025-01-04 16:24:55,665 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:24:55,665 [trainer.py] => prefix: asp
2025-01-04 16:24:55,665 [trainer.py] => model_prefix: asp
2025-01-04 16:24:57,469 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:29:06,696 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:29:06,696 [trainer.py] => model_name: asp
2025-01-04 16:29:06,696 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:29:06,696 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:29:06,696 [trainer.py] => seed: 2024
2025-01-04 16:29:06,696 [trainer.py] => dataset: cifar224
2025-01-04 16:29:06,696 [trainer.py] => init_cls: 60
2025-01-04 16:29:06,696 [trainer.py] => increment: 5
2025-01-04 16:29:06,696 [trainer.py] => kshot: 5
2025-01-04 16:29:06,696 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:29:06,696 [trainer.py] => z_dim: 1000
2025-01-04 16:29:06,696 [trainer.py] => conv_dim: 64
2025-01-04 16:29:06,696 [trainer.py] => img_size: 224
2025-01-04 16:29:06,696 [trainer.py] => generator_lr: 0.005
2025-01-04 16:29:06,696 [trainer.py] => pi: 100
2025-01-04 16:29:06,696 [trainer.py] => w_bn: 50.0
2025-01-04 16:29:06,696 [trainer.py] => w_noise: 0.001
2025-01-04 16:29:06,696 [trainer.py] => server_ss: 32
2025-01-04 16:29:06,696 [trainer.py] => bn_loss: 1
2025-01-04 16:29:06,696 [trainer.py] => noise: 1
2025-01-04 16:29:06,697 [trainer.py] => ie_loss: 1
2025-01-04 16:29:06,697 [trainer.py] => act_loss: 0
2025-01-04 16:29:06,697 [trainer.py] => w_ie: 1.0
2025-01-04 16:29:06,697 [trainer.py] => w_act: 0.1
2025-01-04 16:29:06,697 [trainer.py] => syn_size: 32
2025-01-04 16:29:06,697 [trainer.py] => need_syn_imgs: True
2025-01-04 16:29:06,697 [trainer.py] => g_local_bs: 12
2025-01-04 16:29:06,697 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:29:06,697 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:29:06,697 [trainer.py] => vpt_type: Deep
2025-01-04 16:29:06,697 [trainer.py] => prompt_token_num: 6
2025-01-04 16:29:06,697 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:29:06,697 [trainer.py] => perturb_var: 1
2025-01-04 16:29:06,697 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:29:06,697 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:29:06,697 [trainer.py] => kl_weight: 0.001
2025-01-04 16:29:06,697 [trainer.py] => TIP_init: zero
2025-01-04 16:29:06,697 [trainer.py] => tuned_epoch: 10
2025-01-04 16:29:06,697 [trainer.py] => fs_epoch: 0
2025-01-04 16:29:06,697 [trainer.py] => init_lr: 0.01
2025-01-04 16:29:06,697 [trainer.py] => fs_lr: 0.001
2025-01-04 16:29:06,697 [trainer.py] => batch_size: 48
2025-01-04 16:29:06,697 [trainer.py] => fs_batch_size: 16
2025-01-04 16:29:06,697 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:29:06,697 [trainer.py] => min_lr: 0
2025-01-04 16:29:06,697 [trainer.py] => optimizer: sgd
2025-01-04 16:29:06,697 [trainer.py] => memory_size: 0
2025-01-04 16:29:06,697 [trainer.py] => memory_per_class: 0
2025-01-04 16:29:06,698 [trainer.py] => fixed_memory: False
2025-01-04 16:29:06,698 [trainer.py] => shuffle: False
2025-01-04 16:29:06,698 [trainer.py] => top_k: 5
2025-01-04 16:29:06,698 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:29:06,698 [trainer.py] => prefix: asp
2025-01-04 16:29:06,698 [trainer.py] => model_prefix: asp
2025-01-04 16:29:09,990 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:30:42,007 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:30:42,007 [trainer.py] => model_name: asp
2025-01-04 16:30:42,008 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:30:42,008 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:30:42,008 [trainer.py] => seed: 2024
2025-01-04 16:30:42,008 [trainer.py] => dataset: cifar224
2025-01-04 16:30:42,008 [trainer.py] => init_cls: 60
2025-01-04 16:30:42,008 [trainer.py] => increment: 5
2025-01-04 16:30:42,008 [trainer.py] => kshot: 5
2025-01-04 16:30:42,008 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:30:42,008 [trainer.py] => z_dim: 1000
2025-01-04 16:30:42,008 [trainer.py] => conv_dim: 64
2025-01-04 16:30:42,008 [trainer.py] => img_size: 224
2025-01-04 16:30:42,008 [trainer.py] => generator_lr: 0.005
2025-01-04 16:30:42,008 [trainer.py] => pi: 100
2025-01-04 16:30:42,008 [trainer.py] => w_bn: 50.0
2025-01-04 16:30:42,008 [trainer.py] => w_noise: 0.001
2025-01-04 16:30:42,008 [trainer.py] => server_ss: 32
2025-01-04 16:30:42,008 [trainer.py] => bn_loss: 1
2025-01-04 16:30:42,008 [trainer.py] => noise: 1
2025-01-04 16:30:42,008 [trainer.py] => ie_loss: 1
2025-01-04 16:30:42,008 [trainer.py] => act_loss: 0
2025-01-04 16:30:42,008 [trainer.py] => w_ie: 1.0
2025-01-04 16:30:42,008 [trainer.py] => w_act: 0.1
2025-01-04 16:30:42,008 [trainer.py] => syn_size: 32
2025-01-04 16:30:42,008 [trainer.py] => need_syn_imgs: True
2025-01-04 16:30:42,008 [trainer.py] => g_local_bs: 12
2025-01-04 16:30:42,008 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:30:42,009 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:30:42,009 [trainer.py] => vpt_type: Deep
2025-01-04 16:30:42,009 [trainer.py] => prompt_token_num: 6
2025-01-04 16:30:42,009 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:30:42,009 [trainer.py] => perturb_var: 1
2025-01-04 16:30:42,009 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:30:42,009 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:30:42,009 [trainer.py] => kl_weight: 0.001
2025-01-04 16:30:42,009 [trainer.py] => TIP_init: zero
2025-01-04 16:30:42,009 [trainer.py] => tuned_epoch: 10
2025-01-04 16:30:42,009 [trainer.py] => fs_epoch: 0
2025-01-04 16:30:42,009 [trainer.py] => init_lr: 0.01
2025-01-04 16:30:42,009 [trainer.py] => fs_lr: 0.001
2025-01-04 16:30:42,009 [trainer.py] => batch_size: 48
2025-01-04 16:30:42,009 [trainer.py] => fs_batch_size: 16
2025-01-04 16:30:42,009 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:30:42,009 [trainer.py] => min_lr: 0
2025-01-04 16:30:42,009 [trainer.py] => optimizer: sgd
2025-01-04 16:30:42,009 [trainer.py] => memory_size: 0
2025-01-04 16:30:42,009 [trainer.py] => memory_per_class: 0
2025-01-04 16:30:42,009 [trainer.py] => fixed_memory: False
2025-01-04 16:30:42,009 [trainer.py] => shuffle: False
2025-01-04 16:30:42,009 [trainer.py] => top_k: 5
2025-01-04 16:30:42,009 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:30:42,009 [trainer.py] => prefix: asp
2025-01-04 16:30:42,009 [trainer.py] => model_prefix: asp
2025-01-04 16:30:44,411 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:32:02,913 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:32:02,914 [trainer.py] => model_name: asp
2025-01-04 16:32:02,914 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:32:02,915 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:32:02,915 [trainer.py] => seed: 2024
2025-01-04 16:32:02,915 [trainer.py] => dataset: cifar224
2025-01-04 16:32:02,915 [trainer.py] => init_cls: 60
2025-01-04 16:32:02,915 [trainer.py] => increment: 5
2025-01-04 16:32:02,915 [trainer.py] => kshot: 5
2025-01-04 16:32:02,915 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:32:02,915 [trainer.py] => z_dim: 1000
2025-01-04 16:32:02,915 [trainer.py] => conv_dim: 64
2025-01-04 16:32:02,915 [trainer.py] => img_size: 224
2025-01-04 16:32:02,915 [trainer.py] => generator_lr: 0.005
2025-01-04 16:32:02,915 [trainer.py] => pi: 100
2025-01-04 16:32:02,915 [trainer.py] => w_bn: 50.0
2025-01-04 16:32:02,915 [trainer.py] => w_noise: 0.001
2025-01-04 16:32:02,915 [trainer.py] => server_ss: 32
2025-01-04 16:32:02,916 [trainer.py] => bn_loss: 1
2025-01-04 16:32:02,916 [trainer.py] => noise: 1
2025-01-04 16:32:02,916 [trainer.py] => ie_loss: 1
2025-01-04 16:32:02,916 [trainer.py] => act_loss: 0
2025-01-04 16:32:02,916 [trainer.py] => w_ie: 1.0
2025-01-04 16:32:02,916 [trainer.py] => w_act: 0.1
2025-01-04 16:32:02,916 [trainer.py] => syn_size: 32
2025-01-04 16:32:02,916 [trainer.py] => need_syn_imgs: True
2025-01-04 16:32:02,916 [trainer.py] => g_local_bs: 12
2025-01-04 16:32:02,916 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:32:02,916 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:32:02,916 [trainer.py] => vpt_type: Deep
2025-01-04 16:32:02,916 [trainer.py] => prompt_token_num: 6
2025-01-04 16:32:02,916 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:32:02,916 [trainer.py] => perturb_var: 1
2025-01-04 16:32:02,916 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:32:02,916 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:32:02,916 [trainer.py] => kl_weight: 0.001
2025-01-04 16:32:02,916 [trainer.py] => TIP_init: zero
2025-01-04 16:32:02,917 [trainer.py] => tuned_epoch: 10
2025-01-04 16:32:02,917 [trainer.py] => fs_epoch: 0
2025-01-04 16:32:02,917 [trainer.py] => init_lr: 0.01
2025-01-04 16:32:02,917 [trainer.py] => fs_lr: 0.001
2025-01-04 16:32:02,917 [trainer.py] => batch_size: 48
2025-01-04 16:32:02,917 [trainer.py] => fs_batch_size: 16
2025-01-04 16:32:02,917 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:32:02,917 [trainer.py] => min_lr: 0
2025-01-04 16:32:02,917 [trainer.py] => optimizer: sgd
2025-01-04 16:32:02,917 [trainer.py] => memory_size: 0
2025-01-04 16:32:02,917 [trainer.py] => memory_per_class: 0
2025-01-04 16:32:02,917 [trainer.py] => fixed_memory: False
2025-01-04 16:32:02,917 [trainer.py] => shuffle: False
2025-01-04 16:32:02,917 [trainer.py] => top_k: 5
2025-01-04 16:32:02,917 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:32:02,918 [trainer.py] => prefix: asp
2025-01-04 16:32:02,918 [trainer.py] => model_prefix: asp
2025-01-04 16:32:04,963 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:32:40,968 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:32:40,969 [trainer.py] => model_name: asp
2025-01-04 16:32:40,969 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:32:40,969 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:32:40,969 [trainer.py] => seed: 2024
2025-01-04 16:32:40,970 [trainer.py] => dataset: cifar224
2025-01-04 16:32:40,970 [trainer.py] => init_cls: 60
2025-01-04 16:32:40,970 [trainer.py] => increment: 5
2025-01-04 16:32:40,970 [trainer.py] => kshot: 5
2025-01-04 16:32:40,970 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:32:40,970 [trainer.py] => z_dim: 1000
2025-01-04 16:32:40,970 [trainer.py] => conv_dim: 64
2025-01-04 16:32:40,971 [trainer.py] => img_size: 224
2025-01-04 16:32:40,971 [trainer.py] => generator_lr: 0.005
2025-01-04 16:32:40,971 [trainer.py] => pi: 100
2025-01-04 16:32:40,971 [trainer.py] => w_bn: 50.0
2025-01-04 16:32:40,971 [trainer.py] => w_noise: 0.001
2025-01-04 16:32:40,971 [trainer.py] => server_ss: 32
2025-01-04 16:32:40,972 [trainer.py] => bn_loss: 1
2025-01-04 16:32:40,972 [trainer.py] => noise: 1
2025-01-04 16:32:40,972 [trainer.py] => ie_loss: 1
2025-01-04 16:32:40,972 [trainer.py] => act_loss: 0
2025-01-04 16:32:40,972 [trainer.py] => w_ie: 1.0
2025-01-04 16:32:40,972 [trainer.py] => w_act: 0.1
2025-01-04 16:32:40,972 [trainer.py] => syn_size: 32
2025-01-04 16:32:40,973 [trainer.py] => need_syn_imgs: True
2025-01-04 16:32:40,973 [trainer.py] => g_local_bs: 12
2025-01-04 16:32:40,973 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:32:40,973 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:32:40,973 [trainer.py] => vpt_type: Deep
2025-01-04 16:32:40,973 [trainer.py] => prompt_token_num: 6
2025-01-04 16:32:40,973 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:32:40,973 [trainer.py] => perturb_var: 1
2025-01-04 16:32:40,973 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:32:40,973 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:32:40,973 [trainer.py] => kl_weight: 0.001
2025-01-04 16:32:40,973 [trainer.py] => TIP_init: zero
2025-01-04 16:32:40,974 [trainer.py] => tuned_epoch: 10
2025-01-04 16:32:40,974 [trainer.py] => fs_epoch: 0
2025-01-04 16:32:40,974 [trainer.py] => init_lr: 0.01
2025-01-04 16:32:40,974 [trainer.py] => fs_lr: 0.001
2025-01-04 16:32:40,974 [trainer.py] => batch_size: 48
2025-01-04 16:32:40,974 [trainer.py] => fs_batch_size: 16
2025-01-04 16:32:40,974 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:32:40,974 [trainer.py] => min_lr: 0
2025-01-04 16:32:40,974 [trainer.py] => optimizer: sgd
2025-01-04 16:32:40,974 [trainer.py] => memory_size: 0
2025-01-04 16:32:40,974 [trainer.py] => memory_per_class: 0
2025-01-04 16:32:40,974 [trainer.py] => fixed_memory: False
2025-01-04 16:32:40,974 [trainer.py] => shuffle: False
2025-01-04 16:32:40,974 [trainer.py] => top_k: 5
2025-01-04 16:32:40,974 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:32:40,974 [trainer.py] => prefix: asp
2025-01-04 16:32:40,974 [trainer.py] => model_prefix: asp
2025-01-04 16:32:43,283 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:34:18,022 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:34:18,022 [trainer.py] => model_name: asp
2025-01-04 16:34:18,022 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:34:18,022 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:34:18,022 [trainer.py] => seed: 2024
2025-01-04 16:34:18,022 [trainer.py] => dataset: cifar224
2025-01-04 16:34:18,023 [trainer.py] => init_cls: 60
2025-01-04 16:34:18,023 [trainer.py] => increment: 5
2025-01-04 16:34:18,023 [trainer.py] => kshot: 5
2025-01-04 16:34:18,023 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:34:18,023 [trainer.py] => z_dim: 1000
2025-01-04 16:34:18,023 [trainer.py] => conv_dim: 64
2025-01-04 16:34:18,023 [trainer.py] => img_size: 224
2025-01-04 16:34:18,023 [trainer.py] => generator_lr: 0.005
2025-01-04 16:34:18,023 [trainer.py] => pi: 100
2025-01-04 16:34:18,023 [trainer.py] => w_bn: 50.0
2025-01-04 16:34:18,023 [trainer.py] => w_noise: 0.001
2025-01-04 16:34:18,023 [trainer.py] => server_ss: 32
2025-01-04 16:34:18,023 [trainer.py] => bn_loss: 1
2025-01-04 16:34:18,023 [trainer.py] => noise: 1
2025-01-04 16:34:18,023 [trainer.py] => ie_loss: 1
2025-01-04 16:34:18,023 [trainer.py] => act_loss: 0
2025-01-04 16:34:18,024 [trainer.py] => w_ie: 1.0
2025-01-04 16:34:18,024 [trainer.py] => w_act: 0.1
2025-01-04 16:34:18,024 [trainer.py] => syn_size: 32
2025-01-04 16:34:18,024 [trainer.py] => need_syn_imgs: True
2025-01-04 16:34:18,024 [trainer.py] => g_local_bs: 12
2025-01-04 16:34:18,024 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:34:18,024 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:34:18,024 [trainer.py] => vpt_type: Deep
2025-01-04 16:34:18,024 [trainer.py] => prompt_token_num: 6
2025-01-04 16:34:18,024 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:34:18,024 [trainer.py] => perturb_var: 1
2025-01-04 16:34:18,024 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:34:18,024 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:34:18,024 [trainer.py] => kl_weight: 0.001
2025-01-04 16:34:18,024 [trainer.py] => TIP_init: zero
2025-01-04 16:34:18,024 [trainer.py] => tuned_epoch: 10
2025-01-04 16:34:18,024 [trainer.py] => fs_epoch: 0
2025-01-04 16:34:18,024 [trainer.py] => init_lr: 0.01
2025-01-04 16:34:18,024 [trainer.py] => fs_lr: 0.001
2025-01-04 16:34:18,024 [trainer.py] => batch_size: 48
2025-01-04 16:34:18,024 [trainer.py] => fs_batch_size: 16
2025-01-04 16:34:18,024 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:34:18,024 [trainer.py] => min_lr: 0
2025-01-04 16:34:18,024 [trainer.py] => optimizer: sgd
2025-01-04 16:34:18,024 [trainer.py] => memory_size: 0
2025-01-04 16:34:18,024 [trainer.py] => memory_per_class: 0
2025-01-04 16:34:18,024 [trainer.py] => fixed_memory: False
2025-01-04 16:34:18,025 [trainer.py] => shuffle: False
2025-01-04 16:34:18,025 [trainer.py] => top_k: 5
2025-01-04 16:34:18,025 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:34:18,025 [trainer.py] => prefix: asp
2025-01-04 16:34:18,025 [trainer.py] => model_prefix: asp
2025-01-04 16:34:20,007 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:38:50,432 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:38:50,432 [trainer.py] => model_name: asp
2025-01-04 16:38:50,432 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:38:50,432 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:38:50,432 [trainer.py] => seed: 2024
2025-01-04 16:38:50,432 [trainer.py] => dataset: cifar224
2025-01-04 16:38:50,432 [trainer.py] => init_cls: 60
2025-01-04 16:38:50,432 [trainer.py] => increment: 5
2025-01-04 16:38:50,432 [trainer.py] => kshot: 5
2025-01-04 16:38:50,432 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:38:50,432 [trainer.py] => z_dim: 1000
2025-01-04 16:38:50,432 [trainer.py] => conv_dim: 64
2025-01-04 16:38:50,432 [trainer.py] => img_size: 224
2025-01-04 16:38:50,432 [trainer.py] => generator_lr: 0.005
2025-01-04 16:38:50,432 [trainer.py] => pi: 100
2025-01-04 16:38:50,432 [trainer.py] => w_bn: 50.0
2025-01-04 16:38:50,432 [trainer.py] => w_noise: 0.001
2025-01-04 16:38:50,432 [trainer.py] => server_ss: 32
2025-01-04 16:38:50,432 [trainer.py] => bn_loss: 1
2025-01-04 16:38:50,432 [trainer.py] => noise: 1
2025-01-04 16:38:50,432 [trainer.py] => ie_loss: 1
2025-01-04 16:38:50,432 [trainer.py] => act_loss: 0
2025-01-04 16:38:50,433 [trainer.py] => w_ie: 1.0
2025-01-04 16:38:50,433 [trainer.py] => w_act: 0.1
2025-01-04 16:38:50,433 [trainer.py] => syn_size: 32
2025-01-04 16:38:50,433 [trainer.py] => need_syn_imgs: True
2025-01-04 16:38:50,433 [trainer.py] => g_local_bs: 12
2025-01-04 16:38:50,433 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:38:50,433 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:38:50,433 [trainer.py] => vpt_type: Deep
2025-01-04 16:38:50,433 [trainer.py] => prompt_token_num: 6
2025-01-04 16:38:50,433 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:38:50,433 [trainer.py] => perturb_var: 1
2025-01-04 16:38:50,433 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:38:50,433 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:38:50,433 [trainer.py] => kl_weight: 0.001
2025-01-04 16:38:50,433 [trainer.py] => TIP_init: zero
2025-01-04 16:38:50,433 [trainer.py] => tuned_epoch: 10
2025-01-04 16:38:50,433 [trainer.py] => fs_epoch: 0
2025-01-04 16:38:50,433 [trainer.py] => init_lr: 0.01
2025-01-04 16:38:50,433 [trainer.py] => fs_lr: 0.001
2025-01-04 16:38:50,433 [trainer.py] => batch_size: 48
2025-01-04 16:38:50,433 [trainer.py] => fs_batch_size: 16
2025-01-04 16:38:50,433 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:38:50,433 [trainer.py] => min_lr: 0
2025-01-04 16:38:50,433 [trainer.py] => optimizer: sgd
2025-01-04 16:38:50,433 [trainer.py] => memory_size: 0
2025-01-04 16:38:50,433 [trainer.py] => memory_per_class: 0
2025-01-04 16:38:50,433 [trainer.py] => fixed_memory: False
2025-01-04 16:38:50,433 [trainer.py] => shuffle: False
2025-01-04 16:38:50,433 [trainer.py] => top_k: 5
2025-01-04 16:38:50,433 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:38:50,433 [trainer.py] => prefix: asp
2025-01-04 16:38:50,433 [trainer.py] => model_prefix: asp
2025-01-04 16:38:57,856 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:39:21,715 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:39:21,715 [trainer.py] => model_name: asp
2025-01-04 16:39:21,715 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:39:21,715 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:39:21,715 [trainer.py] => seed: 2024
2025-01-04 16:39:21,715 [trainer.py] => dataset: cifar224
2025-01-04 16:39:21,715 [trainer.py] => init_cls: 60
2025-01-04 16:39:21,715 [trainer.py] => increment: 5
2025-01-04 16:39:21,715 [trainer.py] => kshot: 5
2025-01-04 16:39:21,715 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:39:21,715 [trainer.py] => z_dim: 1000
2025-01-04 16:39:21,715 [trainer.py] => conv_dim: 64
2025-01-04 16:39:21,715 [trainer.py] => img_size: 224
2025-01-04 16:39:21,715 [trainer.py] => generator_lr: 0.005
2025-01-04 16:39:21,715 [trainer.py] => pi: 100
2025-01-04 16:39:21,715 [trainer.py] => w_bn: 50.0
2025-01-04 16:39:21,715 [trainer.py] => w_noise: 0.001
2025-01-04 16:39:21,715 [trainer.py] => server_ss: 32
2025-01-04 16:39:21,716 [trainer.py] => bn_loss: 1
2025-01-04 16:39:21,716 [trainer.py] => noise: 1
2025-01-04 16:39:21,716 [trainer.py] => ie_loss: 1
2025-01-04 16:39:21,716 [trainer.py] => act_loss: 0
2025-01-04 16:39:21,716 [trainer.py] => w_ie: 1.0
2025-01-04 16:39:21,716 [trainer.py] => w_act: 0.1
2025-01-04 16:39:21,716 [trainer.py] => syn_size: 32
2025-01-04 16:39:21,716 [trainer.py] => need_syn_imgs: True
2025-01-04 16:39:21,716 [trainer.py] => g_local_bs: 12
2025-01-04 16:39:21,716 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:39:21,716 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:39:21,716 [trainer.py] => vpt_type: Deep
2025-01-04 16:39:21,716 [trainer.py] => prompt_token_num: 6
2025-01-04 16:39:21,716 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:39:21,716 [trainer.py] => perturb_var: 1
2025-01-04 16:39:21,716 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:39:21,716 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:39:21,716 [trainer.py] => kl_weight: 0.001
2025-01-04 16:39:21,716 [trainer.py] => TIP_init: zero
2025-01-04 16:39:21,716 [trainer.py] => tuned_epoch: 10
2025-01-04 16:39:21,716 [trainer.py] => fs_epoch: 0
2025-01-04 16:39:21,716 [trainer.py] => init_lr: 0.01
2025-01-04 16:39:21,717 [trainer.py] => fs_lr: 0.001
2025-01-04 16:39:21,717 [trainer.py] => batch_size: 48
2025-01-04 16:39:21,717 [trainer.py] => fs_batch_size: 16
2025-01-04 16:39:21,717 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:39:21,717 [trainer.py] => min_lr: 0
2025-01-04 16:39:21,717 [trainer.py] => optimizer: sgd
2025-01-04 16:39:21,717 [trainer.py] => memory_size: 0
2025-01-04 16:39:21,717 [trainer.py] => memory_per_class: 0
2025-01-04 16:39:21,717 [trainer.py] => fixed_memory: False
2025-01-04 16:39:21,717 [trainer.py] => shuffle: False
2025-01-04 16:39:21,717 [trainer.py] => top_k: 5
2025-01-04 16:39:21,717 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:39:21,717 [trainer.py] => prefix: asp
2025-01-04 16:39:21,717 [trainer.py] => model_prefix: asp
2025-01-04 16:39:23,590 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:42:35,722 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:42:35,722 [trainer.py] => model_name: asp
2025-01-04 16:42:35,722 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:42:35,722 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:42:35,722 [trainer.py] => seed: 2024
2025-01-04 16:42:35,722 [trainer.py] => dataset: cifar224
2025-01-04 16:42:35,722 [trainer.py] => init_cls: 60
2025-01-04 16:42:35,722 [trainer.py] => increment: 5
2025-01-04 16:42:35,722 [trainer.py] => kshot: 5
2025-01-04 16:42:35,722 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:42:35,722 [trainer.py] => z_dim: 1000
2025-01-04 16:42:35,722 [trainer.py] => conv_dim: 64
2025-01-04 16:42:35,722 [trainer.py] => img_size: 224
2025-01-04 16:42:35,722 [trainer.py] => generator_lr: 0.005
2025-01-04 16:42:35,723 [trainer.py] => pi: 100
2025-01-04 16:42:35,723 [trainer.py] => w_bn: 50.0
2025-01-04 16:42:35,723 [trainer.py] => w_noise: 0.001
2025-01-04 16:42:35,723 [trainer.py] => server_ss: 32
2025-01-04 16:42:35,723 [trainer.py] => bn_loss: 1
2025-01-04 16:42:35,723 [trainer.py] => noise: 1
2025-01-04 16:42:35,723 [trainer.py] => ie_loss: 1
2025-01-04 16:42:35,723 [trainer.py] => act_loss: 0
2025-01-04 16:42:35,723 [trainer.py] => w_ie: 1.0
2025-01-04 16:42:35,723 [trainer.py] => w_act: 0.1
2025-01-04 16:42:35,723 [trainer.py] => syn_size: 32
2025-01-04 16:42:35,723 [trainer.py] => need_syn_imgs: True
2025-01-04 16:42:35,723 [trainer.py] => g_local_bs: 12
2025-01-04 16:42:35,723 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:42:35,723 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:42:35,723 [trainer.py] => vpt_type: Deep
2025-01-04 16:42:35,723 [trainer.py] => prompt_token_num: 6
2025-01-04 16:42:35,723 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:42:35,723 [trainer.py] => perturb_var: 1
2025-01-04 16:42:35,723 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:42:35,723 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:42:35,723 [trainer.py] => kl_weight: 0.001
2025-01-04 16:42:35,723 [trainer.py] => TIP_init: zero
2025-01-04 16:42:35,723 [trainer.py] => tuned_epoch: 10
2025-01-04 16:42:35,723 [trainer.py] => fs_epoch: 0
2025-01-04 16:42:35,723 [trainer.py] => init_lr: 0.01
2025-01-04 16:42:35,723 [trainer.py] => fs_lr: 0.001
2025-01-04 16:42:35,723 [trainer.py] => batch_size: 48
2025-01-04 16:42:35,724 [trainer.py] => fs_batch_size: 16
2025-01-04 16:42:35,724 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:42:35,724 [trainer.py] => min_lr: 0
2025-01-04 16:42:35,724 [trainer.py] => optimizer: sgd
2025-01-04 16:42:35,724 [trainer.py] => memory_size: 0
2025-01-04 16:42:35,724 [trainer.py] => memory_per_class: 0
2025-01-04 16:42:35,724 [trainer.py] => fixed_memory: False
2025-01-04 16:42:35,724 [trainer.py] => shuffle: False
2025-01-04 16:42:35,724 [trainer.py] => top_k: 5
2025-01-04 16:42:35,724 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:42:35,724 [trainer.py] => prefix: asp
2025-01-04 16:42:35,724 [trainer.py] => model_prefix: asp
2025-01-04 16:42:37,716 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:44:43,999 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:44:43,999 [trainer.py] => model_name: asp
2025-01-04 16:44:43,999 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:44:43,999 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:44:43,999 [trainer.py] => seed: 2024
2025-01-04 16:44:43,999 [trainer.py] => dataset: cifar224
2025-01-04 16:44:43,999 [trainer.py] => init_cls: 60
2025-01-04 16:44:43,999 [trainer.py] => increment: 5
2025-01-04 16:44:44,000 [trainer.py] => kshot: 5
2025-01-04 16:44:44,000 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:44:44,000 [trainer.py] => z_dim: 1000
2025-01-04 16:44:44,000 [trainer.py] => conv_dim: 64
2025-01-04 16:44:44,000 [trainer.py] => img_size: 224
2025-01-04 16:44:44,000 [trainer.py] => generator_lr: 0.005
2025-01-04 16:44:44,000 [trainer.py] => pi: 100
2025-01-04 16:44:44,000 [trainer.py] => w_bn: 50.0
2025-01-04 16:44:44,000 [trainer.py] => w_noise: 0.001
2025-01-04 16:44:44,000 [trainer.py] => server_ss: 32
2025-01-04 16:44:44,000 [trainer.py] => bn_loss: 1
2025-01-04 16:44:44,000 [trainer.py] => noise: 1
2025-01-04 16:44:44,000 [trainer.py] => ie_loss: 1
2025-01-04 16:44:44,000 [trainer.py] => act_loss: 0
2025-01-04 16:44:44,000 [trainer.py] => w_ie: 1.0
2025-01-04 16:44:44,000 [trainer.py] => w_act: 0.1
2025-01-04 16:44:44,000 [trainer.py] => syn_size: 32
2025-01-04 16:44:44,000 [trainer.py] => need_syn_imgs: True
2025-01-04 16:44:44,000 [trainer.py] => g_local_bs: 12
2025-01-04 16:44:44,000 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:44:44,000 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:44:44,000 [trainer.py] => vpt_type: Deep
2025-01-04 16:44:44,000 [trainer.py] => prompt_token_num: 6
2025-01-04 16:44:44,000 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:44:44,000 [trainer.py] => perturb_var: 1
2025-01-04 16:44:44,000 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:44:44,000 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:44:44,000 [trainer.py] => kl_weight: 0.001
2025-01-04 16:44:44,000 [trainer.py] => TIP_init: zero
2025-01-04 16:44:44,000 [trainer.py] => tuned_epoch: 10
2025-01-04 16:44:44,000 [trainer.py] => fs_epoch: 0
2025-01-04 16:44:44,000 [trainer.py] => init_lr: 0.01
2025-01-04 16:44:44,000 [trainer.py] => fs_lr: 0.001
2025-01-04 16:44:44,000 [trainer.py] => batch_size: 48
2025-01-04 16:44:44,001 [trainer.py] => fs_batch_size: 16
2025-01-04 16:44:44,001 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:44:44,001 [trainer.py] => min_lr: 0
2025-01-04 16:44:44,001 [trainer.py] => optimizer: sgd
2025-01-04 16:44:44,001 [trainer.py] => memory_size: 0
2025-01-04 16:44:44,001 [trainer.py] => memory_per_class: 0
2025-01-04 16:44:44,001 [trainer.py] => fixed_memory: False
2025-01-04 16:44:44,001 [trainer.py] => shuffle: False
2025-01-04 16:44:44,001 [trainer.py] => top_k: 5
2025-01-04 16:44:44,001 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:44:44,001 [trainer.py] => prefix: asp
2025-01-04 16:44:44,001 [trainer.py] => model_prefix: asp
2025-01-04 16:44:46,036 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:45:07,666 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:45:07,666 [trainer.py] => model_name: asp
2025-01-04 16:45:07,666 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:45:07,666 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:45:07,666 [trainer.py] => seed: 2024
2025-01-04 16:45:07,666 [trainer.py] => dataset: cifar224
2025-01-04 16:45:07,666 [trainer.py] => init_cls: 60
2025-01-04 16:45:07,666 [trainer.py] => increment: 5
2025-01-04 16:45:07,667 [trainer.py] => kshot: 5
2025-01-04 16:45:07,667 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:45:07,667 [trainer.py] => z_dim: 1000
2025-01-04 16:45:07,667 [trainer.py] => conv_dim: 64
2025-01-04 16:45:07,667 [trainer.py] => img_size: 224
2025-01-04 16:45:07,667 [trainer.py] => generator_lr: 0.005
2025-01-04 16:45:07,667 [trainer.py] => pi: 100
2025-01-04 16:45:07,667 [trainer.py] => w_bn: 50.0
2025-01-04 16:45:07,667 [trainer.py] => w_noise: 0.001
2025-01-04 16:45:07,667 [trainer.py] => server_ss: 32
2025-01-04 16:45:07,667 [trainer.py] => bn_loss: 1
2025-01-04 16:45:07,667 [trainer.py] => noise: 1
2025-01-04 16:45:07,667 [trainer.py] => ie_loss: 1
2025-01-04 16:45:07,667 [trainer.py] => act_loss: 0
2025-01-04 16:45:07,667 [trainer.py] => w_ie: 1.0
2025-01-04 16:45:07,667 [trainer.py] => w_act: 0.1
2025-01-04 16:45:07,667 [trainer.py] => syn_size: 32
2025-01-04 16:45:07,667 [trainer.py] => need_syn_imgs: True
2025-01-04 16:45:07,667 [trainer.py] => g_local_bs: 12
2025-01-04 16:45:07,667 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:45:07,667 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:45:07,667 [trainer.py] => vpt_type: Deep
2025-01-04 16:45:07,667 [trainer.py] => prompt_token_num: 6
2025-01-04 16:45:07,667 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:45:07,667 [trainer.py] => perturb_var: 1
2025-01-04 16:45:07,667 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:45:07,667 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:45:07,668 [trainer.py] => kl_weight: 0.001
2025-01-04 16:45:07,668 [trainer.py] => TIP_init: zero
2025-01-04 16:45:07,668 [trainer.py] => tuned_epoch: 10
2025-01-04 16:45:07,668 [trainer.py] => fs_epoch: 0
2025-01-04 16:45:07,668 [trainer.py] => init_lr: 0.01
2025-01-04 16:45:07,668 [trainer.py] => fs_lr: 0.001
2025-01-04 16:45:07,668 [trainer.py] => batch_size: 48
2025-01-04 16:45:07,668 [trainer.py] => fs_batch_size: 16
2025-01-04 16:45:07,668 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:45:07,668 [trainer.py] => min_lr: 0
2025-01-04 16:45:07,668 [trainer.py] => optimizer: sgd
2025-01-04 16:45:07,668 [trainer.py] => memory_size: 0
2025-01-04 16:45:07,668 [trainer.py] => memory_per_class: 0
2025-01-04 16:45:07,668 [trainer.py] => fixed_memory: False
2025-01-04 16:45:07,668 [trainer.py] => shuffle: False
2025-01-04 16:45:07,668 [trainer.py] => top_k: 5
2025-01-04 16:45:07,668 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:45:07,668 [trainer.py] => prefix: asp
2025-01-04 16:45:07,668 [trainer.py] => model_prefix: asp
2025-01-04 16:45:09,683 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:45:53,199 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:45:53,199 [trainer.py] => model_name: asp
2025-01-04 16:45:53,199 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:45:53,199 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:45:53,199 [trainer.py] => seed: 2024
2025-01-04 16:45:53,199 [trainer.py] => dataset: cifar224
2025-01-04 16:45:53,199 [trainer.py] => init_cls: 60
2025-01-04 16:45:53,200 [trainer.py] => increment: 5
2025-01-04 16:45:53,200 [trainer.py] => kshot: 5
2025-01-04 16:45:53,200 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:45:53,200 [trainer.py] => z_dim: 1000
2025-01-04 16:45:53,200 [trainer.py] => conv_dim: 64
2025-01-04 16:45:53,200 [trainer.py] => img_size: 224
2025-01-04 16:45:53,200 [trainer.py] => generator_lr: 0.005
2025-01-04 16:45:53,200 [trainer.py] => pi: 100
2025-01-04 16:45:53,200 [trainer.py] => w_bn: 50.0
2025-01-04 16:45:53,200 [trainer.py] => w_noise: 0.001
2025-01-04 16:45:53,200 [trainer.py] => server_ss: 32
2025-01-04 16:45:53,200 [trainer.py] => bn_loss: 1
2025-01-04 16:45:53,200 [trainer.py] => noise: 1
2025-01-04 16:45:53,200 [trainer.py] => ie_loss: 1
2025-01-04 16:45:53,200 [trainer.py] => act_loss: 0
2025-01-04 16:45:53,200 [trainer.py] => w_ie: 1.0
2025-01-04 16:45:53,200 [trainer.py] => w_act: 0.1
2025-01-04 16:45:53,200 [trainer.py] => syn_size: 32
2025-01-04 16:45:53,201 [trainer.py] => need_syn_imgs: True
2025-01-04 16:45:53,201 [trainer.py] => g_local_bs: 12
2025-01-04 16:45:53,201 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:45:53,201 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:45:53,201 [trainer.py] => vpt_type: Deep
2025-01-04 16:45:53,201 [trainer.py] => prompt_token_num: 6
2025-01-04 16:45:53,201 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:45:53,201 [trainer.py] => perturb_var: 1
2025-01-04 16:45:53,201 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:45:53,201 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:45:53,201 [trainer.py] => kl_weight: 0.001
2025-01-04 16:45:53,201 [trainer.py] => TIP_init: zero
2025-01-04 16:45:53,201 [trainer.py] => tuned_epoch: 10
2025-01-04 16:45:53,201 [trainer.py] => fs_epoch: 0
2025-01-04 16:45:53,201 [trainer.py] => init_lr: 0.01
2025-01-04 16:45:53,201 [trainer.py] => fs_lr: 0.001
2025-01-04 16:45:53,201 [trainer.py] => batch_size: 48
2025-01-04 16:45:53,201 [trainer.py] => fs_batch_size: 16
2025-01-04 16:45:53,201 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:45:53,202 [trainer.py] => min_lr: 0
2025-01-04 16:45:53,202 [trainer.py] => optimizer: sgd
2025-01-04 16:45:53,202 [trainer.py] => memory_size: 0
2025-01-04 16:45:53,202 [trainer.py] => memory_per_class: 0
2025-01-04 16:45:53,202 [trainer.py] => fixed_memory: False
2025-01-04 16:45:53,202 [trainer.py] => shuffle: False
2025-01-04 16:45:53,202 [trainer.py] => top_k: 5
2025-01-04 16:45:53,202 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:45:53,202 [trainer.py] => prefix: asp
2025-01-04 16:45:53,202 [trainer.py] => model_prefix: asp
2025-01-04 16:45:55,227 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:52:13,469 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:52:13,469 [trainer.py] => model_name: asp
2025-01-04 16:52:13,469 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:52:13,469 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:52:13,469 [trainer.py] => seed: 2024
2025-01-04 16:52:13,469 [trainer.py] => dataset: cifar224
2025-01-04 16:52:13,469 [trainer.py] => init_cls: 60
2025-01-04 16:52:13,469 [trainer.py] => increment: 5
2025-01-04 16:52:13,469 [trainer.py] => kshot: 5
2025-01-04 16:52:13,469 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:52:13,469 [trainer.py] => z_dim: 1000
2025-01-04 16:52:13,469 [trainer.py] => conv_dim: 64
2025-01-04 16:52:13,469 [trainer.py] => img_size: 224
2025-01-04 16:52:13,469 [trainer.py] => generator_lr: 0.005
2025-01-04 16:52:13,469 [trainer.py] => pi: 100
2025-01-04 16:52:13,469 [trainer.py] => w_bn: 50.0
2025-01-04 16:52:13,469 [trainer.py] => w_noise: 0.001
2025-01-04 16:52:13,469 [trainer.py] => server_ss: 32
2025-01-04 16:52:13,470 [trainer.py] => bn_loss: 1
2025-01-04 16:52:13,470 [trainer.py] => noise: 1
2025-01-04 16:52:13,470 [trainer.py] => ie_loss: 1
2025-01-04 16:52:13,470 [trainer.py] => act_loss: 0
2025-01-04 16:52:13,470 [trainer.py] => w_ie: 1.0
2025-01-04 16:52:13,470 [trainer.py] => w_act: 0.1
2025-01-04 16:52:13,470 [trainer.py] => syn_size: 32
2025-01-04 16:52:13,470 [trainer.py] => need_syn_imgs: True
2025-01-04 16:52:13,470 [trainer.py] => g_local_bs: 12
2025-01-04 16:52:13,470 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:52:13,470 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:52:13,470 [trainer.py] => vpt_type: Deep
2025-01-04 16:52:13,470 [trainer.py] => prompt_token_num: 6
2025-01-04 16:52:13,470 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:52:13,470 [trainer.py] => perturb_var: 1
2025-01-04 16:52:13,470 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:52:13,470 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:52:13,470 [trainer.py] => kl_weight: 0.001
2025-01-04 16:52:13,470 [trainer.py] => TIP_init: zero
2025-01-04 16:52:13,470 [trainer.py] => tuned_epoch: 10
2025-01-04 16:52:13,470 [trainer.py] => fs_epoch: 0
2025-01-04 16:52:13,470 [trainer.py] => init_lr: 0.01
2025-01-04 16:52:13,470 [trainer.py] => fs_lr: 0.001
2025-01-04 16:52:13,470 [trainer.py] => batch_size: 48
2025-01-04 16:52:13,470 [trainer.py] => fs_batch_size: 16
2025-01-04 16:52:13,470 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:52:13,470 [trainer.py] => min_lr: 0
2025-01-04 16:52:13,470 [trainer.py] => optimizer: sgd
2025-01-04 16:52:13,470 [trainer.py] => memory_size: 0
2025-01-04 16:52:13,470 [trainer.py] => memory_per_class: 0
2025-01-04 16:52:13,470 [trainer.py] => fixed_memory: False
2025-01-04 16:52:13,470 [trainer.py] => shuffle: False
2025-01-04 16:52:13,470 [trainer.py] => top_k: 5
2025-01-04 16:52:13,470 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:52:13,471 [trainer.py] => prefix: asp
2025-01-04 16:52:13,471 [trainer.py] => model_prefix: asp
2025-01-04 16:52:15,638 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:52:46,999 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:52:47,000 [trainer.py] => model_name: asp
2025-01-04 16:52:47,000 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:52:47,000 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:52:47,000 [trainer.py] => seed: 2024
2025-01-04 16:52:47,000 [trainer.py] => dataset: cifar224
2025-01-04 16:52:47,001 [trainer.py] => init_cls: 60
2025-01-04 16:52:47,001 [trainer.py] => increment: 5
2025-01-04 16:52:47,001 [trainer.py] => kshot: 5
2025-01-04 16:52:47,001 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:52:47,001 [trainer.py] => z_dim: 1000
2025-01-04 16:52:47,001 [trainer.py] => conv_dim: 64
2025-01-04 16:52:47,001 [trainer.py] => img_size: 224
2025-01-04 16:52:47,001 [trainer.py] => generator_lr: 0.005
2025-01-04 16:52:47,001 [trainer.py] => pi: 100
2025-01-04 16:52:47,001 [trainer.py] => w_bn: 50.0
2025-01-04 16:52:47,002 [trainer.py] => w_noise: 0.001
2025-01-04 16:52:47,002 [trainer.py] => server_ss: 32
2025-01-04 16:52:47,002 [trainer.py] => bn_loss: 1
2025-01-04 16:52:47,002 [trainer.py] => noise: 1
2025-01-04 16:52:47,002 [trainer.py] => ie_loss: 1
2025-01-04 16:52:47,002 [trainer.py] => act_loss: 0
2025-01-04 16:52:47,002 [trainer.py] => w_ie: 1.0
2025-01-04 16:52:47,002 [trainer.py] => w_act: 0.1
2025-01-04 16:52:47,002 [trainer.py] => syn_size: 32
2025-01-04 16:52:47,002 [trainer.py] => need_syn_imgs: True
2025-01-04 16:52:47,002 [trainer.py] => g_local_bs: 12
2025-01-04 16:52:47,002 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:52:47,002 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:52:47,002 [trainer.py] => vpt_type: Deep
2025-01-04 16:52:47,002 [trainer.py] => prompt_token_num: 6
2025-01-04 16:52:47,002 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:52:47,002 [trainer.py] => perturb_var: 1
2025-01-04 16:52:47,002 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:52:47,003 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:52:47,003 [trainer.py] => kl_weight: 0.001
2025-01-04 16:52:47,003 [trainer.py] => TIP_init: zero
2025-01-04 16:52:47,003 [trainer.py] => tuned_epoch: 10
2025-01-04 16:52:47,003 [trainer.py] => fs_epoch: 0
2025-01-04 16:52:47,003 [trainer.py] => init_lr: 0.01
2025-01-04 16:52:47,003 [trainer.py] => fs_lr: 0.001
2025-01-04 16:52:47,003 [trainer.py] => batch_size: 48
2025-01-04 16:52:47,003 [trainer.py] => fs_batch_size: 16
2025-01-04 16:52:47,003 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:52:47,003 [trainer.py] => min_lr: 0
2025-01-04 16:52:47,003 [trainer.py] => optimizer: sgd
2025-01-04 16:52:47,003 [trainer.py] => memory_size: 0
2025-01-04 16:52:47,003 [trainer.py] => memory_per_class: 0
2025-01-04 16:52:47,003 [trainer.py] => fixed_memory: False
2025-01-04 16:52:47,003 [trainer.py] => shuffle: False
2025-01-04 16:52:47,003 [trainer.py] => top_k: 5
2025-01-04 16:52:47,003 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:52:47,003 [trainer.py] => prefix: asp
2025-01-04 16:52:47,003 [trainer.py] => model_prefix: asp
2025-01-04 16:52:49,109 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:56:42,861 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:56:42,861 [trainer.py] => model_name: asp
2025-01-04 16:56:42,861 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:56:42,861 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:56:42,861 [trainer.py] => seed: 2024
2025-01-04 16:56:42,861 [trainer.py] => dataset: cifar224
2025-01-04 16:56:42,861 [trainer.py] => init_cls: 60
2025-01-04 16:56:42,861 [trainer.py] => increment: 5
2025-01-04 16:56:42,861 [trainer.py] => kshot: 5
2025-01-04 16:56:42,861 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:56:42,861 [trainer.py] => z_dim: 1000
2025-01-04 16:56:42,861 [trainer.py] => conv_dim: 64
2025-01-04 16:56:42,862 [trainer.py] => img_size: 224
2025-01-04 16:56:42,862 [trainer.py] => generator_lr: 0.005
2025-01-04 16:56:42,862 [trainer.py] => pi: 100
2025-01-04 16:56:42,862 [trainer.py] => w_bn: 50.0
2025-01-04 16:56:42,862 [trainer.py] => w_noise: 0.001
2025-01-04 16:56:42,862 [trainer.py] => server_ss: 32
2025-01-04 16:56:42,862 [trainer.py] => bn_loss: 1
2025-01-04 16:56:42,862 [trainer.py] => noise: 1
2025-01-04 16:56:42,862 [trainer.py] => ie_loss: 1
2025-01-04 16:56:42,862 [trainer.py] => act_loss: 0
2025-01-04 16:56:42,862 [trainer.py] => w_ie: 1.0
2025-01-04 16:56:42,862 [trainer.py] => w_act: 0.1
2025-01-04 16:56:42,862 [trainer.py] => syn_size: 32
2025-01-04 16:56:42,862 [trainer.py] => need_syn_imgs: True
2025-01-04 16:56:42,862 [trainer.py] => g_local_bs: 12
2025-01-04 16:56:42,862 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:56:42,862 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:56:42,862 [trainer.py] => vpt_type: Deep
2025-01-04 16:56:42,862 [trainer.py] => prompt_token_num: 6
2025-01-04 16:56:42,862 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:56:42,862 [trainer.py] => perturb_var: 1
2025-01-04 16:56:42,862 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:56:42,862 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:56:42,862 [trainer.py] => kl_weight: 0.001
2025-01-04 16:56:42,862 [trainer.py] => TIP_init: zero
2025-01-04 16:56:42,862 [trainer.py] => tuned_epoch: 10
2025-01-04 16:56:42,862 [trainer.py] => fs_epoch: 0
2025-01-04 16:56:42,862 [trainer.py] => init_lr: 0.01
2025-01-04 16:56:42,863 [trainer.py] => fs_lr: 0.001
2025-01-04 16:56:42,863 [trainer.py] => batch_size: 48
2025-01-04 16:56:42,863 [trainer.py] => fs_batch_size: 16
2025-01-04 16:56:42,863 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:56:42,863 [trainer.py] => min_lr: 0
2025-01-04 16:56:42,863 [trainer.py] => optimizer: sgd
2025-01-04 16:56:42,863 [trainer.py] => memory_size: 0
2025-01-04 16:56:42,863 [trainer.py] => memory_per_class: 0
2025-01-04 16:56:42,863 [trainer.py] => fixed_memory: False
2025-01-04 16:56:42,863 [trainer.py] => shuffle: False
2025-01-04 16:56:42,863 [trainer.py] => top_k: 5
2025-01-04 16:56:42,863 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:56:42,863 [trainer.py] => prefix: asp
2025-01-04 16:56:42,863 [trainer.py] => model_prefix: asp
2025-01-04 16:56:44,523 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:57:50,522 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:57:50,522 [trainer.py] => model_name: asp
2025-01-04 16:57:50,522 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:57:50,522 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:57:50,522 [trainer.py] => seed: 2024
2025-01-04 16:57:50,522 [trainer.py] => dataset: cifar224
2025-01-04 16:57:50,522 [trainer.py] => init_cls: 60
2025-01-04 16:57:50,522 [trainer.py] => increment: 5
2025-01-04 16:57:50,522 [trainer.py] => kshot: 5
2025-01-04 16:57:50,522 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:57:50,522 [trainer.py] => z_dim: 1000
2025-01-04 16:57:50,522 [trainer.py] => conv_dim: 64
2025-01-04 16:57:50,522 [trainer.py] => img_size: 224
2025-01-04 16:57:50,522 [trainer.py] => generator_lr: 0.005
2025-01-04 16:57:50,522 [trainer.py] => pi: 100
2025-01-04 16:57:50,522 [trainer.py] => w_bn: 50.0
2025-01-04 16:57:50,522 [trainer.py] => w_noise: 0.001
2025-01-04 16:57:50,522 [trainer.py] => server_ss: 32
2025-01-04 16:57:50,522 [trainer.py] => bn_loss: 1
2025-01-04 16:57:50,522 [trainer.py] => noise: 1
2025-01-04 16:57:50,522 [trainer.py] => ie_loss: 1
2025-01-04 16:57:50,522 [trainer.py] => act_loss: 0
2025-01-04 16:57:50,522 [trainer.py] => w_ie: 1.0
2025-01-04 16:57:50,522 [trainer.py] => w_act: 0.1
2025-01-04 16:57:50,522 [trainer.py] => syn_size: 32
2025-01-04 16:57:50,522 [trainer.py] => need_syn_imgs: True
2025-01-04 16:57:50,522 [trainer.py] => g_local_bs: 12
2025-01-04 16:57:50,522 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:57:50,522 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:57:50,523 [trainer.py] => vpt_type: Deep
2025-01-04 16:57:50,523 [trainer.py] => prompt_token_num: 6
2025-01-04 16:57:50,523 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:57:50,523 [trainer.py] => perturb_var: 1
2025-01-04 16:57:50,523 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:57:50,523 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:57:50,523 [trainer.py] => kl_weight: 0.001
2025-01-04 16:57:50,523 [trainer.py] => TIP_init: zero
2025-01-04 16:57:50,523 [trainer.py] => tuned_epoch: 10
2025-01-04 16:57:50,523 [trainer.py] => fs_epoch: 0
2025-01-04 16:57:50,523 [trainer.py] => init_lr: 0.01
2025-01-04 16:57:50,523 [trainer.py] => fs_lr: 0.001
2025-01-04 16:57:50,523 [trainer.py] => batch_size: 48
2025-01-04 16:57:50,523 [trainer.py] => fs_batch_size: 16
2025-01-04 16:57:50,523 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:57:50,523 [trainer.py] => min_lr: 0
2025-01-04 16:57:50,523 [trainer.py] => optimizer: sgd
2025-01-04 16:57:50,523 [trainer.py] => memory_size: 0
2025-01-04 16:57:50,523 [trainer.py] => memory_per_class: 0
2025-01-04 16:57:50,523 [trainer.py] => fixed_memory: False
2025-01-04 16:57:50,523 [trainer.py] => shuffle: False
2025-01-04 16:57:50,523 [trainer.py] => top_k: 5
2025-01-04 16:57:50,523 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:57:50,523 [trainer.py] => prefix: asp
2025-01-04 16:57:50,523 [trainer.py] => model_prefix: asp
2025-01-04 16:57:52,189 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:58:10,531 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:58:10,531 [trainer.py] => model_name: asp
2025-01-04 16:58:10,531 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:58:10,532 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:58:10,532 [trainer.py] => seed: 2024
2025-01-04 16:58:10,532 [trainer.py] => dataset: cifar224
2025-01-04 16:58:10,532 [trainer.py] => init_cls: 60
2025-01-04 16:58:10,532 [trainer.py] => increment: 5
2025-01-04 16:58:10,532 [trainer.py] => kshot: 5
2025-01-04 16:58:10,532 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:58:10,532 [trainer.py] => z_dim: 1000
2025-01-04 16:58:10,532 [trainer.py] => conv_dim: 64
2025-01-04 16:58:10,532 [trainer.py] => img_size: 224
2025-01-04 16:58:10,532 [trainer.py] => generator_lr: 0.005
2025-01-04 16:58:10,532 [trainer.py] => pi: 100
2025-01-04 16:58:10,532 [trainer.py] => w_bn: 50.0
2025-01-04 16:58:10,532 [trainer.py] => w_noise: 0.001
2025-01-04 16:58:10,532 [trainer.py] => server_ss: 32
2025-01-04 16:58:10,532 [trainer.py] => bn_loss: 1
2025-01-04 16:58:10,532 [trainer.py] => noise: 1
2025-01-04 16:58:10,532 [trainer.py] => ie_loss: 1
2025-01-04 16:58:10,532 [trainer.py] => act_loss: 0
2025-01-04 16:58:10,532 [trainer.py] => w_ie: 1.0
2025-01-04 16:58:10,532 [trainer.py] => w_act: 0.1
2025-01-04 16:58:10,532 [trainer.py] => syn_size: 32
2025-01-04 16:58:10,532 [trainer.py] => need_syn_imgs: True
2025-01-04 16:58:10,532 [trainer.py] => g_local_bs: 12
2025-01-04 16:58:10,532 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:58:10,532 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:58:10,532 [trainer.py] => vpt_type: Deep
2025-01-04 16:58:10,532 [trainer.py] => prompt_token_num: 6
2025-01-04 16:58:10,532 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:58:10,532 [trainer.py] => perturb_var: 1
2025-01-04 16:58:10,532 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:58:10,533 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:58:10,533 [trainer.py] => kl_weight: 0.001
2025-01-04 16:58:10,533 [trainer.py] => TIP_init: zero
2025-01-04 16:58:10,533 [trainer.py] => tuned_epoch: 10
2025-01-04 16:58:10,533 [trainer.py] => fs_epoch: 0
2025-01-04 16:58:10,533 [trainer.py] => init_lr: 0.01
2025-01-04 16:58:10,533 [trainer.py] => fs_lr: 0.001
2025-01-04 16:58:10,533 [trainer.py] => batch_size: 48
2025-01-04 16:58:10,533 [trainer.py] => fs_batch_size: 16
2025-01-04 16:58:10,533 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:58:10,533 [trainer.py] => min_lr: 0
2025-01-04 16:58:10,533 [trainer.py] => optimizer: sgd
2025-01-04 16:58:10,533 [trainer.py] => memory_size: 0
2025-01-04 16:58:10,533 [trainer.py] => memory_per_class: 0
2025-01-04 16:58:10,533 [trainer.py] => fixed_memory: False
2025-01-04 16:58:10,533 [trainer.py] => shuffle: False
2025-01-04 16:58:10,533 [trainer.py] => top_k: 5
2025-01-04 16:58:10,533 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:58:10,533 [trainer.py] => prefix: asp
2025-01-04 16:58:10,533 [trainer.py] => model_prefix: asp
2025-01-04 16:58:12,243 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:58:27,867 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:58:27,867 [trainer.py] => model_name: asp
2025-01-04 16:58:27,867 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:58:27,867 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:58:27,867 [trainer.py] => seed: 2024
2025-01-04 16:58:27,867 [trainer.py] => dataset: cifar224
2025-01-04 16:58:27,867 [trainer.py] => init_cls: 60
2025-01-04 16:58:27,867 [trainer.py] => increment: 5
2025-01-04 16:58:27,867 [trainer.py] => kshot: 5
2025-01-04 16:58:27,867 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:58:27,867 [trainer.py] => z_dim: 1000
2025-01-04 16:58:27,867 [trainer.py] => conv_dim: 64
2025-01-04 16:58:27,867 [trainer.py] => img_size: 224
2025-01-04 16:58:27,867 [trainer.py] => generator_lr: 0.005
2025-01-04 16:58:27,867 [trainer.py] => pi: 100
2025-01-04 16:58:27,867 [trainer.py] => w_bn: 50.0
2025-01-04 16:58:27,867 [trainer.py] => w_noise: 0.001
2025-01-04 16:58:27,867 [trainer.py] => server_ss: 32
2025-01-04 16:58:27,867 [trainer.py] => bn_loss: 1
2025-01-04 16:58:27,867 [trainer.py] => noise: 1
2025-01-04 16:58:27,867 [trainer.py] => ie_loss: 1
2025-01-04 16:58:27,867 [trainer.py] => act_loss: 0
2025-01-04 16:58:27,867 [trainer.py] => w_ie: 1.0
2025-01-04 16:58:27,868 [trainer.py] => w_act: 0.1
2025-01-04 16:58:27,868 [trainer.py] => syn_size: 32
2025-01-04 16:58:27,868 [trainer.py] => need_syn_imgs: True
2025-01-04 16:58:27,868 [trainer.py] => g_local_bs: 12
2025-01-04 16:58:27,868 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:58:27,868 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:58:27,868 [trainer.py] => vpt_type: Deep
2025-01-04 16:58:27,868 [trainer.py] => prompt_token_num: 6
2025-01-04 16:58:27,868 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:58:27,868 [trainer.py] => perturb_var: 1
2025-01-04 16:58:27,868 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:58:27,868 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:58:27,868 [trainer.py] => kl_weight: 0.001
2025-01-04 16:58:27,868 [trainer.py] => TIP_init: zero
2025-01-04 16:58:27,868 [trainer.py] => tuned_epoch: 10
2025-01-04 16:58:27,868 [trainer.py] => fs_epoch: 0
2025-01-04 16:58:27,868 [trainer.py] => init_lr: 0.01
2025-01-04 16:58:27,868 [trainer.py] => fs_lr: 0.001
2025-01-04 16:58:27,868 [trainer.py] => batch_size: 48
2025-01-04 16:58:27,868 [trainer.py] => fs_batch_size: 16
2025-01-04 16:58:27,868 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:58:27,868 [trainer.py] => min_lr: 0
2025-01-04 16:58:27,868 [trainer.py] => optimizer: sgd
2025-01-04 16:58:27,868 [trainer.py] => memory_size: 0
2025-01-04 16:58:27,868 [trainer.py] => memory_per_class: 0
2025-01-04 16:58:27,868 [trainer.py] => fixed_memory: False
2025-01-04 16:58:27,868 [trainer.py] => shuffle: False
2025-01-04 16:58:27,868 [trainer.py] => top_k: 5
2025-01-04 16:58:27,868 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:58:27,868 [trainer.py] => prefix: asp
2025-01-04 16:58:27,868 [trainer.py] => model_prefix: asp
2025-01-04 16:58:29,529 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 16:59:49,436 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 16:59:49,436 [trainer.py] => model_name: asp
2025-01-04 16:59:49,436 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 16:59:49,436 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 16:59:49,436 [trainer.py] => seed: 2024
2025-01-04 16:59:49,436 [trainer.py] => dataset: cifar224
2025-01-04 16:59:49,436 [trainer.py] => init_cls: 60
2025-01-04 16:59:49,437 [trainer.py] => increment: 5
2025-01-04 16:59:49,437 [trainer.py] => kshot: 5
2025-01-04 16:59:49,437 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 16:59:49,437 [trainer.py] => z_dim: 1000
2025-01-04 16:59:49,437 [trainer.py] => conv_dim: 64
2025-01-04 16:59:49,437 [trainer.py] => img_size: 224
2025-01-04 16:59:49,437 [trainer.py] => generator_lr: 0.005
2025-01-04 16:59:49,437 [trainer.py] => pi: 100
2025-01-04 16:59:49,437 [trainer.py] => w_bn: 50.0
2025-01-04 16:59:49,437 [trainer.py] => w_noise: 0.001
2025-01-04 16:59:49,437 [trainer.py] => server_ss: 32
2025-01-04 16:59:49,437 [trainer.py] => bn_loss: 1
2025-01-04 16:59:49,437 [trainer.py] => noise: 1
2025-01-04 16:59:49,437 [trainer.py] => ie_loss: 1
2025-01-04 16:59:49,437 [trainer.py] => act_loss: 0
2025-01-04 16:59:49,437 [trainer.py] => w_ie: 1.0
2025-01-04 16:59:49,437 [trainer.py] => w_act: 0.1
2025-01-04 16:59:49,437 [trainer.py] => syn_size: 32
2025-01-04 16:59:49,437 [trainer.py] => need_syn_imgs: True
2025-01-04 16:59:49,437 [trainer.py] => g_local_bs: 12
2025-01-04 16:59:49,437 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 16:59:49,437 [trainer.py] => g_local_train_steps: 50
2025-01-04 16:59:49,437 [trainer.py] => vpt_type: Deep
2025-01-04 16:59:49,437 [trainer.py] => prompt_token_num: 6
2025-01-04 16:59:49,437 [trainer.py] => avg_alpha: 0.8
2025-01-04 16:59:49,437 [trainer.py] => perturb_var: 1
2025-01-04 16:59:49,437 [trainer.py] => EMA_beta: 0.99
2025-01-04 16:59:49,437 [trainer.py] => anchor_lambda: 0.1
2025-01-04 16:59:49,437 [trainer.py] => kl_weight: 0.001
2025-01-04 16:59:49,437 [trainer.py] => TIP_init: zero
2025-01-04 16:59:49,437 [trainer.py] => tuned_epoch: 10
2025-01-04 16:59:49,437 [trainer.py] => fs_epoch: 0
2025-01-04 16:59:49,437 [trainer.py] => init_lr: 0.01
2025-01-04 16:59:49,437 [trainer.py] => fs_lr: 0.001
2025-01-04 16:59:49,438 [trainer.py] => batch_size: 48
2025-01-04 16:59:49,438 [trainer.py] => fs_batch_size: 16
2025-01-04 16:59:49,438 [trainer.py] => weight_decay: 0.0005
2025-01-04 16:59:49,438 [trainer.py] => min_lr: 0
2025-01-04 16:59:49,438 [trainer.py] => optimizer: sgd
2025-01-04 16:59:49,438 [trainer.py] => memory_size: 0
2025-01-04 16:59:49,438 [trainer.py] => memory_per_class: 0
2025-01-04 16:59:49,438 [trainer.py] => fixed_memory: False
2025-01-04 16:59:49,438 [trainer.py] => shuffle: False
2025-01-04 16:59:49,438 [trainer.py] => top_k: 5
2025-01-04 16:59:49,438 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 16:59:49,438 [trainer.py] => prefix: asp
2025-01-04 16:59:49,438 [trainer.py] => model_prefix: asp
2025-01-04 16:59:51,126 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:04:16,241 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:04:16,241 [trainer.py] => model_name: asp
2025-01-04 17:04:16,241 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:04:16,241 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:04:16,242 [trainer.py] => seed: 2024
2025-01-04 17:04:16,242 [trainer.py] => dataset: cifar224
2025-01-04 17:04:16,242 [trainer.py] => init_cls: 60
2025-01-04 17:04:16,242 [trainer.py] => increment: 5
2025-01-04 17:04:16,242 [trainer.py] => kshot: 5
2025-01-04 17:04:16,242 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:04:16,242 [trainer.py] => z_dim: 1000
2025-01-04 17:04:16,242 [trainer.py] => conv_dim: 64
2025-01-04 17:04:16,242 [trainer.py] => img_size: 224
2025-01-04 17:04:16,242 [trainer.py] => generator_lr: 0.005
2025-01-04 17:04:16,242 [trainer.py] => pi: 100
2025-01-04 17:04:16,242 [trainer.py] => w_bn: 50.0
2025-01-04 17:04:16,242 [trainer.py] => w_noise: 0.001
2025-01-04 17:04:16,242 [trainer.py] => server_ss: 32
2025-01-04 17:04:16,242 [trainer.py] => bn_loss: 1
2025-01-04 17:04:16,242 [trainer.py] => noise: 1
2025-01-04 17:04:16,242 [trainer.py] => ie_loss: 1
2025-01-04 17:04:16,242 [trainer.py] => act_loss: 0
2025-01-04 17:04:16,242 [trainer.py] => w_ie: 1.0
2025-01-04 17:04:16,242 [trainer.py] => w_act: 0.1
2025-01-04 17:04:16,242 [trainer.py] => syn_size: 32
2025-01-04 17:04:16,242 [trainer.py] => need_syn_imgs: True
2025-01-04 17:04:16,242 [trainer.py] => g_local_bs: 12
2025-01-04 17:04:16,242 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:04:16,242 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:04:16,242 [trainer.py] => vpt_type: Deep
2025-01-04 17:04:16,242 [trainer.py] => prompt_token_num: 6
2025-01-04 17:04:16,242 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:04:16,242 [trainer.py] => perturb_var: 1
2025-01-04 17:04:16,242 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:04:16,242 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:04:16,242 [trainer.py] => kl_weight: 0.001
2025-01-04 17:04:16,242 [trainer.py] => TIP_init: zero
2025-01-04 17:04:16,242 [trainer.py] => tuned_epoch: 10
2025-01-04 17:04:16,243 [trainer.py] => fs_epoch: 0
2025-01-04 17:04:16,243 [trainer.py] => init_lr: 0.01
2025-01-04 17:04:16,243 [trainer.py] => fs_lr: 0.001
2025-01-04 17:04:16,243 [trainer.py] => batch_size: 48
2025-01-04 17:04:16,243 [trainer.py] => fs_batch_size: 16
2025-01-04 17:04:16,243 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:04:16,243 [trainer.py] => min_lr: 0
2025-01-04 17:04:16,243 [trainer.py] => optimizer: sgd
2025-01-04 17:04:16,243 [trainer.py] => memory_size: 0
2025-01-04 17:04:16,243 [trainer.py] => memory_per_class: 0
2025-01-04 17:04:16,243 [trainer.py] => fixed_memory: False
2025-01-04 17:04:16,243 [trainer.py] => shuffle: False
2025-01-04 17:04:16,243 [trainer.py] => top_k: 5
2025-01-04 17:04:16,243 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:04:16,243 [trainer.py] => prefix: asp
2025-01-04 17:04:16,243 [trainer.py] => model_prefix: asp
2025-01-04 17:04:17,981 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:19:29,298 [trainer.py] => All params: 173596160
2025-01-04 17:19:29,300 [trainer.py] => Trainable params: 1998848
2025-01-04 17:19:29,874 [asp.py] => Learning on 0-60
2025-01-04 17:19:30,070 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:25:08,373 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:25:08,373 [trainer.py] => model_name: asp
2025-01-04 17:25:08,373 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:25:08,373 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:25:08,373 [trainer.py] => seed: 2024
2025-01-04 17:25:08,373 [trainer.py] => dataset: cifar224
2025-01-04 17:25:08,373 [trainer.py] => init_cls: 60
2025-01-04 17:25:08,373 [trainer.py] => increment: 5
2025-01-04 17:25:08,373 [trainer.py] => kshot: 5
2025-01-04 17:25:08,373 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:25:08,373 [trainer.py] => z_dim: 1000
2025-01-04 17:25:08,373 [trainer.py] => conv_dim: 64
2025-01-04 17:25:08,373 [trainer.py] => img_size: 224
2025-01-04 17:25:08,373 [trainer.py] => generator_lr: 0.005
2025-01-04 17:25:08,373 [trainer.py] => pi: 100
2025-01-04 17:25:08,373 [trainer.py] => w_bn: 50.0
2025-01-04 17:25:08,373 [trainer.py] => w_noise: 0.001
2025-01-04 17:25:08,373 [trainer.py] => server_ss: 32
2025-01-04 17:25:08,373 [trainer.py] => bn_loss: 1
2025-01-04 17:25:08,373 [trainer.py] => noise: 1
2025-01-04 17:25:08,373 [trainer.py] => ie_loss: 1
2025-01-04 17:25:08,373 [trainer.py] => act_loss: 0
2025-01-04 17:25:08,374 [trainer.py] => w_ie: 1.0
2025-01-04 17:25:08,374 [trainer.py] => w_act: 0.1
2025-01-04 17:25:08,374 [trainer.py] => syn_size: 32
2025-01-04 17:25:08,374 [trainer.py] => need_syn_imgs: True
2025-01-04 17:25:08,374 [trainer.py] => g_local_bs: 12
2025-01-04 17:25:08,374 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:25:08,375 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:25:08,375 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:25:08,375 [trainer.py] => vpt_type: Deep
2025-01-04 17:25:08,375 [trainer.py] => prompt_token_num: 6
2025-01-04 17:25:08,375 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:25:08,375 [trainer.py] => perturb_var: 1
2025-01-04 17:25:08,375 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:25:08,375 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:25:08,376 [trainer.py] => kl_weight: 0.001
2025-01-04 17:25:08,376 [trainer.py] => TIP_init: zero
2025-01-04 17:25:08,376 [trainer.py] => tuned_epoch: 10
2025-01-04 17:25:08,376 [trainer.py] => fs_epoch: 0
2025-01-04 17:25:08,376 [trainer.py] => init_lr: 0.01
2025-01-04 17:25:08,376 [trainer.py] => fs_lr: 0.001
2025-01-04 17:25:08,376 [trainer.py] => batch_size: 48
2025-01-04 17:25:08,377 [trainer.py] => fs_batch_size: 16
2025-01-04 17:25:08,377 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:25:08,377 [trainer.py] => min_lr: 0
2025-01-04 17:25:08,377 [trainer.py] => optimizer: sgd
2025-01-04 17:25:08,377 [trainer.py] => memory_size: 0
2025-01-04 17:25:08,377 [trainer.py] => memory_per_class: 0
2025-01-04 17:25:08,377 [trainer.py] => fixed_memory: False
2025-01-04 17:25:08,377 [trainer.py] => shuffle: False
2025-01-04 17:25:08,377 [trainer.py] => top_k: 5
2025-01-04 17:25:08,377 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:25:08,377 [trainer.py] => prefix: asp
2025-01-04 17:25:08,377 [trainer.py] => model_prefix: asp
2025-01-04 17:25:10,334 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:27:16,832 [trainer.py] => All params: 173596160
2025-01-04 17:27:16,834 [trainer.py] => Trainable params: 1998848
2025-01-04 17:27:17,052 [asp.py] => Learning on 0-60
2025-01-04 17:27:17,161 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:28:21,645 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:28:21,645 [trainer.py] => model_name: asp
2025-01-04 17:28:21,645 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:28:21,645 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:28:21,645 [trainer.py] => seed: 2024
2025-01-04 17:28:21,645 [trainer.py] => dataset: cifar224
2025-01-04 17:28:21,645 [trainer.py] => init_cls: 60
2025-01-04 17:28:21,645 [trainer.py] => increment: 5
2025-01-04 17:28:21,645 [trainer.py] => kshot: 5
2025-01-04 17:28:21,645 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:28:21,645 [trainer.py] => z_dim: 1000
2025-01-04 17:28:21,645 [trainer.py] => conv_dim: 64
2025-01-04 17:28:21,645 [trainer.py] => img_size: 224
2025-01-04 17:28:21,646 [trainer.py] => generator_lr: 0.005
2025-01-04 17:28:21,646 [trainer.py] => pi: 100
2025-01-04 17:28:21,646 [trainer.py] => w_bn: 50.0
2025-01-04 17:28:21,646 [trainer.py] => w_noise: 0.001
2025-01-04 17:28:21,646 [trainer.py] => server_ss: 32
2025-01-04 17:28:21,646 [trainer.py] => bn_loss: 1
2025-01-04 17:28:21,646 [trainer.py] => noise: 1
2025-01-04 17:28:21,646 [trainer.py] => ie_loss: 1
2025-01-04 17:28:21,646 [trainer.py] => act_loss: 0
2025-01-04 17:28:21,646 [trainer.py] => w_ie: 1.0
2025-01-04 17:28:21,646 [trainer.py] => w_act: 0.1
2025-01-04 17:28:21,646 [trainer.py] => syn_size: 32
2025-01-04 17:28:21,646 [trainer.py] => need_syn_imgs: True
2025-01-04 17:28:21,646 [trainer.py] => g_local_bs: 12
2025-01-04 17:28:21,646 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:28:21,646 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:28:21,646 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:28:21,646 [trainer.py] => vpt_type: Deep
2025-01-04 17:28:21,646 [trainer.py] => prompt_token_num: 6
2025-01-04 17:28:21,646 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:28:21,646 [trainer.py] => perturb_var: 1
2025-01-04 17:28:21,646 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:28:21,646 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:28:21,646 [trainer.py] => kl_weight: 0.001
2025-01-04 17:28:21,646 [trainer.py] => TIP_init: zero
2025-01-04 17:28:21,646 [trainer.py] => tuned_epoch: 10
2025-01-04 17:28:21,646 [trainer.py] => fs_epoch: 0
2025-01-04 17:28:21,646 [trainer.py] => init_lr: 0.01
2025-01-04 17:28:21,646 [trainer.py] => fs_lr: 0.001
2025-01-04 17:28:21,646 [trainer.py] => batch_size: 48
2025-01-04 17:28:21,646 [trainer.py] => fs_batch_size: 16
2025-01-04 17:28:21,646 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:28:21,646 [trainer.py] => min_lr: 0
2025-01-04 17:28:21,647 [trainer.py] => optimizer: sgd
2025-01-04 17:28:21,647 [trainer.py] => memory_size: 0
2025-01-04 17:28:21,647 [trainer.py] => memory_per_class: 0
2025-01-04 17:28:21,647 [trainer.py] => fixed_memory: False
2025-01-04 17:28:21,647 [trainer.py] => shuffle: False
2025-01-04 17:28:21,647 [trainer.py] => top_k: 5
2025-01-04 17:28:21,647 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:28:21,647 [trainer.py] => prefix: asp
2025-01-04 17:28:21,647 [trainer.py] => model_prefix: asp
2025-01-04 17:28:23,367 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:28:55,094 [trainer.py] => All params: 173596160
2025-01-04 17:28:55,095 [trainer.py] => Trainable params: 1998848
2025-01-04 17:28:55,282 [asp.py] => Learning on 0-60
2025-01-04 17:28:55,387 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:29:38,839 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:29:38,839 [trainer.py] => model_name: asp
2025-01-04 17:29:38,839 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:29:38,839 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:29:38,839 [trainer.py] => seed: 2024
2025-01-04 17:29:38,839 [trainer.py] => dataset: cifar224
2025-01-04 17:29:38,839 [trainer.py] => init_cls: 60
2025-01-04 17:29:38,839 [trainer.py] => increment: 5
2025-01-04 17:29:38,839 [trainer.py] => kshot: 5
2025-01-04 17:29:38,839 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:29:38,839 [trainer.py] => z_dim: 1000
2025-01-04 17:29:38,839 [trainer.py] => conv_dim: 64
2025-01-04 17:29:38,839 [trainer.py] => img_size: 224
2025-01-04 17:29:38,839 [trainer.py] => generator_lr: 0.005
2025-01-04 17:29:38,839 [trainer.py] => pi: 100
2025-01-04 17:29:38,839 [trainer.py] => w_bn: 50.0
2025-01-04 17:29:38,839 [trainer.py] => w_noise: 0.001
2025-01-04 17:29:38,839 [trainer.py] => server_ss: 32
2025-01-04 17:29:38,839 [trainer.py] => bn_loss: 1
2025-01-04 17:29:38,839 [trainer.py] => noise: 1
2025-01-04 17:29:38,840 [trainer.py] => ie_loss: 1
2025-01-04 17:29:38,840 [trainer.py] => act_loss: 0
2025-01-04 17:29:38,840 [trainer.py] => w_ie: 1.0
2025-01-04 17:29:38,840 [trainer.py] => w_act: 0.1
2025-01-04 17:29:38,840 [trainer.py] => syn_size: 32
2025-01-04 17:29:38,840 [trainer.py] => need_syn_imgs: True
2025-01-04 17:29:38,840 [trainer.py] => g_local_bs: 12
2025-01-04 17:29:38,840 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:29:38,840 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:29:38,840 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:29:38,840 [trainer.py] => com_round_gen: 10
2025-01-04 17:29:38,840 [trainer.py] => vpt_type: Deep
2025-01-04 17:29:38,840 [trainer.py] => prompt_token_num: 6
2025-01-04 17:29:38,840 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:29:38,840 [trainer.py] => perturb_var: 1
2025-01-04 17:29:38,840 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:29:38,840 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:29:38,840 [trainer.py] => kl_weight: 0.001
2025-01-04 17:29:38,840 [trainer.py] => TIP_init: zero
2025-01-04 17:29:38,840 [trainer.py] => tuned_epoch: 10
2025-01-04 17:29:38,840 [trainer.py] => fs_epoch: 0
2025-01-04 17:29:38,840 [trainer.py] => init_lr: 0.01
2025-01-04 17:29:38,841 [trainer.py] => fs_lr: 0.001
2025-01-04 17:29:38,841 [trainer.py] => batch_size: 48
2025-01-04 17:29:38,841 [trainer.py] => fs_batch_size: 16
2025-01-04 17:29:38,841 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:29:38,841 [trainer.py] => min_lr: 0
2025-01-04 17:29:38,841 [trainer.py] => optimizer: sgd
2025-01-04 17:29:38,841 [trainer.py] => memory_size: 0
2025-01-04 17:29:38,841 [trainer.py] => memory_per_class: 0
2025-01-04 17:29:38,841 [trainer.py] => fixed_memory: False
2025-01-04 17:29:38,841 [trainer.py] => shuffle: False
2025-01-04 17:29:38,841 [trainer.py] => top_k: 5
2025-01-04 17:29:38,841 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:29:38,841 [trainer.py] => prefix: asp
2025-01-04 17:29:38,841 [trainer.py] => model_prefix: asp
2025-01-04 17:29:40,553 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:30:12,975 [trainer.py] => All params: 173596160
2025-01-04 17:30:12,976 [trainer.py] => Trainable params: 1998848
2025-01-04 17:30:13,138 [asp.py] => Learning on 0-60
2025-01-04 17:30:13,208 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:34:51,967 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:34:51,967 [trainer.py] => model_name: asp
2025-01-04 17:34:51,967 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:34:51,967 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:34:51,967 [trainer.py] => seed: 2024
2025-01-04 17:34:51,967 [trainer.py] => dataset: cifar224
2025-01-04 17:34:51,967 [trainer.py] => init_cls: 60
2025-01-04 17:34:51,967 [trainer.py] => increment: 5
2025-01-04 17:34:51,967 [trainer.py] => kshot: 5
2025-01-04 17:34:51,967 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:34:51,967 [trainer.py] => z_dim: 1000
2025-01-04 17:34:51,967 [trainer.py] => conv_dim: 64
2025-01-04 17:34:51,968 [trainer.py] => img_size: 224
2025-01-04 17:34:51,968 [trainer.py] => generator_lr: 0.005
2025-01-04 17:34:51,968 [trainer.py] => pi: 100
2025-01-04 17:34:51,968 [trainer.py] => w_bn: 50.0
2025-01-04 17:34:51,968 [trainer.py] => w_noise: 0.001
2025-01-04 17:34:51,968 [trainer.py] => server_ss: 32
2025-01-04 17:34:51,968 [trainer.py] => bn_loss: 1
2025-01-04 17:34:51,968 [trainer.py] => noise: 1
2025-01-04 17:34:51,968 [trainer.py] => ie_loss: 1
2025-01-04 17:34:51,968 [trainer.py] => act_loss: 0
2025-01-04 17:34:51,968 [trainer.py] => w_ie: 1.0
2025-01-04 17:34:51,968 [trainer.py] => w_act: 0.1
2025-01-04 17:34:51,968 [trainer.py] => syn_size: 32
2025-01-04 17:34:51,968 [trainer.py] => need_syn_imgs: True
2025-01-04 17:34:51,968 [trainer.py] => g_local_bs: 12
2025-01-04 17:34:51,968 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:34:51,968 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:34:51,968 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:34:51,968 [trainer.py] => com_round_gen: 10
2025-01-04 17:34:51,968 [trainer.py] => vpt_type: Deep
2025-01-04 17:34:51,968 [trainer.py] => prompt_token_num: 6
2025-01-04 17:34:51,968 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:34:51,968 [trainer.py] => perturb_var: 1
2025-01-04 17:34:51,968 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:34:51,968 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:34:51,968 [trainer.py] => kl_weight: 0.001
2025-01-04 17:34:51,968 [trainer.py] => TIP_init: zero
2025-01-04 17:34:51,968 [trainer.py] => tuned_epoch: 10
2025-01-04 17:34:51,968 [trainer.py] => fs_epoch: 0
2025-01-04 17:34:51,968 [trainer.py] => init_lr: 0.01
2025-01-04 17:34:51,968 [trainer.py] => fs_lr: 0.001
2025-01-04 17:34:51,969 [trainer.py] => batch_size: 48
2025-01-04 17:34:51,969 [trainer.py] => fs_batch_size: 16
2025-01-04 17:34:51,969 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:34:51,969 [trainer.py] => min_lr: 0
2025-01-04 17:34:51,969 [trainer.py] => optimizer: sgd
2025-01-04 17:34:51,969 [trainer.py] => memory_size: 0
2025-01-04 17:34:51,969 [trainer.py] => memory_per_class: 0
2025-01-04 17:34:51,969 [trainer.py] => fixed_memory: False
2025-01-04 17:34:51,969 [trainer.py] => shuffle: False
2025-01-04 17:34:51,969 [trainer.py] => top_k: 5
2025-01-04 17:34:51,969 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:34:51,969 [trainer.py] => prefix: asp
2025-01-04 17:34:51,969 [trainer.py] => model_prefix: asp
2025-01-04 17:34:53,651 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:35:00,584 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:35:00,584 [trainer.py] => model_name: asp
2025-01-04 17:35:00,584 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:35:00,584 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:35:00,584 [trainer.py] => seed: 2024
2025-01-04 17:35:00,584 [trainer.py] => dataset: cifar224
2025-01-04 17:35:00,584 [trainer.py] => init_cls: 60
2025-01-04 17:35:00,584 [trainer.py] => increment: 5
2025-01-04 17:35:00,584 [trainer.py] => kshot: 5
2025-01-04 17:35:00,584 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:35:00,584 [trainer.py] => z_dim: 1000
2025-01-04 17:35:00,584 [trainer.py] => conv_dim: 64
2025-01-04 17:35:00,584 [trainer.py] => img_size: 224
2025-01-04 17:35:00,584 [trainer.py] => generator_lr: 0.005
2025-01-04 17:35:00,584 [trainer.py] => pi: 100
2025-01-04 17:35:00,584 [trainer.py] => w_bn: 50.0
2025-01-04 17:35:00,585 [trainer.py] => w_noise: 0.001
2025-01-04 17:35:00,585 [trainer.py] => server_ss: 32
2025-01-04 17:35:00,585 [trainer.py] => bn_loss: 1
2025-01-04 17:35:00,585 [trainer.py] => noise: 1
2025-01-04 17:35:00,585 [trainer.py] => ie_loss: 1
2025-01-04 17:35:00,585 [trainer.py] => act_loss: 0
2025-01-04 17:35:00,585 [trainer.py] => w_ie: 1.0
2025-01-04 17:35:00,585 [trainer.py] => w_act: 0.1
2025-01-04 17:35:00,585 [trainer.py] => syn_size: 32
2025-01-04 17:35:00,585 [trainer.py] => need_syn_imgs: True
2025-01-04 17:35:00,585 [trainer.py] => g_local_bs: 12
2025-01-04 17:35:00,585 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:35:00,585 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:35:00,585 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:35:00,585 [trainer.py] => com_round_gen: 10
2025-01-04 17:35:00,585 [trainer.py] => vpt_type: Deep
2025-01-04 17:35:00,585 [trainer.py] => prompt_token_num: 6
2025-01-04 17:35:00,585 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:35:00,585 [trainer.py] => perturb_var: 1
2025-01-04 17:35:00,585 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:35:00,585 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:35:00,585 [trainer.py] => kl_weight: 0.001
2025-01-04 17:35:00,585 [trainer.py] => TIP_init: zero
2025-01-04 17:35:00,585 [trainer.py] => tuned_epoch: 10
2025-01-04 17:35:00,585 [trainer.py] => fs_epoch: 0
2025-01-04 17:35:00,585 [trainer.py] => init_lr: 0.01
2025-01-04 17:35:00,585 [trainer.py] => fs_lr: 0.001
2025-01-04 17:35:00,585 [trainer.py] => batch_size: 48
2025-01-04 17:35:00,585 [trainer.py] => fs_batch_size: 16
2025-01-04 17:35:00,585 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:35:00,585 [trainer.py] => min_lr: 0
2025-01-04 17:35:00,585 [trainer.py] => optimizer: sgd
2025-01-04 17:35:00,585 [trainer.py] => memory_size: 0
2025-01-04 17:35:00,585 [trainer.py] => memory_per_class: 0
2025-01-04 17:35:00,586 [trainer.py] => fixed_memory: False
2025-01-04 17:35:00,586 [trainer.py] => shuffle: False
2025-01-04 17:35:00,586 [trainer.py] => top_k: 5
2025-01-04 17:35:00,586 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:35:00,586 [trainer.py] => prefix: asp
2025-01-04 17:35:00,586 [trainer.py] => model_prefix: asp
2025-01-04 17:35:02,282 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:35:31,002 [trainer.py] => All params: 173596160
2025-01-04 17:35:31,007 [trainer.py] => Trainable params: 1998848
2025-01-04 17:35:31,231 [asp.py] => Learning on 0-60
2025-01-04 17:35:31,311 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:36:58,848 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:36:58,851 [trainer.py] => model_name: asp
2025-01-04 17:36:58,851 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:36:58,851 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:36:58,851 [trainer.py] => seed: 2024
2025-01-04 17:36:58,851 [trainer.py] => dataset: cifar224
2025-01-04 17:36:58,851 [trainer.py] => init_cls: 60
2025-01-04 17:36:58,851 [trainer.py] => increment: 5
2025-01-04 17:36:58,851 [trainer.py] => kshot: 5
2025-01-04 17:36:58,851 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:36:58,851 [trainer.py] => z_dim: 1000
2025-01-04 17:36:58,851 [trainer.py] => conv_dim: 64
2025-01-04 17:36:58,851 [trainer.py] => img_size: 224
2025-01-04 17:36:58,851 [trainer.py] => generator_lr: 0.005
2025-01-04 17:36:58,851 [trainer.py] => pi: 100
2025-01-04 17:36:58,851 [trainer.py] => w_bn: 50.0
2025-01-04 17:36:58,852 [trainer.py] => w_noise: 0.001
2025-01-04 17:36:58,852 [trainer.py] => server_ss: 32
2025-01-04 17:36:58,852 [trainer.py] => bn_loss: 1
2025-01-04 17:36:58,852 [trainer.py] => noise: 1
2025-01-04 17:36:58,852 [trainer.py] => ie_loss: 1
2025-01-04 17:36:58,852 [trainer.py] => act_loss: 0
2025-01-04 17:36:58,852 [trainer.py] => w_ie: 1.0
2025-01-04 17:36:58,852 [trainer.py] => w_act: 0.1
2025-01-04 17:36:58,852 [trainer.py] => syn_size: 32
2025-01-04 17:36:58,852 [trainer.py] => need_syn_imgs: True
2025-01-04 17:36:58,852 [trainer.py] => g_local_bs: 12
2025-01-04 17:36:58,852 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:36:58,852 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:36:58,852 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:36:58,852 [trainer.py] => com_round_gen: 10
2025-01-04 17:36:58,852 [trainer.py] => vpt_type: Deep
2025-01-04 17:36:58,852 [trainer.py] => prompt_token_num: 6
2025-01-04 17:36:58,852 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:36:58,852 [trainer.py] => perturb_var: 1
2025-01-04 17:36:58,852 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:36:58,853 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:36:58,853 [trainer.py] => kl_weight: 0.001
2025-01-04 17:36:58,853 [trainer.py] => TIP_init: zero
2025-01-04 17:36:58,853 [trainer.py] => tuned_epoch: 10
2025-01-04 17:36:58,853 [trainer.py] => fs_epoch: 0
2025-01-04 17:36:58,853 [trainer.py] => init_lr: 0.01
2025-01-04 17:36:58,853 [trainer.py] => fs_lr: 0.001
2025-01-04 17:36:58,853 [trainer.py] => batch_size: 48
2025-01-04 17:36:58,853 [trainer.py] => fs_batch_size: 16
2025-01-04 17:36:58,853 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:36:58,853 [trainer.py] => min_lr: 0
2025-01-04 17:36:58,853 [trainer.py] => optimizer: sgd
2025-01-04 17:36:58,853 [trainer.py] => memory_size: 0
2025-01-04 17:36:58,853 [trainer.py] => memory_per_class: 0
2025-01-04 17:36:58,853 [trainer.py] => fixed_memory: False
2025-01-04 17:36:58,853 [trainer.py] => shuffle: False
2025-01-04 17:36:58,853 [trainer.py] => top_k: 5
2025-01-04 17:36:58,853 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:36:58,853 [trainer.py] => prefix: asp
2025-01-04 17:36:58,853 [trainer.py] => model_prefix: asp
2025-01-04 17:37:00,524 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:37:30,705 [trainer.py] => All params: 173596160
2025-01-04 17:37:30,706 [trainer.py] => Trainable params: 1998848
2025-01-04 17:37:30,883 [asp.py] => Learning on 0-60
2025-01-04 17:37:30,983 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:38:51,911 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:38:51,911 [trainer.py] => model_name: asp
2025-01-04 17:38:51,911 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:38:51,911 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:38:51,911 [trainer.py] => seed: 2024
2025-01-04 17:38:51,911 [trainer.py] => dataset: cifar224
2025-01-04 17:38:51,911 [trainer.py] => init_cls: 60
2025-01-04 17:38:51,911 [trainer.py] => increment: 5
2025-01-04 17:38:51,911 [trainer.py] => kshot: 5
2025-01-04 17:38:51,911 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:38:51,911 [trainer.py] => z_dim: 1000
2025-01-04 17:38:51,911 [trainer.py] => conv_dim: 64
2025-01-04 17:38:51,911 [trainer.py] => img_size: 224
2025-01-04 17:38:51,911 [trainer.py] => generator_lr: 0.005
2025-01-04 17:38:51,911 [trainer.py] => pi: 100
2025-01-04 17:38:51,911 [trainer.py] => w_bn: 50.0
2025-01-04 17:38:51,911 [trainer.py] => w_noise: 0.001
2025-01-04 17:38:51,911 [trainer.py] => server_ss: 32
2025-01-04 17:38:51,911 [trainer.py] => bn_loss: 1
2025-01-04 17:38:51,911 [trainer.py] => noise: 1
2025-01-04 17:38:51,911 [trainer.py] => ie_loss: 1
2025-01-04 17:38:51,911 [trainer.py] => act_loss: 0
2025-01-04 17:38:51,911 [trainer.py] => w_ie: 1.0
2025-01-04 17:38:51,911 [trainer.py] => w_act: 0.1
2025-01-04 17:38:51,911 [trainer.py] => syn_size: 32
2025-01-04 17:38:51,912 [trainer.py] => need_syn_imgs: True
2025-01-04 17:38:51,912 [trainer.py] => g_local_bs: 12
2025-01-04 17:38:51,912 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:38:51,912 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:38:51,913 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:38:51,913 [trainer.py] => com_round_gen: 10
2025-01-04 17:38:51,913 [trainer.py] => vpt_type: Deep
2025-01-04 17:38:51,913 [trainer.py] => prompt_token_num: 6
2025-01-04 17:38:51,913 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:38:51,914 [trainer.py] => perturb_var: 1
2025-01-04 17:38:51,914 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:38:51,914 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:38:51,914 [trainer.py] => kl_weight: 0.001
2025-01-04 17:38:51,914 [trainer.py] => TIP_init: zero
2025-01-04 17:38:51,914 [trainer.py] => tuned_epoch: 10
2025-01-04 17:38:51,914 [trainer.py] => fs_epoch: 0
2025-01-04 17:38:51,914 [trainer.py] => init_lr: 0.01
2025-01-04 17:38:51,914 [trainer.py] => fs_lr: 0.001
2025-01-04 17:38:51,914 [trainer.py] => batch_size: 48
2025-01-04 17:38:51,914 [trainer.py] => fs_batch_size: 16
2025-01-04 17:38:51,914 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:38:51,915 [trainer.py] => min_lr: 0
2025-01-04 17:38:51,915 [trainer.py] => optimizer: sgd
2025-01-04 17:38:51,915 [trainer.py] => memory_size: 0
2025-01-04 17:38:51,915 [trainer.py] => memory_per_class: 0
2025-01-04 17:38:51,915 [trainer.py] => fixed_memory: False
2025-01-04 17:38:51,915 [trainer.py] => shuffle: False
2025-01-04 17:38:51,915 [trainer.py] => top_k: 5
2025-01-04 17:38:51,915 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:38:51,916 [trainer.py] => prefix: asp
2025-01-04 17:38:51,916 [trainer.py] => model_prefix: asp
2025-01-04 17:38:53,479 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:39:24,555 [trainer.py] => All params: 173596160
2025-01-04 17:39:24,556 [trainer.py] => Trainable params: 1998848
2025-01-04 17:39:24,738 [asp.py] => Learning on 0-60
2025-01-04 17:39:24,877 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:40:16,686 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:40:16,687 [trainer.py] => model_name: asp
2025-01-04 17:40:16,687 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:40:16,687 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:40:16,687 [trainer.py] => seed: 2024
2025-01-04 17:40:16,687 [trainer.py] => dataset: cifar224
2025-01-04 17:40:16,687 [trainer.py] => init_cls: 60
2025-01-04 17:40:16,687 [trainer.py] => increment: 5
2025-01-04 17:40:16,687 [trainer.py] => kshot: 5
2025-01-04 17:40:16,687 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:40:16,687 [trainer.py] => z_dim: 1000
2025-01-04 17:40:16,687 [trainer.py] => conv_dim: 64
2025-01-04 17:40:16,687 [trainer.py] => img_size: 224
2025-01-04 17:40:16,687 [trainer.py] => generator_lr: 0.005
2025-01-04 17:40:16,687 [trainer.py] => pi: 100
2025-01-04 17:40:16,687 [trainer.py] => w_bn: 50.0
2025-01-04 17:40:16,687 [trainer.py] => w_noise: 0.001
2025-01-04 17:40:16,687 [trainer.py] => server_ss: 32
2025-01-04 17:40:16,687 [trainer.py] => bn_loss: 1
2025-01-04 17:40:16,687 [trainer.py] => noise: 1
2025-01-04 17:40:16,687 [trainer.py] => ie_loss: 1
2025-01-04 17:40:16,687 [trainer.py] => act_loss: 0
2025-01-04 17:40:16,687 [trainer.py] => w_ie: 1.0
2025-01-04 17:40:16,687 [trainer.py] => w_act: 0.1
2025-01-04 17:40:16,687 [trainer.py] => syn_size: 32
2025-01-04 17:40:16,687 [trainer.py] => need_syn_imgs: True
2025-01-04 17:40:16,687 [trainer.py] => g_local_bs: 12
2025-01-04 17:40:16,687 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:40:16,687 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:40:16,687 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:40:16,687 [trainer.py] => com_round_gen: 10
2025-01-04 17:40:16,687 [trainer.py] => vpt_type: Deep
2025-01-04 17:40:16,688 [trainer.py] => prompt_token_num: 6
2025-01-04 17:40:16,688 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:40:16,688 [trainer.py] => perturb_var: 1
2025-01-04 17:40:16,688 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:40:16,688 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:40:16,688 [trainer.py] => kl_weight: 0.001
2025-01-04 17:40:16,688 [trainer.py] => TIP_init: zero
2025-01-04 17:40:16,688 [trainer.py] => tuned_epoch: 10
2025-01-04 17:40:16,688 [trainer.py] => fs_epoch: 0
2025-01-04 17:40:16,688 [trainer.py] => init_lr: 0.01
2025-01-04 17:40:16,688 [trainer.py] => fs_lr: 0.001
2025-01-04 17:40:16,688 [trainer.py] => batch_size: 48
2025-01-04 17:40:16,688 [trainer.py] => fs_batch_size: 16
2025-01-04 17:40:16,688 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:40:16,688 [trainer.py] => min_lr: 0
2025-01-04 17:40:16,688 [trainer.py] => optimizer: sgd
2025-01-04 17:40:16,688 [trainer.py] => memory_size: 0
2025-01-04 17:40:16,688 [trainer.py] => memory_per_class: 0
2025-01-04 17:40:16,688 [trainer.py] => fixed_memory: False
2025-01-04 17:40:16,688 [trainer.py] => shuffle: False
2025-01-04 17:40:16,688 [trainer.py] => top_k: 5
2025-01-04 17:40:16,688 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:40:16,688 [trainer.py] => prefix: asp
2025-01-04 17:40:16,688 [trainer.py] => model_prefix: asp
2025-01-04 17:40:18,418 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:40:51,336 [trainer.py] => All params: 173596160
2025-01-04 17:40:51,337 [trainer.py] => Trainable params: 1998848
2025-01-04 17:40:51,634 [asp.py] => Learning on 0-60
2025-01-04 17:40:51,714 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:41:20,160 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:41:20,160 [trainer.py] => model_name: asp
2025-01-04 17:41:20,160 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:41:20,161 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:41:20,161 [trainer.py] => seed: 2024
2025-01-04 17:41:20,161 [trainer.py] => dataset: cifar224
2025-01-04 17:41:20,161 [trainer.py] => init_cls: 60
2025-01-04 17:41:20,161 [trainer.py] => increment: 5
2025-01-04 17:41:20,161 [trainer.py] => kshot: 5
2025-01-04 17:41:20,161 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:41:20,161 [trainer.py] => z_dim: 1000
2025-01-04 17:41:20,161 [trainer.py] => conv_dim: 64
2025-01-04 17:41:20,161 [trainer.py] => img_size: 224
2025-01-04 17:41:20,162 [trainer.py] => generator_lr: 0.005
2025-01-04 17:41:20,162 [trainer.py] => pi: 100
2025-01-04 17:41:20,162 [trainer.py] => w_bn: 50.0
2025-01-04 17:41:20,162 [trainer.py] => w_noise: 0.001
2025-01-04 17:41:20,162 [trainer.py] => server_ss: 32
2025-01-04 17:41:20,162 [trainer.py] => bn_loss: 1
2025-01-04 17:41:20,162 [trainer.py] => noise: 1
2025-01-04 17:41:20,162 [trainer.py] => ie_loss: 1
2025-01-04 17:41:20,162 [trainer.py] => act_loss: 0
2025-01-04 17:41:20,163 [trainer.py] => w_ie: 1.0
2025-01-04 17:41:20,164 [trainer.py] => w_act: 0.1
2025-01-04 17:41:20,164 [trainer.py] => syn_size: 32
2025-01-04 17:41:20,164 [trainer.py] => need_syn_imgs: True
2025-01-04 17:41:20,164 [trainer.py] => g_local_bs: 12
2025-01-04 17:41:20,164 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:41:20,164 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:41:20,164 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:41:20,164 [trainer.py] => com_round_gen: 10
2025-01-04 17:41:20,165 [trainer.py] => vpt_type: Deep
2025-01-04 17:41:20,165 [trainer.py] => prompt_token_num: 6
2025-01-04 17:41:20,165 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:41:20,165 [trainer.py] => perturb_var: 1
2025-01-04 17:41:20,166 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:41:20,166 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:41:20,167 [trainer.py] => kl_weight: 0.001
2025-01-04 17:41:20,167 [trainer.py] => TIP_init: zero
2025-01-04 17:41:20,167 [trainer.py] => tuned_epoch: 10
2025-01-04 17:41:20,167 [trainer.py] => fs_epoch: 0
2025-01-04 17:41:20,167 [trainer.py] => init_lr: 0.01
2025-01-04 17:41:20,167 [trainer.py] => fs_lr: 0.001
2025-01-04 17:41:20,168 [trainer.py] => batch_size: 48
2025-01-04 17:41:20,168 [trainer.py] => fs_batch_size: 16
2025-01-04 17:41:20,168 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:41:20,168 [trainer.py] => min_lr: 0
2025-01-04 17:41:20,168 [trainer.py] => optimizer: sgd
2025-01-04 17:41:20,168 [trainer.py] => memory_size: 0
2025-01-04 17:41:20,169 [trainer.py] => memory_per_class: 0
2025-01-04 17:41:20,169 [trainer.py] => fixed_memory: False
2025-01-04 17:41:20,169 [trainer.py] => shuffle: False
2025-01-04 17:41:20,169 [trainer.py] => top_k: 5
2025-01-04 17:41:20,169 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:41:20,169 [trainer.py] => prefix: asp
2025-01-04 17:41:20,169 [trainer.py] => model_prefix: asp
2025-01-04 17:41:21,953 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:41:52,362 [trainer.py] => All params: 173596160
2025-01-04 17:41:52,364 [trainer.py] => Trainable params: 1998848
2025-01-04 17:41:52,575 [asp.py] => Learning on 0-60
2025-01-04 17:41:52,691 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:43:37,814 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:43:37,814 [trainer.py] => model_name: asp
2025-01-04 17:43:37,814 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:43:37,814 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:43:37,814 [trainer.py] => seed: 2024
2025-01-04 17:43:37,814 [trainer.py] => dataset: cifar224
2025-01-04 17:43:37,814 [trainer.py] => init_cls: 60
2025-01-04 17:43:37,814 [trainer.py] => increment: 5
2025-01-04 17:43:37,814 [trainer.py] => kshot: 5
2025-01-04 17:43:37,814 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:43:37,814 [trainer.py] => z_dim: 1000
2025-01-04 17:43:37,815 [trainer.py] => conv_dim: 64
2025-01-04 17:43:37,815 [trainer.py] => img_size: 224
2025-01-04 17:43:37,815 [trainer.py] => generator_lr: 0.005
2025-01-04 17:43:37,815 [trainer.py] => pi: 100
2025-01-04 17:43:37,815 [trainer.py] => w_bn: 50.0
2025-01-04 17:43:37,815 [trainer.py] => w_noise: 0.001
2025-01-04 17:43:37,815 [trainer.py] => server_ss: 32
2025-01-04 17:43:37,815 [trainer.py] => bn_loss: 1
2025-01-04 17:43:37,815 [trainer.py] => noise: 1
2025-01-04 17:43:37,815 [trainer.py] => ie_loss: 1
2025-01-04 17:43:37,815 [trainer.py] => act_loss: 0
2025-01-04 17:43:37,815 [trainer.py] => w_ie: 1.0
2025-01-04 17:43:37,815 [trainer.py] => w_act: 0.1
2025-01-04 17:43:37,815 [trainer.py] => syn_size: 32
2025-01-04 17:43:37,815 [trainer.py] => need_syn_imgs: True
2025-01-04 17:43:37,815 [trainer.py] => g_local_bs: 12
2025-01-04 17:43:37,815 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:43:37,815 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:43:37,815 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:43:37,815 [trainer.py] => com_round_gen: 10
2025-01-04 17:43:37,815 [trainer.py] => vpt_type: Deep
2025-01-04 17:43:37,815 [trainer.py] => prompt_token_num: 6
2025-01-04 17:43:37,815 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:43:37,815 [trainer.py] => perturb_var: 1
2025-01-04 17:43:37,815 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:43:37,815 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:43:37,815 [trainer.py] => kl_weight: 0.001
2025-01-04 17:43:37,815 [trainer.py] => TIP_init: zero
2025-01-04 17:43:37,815 [trainer.py] => tuned_epoch: 10
2025-01-04 17:43:37,815 [trainer.py] => fs_epoch: 0
2025-01-04 17:43:37,815 [trainer.py] => init_lr: 0.01
2025-01-04 17:43:37,815 [trainer.py] => fs_lr: 0.001
2025-01-04 17:43:37,816 [trainer.py] => batch_size: 48
2025-01-04 17:43:37,816 [trainer.py] => fs_batch_size: 16
2025-01-04 17:43:37,816 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:43:37,816 [trainer.py] => min_lr: 0
2025-01-04 17:43:37,816 [trainer.py] => optimizer: sgd
2025-01-04 17:43:37,816 [trainer.py] => memory_size: 0
2025-01-04 17:43:37,816 [trainer.py] => memory_per_class: 0
2025-01-04 17:43:37,816 [trainer.py] => fixed_memory: False
2025-01-04 17:43:37,816 [trainer.py] => shuffle: False
2025-01-04 17:43:37,816 [trainer.py] => top_k: 5
2025-01-04 17:43:37,816 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:43:37,816 [trainer.py] => prefix: asp
2025-01-04 17:43:37,816 [trainer.py] => model_prefix: asp
2025-01-04 17:43:39,525 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:44:10,431 [trainer.py] => All params: 173596160
2025-01-04 17:44:10,432 [trainer.py] => Trainable params: 1998848
2025-01-04 17:44:10,590 [asp.py] => Learning on 0-60
2025-01-04 17:44:10,663 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:49:27,426 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:49:27,427 [trainer.py] => model_name: asp
2025-01-04 17:49:27,427 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:49:27,427 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:49:27,427 [trainer.py] => seed: 2024
2025-01-04 17:49:27,427 [trainer.py] => dataset: cifar224
2025-01-04 17:49:27,427 [trainer.py] => init_cls: 60
2025-01-04 17:49:27,427 [trainer.py] => increment: 5
2025-01-04 17:49:27,427 [trainer.py] => kshot: 5
2025-01-04 17:49:27,427 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:49:27,427 [trainer.py] => z_dim: 1000
2025-01-04 17:49:27,427 [trainer.py] => conv_dim: 64
2025-01-04 17:49:27,427 [trainer.py] => img_size: 224
2025-01-04 17:49:27,427 [trainer.py] => generator_lr: 0.005
2025-01-04 17:49:27,427 [trainer.py] => pi: 100
2025-01-04 17:49:27,427 [trainer.py] => w_bn: 50.0
2025-01-04 17:49:27,427 [trainer.py] => w_noise: 0.001
2025-01-04 17:49:27,427 [trainer.py] => server_ss: 32
2025-01-04 17:49:27,427 [trainer.py] => bn_loss: 1
2025-01-04 17:49:27,427 [trainer.py] => noise: 1
2025-01-04 17:49:27,427 [trainer.py] => ie_loss: 1
2025-01-04 17:49:27,427 [trainer.py] => act_loss: 0
2025-01-04 17:49:27,428 [trainer.py] => w_ie: 1.0
2025-01-04 17:49:27,428 [trainer.py] => w_act: 0.1
2025-01-04 17:49:27,428 [trainer.py] => syn_size: 32
2025-01-04 17:49:27,428 [trainer.py] => need_syn_imgs: True
2025-01-04 17:49:27,428 [trainer.py] => g_local_bs: 12
2025-01-04 17:49:27,428 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:49:27,428 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:49:27,428 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:49:27,428 [trainer.py] => com_round_gen: 10
2025-01-04 17:49:27,428 [trainer.py] => vpt_type: Deep
2025-01-04 17:49:27,428 [trainer.py] => prompt_token_num: 6
2025-01-04 17:49:27,428 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:49:27,428 [trainer.py] => perturb_var: 1
2025-01-04 17:49:27,428 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:49:27,428 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:49:27,428 [trainer.py] => kl_weight: 0.001
2025-01-04 17:49:27,428 [trainer.py] => TIP_init: zero
2025-01-04 17:49:27,428 [trainer.py] => tuned_epoch: 10
2025-01-04 17:49:27,428 [trainer.py] => fs_epoch: 0
2025-01-04 17:49:27,428 [trainer.py] => init_lr: 0.01
2025-01-04 17:49:27,428 [trainer.py] => fs_lr: 0.001
2025-01-04 17:49:27,428 [trainer.py] => batch_size: 48
2025-01-04 17:49:27,428 [trainer.py] => fs_batch_size: 16
2025-01-04 17:49:27,428 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:49:27,428 [trainer.py] => min_lr: 0
2025-01-04 17:49:27,428 [trainer.py] => optimizer: sgd
2025-01-04 17:49:27,429 [trainer.py] => memory_size: 0
2025-01-04 17:49:27,429 [trainer.py] => memory_per_class: 0
2025-01-04 17:49:27,429 [trainer.py] => fixed_memory: False
2025-01-04 17:49:27,429 [trainer.py] => shuffle: False
2025-01-04 17:49:27,429 [trainer.py] => top_k: 5
2025-01-04 17:49:27,429 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:49:27,429 [trainer.py] => prefix: asp
2025-01-04 17:49:27,429 [trainer.py] => model_prefix: asp
2025-01-04 17:49:29,183 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:50:10,238 [trainer.py] => All params: 173596160
2025-01-04 17:50:10,239 [trainer.py] => Trainable params: 1998848
2025-01-04 17:50:10,528 [asp.py] => Learning on 0-60
2025-01-04 17:50:10,616 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:51:28,918 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:51:28,918 [trainer.py] => model_name: asp
2025-01-04 17:51:28,918 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:51:28,918 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:51:28,918 [trainer.py] => seed: 2024
2025-01-04 17:51:28,918 [trainer.py] => dataset: cifar224
2025-01-04 17:51:28,918 [trainer.py] => init_cls: 60
2025-01-04 17:51:28,918 [trainer.py] => increment: 5
2025-01-04 17:51:28,919 [trainer.py] => kshot: 5
2025-01-04 17:51:28,919 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:51:28,919 [trainer.py] => z_dim: 1000
2025-01-04 17:51:28,919 [trainer.py] => conv_dim: 64
2025-01-04 17:51:28,919 [trainer.py] => img_size: 224
2025-01-04 17:51:28,919 [trainer.py] => generator_lr: 0.005
2025-01-04 17:51:28,919 [trainer.py] => pi: 100
2025-01-04 17:51:28,919 [trainer.py] => w_bn: 50.0
2025-01-04 17:51:28,919 [trainer.py] => w_noise: 0.001
2025-01-04 17:51:28,919 [trainer.py] => server_ss: 32
2025-01-04 17:51:28,919 [trainer.py] => bn_loss: 1
2025-01-04 17:51:28,919 [trainer.py] => noise: 1
2025-01-04 17:51:28,919 [trainer.py] => ie_loss: 1
2025-01-04 17:51:28,919 [trainer.py] => act_loss: 0
2025-01-04 17:51:28,919 [trainer.py] => w_ie: 1.0
2025-01-04 17:51:28,919 [trainer.py] => w_act: 0.1
2025-01-04 17:51:28,919 [trainer.py] => syn_size: 32
2025-01-04 17:51:28,919 [trainer.py] => need_syn_imgs: True
2025-01-04 17:51:28,919 [trainer.py] => g_local_bs: 12
2025-01-04 17:51:28,919 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:51:28,919 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:51:28,919 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:51:28,919 [trainer.py] => com_round_gen: 10
2025-01-04 17:51:28,919 [trainer.py] => vpt_type: Deep
2025-01-04 17:51:28,919 [trainer.py] => prompt_token_num: 6
2025-01-04 17:51:28,919 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:51:28,919 [trainer.py] => perturb_var: 1
2025-01-04 17:51:28,919 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:51:28,919 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:51:28,919 [trainer.py] => kl_weight: 0.001
2025-01-04 17:51:28,919 [trainer.py] => TIP_init: zero
2025-01-04 17:51:28,919 [trainer.py] => tuned_epoch: 10
2025-01-04 17:51:28,920 [trainer.py] => fs_epoch: 0
2025-01-04 17:51:28,920 [trainer.py] => init_lr: 0.01
2025-01-04 17:51:28,920 [trainer.py] => fs_lr: 0.001
2025-01-04 17:51:28,920 [trainer.py] => batch_size: 48
2025-01-04 17:51:28,920 [trainer.py] => fs_batch_size: 16
2025-01-04 17:51:28,920 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:51:28,920 [trainer.py] => min_lr: 0
2025-01-04 17:51:28,920 [trainer.py] => optimizer: sgd
2025-01-04 17:51:28,920 [trainer.py] => memory_size: 0
2025-01-04 17:51:28,920 [trainer.py] => memory_per_class: 0
2025-01-04 17:51:28,920 [trainer.py] => fixed_memory: False
2025-01-04 17:51:28,920 [trainer.py] => shuffle: False
2025-01-04 17:51:28,920 [trainer.py] => top_k: 5
2025-01-04 17:51:28,920 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:51:28,920 [trainer.py] => prefix: asp
2025-01-04 17:51:28,920 [trainer.py] => model_prefix: asp
2025-01-04 17:51:30,744 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:52:05,656 [trainer.py] => All params: 173596160
2025-01-04 17:52:05,658 [trainer.py] => Trainable params: 1998848
2025-01-04 17:52:05,832 [asp.py] => Learning on 0-60
2025-01-04 17:52:05,922 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-04 17:54:54,243 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-04 17:54:54,243 [trainer.py] => model_name: asp
2025-01-04 17:54:54,243 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-04 17:54:54,243 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-04 17:54:54,244 [trainer.py] => seed: 2024
2025-01-04 17:54:54,244 [trainer.py] => dataset: cifar224
2025-01-04 17:54:54,244 [trainer.py] => init_cls: 60
2025-01-04 17:54:54,244 [trainer.py] => increment: 5
2025-01-04 17:54:54,244 [trainer.py] => kshot: 5
2025-01-04 17:54:54,244 [trainer.py] => generator_model: CIFAR_GEN
2025-01-04 17:54:54,244 [trainer.py] => z_dim: 1000
2025-01-04 17:54:54,244 [trainer.py] => conv_dim: 64
2025-01-04 17:54:54,244 [trainer.py] => img_size: 224
2025-01-04 17:54:54,244 [trainer.py] => generator_lr: 0.005
2025-01-04 17:54:54,244 [trainer.py] => pi: 100
2025-01-04 17:54:54,244 [trainer.py] => w_bn: 50.0
2025-01-04 17:54:54,244 [trainer.py] => w_noise: 0.001
2025-01-04 17:54:54,244 [trainer.py] => server_ss: 32
2025-01-04 17:54:54,244 [trainer.py] => bn_loss: 1
2025-01-04 17:54:54,244 [trainer.py] => noise: 1
2025-01-04 17:54:54,244 [trainer.py] => ie_loss: 1
2025-01-04 17:54:54,244 [trainer.py] => act_loss: 0
2025-01-04 17:54:54,244 [trainer.py] => w_ie: 1.0
2025-01-04 17:54:54,244 [trainer.py] => w_act: 0.1
2025-01-04 17:54:54,244 [trainer.py] => syn_size: 32
2025-01-04 17:54:54,244 [trainer.py] => need_syn_imgs: True
2025-01-04 17:54:54,244 [trainer.py] => g_local_bs: 12
2025-01-04 17:54:54,244 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-04 17:54:54,244 [trainer.py] => g_local_train_steps: 50
2025-01-04 17:54:54,244 [trainer.py] => dataset_syn: cifar100
2025-01-04 17:54:54,244 [trainer.py] => com_round_gen: 10
2025-01-04 17:54:54,244 [trainer.py] => vpt_type: Deep
2025-01-04 17:54:54,244 [trainer.py] => prompt_token_num: 6
2025-01-04 17:54:54,244 [trainer.py] => avg_alpha: 0.8
2025-01-04 17:54:54,244 [trainer.py] => perturb_var: 1
2025-01-04 17:54:54,244 [trainer.py] => EMA_beta: 0.99
2025-01-04 17:54:54,244 [trainer.py] => anchor_lambda: 0.1
2025-01-04 17:54:54,244 [trainer.py] => kl_weight: 0.001
2025-01-04 17:54:54,244 [trainer.py] => TIP_init: zero
2025-01-04 17:54:54,245 [trainer.py] => tuned_epoch: 10
2025-01-04 17:54:54,245 [trainer.py] => fs_epoch: 0
2025-01-04 17:54:54,245 [trainer.py] => init_lr: 0.01
2025-01-04 17:54:54,245 [trainer.py] => fs_lr: 0.001
2025-01-04 17:54:54,245 [trainer.py] => batch_size: 48
2025-01-04 17:54:54,245 [trainer.py] => fs_batch_size: 16
2025-01-04 17:54:54,245 [trainer.py] => weight_decay: 0.0005
2025-01-04 17:54:54,245 [trainer.py] => min_lr: 0
2025-01-04 17:54:54,245 [trainer.py] => optimizer: sgd
2025-01-04 17:54:54,245 [trainer.py] => memory_size: 0
2025-01-04 17:54:54,245 [trainer.py] => memory_per_class: 0
2025-01-04 17:54:54,245 [trainer.py] => fixed_memory: False
2025-01-04 17:54:54,245 [trainer.py] => shuffle: False
2025-01-04 17:54:54,245 [trainer.py] => top_k: 5
2025-01-04 17:54:54,245 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-04 17:54:54,245 [trainer.py] => prefix: asp
2025-01-04 17:54:54,245 [trainer.py] => model_prefix: asp
2025-01-04 17:54:55,904 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-04 17:55:24,653 [trainer.py] => All params: 173596160
2025-01-04 17:55:24,654 [trainer.py] => Trainable params: 1998848
2025-01-04 17:55:24,838 [asp.py] => Learning on 0-60
2025-01-04 17:55:24,897 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 13:27:32,061 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 13:27:32,062 [trainer.py] => model_name: asp
2025-01-05 13:27:32,062 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 13:27:32,062 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-05 13:27:32,062 [trainer.py] => seed: 2024
2025-01-05 13:27:32,062 [trainer.py] => dataset: cifar224
2025-01-05 13:27:32,062 [trainer.py] => init_cls: 60
2025-01-05 13:27:32,062 [trainer.py] => increment: 5
2025-01-05 13:27:32,062 [trainer.py] => kshot: 5
2025-01-05 13:27:32,062 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 13:27:32,062 [trainer.py] => z_dim: 1000
2025-01-05 13:27:32,062 [trainer.py] => conv_dim: 64
2025-01-05 13:27:32,062 [trainer.py] => img_size: 224
2025-01-05 13:27:32,062 [trainer.py] => generator_lr: 0.005
2025-01-05 13:27:32,062 [trainer.py] => pi: 100
2025-01-05 13:27:32,062 [trainer.py] => w_bn: 50.0
2025-01-05 13:27:32,062 [trainer.py] => w_noise: 0.001
2025-01-05 13:27:32,062 [trainer.py] => server_ss: 32
2025-01-05 13:27:32,062 [trainer.py] => bn_loss: 1
2025-01-05 13:27:32,062 [trainer.py] => noise: 1
2025-01-05 13:27:32,062 [trainer.py] => ie_loss: 1
2025-01-05 13:27:32,062 [trainer.py] => act_loss: 0
2025-01-05 13:27:32,062 [trainer.py] => w_ie: 1.0
2025-01-05 13:27:32,063 [trainer.py] => w_act: 0.1
2025-01-05 13:27:32,063 [trainer.py] => syn_size: 32
2025-01-05 13:27:32,063 [trainer.py] => need_syn_imgs: True
2025-01-05 13:27:32,063 [trainer.py] => g_local_bs: 12
2025-01-05 13:27:32,063 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 13:27:32,063 [trainer.py] => g_local_train_steps: 50
2025-01-05 13:27:32,063 [trainer.py] => dataset_syn: cifar100
2025-01-05 13:27:32,063 [trainer.py] => com_round_gen: 10
2025-01-05 13:27:32,063 [trainer.py] => vpt_type: Deep
2025-01-05 13:27:32,063 [trainer.py] => prompt_token_num: 6
2025-01-05 13:27:32,063 [trainer.py] => avg_alpha: 0.8
2025-01-05 13:27:32,063 [trainer.py] => perturb_var: 1
2025-01-05 13:27:32,063 [trainer.py] => EMA_beta: 0.99
2025-01-05 13:27:32,063 [trainer.py] => anchor_lambda: 0.1
2025-01-05 13:27:32,063 [trainer.py] => kl_weight: 0.001
2025-01-05 13:27:32,063 [trainer.py] => TIP_init: zero
2025-01-05 13:27:32,063 [trainer.py] => tuned_epoch: 10
2025-01-05 13:27:32,063 [trainer.py] => fs_epoch: 0
2025-01-05 13:27:32,063 [trainer.py] => init_lr: 0.01
2025-01-05 13:27:32,063 [trainer.py] => fs_lr: 0.001
2025-01-05 13:27:32,063 [trainer.py] => batch_size: 48
2025-01-05 13:27:32,063 [trainer.py] => fs_batch_size: 16
2025-01-05 13:27:32,063 [trainer.py] => weight_decay: 0.0005
2025-01-05 13:27:32,063 [trainer.py] => min_lr: 0
2025-01-05 13:27:32,063 [trainer.py] => optimizer: sgd
2025-01-05 13:27:32,063 [trainer.py] => memory_size: 0
2025-01-05 13:27:32,063 [trainer.py] => memory_per_class: 0
2025-01-05 13:27:32,063 [trainer.py] => fixed_memory: False
2025-01-05 13:27:32,063 [trainer.py] => shuffle: False
2025-01-05 13:27:32,063 [trainer.py] => top_k: 5
2025-01-05 13:27:32,064 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 13:27:32,064 [trainer.py] => prefix: asp
2025-01-05 13:27:32,064 [trainer.py] => model_prefix: asp
2025-01-05 13:27:41,478 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 13:30:51,672 [trainer.py] => All params: 173596160
2025-01-05 13:30:51,688 [trainer.py] => Trainable params: 1998848
2025-01-05 13:30:52,057 [asp.py] => Learning on 0-60
2025-01-05 13:30:52,352 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 13:36:24,523 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 13:36:24,523 [trainer.py] => model_name: asp
2025-01-05 13:36:24,523 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 13:36:24,523 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-05 13:36:24,523 [trainer.py] => seed: 2024
2025-01-05 13:36:24,523 [trainer.py] => dataset: cifar224
2025-01-05 13:36:24,523 [trainer.py] => init_cls: 60
2025-01-05 13:36:24,523 [trainer.py] => increment: 5
2025-01-05 13:36:24,523 [trainer.py] => kshot: 5
2025-01-05 13:36:24,523 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 13:36:24,523 [trainer.py] => z_dim: 1000
2025-01-05 13:36:24,523 [trainer.py] => conv_dim: 64
2025-01-05 13:36:24,523 [trainer.py] => img_size: 224
2025-01-05 13:36:24,523 [trainer.py] => generator_lr: 0.005
2025-01-05 13:36:24,523 [trainer.py] => pi: 100
2025-01-05 13:36:24,523 [trainer.py] => w_bn: 50.0
2025-01-05 13:36:24,523 [trainer.py] => w_noise: 0.001
2025-01-05 13:36:24,523 [trainer.py] => server_ss: 32
2025-01-05 13:36:24,523 [trainer.py] => bn_loss: 1
2025-01-05 13:36:24,523 [trainer.py] => noise: 1
2025-01-05 13:36:24,523 [trainer.py] => ie_loss: 1
2025-01-05 13:36:24,523 [trainer.py] => act_loss: 0
2025-01-05 13:36:24,523 [trainer.py] => w_ie: 1.0
2025-01-05 13:36:24,524 [trainer.py] => w_act: 0.1
2025-01-05 13:36:24,524 [trainer.py] => syn_size: 32
2025-01-05 13:36:24,524 [trainer.py] => need_syn_imgs: True
2025-01-05 13:36:24,524 [trainer.py] => g_local_bs: 12
2025-01-05 13:36:24,524 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 13:36:24,524 [trainer.py] => g_local_train_steps: 50
2025-01-05 13:36:24,524 [trainer.py] => dataset_syn: cifar100
2025-01-05 13:36:24,524 [trainer.py] => com_round_gen: 10
2025-01-05 13:36:24,524 [trainer.py] => vpt_type: Deep
2025-01-05 13:36:24,524 [trainer.py] => prompt_token_num: 6
2025-01-05 13:36:24,524 [trainer.py] => avg_alpha: 0.8
2025-01-05 13:36:24,524 [trainer.py] => perturb_var: 1
2025-01-05 13:36:24,524 [trainer.py] => EMA_beta: 0.99
2025-01-05 13:36:24,524 [trainer.py] => anchor_lambda: 0.1
2025-01-05 13:36:24,524 [trainer.py] => kl_weight: 0.001
2025-01-05 13:36:24,524 [trainer.py] => TIP_init: zero
2025-01-05 13:36:24,524 [trainer.py] => tuned_epoch: 10
2025-01-05 13:36:24,524 [trainer.py] => fs_epoch: 0
2025-01-05 13:36:24,524 [trainer.py] => init_lr: 0.01
2025-01-05 13:36:24,524 [trainer.py] => fs_lr: 0.001
2025-01-05 13:36:24,524 [trainer.py] => batch_size: 48
2025-01-05 13:36:24,524 [trainer.py] => fs_batch_size: 16
2025-01-05 13:36:24,524 [trainer.py] => weight_decay: 0.0005
2025-01-05 13:36:24,524 [trainer.py] => min_lr: 0
2025-01-05 13:36:24,524 [trainer.py] => optimizer: sgd
2025-01-05 13:36:24,524 [trainer.py] => memory_size: 0
2025-01-05 13:36:24,524 [trainer.py] => memory_per_class: 0
2025-01-05 13:36:24,524 [trainer.py] => fixed_memory: False
2025-01-05 13:36:24,524 [trainer.py] => shuffle: False
2025-01-05 13:36:24,524 [trainer.py] => top_k: 5
2025-01-05 13:36:24,524 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 13:36:24,524 [trainer.py] => prefix: asp
2025-01-05 13:36:24,525 [trainer.py] => model_prefix: asp
2025-01-05 13:36:27,456 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 13:37:19,884 [trainer.py] => All params: 173596160
2025-01-05 13:37:19,885 [trainer.py] => Trainable params: 1998848
2025-01-05 13:37:20,158 [asp.py] => Learning on 0-60
2025-01-05 13:37:20,250 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 13:40:07,226 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 13:40:07,228 [trainer.py] => model_name: asp
2025-01-05 13:40:07,229 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 13:40:07,231 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-05 13:40:07,231 [trainer.py] => seed: 2024
2025-01-05 13:40:07,231 [trainer.py] => dataset: cifar224
2025-01-05 13:40:07,232 [trainer.py] => init_cls: 60
2025-01-05 13:40:07,232 [trainer.py] => increment: 5
2025-01-05 13:40:07,232 [trainer.py] => kshot: 5
2025-01-05 13:40:07,232 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 13:40:07,232 [trainer.py] => z_dim: 1000
2025-01-05 13:40:07,233 [trainer.py] => conv_dim: 64
2025-01-05 13:40:07,233 [trainer.py] => img_size: 224
2025-01-05 13:40:07,233 [trainer.py] => generator_lr: 0.005
2025-01-05 13:40:07,233 [trainer.py] => pi: 100
2025-01-05 13:40:07,233 [trainer.py] => w_bn: 50.0
2025-01-05 13:40:07,233 [trainer.py] => w_noise: 0.001
2025-01-05 13:40:07,233 [trainer.py] => server_ss: 32
2025-01-05 13:40:07,233 [trainer.py] => bn_loss: 1
2025-01-05 13:40:07,233 [trainer.py] => noise: 1
2025-01-05 13:40:07,233 [trainer.py] => ie_loss: 1
2025-01-05 13:40:07,234 [trainer.py] => act_loss: 0
2025-01-05 13:40:07,234 [trainer.py] => w_ie: 1.0
2025-01-05 13:40:07,234 [trainer.py] => w_act: 0.1
2025-01-05 13:40:07,234 [trainer.py] => syn_size: 32
2025-01-05 13:40:07,234 [trainer.py] => need_syn_imgs: True
2025-01-05 13:40:07,234 [trainer.py] => g_local_bs: 12
2025-01-05 13:40:07,234 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 13:40:07,234 [trainer.py] => g_local_train_steps: 50
2025-01-05 13:40:07,234 [trainer.py] => dataset_syn: cifar100
2025-01-05 13:40:07,234 [trainer.py] => com_round_gen: 10
2025-01-05 13:40:07,234 [trainer.py] => vpt_type: Deep
2025-01-05 13:40:07,234 [trainer.py] => prompt_token_num: 6
2025-01-05 13:40:07,234 [trainer.py] => avg_alpha: 0.8
2025-01-05 13:40:07,234 [trainer.py] => perturb_var: 1
2025-01-05 13:40:07,234 [trainer.py] => EMA_beta: 0.99
2025-01-05 13:40:07,234 [trainer.py] => anchor_lambda: 0.1
2025-01-05 13:40:07,234 [trainer.py] => kl_weight: 0.001
2025-01-05 13:40:07,234 [trainer.py] => TIP_init: zero
2025-01-05 13:40:07,234 [trainer.py] => tuned_epoch: 10
2025-01-05 13:40:07,234 [trainer.py] => fs_epoch: 0
2025-01-05 13:40:07,234 [trainer.py] => init_lr: 0.01
2025-01-05 13:40:07,234 [trainer.py] => fs_lr: 0.001
2025-01-05 13:40:07,234 [trainer.py] => batch_size: 48
2025-01-05 13:40:07,234 [trainer.py] => fs_batch_size: 16
2025-01-05 13:40:07,234 [trainer.py] => weight_decay: 0.0005
2025-01-05 13:40:07,234 [trainer.py] => min_lr: 0
2025-01-05 13:40:07,234 [trainer.py] => optimizer: sgd
2025-01-05 13:40:07,234 [trainer.py] => memory_size: 0
2025-01-05 13:40:07,234 [trainer.py] => memory_per_class: 0
2025-01-05 13:40:07,235 [trainer.py] => fixed_memory: False
2025-01-05 13:40:07,235 [trainer.py] => shuffle: False
2025-01-05 13:40:07,235 [trainer.py] => top_k: 5
2025-01-05 13:40:07,235 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 13:40:07,235 [trainer.py] => prefix: asp
2025-01-05 13:40:07,235 [trainer.py] => model_prefix: asp
2025-01-05 13:40:09,053 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 13:43:17,183 [trainer.py] => All params: 173596160
2025-01-05 13:43:17,189 [trainer.py] => Trainable params: 1998848
2025-01-05 13:43:17,434 [asp.py] => Learning on 0-60
2025-01-05 13:43:17,523 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 13:43:45,837 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 13:43:45,837 [trainer.py] => model_name: asp
2025-01-05 13:43:45,837 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 13:43:45,837 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-05 13:43:45,837 [trainer.py] => seed: 2024
2025-01-05 13:43:45,838 [trainer.py] => dataset: cifar224
2025-01-05 13:43:45,838 [trainer.py] => init_cls: 60
2025-01-05 13:43:45,838 [trainer.py] => increment: 5
2025-01-05 13:43:45,838 [trainer.py] => kshot: 5
2025-01-05 13:43:45,838 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 13:43:45,838 [trainer.py] => z_dim: 1000
2025-01-05 13:43:45,838 [trainer.py] => conv_dim: 64
2025-01-05 13:43:45,838 [trainer.py] => img_size: 224
2025-01-05 13:43:45,838 [trainer.py] => generator_lr: 0.005
2025-01-05 13:43:45,838 [trainer.py] => pi: 100
2025-01-05 13:43:45,838 [trainer.py] => w_bn: 50.0
2025-01-05 13:43:45,838 [trainer.py] => w_noise: 0.001
2025-01-05 13:43:45,838 [trainer.py] => server_ss: 32
2025-01-05 13:43:45,838 [trainer.py] => bn_loss: 1
2025-01-05 13:43:45,838 [trainer.py] => noise: 1
2025-01-05 13:43:45,838 [trainer.py] => ie_loss: 1
2025-01-05 13:43:45,838 [trainer.py] => act_loss: 0
2025-01-05 13:43:45,838 [trainer.py] => w_ie: 1.0
2025-01-05 13:43:45,838 [trainer.py] => w_act: 0.1
2025-01-05 13:43:45,838 [trainer.py] => syn_size: 32
2025-01-05 13:43:45,838 [trainer.py] => need_syn_imgs: True
2025-01-05 13:43:45,838 [trainer.py] => g_local_bs: 12
2025-01-05 13:43:45,838 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 13:43:45,838 [trainer.py] => g_local_train_steps: 50
2025-01-05 13:43:45,838 [trainer.py] => dataset_syn: cifar100
2025-01-05 13:43:45,838 [trainer.py] => com_round_gen: 10
2025-01-05 13:43:45,838 [trainer.py] => vpt_type: Deep
2025-01-05 13:43:45,838 [trainer.py] => prompt_token_num: 6
2025-01-05 13:43:45,839 [trainer.py] => avg_alpha: 0.8
2025-01-05 13:43:45,839 [trainer.py] => perturb_var: 1
2025-01-05 13:43:45,839 [trainer.py] => EMA_beta: 0.99
2025-01-05 13:43:45,839 [trainer.py] => anchor_lambda: 0.1
2025-01-05 13:43:45,839 [trainer.py] => kl_weight: 0.001
2025-01-05 13:43:45,839 [trainer.py] => TIP_init: zero
2025-01-05 13:43:45,839 [trainer.py] => tuned_epoch: 10
2025-01-05 13:43:45,839 [trainer.py] => fs_epoch: 0
2025-01-05 13:43:45,839 [trainer.py] => init_lr: 0.01
2025-01-05 13:43:45,839 [trainer.py] => fs_lr: 0.001
2025-01-05 13:43:45,839 [trainer.py] => batch_size: 48
2025-01-05 13:43:45,839 [trainer.py] => fs_batch_size: 16
2025-01-05 13:43:45,839 [trainer.py] => weight_decay: 0.0005
2025-01-05 13:43:45,839 [trainer.py] => min_lr: 0
2025-01-05 13:43:45,839 [trainer.py] => optimizer: sgd
2025-01-05 13:43:45,839 [trainer.py] => memory_size: 0
2025-01-05 13:43:45,839 [trainer.py] => memory_per_class: 0
2025-01-05 13:43:45,839 [trainer.py] => fixed_memory: False
2025-01-05 13:43:45,839 [trainer.py] => shuffle: False
2025-01-05 13:43:45,839 [trainer.py] => top_k: 5
2025-01-05 13:43:45,839 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 13:43:45,839 [trainer.py] => prefix: asp
2025-01-05 13:43:45,839 [trainer.py] => model_prefix: asp
2025-01-05 13:43:47,671 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 13:44:21,715 [trainer.py] => All params: 173596160
2025-01-05 13:44:21,716 [trainer.py] => Trainable params: 1998848
2025-01-05 13:44:21,965 [asp.py] => Learning on 0-60
2025-01-05 13:44:22,058 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 13:45:33,594 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 13:45:33,594 [trainer.py] => model_name: asp
2025-01-05 13:45:33,594 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 13:45:33,594 [trainer.py] => device: [device(type='cuda', index=2)]
2025-01-05 13:45:33,594 [trainer.py] => seed: 2024
2025-01-05 13:45:33,594 [trainer.py] => dataset: cifar224
2025-01-05 13:45:33,594 [trainer.py] => init_cls: 60
2025-01-05 13:45:33,594 [trainer.py] => increment: 5
2025-01-05 13:45:33,594 [trainer.py] => kshot: 5
2025-01-05 13:45:33,594 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 13:45:33,594 [trainer.py] => z_dim: 1000
2025-01-05 13:45:33,594 [trainer.py] => conv_dim: 64
2025-01-05 13:45:33,594 [trainer.py] => img_size: 224
2025-01-05 13:45:33,595 [trainer.py] => generator_lr: 0.005
2025-01-05 13:45:33,595 [trainer.py] => pi: 100
2025-01-05 13:45:33,595 [trainer.py] => w_bn: 50.0
2025-01-05 13:45:33,595 [trainer.py] => w_noise: 0.001
2025-01-05 13:45:33,595 [trainer.py] => server_ss: 32
2025-01-05 13:45:33,595 [trainer.py] => bn_loss: 1
2025-01-05 13:45:33,595 [trainer.py] => noise: 1
2025-01-05 13:45:33,595 [trainer.py] => ie_loss: 1
2025-01-05 13:45:33,595 [trainer.py] => act_loss: 0
2025-01-05 13:45:33,595 [trainer.py] => w_ie: 1.0
2025-01-05 13:45:33,595 [trainer.py] => w_act: 0.1
2025-01-05 13:45:33,595 [trainer.py] => syn_size: 32
2025-01-05 13:45:33,595 [trainer.py] => need_syn_imgs: True
2025-01-05 13:45:33,595 [trainer.py] => g_local_bs: 12
2025-01-05 13:45:33,595 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 13:45:33,595 [trainer.py] => g_local_train_steps: 50
2025-01-05 13:45:33,595 [trainer.py] => dataset_syn: cifar100
2025-01-05 13:45:33,595 [trainer.py] => com_round_gen: 10
2025-01-05 13:45:33,595 [trainer.py] => vpt_type: Deep
2025-01-05 13:45:33,595 [trainer.py] => prompt_token_num: 6
2025-01-05 13:45:33,595 [trainer.py] => avg_alpha: 0.8
2025-01-05 13:45:33,595 [trainer.py] => perturb_var: 1
2025-01-05 13:45:33,595 [trainer.py] => EMA_beta: 0.99
2025-01-05 13:45:33,595 [trainer.py] => anchor_lambda: 0.1
2025-01-05 13:45:33,595 [trainer.py] => kl_weight: 0.001
2025-01-05 13:45:33,595 [trainer.py] => TIP_init: zero
2025-01-05 13:45:33,595 [trainer.py] => tuned_epoch: 10
2025-01-05 13:45:33,595 [trainer.py] => fs_epoch: 0
2025-01-05 13:45:33,596 [trainer.py] => init_lr: 0.01
2025-01-05 13:45:33,596 [trainer.py] => fs_lr: 0.001
2025-01-05 13:45:33,596 [trainer.py] => batch_size: 48
2025-01-05 13:45:33,596 [trainer.py] => fs_batch_size: 16
2025-01-05 13:45:33,596 [trainer.py] => weight_decay: 0.0005
2025-01-05 13:45:33,596 [trainer.py] => min_lr: 0
2025-01-05 13:45:33,596 [trainer.py] => optimizer: sgd
2025-01-05 13:45:33,596 [trainer.py] => memory_size: 0
2025-01-05 13:45:33,596 [trainer.py] => memory_per_class: 0
2025-01-05 13:45:33,596 [trainer.py] => fixed_memory: False
2025-01-05 13:45:33,596 [trainer.py] => shuffle: False
2025-01-05 13:45:33,596 [trainer.py] => top_k: 5
2025-01-05 13:45:33,596 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 13:45:33,596 [trainer.py] => prefix: asp
2025-01-05 13:45:33,596 [trainer.py] => model_prefix: asp
2025-01-05 13:45:35,485 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 13:46:10,595 [trainer.py] => All params: 173596160
2025-01-05 13:46:10,596 [trainer.py] => Trainable params: 1998848
2025-01-05 13:46:10,862 [asp.py] => Learning on 0-60
2025-01-05 13:46:10,951 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 13:50:14,081 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 13:50:14,081 [trainer.py] => model_name: asp
2025-01-05 13:50:14,081 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 13:50:14,081 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 13:50:14,082 [trainer.py] => seed: 2024
2025-01-05 13:50:14,082 [trainer.py] => dataset: cifar224
2025-01-05 13:50:14,082 [trainer.py] => init_cls: 60
2025-01-05 13:50:14,082 [trainer.py] => increment: 5
2025-01-05 13:50:14,082 [trainer.py] => kshot: 5
2025-01-05 13:50:14,082 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 13:50:14,082 [trainer.py] => z_dim: 1000
2025-01-05 13:50:14,082 [trainer.py] => conv_dim: 64
2025-01-05 13:50:14,082 [trainer.py] => img_size: 224
2025-01-05 13:50:14,082 [trainer.py] => generator_lr: 0.005
2025-01-05 13:50:14,082 [trainer.py] => pi: 100
2025-01-05 13:50:14,082 [trainer.py] => w_bn: 50.0
2025-01-05 13:50:14,082 [trainer.py] => w_noise: 0.001
2025-01-05 13:50:14,082 [trainer.py] => server_ss: 32
2025-01-05 13:50:14,082 [trainer.py] => bn_loss: 1
2025-01-05 13:50:14,082 [trainer.py] => noise: 1
2025-01-05 13:50:14,082 [trainer.py] => ie_loss: 1
2025-01-05 13:50:14,082 [trainer.py] => act_loss: 0
2025-01-05 13:50:14,082 [trainer.py] => w_ie: 1.0
2025-01-05 13:50:14,082 [trainer.py] => w_act: 0.1
2025-01-05 13:50:14,082 [trainer.py] => syn_size: 32
2025-01-05 13:50:14,082 [trainer.py] => need_syn_imgs: True
2025-01-05 13:50:14,082 [trainer.py] => g_local_bs: 12
2025-01-05 13:50:14,083 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 13:50:14,083 [trainer.py] => g_local_train_steps: 50
2025-01-05 13:50:14,083 [trainer.py] => dataset_syn: cifar100
2025-01-05 13:50:14,083 [trainer.py] => com_round_gen: 10
2025-01-05 13:50:14,083 [trainer.py] => vpt_type: Deep
2025-01-05 13:50:14,083 [trainer.py] => prompt_token_num: 6
2025-01-05 13:50:14,083 [trainer.py] => avg_alpha: 0.8
2025-01-05 13:50:14,083 [trainer.py] => perturb_var: 1
2025-01-05 13:50:14,083 [trainer.py] => EMA_beta: 0.99
2025-01-05 13:50:14,083 [trainer.py] => anchor_lambda: 0.1
2025-01-05 13:50:14,083 [trainer.py] => kl_weight: 0.001
2025-01-05 13:50:14,083 [trainer.py] => TIP_init: zero
2025-01-05 13:50:14,083 [trainer.py] => tuned_epoch: 10
2025-01-05 13:50:14,083 [trainer.py] => fs_epoch: 0
2025-01-05 13:50:14,083 [trainer.py] => init_lr: 0.01
2025-01-05 13:50:14,083 [trainer.py] => fs_lr: 0.001
2025-01-05 13:50:14,083 [trainer.py] => batch_size: 48
2025-01-05 13:50:14,083 [trainer.py] => fs_batch_size: 16
2025-01-05 13:50:14,083 [trainer.py] => weight_decay: 0.0005
2025-01-05 13:50:14,083 [trainer.py] => min_lr: 0
2025-01-05 13:50:14,083 [trainer.py] => optimizer: sgd
2025-01-05 13:50:14,083 [trainer.py] => memory_size: 0
2025-01-05 13:50:14,083 [trainer.py] => memory_per_class: 0
2025-01-05 13:50:14,083 [trainer.py] => fixed_memory: False
2025-01-05 13:50:14,084 [trainer.py] => shuffle: False
2025-01-05 13:50:14,084 [trainer.py] => top_k: 5
2025-01-05 13:50:14,084 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 13:50:14,084 [trainer.py] => prefix: asp
2025-01-05 13:50:14,084 [trainer.py] => model_prefix: asp
2025-01-05 13:50:15,968 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 13:50:53,084 [trainer.py] => All params: 173596160
2025-01-05 13:50:53,085 [trainer.py] => Trainable params: 1998848
2025-01-05 13:50:53,086 [asp.py] => Learning on 0-60
2025-01-05 13:50:53,215 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 13:54:04,548 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 13:54:04,548 [trainer.py] => model_name: asp
2025-01-05 13:54:04,549 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 13:54:04,549 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 13:54:04,549 [trainer.py] => seed: 2024
2025-01-05 13:54:04,549 [trainer.py] => dataset: cifar224
2025-01-05 13:54:04,549 [trainer.py] => init_cls: 60
2025-01-05 13:54:04,549 [trainer.py] => increment: 5
2025-01-05 13:54:04,549 [trainer.py] => kshot: 5
2025-01-05 13:54:04,549 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 13:54:04,549 [trainer.py] => z_dim: 1000
2025-01-05 13:54:04,549 [trainer.py] => conv_dim: 64
2025-01-05 13:54:04,549 [trainer.py] => img_size: 224
2025-01-05 13:54:04,549 [trainer.py] => generator_lr: 0.005
2025-01-05 13:54:04,549 [trainer.py] => pi: 100
2025-01-05 13:54:04,549 [trainer.py] => w_bn: 50.0
2025-01-05 13:54:04,549 [trainer.py] => w_noise: 0.001
2025-01-05 13:54:04,549 [trainer.py] => server_ss: 32
2025-01-05 13:54:04,549 [trainer.py] => bn_loss: 1
2025-01-05 13:54:04,549 [trainer.py] => noise: 1
2025-01-05 13:54:04,549 [trainer.py] => ie_loss: 1
2025-01-05 13:54:04,549 [trainer.py] => act_loss: 0
2025-01-05 13:54:04,549 [trainer.py] => w_ie: 1.0
2025-01-05 13:54:04,549 [trainer.py] => w_act: 0.1
2025-01-05 13:54:04,549 [trainer.py] => syn_size: 32
2025-01-05 13:54:04,549 [trainer.py] => need_syn_imgs: True
2025-01-05 13:54:04,549 [trainer.py] => g_local_bs: 12
2025-01-05 13:54:04,549 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 13:54:04,550 [trainer.py] => g_local_train_steps: 50
2025-01-05 13:54:04,550 [trainer.py] => dataset_syn: cifar100
2025-01-05 13:54:04,550 [trainer.py] => com_round_gen: 10
2025-01-05 13:54:04,550 [trainer.py] => vpt_type: Deep
2025-01-05 13:54:04,550 [trainer.py] => prompt_token_num: 6
2025-01-05 13:54:04,550 [trainer.py] => avg_alpha: 0.8
2025-01-05 13:54:04,550 [trainer.py] => perturb_var: 1
2025-01-05 13:54:04,550 [trainer.py] => EMA_beta: 0.99
2025-01-05 13:54:04,550 [trainer.py] => anchor_lambda: 0.1
2025-01-05 13:54:04,550 [trainer.py] => kl_weight: 0.001
2025-01-05 13:54:04,550 [trainer.py] => TIP_init: zero
2025-01-05 13:54:04,550 [trainer.py] => tuned_epoch: 10
2025-01-05 13:54:04,550 [trainer.py] => fs_epoch: 0
2025-01-05 13:54:04,550 [trainer.py] => init_lr: 0.01
2025-01-05 13:54:04,550 [trainer.py] => fs_lr: 0.001
2025-01-05 13:54:04,550 [trainer.py] => batch_size: 48
2025-01-05 13:54:04,550 [trainer.py] => fs_batch_size: 16
2025-01-05 13:54:04,550 [trainer.py] => weight_decay: 0.0005
2025-01-05 13:54:04,550 [trainer.py] => min_lr: 0
2025-01-05 13:54:04,550 [trainer.py] => optimizer: sgd
2025-01-05 13:54:04,550 [trainer.py] => memory_size: 0
2025-01-05 13:54:04,550 [trainer.py] => memory_per_class: 0
2025-01-05 13:54:04,550 [trainer.py] => fixed_memory: False
2025-01-05 13:54:04,550 [trainer.py] => shuffle: False
2025-01-05 13:54:04,550 [trainer.py] => top_k: 5
2025-01-05 13:54:04,550 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 13:54:04,550 [trainer.py] => prefix: asp
2025-01-05 13:54:04,550 [trainer.py] => model_prefix: asp
2025-01-05 13:54:06,229 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 13:54:39,468 [trainer.py] => All params: 173596160
2025-01-05 13:54:39,469 [trainer.py] => Trainable params: 1998848
2025-01-05 13:54:39,470 [asp.py] => Learning on 0-60
2025-01-05 13:54:39,846 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 13:55:33,253 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 13:55:33,253 [trainer.py] => model_name: asp
2025-01-05 13:55:33,253 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 13:55:33,253 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 13:55:33,253 [trainer.py] => seed: 2024
2025-01-05 13:55:33,253 [trainer.py] => dataset: cifar224
2025-01-05 13:55:33,254 [trainer.py] => init_cls: 60
2025-01-05 13:55:33,254 [trainer.py] => increment: 5
2025-01-05 13:55:33,254 [trainer.py] => kshot: 5
2025-01-05 13:55:33,254 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 13:55:33,254 [trainer.py] => z_dim: 1000
2025-01-05 13:55:33,254 [trainer.py] => conv_dim: 64
2025-01-05 13:55:33,254 [trainer.py] => img_size: 224
2025-01-05 13:55:33,254 [trainer.py] => generator_lr: 0.005
2025-01-05 13:55:33,254 [trainer.py] => pi: 100
2025-01-05 13:55:33,254 [trainer.py] => w_bn: 50.0
2025-01-05 13:55:33,254 [trainer.py] => w_noise: 0.001
2025-01-05 13:55:33,254 [trainer.py] => server_ss: 32
2025-01-05 13:55:33,254 [trainer.py] => bn_loss: 1
2025-01-05 13:55:33,254 [trainer.py] => noise: 1
2025-01-05 13:55:33,254 [trainer.py] => ie_loss: 1
2025-01-05 13:55:33,254 [trainer.py] => act_loss: 0
2025-01-05 13:55:33,254 [trainer.py] => w_ie: 1.0
2025-01-05 13:55:33,254 [trainer.py] => w_act: 0.1
2025-01-05 13:55:33,254 [trainer.py] => syn_size: 32
2025-01-05 13:55:33,254 [trainer.py] => need_syn_imgs: True
2025-01-05 13:55:33,255 [trainer.py] => g_local_bs: 12
2025-01-05 13:55:33,255 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 13:55:33,255 [trainer.py] => g_local_train_steps: 50
2025-01-05 13:55:33,255 [trainer.py] => dataset_syn: cifar100
2025-01-05 13:55:33,255 [trainer.py] => com_round_gen: 10
2025-01-05 13:55:33,255 [trainer.py] => vpt_type: Deep
2025-01-05 13:55:33,255 [trainer.py] => prompt_token_num: 6
2025-01-05 13:55:33,255 [trainer.py] => avg_alpha: 0.8
2025-01-05 13:55:33,255 [trainer.py] => perturb_var: 1
2025-01-05 13:55:33,255 [trainer.py] => EMA_beta: 0.99
2025-01-05 13:55:33,255 [trainer.py] => anchor_lambda: 0.1
2025-01-05 13:55:33,255 [trainer.py] => kl_weight: 0.001
2025-01-05 13:55:33,255 [trainer.py] => TIP_init: zero
2025-01-05 13:55:33,255 [trainer.py] => tuned_epoch: 10
2025-01-05 13:55:33,255 [trainer.py] => fs_epoch: 0
2025-01-05 13:55:33,255 [trainer.py] => init_lr: 0.01
2025-01-05 13:55:33,255 [trainer.py] => fs_lr: 0.001
2025-01-05 13:55:33,255 [trainer.py] => batch_size: 48
2025-01-05 13:55:33,256 [trainer.py] => fs_batch_size: 16
2025-01-05 13:55:33,256 [trainer.py] => weight_decay: 0.0005
2025-01-05 13:55:33,256 [trainer.py] => min_lr: 0
2025-01-05 13:55:33,256 [trainer.py] => optimizer: sgd
2025-01-05 13:55:33,256 [trainer.py] => memory_size: 0
2025-01-05 13:55:33,256 [trainer.py] => memory_per_class: 0
2025-01-05 13:55:33,256 [trainer.py] => fixed_memory: False
2025-01-05 13:55:33,256 [trainer.py] => shuffle: False
2025-01-05 13:55:33,256 [trainer.py] => top_k: 5
2025-01-05 13:55:33,256 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 13:55:33,256 [trainer.py] => prefix: asp
2025-01-05 13:55:33,256 [trainer.py] => model_prefix: asp
2025-01-05 13:55:35,068 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 13:56:07,803 [trainer.py] => All params: 173596160
2025-01-05 13:56:07,804 [trainer.py] => Trainable params: 1998848
2025-01-05 13:56:07,804 [asp.py] => Learning on 0-60
2025-01-05 13:56:07,986 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 13:56:35,370 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 13:56:35,371 [trainer.py] => model_name: asp
2025-01-05 13:56:35,371 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 13:56:35,371 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 13:56:35,371 [trainer.py] => seed: 2024
2025-01-05 13:56:35,371 [trainer.py] => dataset: cifar224
2025-01-05 13:56:35,371 [trainer.py] => init_cls: 60
2025-01-05 13:56:35,371 [trainer.py] => increment: 5
2025-01-05 13:56:35,371 [trainer.py] => kshot: 5
2025-01-05 13:56:35,371 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 13:56:35,371 [trainer.py] => z_dim: 1000
2025-01-05 13:56:35,371 [trainer.py] => conv_dim: 64
2025-01-05 13:56:35,371 [trainer.py] => img_size: 224
2025-01-05 13:56:35,371 [trainer.py] => generator_lr: 0.005
2025-01-05 13:56:35,371 [trainer.py] => pi: 100
2025-01-05 13:56:35,371 [trainer.py] => w_bn: 50.0
2025-01-05 13:56:35,371 [trainer.py] => w_noise: 0.001
2025-01-05 13:56:35,371 [trainer.py] => server_ss: 32
2025-01-05 13:56:35,371 [trainer.py] => bn_loss: 1
2025-01-05 13:56:35,371 [trainer.py] => noise: 1
2025-01-05 13:56:35,372 [trainer.py] => ie_loss: 1
2025-01-05 13:56:35,372 [trainer.py] => act_loss: 0
2025-01-05 13:56:35,372 [trainer.py] => w_ie: 1.0
2025-01-05 13:56:35,372 [trainer.py] => w_act: 0.1
2025-01-05 13:56:35,372 [trainer.py] => syn_size: 32
2025-01-05 13:56:35,372 [trainer.py] => need_syn_imgs: True
2025-01-05 13:56:35,372 [trainer.py] => g_local_bs: 12
2025-01-05 13:56:35,372 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 13:56:35,372 [trainer.py] => g_local_train_steps: 50
2025-01-05 13:56:35,372 [trainer.py] => dataset_syn: cifar100
2025-01-05 13:56:35,372 [trainer.py] => com_round_gen: 10
2025-01-05 13:56:35,372 [trainer.py] => vpt_type: Deep
2025-01-05 13:56:35,372 [trainer.py] => prompt_token_num: 6
2025-01-05 13:56:35,372 [trainer.py] => avg_alpha: 0.8
2025-01-05 13:56:35,372 [trainer.py] => perturb_var: 1
2025-01-05 13:56:35,372 [trainer.py] => EMA_beta: 0.99
2025-01-05 13:56:35,372 [trainer.py] => anchor_lambda: 0.1
2025-01-05 13:56:35,372 [trainer.py] => kl_weight: 0.001
2025-01-05 13:56:35,372 [trainer.py] => TIP_init: zero
2025-01-05 13:56:35,372 [trainer.py] => tuned_epoch: 10
2025-01-05 13:56:35,372 [trainer.py] => fs_epoch: 0
2025-01-05 13:56:35,372 [trainer.py] => init_lr: 0.01
2025-01-05 13:56:35,372 [trainer.py] => fs_lr: 0.001
2025-01-05 13:56:35,372 [trainer.py] => batch_size: 48
2025-01-05 13:56:35,372 [trainer.py] => fs_batch_size: 16
2025-01-05 13:56:35,372 [trainer.py] => weight_decay: 0.0005
2025-01-05 13:56:35,372 [trainer.py] => min_lr: 0
2025-01-05 13:56:35,372 [trainer.py] => optimizer: sgd
2025-01-05 13:56:35,372 [trainer.py] => memory_size: 0
2025-01-05 13:56:35,372 [trainer.py] => memory_per_class: 0
2025-01-05 13:56:35,372 [trainer.py] => fixed_memory: False
2025-01-05 13:56:35,372 [trainer.py] => shuffle: False
2025-01-05 13:56:35,372 [trainer.py] => top_k: 5
2025-01-05 13:56:35,372 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 13:56:35,372 [trainer.py] => prefix: asp
2025-01-05 13:56:35,372 [trainer.py] => model_prefix: asp
2025-01-05 13:56:37,116 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 13:57:07,477 [trainer.py] => All params: 173596160
2025-01-05 13:57:07,478 [trainer.py] => Trainable params: 1998848
2025-01-05 13:57:07,478 [asp.py] => Learning on 0-60
2025-01-05 13:57:07,558 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 14:04:02,068 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 14:04:02,069 [trainer.py] => model_name: asp
2025-01-05 14:04:02,069 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 14:04:02,069 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 14:04:02,069 [trainer.py] => seed: 2024
2025-01-05 14:04:02,069 [trainer.py] => dataset: cifar224
2025-01-05 14:04:02,069 [trainer.py] => init_cls: 60
2025-01-05 14:04:02,069 [trainer.py] => increment: 5
2025-01-05 14:04:02,069 [trainer.py] => kshot: 5
2025-01-05 14:04:02,069 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 14:04:02,069 [trainer.py] => z_dim: 1000
2025-01-05 14:04:02,069 [trainer.py] => conv_dim: 64
2025-01-05 14:04:02,069 [trainer.py] => img_size: 224
2025-01-05 14:04:02,069 [trainer.py] => generator_lr: 0.005
2025-01-05 14:04:02,069 [trainer.py] => pi: 100
2025-01-05 14:04:02,069 [trainer.py] => w_bn: 50.0
2025-01-05 14:04:02,069 [trainer.py] => w_noise: 0.001
2025-01-05 14:04:02,069 [trainer.py] => server_ss: 32
2025-01-05 14:04:02,069 [trainer.py] => bn_loss: 1
2025-01-05 14:04:02,069 [trainer.py] => noise: 1
2025-01-05 14:04:02,069 [trainer.py] => ie_loss: 1
2025-01-05 14:04:02,069 [trainer.py] => act_loss: 0
2025-01-05 14:04:02,069 [trainer.py] => w_ie: 1.0
2025-01-05 14:04:02,069 [trainer.py] => w_act: 0.1
2025-01-05 14:04:02,069 [trainer.py] => syn_size: 32
2025-01-05 14:04:02,069 [trainer.py] => need_syn_imgs: True
2025-01-05 14:04:02,069 [trainer.py] => g_local_bs: 12
2025-01-05 14:04:02,069 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 14:04:02,069 [trainer.py] => g_local_train_steps: 50
2025-01-05 14:04:02,069 [trainer.py] => dataset_syn: cifar100
2025-01-05 14:04:02,069 [trainer.py] => com_round_gen: 10
2025-01-05 14:04:02,069 [trainer.py] => vpt_type: Deep
2025-01-05 14:04:02,069 [trainer.py] => prompt_token_num: 6
2025-01-05 14:04:02,070 [trainer.py] => avg_alpha: 0.8
2025-01-05 14:04:02,070 [trainer.py] => perturb_var: 1
2025-01-05 14:04:02,070 [trainer.py] => EMA_beta: 0.99
2025-01-05 14:04:02,070 [trainer.py] => anchor_lambda: 0.1
2025-01-05 14:04:02,070 [trainer.py] => kl_weight: 0.001
2025-01-05 14:04:02,070 [trainer.py] => TIP_init: zero
2025-01-05 14:04:02,070 [trainer.py] => tuned_epoch: 10
2025-01-05 14:04:02,070 [trainer.py] => fs_epoch: 0
2025-01-05 14:04:02,070 [trainer.py] => init_lr: 0.01
2025-01-05 14:04:02,070 [trainer.py] => fs_lr: 0.001
2025-01-05 14:04:02,070 [trainer.py] => batch_size: 48
2025-01-05 14:04:02,070 [trainer.py] => fs_batch_size: 16
2025-01-05 14:04:02,070 [trainer.py] => weight_decay: 0.0005
2025-01-05 14:04:02,070 [trainer.py] => min_lr: 0
2025-01-05 14:04:02,070 [trainer.py] => optimizer: sgd
2025-01-05 14:04:02,070 [trainer.py] => memory_size: 0
2025-01-05 14:04:02,070 [trainer.py] => memory_per_class: 0
2025-01-05 14:04:02,070 [trainer.py] => fixed_memory: False
2025-01-05 14:04:02,070 [trainer.py] => shuffle: False
2025-01-05 14:04:02,070 [trainer.py] => top_k: 5
2025-01-05 14:04:02,070 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 14:04:02,070 [trainer.py] => prefix: asp
2025-01-05 14:04:02,070 [trainer.py] => model_prefix: asp
2025-01-05 14:04:03,916 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 14:04:46,886 [trainer.py] => All params: 173596160
2025-01-05 14:04:46,887 [trainer.py] => Trainable params: 1998848
2025-01-05 14:04:46,889 [asp.py] => Learning on 0-60
2025-01-05 14:04:47,011 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 14:14:18,417 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 14:14:18,417 [trainer.py] => model_name: asp
2025-01-05 14:14:18,418 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 14:14:18,418 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 14:14:18,418 [trainer.py] => seed: 2024
2025-01-05 14:14:18,418 [trainer.py] => dataset: cifar224
2025-01-05 14:14:18,418 [trainer.py] => init_cls: 60
2025-01-05 14:14:18,418 [trainer.py] => increment: 5
2025-01-05 14:14:18,418 [trainer.py] => kshot: 5
2025-01-05 14:14:18,418 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 14:14:18,418 [trainer.py] => z_dim: 1000
2025-01-05 14:14:18,418 [trainer.py] => conv_dim: 64
2025-01-05 14:14:18,418 [trainer.py] => img_size: 224
2025-01-05 14:14:18,418 [trainer.py] => generator_lr: 0.005
2025-01-05 14:14:18,418 [trainer.py] => pi: 100
2025-01-05 14:14:18,418 [trainer.py] => w_bn: 50.0
2025-01-05 14:14:18,418 [trainer.py] => w_noise: 0.001
2025-01-05 14:14:18,418 [trainer.py] => server_ss: 32
2025-01-05 14:14:18,418 [trainer.py] => bn_loss: 1
2025-01-05 14:14:18,418 [trainer.py] => noise: 1
2025-01-05 14:14:18,418 [trainer.py] => ie_loss: 1
2025-01-05 14:14:18,418 [trainer.py] => act_loss: 0
2025-01-05 14:14:18,418 [trainer.py] => w_ie: 1.0
2025-01-05 14:14:18,418 [trainer.py] => w_act: 0.1
2025-01-05 14:14:18,418 [trainer.py] => syn_size: 32
2025-01-05 14:14:18,418 [trainer.py] => need_syn_imgs: True
2025-01-05 14:14:18,418 [trainer.py] => g_local_bs: 12
2025-01-05 14:14:18,418 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 14:14:18,418 [trainer.py] => g_local_train_steps: 50
2025-01-05 14:14:18,418 [trainer.py] => dataset_syn: cifar100
2025-01-05 14:14:18,418 [trainer.py] => com_round_gen: 10
2025-01-05 14:14:18,418 [trainer.py] => vpt_type: Deep
2025-01-05 14:14:18,418 [trainer.py] => prompt_token_num: 6
2025-01-05 14:14:18,418 [trainer.py] => avg_alpha: 0.8
2025-01-05 14:14:18,419 [trainer.py] => perturb_var: 1
2025-01-05 14:14:18,419 [trainer.py] => EMA_beta: 0.99
2025-01-05 14:14:18,419 [trainer.py] => anchor_lambda: 0.1
2025-01-05 14:14:18,419 [trainer.py] => kl_weight: 0.001
2025-01-05 14:14:18,419 [trainer.py] => TIP_init: zero
2025-01-05 14:14:18,419 [trainer.py] => tuned_epoch: 10
2025-01-05 14:14:18,419 [trainer.py] => fs_epoch: 0
2025-01-05 14:14:18,419 [trainer.py] => init_lr: 0.01
2025-01-05 14:14:18,419 [trainer.py] => fs_lr: 0.001
2025-01-05 14:14:18,419 [trainer.py] => batch_size: 48
2025-01-05 14:14:18,419 [trainer.py] => fs_batch_size: 16
2025-01-05 14:14:18,419 [trainer.py] => weight_decay: 0.0005
2025-01-05 14:14:18,419 [trainer.py] => min_lr: 0
2025-01-05 14:14:18,419 [trainer.py] => optimizer: sgd
2025-01-05 14:14:18,419 [trainer.py] => memory_size: 0
2025-01-05 14:14:18,419 [trainer.py] => memory_per_class: 0
2025-01-05 14:14:18,419 [trainer.py] => fixed_memory: False
2025-01-05 14:14:18,419 [trainer.py] => shuffle: False
2025-01-05 14:14:18,419 [trainer.py] => top_k: 5
2025-01-05 14:14:18,419 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 14:14:18,419 [trainer.py] => prefix: asp
2025-01-05 14:14:18,419 [trainer.py] => model_prefix: asp
2025-01-05 14:14:20,140 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 14:14:51,607 [trainer.py] => All params: 173596160
2025-01-05 14:14:51,608 [trainer.py] => Trainable params: 1998848
2025-01-05 14:14:51,609 [asp.py] => Learning on 0-60
2025-01-05 14:14:51,697 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 14:28:31,457 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 14:28:31,457 [trainer.py] => model_name: asp
2025-01-05 14:28:31,457 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 14:28:31,457 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 14:28:31,457 [trainer.py] => seed: 2024
2025-01-05 14:28:31,457 [trainer.py] => dataset: cifar224
2025-01-05 14:28:31,457 [trainer.py] => init_cls: 60
2025-01-05 14:28:31,457 [trainer.py] => increment: 5
2025-01-05 14:28:31,457 [trainer.py] => kshot: 5
2025-01-05 14:28:31,457 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 14:28:31,457 [trainer.py] => z_dim: 1000
2025-01-05 14:28:31,457 [trainer.py] => conv_dim: 64
2025-01-05 14:28:31,457 [trainer.py] => img_size: 224
2025-01-05 14:28:31,457 [trainer.py] => generator_lr: 0.005
2025-01-05 14:28:31,457 [trainer.py] => pi: 100
2025-01-05 14:28:31,457 [trainer.py] => w_bn: 50.0
2025-01-05 14:28:31,457 [trainer.py] => w_noise: 0.001
2025-01-05 14:28:31,457 [trainer.py] => server_ss: 32
2025-01-05 14:28:31,457 [trainer.py] => bn_loss: 1
2025-01-05 14:28:31,457 [trainer.py] => noise: 1
2025-01-05 14:28:31,458 [trainer.py] => ie_loss: 1
2025-01-05 14:28:31,458 [trainer.py] => act_loss: 0
2025-01-05 14:28:31,458 [trainer.py] => w_ie: 1.0
2025-01-05 14:28:31,458 [trainer.py] => w_act: 0.1
2025-01-05 14:28:31,458 [trainer.py] => syn_size: 32
2025-01-05 14:28:31,458 [trainer.py] => need_syn_imgs: True
2025-01-05 14:28:31,458 [trainer.py] => g_local_bs: 12
2025-01-05 14:28:31,458 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 14:28:31,458 [trainer.py] => g_local_train_steps: 50
2025-01-05 14:28:31,458 [trainer.py] => dataset_syn: cifar100
2025-01-05 14:28:31,458 [trainer.py] => com_round_gen: 10
2025-01-05 14:28:31,458 [trainer.py] => vpt_type: Deep
2025-01-05 14:28:31,458 [trainer.py] => prompt_token_num: 6
2025-01-05 14:28:31,458 [trainer.py] => avg_alpha: 0.8
2025-01-05 14:28:31,458 [trainer.py] => perturb_var: 1
2025-01-05 14:28:31,458 [trainer.py] => EMA_beta: 0.99
2025-01-05 14:28:31,458 [trainer.py] => anchor_lambda: 0.1
2025-01-05 14:28:31,458 [trainer.py] => kl_weight: 0.001
2025-01-05 14:28:31,458 [trainer.py] => TIP_init: zero
2025-01-05 14:28:31,458 [trainer.py] => tuned_epoch: 10
2025-01-05 14:28:31,458 [trainer.py] => fs_epoch: 0
2025-01-05 14:28:31,458 [trainer.py] => init_lr: 0.01
2025-01-05 14:28:31,458 [trainer.py] => fs_lr: 0.001
2025-01-05 14:28:31,458 [trainer.py] => batch_size: 48
2025-01-05 14:28:31,458 [trainer.py] => fs_batch_size: 16
2025-01-05 14:28:31,458 [trainer.py] => weight_decay: 0.0005
2025-01-05 14:28:31,458 [trainer.py] => min_lr: 0
2025-01-05 14:28:31,458 [trainer.py] => optimizer: sgd
2025-01-05 14:28:31,458 [trainer.py] => memory_size: 0
2025-01-05 14:28:31,458 [trainer.py] => memory_per_class: 0
2025-01-05 14:28:31,458 [trainer.py] => fixed_memory: False
2025-01-05 14:28:31,458 [trainer.py] => shuffle: False
2025-01-05 14:28:31,458 [trainer.py] => top_k: 5
2025-01-05 14:28:31,458 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 14:28:31,459 [trainer.py] => prefix: asp
2025-01-05 14:28:31,459 [trainer.py] => model_prefix: asp
2025-01-05 14:28:33,476 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 14:29:09,812 [trainer.py] => All params: 173596160
2025-01-05 14:29:09,813 [trainer.py] => Trainable params: 1998848
2025-01-05 14:29:09,814 [asp.py] => Learning on 0-60
2025-01-05 14:29:10,036 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 14:30:25,376 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 14:30:25,376 [trainer.py] => model_name: asp
2025-01-05 14:30:25,376 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 14:30:25,376 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 14:30:25,376 [trainer.py] => seed: 2024
2025-01-05 14:30:25,376 [trainer.py] => dataset: cifar224
2025-01-05 14:30:25,376 [trainer.py] => init_cls: 60
2025-01-05 14:30:25,376 [trainer.py] => increment: 5
2025-01-05 14:30:25,377 [trainer.py] => kshot: 5
2025-01-05 14:30:25,377 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 14:30:25,377 [trainer.py] => z_dim: 1000
2025-01-05 14:30:25,377 [trainer.py] => conv_dim: 64
2025-01-05 14:30:25,377 [trainer.py] => img_size: 224
2025-01-05 14:30:25,377 [trainer.py] => generator_lr: 0.005
2025-01-05 14:30:25,377 [trainer.py] => pi: 100
2025-01-05 14:30:25,377 [trainer.py] => w_bn: 50.0
2025-01-05 14:30:25,377 [trainer.py] => w_noise: 0.001
2025-01-05 14:30:25,377 [trainer.py] => server_ss: 32
2025-01-05 14:30:25,377 [trainer.py] => bn_loss: 1
2025-01-05 14:30:25,377 [trainer.py] => noise: 1
2025-01-05 14:30:25,377 [trainer.py] => ie_loss: 1
2025-01-05 14:30:25,377 [trainer.py] => act_loss: 0
2025-01-05 14:30:25,377 [trainer.py] => w_ie: 1.0
2025-01-05 14:30:25,377 [trainer.py] => w_act: 0.1
2025-01-05 14:30:25,377 [trainer.py] => syn_size: 32
2025-01-05 14:30:25,377 [trainer.py] => need_syn_imgs: True
2025-01-05 14:30:25,377 [trainer.py] => g_local_bs: 12
2025-01-05 14:30:25,377 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 14:30:25,377 [trainer.py] => g_local_train_steps: 50
2025-01-05 14:30:25,377 [trainer.py] => dataset_syn: cifar100
2025-01-05 14:30:25,378 [trainer.py] => com_round_gen: 10
2025-01-05 14:30:25,378 [trainer.py] => vpt_type: Deep
2025-01-05 14:30:25,378 [trainer.py] => prompt_token_num: 6
2025-01-05 14:30:25,378 [trainer.py] => avg_alpha: 0.8
2025-01-05 14:30:25,378 [trainer.py] => perturb_var: 1
2025-01-05 14:30:25,378 [trainer.py] => EMA_beta: 0.99
2025-01-05 14:30:25,378 [trainer.py] => anchor_lambda: 0.1
2025-01-05 14:30:25,378 [trainer.py] => kl_weight: 0.001
2025-01-05 14:30:25,378 [trainer.py] => TIP_init: zero
2025-01-05 14:30:25,378 [trainer.py] => tuned_epoch: 10
2025-01-05 14:30:25,378 [trainer.py] => fs_epoch: 0
2025-01-05 14:30:25,378 [trainer.py] => init_lr: 0.01
2025-01-05 14:30:25,378 [trainer.py] => fs_lr: 0.001
2025-01-05 14:30:25,378 [trainer.py] => batch_size: 48
2025-01-05 14:30:25,378 [trainer.py] => fs_batch_size: 16
2025-01-05 14:30:25,378 [trainer.py] => weight_decay: 0.0005
2025-01-05 14:30:25,378 [trainer.py] => min_lr: 0
2025-01-05 14:30:25,378 [trainer.py] => optimizer: sgd
2025-01-05 14:30:25,378 [trainer.py] => memory_size: 0
2025-01-05 14:30:25,378 [trainer.py] => memory_per_class: 0
2025-01-05 14:30:25,378 [trainer.py] => fixed_memory: False
2025-01-05 14:30:25,378 [trainer.py] => shuffle: False
2025-01-05 14:30:25,379 [trainer.py] => top_k: 5
2025-01-05 14:30:25,379 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 14:30:25,379 [trainer.py] => prefix: asp
2025-01-05 14:30:25,379 [trainer.py] => model_prefix: asp
2025-01-05 14:30:27,208 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 14:31:05,219 [trainer.py] => All params: 173596160
2025-01-05 14:31:05,220 [trainer.py] => Trainable params: 1998848
2025-01-05 14:31:05,221 [asp.py] => Learning on 0-60
2025-01-05 14:31:05,302 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 14:54:11,150 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 14:54:11,150 [trainer.py] => model_name: asp
2025-01-05 14:54:11,150 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 14:54:11,150 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 14:54:11,151 [trainer.py] => seed: 2024
2025-01-05 14:54:11,151 [trainer.py] => dataset: cifar224
2025-01-05 14:54:11,151 [trainer.py] => init_cls: 60
2025-01-05 14:54:11,151 [trainer.py] => increment: 5
2025-01-05 14:54:11,151 [trainer.py] => kshot: 5
2025-01-05 14:54:11,151 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 14:54:11,151 [trainer.py] => z_dim: 1000
2025-01-05 14:54:11,151 [trainer.py] => conv_dim: 64
2025-01-05 14:54:11,151 [trainer.py] => img_size: 224
2025-01-05 14:54:11,151 [trainer.py] => generator_lr: 0.005
2025-01-05 14:54:11,151 [trainer.py] => pi: 100
2025-01-05 14:54:11,151 [trainer.py] => w_bn: 50.0
2025-01-05 14:54:11,151 [trainer.py] => w_noise: 0.001
2025-01-05 14:54:11,151 [trainer.py] => server_ss: 32
2025-01-05 14:54:11,151 [trainer.py] => bn_loss: 1
2025-01-05 14:54:11,151 [trainer.py] => noise: 1
2025-01-05 14:54:11,151 [trainer.py] => ie_loss: 1
2025-01-05 14:54:11,151 [trainer.py] => act_loss: 0
2025-01-05 14:54:11,151 [trainer.py] => w_ie: 1.0
2025-01-05 14:54:11,151 [trainer.py] => w_act: 0.1
2025-01-05 14:54:11,151 [trainer.py] => syn_size: 32
2025-01-05 14:54:11,152 [trainer.py] => need_syn_imgs: True
2025-01-05 14:54:11,152 [trainer.py] => g_local_bs: 12
2025-01-05 14:54:11,152 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 14:54:11,152 [trainer.py] => g_local_train_steps: 50
2025-01-05 14:54:11,152 [trainer.py] => dataset_syn: cifar100
2025-01-05 14:54:11,152 [trainer.py] => com_round_gen: 10
2025-01-05 14:54:11,152 [trainer.py] => vpt_type: Deep
2025-01-05 14:54:11,152 [trainer.py] => prompt_token_num: 6
2025-01-05 14:54:11,152 [trainer.py] => avg_alpha: 0.8
2025-01-05 14:54:11,152 [trainer.py] => perturb_var: 1
2025-01-05 14:54:11,152 [trainer.py] => EMA_beta: 0.99
2025-01-05 14:54:11,152 [trainer.py] => anchor_lambda: 0.1
2025-01-05 14:54:11,152 [trainer.py] => kl_weight: 0.001
2025-01-05 14:54:11,152 [trainer.py] => TIP_init: zero
2025-01-05 14:54:11,152 [trainer.py] => tuned_epoch: 10
2025-01-05 14:54:11,152 [trainer.py] => fs_epoch: 0
2025-01-05 14:54:11,152 [trainer.py] => init_lr: 0.01
2025-01-05 14:54:11,152 [trainer.py] => fs_lr: 0.001
2025-01-05 14:54:11,152 [trainer.py] => batch_size: 48
2025-01-05 14:54:11,152 [trainer.py] => fs_batch_size: 16
2025-01-05 14:54:11,152 [trainer.py] => weight_decay: 0.0005
2025-01-05 14:54:11,152 [trainer.py] => min_lr: 0
2025-01-05 14:54:11,152 [trainer.py] => optimizer: sgd
2025-01-05 14:54:11,152 [trainer.py] => memory_size: 0
2025-01-05 14:54:11,152 [trainer.py] => memory_per_class: 0
2025-01-05 14:54:11,152 [trainer.py] => fixed_memory: False
2025-01-05 14:54:11,152 [trainer.py] => shuffle: False
2025-01-05 14:54:11,153 [trainer.py] => top_k: 5
2025-01-05 14:54:11,153 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 14:54:11,153 [trainer.py] => prefix: asp
2025-01-05 14:54:11,153 [trainer.py] => model_prefix: asp
2025-01-05 14:54:13,345 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 14:55:45,923 [trainer.py] => All params: 173596160
2025-01-05 14:55:45,926 [trainer.py] => Trainable params: 1998848
2025-01-05 14:55:45,931 [asp.py] => Learning on 0-60
2025-01-05 14:55:46,085 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 15:24:12,230 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:24:12,230 [trainer.py] => model_name: asp
2025-01-05 15:24:12,230 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:24:12,230 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:24:12,230 [trainer.py] => seed: 2024
2025-01-05 15:24:12,230 [trainer.py] => dataset: cifar224
2025-01-05 15:24:12,230 [trainer.py] => init_cls: 60
2025-01-05 15:24:12,230 [trainer.py] => increment: 5
2025-01-05 15:24:12,230 [trainer.py] => kshot: 5
2025-01-05 15:24:12,230 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:24:12,230 [trainer.py] => z_dim: 1000
2025-01-05 15:24:12,230 [trainer.py] => conv_dim: 64
2025-01-05 15:24:12,231 [trainer.py] => img_size: 224
2025-01-05 15:24:12,231 [trainer.py] => generator_lr: 0.005
2025-01-05 15:24:12,231 [trainer.py] => pi: 100
2025-01-05 15:24:12,231 [trainer.py] => w_bn: 50.0
2025-01-05 15:24:12,231 [trainer.py] => w_noise: 0.001
2025-01-05 15:24:12,231 [trainer.py] => server_ss: 32
2025-01-05 15:24:12,231 [trainer.py] => bn_loss: 1
2025-01-05 15:24:12,231 [trainer.py] => noise: 1
2025-01-05 15:24:12,231 [trainer.py] => ie_loss: 1
2025-01-05 15:24:12,231 [trainer.py] => act_loss: 0
2025-01-05 15:24:12,231 [trainer.py] => w_ie: 1.0
2025-01-05 15:24:12,231 [trainer.py] => w_act: 0.1
2025-01-05 15:24:12,231 [trainer.py] => syn_size: 32
2025-01-05 15:24:12,231 [trainer.py] => need_syn_imgs: True
2025-01-05 15:24:12,231 [trainer.py] => g_local_bs: 12
2025-01-05 15:24:12,231 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:24:12,231 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:24:12,231 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:24:12,231 [trainer.py] => com_round_gen: 10
2025-01-05 15:24:12,231 [trainer.py] => vpt_type: Deep
2025-01-05 15:24:12,231 [trainer.py] => prompt_token_num: 6
2025-01-05 15:24:12,231 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:24:12,231 [trainer.py] => perturb_var: 1
2025-01-05 15:24:12,231 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:24:12,231 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:24:12,231 [trainer.py] => kl_weight: 0.001
2025-01-05 15:24:12,231 [trainer.py] => TIP_init: zero
2025-01-05 15:24:12,231 [trainer.py] => tuned_epoch: 10
2025-01-05 15:24:12,231 [trainer.py] => fs_epoch: 0
2025-01-05 15:24:12,231 [trainer.py] => init_lr: 0.01
2025-01-05 15:24:12,231 [trainer.py] => fs_lr: 0.001
2025-01-05 15:24:12,231 [trainer.py] => batch_size: 48
2025-01-05 15:24:12,231 [trainer.py] => fs_batch_size: 16
2025-01-05 15:24:12,232 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:24:12,232 [trainer.py] => min_lr: 0
2025-01-05 15:24:12,232 [trainer.py] => optimizer: sgd
2025-01-05 15:24:12,232 [trainer.py] => memory_size: 0
2025-01-05 15:24:12,232 [trainer.py] => memory_per_class: 0
2025-01-05 15:24:12,232 [trainer.py] => fixed_memory: False
2025-01-05 15:24:12,232 [trainer.py] => shuffle: False
2025-01-05 15:24:12,232 [trainer.py] => top_k: 5
2025-01-05 15:24:12,232 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:24:12,232 [trainer.py] => prefix: asp
2025-01-05 15:24:12,232 [trainer.py] => model_prefix: asp
2025-01-05 15:24:14,154 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:24:52,534 [trainer.py] => All params: 173596160
2025-01-05 15:24:52,535 [trainer.py] => Trainable params: 1998848
2025-01-05 15:24:52,537 [asp.py] => Learning on 0-60
2025-01-05 15:24:52,902 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 15:25:56,429 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:25:56,429 [trainer.py] => model_name: asp
2025-01-05 15:25:56,429 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:25:56,429 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:25:56,429 [trainer.py] => seed: 2024
2025-01-05 15:25:56,429 [trainer.py] => dataset: cifar224
2025-01-05 15:25:56,429 [trainer.py] => init_cls: 60
2025-01-05 15:25:56,429 [trainer.py] => increment: 5
2025-01-05 15:25:56,429 [trainer.py] => kshot: 5
2025-01-05 15:25:56,429 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:25:56,429 [trainer.py] => z_dim: 1000
2025-01-05 15:25:56,429 [trainer.py] => conv_dim: 64
2025-01-05 15:25:56,429 [trainer.py] => img_size: 224
2025-01-05 15:25:56,429 [trainer.py] => generator_lr: 0.005
2025-01-05 15:25:56,429 [trainer.py] => pi: 100
2025-01-05 15:25:56,429 [trainer.py] => w_bn: 50.0
2025-01-05 15:25:56,429 [trainer.py] => w_noise: 0.001
2025-01-05 15:25:56,429 [trainer.py] => server_ss: 32
2025-01-05 15:25:56,429 [trainer.py] => bn_loss: 1
2025-01-05 15:25:56,429 [trainer.py] => noise: 1
2025-01-05 15:25:56,429 [trainer.py] => ie_loss: 1
2025-01-05 15:25:56,429 [trainer.py] => act_loss: 0
2025-01-05 15:25:56,429 [trainer.py] => w_ie: 1.0
2025-01-05 15:25:56,429 [trainer.py] => w_act: 0.1
2025-01-05 15:25:56,430 [trainer.py] => syn_size: 32
2025-01-05 15:25:56,430 [trainer.py] => need_syn_imgs: True
2025-01-05 15:25:56,430 [trainer.py] => g_local_bs: 12
2025-01-05 15:25:56,430 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:25:56,430 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:25:56,430 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:25:56,430 [trainer.py] => com_round_gen: 10
2025-01-05 15:25:56,430 [trainer.py] => vpt_type: Deep
2025-01-05 15:25:56,430 [trainer.py] => prompt_token_num: 6
2025-01-05 15:25:56,430 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:25:56,430 [trainer.py] => perturb_var: 1
2025-01-05 15:25:56,430 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:25:56,430 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:25:56,430 [trainer.py] => kl_weight: 0.001
2025-01-05 15:25:56,430 [trainer.py] => TIP_init: zero
2025-01-05 15:25:56,430 [trainer.py] => tuned_epoch: 10
2025-01-05 15:25:56,430 [trainer.py] => fs_epoch: 0
2025-01-05 15:25:56,430 [trainer.py] => init_lr: 0.01
2025-01-05 15:25:56,430 [trainer.py] => fs_lr: 0.001
2025-01-05 15:25:56,430 [trainer.py] => batch_size: 48
2025-01-05 15:25:56,430 [trainer.py] => fs_batch_size: 16
2025-01-05 15:25:56,430 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:25:56,430 [trainer.py] => min_lr: 0
2025-01-05 15:25:56,430 [trainer.py] => optimizer: sgd
2025-01-05 15:25:56,430 [trainer.py] => memory_size: 0
2025-01-05 15:25:56,430 [trainer.py] => memory_per_class: 0
2025-01-05 15:25:56,430 [trainer.py] => fixed_memory: False
2025-01-05 15:25:56,430 [trainer.py] => shuffle: False
2025-01-05 15:25:56,430 [trainer.py] => top_k: 5
2025-01-05 15:25:56,430 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:25:56,430 [trainer.py] => prefix: asp
2025-01-05 15:25:56,430 [trainer.py] => model_prefix: asp
2025-01-05 15:25:58,151 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:26:32,377 [trainer.py] => All params: 173596160
2025-01-05 15:26:32,378 [trainer.py] => Trainable params: 1998848
2025-01-05 15:26:32,379 [asp.py] => Learning on 0-60
2025-01-05 15:26:32,474 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 15:30:16,616 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:30:16,616 [trainer.py] => model_name: asp
2025-01-05 15:30:16,616 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:30:16,616 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:30:16,616 [trainer.py] => seed: 2024
2025-01-05 15:30:16,616 [trainer.py] => dataset: cifar224
2025-01-05 15:30:16,616 [trainer.py] => init_cls: 60
2025-01-05 15:30:16,616 [trainer.py] => increment: 5
2025-01-05 15:30:16,616 [trainer.py] => kshot: 5
2025-01-05 15:30:16,616 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:30:16,616 [trainer.py] => z_dim: 1000
2025-01-05 15:30:16,616 [trainer.py] => conv_dim: 64
2025-01-05 15:30:16,616 [trainer.py] => img_size: 224
2025-01-05 15:30:16,616 [trainer.py] => generator_lr: 0.005
2025-01-05 15:30:16,616 [trainer.py] => pi: 100
2025-01-05 15:30:16,616 [trainer.py] => w_bn: 50.0
2025-01-05 15:30:16,616 [trainer.py] => w_noise: 0.001
2025-01-05 15:30:16,617 [trainer.py] => server_ss: 32
2025-01-05 15:30:16,617 [trainer.py] => bn_loss: 1
2025-01-05 15:30:16,617 [trainer.py] => noise: 1
2025-01-05 15:30:16,617 [trainer.py] => ie_loss: 1
2025-01-05 15:30:16,617 [trainer.py] => act_loss: 0
2025-01-05 15:30:16,617 [trainer.py] => w_ie: 1.0
2025-01-05 15:30:16,617 [trainer.py] => w_act: 0.1
2025-01-05 15:30:16,617 [trainer.py] => syn_size: 32
2025-01-05 15:30:16,617 [trainer.py] => need_syn_imgs: True
2025-01-05 15:30:16,617 [trainer.py] => g_local_bs: 5
2025-01-05 15:30:16,617 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:30:16,617 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:30:16,617 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:30:16,617 [trainer.py] => com_round_gen: 10
2025-01-05 15:30:16,617 [trainer.py] => vpt_type: Deep
2025-01-05 15:30:16,617 [trainer.py] => prompt_token_num: 6
2025-01-05 15:30:16,617 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:30:16,617 [trainer.py] => perturb_var: 1
2025-01-05 15:30:16,617 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:30:16,617 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:30:16,617 [trainer.py] => kl_weight: 0.001
2025-01-05 15:30:16,617 [trainer.py] => TIP_init: zero
2025-01-05 15:30:16,617 [trainer.py] => tuned_epoch: 10
2025-01-05 15:30:16,617 [trainer.py] => fs_epoch: 0
2025-01-05 15:30:16,617 [trainer.py] => init_lr: 0.01
2025-01-05 15:30:16,617 [trainer.py] => fs_lr: 0.001
2025-01-05 15:30:16,617 [trainer.py] => batch_size: 48
2025-01-05 15:30:16,617 [trainer.py] => fs_batch_size: 16
2025-01-05 15:30:16,617 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:30:16,618 [trainer.py] => min_lr: 0
2025-01-05 15:30:16,618 [trainer.py] => optimizer: sgd
2025-01-05 15:30:16,618 [trainer.py] => memory_size: 0
2025-01-05 15:30:16,618 [trainer.py] => memory_per_class: 0
2025-01-05 15:30:16,618 [trainer.py] => fixed_memory: False
2025-01-05 15:30:16,618 [trainer.py] => shuffle: False
2025-01-05 15:30:16,618 [trainer.py] => top_k: 5
2025-01-05 15:30:16,618 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:30:16,618 [trainer.py] => prefix: asp
2025-01-05 15:30:16,618 [trainer.py] => model_prefix: asp
2025-01-05 15:30:18,579 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:30:55,765 [trainer.py] => All params: 173596160
2025-01-05 15:30:55,767 [trainer.py] => Trainable params: 1998848
2025-01-05 15:30:55,769 [asp.py] => Learning on 0-60
2025-01-05 15:30:55,862 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 15:32:28,467 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:32:28,467 [trainer.py] => model_name: asp
2025-01-05 15:32:28,467 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:32:28,467 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:32:28,467 [trainer.py] => seed: 2024
2025-01-05 15:32:28,467 [trainer.py] => dataset: cifar224
2025-01-05 15:32:28,467 [trainer.py] => init_cls: 60
2025-01-05 15:32:28,467 [trainer.py] => increment: 5
2025-01-05 15:32:28,467 [trainer.py] => kshot: 5
2025-01-05 15:32:28,467 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:32:28,467 [trainer.py] => z_dim: 1000
2025-01-05 15:32:28,467 [trainer.py] => conv_dim: 64
2025-01-05 15:32:28,467 [trainer.py] => img_size: 224
2025-01-05 15:32:28,467 [trainer.py] => generator_lr: 0.005
2025-01-05 15:32:28,467 [trainer.py] => pi: 100
2025-01-05 15:32:28,468 [trainer.py] => w_bn: 50.0
2025-01-05 15:32:28,468 [trainer.py] => w_noise: 0.001
2025-01-05 15:32:28,468 [trainer.py] => server_ss: 32
2025-01-05 15:32:28,468 [trainer.py] => bn_loss: 1
2025-01-05 15:32:28,468 [trainer.py] => noise: 1
2025-01-05 15:32:28,468 [trainer.py] => ie_loss: 1
2025-01-05 15:32:28,468 [trainer.py] => act_loss: 0
2025-01-05 15:32:28,468 [trainer.py] => w_ie: 1.0
2025-01-05 15:32:28,468 [trainer.py] => w_act: 0.1
2025-01-05 15:32:28,468 [trainer.py] => syn_size: 32
2025-01-05 15:32:28,468 [trainer.py] => need_syn_imgs: True
2025-01-05 15:32:28,468 [trainer.py] => g_local_bs: 5
2025-01-05 15:32:28,468 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:32:28,468 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:32:28,468 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:32:28,468 [trainer.py] => com_round_gen: 10
2025-01-05 15:32:28,468 [trainer.py] => vpt_type: Deep
2025-01-05 15:32:28,468 [trainer.py] => prompt_token_num: 6
2025-01-05 15:32:28,468 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:32:28,468 [trainer.py] => perturb_var: 1
2025-01-05 15:32:28,468 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:32:28,468 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:32:28,468 [trainer.py] => kl_weight: 0.001
2025-01-05 15:32:28,468 [trainer.py] => TIP_init: zero
2025-01-05 15:32:28,468 [trainer.py] => tuned_epoch: 10
2025-01-05 15:32:28,468 [trainer.py] => fs_epoch: 0
2025-01-05 15:32:28,468 [trainer.py] => init_lr: 0.01
2025-01-05 15:32:28,468 [trainer.py] => fs_lr: 0.001
2025-01-05 15:32:28,468 [trainer.py] => batch_size: 48
2025-01-05 15:32:28,468 [trainer.py] => fs_batch_size: 16
2025-01-05 15:32:28,468 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:32:28,468 [trainer.py] => min_lr: 0
2025-01-05 15:32:28,469 [trainer.py] => optimizer: sgd
2025-01-05 15:32:28,469 [trainer.py] => memory_size: 0
2025-01-05 15:32:28,469 [trainer.py] => memory_per_class: 0
2025-01-05 15:32:28,469 [trainer.py] => fixed_memory: False
2025-01-05 15:32:28,469 [trainer.py] => shuffle: False
2025-01-05 15:32:28,469 [trainer.py] => top_k: 5
2025-01-05 15:32:28,469 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:32:28,469 [trainer.py] => prefix: asp
2025-01-05 15:32:28,469 [trainer.py] => model_prefix: asp
2025-01-05 15:32:30,355 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:33:05,168 [trainer.py] => All params: 173596160
2025-01-05 15:33:05,169 [trainer.py] => Trainable params: 1998848
2025-01-05 15:33:05,170 [asp.py] => Learning on 0-60
2025-01-05 15:33:05,244 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 15:33:23,509 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 15:33:23,509 [trainer.py] => model_name: asp
2025-01-05 15:33:23,509 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 15:33:23,509 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 15:33:23,510 [trainer.py] => seed: 2024
2025-01-05 15:33:23,510 [trainer.py] => dataset: cifar224
2025-01-05 15:33:23,510 [trainer.py] => init_cls: 60
2025-01-05 15:33:23,510 [trainer.py] => increment: 5
2025-01-05 15:33:23,510 [trainer.py] => kshot: 5
2025-01-05 15:33:23,510 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 15:33:23,510 [trainer.py] => z_dim: 1000
2025-01-05 15:33:23,510 [trainer.py] => conv_dim: 64
2025-01-05 15:33:23,510 [trainer.py] => img_size: 224
2025-01-05 15:33:23,510 [trainer.py] => generator_lr: 0.005
2025-01-05 15:33:23,510 [trainer.py] => pi: 100
2025-01-05 15:33:23,510 [trainer.py] => w_bn: 50.0
2025-01-05 15:33:23,510 [trainer.py] => w_noise: 0.001
2025-01-05 15:33:23,510 [trainer.py] => server_ss: 32
2025-01-05 15:33:23,510 [trainer.py] => bn_loss: 1
2025-01-05 15:33:23,510 [trainer.py] => noise: 1
2025-01-05 15:33:23,510 [trainer.py] => ie_loss: 1
2025-01-05 15:33:23,510 [trainer.py] => act_loss: 0
2025-01-05 15:33:23,510 [trainer.py] => w_ie: 1.0
2025-01-05 15:33:23,510 [trainer.py] => w_act: 0.1
2025-01-05 15:33:23,510 [trainer.py] => syn_size: 32
2025-01-05 15:33:23,510 [trainer.py] => need_syn_imgs: True
2025-01-05 15:33:23,510 [trainer.py] => g_local_bs: 5
2025-01-05 15:33:23,510 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 15:33:23,510 [trainer.py] => g_local_train_steps: 50
2025-01-05 15:33:23,510 [trainer.py] => dataset_syn: cifar100
2025-01-05 15:33:23,510 [trainer.py] => com_round_gen: 10
2025-01-05 15:33:23,510 [trainer.py] => vpt_type: Deep
2025-01-05 15:33:23,510 [trainer.py] => prompt_token_num: 6
2025-01-05 15:33:23,510 [trainer.py] => avg_alpha: 0.8
2025-01-05 15:33:23,510 [trainer.py] => perturb_var: 1
2025-01-05 15:33:23,511 [trainer.py] => EMA_beta: 0.99
2025-01-05 15:33:23,511 [trainer.py] => anchor_lambda: 0.1
2025-01-05 15:33:23,511 [trainer.py] => kl_weight: 0.001
2025-01-05 15:33:23,511 [trainer.py] => TIP_init: zero
2025-01-05 15:33:23,511 [trainer.py] => tuned_epoch: 10
2025-01-05 15:33:23,511 [trainer.py] => fs_epoch: 0
2025-01-05 15:33:23,511 [trainer.py] => init_lr: 0.01
2025-01-05 15:33:23,511 [trainer.py] => fs_lr: 0.001
2025-01-05 15:33:23,511 [trainer.py] => batch_size: 48
2025-01-05 15:33:23,511 [trainer.py] => fs_batch_size: 16
2025-01-05 15:33:23,511 [trainer.py] => weight_decay: 0.0005
2025-01-05 15:33:23,511 [trainer.py] => min_lr: 0
2025-01-05 15:33:23,511 [trainer.py] => optimizer: sgd
2025-01-05 15:33:23,511 [trainer.py] => memory_size: 0
2025-01-05 15:33:23,511 [trainer.py] => memory_per_class: 0
2025-01-05 15:33:23,511 [trainer.py] => fixed_memory: False
2025-01-05 15:33:23,511 [trainer.py] => shuffle: False
2025-01-05 15:33:23,511 [trainer.py] => top_k: 5
2025-01-05 15:33:23,511 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 15:33:23,511 [trainer.py] => prefix: asp
2025-01-05 15:33:23,511 [trainer.py] => model_prefix: asp
2025-01-05 15:33:25,436 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 15:33:59,708 [trainer.py] => All params: 173596160
2025-01-05 15:33:59,709 [trainer.py] => Trainable params: 1998848
2025-01-05 15:33:59,710 [asp.py] => Learning on 0-60
2025-01-05 15:33:59,832 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 16:51:04,838 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 16:51:04,838 [trainer.py] => model_name: asp
2025-01-05 16:51:04,838 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 16:51:04,838 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 16:51:04,838 [trainer.py] => seed: 2024
2025-01-05 16:51:04,838 [trainer.py] => dataset: cifar224
2025-01-05 16:51:04,838 [trainer.py] => init_cls: 60
2025-01-05 16:51:04,838 [trainer.py] => increment: 5
2025-01-05 16:51:04,838 [trainer.py] => kshot: 5
2025-01-05 16:51:04,838 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 16:51:04,838 [trainer.py] => z_dim: 1000
2025-01-05 16:51:04,838 [trainer.py] => conv_dim: 64
2025-01-05 16:51:04,838 [trainer.py] => img_size: 224
2025-01-05 16:51:04,838 [trainer.py] => generator_lr: 0.005
2025-01-05 16:51:04,838 [trainer.py] => pi: 100
2025-01-05 16:51:04,838 [trainer.py] => w_bn: 50.0
2025-01-05 16:51:04,838 [trainer.py] => w_noise: 0.001
2025-01-05 16:51:04,838 [trainer.py] => server_ss: 32
2025-01-05 16:51:04,838 [trainer.py] => bn_loss: 1
2025-01-05 16:51:04,838 [trainer.py] => noise: 1
2025-01-05 16:51:04,838 [trainer.py] => ie_loss: 1
2025-01-05 16:51:04,838 [trainer.py] => act_loss: 0
2025-01-05 16:51:04,838 [trainer.py] => w_ie: 1.0
2025-01-05 16:51:04,838 [trainer.py] => w_act: 0.1
2025-01-05 16:51:04,838 [trainer.py] => syn_size: 32
2025-01-05 16:51:04,838 [trainer.py] => need_syn_imgs: True
2025-01-05 16:51:04,839 [trainer.py] => g_local_bs: 5
2025-01-05 16:51:04,839 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 16:51:04,839 [trainer.py] => g_local_train_steps: 5
2025-01-05 16:51:04,839 [trainer.py] => dataset_syn: cifar100
2025-01-05 16:51:04,839 [trainer.py] => com_round_gen: 10
2025-01-05 16:51:04,839 [trainer.py] => g_sigma: 0
2025-01-05 16:51:04,839 [trainer.py] => save_cls_embeds: False
2025-01-05 16:51:04,839 [trainer.py] => syn_image_path: None
2025-01-05 16:51:04,839 [trainer.py] => save_dir: outputs
2025-01-05 16:51:04,839 [trainer.py] => n_iter: 5
2025-01-05 16:51:04,839 [trainer.py] => num_users: 1
2025-01-05 16:51:04,839 [trainer.py] => cur_size: 50
2025-01-05 16:51:04,839 [trainer.py] => vpt_type: Deep
2025-01-05 16:51:04,839 [trainer.py] => prompt_token_num: 6
2025-01-05 16:51:04,839 [trainer.py] => avg_alpha: 0.8
2025-01-05 16:51:04,839 [trainer.py] => perturb_var: 1
2025-01-05 16:51:04,839 [trainer.py] => EMA_beta: 0.99
2025-01-05 16:51:04,839 [trainer.py] => anchor_lambda: 0.1
2025-01-05 16:51:04,839 [trainer.py] => kl_weight: 0.001
2025-01-05 16:51:04,839 [trainer.py] => TIP_init: zero
2025-01-05 16:51:04,839 [trainer.py] => tuned_epoch: 10
2025-01-05 16:51:04,839 [trainer.py] => fs_epoch: 0
2025-01-05 16:51:04,839 [trainer.py] => init_lr: 0.01
2025-01-05 16:51:04,839 [trainer.py] => fs_lr: 0.001
2025-01-05 16:51:04,839 [trainer.py] => batch_size: 48
2025-01-05 16:51:04,839 [trainer.py] => fs_batch_size: 16
2025-01-05 16:51:04,839 [trainer.py] => weight_decay: 0.0005
2025-01-05 16:51:04,839 [trainer.py] => min_lr: 0
2025-01-05 16:51:04,839 [trainer.py] => optimizer: sgd
2025-01-05 16:51:04,839 [trainer.py] => memory_size: 0
2025-01-05 16:51:04,839 [trainer.py] => memory_per_class: 0
2025-01-05 16:51:04,839 [trainer.py] => fixed_memory: False
2025-01-05 16:51:04,839 [trainer.py] => shuffle: False
2025-01-05 16:51:04,840 [trainer.py] => top_k: 5
2025-01-05 16:51:04,840 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 16:51:04,840 [trainer.py] => prefix: asp
2025-01-05 16:51:04,840 [trainer.py] => model_prefix: asp
2025-01-05 16:51:06,678 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 16:51:13,354 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 16:51:13,354 [trainer.py] => model_name: asp
2025-01-05 16:51:13,354 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 16:51:13,354 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 16:51:13,354 [trainer.py] => seed: 2024
2025-01-05 16:51:13,354 [trainer.py] => dataset: cifar224
2025-01-05 16:51:13,354 [trainer.py] => init_cls: 60
2025-01-05 16:51:13,354 [trainer.py] => increment: 5
2025-01-05 16:51:13,354 [trainer.py] => kshot: 5
2025-01-05 16:51:13,354 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 16:51:13,354 [trainer.py] => z_dim: 1000
2025-01-05 16:51:13,354 [trainer.py] => conv_dim: 64
2025-01-05 16:51:13,354 [trainer.py] => img_size: 224
2025-01-05 16:51:13,354 [trainer.py] => generator_lr: 0.005
2025-01-05 16:51:13,354 [trainer.py] => pi: 100
2025-01-05 16:51:13,354 [trainer.py] => w_bn: 50.0
2025-01-05 16:51:13,354 [trainer.py] => w_noise: 0.001
2025-01-05 16:51:13,354 [trainer.py] => server_ss: 32
2025-01-05 16:51:13,354 [trainer.py] => bn_loss: 1
2025-01-05 16:51:13,354 [trainer.py] => noise: 1
2025-01-05 16:51:13,354 [trainer.py] => ie_loss: 1
2025-01-05 16:51:13,354 [trainer.py] => act_loss: 0
2025-01-05 16:51:13,354 [trainer.py] => w_ie: 1.0
2025-01-05 16:51:13,354 [trainer.py] => w_act: 0.1
2025-01-05 16:51:13,354 [trainer.py] => syn_size: 32
2025-01-05 16:51:13,355 [trainer.py] => need_syn_imgs: True
2025-01-05 16:51:13,355 [trainer.py] => g_local_bs: 5
2025-01-05 16:51:13,355 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 16:51:13,355 [trainer.py] => g_local_train_steps: 1
2025-01-05 16:51:13,355 [trainer.py] => dataset_syn: cifar100
2025-01-05 16:51:13,355 [trainer.py] => com_round_gen: 10
2025-01-05 16:51:13,355 [trainer.py] => g_sigma: 0
2025-01-05 16:51:13,355 [trainer.py] => save_cls_embeds: False
2025-01-05 16:51:13,355 [trainer.py] => syn_image_path: None
2025-01-05 16:51:13,355 [trainer.py] => save_dir: outputs
2025-01-05 16:51:13,355 [trainer.py] => n_iter: 5
2025-01-05 16:51:13,355 [trainer.py] => num_users: 1
2025-01-05 16:51:13,355 [trainer.py] => cur_size: 50
2025-01-05 16:51:13,355 [trainer.py] => vpt_type: Deep
2025-01-05 16:51:13,355 [trainer.py] => prompt_token_num: 6
2025-01-05 16:51:13,355 [trainer.py] => avg_alpha: 0.8
2025-01-05 16:51:13,355 [trainer.py] => perturb_var: 1
2025-01-05 16:51:13,355 [trainer.py] => EMA_beta: 0.99
2025-01-05 16:51:13,355 [trainer.py] => anchor_lambda: 0.1
2025-01-05 16:51:13,355 [trainer.py] => kl_weight: 0.001
2025-01-05 16:51:13,355 [trainer.py] => TIP_init: zero
2025-01-05 16:51:13,355 [trainer.py] => tuned_epoch: 10
2025-01-05 16:51:13,355 [trainer.py] => fs_epoch: 0
2025-01-05 16:51:13,355 [trainer.py] => init_lr: 0.01
2025-01-05 16:51:13,355 [trainer.py] => fs_lr: 0.001
2025-01-05 16:51:13,355 [trainer.py] => batch_size: 48
2025-01-05 16:51:13,355 [trainer.py] => fs_batch_size: 16
2025-01-05 16:51:13,355 [trainer.py] => weight_decay: 0.0005
2025-01-05 16:51:13,355 [trainer.py] => min_lr: 0
2025-01-05 16:51:13,355 [trainer.py] => optimizer: sgd
2025-01-05 16:51:13,355 [trainer.py] => memory_size: 0
2025-01-05 16:51:13,355 [trainer.py] => memory_per_class: 0
2025-01-05 16:51:13,355 [trainer.py] => fixed_memory: False
2025-01-05 16:51:13,356 [trainer.py] => shuffle: False
2025-01-05 16:51:13,356 [trainer.py] => top_k: 5
2025-01-05 16:51:13,356 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 16:51:13,356 [trainer.py] => prefix: asp
2025-01-05 16:51:13,356 [trainer.py] => model_prefix: asp
2025-01-05 16:51:15,214 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 16:51:59,021 [trainer.py] => All params: 173596160
2025-01-05 16:51:59,022 [trainer.py] => Trainable params: 1998848
2025-01-05 16:51:59,024 [asp.py] => Learning on 0-60
2025-01-05 16:51:59,184 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 16:52:21,809 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 16:52:21,809 [trainer.py] => model_name: asp
2025-01-05 16:52:21,809 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 16:52:21,809 [trainer.py] => device: [device(type='cuda', index=0)]
2025-01-05 16:52:21,809 [trainer.py] => seed: 2024
2025-01-05 16:52:21,809 [trainer.py] => dataset: cifar224
2025-01-05 16:52:21,809 [trainer.py] => init_cls: 60
2025-01-05 16:52:21,809 [trainer.py] => increment: 5
2025-01-05 16:52:21,809 [trainer.py] => kshot: 5
2025-01-05 16:52:21,809 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 16:52:21,809 [trainer.py] => z_dim: 1000
2025-01-05 16:52:21,810 [trainer.py] => conv_dim: 64
2025-01-05 16:52:21,810 [trainer.py] => img_size: 224
2025-01-05 16:52:21,810 [trainer.py] => generator_lr: 0.005
2025-01-05 16:52:21,810 [trainer.py] => pi: 100
2025-01-05 16:52:21,810 [trainer.py] => w_bn: 50.0
2025-01-05 16:52:21,810 [trainer.py] => w_noise: 0.001
2025-01-05 16:52:21,810 [trainer.py] => server_ss: 32
2025-01-05 16:52:21,810 [trainer.py] => bn_loss: 1
2025-01-05 16:52:21,810 [trainer.py] => noise: 1
2025-01-05 16:52:21,810 [trainer.py] => ie_loss: 1
2025-01-05 16:52:21,810 [trainer.py] => act_loss: 0
2025-01-05 16:52:21,810 [trainer.py] => w_ie: 1.0
2025-01-05 16:52:21,810 [trainer.py] => w_act: 0.1
2025-01-05 16:52:21,810 [trainer.py] => syn_size: 32
2025-01-05 16:52:21,810 [trainer.py] => need_syn_imgs: True
2025-01-05 16:52:21,810 [trainer.py] => g_local_bs: 5
2025-01-05 16:52:21,810 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 16:52:21,810 [trainer.py] => g_local_train_steps: 1
2025-01-05 16:52:21,810 [trainer.py] => dataset_syn: cifar100
2025-01-05 16:52:21,810 [trainer.py] => com_round_gen: 10
2025-01-05 16:52:21,811 [trainer.py] => g_sigma: 0
2025-01-05 16:52:21,811 [trainer.py] => save_cls_embeds: False
2025-01-05 16:52:21,811 [trainer.py] => syn_image_path: None
2025-01-05 16:52:21,811 [trainer.py] => save_dir: outputs
2025-01-05 16:52:21,811 [trainer.py] => n_iter: 5
2025-01-05 16:52:21,811 [trainer.py] => num_users: 1
2025-01-05 16:52:21,811 [trainer.py] => cur_size: 50
2025-01-05 16:52:21,811 [trainer.py] => vpt_type: Deep
2025-01-05 16:52:21,811 [trainer.py] => prompt_token_num: 6
2025-01-05 16:52:21,811 [trainer.py] => avg_alpha: 0.8
2025-01-05 16:52:21,811 [trainer.py] => perturb_var: 1
2025-01-05 16:52:21,811 [trainer.py] => EMA_beta: 0.99
2025-01-05 16:52:21,811 [trainer.py] => anchor_lambda: 0.1
2025-01-05 16:52:21,811 [trainer.py] => kl_weight: 0.001
2025-01-05 16:52:21,811 [trainer.py] => TIP_init: zero
2025-01-05 16:52:21,811 [trainer.py] => tuned_epoch: 10
2025-01-05 16:52:21,811 [trainer.py] => fs_epoch: 0
2025-01-05 16:52:21,811 [trainer.py] => init_lr: 0.01
2025-01-05 16:52:21,811 [trainer.py] => fs_lr: 0.001
2025-01-05 16:52:21,812 [trainer.py] => batch_size: 48
2025-01-05 16:52:21,812 [trainer.py] => fs_batch_size: 16
2025-01-05 16:52:21,812 [trainer.py] => weight_decay: 0.0005
2025-01-05 16:52:21,812 [trainer.py] => min_lr: 0
2025-01-05 16:52:21,812 [trainer.py] => optimizer: sgd
2025-01-05 16:52:21,812 [trainer.py] => memory_size: 0
2025-01-05 16:52:21,812 [trainer.py] => memory_per_class: 0
2025-01-05 16:52:21,812 [trainer.py] => fixed_memory: False
2025-01-05 16:52:21,812 [trainer.py] => shuffle: False
2025-01-05 16:52:21,812 [trainer.py] => top_k: 5
2025-01-05 16:52:21,812 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 16:52:21,812 [trainer.py] => prefix: asp
2025-01-05 16:52:21,812 [trainer.py] => model_prefix: asp
2025-01-05 16:52:23,681 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 16:52:57,677 [trainer.py] => All params: 173596160
2025-01-05 16:52:57,678 [trainer.py] => Trainable params: 1998848
2025-01-05 16:52:57,681 [asp.py] => Learning on 0-60
2025-01-05 16:52:57,787 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 16:55:07,216 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 16:55:07,216 [trainer.py] => model_name: asp
2025-01-05 16:55:07,217 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 16:55:07,217 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 16:55:07,217 [trainer.py] => seed: 2024
2025-01-05 16:55:07,217 [trainer.py] => dataset: cifar224
2025-01-05 16:55:07,217 [trainer.py] => init_cls: 60
2025-01-05 16:55:07,217 [trainer.py] => increment: 5
2025-01-05 16:55:07,217 [trainer.py] => kshot: 5
2025-01-05 16:55:07,217 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 16:55:07,217 [trainer.py] => z_dim: 1000
2025-01-05 16:55:07,217 [trainer.py] => conv_dim: 64
2025-01-05 16:55:07,217 [trainer.py] => img_size: 224
2025-01-05 16:55:07,217 [trainer.py] => generator_lr: 0.005
2025-01-05 16:55:07,217 [trainer.py] => pi: 100
2025-01-05 16:55:07,217 [trainer.py] => w_bn: 50.0
2025-01-05 16:55:07,217 [trainer.py] => w_noise: 0.001
2025-01-05 16:55:07,217 [trainer.py] => server_ss: 32
2025-01-05 16:55:07,217 [trainer.py] => bn_loss: 1
2025-01-05 16:55:07,217 [trainer.py] => noise: 1
2025-01-05 16:55:07,217 [trainer.py] => ie_loss: 1
2025-01-05 16:55:07,217 [trainer.py] => act_loss: 0
2025-01-05 16:55:07,217 [trainer.py] => w_ie: 1.0
2025-01-05 16:55:07,217 [trainer.py] => w_act: 0.1
2025-01-05 16:55:07,217 [trainer.py] => syn_size: 32
2025-01-05 16:55:07,217 [trainer.py] => need_syn_imgs: True
2025-01-05 16:55:07,217 [trainer.py] => g_local_bs: 5
2025-01-05 16:55:07,217 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 16:55:07,217 [trainer.py] => g_local_train_steps: 1
2025-01-05 16:55:07,218 [trainer.py] => dataset_syn: cifar100
2025-01-05 16:55:07,218 [trainer.py] => com_round_gen: 10
2025-01-05 16:55:07,218 [trainer.py] => g_sigma: 0
2025-01-05 16:55:07,218 [trainer.py] => save_cls_embeds: False
2025-01-05 16:55:07,218 [trainer.py] => syn_image_path: None
2025-01-05 16:55:07,218 [trainer.py] => save_dir: outputs
2025-01-05 16:55:07,218 [trainer.py] => n_iter: 5
2025-01-05 16:55:07,218 [trainer.py] => num_users: 1
2025-01-05 16:55:07,218 [trainer.py] => cur_size: 50
2025-01-05 16:55:07,218 [trainer.py] => vpt_type: Deep
2025-01-05 16:55:07,218 [trainer.py] => prompt_token_num: 6
2025-01-05 16:55:07,218 [trainer.py] => avg_alpha: 0.8
2025-01-05 16:55:07,218 [trainer.py] => perturb_var: 1
2025-01-05 16:55:07,218 [trainer.py] => EMA_beta: 0.99
2025-01-05 16:55:07,218 [trainer.py] => anchor_lambda: 0.1
2025-01-05 16:55:07,218 [trainer.py] => kl_weight: 0.001
2025-01-05 16:55:07,218 [trainer.py] => TIP_init: zero
2025-01-05 16:55:07,218 [trainer.py] => tuned_epoch: 10
2025-01-05 16:55:07,218 [trainer.py] => fs_epoch: 0
2025-01-05 16:55:07,218 [trainer.py] => init_lr: 0.01
2025-01-05 16:55:07,218 [trainer.py] => fs_lr: 0.001
2025-01-05 16:55:07,218 [trainer.py] => batch_size: 48
2025-01-05 16:55:07,218 [trainer.py] => fs_batch_size: 16
2025-01-05 16:55:07,218 [trainer.py] => weight_decay: 0.0005
2025-01-05 16:55:07,218 [trainer.py] => min_lr: 0
2025-01-05 16:55:07,218 [trainer.py] => optimizer: sgd
2025-01-05 16:55:07,218 [trainer.py] => memory_size: 0
2025-01-05 16:55:07,218 [trainer.py] => memory_per_class: 0
2025-01-05 16:55:07,218 [trainer.py] => fixed_memory: False
2025-01-05 16:55:07,218 [trainer.py] => shuffle: False
2025-01-05 16:55:07,219 [trainer.py] => top_k: 5
2025-01-05 16:55:07,219 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 16:55:07,219 [trainer.py] => prefix: asp
2025-01-05 16:55:07,219 [trainer.py] => model_prefix: asp
2025-01-05 16:55:08,906 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 16:56:03,674 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 16:56:03,674 [trainer.py] => model_name: asp
2025-01-05 16:56:03,674 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 16:56:03,675 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 16:56:03,675 [trainer.py] => seed: 2024
2025-01-05 16:56:03,675 [trainer.py] => dataset: cifar224
2025-01-05 16:56:03,675 [trainer.py] => init_cls: 60
2025-01-05 16:56:03,675 [trainer.py] => increment: 5
2025-01-05 16:56:03,675 [trainer.py] => kshot: 5
2025-01-05 16:56:03,675 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 16:56:03,675 [trainer.py] => z_dim: 1000
2025-01-05 16:56:03,675 [trainer.py] => conv_dim: 64
2025-01-05 16:56:03,675 [trainer.py] => img_size: 224
2025-01-05 16:56:03,675 [trainer.py] => generator_lr: 0.005
2025-01-05 16:56:03,675 [trainer.py] => pi: 100
2025-01-05 16:56:03,675 [trainer.py] => w_bn: 50.0
2025-01-05 16:56:03,675 [trainer.py] => w_noise: 0.001
2025-01-05 16:56:03,675 [trainer.py] => server_ss: 32
2025-01-05 16:56:03,675 [trainer.py] => bn_loss: 1
2025-01-05 16:56:03,675 [trainer.py] => noise: 1
2025-01-05 16:56:03,675 [trainer.py] => ie_loss: 1
2025-01-05 16:56:03,675 [trainer.py] => act_loss: 0
2025-01-05 16:56:03,675 [trainer.py] => w_ie: 1.0
2025-01-05 16:56:03,675 [trainer.py] => w_act: 0.1
2025-01-05 16:56:03,675 [trainer.py] => syn_size: 32
2025-01-05 16:56:03,675 [trainer.py] => need_syn_imgs: True
2025-01-05 16:56:03,675 [trainer.py] => g_local_bs: 5
2025-01-05 16:56:03,675 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 16:56:03,675 [trainer.py] => g_local_train_steps: 1
2025-01-05 16:56:03,675 [trainer.py] => dataset_syn: cifar100
2025-01-05 16:56:03,675 [trainer.py] => com_round_gen: 10
2025-01-05 16:56:03,675 [trainer.py] => g_sigma: 0
2025-01-05 16:56:03,676 [trainer.py] => save_cls_embeds: False
2025-01-05 16:56:03,676 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 16:56:03,676 [trainer.py] => save_dir: outputs
2025-01-05 16:56:03,676 [trainer.py] => n_iter: 5
2025-01-05 16:56:03,676 [trainer.py] => num_users: 1
2025-01-05 16:56:03,676 [trainer.py] => cur_size: 50
2025-01-05 16:56:03,676 [trainer.py] => vpt_type: Deep
2025-01-05 16:56:03,676 [trainer.py] => prompt_token_num: 6
2025-01-05 16:56:03,676 [trainer.py] => avg_alpha: 0.8
2025-01-05 16:56:03,676 [trainer.py] => perturb_var: 1
2025-01-05 16:56:03,676 [trainer.py] => EMA_beta: 0.99
2025-01-05 16:56:03,676 [trainer.py] => anchor_lambda: 0.1
2025-01-05 16:56:03,676 [trainer.py] => kl_weight: 0.001
2025-01-05 16:56:03,676 [trainer.py] => TIP_init: zero
2025-01-05 16:56:03,676 [trainer.py] => tuned_epoch: 10
2025-01-05 16:56:03,676 [trainer.py] => fs_epoch: 0
2025-01-05 16:56:03,676 [trainer.py] => init_lr: 0.01
2025-01-05 16:56:03,676 [trainer.py] => fs_lr: 0.001
2025-01-05 16:56:03,676 [trainer.py] => batch_size: 48
2025-01-05 16:56:03,676 [trainer.py] => fs_batch_size: 16
2025-01-05 16:56:03,676 [trainer.py] => weight_decay: 0.0005
2025-01-05 16:56:03,676 [trainer.py] => min_lr: 0
2025-01-05 16:56:03,676 [trainer.py] => optimizer: sgd
2025-01-05 16:56:03,676 [trainer.py] => memory_size: 0
2025-01-05 16:56:03,676 [trainer.py] => memory_per_class: 0
2025-01-05 16:56:03,676 [trainer.py] => fixed_memory: False
2025-01-05 16:56:03,676 [trainer.py] => shuffle: False
2025-01-05 16:56:03,676 [trainer.py] => top_k: 5
2025-01-05 16:56:03,676 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 16:56:03,676 [trainer.py] => prefix: asp
2025-01-05 16:56:03,676 [trainer.py] => model_prefix: asp
2025-01-05 16:56:05,600 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 16:56:41,671 [trainer.py] => All params: 173596160
2025-01-05 16:56:41,672 [trainer.py] => Trainable params: 1998848
2025-01-05 16:56:41,845 [asp.py] => Learning on 0-60
2025-01-05 16:56:41,974 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 16:58:51,152 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 16:58:51,152 [trainer.py] => model_name: asp
2025-01-05 16:58:51,152 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 16:58:51,152 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 16:58:51,152 [trainer.py] => seed: 2024
2025-01-05 16:58:51,152 [trainer.py] => dataset: cifar224
2025-01-05 16:58:51,152 [trainer.py] => init_cls: 60
2025-01-05 16:58:51,153 [trainer.py] => increment: 5
2025-01-05 16:58:51,153 [trainer.py] => kshot: 5
2025-01-05 16:58:51,153 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 16:58:51,153 [trainer.py] => z_dim: 1000
2025-01-05 16:58:51,153 [trainer.py] => conv_dim: 64
2025-01-05 16:58:51,153 [trainer.py] => img_size: 224
2025-01-05 16:58:51,153 [trainer.py] => generator_lr: 0.005
2025-01-05 16:58:51,153 [trainer.py] => pi: 100
2025-01-05 16:58:51,153 [trainer.py] => w_bn: 50.0
2025-01-05 16:58:51,153 [trainer.py] => w_noise: 0.001
2025-01-05 16:58:51,153 [trainer.py] => server_ss: 32
2025-01-05 16:58:51,153 [trainer.py] => bn_loss: 1
2025-01-05 16:58:51,153 [trainer.py] => noise: 1
2025-01-05 16:58:51,153 [trainer.py] => ie_loss: 1
2025-01-05 16:58:51,153 [trainer.py] => act_loss: 0
2025-01-05 16:58:51,153 [trainer.py] => w_ie: 1.0
2025-01-05 16:58:51,153 [trainer.py] => w_act: 0.1
2025-01-05 16:58:51,153 [trainer.py] => syn_size: 32
2025-01-05 16:58:51,153 [trainer.py] => need_syn_imgs: True
2025-01-05 16:58:51,153 [trainer.py] => g_local_bs: 5
2025-01-05 16:58:51,153 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 16:58:51,153 [trainer.py] => g_local_train_steps: 1
2025-01-05 16:58:51,153 [trainer.py] => dataset_syn: cifar100
2025-01-05 16:58:51,153 [trainer.py] => com_round_gen: 10
2025-01-05 16:58:51,153 [trainer.py] => g_sigma: 0
2025-01-05 16:58:51,153 [trainer.py] => save_cls_embeds: False
2025-01-05 16:58:51,153 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 16:58:51,153 [trainer.py] => save_dir: outputs
2025-01-05 16:58:51,153 [trainer.py] => n_iter: 5
2025-01-05 16:58:51,153 [trainer.py] => num_users: 1
2025-01-05 16:58:51,153 [trainer.py] => cur_size: 50
2025-01-05 16:58:51,153 [trainer.py] => vpt_type: Deep
2025-01-05 16:58:51,153 [trainer.py] => prompt_token_num: 6
2025-01-05 16:58:51,153 [trainer.py] => avg_alpha: 0.8
2025-01-05 16:58:51,154 [trainer.py] => perturb_var: 1
2025-01-05 16:58:51,154 [trainer.py] => EMA_beta: 0.99
2025-01-05 16:58:51,154 [trainer.py] => anchor_lambda: 0.1
2025-01-05 16:58:51,154 [trainer.py] => kl_weight: 0.001
2025-01-05 16:58:51,154 [trainer.py] => TIP_init: zero
2025-01-05 16:58:51,154 [trainer.py] => tuned_epoch: 10
2025-01-05 16:58:51,154 [trainer.py] => fs_epoch: 0
2025-01-05 16:58:51,154 [trainer.py] => init_lr: 0.01
2025-01-05 16:58:51,154 [trainer.py] => fs_lr: 0.001
2025-01-05 16:58:51,154 [trainer.py] => batch_size: 48
2025-01-05 16:58:51,154 [trainer.py] => fs_batch_size: 16
2025-01-05 16:58:51,154 [trainer.py] => weight_decay: 0.0005
2025-01-05 16:58:51,154 [trainer.py] => min_lr: 0
2025-01-05 16:58:51,154 [trainer.py] => optimizer: sgd
2025-01-05 16:58:51,155 [trainer.py] => memory_size: 0
2025-01-05 16:58:51,155 [trainer.py] => memory_per_class: 0
2025-01-05 16:58:51,156 [trainer.py] => fixed_memory: False
2025-01-05 16:58:51,156 [trainer.py] => shuffle: False
2025-01-05 16:58:51,156 [trainer.py] => top_k: 5
2025-01-05 16:58:51,156 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 16:58:51,156 [trainer.py] => prefix: asp
2025-01-05 16:58:51,156 [trainer.py] => model_prefix: asp
2025-01-05 16:58:52,969 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 16:59:27,176 [trainer.py] => All params: 173596160
2025-01-05 16:59:27,177 [trainer.py] => Trainable params: 1998848
2025-01-05 16:59:27,402 [asp.py] => Learning on 0-60
2025-01-05 16:59:27,550 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:01:33,670 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:01:33,670 [trainer.py] => model_name: asp
2025-01-05 17:01:33,670 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:01:33,670 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:01:33,670 [trainer.py] => seed: 2024
2025-01-05 17:01:33,670 [trainer.py] => dataset: cifar224
2025-01-05 17:01:33,671 [trainer.py] => init_cls: 60
2025-01-05 17:01:33,671 [trainer.py] => increment: 5
2025-01-05 17:01:33,671 [trainer.py] => kshot: 5
2025-01-05 17:01:33,671 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:01:33,671 [trainer.py] => z_dim: 1000
2025-01-05 17:01:33,671 [trainer.py] => conv_dim: 64
2025-01-05 17:01:33,671 [trainer.py] => img_size: 224
2025-01-05 17:01:33,671 [trainer.py] => generator_lr: 0.005
2025-01-05 17:01:33,671 [trainer.py] => pi: 100
2025-01-05 17:01:33,671 [trainer.py] => w_bn: 50.0
2025-01-05 17:01:33,671 [trainer.py] => w_noise: 0.001
2025-01-05 17:01:33,671 [trainer.py] => server_ss: 32
2025-01-05 17:01:33,671 [trainer.py] => bn_loss: 1
2025-01-05 17:01:33,671 [trainer.py] => noise: 1
2025-01-05 17:01:33,671 [trainer.py] => ie_loss: 1
2025-01-05 17:01:33,671 [trainer.py] => act_loss: 0
2025-01-05 17:01:33,671 [trainer.py] => w_ie: 1.0
2025-01-05 17:01:33,671 [trainer.py] => w_act: 0.1
2025-01-05 17:01:33,671 [trainer.py] => syn_size: 32
2025-01-05 17:01:33,671 [trainer.py] => need_syn_imgs: True
2025-01-05 17:01:33,671 [trainer.py] => g_local_bs: 5
2025-01-05 17:01:33,671 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:01:33,671 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:01:33,671 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:01:33,671 [trainer.py] => com_round_gen: 10
2025-01-05 17:01:33,671 [trainer.py] => g_sigma: 0
2025-01-05 17:01:33,671 [trainer.py] => save_cls_embeds: False
2025-01-05 17:01:33,671 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:01:33,671 [trainer.py] => save_dir: outputs
2025-01-05 17:01:33,671 [trainer.py] => n_iter: 5
2025-01-05 17:01:33,671 [trainer.py] => num_users: 1
2025-01-05 17:01:33,671 [trainer.py] => cur_size: 50
2025-01-05 17:01:33,671 [trainer.py] => vpt_type: Deep
2025-01-05 17:01:33,671 [trainer.py] => prompt_token_num: 6
2025-01-05 17:01:33,672 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:01:33,672 [trainer.py] => perturb_var: 1
2025-01-05 17:01:33,672 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:01:33,672 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:01:33,672 [trainer.py] => kl_weight: 0.001
2025-01-05 17:01:33,672 [trainer.py] => TIP_init: zero
2025-01-05 17:01:33,672 [trainer.py] => tuned_epoch: 10
2025-01-05 17:01:33,672 [trainer.py] => fs_epoch: 0
2025-01-05 17:01:33,672 [trainer.py] => init_lr: 0.01
2025-01-05 17:01:33,672 [trainer.py] => fs_lr: 0.001
2025-01-05 17:01:33,672 [trainer.py] => batch_size: 48
2025-01-05 17:01:33,672 [trainer.py] => fs_batch_size: 16
2025-01-05 17:01:33,672 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:01:33,672 [trainer.py] => min_lr: 0
2025-01-05 17:01:33,672 [trainer.py] => optimizer: sgd
2025-01-05 17:01:33,672 [trainer.py] => memory_size: 0
2025-01-05 17:01:33,672 [trainer.py] => memory_per_class: 0
2025-01-05 17:01:33,672 [trainer.py] => fixed_memory: False
2025-01-05 17:01:33,672 [trainer.py] => shuffle: False
2025-01-05 17:01:33,672 [trainer.py] => top_k: 5
2025-01-05 17:01:33,672 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:01:33,672 [trainer.py] => prefix: asp
2025-01-05 17:01:33,672 [trainer.py] => model_prefix: asp
2025-01-05 17:01:35,555 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:02:10,587 [trainer.py] => All params: 173596160
2025-01-05 17:02:10,588 [trainer.py] => Trainable params: 1998848
2025-01-05 17:02:10,778 [asp.py] => Learning on 0-60
2025-01-05 17:02:10,930 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:06:10,157 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:06:10,157 [trainer.py] => model_name: asp
2025-01-05 17:06:10,157 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:06:10,157 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:06:10,157 [trainer.py] => seed: 2024
2025-01-05 17:06:10,157 [trainer.py] => dataset: cifar224
2025-01-05 17:06:10,157 [trainer.py] => init_cls: 60
2025-01-05 17:06:10,157 [trainer.py] => increment: 5
2025-01-05 17:06:10,157 [trainer.py] => kshot: 5
2025-01-05 17:06:10,157 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:06:10,157 [trainer.py] => z_dim: 1000
2025-01-05 17:06:10,157 [trainer.py] => conv_dim: 64
2025-01-05 17:06:10,157 [trainer.py] => img_size: 224
2025-01-05 17:06:10,157 [trainer.py] => generator_lr: 0.005
2025-01-05 17:06:10,157 [trainer.py] => pi: 100
2025-01-05 17:06:10,157 [trainer.py] => w_bn: 50.0
2025-01-05 17:06:10,157 [trainer.py] => w_noise: 0.001
2025-01-05 17:06:10,157 [trainer.py] => server_ss: 32
2025-01-05 17:06:10,158 [trainer.py] => bn_loss: 1
2025-01-05 17:06:10,158 [trainer.py] => noise: 1
2025-01-05 17:06:10,158 [trainer.py] => ie_loss: 1
2025-01-05 17:06:10,158 [trainer.py] => act_loss: 0
2025-01-05 17:06:10,158 [trainer.py] => w_ie: 1.0
2025-01-05 17:06:10,158 [trainer.py] => w_act: 0.1
2025-01-05 17:06:10,158 [trainer.py] => syn_size: 32
2025-01-05 17:06:10,158 [trainer.py] => need_syn_imgs: True
2025-01-05 17:06:10,158 [trainer.py] => g_local_bs: 5
2025-01-05 17:06:10,158 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:06:10,158 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:06:10,158 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:06:10,158 [trainer.py] => com_round_gen: 10
2025-01-05 17:06:10,158 [trainer.py] => g_sigma: 0
2025-01-05 17:06:10,158 [trainer.py] => save_cls_embeds: False
2025-01-05 17:06:10,158 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:06:10,158 [trainer.py] => save_dir: outputs
2025-01-05 17:06:10,158 [trainer.py] => n_iter: 5
2025-01-05 17:06:10,158 [trainer.py] => num_users: 1
2025-01-05 17:06:10,158 [trainer.py] => cur_size: 50
2025-01-05 17:06:10,158 [trainer.py] => vpt_type: Deep
2025-01-05 17:06:10,158 [trainer.py] => prompt_token_num: 6
2025-01-05 17:06:10,158 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:06:10,158 [trainer.py] => perturb_var: 1
2025-01-05 17:06:10,158 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:06:10,158 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:06:10,158 [trainer.py] => kl_weight: 0.001
2025-01-05 17:06:10,158 [trainer.py] => TIP_init: zero
2025-01-05 17:06:10,158 [trainer.py] => tuned_epoch: 10
2025-01-05 17:06:10,158 [trainer.py] => fs_epoch: 0
2025-01-05 17:06:10,158 [trainer.py] => init_lr: 0.01
2025-01-05 17:06:10,158 [trainer.py] => fs_lr: 0.001
2025-01-05 17:06:10,158 [trainer.py] => batch_size: 48
2025-01-05 17:06:10,158 [trainer.py] => fs_batch_size: 16
2025-01-05 17:06:10,158 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:06:10,159 [trainer.py] => min_lr: 0
2025-01-05 17:06:10,159 [trainer.py] => optimizer: sgd
2025-01-05 17:06:10,159 [trainer.py] => memory_size: 0
2025-01-05 17:06:10,159 [trainer.py] => memory_per_class: 0
2025-01-05 17:06:10,159 [trainer.py] => fixed_memory: False
2025-01-05 17:06:10,159 [trainer.py] => shuffle: False
2025-01-05 17:06:10,159 [trainer.py] => top_k: 5
2025-01-05 17:06:10,159 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:06:10,159 [trainer.py] => prefix: asp
2025-01-05 17:06:10,159 [trainer.py] => model_prefix: asp
2025-01-05 17:06:11,956 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:06:49,757 [trainer.py] => All params: 173596160
2025-01-05 17:06:49,759 [trainer.py] => Trainable params: 1998848
2025-01-05 17:06:49,948 [asp.py] => Learning on 0-60
2025-01-05 17:06:50,017 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:11:39,298 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:11:39,298 [trainer.py] => model_name: asp
2025-01-05 17:11:39,298 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:11:39,299 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:11:39,299 [trainer.py] => seed: 2024
2025-01-05 17:11:39,299 [trainer.py] => dataset: cifar224
2025-01-05 17:11:39,299 [trainer.py] => init_cls: 60
2025-01-05 17:11:39,299 [trainer.py] => increment: 5
2025-01-05 17:11:39,299 [trainer.py] => kshot: 5
2025-01-05 17:11:39,299 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:11:39,299 [trainer.py] => z_dim: 1000
2025-01-05 17:11:39,299 [trainer.py] => conv_dim: 64
2025-01-05 17:11:39,299 [trainer.py] => img_size: 224
2025-01-05 17:11:39,299 [trainer.py] => generator_lr: 0.005
2025-01-05 17:11:39,299 [trainer.py] => pi: 100
2025-01-05 17:11:39,299 [trainer.py] => w_bn: 50.0
2025-01-05 17:11:39,299 [trainer.py] => w_noise: 0.001
2025-01-05 17:11:39,299 [trainer.py] => server_ss: 32
2025-01-05 17:11:39,299 [trainer.py] => bn_loss: 1
2025-01-05 17:11:39,299 [trainer.py] => noise: 1
2025-01-05 17:11:39,299 [trainer.py] => ie_loss: 1
2025-01-05 17:11:39,299 [trainer.py] => act_loss: 0
2025-01-05 17:11:39,299 [trainer.py] => w_ie: 1.0
2025-01-05 17:11:39,299 [trainer.py] => w_act: 0.1
2025-01-05 17:11:39,299 [trainer.py] => syn_size: 32
2025-01-05 17:11:39,299 [trainer.py] => need_syn_imgs: True
2025-01-05 17:11:39,299 [trainer.py] => g_local_bs: 5
2025-01-05 17:11:39,299 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:11:39,299 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:11:39,299 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:11:39,299 [trainer.py] => com_round_gen: 10
2025-01-05 17:11:39,299 [trainer.py] => g_sigma: 0
2025-01-05 17:11:39,299 [trainer.py] => save_cls_embeds: False
2025-01-05 17:11:39,299 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:11:39,300 [trainer.py] => save_dir: outputs
2025-01-05 17:11:39,300 [trainer.py] => n_iter: 5
2025-01-05 17:11:39,300 [trainer.py] => num_users: 1
2025-01-05 17:11:39,300 [trainer.py] => cur_size: 50
2025-01-05 17:11:39,300 [trainer.py] => vpt_type: Deep
2025-01-05 17:11:39,300 [trainer.py] => prompt_token_num: 6
2025-01-05 17:11:39,300 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:11:39,300 [trainer.py] => perturb_var: 1
2025-01-05 17:11:39,300 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:11:39,300 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:11:39,300 [trainer.py] => kl_weight: 0.001
2025-01-05 17:11:39,300 [trainer.py] => TIP_init: zero
2025-01-05 17:11:39,300 [trainer.py] => tuned_epoch: 10
2025-01-05 17:11:39,300 [trainer.py] => fs_epoch: 0
2025-01-05 17:11:39,300 [trainer.py] => init_lr: 0.01
2025-01-05 17:11:39,300 [trainer.py] => fs_lr: 0.001
2025-01-05 17:11:39,300 [trainer.py] => batch_size: 48
2025-01-05 17:11:39,300 [trainer.py] => fs_batch_size: 16
2025-01-05 17:11:39,300 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:11:39,300 [trainer.py] => min_lr: 0
2025-01-05 17:11:39,300 [trainer.py] => optimizer: sgd
2025-01-05 17:11:39,300 [trainer.py] => memory_size: 0
2025-01-05 17:11:39,300 [trainer.py] => memory_per_class: 0
2025-01-05 17:11:39,300 [trainer.py] => fixed_memory: False
2025-01-05 17:11:39,300 [trainer.py] => shuffle: False
2025-01-05 17:11:39,300 [trainer.py] => top_k: 5
2025-01-05 17:11:39,300 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:11:39,300 [trainer.py] => prefix: asp
2025-01-05 17:11:39,300 [trainer.py] => model_prefix: asp
2025-01-05 17:11:41,261 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:12:24,526 [trainer.py] => All params: 173596160
2025-01-05 17:12:24,527 [trainer.py] => Trainable params: 1998848
2025-01-05 17:12:24,707 [asp.py] => Learning on 0-60
2025-01-05 17:12:24,804 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:13:18,725 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:13:18,725 [trainer.py] => model_name: asp
2025-01-05 17:13:18,725 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:13:18,725 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:13:18,725 [trainer.py] => seed: 2024
2025-01-05 17:13:18,725 [trainer.py] => dataset: cifar224
2025-01-05 17:13:18,725 [trainer.py] => init_cls: 60
2025-01-05 17:13:18,725 [trainer.py] => increment: 5
2025-01-05 17:13:18,725 [trainer.py] => kshot: 5
2025-01-05 17:13:18,725 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:13:18,726 [trainer.py] => z_dim: 1000
2025-01-05 17:13:18,726 [trainer.py] => conv_dim: 64
2025-01-05 17:13:18,726 [trainer.py] => img_size: 224
2025-01-05 17:13:18,726 [trainer.py] => generator_lr: 0.005
2025-01-05 17:13:18,726 [trainer.py] => pi: 100
2025-01-05 17:13:18,726 [trainer.py] => w_bn: 50.0
2025-01-05 17:13:18,726 [trainer.py] => w_noise: 0.001
2025-01-05 17:13:18,726 [trainer.py] => server_ss: 32
2025-01-05 17:13:18,726 [trainer.py] => bn_loss: 1
2025-01-05 17:13:18,726 [trainer.py] => noise: 1
2025-01-05 17:13:18,726 [trainer.py] => ie_loss: 1
2025-01-05 17:13:18,726 [trainer.py] => act_loss: 0
2025-01-05 17:13:18,726 [trainer.py] => w_ie: 1.0
2025-01-05 17:13:18,726 [trainer.py] => w_act: 0.1
2025-01-05 17:13:18,726 [trainer.py] => syn_size: 32
2025-01-05 17:13:18,726 [trainer.py] => need_syn_imgs: True
2025-01-05 17:13:18,726 [trainer.py] => g_local_bs: 5
2025-01-05 17:13:18,726 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:13:18,726 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:13:18,726 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:13:18,726 [trainer.py] => com_round_gen: 10
2025-01-05 17:13:18,726 [trainer.py] => g_sigma: 0
2025-01-05 17:13:18,726 [trainer.py] => save_cls_embeds: False
2025-01-05 17:13:18,726 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:13:18,726 [trainer.py] => save_dir: outputs
2025-01-05 17:13:18,726 [trainer.py] => n_iter: 5
2025-01-05 17:13:18,726 [trainer.py] => num_users: 1
2025-01-05 17:13:18,726 [trainer.py] => cur_size: 50
2025-01-05 17:13:18,726 [trainer.py] => vpt_type: Deep
2025-01-05 17:13:18,726 [trainer.py] => prompt_token_num: 6
2025-01-05 17:13:18,726 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:13:18,726 [trainer.py] => perturb_var: 1
2025-01-05 17:13:18,726 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:13:18,726 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:13:18,727 [trainer.py] => kl_weight: 0.001
2025-01-05 17:13:18,727 [trainer.py] => TIP_init: zero
2025-01-05 17:13:18,727 [trainer.py] => tuned_epoch: 10
2025-01-05 17:13:18,727 [trainer.py] => fs_epoch: 0
2025-01-05 17:13:18,727 [trainer.py] => init_lr: 0.01
2025-01-05 17:13:18,727 [trainer.py] => fs_lr: 0.001
2025-01-05 17:13:18,727 [trainer.py] => batch_size: 48
2025-01-05 17:13:18,727 [trainer.py] => fs_batch_size: 16
2025-01-05 17:13:18,727 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:13:18,727 [trainer.py] => min_lr: 0
2025-01-05 17:13:18,727 [trainer.py] => optimizer: sgd
2025-01-05 17:13:18,727 [trainer.py] => memory_size: 0
2025-01-05 17:13:18,727 [trainer.py] => memory_per_class: 0
2025-01-05 17:13:18,727 [trainer.py] => fixed_memory: False
2025-01-05 17:13:18,727 [trainer.py] => shuffle: False
2025-01-05 17:13:18,727 [trainer.py] => top_k: 5
2025-01-05 17:13:18,727 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:13:18,727 [trainer.py] => prefix: asp
2025-01-05 17:13:18,727 [trainer.py] => model_prefix: asp
2025-01-05 17:13:20,756 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:13:54,677 [trainer.py] => All params: 173596160
2025-01-05 17:13:54,679 [trainer.py] => Trainable params: 1998848
2025-01-05 17:13:54,834 [asp.py] => Learning on 0-60
2025-01-05 17:13:54,953 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:15:13,310 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:15:13,310 [trainer.py] => model_name: asp
2025-01-05 17:15:13,311 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:15:13,311 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:15:13,311 [trainer.py] => seed: 2024
2025-01-05 17:15:13,311 [trainer.py] => dataset: cifar224
2025-01-05 17:15:13,311 [trainer.py] => init_cls: 60
2025-01-05 17:15:13,311 [trainer.py] => increment: 5
2025-01-05 17:15:13,311 [trainer.py] => kshot: 5
2025-01-05 17:15:13,311 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:15:13,311 [trainer.py] => z_dim: 1000
2025-01-05 17:15:13,311 [trainer.py] => conv_dim: 64
2025-01-05 17:15:13,311 [trainer.py] => img_size: 224
2025-01-05 17:15:13,311 [trainer.py] => generator_lr: 0.005
2025-01-05 17:15:13,311 [trainer.py] => pi: 100
2025-01-05 17:15:13,311 [trainer.py] => w_bn: 50.0
2025-01-05 17:15:13,311 [trainer.py] => w_noise: 0.001
2025-01-05 17:15:13,311 [trainer.py] => server_ss: 32
2025-01-05 17:15:13,311 [trainer.py] => bn_loss: 1
2025-01-05 17:15:13,311 [trainer.py] => noise: 1
2025-01-05 17:15:13,311 [trainer.py] => ie_loss: 1
2025-01-05 17:15:13,311 [trainer.py] => act_loss: 0
2025-01-05 17:15:13,311 [trainer.py] => w_ie: 1.0
2025-01-05 17:15:13,311 [trainer.py] => w_act: 0.1
2025-01-05 17:15:13,311 [trainer.py] => syn_size: 32
2025-01-05 17:15:13,311 [trainer.py] => need_syn_imgs: True
2025-01-05 17:15:13,311 [trainer.py] => g_local_bs: 5
2025-01-05 17:15:13,311 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:15:13,311 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:15:13,312 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:15:13,312 [trainer.py] => com_round_gen: 10
2025-01-05 17:15:13,312 [trainer.py] => g_sigma: 0
2025-01-05 17:15:13,312 [trainer.py] => save_cls_embeds: False
2025-01-05 17:15:13,312 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:15:13,312 [trainer.py] => save_dir: outputs
2025-01-05 17:15:13,312 [trainer.py] => n_iter: 5
2025-01-05 17:15:13,312 [trainer.py] => num_users: 1
2025-01-05 17:15:13,312 [trainer.py] => cur_size: 50
2025-01-05 17:15:13,312 [trainer.py] => vpt_type: Deep
2025-01-05 17:15:13,312 [trainer.py] => prompt_token_num: 6
2025-01-05 17:15:13,312 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:15:13,312 [trainer.py] => perturb_var: 1
2025-01-05 17:15:13,312 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:15:13,312 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:15:13,312 [trainer.py] => kl_weight: 0.001
2025-01-05 17:15:13,312 [trainer.py] => TIP_init: zero
2025-01-05 17:15:13,312 [trainer.py] => tuned_epoch: 10
2025-01-05 17:15:13,312 [trainer.py] => fs_epoch: 0
2025-01-05 17:15:13,312 [trainer.py] => init_lr: 0.01
2025-01-05 17:15:13,312 [trainer.py] => fs_lr: 0.001
2025-01-05 17:15:13,312 [trainer.py] => batch_size: 48
2025-01-05 17:15:13,312 [trainer.py] => fs_batch_size: 16
2025-01-05 17:15:13,312 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:15:13,312 [trainer.py] => min_lr: 0
2025-01-05 17:15:13,312 [trainer.py] => optimizer: sgd
2025-01-05 17:15:13,312 [trainer.py] => memory_size: 0
2025-01-05 17:15:13,312 [trainer.py] => memory_per_class: 0
2025-01-05 17:15:13,312 [trainer.py] => fixed_memory: False
2025-01-05 17:15:13,312 [trainer.py] => shuffle: False
2025-01-05 17:15:13,312 [trainer.py] => top_k: 5
2025-01-05 17:15:13,312 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:15:13,313 [trainer.py] => prefix: asp
2025-01-05 17:15:13,313 [trainer.py] => model_prefix: asp
2025-01-05 17:15:15,276 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:15:54,856 [trainer.py] => All params: 173596160
2025-01-05 17:15:54,858 [trainer.py] => Trainable params: 1998848
2025-01-05 17:15:55,047 [asp.py] => Learning on 0-60
2025-01-05 17:15:55,183 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:18:33,811 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:18:33,811 [trainer.py] => model_name: asp
2025-01-05 17:18:33,811 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:18:33,811 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:18:33,811 [trainer.py] => seed: 2024
2025-01-05 17:18:33,811 [trainer.py] => dataset: cifar224
2025-01-05 17:18:33,811 [trainer.py] => init_cls: 60
2025-01-05 17:18:33,811 [trainer.py] => increment: 5
2025-01-05 17:18:33,811 [trainer.py] => kshot: 5
2025-01-05 17:18:33,811 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:18:33,811 [trainer.py] => z_dim: 1000
2025-01-05 17:18:33,811 [trainer.py] => conv_dim: 64
2025-01-05 17:18:33,811 [trainer.py] => img_size: 224
2025-01-05 17:18:33,811 [trainer.py] => generator_lr: 0.005
2025-01-05 17:18:33,811 [trainer.py] => pi: 100
2025-01-05 17:18:33,811 [trainer.py] => w_bn: 50.0
2025-01-05 17:18:33,811 [trainer.py] => w_noise: 0.001
2025-01-05 17:18:33,811 [trainer.py] => server_ss: 32
2025-01-05 17:18:33,811 [trainer.py] => bn_loss: 1
2025-01-05 17:18:33,811 [trainer.py] => noise: 1
2025-01-05 17:18:33,811 [trainer.py] => ie_loss: 1
2025-01-05 17:18:33,811 [trainer.py] => act_loss: 0
2025-01-05 17:18:33,812 [trainer.py] => w_ie: 1.0
2025-01-05 17:18:33,812 [trainer.py] => w_act: 0.1
2025-01-05 17:18:33,812 [trainer.py] => syn_size: 32
2025-01-05 17:18:33,812 [trainer.py] => need_syn_imgs: True
2025-01-05 17:18:33,812 [trainer.py] => g_local_bs: 5
2025-01-05 17:18:33,812 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:18:33,812 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:18:33,812 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:18:33,812 [trainer.py] => com_round_gen: 10
2025-01-05 17:18:33,812 [trainer.py] => g_sigma: 0
2025-01-05 17:18:33,812 [trainer.py] => save_cls_embeds: False
2025-01-05 17:18:33,812 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:18:33,812 [trainer.py] => save_dir: outputs
2025-01-05 17:18:33,812 [trainer.py] => n_iter: 5
2025-01-05 17:18:33,812 [trainer.py] => num_users: 1
2025-01-05 17:18:33,812 [trainer.py] => cur_size: 50
2025-01-05 17:18:33,812 [trainer.py] => vpt_type: Deep
2025-01-05 17:18:33,812 [trainer.py] => prompt_token_num: 6
2025-01-05 17:18:33,812 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:18:33,812 [trainer.py] => perturb_var: 1
2025-01-05 17:18:33,812 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:18:33,812 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:18:33,812 [trainer.py] => kl_weight: 0.001
2025-01-05 17:18:33,812 [trainer.py] => TIP_init: zero
2025-01-05 17:18:33,812 [trainer.py] => tuned_epoch: 10
2025-01-05 17:18:33,812 [trainer.py] => fs_epoch: 0
2025-01-05 17:18:33,812 [trainer.py] => init_lr: 0.01
2025-01-05 17:18:33,812 [trainer.py] => fs_lr: 0.001
2025-01-05 17:18:33,812 [trainer.py] => batch_size: 48
2025-01-05 17:18:33,812 [trainer.py] => fs_batch_size: 16
2025-01-05 17:18:33,812 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:18:33,812 [trainer.py] => min_lr: 0
2025-01-05 17:18:33,813 [trainer.py] => optimizer: sgd
2025-01-05 17:18:33,813 [trainer.py] => memory_size: 0
2025-01-05 17:18:33,813 [trainer.py] => memory_per_class: 0
2025-01-05 17:18:33,813 [trainer.py] => fixed_memory: False
2025-01-05 17:18:33,813 [trainer.py] => shuffle: False
2025-01-05 17:18:33,813 [trainer.py] => top_k: 5
2025-01-05 17:18:33,813 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:18:33,813 [trainer.py] => prefix: asp
2025-01-05 17:18:33,813 [trainer.py] => model_prefix: asp
2025-01-05 17:18:35,709 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:19:15,306 [trainer.py] => All params: 173596160
2025-01-05 17:19:15,307 [trainer.py] => Trainable params: 1998848
2025-01-05 17:19:15,528 [asp.py] => Learning on 0-60
2025-01-05 17:19:15,759 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:29:17,937 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:29:17,937 [trainer.py] => model_name: asp
2025-01-05 17:29:17,937 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:29:17,937 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:29:17,937 [trainer.py] => seed: 2024
2025-01-05 17:29:17,937 [trainer.py] => dataset: cifar224
2025-01-05 17:29:17,937 [trainer.py] => init_cls: 60
2025-01-05 17:29:17,937 [trainer.py] => increment: 5
2025-01-05 17:29:17,937 [trainer.py] => kshot: 5
2025-01-05 17:29:17,938 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:29:17,938 [trainer.py] => z_dim: 1000
2025-01-05 17:29:17,938 [trainer.py] => conv_dim: 64
2025-01-05 17:29:17,938 [trainer.py] => img_size: 224
2025-01-05 17:29:17,938 [trainer.py] => generator_lr: 0.005
2025-01-05 17:29:17,938 [trainer.py] => pi: 100
2025-01-05 17:29:17,938 [trainer.py] => w_bn: 50.0
2025-01-05 17:29:17,938 [trainer.py] => w_noise: 0.001
2025-01-05 17:29:17,938 [trainer.py] => server_ss: 32
2025-01-05 17:29:17,938 [trainer.py] => bn_loss: 1
2025-01-05 17:29:17,938 [trainer.py] => noise: 1
2025-01-05 17:29:17,938 [trainer.py] => ie_loss: 1
2025-01-05 17:29:17,938 [trainer.py] => act_loss: 0
2025-01-05 17:29:17,938 [trainer.py] => w_ie: 1.0
2025-01-05 17:29:17,938 [trainer.py] => w_act: 0.1
2025-01-05 17:29:17,939 [trainer.py] => syn_size: 32
2025-01-05 17:29:17,939 [trainer.py] => need_syn_imgs: True
2025-01-05 17:29:17,939 [trainer.py] => g_local_bs: 5
2025-01-05 17:29:17,939 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:29:17,940 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:29:17,940 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:29:17,940 [trainer.py] => com_round_gen: 10
2025-01-05 17:29:17,940 [trainer.py] => g_sigma: 0
2025-01-05 17:29:17,940 [trainer.py] => save_cls_embeds: False
2025-01-05 17:29:17,940 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:29:17,940 [trainer.py] => save_dir: outputs
2025-01-05 17:29:17,940 [trainer.py] => n_iter: 5
2025-01-05 17:29:17,941 [trainer.py] => num_users: 1
2025-01-05 17:29:17,941 [trainer.py] => cur_size: 50
2025-01-05 17:29:17,941 [trainer.py] => vpt_type: Deep
2025-01-05 17:29:17,941 [trainer.py] => prompt_token_num: 6
2025-01-05 17:29:17,941 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:29:17,941 [trainer.py] => perturb_var: 1
2025-01-05 17:29:17,941 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:29:17,941 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:29:17,941 [trainer.py] => kl_weight: 0.001
2025-01-05 17:29:17,941 [trainer.py] => TIP_init: zero
2025-01-05 17:29:17,941 [trainer.py] => tuned_epoch: 10
2025-01-05 17:29:17,941 [trainer.py] => fs_epoch: 0
2025-01-05 17:29:17,941 [trainer.py] => init_lr: 0.01
2025-01-05 17:29:17,941 [trainer.py] => fs_lr: 0.001
2025-01-05 17:29:17,941 [trainer.py] => batch_size: 48
2025-01-05 17:29:17,941 [trainer.py] => fs_batch_size: 16
2025-01-05 17:29:17,941 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:29:17,941 [trainer.py] => min_lr: 0
2025-01-05 17:29:17,941 [trainer.py] => optimizer: sgd
2025-01-05 17:29:17,941 [trainer.py] => memory_size: 0
2025-01-05 17:29:17,941 [trainer.py] => memory_per_class: 0
2025-01-05 17:29:17,941 [trainer.py] => fixed_memory: False
2025-01-05 17:29:17,941 [trainer.py] => shuffle: False
2025-01-05 17:29:17,941 [trainer.py] => top_k: 5
2025-01-05 17:29:17,941 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:29:17,941 [trainer.py] => prefix: asp
2025-01-05 17:29:17,941 [trainer.py] => model_prefix: asp
2025-01-05 17:29:19,947 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:29:54,770 [trainer.py] => All params: 173596160
2025-01-05 17:29:54,771 [trainer.py] => Trainable params: 1998848
2025-01-05 17:29:55,014 [asp.py] => Learning on 0-60
2025-01-05 17:29:55,101 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:30:24,078 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:30:24,078 [trainer.py] => model_name: asp
2025-01-05 17:30:24,078 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:30:24,078 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:30:24,078 [trainer.py] => seed: 2024
2025-01-05 17:30:24,078 [trainer.py] => dataset: cifar224
2025-01-05 17:30:24,078 [trainer.py] => init_cls: 60
2025-01-05 17:30:24,078 [trainer.py] => increment: 5
2025-01-05 17:30:24,078 [trainer.py] => kshot: 5
2025-01-05 17:30:24,078 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:30:24,079 [trainer.py] => z_dim: 1000
2025-01-05 17:30:24,079 [trainer.py] => conv_dim: 64
2025-01-05 17:30:24,079 [trainer.py] => img_size: 224
2025-01-05 17:30:24,079 [trainer.py] => generator_lr: 0.005
2025-01-05 17:30:24,079 [trainer.py] => pi: 100
2025-01-05 17:30:24,079 [trainer.py] => w_bn: 50.0
2025-01-05 17:30:24,079 [trainer.py] => w_noise: 0.001
2025-01-05 17:30:24,079 [trainer.py] => server_ss: 32
2025-01-05 17:30:24,079 [trainer.py] => bn_loss: 1
2025-01-05 17:30:24,079 [trainer.py] => noise: 1
2025-01-05 17:30:24,079 [trainer.py] => ie_loss: 1
2025-01-05 17:30:24,079 [trainer.py] => act_loss: 0
2025-01-05 17:30:24,079 [trainer.py] => w_ie: 1.0
2025-01-05 17:30:24,079 [trainer.py] => w_act: 0.1
2025-01-05 17:30:24,079 [trainer.py] => syn_size: 32
2025-01-05 17:30:24,079 [trainer.py] => need_syn_imgs: True
2025-01-05 17:30:24,079 [trainer.py] => g_local_bs: 5
2025-01-05 17:30:24,079 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:30:24,079 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:30:24,079 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:30:24,079 [trainer.py] => com_round_gen: 10
2025-01-05 17:30:24,079 [trainer.py] => g_sigma: 0
2025-01-05 17:30:24,079 [trainer.py] => save_cls_embeds: False
2025-01-05 17:30:24,079 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:30:24,079 [trainer.py] => save_dir: outputs
2025-01-05 17:30:24,079 [trainer.py] => n_iter: 5
2025-01-05 17:30:24,079 [trainer.py] => num_users: 1
2025-01-05 17:30:24,079 [trainer.py] => cur_size: 50
2025-01-05 17:30:24,079 [trainer.py] => vpt_type: Deep
2025-01-05 17:30:24,079 [trainer.py] => prompt_token_num: 6
2025-01-05 17:30:24,079 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:30:24,080 [trainer.py] => perturb_var: 1
2025-01-05 17:30:24,080 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:30:24,080 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:30:24,080 [trainer.py] => kl_weight: 0.001
2025-01-05 17:30:24,080 [trainer.py] => TIP_init: zero
2025-01-05 17:30:24,080 [trainer.py] => tuned_epoch: 10
2025-01-05 17:30:24,080 [trainer.py] => fs_epoch: 0
2025-01-05 17:30:24,080 [trainer.py] => init_lr: 0.01
2025-01-05 17:30:24,080 [trainer.py] => fs_lr: 0.001
2025-01-05 17:30:24,080 [trainer.py] => batch_size: 48
2025-01-05 17:30:24,080 [trainer.py] => fs_batch_size: 16
2025-01-05 17:30:24,080 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:30:24,080 [trainer.py] => min_lr: 0
2025-01-05 17:30:24,080 [trainer.py] => optimizer: sgd
2025-01-05 17:30:24,080 [trainer.py] => memory_size: 0
2025-01-05 17:30:24,080 [trainer.py] => memory_per_class: 0
2025-01-05 17:30:24,080 [trainer.py] => fixed_memory: False
2025-01-05 17:30:24,080 [trainer.py] => shuffle: False
2025-01-05 17:30:24,080 [trainer.py] => top_k: 5
2025-01-05 17:30:24,080 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:30:24,080 [trainer.py] => prefix: asp
2025-01-05 17:30:24,080 [trainer.py] => model_prefix: asp
2025-01-05 17:30:25,903 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:30:56,996 [trainer.py] => All params: 173596160
2025-01-05 17:30:56,997 [trainer.py] => Trainable params: 1998848
2025-01-05 17:30:57,164 [asp.py] => Learning on 0-60
2025-01-05 17:30:57,217 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:32:14,521 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:32:14,522 [trainer.py] => model_name: asp
2025-01-05 17:32:14,522 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:32:14,522 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:32:14,522 [trainer.py] => seed: 2024
2025-01-05 17:32:14,522 [trainer.py] => dataset: cifar224
2025-01-05 17:32:14,522 [trainer.py] => init_cls: 60
2025-01-05 17:32:14,522 [trainer.py] => increment: 5
2025-01-05 17:32:14,522 [trainer.py] => kshot: 5
2025-01-05 17:32:14,522 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:32:14,522 [trainer.py] => z_dim: 1000
2025-01-05 17:32:14,522 [trainer.py] => conv_dim: 64
2025-01-05 17:32:14,522 [trainer.py] => img_size: 224
2025-01-05 17:32:14,522 [trainer.py] => generator_lr: 0.005
2025-01-05 17:32:14,522 [trainer.py] => pi: 100
2025-01-05 17:32:14,522 [trainer.py] => w_bn: 50.0
2025-01-05 17:32:14,522 [trainer.py] => w_noise: 0.001
2025-01-05 17:32:14,522 [trainer.py] => server_ss: 32
2025-01-05 17:32:14,522 [trainer.py] => bn_loss: 1
2025-01-05 17:32:14,522 [trainer.py] => noise: 1
2025-01-05 17:32:14,522 [trainer.py] => ie_loss: 1
2025-01-05 17:32:14,522 [trainer.py] => act_loss: 0
2025-01-05 17:32:14,522 [trainer.py] => w_ie: 1.0
2025-01-05 17:32:14,522 [trainer.py] => w_act: 0.1
2025-01-05 17:32:14,522 [trainer.py] => syn_size: 32
2025-01-05 17:32:14,522 [trainer.py] => need_syn_imgs: True
2025-01-05 17:32:14,522 [trainer.py] => g_local_bs: 5
2025-01-05 17:32:14,522 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:32:14,522 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:32:14,522 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:32:14,522 [trainer.py] => com_round_gen: 10
2025-01-05 17:32:14,522 [trainer.py] => g_sigma: 0
2025-01-05 17:32:14,522 [trainer.py] => save_cls_embeds: False
2025-01-05 17:32:14,523 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:32:14,523 [trainer.py] => save_dir: outputs
2025-01-05 17:32:14,523 [trainer.py] => n_iter: 5
2025-01-05 17:32:14,523 [trainer.py] => num_users: 1
2025-01-05 17:32:14,523 [trainer.py] => cur_size: 50
2025-01-05 17:32:14,523 [trainer.py] => vpt_type: Deep
2025-01-05 17:32:14,523 [trainer.py] => prompt_token_num: 6
2025-01-05 17:32:14,523 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:32:14,523 [trainer.py] => perturb_var: 1
2025-01-05 17:32:14,523 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:32:14,523 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:32:14,523 [trainer.py] => kl_weight: 0.001
2025-01-05 17:32:14,523 [trainer.py] => TIP_init: zero
2025-01-05 17:32:14,523 [trainer.py] => tuned_epoch: 10
2025-01-05 17:32:14,523 [trainer.py] => fs_epoch: 0
2025-01-05 17:32:14,523 [trainer.py] => init_lr: 0.01
2025-01-05 17:32:14,523 [trainer.py] => fs_lr: 0.001
2025-01-05 17:32:14,523 [trainer.py] => batch_size: 48
2025-01-05 17:32:14,523 [trainer.py] => fs_batch_size: 16
2025-01-05 17:32:14,523 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:32:14,523 [trainer.py] => min_lr: 0
2025-01-05 17:32:14,523 [trainer.py] => optimizer: sgd
2025-01-05 17:32:14,523 [trainer.py] => memory_size: 0
2025-01-05 17:32:14,523 [trainer.py] => memory_per_class: 0
2025-01-05 17:32:14,523 [trainer.py] => fixed_memory: False
2025-01-05 17:32:14,523 [trainer.py] => shuffle: False
2025-01-05 17:32:14,523 [trainer.py] => top_k: 5
2025-01-05 17:32:14,523 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:32:14,523 [trainer.py] => prefix: asp
2025-01-05 17:32:14,523 [trainer.py] => model_prefix: asp
2025-01-05 17:32:16,482 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:32:50,989 [trainer.py] => All params: 173596160
2025-01-05 17:32:50,991 [trainer.py] => Trainable params: 1998848
2025-01-05 17:32:51,169 [asp.py] => Learning on 0-60
2025-01-05 17:32:51,276 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:34:55,556 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:34:55,556 [trainer.py] => model_name: asp
2025-01-05 17:34:55,556 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:34:55,556 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:34:55,556 [trainer.py] => seed: 2024
2025-01-05 17:34:55,556 [trainer.py] => dataset: cifar224
2025-01-05 17:34:55,556 [trainer.py] => init_cls: 60
2025-01-05 17:34:55,556 [trainer.py] => increment: 5
2025-01-05 17:34:55,556 [trainer.py] => kshot: 5
2025-01-05 17:34:55,556 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:34:55,556 [trainer.py] => z_dim: 1000
2025-01-05 17:34:55,556 [trainer.py] => conv_dim: 64
2025-01-05 17:34:55,556 [trainer.py] => img_size: 224
2025-01-05 17:34:55,556 [trainer.py] => generator_lr: 0.005
2025-01-05 17:34:55,556 [trainer.py] => pi: 100
2025-01-05 17:34:55,556 [trainer.py] => w_bn: 50.0
2025-01-05 17:34:55,556 [trainer.py] => w_noise: 0.001
2025-01-05 17:34:55,556 [trainer.py] => server_ss: 32
2025-01-05 17:34:55,556 [trainer.py] => bn_loss: 1
2025-01-05 17:34:55,557 [trainer.py] => noise: 1
2025-01-05 17:34:55,557 [trainer.py] => ie_loss: 1
2025-01-05 17:34:55,557 [trainer.py] => act_loss: 0
2025-01-05 17:34:55,557 [trainer.py] => w_ie: 1.0
2025-01-05 17:34:55,557 [trainer.py] => w_act: 0.1
2025-01-05 17:34:55,557 [trainer.py] => syn_size: 32
2025-01-05 17:34:55,557 [trainer.py] => need_syn_imgs: True
2025-01-05 17:34:55,557 [trainer.py] => g_local_bs: 5
2025-01-05 17:34:55,557 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:34:55,557 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:34:55,557 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:34:55,557 [trainer.py] => com_round_gen: 10
2025-01-05 17:34:55,557 [trainer.py] => g_sigma: 0
2025-01-05 17:34:55,557 [trainer.py] => save_cls_embeds: False
2025-01-05 17:34:55,557 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:34:55,557 [trainer.py] => save_dir: outputs
2025-01-05 17:34:55,557 [trainer.py] => n_iter: 5
2025-01-05 17:34:55,557 [trainer.py] => num_users: 1
2025-01-05 17:34:55,557 [trainer.py] => cur_size: 50
2025-01-05 17:34:55,557 [trainer.py] => vpt_type: Deep
2025-01-05 17:34:55,557 [trainer.py] => prompt_token_num: 6
2025-01-05 17:34:55,557 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:34:55,557 [trainer.py] => perturb_var: 1
2025-01-05 17:34:55,557 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:34:55,557 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:34:55,557 [trainer.py] => kl_weight: 0.001
2025-01-05 17:34:55,557 [trainer.py] => TIP_init: zero
2025-01-05 17:34:55,557 [trainer.py] => tuned_epoch: 10
2025-01-05 17:34:55,557 [trainer.py] => fs_epoch: 0
2025-01-05 17:34:55,557 [trainer.py] => init_lr: 0.01
2025-01-05 17:34:55,557 [trainer.py] => fs_lr: 0.001
2025-01-05 17:34:55,557 [trainer.py] => batch_size: 48
2025-01-05 17:34:55,557 [trainer.py] => fs_batch_size: 16
2025-01-05 17:34:55,558 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:34:55,558 [trainer.py] => min_lr: 0
2025-01-05 17:34:55,558 [trainer.py] => optimizer: sgd
2025-01-05 17:34:55,558 [trainer.py] => memory_size: 0
2025-01-05 17:34:55,558 [trainer.py] => memory_per_class: 0
2025-01-05 17:34:55,558 [trainer.py] => fixed_memory: False
2025-01-05 17:34:55,558 [trainer.py] => shuffle: False
2025-01-05 17:34:55,558 [trainer.py] => top_k: 5
2025-01-05 17:34:55,558 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:34:55,558 [trainer.py] => prefix: asp
2025-01-05 17:34:55,558 [trainer.py] => model_prefix: asp
2025-01-05 17:34:57,339 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:35:32,248 [trainer.py] => All params: 173596160
2025-01-05 17:35:32,249 [trainer.py] => Trainable params: 1998848
2025-01-05 17:35:32,450 [asp.py] => Learning on 0-60
2025-01-05 17:35:32,536 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:38:07,268 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:38:07,268 [trainer.py] => model_name: asp
2025-01-05 17:38:07,268 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:38:07,268 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:38:07,268 [trainer.py] => seed: 2024
2025-01-05 17:38:07,268 [trainer.py] => dataset: cifar224
2025-01-05 17:38:07,268 [trainer.py] => init_cls: 60
2025-01-05 17:38:07,268 [trainer.py] => increment: 5
2025-01-05 17:38:07,268 [trainer.py] => kshot: 5
2025-01-05 17:38:07,268 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:38:07,268 [trainer.py] => z_dim: 1000
2025-01-05 17:38:07,268 [trainer.py] => conv_dim: 64
2025-01-05 17:38:07,268 [trainer.py] => img_size: 224
2025-01-05 17:38:07,268 [trainer.py] => generator_lr: 0.005
2025-01-05 17:38:07,268 [trainer.py] => pi: 100
2025-01-05 17:38:07,268 [trainer.py] => w_bn: 50.0
2025-01-05 17:38:07,268 [trainer.py] => w_noise: 0.001
2025-01-05 17:38:07,268 [trainer.py] => server_ss: 32
2025-01-05 17:38:07,268 [trainer.py] => bn_loss: 1
2025-01-05 17:38:07,268 [trainer.py] => noise: 1
2025-01-05 17:38:07,269 [trainer.py] => ie_loss: 1
2025-01-05 17:38:07,269 [trainer.py] => act_loss: 0
2025-01-05 17:38:07,269 [trainer.py] => w_ie: 1.0
2025-01-05 17:38:07,269 [trainer.py] => w_act: 0.1
2025-01-05 17:38:07,269 [trainer.py] => syn_size: 32
2025-01-05 17:38:07,269 [trainer.py] => need_syn_imgs: True
2025-01-05 17:38:07,269 [trainer.py] => g_local_bs: 5
2025-01-05 17:38:07,269 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:38:07,269 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:38:07,269 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:38:07,269 [trainer.py] => com_round_gen: 10
2025-01-05 17:38:07,269 [trainer.py] => g_sigma: 0
2025-01-05 17:38:07,269 [trainer.py] => save_cls_embeds: False
2025-01-05 17:38:07,269 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:38:07,269 [trainer.py] => save_dir: outputs
2025-01-05 17:38:07,269 [trainer.py] => n_iter: 5
2025-01-05 17:38:07,269 [trainer.py] => num_users: 1
2025-01-05 17:38:07,269 [trainer.py] => cur_size: 50
2025-01-05 17:38:07,269 [trainer.py] => vpt_type: Deep
2025-01-05 17:38:07,269 [trainer.py] => prompt_token_num: 6
2025-01-05 17:38:07,269 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:38:07,269 [trainer.py] => perturb_var: 1
2025-01-05 17:38:07,269 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:38:07,269 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:38:07,269 [trainer.py] => kl_weight: 0.001
2025-01-05 17:38:07,269 [trainer.py] => TIP_init: zero
2025-01-05 17:38:07,269 [trainer.py] => tuned_epoch: 10
2025-01-05 17:38:07,269 [trainer.py] => fs_epoch: 0
2025-01-05 17:38:07,269 [trainer.py] => init_lr: 0.01
2025-01-05 17:38:07,270 [trainer.py] => fs_lr: 0.001
2025-01-05 17:38:07,270 [trainer.py] => batch_size: 48
2025-01-05 17:38:07,270 [trainer.py] => fs_batch_size: 16
2025-01-05 17:38:07,270 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:38:07,270 [trainer.py] => min_lr: 0
2025-01-05 17:38:07,270 [trainer.py] => optimizer: sgd
2025-01-05 17:38:07,270 [trainer.py] => memory_size: 0
2025-01-05 17:38:07,270 [trainer.py] => memory_per_class: 0
2025-01-05 17:38:07,270 [trainer.py] => fixed_memory: False
2025-01-05 17:38:07,270 [trainer.py] => shuffle: False
2025-01-05 17:38:07,270 [trainer.py] => top_k: 5
2025-01-05 17:38:07,270 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:38:07,270 [trainer.py] => prefix: asp
2025-01-05 17:38:07,270 [trainer.py] => model_prefix: asp
2025-01-05 17:38:09,278 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:38:42,232 [trainer.py] => All params: 173596160
2025-01-05 17:38:42,233 [trainer.py] => Trainable params: 1998848
2025-01-05 17:38:42,396 [asp.py] => Learning on 0-60
2025-01-05 17:38:42,505 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 17:39:28,731 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 17:39:28,732 [trainer.py] => model_name: asp
2025-01-05 17:39:28,732 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 17:39:28,732 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 17:39:28,732 [trainer.py] => seed: 2024
2025-01-05 17:39:28,732 [trainer.py] => dataset: cifar224
2025-01-05 17:39:28,732 [trainer.py] => init_cls: 60
2025-01-05 17:39:28,732 [trainer.py] => increment: 5
2025-01-05 17:39:28,732 [trainer.py] => kshot: 5
2025-01-05 17:39:28,732 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 17:39:28,732 [trainer.py] => z_dim: 1000
2025-01-05 17:39:28,732 [trainer.py] => conv_dim: 64
2025-01-05 17:39:28,732 [trainer.py] => img_size: 224
2025-01-05 17:39:28,732 [trainer.py] => generator_lr: 0.005
2025-01-05 17:39:28,732 [trainer.py] => pi: 100
2025-01-05 17:39:28,732 [trainer.py] => w_bn: 50.0
2025-01-05 17:39:28,732 [trainer.py] => w_noise: 0.001
2025-01-05 17:39:28,732 [trainer.py] => server_ss: 32
2025-01-05 17:39:28,732 [trainer.py] => bn_loss: 1
2025-01-05 17:39:28,732 [trainer.py] => noise: 1
2025-01-05 17:39:28,732 [trainer.py] => ie_loss: 1
2025-01-05 17:39:28,732 [trainer.py] => act_loss: 0
2025-01-05 17:39:28,732 [trainer.py] => w_ie: 1.0
2025-01-05 17:39:28,733 [trainer.py] => w_act: 0.1
2025-01-05 17:39:28,733 [trainer.py] => syn_size: 32
2025-01-05 17:39:28,733 [trainer.py] => need_syn_imgs: True
2025-01-05 17:39:28,733 [trainer.py] => g_local_bs: 5
2025-01-05 17:39:28,733 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 17:39:28,733 [trainer.py] => g_local_train_steps: 1
2025-01-05 17:39:28,733 [trainer.py] => dataset_syn: cifar100
2025-01-05 17:39:28,733 [trainer.py] => com_round_gen: 10
2025-01-05 17:39:28,733 [trainer.py] => g_sigma: 0
2025-01-05 17:39:28,733 [trainer.py] => save_cls_embeds: False
2025-01-05 17:39:28,733 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 17:39:28,733 [trainer.py] => save_dir: outputs
2025-01-05 17:39:28,734 [trainer.py] => n_iter: 5
2025-01-05 17:39:28,734 [trainer.py] => num_users: 1
2025-01-05 17:39:28,734 [trainer.py] => cur_size: 50
2025-01-05 17:39:28,734 [trainer.py] => vpt_type: Deep
2025-01-05 17:39:28,734 [trainer.py] => prompt_token_num: 6
2025-01-05 17:39:28,735 [trainer.py] => avg_alpha: 0.8
2025-01-05 17:39:28,735 [trainer.py] => perturb_var: 1
2025-01-05 17:39:28,735 [trainer.py] => EMA_beta: 0.99
2025-01-05 17:39:28,735 [trainer.py] => anchor_lambda: 0.1
2025-01-05 17:39:28,735 [trainer.py] => kl_weight: 0.001
2025-01-05 17:39:28,736 [trainer.py] => TIP_init: zero
2025-01-05 17:39:28,736 [trainer.py] => tuned_epoch: 10
2025-01-05 17:39:28,736 [trainer.py] => fs_epoch: 0
2025-01-05 17:39:28,736 [trainer.py] => init_lr: 0.01
2025-01-05 17:39:28,736 [trainer.py] => fs_lr: 0.001
2025-01-05 17:39:28,736 [trainer.py] => batch_size: 48
2025-01-05 17:39:28,736 [trainer.py] => fs_batch_size: 16
2025-01-05 17:39:28,736 [trainer.py] => weight_decay: 0.0005
2025-01-05 17:39:28,736 [trainer.py] => min_lr: 0
2025-01-05 17:39:28,737 [trainer.py] => optimizer: sgd
2025-01-05 17:39:28,737 [trainer.py] => memory_size: 0
2025-01-05 17:39:28,737 [trainer.py] => memory_per_class: 0
2025-01-05 17:39:28,737 [trainer.py] => fixed_memory: False
2025-01-05 17:39:28,737 [trainer.py] => shuffle: False
2025-01-05 17:39:28,737 [trainer.py] => top_k: 5
2025-01-05 17:39:28,737 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 17:39:28,737 [trainer.py] => prefix: asp
2025-01-05 17:39:28,737 [trainer.py] => model_prefix: asp
2025-01-05 17:39:30,639 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 17:40:04,367 [trainer.py] => All params: 173596160
2025-01-05 17:40:04,368 [trainer.py] => Trainable params: 1998848
2025-01-05 17:40:04,597 [asp.py] => Learning on 0-60
2025-01-05 17:40:04,721 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 18:27:28,129 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 18:27:28,129 [trainer.py] => model_name: asp
2025-01-05 18:27:28,129 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 18:27:28,129 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 18:27:28,129 [trainer.py] => seed: 2024
2025-01-05 18:27:28,129 [trainer.py] => dataset: cifar224
2025-01-05 18:27:28,129 [trainer.py] => init_cls: 60
2025-01-05 18:27:28,129 [trainer.py] => increment: 5
2025-01-05 18:27:28,129 [trainer.py] => kshot: 5
2025-01-05 18:27:28,129 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 18:27:28,129 [trainer.py] => z_dim: 1000
2025-01-05 18:27:28,129 [trainer.py] => conv_dim: 64
2025-01-05 18:27:28,129 [trainer.py] => img_size: 224
2025-01-05 18:27:28,129 [trainer.py] => generator_lr: 0.005
2025-01-05 18:27:28,129 [trainer.py] => pi: 100
2025-01-05 18:27:28,129 [trainer.py] => w_bn: 50.0
2025-01-05 18:27:28,130 [trainer.py] => w_noise: 0.001
2025-01-05 18:27:28,130 [trainer.py] => server_ss: 32
2025-01-05 18:27:28,130 [trainer.py] => bn_loss: 1
2025-01-05 18:27:28,130 [trainer.py] => noise: 1
2025-01-05 18:27:28,130 [trainer.py] => ie_loss: 1
2025-01-05 18:27:28,130 [trainer.py] => act_loss: 0
2025-01-05 18:27:28,130 [trainer.py] => w_ie: 1.0
2025-01-05 18:27:28,130 [trainer.py] => w_act: 0.1
2025-01-05 18:27:28,130 [trainer.py] => syn_size: 32
2025-01-05 18:27:28,130 [trainer.py] => need_syn_imgs: True
2025-01-05 18:27:28,130 [trainer.py] => g_local_bs: 5
2025-01-05 18:27:28,130 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 18:27:28,130 [trainer.py] => g_local_train_steps: 1
2025-01-05 18:27:28,130 [trainer.py] => dataset_syn: cifar100
2025-01-05 18:27:28,130 [trainer.py] => com_round_gen: 10
2025-01-05 18:27:28,130 [trainer.py] => g_sigma: 0
2025-01-05 18:27:28,130 [trainer.py] => save_cls_embeds: False
2025-01-05 18:27:28,130 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 18:27:28,130 [trainer.py] => save_dir: outputs
2025-01-05 18:27:28,130 [trainer.py] => n_iter: 5
2025-01-05 18:27:28,130 [trainer.py] => num_users: 1
2025-01-05 18:27:28,130 [trainer.py] => cur_size: 50
2025-01-05 18:27:28,130 [trainer.py] => vpt_type: Deep
2025-01-05 18:27:28,130 [trainer.py] => prompt_token_num: 6
2025-01-05 18:27:28,130 [trainer.py] => avg_alpha: 0.8
2025-01-05 18:27:28,130 [trainer.py] => perturb_var: 1
2025-01-05 18:27:28,130 [trainer.py] => EMA_beta: 0.99
2025-01-05 18:27:28,130 [trainer.py] => anchor_lambda: 0.1
2025-01-05 18:27:28,130 [trainer.py] => kl_weight: 0.001
2025-01-05 18:27:28,130 [trainer.py] => TIP_init: zero
2025-01-05 18:27:28,130 [trainer.py] => tuned_epoch: 10
2025-01-05 18:27:28,130 [trainer.py] => fs_epoch: 0
2025-01-05 18:27:28,131 [trainer.py] => init_lr: 0.01
2025-01-05 18:27:28,131 [trainer.py] => fs_lr: 0.001
2025-01-05 18:27:28,131 [trainer.py] => batch_size: 48
2025-01-05 18:27:28,131 [trainer.py] => fs_batch_size: 16
2025-01-05 18:27:28,131 [trainer.py] => weight_decay: 0.0005
2025-01-05 18:27:28,131 [trainer.py] => min_lr: 0
2025-01-05 18:27:28,131 [trainer.py] => optimizer: sgd
2025-01-05 18:27:28,131 [trainer.py] => memory_size: 0
2025-01-05 18:27:28,131 [trainer.py] => memory_per_class: 0
2025-01-05 18:27:28,131 [trainer.py] => fixed_memory: False
2025-01-05 18:27:28,131 [trainer.py] => shuffle: False
2025-01-05 18:27:28,131 [trainer.py] => top_k: 5
2025-01-05 18:27:28,131 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 18:27:28,131 [trainer.py] => prefix: asp
2025-01-05 18:27:28,131 [trainer.py] => model_prefix: asp
2025-01-05 18:27:29,975 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 18:28:04,693 [trainer.py] => All params: 173596160
2025-01-05 18:28:04,694 [trainer.py] => Trainable params: 1998848
2025-01-05 18:28:04,878 [asp.py] => Learning on 0-60
2025-01-05 18:28:05,038 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 18:49:44,633 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 18:49:44,634 [trainer.py] => model_name: asp
2025-01-05 18:49:44,634 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 18:49:44,634 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 18:49:44,634 [trainer.py] => seed: 2024
2025-01-05 18:49:44,634 [trainer.py] => dataset: cifar224
2025-01-05 18:49:44,634 [trainer.py] => init_cls: 60
2025-01-05 18:49:44,634 [trainer.py] => increment: 5
2025-01-05 18:49:44,634 [trainer.py] => kshot: 5
2025-01-05 18:49:44,634 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 18:49:44,634 [trainer.py] => z_dim: 1000
2025-01-05 18:49:44,634 [trainer.py] => conv_dim: 64
2025-01-05 18:49:44,634 [trainer.py] => img_size: 224
2025-01-05 18:49:44,634 [trainer.py] => generator_lr: 0.005
2025-01-05 18:49:44,634 [trainer.py] => pi: 100
2025-01-05 18:49:44,634 [trainer.py] => w_bn: 50.0
2025-01-05 18:49:44,634 [trainer.py] => w_noise: 0.001
2025-01-05 18:49:44,635 [trainer.py] => server_ss: 32
2025-01-05 18:49:44,635 [trainer.py] => bn_loss: 1
2025-01-05 18:49:44,635 [trainer.py] => noise: 1
2025-01-05 18:49:44,635 [trainer.py] => ie_loss: 1
2025-01-05 18:49:44,635 [trainer.py] => act_loss: 0
2025-01-05 18:49:44,635 [trainer.py] => w_ie: 1.0
2025-01-05 18:49:44,635 [trainer.py] => w_act: 0.1
2025-01-05 18:49:44,635 [trainer.py] => syn_size: 32
2025-01-05 18:49:44,635 [trainer.py] => need_syn_imgs: True
2025-01-05 18:49:44,635 [trainer.py] => g_local_bs: 5
2025-01-05 18:49:44,635 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 18:49:44,635 [trainer.py] => g_local_train_steps: 1
2025-01-05 18:49:44,635 [trainer.py] => dataset_syn: cifar100
2025-01-05 18:49:44,635 [trainer.py] => com_round_gen: 10
2025-01-05 18:49:44,635 [trainer.py] => g_sigma: 0
2025-01-05 18:49:44,635 [trainer.py] => save_cls_embeds: False
2025-01-05 18:49:44,635 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 18:49:44,635 [trainer.py] => save_dir: outputs
2025-01-05 18:49:44,635 [trainer.py] => n_iter: 5
2025-01-05 18:49:44,635 [trainer.py] => num_users: 1
2025-01-05 18:49:44,635 [trainer.py] => cur_size: 50
2025-01-05 18:49:44,635 [trainer.py] => vpt_type: Deep
2025-01-05 18:49:44,635 [trainer.py] => prompt_token_num: 6
2025-01-05 18:49:44,635 [trainer.py] => avg_alpha: 0.8
2025-01-05 18:49:44,635 [trainer.py] => perturb_var: 1
2025-01-05 18:49:44,636 [trainer.py] => EMA_beta: 0.99
2025-01-05 18:49:44,636 [trainer.py] => anchor_lambda: 0.1
2025-01-05 18:49:44,636 [trainer.py] => kl_weight: 0.001
2025-01-05 18:49:44,636 [trainer.py] => TIP_init: zero
2025-01-05 18:49:44,636 [trainer.py] => tuned_epoch: 10
2025-01-05 18:49:44,636 [trainer.py] => fs_epoch: 0
2025-01-05 18:49:44,636 [trainer.py] => init_lr: 0.01
2025-01-05 18:49:44,636 [trainer.py] => fs_lr: 0.001
2025-01-05 18:49:44,636 [trainer.py] => batch_size: 48
2025-01-05 18:49:44,636 [trainer.py] => fs_batch_size: 16
2025-01-05 18:49:44,636 [trainer.py] => weight_decay: 0.0005
2025-01-05 18:49:44,636 [trainer.py] => min_lr: 0
2025-01-05 18:49:44,636 [trainer.py] => optimizer: sgd
2025-01-05 18:49:44,636 [trainer.py] => memory_size: 0
2025-01-05 18:49:44,636 [trainer.py] => memory_per_class: 0
2025-01-05 18:49:44,636 [trainer.py] => fixed_memory: False
2025-01-05 18:49:44,636 [trainer.py] => shuffle: False
2025-01-05 18:49:44,636 [trainer.py] => top_k: 5
2025-01-05 18:49:44,636 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 18:49:44,636 [trainer.py] => prefix: asp
2025-01-05 18:49:44,636 [trainer.py] => model_prefix: asp
2025-01-05 18:49:46,393 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 18:50:29,117 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 18:50:29,117 [trainer.py] => model_name: asp
2025-01-05 18:50:29,117 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 18:50:29,117 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 18:50:29,117 [trainer.py] => seed: 2024
2025-01-05 18:50:29,117 [trainer.py] => dataset: cifar224
2025-01-05 18:50:29,117 [trainer.py] => init_cls: 60
2025-01-05 18:50:29,117 [trainer.py] => increment: 5
2025-01-05 18:50:29,118 [trainer.py] => kshot: 5
2025-01-05 18:50:29,118 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 18:50:29,118 [trainer.py] => z_dim: 1000
2025-01-05 18:50:29,118 [trainer.py] => conv_dim: 64
2025-01-05 18:50:29,118 [trainer.py] => img_size: 224
2025-01-05 18:50:29,118 [trainer.py] => generator_lr: 0.005
2025-01-05 18:50:29,118 [trainer.py] => pi: 100
2025-01-05 18:50:29,118 [trainer.py] => w_bn: 50.0
2025-01-05 18:50:29,118 [trainer.py] => w_noise: 0.001
2025-01-05 18:50:29,118 [trainer.py] => server_ss: 32
2025-01-05 18:50:29,118 [trainer.py] => bn_loss: 1
2025-01-05 18:50:29,118 [trainer.py] => noise: 1
2025-01-05 18:50:29,118 [trainer.py] => ie_loss: 1
2025-01-05 18:50:29,118 [trainer.py] => act_loss: 0
2025-01-05 18:50:29,118 [trainer.py] => w_ie: 1.0
2025-01-05 18:50:29,118 [trainer.py] => w_act: 0.1
2025-01-05 18:50:29,118 [trainer.py] => syn_size: 32
2025-01-05 18:50:29,118 [trainer.py] => need_syn_imgs: True
2025-01-05 18:50:29,118 [trainer.py] => g_local_bs: 5
2025-01-05 18:50:29,118 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 18:50:29,118 [trainer.py] => g_local_train_steps: 1
2025-01-05 18:50:29,118 [trainer.py] => dataset_syn: cifar100
2025-01-05 18:50:29,118 [trainer.py] => com_round_gen: 10
2025-01-05 18:50:29,118 [trainer.py] => g_sigma: 0
2025-01-05 18:50:29,118 [trainer.py] => save_cls_embeds: False
2025-01-05 18:50:29,118 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 18:50:29,118 [trainer.py] => save_dir: outputs
2025-01-05 18:50:29,118 [trainer.py] => n_iter: 5
2025-01-05 18:50:29,118 [trainer.py] => num_users: 1
2025-01-05 18:50:29,118 [trainer.py] => cur_size: 50
2025-01-05 18:50:29,118 [trainer.py] => vpt_type: Deep
2025-01-05 18:50:29,118 [trainer.py] => prompt_token_num: 6
2025-01-05 18:50:29,118 [trainer.py] => avg_alpha: 0.8
2025-01-05 18:50:29,119 [trainer.py] => perturb_var: 1
2025-01-05 18:50:29,119 [trainer.py] => EMA_beta: 0.99
2025-01-05 18:50:29,119 [trainer.py] => anchor_lambda: 0.1
2025-01-05 18:50:29,119 [trainer.py] => kl_weight: 0.001
2025-01-05 18:50:29,119 [trainer.py] => TIP_init: zero
2025-01-05 18:50:29,119 [trainer.py] => tuned_epoch: 10
2025-01-05 18:50:29,119 [trainer.py] => fs_epoch: 0
2025-01-05 18:50:29,119 [trainer.py] => init_lr: 0.01
2025-01-05 18:50:29,119 [trainer.py] => fs_lr: 0.001
2025-01-05 18:50:29,119 [trainer.py] => batch_size: 48
2025-01-05 18:50:29,119 [trainer.py] => fs_batch_size: 16
2025-01-05 18:50:29,119 [trainer.py] => weight_decay: 0.0005
2025-01-05 18:50:29,119 [trainer.py] => min_lr: 0
2025-01-05 18:50:29,119 [trainer.py] => optimizer: sgd
2025-01-05 18:50:29,119 [trainer.py] => memory_size: 0
2025-01-05 18:50:29,119 [trainer.py] => memory_per_class: 0
2025-01-05 18:50:29,119 [trainer.py] => fixed_memory: False
2025-01-05 18:50:29,119 [trainer.py] => shuffle: False
2025-01-05 18:50:29,119 [trainer.py] => top_k: 5
2025-01-05 18:50:29,119 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 18:50:29,119 [trainer.py] => prefix: asp
2025-01-05 18:50:29,119 [trainer.py] => model_prefix: asp
2025-01-05 18:50:30,864 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 18:51:04,632 [trainer.py] => All params: 173596160
2025-01-05 18:51:04,633 [trainer.py] => Trainable params: 1998848
2025-01-05 18:51:04,821 [asp.py] => Learning on 0-60
2025-01-05 18:51:04,938 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 18:51:47,736 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 18:51:47,736 [trainer.py] => model_name: asp
2025-01-05 18:51:47,736 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 18:51:47,737 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 18:51:47,737 [trainer.py] => seed: 2024
2025-01-05 18:51:47,737 [trainer.py] => dataset: cifar224
2025-01-05 18:51:47,737 [trainer.py] => init_cls: 60
2025-01-05 18:51:47,737 [trainer.py] => increment: 5
2025-01-05 18:51:47,737 [trainer.py] => kshot: 5
2025-01-05 18:51:47,737 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 18:51:47,737 [trainer.py] => z_dim: 1000
2025-01-05 18:51:47,737 [trainer.py] => conv_dim: 64
2025-01-05 18:51:47,737 [trainer.py] => img_size: 224
2025-01-05 18:51:47,737 [trainer.py] => generator_lr: 0.005
2025-01-05 18:51:47,737 [trainer.py] => pi: 100
2025-01-05 18:51:47,737 [trainer.py] => w_bn: 50.0
2025-01-05 18:51:47,737 [trainer.py] => w_noise: 0.001
2025-01-05 18:51:47,737 [trainer.py] => server_ss: 32
2025-01-05 18:51:47,737 [trainer.py] => bn_loss: 1
2025-01-05 18:51:47,737 [trainer.py] => noise: 1
2025-01-05 18:51:47,737 [trainer.py] => ie_loss: 1
2025-01-05 18:51:47,737 [trainer.py] => act_loss: 0
2025-01-05 18:51:47,737 [trainer.py] => w_ie: 1.0
2025-01-05 18:51:47,737 [trainer.py] => w_act: 0.1
2025-01-05 18:51:47,737 [trainer.py] => syn_size: 32
2025-01-05 18:51:47,737 [trainer.py] => need_syn_imgs: True
2025-01-05 18:51:47,737 [trainer.py] => g_local_bs: 5
2025-01-05 18:51:47,737 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 18:51:47,737 [trainer.py] => g_local_train_steps: 1
2025-01-05 18:51:47,737 [trainer.py] => dataset_syn: cifar100
2025-01-05 18:51:47,737 [trainer.py] => com_round_gen: 10
2025-01-05 18:51:47,737 [trainer.py] => g_sigma: 0
2025-01-05 18:51:47,737 [trainer.py] => save_cls_embeds: False
2025-01-05 18:51:47,738 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 18:51:47,738 [trainer.py] => save_dir: outputs
2025-01-05 18:51:47,738 [trainer.py] => n_iter: 5
2025-01-05 18:51:47,738 [trainer.py] => num_users: 1
2025-01-05 18:51:47,738 [trainer.py] => cur_size: 50
2025-01-05 18:51:47,738 [trainer.py] => vpt_type: Deep
2025-01-05 18:51:47,738 [trainer.py] => prompt_token_num: 6
2025-01-05 18:51:47,738 [trainer.py] => avg_alpha: 0.8
2025-01-05 18:51:47,738 [trainer.py] => perturb_var: 1
2025-01-05 18:51:47,738 [trainer.py] => EMA_beta: 0.99
2025-01-05 18:51:47,738 [trainer.py] => anchor_lambda: 0.1
2025-01-05 18:51:47,738 [trainer.py] => kl_weight: 0.001
2025-01-05 18:51:47,738 [trainer.py] => TIP_init: zero
2025-01-05 18:51:47,738 [trainer.py] => tuned_epoch: 10
2025-01-05 18:51:47,738 [trainer.py] => fs_epoch: 0
2025-01-05 18:51:47,738 [trainer.py] => init_lr: 0.01
2025-01-05 18:51:47,738 [trainer.py] => fs_lr: 0.001
2025-01-05 18:51:47,738 [trainer.py] => batch_size: 48
2025-01-05 18:51:47,738 [trainer.py] => fs_batch_size: 16
2025-01-05 18:51:47,738 [trainer.py] => weight_decay: 0.0005
2025-01-05 18:51:47,738 [trainer.py] => min_lr: 0
2025-01-05 18:51:47,738 [trainer.py] => optimizer: sgd
2025-01-05 18:51:47,738 [trainer.py] => memory_size: 0
2025-01-05 18:51:47,738 [trainer.py] => memory_per_class: 0
2025-01-05 18:51:47,738 [trainer.py] => fixed_memory: False
2025-01-05 18:51:47,738 [trainer.py] => shuffle: False
2025-01-05 18:51:47,738 [trainer.py] => top_k: 5
2025-01-05 18:51:47,738 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 18:51:47,738 [trainer.py] => prefix: asp
2025-01-05 18:51:47,738 [trainer.py] => model_prefix: asp
2025-01-05 18:51:49,755 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 18:52:22,240 [trainer.py] => All params: 173596160
2025-01-05 18:52:22,241 [trainer.py] => Trainable params: 1998848
2025-01-05 18:52:22,476 [asp.py] => Learning on 0-60
2025-01-05 18:52:22,580 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 18:53:16,678 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 18:53:16,678 [trainer.py] => model_name: asp
2025-01-05 18:53:16,678 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 18:53:16,678 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 18:53:16,678 [trainer.py] => seed: 2024
2025-01-05 18:53:16,678 [trainer.py] => dataset: cifar224
2025-01-05 18:53:16,678 [trainer.py] => init_cls: 60
2025-01-05 18:53:16,678 [trainer.py] => increment: 5
2025-01-05 18:53:16,678 [trainer.py] => kshot: 5
2025-01-05 18:53:16,678 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 18:53:16,678 [trainer.py] => z_dim: 1000
2025-01-05 18:53:16,679 [trainer.py] => conv_dim: 64
2025-01-05 18:53:16,679 [trainer.py] => img_size: 224
2025-01-05 18:53:16,679 [trainer.py] => generator_lr: 0.005
2025-01-05 18:53:16,679 [trainer.py] => pi: 100
2025-01-05 18:53:16,679 [trainer.py] => w_bn: 50.0
2025-01-05 18:53:16,679 [trainer.py] => w_noise: 0.001
2025-01-05 18:53:16,679 [trainer.py] => server_ss: 32
2025-01-05 18:53:16,679 [trainer.py] => bn_loss: 1
2025-01-05 18:53:16,679 [trainer.py] => noise: 1
2025-01-05 18:53:16,679 [trainer.py] => ie_loss: 1
2025-01-05 18:53:16,679 [trainer.py] => act_loss: 0
2025-01-05 18:53:16,679 [trainer.py] => w_ie: 1.0
2025-01-05 18:53:16,679 [trainer.py] => w_act: 0.1
2025-01-05 18:53:16,679 [trainer.py] => syn_size: 32
2025-01-05 18:53:16,679 [trainer.py] => need_syn_imgs: True
2025-01-05 18:53:16,679 [trainer.py] => g_local_bs: 5
2025-01-05 18:53:16,679 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 18:53:16,679 [trainer.py] => g_local_train_steps: 1
2025-01-05 18:53:16,679 [trainer.py] => dataset_syn: cifar100
2025-01-05 18:53:16,679 [trainer.py] => com_round_gen: 10
2025-01-05 18:53:16,679 [trainer.py] => g_sigma: 0
2025-01-05 18:53:16,679 [trainer.py] => save_cls_embeds: False
2025-01-05 18:53:16,679 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 18:53:16,679 [trainer.py] => save_dir: outputs
2025-01-05 18:53:16,679 [trainer.py] => n_iter: 5
2025-01-05 18:53:16,679 [trainer.py] => num_users: 1
2025-01-05 18:53:16,679 [trainer.py] => cur_size: 50
2025-01-05 18:53:16,679 [trainer.py] => vpt_type: Deep
2025-01-05 18:53:16,679 [trainer.py] => prompt_token_num: 6
2025-01-05 18:53:16,679 [trainer.py] => avg_alpha: 0.8
2025-01-05 18:53:16,679 [trainer.py] => perturb_var: 1
2025-01-05 18:53:16,679 [trainer.py] => EMA_beta: 0.99
2025-01-05 18:53:16,679 [trainer.py] => anchor_lambda: 0.1
2025-01-05 18:53:16,679 [trainer.py] => kl_weight: 0.001
2025-01-05 18:53:16,679 [trainer.py] => TIP_init: zero
2025-01-05 18:53:16,680 [trainer.py] => tuned_epoch: 10
2025-01-05 18:53:16,680 [trainer.py] => fs_epoch: 0
2025-01-05 18:53:16,680 [trainer.py] => init_lr: 0.01
2025-01-05 18:53:16,680 [trainer.py] => fs_lr: 0.001
2025-01-05 18:53:16,680 [trainer.py] => batch_size: 48
2025-01-05 18:53:16,680 [trainer.py] => fs_batch_size: 16
2025-01-05 18:53:16,680 [trainer.py] => weight_decay: 0.0005
2025-01-05 18:53:16,680 [trainer.py] => min_lr: 0
2025-01-05 18:53:16,680 [trainer.py] => optimizer: sgd
2025-01-05 18:53:16,680 [trainer.py] => memory_size: 0
2025-01-05 18:53:16,680 [trainer.py] => memory_per_class: 0
2025-01-05 18:53:16,680 [trainer.py] => fixed_memory: False
2025-01-05 18:53:16,680 [trainer.py] => shuffle: False
2025-01-05 18:53:16,680 [trainer.py] => top_k: 5
2025-01-05 18:53:16,680 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 18:53:16,680 [trainer.py] => prefix: asp
2025-01-05 18:53:16,680 [trainer.py] => model_prefix: asp
2025-01-05 18:53:18,592 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 18:53:51,963 [trainer.py] => All params: 173596160
2025-01-05 18:53:51,967 [trainer.py] => Trainable params: 1998848
2025-01-05 18:53:52,134 [asp.py] => Learning on 0-60
2025-01-05 18:53:52,256 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 18:54:33,622 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 18:54:33,622 [trainer.py] => model_name: asp
2025-01-05 18:54:33,622 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 18:54:33,622 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 18:54:33,622 [trainer.py] => seed: 2024
2025-01-05 18:54:33,622 [trainer.py] => dataset: cifar224
2025-01-05 18:54:33,622 [trainer.py] => init_cls: 60
2025-01-05 18:54:33,622 [trainer.py] => increment: 5
2025-01-05 18:54:33,622 [trainer.py] => kshot: 5
2025-01-05 18:54:33,622 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 18:54:33,622 [trainer.py] => z_dim: 1000
2025-01-05 18:54:33,622 [trainer.py] => conv_dim: 64
2025-01-05 18:54:33,622 [trainer.py] => img_size: 224
2025-01-05 18:54:33,622 [trainer.py] => generator_lr: 0.005
2025-01-05 18:54:33,622 [trainer.py] => pi: 100
2025-01-05 18:54:33,622 [trainer.py] => w_bn: 50.0
2025-01-05 18:54:33,622 [trainer.py] => w_noise: 0.001
2025-01-05 18:54:33,622 [trainer.py] => server_ss: 32
2025-01-05 18:54:33,622 [trainer.py] => bn_loss: 1
2025-01-05 18:54:33,623 [trainer.py] => noise: 1
2025-01-05 18:54:33,623 [trainer.py] => ie_loss: 1
2025-01-05 18:54:33,623 [trainer.py] => act_loss: 0
2025-01-05 18:54:33,623 [trainer.py] => w_ie: 1.0
2025-01-05 18:54:33,623 [trainer.py] => w_act: 0.1
2025-01-05 18:54:33,623 [trainer.py] => syn_size: 32
2025-01-05 18:54:33,623 [trainer.py] => need_syn_imgs: True
2025-01-05 18:54:33,623 [trainer.py] => g_local_bs: 5
2025-01-05 18:54:33,623 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 18:54:33,623 [trainer.py] => g_local_train_steps: 1
2025-01-05 18:54:33,623 [trainer.py] => dataset_syn: cifar100
2025-01-05 18:54:33,623 [trainer.py] => com_round_gen: 10
2025-01-05 18:54:33,623 [trainer.py] => g_sigma: 0
2025-01-05 18:54:33,623 [trainer.py] => save_cls_embeds: False
2025-01-05 18:54:33,623 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 18:54:33,623 [trainer.py] => save_dir: outputs
2025-01-05 18:54:33,623 [trainer.py] => n_iter: 5
2025-01-05 18:54:33,623 [trainer.py] => num_users: 1
2025-01-05 18:54:33,623 [trainer.py] => cur_size: 50
2025-01-05 18:54:33,623 [trainer.py] => vpt_type: Deep
2025-01-05 18:54:33,623 [trainer.py] => prompt_token_num: 6
2025-01-05 18:54:33,623 [trainer.py] => avg_alpha: 0.8
2025-01-05 18:54:33,623 [trainer.py] => perturb_var: 1
2025-01-05 18:54:33,623 [trainer.py] => EMA_beta: 0.99
2025-01-05 18:54:33,623 [trainer.py] => anchor_lambda: 0.1
2025-01-05 18:54:33,623 [trainer.py] => kl_weight: 0.001
2025-01-05 18:54:33,623 [trainer.py] => TIP_init: zero
2025-01-05 18:54:33,623 [trainer.py] => tuned_epoch: 10
2025-01-05 18:54:33,623 [trainer.py] => fs_epoch: 0
2025-01-05 18:54:33,623 [trainer.py] => init_lr: 0.01
2025-01-05 18:54:33,623 [trainer.py] => fs_lr: 0.001
2025-01-05 18:54:33,623 [trainer.py] => batch_size: 48
2025-01-05 18:54:33,623 [trainer.py] => fs_batch_size: 16
2025-01-05 18:54:33,623 [trainer.py] => weight_decay: 0.0005
2025-01-05 18:54:33,624 [trainer.py] => min_lr: 0
2025-01-05 18:54:33,624 [trainer.py] => optimizer: sgd
2025-01-05 18:54:33,624 [trainer.py] => memory_size: 0
2025-01-05 18:54:33,624 [trainer.py] => memory_per_class: 0
2025-01-05 18:54:33,624 [trainer.py] => fixed_memory: False
2025-01-05 18:54:33,624 [trainer.py] => shuffle: False
2025-01-05 18:54:33,624 [trainer.py] => top_k: 5
2025-01-05 18:54:33,624 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 18:54:33,624 [trainer.py] => prefix: asp
2025-01-05 18:54:33,624 [trainer.py] => model_prefix: asp
2025-01-05 18:54:35,289 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 18:55:07,810 [trainer.py] => All params: 173596160
2025-01-05 18:55:07,811 [trainer.py] => Trainable params: 1998848
2025-01-05 18:55:08,009 [asp.py] => Learning on 0-60
2025-01-05 18:55:08,158 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 18:55:50,054 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 18:55:50,054 [trainer.py] => model_name: asp
2025-01-05 18:55:50,054 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 18:55:50,054 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 18:55:50,055 [trainer.py] => seed: 2024
2025-01-05 18:55:50,055 [trainer.py] => dataset: cifar224
2025-01-05 18:55:50,055 [trainer.py] => init_cls: 60
2025-01-05 18:55:50,055 [trainer.py] => increment: 5
2025-01-05 18:55:50,055 [trainer.py] => kshot: 5
2025-01-05 18:55:50,055 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 18:55:50,055 [trainer.py] => z_dim: 1000
2025-01-05 18:55:50,055 [trainer.py] => conv_dim: 64
2025-01-05 18:55:50,055 [trainer.py] => img_size: 224
2025-01-05 18:55:50,055 [trainer.py] => generator_lr: 0.005
2025-01-05 18:55:50,055 [trainer.py] => pi: 100
2025-01-05 18:55:50,055 [trainer.py] => w_bn: 50.0
2025-01-05 18:55:50,055 [trainer.py] => w_noise: 0.001
2025-01-05 18:55:50,055 [trainer.py] => server_ss: 32
2025-01-05 18:55:50,055 [trainer.py] => bn_loss: 1
2025-01-05 18:55:50,055 [trainer.py] => noise: 1
2025-01-05 18:55:50,055 [trainer.py] => ie_loss: 1
2025-01-05 18:55:50,055 [trainer.py] => act_loss: 0
2025-01-05 18:55:50,055 [trainer.py] => w_ie: 1.0
2025-01-05 18:55:50,055 [trainer.py] => w_act: 0.1
2025-01-05 18:55:50,055 [trainer.py] => syn_size: 32
2025-01-05 18:55:50,055 [trainer.py] => need_syn_imgs: True
2025-01-05 18:55:50,055 [trainer.py] => g_local_bs: 5
2025-01-05 18:55:50,055 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 18:55:50,055 [trainer.py] => g_local_train_steps: 1
2025-01-05 18:55:50,055 [trainer.py] => dataset_syn: cifar100
2025-01-05 18:55:50,055 [trainer.py] => com_round_gen: 10
2025-01-05 18:55:50,055 [trainer.py] => g_sigma: 0
2025-01-05 18:55:50,055 [trainer.py] => save_cls_embeds: False
2025-01-05 18:55:50,055 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 18:55:50,055 [trainer.py] => save_dir: outputs
2025-01-05 18:55:50,055 [trainer.py] => n_iter: 5
2025-01-05 18:55:50,055 [trainer.py] => num_users: 1
2025-01-05 18:55:50,055 [trainer.py] => cur_size: 50
2025-01-05 18:55:50,056 [trainer.py] => vpt_type: Deep
2025-01-05 18:55:50,056 [trainer.py] => prompt_token_num: 6
2025-01-05 18:55:50,056 [trainer.py] => avg_alpha: 0.8
2025-01-05 18:55:50,056 [trainer.py] => perturb_var: 1
2025-01-05 18:55:50,056 [trainer.py] => EMA_beta: 0.99
2025-01-05 18:55:50,056 [trainer.py] => anchor_lambda: 0.1
2025-01-05 18:55:50,056 [trainer.py] => kl_weight: 0.001
2025-01-05 18:55:50,056 [trainer.py] => TIP_init: zero
2025-01-05 18:55:50,056 [trainer.py] => tuned_epoch: 10
2025-01-05 18:55:50,056 [trainer.py] => fs_epoch: 0
2025-01-05 18:55:50,056 [trainer.py] => init_lr: 0.01
2025-01-05 18:55:50,056 [trainer.py] => fs_lr: 0.001
2025-01-05 18:55:50,056 [trainer.py] => batch_size: 48
2025-01-05 18:55:50,056 [trainer.py] => fs_batch_size: 16
2025-01-05 18:55:50,056 [trainer.py] => weight_decay: 0.0005
2025-01-05 18:55:50,056 [trainer.py] => min_lr: 0
2025-01-05 18:55:50,056 [trainer.py] => optimizer: sgd
2025-01-05 18:55:50,056 [trainer.py] => memory_size: 0
2025-01-05 18:55:50,056 [trainer.py] => memory_per_class: 0
2025-01-05 18:55:50,056 [trainer.py] => fixed_memory: False
2025-01-05 18:55:50,056 [trainer.py] => shuffle: False
2025-01-05 18:55:50,056 [trainer.py] => top_k: 5
2025-01-05 18:55:50,056 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 18:55:50,056 [trainer.py] => prefix: asp
2025-01-05 18:55:50,056 [trainer.py] => model_prefix: asp
2025-01-05 18:55:51,960 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 18:56:25,564 [trainer.py] => All params: 173596160
2025-01-05 18:56:25,564 [trainer.py] => Trainable params: 1998848
2025-01-05 18:56:25,748 [asp.py] => Learning on 0-60
2025-01-05 18:56:25,930 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 18:57:31,283 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 18:57:31,283 [trainer.py] => model_name: asp
2025-01-05 18:57:31,283 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 18:57:31,283 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 18:57:31,283 [trainer.py] => seed: 2024
2025-01-05 18:57:31,283 [trainer.py] => dataset: cifar224
2025-01-05 18:57:31,284 [trainer.py] => init_cls: 60
2025-01-05 18:57:31,284 [trainer.py] => increment: 5
2025-01-05 18:57:31,284 [trainer.py] => kshot: 5
2025-01-05 18:57:31,284 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 18:57:31,284 [trainer.py] => z_dim: 1000
2025-01-05 18:57:31,284 [trainer.py] => conv_dim: 64
2025-01-05 18:57:31,284 [trainer.py] => img_size: 224
2025-01-05 18:57:31,284 [trainer.py] => generator_lr: 0.005
2025-01-05 18:57:31,284 [trainer.py] => pi: 100
2025-01-05 18:57:31,284 [trainer.py] => w_bn: 50.0
2025-01-05 18:57:31,284 [trainer.py] => w_noise: 0.001
2025-01-05 18:57:31,284 [trainer.py] => server_ss: 32
2025-01-05 18:57:31,284 [trainer.py] => bn_loss: 1
2025-01-05 18:57:31,284 [trainer.py] => noise: 1
2025-01-05 18:57:31,284 [trainer.py] => ie_loss: 1
2025-01-05 18:57:31,284 [trainer.py] => act_loss: 0
2025-01-05 18:57:31,284 [trainer.py] => w_ie: 1.0
2025-01-05 18:57:31,284 [trainer.py] => w_act: 0.1
2025-01-05 18:57:31,284 [trainer.py] => syn_size: 32
2025-01-05 18:57:31,284 [trainer.py] => need_syn_imgs: True
2025-01-05 18:57:31,284 [trainer.py] => g_local_bs: 5
2025-01-05 18:57:31,284 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 18:57:31,284 [trainer.py] => g_local_train_steps: 1
2025-01-05 18:57:31,284 [trainer.py] => dataset_syn: cifar100
2025-01-05 18:57:31,284 [trainer.py] => com_round_gen: 10
2025-01-05 18:57:31,284 [trainer.py] => g_sigma: 0
2025-01-05 18:57:31,284 [trainer.py] => save_cls_embeds: False
2025-01-05 18:57:31,284 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 18:57:31,284 [trainer.py] => save_dir: outputs
2025-01-05 18:57:31,284 [trainer.py] => n_iter: 5
2025-01-05 18:57:31,284 [trainer.py] => num_users: 1
2025-01-05 18:57:31,284 [trainer.py] => cur_size: 50
2025-01-05 18:57:31,285 [trainer.py] => vpt_type: Deep
2025-01-05 18:57:31,285 [trainer.py] => prompt_token_num: 6
2025-01-05 18:57:31,285 [trainer.py] => avg_alpha: 0.8
2025-01-05 18:57:31,285 [trainer.py] => perturb_var: 1
2025-01-05 18:57:31,285 [trainer.py] => EMA_beta: 0.99
2025-01-05 18:57:31,285 [trainer.py] => anchor_lambda: 0.1
2025-01-05 18:57:31,285 [trainer.py] => kl_weight: 0.001
2025-01-05 18:57:31,285 [trainer.py] => TIP_init: zero
2025-01-05 18:57:31,285 [trainer.py] => tuned_epoch: 10
2025-01-05 18:57:31,285 [trainer.py] => fs_epoch: 0
2025-01-05 18:57:31,285 [trainer.py] => init_lr: 0.01
2025-01-05 18:57:31,285 [trainer.py] => fs_lr: 0.001
2025-01-05 18:57:31,285 [trainer.py] => batch_size: 48
2025-01-05 18:57:31,285 [trainer.py] => fs_batch_size: 16
2025-01-05 18:57:31,285 [trainer.py] => weight_decay: 0.0005
2025-01-05 18:57:31,285 [trainer.py] => min_lr: 0
2025-01-05 18:57:31,285 [trainer.py] => optimizer: sgd
2025-01-05 18:57:31,285 [trainer.py] => memory_size: 0
2025-01-05 18:57:31,285 [trainer.py] => memory_per_class: 0
2025-01-05 18:57:31,285 [trainer.py] => fixed_memory: False
2025-01-05 18:57:31,285 [trainer.py] => shuffle: False
2025-01-05 18:57:31,285 [trainer.py] => top_k: 5
2025-01-05 18:57:31,285 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 18:57:31,285 [trainer.py] => prefix: asp
2025-01-05 18:57:31,285 [trainer.py] => model_prefix: asp
2025-01-05 18:57:33,322 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 18:58:09,518 [trainer.py] => All params: 173596160
2025-01-05 18:58:09,519 [trainer.py] => Trainable params: 1998848
2025-01-05 18:58:32,397 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 18:58:32,397 [trainer.py] => model_name: asp
2025-01-05 18:58:32,397 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 18:58:32,397 [trainer.py] => device: [device(type='cuda', index=7)]
2025-01-05 18:58:32,397 [trainer.py] => seed: 2024
2025-01-05 18:58:32,397 [trainer.py] => dataset: cifar224
2025-01-05 18:58:32,397 [trainer.py] => init_cls: 60
2025-01-05 18:58:32,397 [trainer.py] => increment: 5
2025-01-05 18:58:32,397 [trainer.py] => kshot: 5
2025-01-05 18:58:32,397 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 18:58:32,397 [trainer.py] => z_dim: 1000
2025-01-05 18:58:32,397 [trainer.py] => conv_dim: 64
2025-01-05 18:58:32,398 [trainer.py] => img_size: 224
2025-01-05 18:58:32,398 [trainer.py] => generator_lr: 0.005
2025-01-05 18:58:32,398 [trainer.py] => pi: 100
2025-01-05 18:58:32,398 [trainer.py] => w_bn: 50.0
2025-01-05 18:58:32,398 [trainer.py] => w_noise: 0.001
2025-01-05 18:58:32,398 [trainer.py] => server_ss: 32
2025-01-05 18:58:32,398 [trainer.py] => bn_loss: 1
2025-01-05 18:58:32,398 [trainer.py] => noise: 1
2025-01-05 18:58:32,398 [trainer.py] => ie_loss: 1
2025-01-05 18:58:32,398 [trainer.py] => act_loss: 0
2025-01-05 18:58:32,398 [trainer.py] => w_ie: 1.0
2025-01-05 18:58:32,398 [trainer.py] => w_act: 0.1
2025-01-05 18:58:32,398 [trainer.py] => syn_size: 32
2025-01-05 18:58:32,398 [trainer.py] => need_syn_imgs: True
2025-01-05 18:58:32,398 [trainer.py] => g_local_bs: 5
2025-01-05 18:58:32,398 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 18:58:32,398 [trainer.py] => g_local_train_steps: 1
2025-01-05 18:58:32,398 [trainer.py] => dataset_syn: cifar100
2025-01-05 18:58:32,399 [trainer.py] => com_round_gen: 10
2025-01-05 18:58:32,399 [trainer.py] => g_sigma: 0
2025-01-05 18:58:32,399 [trainer.py] => save_cls_embeds: False
2025-01-05 18:58:32,399 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 18:58:32,399 [trainer.py] => save_dir: outputs
2025-01-05 18:58:32,399 [trainer.py] => n_iter: 5
2025-01-05 18:58:32,399 [trainer.py] => num_users: 1
2025-01-05 18:58:32,399 [trainer.py] => cur_size: 50
2025-01-05 18:58:32,399 [trainer.py] => vpt_type: Deep
2025-01-05 18:58:32,399 [trainer.py] => prompt_token_num: 6
2025-01-05 18:58:32,399 [trainer.py] => avg_alpha: 0.8
2025-01-05 18:58:32,399 [trainer.py] => perturb_var: 1
2025-01-05 18:58:32,399 [trainer.py] => EMA_beta: 0.99
2025-01-05 18:58:32,399 [trainer.py] => anchor_lambda: 0.1
2025-01-05 18:58:32,399 [trainer.py] => kl_weight: 0.001
2025-01-05 18:58:32,399 [trainer.py] => TIP_init: zero
2025-01-05 18:58:32,399 [trainer.py] => tuned_epoch: 10
2025-01-05 18:58:32,399 [trainer.py] => fs_epoch: 0
2025-01-05 18:58:32,399 [trainer.py] => init_lr: 0.01
2025-01-05 18:58:32,400 [trainer.py] => fs_lr: 0.001
2025-01-05 18:58:32,400 [trainer.py] => batch_size: 48
2025-01-05 18:58:32,400 [trainer.py] => fs_batch_size: 16
2025-01-05 18:58:32,400 [trainer.py] => weight_decay: 0.0005
2025-01-05 18:58:32,400 [trainer.py] => min_lr: 0
2025-01-05 18:58:32,400 [trainer.py] => optimizer: sgd
2025-01-05 18:58:32,400 [trainer.py] => memory_size: 0
2025-01-05 18:58:32,400 [trainer.py] => memory_per_class: 0
2025-01-05 18:58:32,400 [trainer.py] => fixed_memory: False
2025-01-05 18:58:32,400 [trainer.py] => shuffle: False
2025-01-05 18:58:32,400 [trainer.py] => top_k: 5
2025-01-05 18:58:32,400 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 18:58:32,400 [trainer.py] => prefix: asp
2025-01-05 18:58:32,400 [trainer.py] => model_prefix: asp
2025-01-05 18:58:34,210 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 18:59:06,376 [trainer.py] => All params: 173596160
2025-01-05 18:59:06,377 [trainer.py] => Trainable params: 1998848
2025-01-05 18:59:06,557 [asp.py] => Learning on 0-60
2025-01-05 18:59:06,650 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 19:03:16,501 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:03:16,502 [trainer.py] => model_name: asp
2025-01-05 19:03:16,502 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:03:16,502 [trainer.py] => device: cuda
2025-01-05 19:03:16,502 [trainer.py] => seed: 2024
2025-01-05 19:03:16,502 [trainer.py] => dataset: cifar224
2025-01-05 19:03:16,502 [trainer.py] => init_cls: 60
2025-01-05 19:03:16,502 [trainer.py] => increment: 5
2025-01-05 19:03:16,502 [trainer.py] => kshot: 5
2025-01-05 19:03:16,502 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:03:16,502 [trainer.py] => z_dim: 1000
2025-01-05 19:03:16,502 [trainer.py] => conv_dim: 64
2025-01-05 19:03:16,502 [trainer.py] => img_size: 224
2025-01-05 19:03:16,502 [trainer.py] => generator_lr: 0.005
2025-01-05 19:03:16,502 [trainer.py] => pi: 100
2025-01-05 19:03:16,502 [trainer.py] => w_bn: 50.0
2025-01-05 19:03:16,502 [trainer.py] => w_noise: 0.001
2025-01-05 19:03:16,502 [trainer.py] => server_ss: 32
2025-01-05 19:03:16,502 [trainer.py] => bn_loss: 1
2025-01-05 19:03:16,502 [trainer.py] => noise: 1
2025-01-05 19:03:16,502 [trainer.py] => ie_loss: 1
2025-01-05 19:03:16,502 [trainer.py] => act_loss: 0
2025-01-05 19:03:16,502 [trainer.py] => w_ie: 1.0
2025-01-05 19:03:16,502 [trainer.py] => w_act: 0.1
2025-01-05 19:03:16,502 [trainer.py] => syn_size: 32
2025-01-05 19:03:16,502 [trainer.py] => need_syn_imgs: True
2025-01-05 19:03:16,502 [trainer.py] => g_local_bs: 5
2025-01-05 19:03:16,502 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:03:16,502 [trainer.py] => g_local_train_steps: 1
2025-01-05 19:03:16,503 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:03:16,503 [trainer.py] => com_round_gen: 10
2025-01-05 19:03:16,503 [trainer.py] => g_sigma: 0
2025-01-05 19:03:16,503 [trainer.py] => save_cls_embeds: False
2025-01-05 19:03:16,503 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 19:03:16,503 [trainer.py] => save_dir: outputs
2025-01-05 19:03:16,503 [trainer.py] => n_iter: 5
2025-01-05 19:03:16,503 [trainer.py] => num_users: 1
2025-01-05 19:03:16,503 [trainer.py] => cur_size: 50
2025-01-05 19:03:16,503 [trainer.py] => vpt_type: Deep
2025-01-05 19:03:16,503 [trainer.py] => prompt_token_num: 6
2025-01-05 19:03:16,503 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:03:16,503 [trainer.py] => perturb_var: 1
2025-01-05 19:03:16,503 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:03:16,503 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:03:16,503 [trainer.py] => kl_weight: 0.001
2025-01-05 19:03:16,503 [trainer.py] => TIP_init: zero
2025-01-05 19:03:16,503 [trainer.py] => tuned_epoch: 10
2025-01-05 19:03:16,503 [trainer.py] => fs_epoch: 0
2025-01-05 19:03:16,503 [trainer.py] => init_lr: 0.01
2025-01-05 19:03:16,503 [trainer.py] => fs_lr: 0.001
2025-01-05 19:03:16,503 [trainer.py] => batch_size: 48
2025-01-05 19:03:16,503 [trainer.py] => fs_batch_size: 16
2025-01-05 19:03:16,503 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:03:16,503 [trainer.py] => min_lr: 0
2025-01-05 19:03:16,503 [trainer.py] => optimizer: sgd
2025-01-05 19:03:16,503 [trainer.py] => memory_size: 0
2025-01-05 19:03:16,503 [trainer.py] => memory_per_class: 0
2025-01-05 19:03:16,503 [trainer.py] => fixed_memory: False
2025-01-05 19:03:16,503 [trainer.py] => shuffle: False
2025-01-05 19:03:16,503 [trainer.py] => top_k: 5
2025-01-05 19:03:16,503 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:03:16,503 [trainer.py] => prefix: asp
2025-01-05 19:03:16,503 [trainer.py] => model_prefix: asp
2025-01-05 19:03:18,250 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:03:51,955 [trainer.py] => All params: 173596160
2025-01-05 19:03:51,957 [trainer.py] => Trainable params: 1998848
2025-01-05 19:08:13,358 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:08:13,358 [trainer.py] => model_name: asp
2025-01-05 19:08:13,358 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:08:13,358 [trainer.py] => device: ['cuda']
2025-01-05 19:08:13,358 [trainer.py] => seed: 2024
2025-01-05 19:08:13,358 [trainer.py] => dataset: cifar224
2025-01-05 19:08:13,358 [trainer.py] => init_cls: 60
2025-01-05 19:08:13,358 [trainer.py] => increment: 5
2025-01-05 19:08:13,358 [trainer.py] => kshot: 5
2025-01-05 19:08:13,358 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:08:13,358 [trainer.py] => z_dim: 1000
2025-01-05 19:08:13,358 [trainer.py] => conv_dim: 64
2025-01-05 19:08:13,358 [trainer.py] => img_size: 224
2025-01-05 19:08:13,358 [trainer.py] => generator_lr: 0.005
2025-01-05 19:08:13,358 [trainer.py] => pi: 100
2025-01-05 19:08:13,359 [trainer.py] => w_bn: 50.0
2025-01-05 19:08:13,359 [trainer.py] => w_noise: 0.001
2025-01-05 19:08:13,359 [trainer.py] => server_ss: 32
2025-01-05 19:08:13,359 [trainer.py] => bn_loss: 1
2025-01-05 19:08:13,359 [trainer.py] => noise: 1
2025-01-05 19:08:13,359 [trainer.py] => ie_loss: 1
2025-01-05 19:08:13,359 [trainer.py] => act_loss: 0
2025-01-05 19:08:13,359 [trainer.py] => w_ie: 1.0
2025-01-05 19:08:13,359 [trainer.py] => w_act: 0.1
2025-01-05 19:08:13,359 [trainer.py] => syn_size: 32
2025-01-05 19:08:13,359 [trainer.py] => need_syn_imgs: True
2025-01-05 19:08:13,359 [trainer.py] => g_local_bs: 5
2025-01-05 19:08:13,359 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:08:13,359 [trainer.py] => g_local_train_steps: 1
2025-01-05 19:08:13,359 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:08:13,359 [trainer.py] => com_round_gen: 10
2025-01-05 19:08:13,359 [trainer.py] => g_sigma: 0
2025-01-05 19:08:13,359 [trainer.py] => save_cls_embeds: False
2025-01-05 19:08:13,359 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 19:08:13,359 [trainer.py] => save_dir: outputs
2025-01-05 19:08:13,359 [trainer.py] => n_iter: 5
2025-01-05 19:08:13,359 [trainer.py] => num_users: 1
2025-01-05 19:08:13,359 [trainer.py] => cur_size: 50
2025-01-05 19:08:13,359 [trainer.py] => vpt_type: Deep
2025-01-05 19:08:13,359 [trainer.py] => prompt_token_num: 6
2025-01-05 19:08:13,359 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:08:13,359 [trainer.py] => perturb_var: 1
2025-01-05 19:08:13,359 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:08:13,359 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:08:13,359 [trainer.py] => kl_weight: 0.001
2025-01-05 19:08:13,359 [trainer.py] => TIP_init: zero
2025-01-05 19:08:13,359 [trainer.py] => tuned_epoch: 10
2025-01-05 19:08:13,360 [trainer.py] => fs_epoch: 0
2025-01-05 19:08:13,360 [trainer.py] => init_lr: 0.01
2025-01-05 19:08:13,360 [trainer.py] => fs_lr: 0.001
2025-01-05 19:08:13,360 [trainer.py] => batch_size: 48
2025-01-05 19:08:13,360 [trainer.py] => fs_batch_size: 16
2025-01-05 19:08:13,360 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:08:13,360 [trainer.py] => min_lr: 0
2025-01-05 19:08:13,360 [trainer.py] => optimizer: sgd
2025-01-05 19:08:13,360 [trainer.py] => memory_size: 0
2025-01-05 19:08:13,360 [trainer.py] => memory_per_class: 0
2025-01-05 19:08:13,360 [trainer.py] => fixed_memory: False
2025-01-05 19:08:13,360 [trainer.py] => shuffle: False
2025-01-05 19:08:13,360 [trainer.py] => top_k: 5
2025-01-05 19:08:13,360 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:08:13,360 [trainer.py] => prefix: asp
2025-01-05 19:08:13,360 [trainer.py] => model_prefix: asp
2025-01-05 19:08:15,432 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:08:50,562 [trainer.py] => All params: 173596160
2025-01-05 19:08:50,563 [trainer.py] => Trainable params: 1998848
2025-01-05 19:08:50,564 [asp.py] => Learning on 0-60
2025-01-05 19:08:50,755 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 19:09:54,468 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:09:54,468 [trainer.py] => model_name: asp
2025-01-05 19:09:54,468 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:09:54,469 [trainer.py] => device: ['cuda']
2025-01-05 19:09:54,469 [trainer.py] => seed: 2024
2025-01-05 19:09:54,469 [trainer.py] => dataset: cifar224
2025-01-05 19:09:54,469 [trainer.py] => init_cls: 60
2025-01-05 19:09:54,469 [trainer.py] => increment: 5
2025-01-05 19:09:54,469 [trainer.py] => kshot: 5
2025-01-05 19:09:54,469 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:09:54,469 [trainer.py] => z_dim: 1000
2025-01-05 19:09:54,469 [trainer.py] => conv_dim: 64
2025-01-05 19:09:54,469 [trainer.py] => img_size: 224
2025-01-05 19:09:54,469 [trainer.py] => generator_lr: 0.005
2025-01-05 19:09:54,469 [trainer.py] => pi: 100
2025-01-05 19:09:54,469 [trainer.py] => w_bn: 50.0
2025-01-05 19:09:54,469 [trainer.py] => w_noise: 0.001
2025-01-05 19:09:54,469 [trainer.py] => server_ss: 32
2025-01-05 19:09:54,469 [trainer.py] => bn_loss: 1
2025-01-05 19:09:54,469 [trainer.py] => noise: 1
2025-01-05 19:09:54,470 [trainer.py] => ie_loss: 1
2025-01-05 19:09:54,470 [trainer.py] => act_loss: 0
2025-01-05 19:09:54,470 [trainer.py] => w_ie: 1.0
2025-01-05 19:09:54,470 [trainer.py] => w_act: 0.1
2025-01-05 19:09:54,471 [trainer.py] => syn_size: 32
2025-01-05 19:09:54,471 [trainer.py] => need_syn_imgs: True
2025-01-05 19:09:54,471 [trainer.py] => g_local_bs: 5
2025-01-05 19:09:54,471 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:09:54,471 [trainer.py] => g_local_train_steps: 1
2025-01-05 19:09:54,471 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:09:54,471 [trainer.py] => com_round_gen: 10
2025-01-05 19:09:54,471 [trainer.py] => g_sigma: 0
2025-01-05 19:09:54,472 [trainer.py] => save_cls_embeds: False
2025-01-05 19:09:54,472 [trainer.py] => syn_image_path: outputs/syn_image
2025-01-05 19:09:54,472 [trainer.py] => save_dir: outputs
2025-01-05 19:09:54,472 [trainer.py] => n_iter: 5
2025-01-05 19:09:54,472 [trainer.py] => num_users: 1
2025-01-05 19:09:54,472 [trainer.py] => cur_size: 50
2025-01-05 19:09:54,472 [trainer.py] => vpt_type: Deep
2025-01-05 19:09:54,472 [trainer.py] => prompt_token_num: 6
2025-01-05 19:09:54,472 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:09:54,472 [trainer.py] => perturb_var: 1
2025-01-05 19:09:54,472 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:09:54,472 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:09:54,472 [trainer.py] => kl_weight: 0.001
2025-01-05 19:09:54,472 [trainer.py] => TIP_init: zero
2025-01-05 19:09:54,472 [trainer.py] => tuned_epoch: 10
2025-01-05 19:09:54,472 [trainer.py] => fs_epoch: 0
2025-01-05 19:09:54,472 [trainer.py] => init_lr: 0.01
2025-01-05 19:09:54,473 [trainer.py] => fs_lr: 0.001
2025-01-05 19:09:54,473 [trainer.py] => batch_size: 48
2025-01-05 19:09:54,473 [trainer.py] => fs_batch_size: 16
2025-01-05 19:09:54,473 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:09:54,473 [trainer.py] => min_lr: 0
2025-01-05 19:09:54,473 [trainer.py] => optimizer: sgd
2025-01-05 19:09:54,473 [trainer.py] => memory_size: 0
2025-01-05 19:09:54,473 [trainer.py] => memory_per_class: 0
2025-01-05 19:09:54,474 [trainer.py] => fixed_memory: False
2025-01-05 19:09:54,474 [trainer.py] => shuffle: False
2025-01-05 19:09:54,474 [trainer.py] => top_k: 5
2025-01-05 19:09:54,474 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:09:54,474 [trainer.py] => prefix: asp
2025-01-05 19:09:54,474 [trainer.py] => model_prefix: asp
2025-01-05 19:09:56,363 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:10:35,031 [trainer.py] => All params: 173596160
2025-01-05 19:10:35,036 [trainer.py] => Trainable params: 1998848
2025-01-05 19:10:35,038 [asp.py] => Learning on 0-60
2025-01-05 19:10:35,178 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 19:45:40,137 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:45:40,137 [trainer.py] => model_name: asp
2025-01-05 19:45:40,137 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:45:40,138 [trainer.py] => device: ['cuda']
2025-01-05 19:45:40,138 [trainer.py] => seed: 2024
2025-01-05 19:45:40,138 [trainer.py] => dataset: cifar224
2025-01-05 19:45:40,138 [trainer.py] => init_cls: 60
2025-01-05 19:45:40,138 [trainer.py] => increment: 5
2025-01-05 19:45:40,138 [trainer.py] => kshot: 5
2025-01-05 19:45:40,138 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:45:40,138 [trainer.py] => z_dim: 1000
2025-01-05 19:45:40,138 [trainer.py] => conv_dim: 64
2025-01-05 19:45:40,138 [trainer.py] => img_size: 224
2025-01-05 19:45:40,138 [trainer.py] => generator_lr: 0.005
2025-01-05 19:45:40,138 [trainer.py] => pi: 100
2025-01-05 19:45:40,138 [trainer.py] => w_bn: 50.0
2025-01-05 19:45:40,138 [trainer.py] => w_noise: 0.001
2025-01-05 19:45:40,138 [trainer.py] => server_ss: 32
2025-01-05 19:45:40,138 [trainer.py] => bn_loss: 1
2025-01-05 19:45:40,138 [trainer.py] => noise: 1
2025-01-05 19:45:40,138 [trainer.py] => ie_loss: 1
2025-01-05 19:45:40,138 [trainer.py] => act_loss: 0
2025-01-05 19:45:40,138 [trainer.py] => w_ie: 1.0
2025-01-05 19:45:40,138 [trainer.py] => w_act: 0.1
2025-01-05 19:45:40,138 [trainer.py] => syn_size: 32
2025-01-05 19:45:40,138 [trainer.py] => need_syn_imgs: True
2025-01-05 19:45:40,138 [trainer.py] => g_local_bs: 5
2025-01-05 19:45:40,138 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:45:40,138 [trainer.py] => g_local_train_steps: 10
2025-01-05 19:45:40,138 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:45:40,138 [trainer.py] => com_round_gen: 10
2025-01-05 19:45:40,138 [trainer.py] => g_sigma: 0
2025-01-05 19:45:40,138 [trainer.py] => save_cls_embeds: False
2025-01-05 19:45:40,138 [trainer.py] => syn_image_path: outputs/syn_image_60
2025-01-05 19:45:40,138 [trainer.py] => save_dir: outputs
2025-01-05 19:45:40,139 [trainer.py] => n_iter: 5
2025-01-05 19:45:40,139 [trainer.py] => num_users: 1
2025-01-05 19:45:40,139 [trainer.py] => cur_size: 50
2025-01-05 19:45:40,139 [trainer.py] => local_bs: 128
2025-01-05 19:45:40,139 [trainer.py] => vpt_type: Deep
2025-01-05 19:45:40,139 [trainer.py] => prompt_token_num: 6
2025-01-05 19:45:40,139 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:45:40,139 [trainer.py] => perturb_var: 1
2025-01-05 19:45:40,139 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:45:40,139 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:45:40,139 [trainer.py] => kl_weight: 0.001
2025-01-05 19:45:40,139 [trainer.py] => TIP_init: zero
2025-01-05 19:45:40,139 [trainer.py] => tuned_epoch: 10
2025-01-05 19:45:40,139 [trainer.py] => fs_epoch: 0
2025-01-05 19:45:40,139 [trainer.py] => init_lr: 0.01
2025-01-05 19:45:40,139 [trainer.py] => fs_lr: 0.001
2025-01-05 19:45:40,139 [trainer.py] => batch_size: 48
2025-01-05 19:45:40,139 [trainer.py] => fs_batch_size: 16
2025-01-05 19:45:40,139 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:45:40,139 [trainer.py] => min_lr: 0
2025-01-05 19:45:40,139 [trainer.py] => optimizer: sgd
2025-01-05 19:45:40,139 [trainer.py] => memory_size: 0
2025-01-05 19:45:40,139 [trainer.py] => memory_per_class: 0
2025-01-05 19:45:40,139 [trainer.py] => fixed_memory: False
2025-01-05 19:45:40,139 [trainer.py] => shuffle: False
2025-01-05 19:45:40,139 [trainer.py] => top_k: 5
2025-01-05 19:45:40,139 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:45:40,139 [trainer.py] => prefix: asp
2025-01-05 19:45:40,139 [trainer.py] => model_prefix: asp
2025-01-05 19:45:41,807 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:46:22,407 [trainer.py] => All params: 173596160
2025-01-05 19:46:22,409 [trainer.py] => Trainable params: 1998848
2025-01-05 19:46:22,410 [asp.py] => Learning on 0-60
2025-01-05 19:46:22,554 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 19:48:20,396 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:48:20,397 [trainer.py] => model_name: asp
2025-01-05 19:48:20,397 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:48:20,397 [trainer.py] => device: ['cuda']
2025-01-05 19:48:20,397 [trainer.py] => seed: 2024
2025-01-05 19:48:20,397 [trainer.py] => dataset: cifar224
2025-01-05 19:48:20,397 [trainer.py] => init_cls: 60
2025-01-05 19:48:20,397 [trainer.py] => increment: 5
2025-01-05 19:48:20,397 [trainer.py] => kshot: 5
2025-01-05 19:48:20,397 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:48:20,397 [trainer.py] => z_dim: 1000
2025-01-05 19:48:20,397 [trainer.py] => conv_dim: 64
2025-01-05 19:48:20,397 [trainer.py] => img_size: 224
2025-01-05 19:48:20,397 [trainer.py] => generator_lr: 0.005
2025-01-05 19:48:20,397 [trainer.py] => pi: 100
2025-01-05 19:48:20,397 [trainer.py] => w_bn: 50.0
2025-01-05 19:48:20,397 [trainer.py] => w_noise: 0.001
2025-01-05 19:48:20,397 [trainer.py] => server_ss: 32
2025-01-05 19:48:20,397 [trainer.py] => bn_loss: 1
2025-01-05 19:48:20,397 [trainer.py] => noise: 1
2025-01-05 19:48:20,397 [trainer.py] => ie_loss: 1
2025-01-05 19:48:20,397 [trainer.py] => act_loss: 0
2025-01-05 19:48:20,397 [trainer.py] => w_ie: 1.0
2025-01-05 19:48:20,397 [trainer.py] => w_act: 0.1
2025-01-05 19:48:20,397 [trainer.py] => syn_size: 32
2025-01-05 19:48:20,397 [trainer.py] => need_syn_imgs: True
2025-01-05 19:48:20,397 [trainer.py] => g_local_bs: 5
2025-01-05 19:48:20,397 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:48:20,397 [trainer.py] => g_local_train_steps: 10
2025-01-05 19:48:20,397 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:48:20,397 [trainer.py] => com_round_gen: 10
2025-01-05 19:48:20,398 [trainer.py] => g_sigma: 0
2025-01-05 19:48:20,398 [trainer.py] => save_cls_embeds: False
2025-01-05 19:48:20,398 [trainer.py] => syn_image_path: outputs/syn_image_60
2025-01-05 19:48:20,398 [trainer.py] => save_dir: outputs
2025-01-05 19:48:20,398 [trainer.py] => n_iter: 5
2025-01-05 19:48:20,398 [trainer.py] => num_users: 1
2025-01-05 19:48:20,398 [trainer.py] => cur_size: 50
2025-01-05 19:48:20,398 [trainer.py] => local_bs: 128
2025-01-05 19:48:20,398 [trainer.py] => vpt_type: Deep
2025-01-05 19:48:20,398 [trainer.py] => prompt_token_num: 6
2025-01-05 19:48:20,398 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:48:20,398 [trainer.py] => perturb_var: 1
2025-01-05 19:48:20,398 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:48:20,398 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:48:20,398 [trainer.py] => kl_weight: 0.001
2025-01-05 19:48:20,398 [trainer.py] => TIP_init: zero
2025-01-05 19:48:20,398 [trainer.py] => tuned_epoch: 10
2025-01-05 19:48:20,398 [trainer.py] => fs_epoch: 0
2025-01-05 19:48:20,398 [trainer.py] => init_lr: 0.01
2025-01-05 19:48:20,398 [trainer.py] => fs_lr: 0.001
2025-01-05 19:48:20,398 [trainer.py] => batch_size: 48
2025-01-05 19:48:20,398 [trainer.py] => fs_batch_size: 16
2025-01-05 19:48:20,398 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:48:20,398 [trainer.py] => min_lr: 0
2025-01-05 19:48:20,398 [trainer.py] => optimizer: sgd
2025-01-05 19:48:20,398 [trainer.py] => memory_size: 0
2025-01-05 19:48:20,398 [trainer.py] => memory_per_class: 0
2025-01-05 19:48:20,398 [trainer.py] => fixed_memory: False
2025-01-05 19:48:20,398 [trainer.py] => shuffle: False
2025-01-05 19:48:20,398 [trainer.py] => top_k: 5
2025-01-05 19:48:20,398 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:48:20,398 [trainer.py] => prefix: asp
2025-01-05 19:48:20,399 [trainer.py] => model_prefix: asp
2025-01-05 19:48:22,241 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:49:00,351 [trainer.py] => All params: 173596160
2025-01-05 19:49:00,353 [trainer.py] => Trainable params: 1998848
2025-01-05 19:49:00,356 [asp.py] => Learning on 0-60
2025-01-05 19:49:00,514 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 19:54:00,525 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:54:00,526 [trainer.py] => model_name: asp
2025-01-05 19:54:00,526 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:54:00,526 [trainer.py] => device: ['cuda']
2025-01-05 19:54:00,526 [trainer.py] => seed: 2024
2025-01-05 19:54:00,526 [trainer.py] => dataset: cifar224
2025-01-05 19:54:00,526 [trainer.py] => init_cls: 60
2025-01-05 19:54:00,526 [trainer.py] => increment: 5
2025-01-05 19:54:00,526 [trainer.py] => kshot: 5
2025-01-05 19:54:00,526 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:54:00,526 [trainer.py] => z_dim: 1000
2025-01-05 19:54:00,526 [trainer.py] => conv_dim: 64
2025-01-05 19:54:00,526 [trainer.py] => img_size: 224
2025-01-05 19:54:00,526 [trainer.py] => generator_lr: 0.005
2025-01-05 19:54:00,526 [trainer.py] => pi: 100
2025-01-05 19:54:00,526 [trainer.py] => w_bn: 50.0
2025-01-05 19:54:00,526 [trainer.py] => w_noise: 0.001
2025-01-05 19:54:00,526 [trainer.py] => server_ss: 32
2025-01-05 19:54:00,526 [trainer.py] => bn_loss: 1
2025-01-05 19:54:00,526 [trainer.py] => noise: 1
2025-01-05 19:54:00,526 [trainer.py] => ie_loss: 1
2025-01-05 19:54:00,526 [trainer.py] => act_loss: 0
2025-01-05 19:54:00,526 [trainer.py] => w_ie: 1.0
2025-01-05 19:54:00,526 [trainer.py] => w_act: 0.1
2025-01-05 19:54:00,526 [trainer.py] => syn_size: 32
2025-01-05 19:54:00,526 [trainer.py] => need_syn_imgs: True
2025-01-05 19:54:00,526 [trainer.py] => g_local_bs: 5
2025-01-05 19:54:00,527 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:54:00,527 [trainer.py] => g_local_train_steps: 10
2025-01-05 19:54:00,527 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:54:00,527 [trainer.py] => com_round_gen: 10
2025-01-05 19:54:00,527 [trainer.py] => g_sigma: 0
2025-01-05 19:54:00,527 [trainer.py] => save_cls_embeds: False
2025-01-05 19:54:00,527 [trainer.py] => syn_image_path: outputs/syn_image_60
2025-01-05 19:54:00,527 [trainer.py] => save_dir: outputs
2025-01-05 19:54:00,527 [trainer.py] => n_iter: 5
2025-01-05 19:54:00,527 [trainer.py] => num_users: 1
2025-01-05 19:54:00,527 [trainer.py] => cur_size: 50
2025-01-05 19:54:00,527 [trainer.py] => local_bs: 128
2025-01-05 19:54:00,527 [trainer.py] => vpt_type: Deep
2025-01-05 19:54:00,527 [trainer.py] => prompt_token_num: 6
2025-01-05 19:54:00,527 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:54:00,527 [trainer.py] => perturb_var: 1
2025-01-05 19:54:00,527 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:54:00,527 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:54:00,527 [trainer.py] => kl_weight: 0.001
2025-01-05 19:54:00,527 [trainer.py] => TIP_init: zero
2025-01-05 19:54:00,527 [trainer.py] => tuned_epoch: 10
2025-01-05 19:54:00,527 [trainer.py] => fs_epoch: 0
2025-01-05 19:54:00,527 [trainer.py] => init_lr: 0.01
2025-01-05 19:54:00,527 [trainer.py] => fs_lr: 0.001
2025-01-05 19:54:00,527 [trainer.py] => batch_size: 48
2025-01-05 19:54:00,527 [trainer.py] => fs_batch_size: 16
2025-01-05 19:54:00,527 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:54:00,527 [trainer.py] => min_lr: 0
2025-01-05 19:54:00,527 [trainer.py] => optimizer: sgd
2025-01-05 19:54:00,527 [trainer.py] => memory_size: 0
2025-01-05 19:54:00,528 [trainer.py] => memory_per_class: 0
2025-01-05 19:54:00,528 [trainer.py] => fixed_memory: False
2025-01-05 19:54:00,528 [trainer.py] => shuffle: False
2025-01-05 19:54:00,528 [trainer.py] => top_k: 5
2025-01-05 19:54:00,528 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:54:00,528 [trainer.py] => prefix: asp
2025-01-05 19:54:00,528 [trainer.py] => model_prefix: asp
2025-01-05 19:54:02,638 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:54:39,946 [trainer.py] => All params: 173596160
2025-01-05 19:54:39,947 [trainer.py] => Trainable params: 1998848
2025-01-05 19:54:39,952 [asp.py] => Learning on 0-60
2025-01-05 19:54:40,062 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 19:54:53,442 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:54:53,443 [trainer.py] => model_name: asp
2025-01-05 19:54:53,443 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:54:53,443 [trainer.py] => device: ['cuda']
2025-01-05 19:54:53,443 [trainer.py] => seed: 2024
2025-01-05 19:54:53,443 [trainer.py] => dataset: cifar224
2025-01-05 19:54:53,443 [trainer.py] => init_cls: 60
2025-01-05 19:54:53,443 [trainer.py] => increment: 5
2025-01-05 19:54:53,443 [trainer.py] => kshot: 5
2025-01-05 19:54:53,443 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:54:53,443 [trainer.py] => z_dim: 1000
2025-01-05 19:54:53,443 [trainer.py] => conv_dim: 64
2025-01-05 19:54:53,443 [trainer.py] => img_size: 224
2025-01-05 19:54:53,443 [trainer.py] => generator_lr: 0.005
2025-01-05 19:54:53,443 [trainer.py] => pi: 100
2025-01-05 19:54:53,443 [trainer.py] => w_bn: 50.0
2025-01-05 19:54:53,443 [trainer.py] => w_noise: 0.001
2025-01-05 19:54:53,443 [trainer.py] => server_ss: 32
2025-01-05 19:54:53,443 [trainer.py] => bn_loss: 1
2025-01-05 19:54:53,443 [trainer.py] => noise: 1
2025-01-05 19:54:53,443 [trainer.py] => ie_loss: 1
2025-01-05 19:54:53,443 [trainer.py] => act_loss: 0
2025-01-05 19:54:53,443 [trainer.py] => w_ie: 1.0
2025-01-05 19:54:53,443 [trainer.py] => w_act: 0.1
2025-01-05 19:54:53,443 [trainer.py] => syn_size: 32
2025-01-05 19:54:53,443 [trainer.py] => need_syn_imgs: True
2025-01-05 19:54:53,443 [trainer.py] => g_local_bs: 5
2025-01-05 19:54:53,443 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:54:53,443 [trainer.py] => g_local_train_steps: 10
2025-01-05 19:54:53,443 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:54:53,444 [trainer.py] => com_round_gen: 10
2025-01-05 19:54:53,444 [trainer.py] => g_sigma: 0
2025-01-05 19:54:53,444 [trainer.py] => save_cls_embeds: False
2025-01-05 19:54:53,444 [trainer.py] => syn_image_path: outputs/syn_image_60
2025-01-05 19:54:53,444 [trainer.py] => save_dir: outputs
2025-01-05 19:54:53,444 [trainer.py] => n_iter: 5
2025-01-05 19:54:53,444 [trainer.py] => num_users: 1
2025-01-05 19:54:53,444 [trainer.py] => cur_size: 50
2025-01-05 19:54:53,444 [trainer.py] => local_bs: 128
2025-01-05 19:54:53,444 [trainer.py] => vpt_type: Deep
2025-01-05 19:54:53,444 [trainer.py] => prompt_token_num: 6
2025-01-05 19:54:53,444 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:54:53,444 [trainer.py] => perturb_var: 1
2025-01-05 19:54:53,444 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:54:53,444 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:54:53,444 [trainer.py] => kl_weight: 0.001
2025-01-05 19:54:53,444 [trainer.py] => TIP_init: zero
2025-01-05 19:54:53,444 [trainer.py] => tuned_epoch: 10
2025-01-05 19:54:53,444 [trainer.py] => fs_epoch: 0
2025-01-05 19:54:53,444 [trainer.py] => init_lr: 0.01
2025-01-05 19:54:53,444 [trainer.py] => fs_lr: 0.001
2025-01-05 19:54:53,444 [trainer.py] => batch_size: 48
2025-01-05 19:54:53,444 [trainer.py] => fs_batch_size: 16
2025-01-05 19:54:53,444 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:54:53,444 [trainer.py] => min_lr: 0
2025-01-05 19:54:53,444 [trainer.py] => optimizer: sgd
2025-01-05 19:54:53,444 [trainer.py] => memory_size: 0
2025-01-05 19:54:53,444 [trainer.py] => memory_per_class: 0
2025-01-05 19:54:53,444 [trainer.py] => fixed_memory: False
2025-01-05 19:54:53,444 [trainer.py] => shuffle: False
2025-01-05 19:54:53,444 [trainer.py] => top_k: 5
2025-01-05 19:54:53,444 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:54:53,444 [trainer.py] => prefix: asp
2025-01-05 19:54:53,444 [trainer.py] => model_prefix: asp
2025-01-05 19:54:55,240 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:55:34,415 [trainer.py] => All params: 173596160
2025-01-05 19:55:34,416 [trainer.py] => Trainable params: 1998848
2025-01-05 19:55:34,418 [asp.py] => Learning on 0-60
2025-01-05 19:55:34,671 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 19:56:32,603 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:56:32,603 [trainer.py] => model_name: asp
2025-01-05 19:56:32,603 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:56:32,603 [trainer.py] => device: ['cuda']
2025-01-05 19:56:32,603 [trainer.py] => seed: 2024
2025-01-05 19:56:32,603 [trainer.py] => dataset: cifar224
2025-01-05 19:56:32,603 [trainer.py] => init_cls: 60
2025-01-05 19:56:32,603 [trainer.py] => increment: 5
2025-01-05 19:56:32,603 [trainer.py] => kshot: 5
2025-01-05 19:56:32,603 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:56:32,603 [trainer.py] => z_dim: 1000
2025-01-05 19:56:32,603 [trainer.py] => conv_dim: 64
2025-01-05 19:56:32,603 [trainer.py] => img_size: 224
2025-01-05 19:56:32,603 [trainer.py] => generator_lr: 0.005
2025-01-05 19:56:32,603 [trainer.py] => pi: 100
2025-01-05 19:56:32,603 [trainer.py] => w_bn: 50.0
2025-01-05 19:56:32,603 [trainer.py] => w_noise: 0.001
2025-01-05 19:56:32,603 [trainer.py] => server_ss: 32
2025-01-05 19:56:32,604 [trainer.py] => bn_loss: 1
2025-01-05 19:56:32,604 [trainer.py] => noise: 1
2025-01-05 19:56:32,604 [trainer.py] => ie_loss: 1
2025-01-05 19:56:32,604 [trainer.py] => act_loss: 0
2025-01-05 19:56:32,604 [trainer.py] => w_ie: 1.0
2025-01-05 19:56:32,604 [trainer.py] => w_act: 0.1
2025-01-05 19:56:32,604 [trainer.py] => syn_size: 32
2025-01-05 19:56:32,604 [trainer.py] => need_syn_imgs: True
2025-01-05 19:56:32,604 [trainer.py] => g_local_bs: 5
2025-01-05 19:56:32,604 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:56:32,604 [trainer.py] => g_local_train_steps: 10
2025-01-05 19:56:32,604 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:56:32,604 [trainer.py] => com_round_gen: 10
2025-01-05 19:56:32,604 [trainer.py] => g_sigma: 0
2025-01-05 19:56:32,604 [trainer.py] => save_cls_embeds: False
2025-01-05 19:56:32,604 [trainer.py] => syn_image_path: outputs/syn_image_60
2025-01-05 19:56:32,604 [trainer.py] => save_dir: outputs
2025-01-05 19:56:32,604 [trainer.py] => n_iter: 5
2025-01-05 19:56:32,604 [trainer.py] => num_users: 1
2025-01-05 19:56:32,604 [trainer.py] => cur_size: 50
2025-01-05 19:56:32,604 [trainer.py] => local_bs: 128
2025-01-05 19:56:32,604 [trainer.py] => vpt_type: Deep
2025-01-05 19:56:32,604 [trainer.py] => prompt_token_num: 6
2025-01-05 19:56:32,604 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:56:32,604 [trainer.py] => perturb_var: 1
2025-01-05 19:56:32,604 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:56:32,604 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:56:32,604 [trainer.py] => kl_weight: 0.001
2025-01-05 19:56:32,604 [trainer.py] => TIP_init: zero
2025-01-05 19:56:32,604 [trainer.py] => tuned_epoch: 10
2025-01-05 19:56:32,604 [trainer.py] => fs_epoch: 0
2025-01-05 19:56:32,604 [trainer.py] => init_lr: 0.01
2025-01-05 19:56:32,604 [trainer.py] => fs_lr: 0.001
2025-01-05 19:56:32,604 [trainer.py] => batch_size: 48
2025-01-05 19:56:32,604 [trainer.py] => fs_batch_size: 16
2025-01-05 19:56:32,605 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:56:32,605 [trainer.py] => min_lr: 0
2025-01-05 19:56:32,605 [trainer.py] => optimizer: sgd
2025-01-05 19:56:32,605 [trainer.py] => memory_size: 0
2025-01-05 19:56:32,605 [trainer.py] => memory_per_class: 0
2025-01-05 19:56:32,605 [trainer.py] => fixed_memory: False
2025-01-05 19:56:32,605 [trainer.py] => shuffle: False
2025-01-05 19:56:32,605 [trainer.py] => top_k: 5
2025-01-05 19:56:32,605 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:56:32,605 [trainer.py] => prefix: asp
2025-01-05 19:56:32,605 [trainer.py] => model_prefix: asp
2025-01-05 19:56:34,337 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:56:46,613 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:56:46,613 [trainer.py] => model_name: asp
2025-01-05 19:56:46,613 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:56:46,613 [trainer.py] => device: ['cuda']
2025-01-05 19:56:46,613 [trainer.py] => seed: 2024
2025-01-05 19:56:46,613 [trainer.py] => dataset: cifar224
2025-01-05 19:56:46,613 [trainer.py] => init_cls: 60
2025-01-05 19:56:46,613 [trainer.py] => increment: 5
2025-01-05 19:56:46,613 [trainer.py] => kshot: 5
2025-01-05 19:56:46,613 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:56:46,613 [trainer.py] => z_dim: 1000
2025-01-05 19:56:46,614 [trainer.py] => conv_dim: 64
2025-01-05 19:56:46,614 [trainer.py] => img_size: 224
2025-01-05 19:56:46,614 [trainer.py] => generator_lr: 0.005
2025-01-05 19:56:46,614 [trainer.py] => pi: 100
2025-01-05 19:56:46,614 [trainer.py] => w_bn: 50.0
2025-01-05 19:56:46,614 [trainer.py] => w_noise: 0.001
2025-01-05 19:56:46,614 [trainer.py] => server_ss: 32
2025-01-05 19:56:46,614 [trainer.py] => bn_loss: 1
2025-01-05 19:56:46,614 [trainer.py] => noise: 1
2025-01-05 19:56:46,614 [trainer.py] => ie_loss: 1
2025-01-05 19:56:46,614 [trainer.py] => act_loss: 0
2025-01-05 19:56:46,614 [trainer.py] => w_ie: 1.0
2025-01-05 19:56:46,614 [trainer.py] => w_act: 0.1
2025-01-05 19:56:46,614 [trainer.py] => syn_size: 32
2025-01-05 19:56:46,614 [trainer.py] => need_syn_imgs: True
2025-01-05 19:56:46,614 [trainer.py] => g_local_bs: 5
2025-01-05 19:56:46,614 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:56:46,614 [trainer.py] => g_local_train_steps: 10
2025-01-05 19:56:46,614 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:56:46,614 [trainer.py] => com_round_gen: 10
2025-01-05 19:56:46,614 [trainer.py] => g_sigma: 0
2025-01-05 19:56:46,614 [trainer.py] => save_cls_embeds: False
2025-01-05 19:56:46,614 [trainer.py] => syn_image_path: outputs/syn_image_60
2025-01-05 19:56:46,614 [trainer.py] => save_dir: outputs
2025-01-05 19:56:46,614 [trainer.py] => n_iter: 5
2025-01-05 19:56:46,615 [trainer.py] => num_users: 1
2025-01-05 19:56:46,615 [trainer.py] => cur_size: 50
2025-01-05 19:56:46,615 [trainer.py] => local_bs: 128
2025-01-05 19:56:46,615 [trainer.py] => vpt_type: Deep
2025-01-05 19:56:46,615 [trainer.py] => prompt_token_num: 6
2025-01-05 19:56:46,615 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:56:46,615 [trainer.py] => perturb_var: 1
2025-01-05 19:56:46,615 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:56:46,615 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:56:46,615 [trainer.py] => kl_weight: 0.001
2025-01-05 19:56:46,615 [trainer.py] => TIP_init: zero
2025-01-05 19:56:46,615 [trainer.py] => tuned_epoch: 10
2025-01-05 19:56:46,615 [trainer.py] => fs_epoch: 0
2025-01-05 19:56:46,615 [trainer.py] => init_lr: 0.01
2025-01-05 19:56:46,615 [trainer.py] => fs_lr: 0.001
2025-01-05 19:56:46,615 [trainer.py] => batch_size: 48
2025-01-05 19:56:46,615 [trainer.py] => fs_batch_size: 16
2025-01-05 19:56:46,615 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:56:46,615 [trainer.py] => min_lr: 0
2025-01-05 19:56:46,615 [trainer.py] => optimizer: sgd
2025-01-05 19:56:46,615 [trainer.py] => memory_size: 0
2025-01-05 19:56:46,615 [trainer.py] => memory_per_class: 0
2025-01-05 19:56:46,615 [trainer.py] => fixed_memory: False
2025-01-05 19:56:46,615 [trainer.py] => shuffle: False
2025-01-05 19:56:46,615 [trainer.py] => top_k: 5
2025-01-05 19:56:46,616 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:56:46,616 [trainer.py] => prefix: asp
2025-01-05 19:56:46,616 [trainer.py] => model_prefix: asp
2025-01-05 19:56:48,332 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:57:24,942 [trainer.py] => All params: 173596160
2025-01-05 19:57:24,943 [trainer.py] => Trainable params: 1998848
2025-01-05 19:57:24,944 [asp.py] => Learning on 0-60
2025-01-05 19:57:25,140 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 19:58:07,021 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 19:58:07,021 [trainer.py] => model_name: asp
2025-01-05 19:58:07,021 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 19:58:07,021 [trainer.py] => device: ['cuda']
2025-01-05 19:58:07,021 [trainer.py] => seed: 2024
2025-01-05 19:58:07,021 [trainer.py] => dataset: cifar224
2025-01-05 19:58:07,021 [trainer.py] => init_cls: 60
2025-01-05 19:58:07,021 [trainer.py] => increment: 5
2025-01-05 19:58:07,021 [trainer.py] => kshot: 5
2025-01-05 19:58:07,021 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 19:58:07,021 [trainer.py] => z_dim: 1000
2025-01-05 19:58:07,021 [trainer.py] => conv_dim: 64
2025-01-05 19:58:07,021 [trainer.py] => img_size: 224
2025-01-05 19:58:07,022 [trainer.py] => generator_lr: 0.005
2025-01-05 19:58:07,022 [trainer.py] => pi: 100
2025-01-05 19:58:07,022 [trainer.py] => w_bn: 50.0
2025-01-05 19:58:07,022 [trainer.py] => w_noise: 0.001
2025-01-05 19:58:07,022 [trainer.py] => server_ss: 32
2025-01-05 19:58:07,022 [trainer.py] => bn_loss: 1
2025-01-05 19:58:07,022 [trainer.py] => noise: 1
2025-01-05 19:58:07,022 [trainer.py] => ie_loss: 1
2025-01-05 19:58:07,022 [trainer.py] => act_loss: 0
2025-01-05 19:58:07,022 [trainer.py] => w_ie: 1.0
2025-01-05 19:58:07,022 [trainer.py] => w_act: 0.1
2025-01-05 19:58:07,022 [trainer.py] => syn_size: 32
2025-01-05 19:58:07,022 [trainer.py] => need_syn_imgs: True
2025-01-05 19:58:07,022 [trainer.py] => g_local_bs: 5
2025-01-05 19:58:07,022 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 19:58:07,022 [trainer.py] => g_local_train_steps: 10
2025-01-05 19:58:07,022 [trainer.py] => dataset_syn: cifar100
2025-01-05 19:58:07,022 [trainer.py] => com_round_gen: 10
2025-01-05 19:58:07,022 [trainer.py] => g_sigma: 0
2025-01-05 19:58:07,022 [trainer.py] => save_cls_embeds: False
2025-01-05 19:58:07,022 [trainer.py] => syn_image_path: outputs/syn_image_60
2025-01-05 19:58:07,022 [trainer.py] => save_dir: outputs
2025-01-05 19:58:07,022 [trainer.py] => n_iter: 5
2025-01-05 19:58:07,022 [trainer.py] => num_users: 1
2025-01-05 19:58:07,022 [trainer.py] => cur_size: 50
2025-01-05 19:58:07,022 [trainer.py] => local_bs: 128
2025-01-05 19:58:07,022 [trainer.py] => vpt_type: Deep
2025-01-05 19:58:07,022 [trainer.py] => prompt_token_num: 6
2025-01-05 19:58:07,022 [trainer.py] => avg_alpha: 0.8
2025-01-05 19:58:07,022 [trainer.py] => perturb_var: 1
2025-01-05 19:58:07,022 [trainer.py] => EMA_beta: 0.99
2025-01-05 19:58:07,022 [trainer.py] => anchor_lambda: 0.1
2025-01-05 19:58:07,022 [trainer.py] => kl_weight: 0.001
2025-01-05 19:58:07,023 [trainer.py] => TIP_init: zero
2025-01-05 19:58:07,023 [trainer.py] => tuned_epoch: 10
2025-01-05 19:58:07,023 [trainer.py] => fs_epoch: 0
2025-01-05 19:58:07,023 [trainer.py] => init_lr: 0.01
2025-01-05 19:58:07,023 [trainer.py] => fs_lr: 0.001
2025-01-05 19:58:07,023 [trainer.py] => batch_size: 48
2025-01-05 19:58:07,023 [trainer.py] => fs_batch_size: 16
2025-01-05 19:58:07,023 [trainer.py] => weight_decay: 0.0005
2025-01-05 19:58:07,023 [trainer.py] => min_lr: 0
2025-01-05 19:58:07,023 [trainer.py] => optimizer: sgd
2025-01-05 19:58:07,023 [trainer.py] => memory_size: 0
2025-01-05 19:58:07,023 [trainer.py] => memory_per_class: 0
2025-01-05 19:58:07,023 [trainer.py] => fixed_memory: False
2025-01-05 19:58:07,023 [trainer.py] => shuffle: False
2025-01-05 19:58:07,023 [trainer.py] => top_k: 5
2025-01-05 19:58:07,023 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 19:58:07,023 [trainer.py] => prefix: asp
2025-01-05 19:58:07,023 [trainer.py] => model_prefix: asp
2025-01-05 19:58:08,886 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 19:58:46,482 [trainer.py] => All params: 173596160
2025-01-05 19:58:46,484 [trainer.py] => Trainable params: 1998848
2025-01-05 19:58:46,485 [asp.py] => Learning on 0-60
2025-01-05 19:58:46,603 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 20:45:51,735 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-05 20:45:51,735 [trainer.py] => model_name: asp
2025-01-05 20:45:51,735 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-05 20:45:51,735 [trainer.py] => device: ['cuda']
2025-01-05 20:45:51,735 [trainer.py] => seed: 2024
2025-01-05 20:45:51,735 [trainer.py] => dataset: cifar224
2025-01-05 20:45:51,735 [trainer.py] => init_cls: 60
2025-01-05 20:45:51,735 [trainer.py] => increment: 5
2025-01-05 20:45:51,735 [trainer.py] => kshot: 5
2025-01-05 20:45:51,735 [trainer.py] => generator_model: CIFAR_GEN
2025-01-05 20:45:51,735 [trainer.py] => z_dim: 1000
2025-01-05 20:45:51,735 [trainer.py] => conv_dim: 64
2025-01-05 20:45:51,735 [trainer.py] => img_size: 224
2025-01-05 20:45:51,736 [trainer.py] => generator_lr: 0.005
2025-01-05 20:45:51,736 [trainer.py] => pi: 100
2025-01-05 20:45:51,736 [trainer.py] => w_bn: 50.0
2025-01-05 20:45:51,736 [trainer.py] => w_noise: 0.001
2025-01-05 20:45:51,736 [trainer.py] => server_ss: 32
2025-01-05 20:45:51,736 [trainer.py] => bn_loss: 1
2025-01-05 20:45:51,736 [trainer.py] => noise: 1
2025-01-05 20:45:51,736 [trainer.py] => ie_loss: 1
2025-01-05 20:45:51,736 [trainer.py] => act_loss: 0
2025-01-05 20:45:51,736 [trainer.py] => w_ie: 1.0
2025-01-05 20:45:51,736 [trainer.py] => w_act: 0.1
2025-01-05 20:45:51,736 [trainer.py] => syn_size: 32
2025-01-05 20:45:51,736 [trainer.py] => need_syn_imgs: True
2025-01-05 20:45:51,736 [trainer.py] => g_local_bs: 5
2025-01-05 20:45:51,736 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-05 20:45:51,736 [trainer.py] => g_local_train_steps: 10
2025-01-05 20:45:51,736 [trainer.py] => dataset_syn: cifar100
2025-01-05 20:45:51,736 [trainer.py] => com_round_gen: 10
2025-01-05 20:45:51,736 [trainer.py] => g_sigma: 0
2025-01-05 20:45:51,736 [trainer.py] => save_cls_embeds: False
2025-01-05 20:45:51,736 [trainer.py] => syn_image_path: outputs/syn_image_60
2025-01-05 20:45:51,736 [trainer.py] => save_dir: outputs
2025-01-05 20:45:51,736 [trainer.py] => n_iter: 5
2025-01-05 20:45:51,736 [trainer.py] => num_users: 1
2025-01-05 20:45:51,736 [trainer.py] => cur_size: 50
2025-01-05 20:45:51,736 [trainer.py] => local_bs: 128
2025-01-05 20:45:51,736 [trainer.py] => vpt_type: Deep
2025-01-05 20:45:51,736 [trainer.py] => prompt_token_num: 6
2025-01-05 20:45:51,736 [trainer.py] => avg_alpha: 0.8
2025-01-05 20:45:51,736 [trainer.py] => perturb_var: 1
2025-01-05 20:45:51,736 [trainer.py] => EMA_beta: 0.99
2025-01-05 20:45:51,736 [trainer.py] => anchor_lambda: 0.1
2025-01-05 20:45:51,736 [trainer.py] => kl_weight: 0.001
2025-01-05 20:45:51,737 [trainer.py] => TIP_init: zero
2025-01-05 20:45:51,737 [trainer.py] => tuned_epoch: 10
2025-01-05 20:45:51,737 [trainer.py] => fs_epoch: 0
2025-01-05 20:45:51,737 [trainer.py] => init_lr: 0.01
2025-01-05 20:45:51,737 [trainer.py] => fs_lr: 0.001
2025-01-05 20:45:51,737 [trainer.py] => batch_size: 48
2025-01-05 20:45:51,737 [trainer.py] => fs_batch_size: 16
2025-01-05 20:45:51,737 [trainer.py] => weight_decay: 0.0005
2025-01-05 20:45:51,737 [trainer.py] => min_lr: 0
2025-01-05 20:45:51,737 [trainer.py] => optimizer: sgd
2025-01-05 20:45:51,737 [trainer.py] => memory_size: 0
2025-01-05 20:45:51,737 [trainer.py] => memory_per_class: 0
2025-01-05 20:45:51,737 [trainer.py] => fixed_memory: False
2025-01-05 20:45:51,737 [trainer.py] => shuffle: False
2025-01-05 20:45:51,737 [trainer.py] => top_k: 5
2025-01-05 20:45:51,737 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-05 20:45:51,737 [trainer.py] => prefix: asp
2025-01-05 20:45:51,737 [trainer.py] => model_prefix: asp
2025-01-05 20:45:53,540 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-05 20:46:43,085 [trainer.py] => All params: 173596160
2025-01-05 20:46:43,086 [trainer.py] => Trainable params: 1998848
2025-01-05 20:46:43,087 [asp.py] => Learning on 0-60
2025-01-05 20:46:43,276 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-05 23:07:54,342 [asp.py] => total parameters: 173642241
2025-01-05 23:07:54,343 [asp.py] => trainable parameters: 2044929
2025-01-05 23:19:46,340 [asp.py] => Task 0, Epoch 1 => Loss 3.829, Train_accy 24.06, Test_curr_accy 85.87, Test_accy 85.87
2025-01-05 23:31:38,919 [asp.py] => Task 0, Epoch 2 => Loss 1.096, Train_accy 77.10, Test_curr_accy 91.05, Test_accy 91.05
2025-01-05 23:43:28,244 [asp.py] => Task 0, Epoch 3 => Loss 0.896, Train_accy 79.45, Test_curr_accy 91.15, Test_accy 91.15
2025-01-05 23:55:20,426 [asp.py] => Task 0, Epoch 4 => Loss 0.819, Train_accy 80.74, Test_curr_accy 92.33, Test_accy 92.33
2025-01-06 00:07:14,161 [asp.py] => Task 0, Epoch 5 => Loss 0.800, Train_accy 80.99, Test_curr_accy 92.33, Test_accy 92.33
2025-01-06 00:19:08,310 [asp.py] => Task 0, Epoch 6 => Loss 0.765, Train_accy 81.47, Test_curr_accy 92.53, Test_accy 92.53
2025-01-06 00:31:03,690 [asp.py] => Task 0, Epoch 7 => Loss 0.743, Train_accy 81.96, Test_curr_accy 92.52, Test_accy 92.52
2025-01-06 00:42:56,091 [asp.py] => Task 0, Epoch 8 => Loss 0.711, Train_accy 82.69, Test_curr_accy 92.52, Test_accy 92.52
2025-01-06 00:54:47,577 [asp.py] => Task 0, Epoch 9 => Loss 0.714, Train_accy 82.46, Test_curr_accy 92.62, Test_accy 92.62
2025-01-06 01:06:39,472 [asp.py] => Task 0, Epoch 10 => Loss 0.718, Train_accy 82.93, Test_curr_accy 92.58, Test_accy 92.58
2025-01-10 19:51:30,156 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 19:51:30,156 [trainer.py] => model_name: asp
2025-01-10 19:51:30,157 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 19:51:30,157 [trainer.py] => device: ['cuda']
2025-01-10 19:51:30,157 [trainer.py] => seed: 2024
2025-01-10 19:51:30,157 [trainer.py] => dataset: cifar224
2025-01-10 19:51:30,157 [trainer.py] => init_cls: 60
2025-01-10 19:51:30,157 [trainer.py] => increment: 5
2025-01-10 19:51:30,157 [trainer.py] => kshot: 5
2025-01-10 19:51:30,157 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 19:51:30,157 [trainer.py] => z_dim: 1000
2025-01-10 19:51:30,157 [trainer.py] => conv_dim: 64
2025-01-10 19:51:30,157 [trainer.py] => img_size: 224
2025-01-10 19:51:30,157 [trainer.py] => generator_lr: 0.005
2025-01-10 19:51:30,157 [trainer.py] => pi: 100
2025-01-10 19:51:30,157 [trainer.py] => w_bn: 50.0
2025-01-10 19:51:30,157 [trainer.py] => w_noise: 0.001
2025-01-10 19:51:30,157 [trainer.py] => server_ss: 32
2025-01-10 19:51:30,157 [trainer.py] => bn_loss: 1
2025-01-10 19:51:30,157 [trainer.py] => noise: 1
2025-01-10 19:51:30,157 [trainer.py] => ie_loss: 1
2025-01-10 19:51:30,157 [trainer.py] => act_loss: 0
2025-01-10 19:51:30,157 [trainer.py] => w_ie: 1.0
2025-01-10 19:51:30,157 [trainer.py] => w_act: 0.1
2025-01-10 19:51:30,157 [trainer.py] => syn_size: 32
2025-01-10 19:51:30,157 [trainer.py] => need_syn_imgs: True
2025-01-10 19:51:30,157 [trainer.py] => g_local_bs: 5
2025-01-10 19:51:30,157 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 19:51:30,157 [trainer.py] => g_local_train_steps: 5
2025-01-10 19:51:30,157 [trainer.py] => dataset_syn: cifar100
2025-01-10 19:51:30,157 [trainer.py] => com_round_gen: 10
2025-01-10 19:51:30,157 [trainer.py] => g_sigma: 0
2025-01-10 19:51:30,157 [trainer.py] => save_cls_embeds: False
2025-01-10 19:51:30,158 [trainer.py] => syn_image_path: outputs/syn_image_60_5
2025-01-10 19:51:30,158 [trainer.py] => save_dir: outputs
2025-01-10 19:51:30,158 [trainer.py] => n_iter: 5
2025-01-10 19:51:30,158 [trainer.py] => num_users: 1
2025-01-10 19:51:30,158 [trainer.py] => cur_size: 50
2025-01-10 19:51:30,158 [trainer.py] => local_bs: 5
2025-01-10 19:51:30,158 [trainer.py] => pre_size: 48
2025-01-10 19:51:30,158 [trainer.py] => w_ce_pre: 0
2025-01-10 19:51:30,158 [trainer.py] => vpt_type: Deep
2025-01-10 19:51:30,158 [trainer.py] => prompt_token_num: 6
2025-01-10 19:51:30,158 [trainer.py] => avg_alpha: 0.8
2025-01-10 19:51:30,158 [trainer.py] => perturb_var: 1
2025-01-10 19:51:30,158 [trainer.py] => EMA_beta: 0.99
2025-01-10 19:51:30,158 [trainer.py] => anchor_lambda: 0.1
2025-01-10 19:51:30,158 [trainer.py] => kl_weight: 0.001
2025-01-10 19:51:30,158 [trainer.py] => TIP_init: zero
2025-01-10 19:51:30,158 [trainer.py] => tuned_epoch: 10
2025-01-10 19:51:30,158 [trainer.py] => fs_epoch: 0
2025-01-10 19:51:30,158 [trainer.py] => init_lr: 0.01
2025-01-10 19:51:30,158 [trainer.py] => fs_lr: 0.001
2025-01-10 19:51:30,158 [trainer.py] => batch_size: 48
2025-01-10 19:51:30,158 [trainer.py] => fs_batch_size: 16
2025-01-10 19:51:30,158 [trainer.py] => weight_decay: 0.0005
2025-01-10 19:51:30,158 [trainer.py] => min_lr: 0
2025-01-10 19:51:30,158 [trainer.py] => optimizer: sgd
2025-01-10 19:51:30,158 [trainer.py] => memory_size: 0
2025-01-10 19:51:30,158 [trainer.py] => memory_per_class: 0
2025-01-10 19:51:30,158 [trainer.py] => fixed_memory: False
2025-01-10 19:51:30,158 [trainer.py] => shuffle: False
2025-01-10 19:51:30,158 [trainer.py] => top_k: 5
2025-01-10 19:51:30,158 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 19:51:30,158 [trainer.py] => prefix: asp
2025-01-10 19:51:30,158 [trainer.py] => model_prefix: asp
2025-01-10 19:51:31,688 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 19:52:58,719 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 19:52:58,719 [trainer.py] => model_name: asp
2025-01-10 19:52:58,720 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 19:52:58,720 [trainer.py] => device: ['cuda']
2025-01-10 19:52:58,720 [trainer.py] => seed: 2024
2025-01-10 19:52:58,720 [trainer.py] => dataset: cifar224
2025-01-10 19:52:58,720 [trainer.py] => init_cls: 60
2025-01-10 19:52:58,720 [trainer.py] => increment: 5
2025-01-10 19:52:58,720 [trainer.py] => kshot: 5
2025-01-10 19:52:58,720 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 19:52:58,720 [trainer.py] => z_dim: 1000
2025-01-10 19:52:58,720 [trainer.py] => conv_dim: 64
2025-01-10 19:52:58,720 [trainer.py] => img_size: 224
2025-01-10 19:52:58,720 [trainer.py] => generator_lr: 0.005
2025-01-10 19:52:58,720 [trainer.py] => pi: 100
2025-01-10 19:52:58,720 [trainer.py] => w_bn: 50.0
2025-01-10 19:52:58,720 [trainer.py] => w_noise: 0.001
2025-01-10 19:52:58,720 [trainer.py] => server_ss: 32
2025-01-10 19:52:58,720 [trainer.py] => bn_loss: 1
2025-01-10 19:52:58,720 [trainer.py] => noise: 1
2025-01-10 19:52:58,720 [trainer.py] => ie_loss: 1
2025-01-10 19:52:58,720 [trainer.py] => act_loss: 0
2025-01-10 19:52:58,720 [trainer.py] => w_ie: 1.0
2025-01-10 19:52:58,720 [trainer.py] => w_act: 0.1
2025-01-10 19:52:58,720 [trainer.py] => syn_size: 32
2025-01-10 19:52:58,720 [trainer.py] => need_syn_imgs: True
2025-01-10 19:52:58,720 [trainer.py] => g_local_bs: 5
2025-01-10 19:52:58,720 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 19:52:58,720 [trainer.py] => g_local_train_steps: 5
2025-01-10 19:52:58,721 [trainer.py] => dataset_syn: cifar100
2025-01-10 19:52:58,721 [trainer.py] => com_round_gen: 10
2025-01-10 19:52:58,721 [trainer.py] => g_sigma: 0
2025-01-10 19:52:58,721 [trainer.py] => save_cls_embeds: False
2025-01-10 19:52:58,721 [trainer.py] => syn_image_path: outputs/syn_image_60_5
2025-01-10 19:52:58,721 [trainer.py] => save_dir: outputs
2025-01-10 19:52:58,721 [trainer.py] => n_iter: 5
2025-01-10 19:52:58,721 [trainer.py] => num_users: 1
2025-01-10 19:52:58,721 [trainer.py] => cur_size: 50
2025-01-10 19:52:58,721 [trainer.py] => local_bs: 5
2025-01-10 19:52:58,721 [trainer.py] => pre_size: 48
2025-01-10 19:52:58,721 [trainer.py] => w_ce_pre: 0.0
2025-01-10 19:52:58,721 [trainer.py] => vpt_type: Deep
2025-01-10 19:52:58,721 [trainer.py] => prompt_token_num: 6
2025-01-10 19:52:58,721 [trainer.py] => avg_alpha: 0.8
2025-01-10 19:52:58,721 [trainer.py] => perturb_var: 1
2025-01-10 19:52:58,721 [trainer.py] => EMA_beta: 0.99
2025-01-10 19:52:58,721 [trainer.py] => anchor_lambda: 0.1
2025-01-10 19:52:58,721 [trainer.py] => kl_weight: 0.001
2025-01-10 19:52:58,721 [trainer.py] => TIP_init: zero
2025-01-10 19:52:58,721 [trainer.py] => tuned_epoch: 10
2025-01-10 19:52:58,721 [trainer.py] => fs_epoch: 0
2025-01-10 19:52:58,721 [trainer.py] => init_lr: 0.01
2025-01-10 19:52:58,721 [trainer.py] => fs_lr: 0.001
2025-01-10 19:52:58,721 [trainer.py] => batch_size: 48
2025-01-10 19:52:58,721 [trainer.py] => fs_batch_size: 16
2025-01-10 19:52:58,721 [trainer.py] => weight_decay: 0.0005
2025-01-10 19:52:58,722 [trainer.py] => min_lr: 0
2025-01-10 19:52:58,722 [trainer.py] => optimizer: sgd
2025-01-10 19:52:58,722 [trainer.py] => memory_size: 0
2025-01-10 19:52:58,722 [trainer.py] => memory_per_class: 0
2025-01-10 19:52:58,722 [trainer.py] => fixed_memory: False
2025-01-10 19:52:58,722 [trainer.py] => shuffle: False
2025-01-10 19:52:58,722 [trainer.py] => top_k: 5
2025-01-10 19:52:58,722 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 19:52:58,722 [trainer.py] => prefix: asp
2025-01-10 19:52:58,722 [trainer.py] => model_prefix: asp
2025-01-10 19:53:00,330 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 19:53:57,109 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 19:53:57,109 [trainer.py] => model_name: asp
2025-01-10 19:53:57,109 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 19:53:57,109 [trainer.py] => device: ['cuda']
2025-01-10 19:53:57,109 [trainer.py] => seed: 2024
2025-01-10 19:53:57,109 [trainer.py] => dataset: cifar224
2025-01-10 19:53:57,109 [trainer.py] => init_cls: 60
2025-01-10 19:53:57,109 [trainer.py] => increment: 5
2025-01-10 19:53:57,109 [trainer.py] => kshot: 5
2025-01-10 19:53:57,109 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 19:53:57,109 [trainer.py] => z_dim: 1000
2025-01-10 19:53:57,109 [trainer.py] => conv_dim: 64
2025-01-10 19:53:57,109 [trainer.py] => img_size: 224
2025-01-10 19:53:57,109 [trainer.py] => generator_lr: 0.005
2025-01-10 19:53:57,109 [trainer.py] => pi: 100
2025-01-10 19:53:57,109 [trainer.py] => w_bn: 50.0
2025-01-10 19:53:57,109 [trainer.py] => w_noise: 0.001
2025-01-10 19:53:57,109 [trainer.py] => server_ss: 32
2025-01-10 19:53:57,109 [trainer.py] => bn_loss: 1
2025-01-10 19:53:57,109 [trainer.py] => noise: 1
2025-01-10 19:53:57,109 [trainer.py] => ie_loss: 1
2025-01-10 19:53:57,109 [trainer.py] => act_loss: 0
2025-01-10 19:53:57,109 [trainer.py] => w_ie: 1.0
2025-01-10 19:53:57,109 [trainer.py] => w_act: 0.1
2025-01-10 19:53:57,110 [trainer.py] => syn_size: 32
2025-01-10 19:53:57,110 [trainer.py] => need_syn_imgs: True
2025-01-10 19:53:57,110 [trainer.py] => g_local_bs: 5
2025-01-10 19:53:57,110 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 19:53:57,110 [trainer.py] => g_local_train_steps: 5
2025-01-10 19:53:57,110 [trainer.py] => dataset_syn: cifar100
2025-01-10 19:53:57,110 [trainer.py] => com_round_gen: 10
2025-01-10 19:53:57,110 [trainer.py] => g_sigma: 0
2025-01-10 19:53:57,110 [trainer.py] => save_cls_embeds: False
2025-01-10 19:53:57,110 [trainer.py] => syn_image_path: outputs/syn_image_60_5
2025-01-10 19:53:57,110 [trainer.py] => save_dir: outputs
2025-01-10 19:53:57,110 [trainer.py] => n_iter: 5
2025-01-10 19:53:57,110 [trainer.py] => num_users: 1
2025-01-10 19:53:57,110 [trainer.py] => cur_size: 50
2025-01-10 19:53:57,110 [trainer.py] => local_bs: 5
2025-01-10 19:53:57,110 [trainer.py] => pre_size: 48
2025-01-10 19:53:57,110 [trainer.py] => w_ce_pre: 0.3
2025-01-10 19:53:57,110 [trainer.py] => vpt_type: Deep
2025-01-10 19:53:57,110 [trainer.py] => prompt_token_num: 6
2025-01-10 19:53:57,110 [trainer.py] => avg_alpha: 0.8
2025-01-10 19:53:57,110 [trainer.py] => perturb_var: 1
2025-01-10 19:53:57,110 [trainer.py] => EMA_beta: 0.99
2025-01-10 19:53:57,110 [trainer.py] => anchor_lambda: 0.1
2025-01-10 19:53:57,110 [trainer.py] => kl_weight: 0.001
2025-01-10 19:53:57,110 [trainer.py] => TIP_init: zero
2025-01-10 19:53:57,110 [trainer.py] => tuned_epoch: 10
2025-01-10 19:53:57,110 [trainer.py] => fs_epoch: 0
2025-01-10 19:53:57,110 [trainer.py] => init_lr: 0.01
2025-01-10 19:53:57,110 [trainer.py] => fs_lr: 0.001
2025-01-10 19:53:57,110 [trainer.py] => batch_size: 48
2025-01-10 19:53:57,111 [trainer.py] => fs_batch_size: 16
2025-01-10 19:53:57,111 [trainer.py] => weight_decay: 0.0005
2025-01-10 19:53:57,111 [trainer.py] => min_lr: 0
2025-01-10 19:53:57,111 [trainer.py] => optimizer: sgd
2025-01-10 19:53:57,111 [trainer.py] => memory_size: 0
2025-01-10 19:53:57,111 [trainer.py] => memory_per_class: 0
2025-01-10 19:53:57,111 [trainer.py] => fixed_memory: False
2025-01-10 19:53:57,111 [trainer.py] => shuffle: False
2025-01-10 19:53:57,111 [trainer.py] => top_k: 5
2025-01-10 19:53:57,111 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 19:53:57,111 [trainer.py] => prefix: asp
2025-01-10 19:53:57,111 [trainer.py] => model_prefix: asp
2025-01-10 19:53:58,683 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 19:54:28,594 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 19:54:28,594 [trainer.py] => model_name: asp
2025-01-10 19:54:28,594 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 19:54:28,595 [trainer.py] => device: ['cuda']
2025-01-10 19:54:28,595 [trainer.py] => seed: 2024
2025-01-10 19:54:28,595 [trainer.py] => dataset: cifar224
2025-01-10 19:54:28,595 [trainer.py] => init_cls: 60
2025-01-10 19:54:28,595 [trainer.py] => increment: 5
2025-01-10 19:54:28,595 [trainer.py] => kshot: 5
2025-01-10 19:54:28,595 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 19:54:28,595 [trainer.py] => z_dim: 1000
2025-01-10 19:54:28,595 [trainer.py] => conv_dim: 64
2025-01-10 19:54:28,595 [trainer.py] => img_size: 224
2025-01-10 19:54:28,595 [trainer.py] => generator_lr: 0.005
2025-01-10 19:54:28,595 [trainer.py] => pi: 100
2025-01-10 19:54:28,595 [trainer.py] => w_bn: 50.0
2025-01-10 19:54:28,595 [trainer.py] => w_noise: 0.001
2025-01-10 19:54:28,595 [trainer.py] => server_ss: 32
2025-01-10 19:54:28,595 [trainer.py] => bn_loss: 1
2025-01-10 19:54:28,595 [trainer.py] => noise: 1
2025-01-10 19:54:28,595 [trainer.py] => ie_loss: 1
2025-01-10 19:54:28,595 [trainer.py] => act_loss: 0
2025-01-10 19:54:28,595 [trainer.py] => w_ie: 1.0
2025-01-10 19:54:28,595 [trainer.py] => w_act: 0.1
2025-01-10 19:54:28,595 [trainer.py] => syn_size: 32
2025-01-10 19:54:28,595 [trainer.py] => need_syn_imgs: True
2025-01-10 19:54:28,595 [trainer.py] => g_local_bs: 5
2025-01-10 19:54:28,595 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 19:54:28,595 [trainer.py] => g_local_train_steps: 5
2025-01-10 19:54:28,595 [trainer.py] => dataset_syn: cifar100
2025-01-10 19:54:28,595 [trainer.py] => com_round_gen: 10
2025-01-10 19:54:28,595 [trainer.py] => g_sigma: 0
2025-01-10 19:54:28,596 [trainer.py] => save_cls_embeds: False
2025-01-10 19:54:28,596 [trainer.py] => syn_image_path: outputs/syn_image_60_5
2025-01-10 19:54:28,596 [trainer.py] => save_dir: outputs
2025-01-10 19:54:28,596 [trainer.py] => n_iter: 5
2025-01-10 19:54:28,596 [trainer.py] => num_users: 1
2025-01-10 19:54:28,596 [trainer.py] => cur_size: 50
2025-01-10 19:54:28,596 [trainer.py] => local_bs: 5
2025-01-10 19:54:28,596 [trainer.py] => pre_size: 48
2025-01-10 19:54:28,596 [trainer.py] => w_ce_pre: 0.3
2025-01-10 19:54:28,596 [trainer.py] => vpt_type: Deep
2025-01-10 19:54:28,596 [trainer.py] => prompt_token_num: 6
2025-01-10 19:54:28,596 [trainer.py] => avg_alpha: 0.8
2025-01-10 19:54:28,596 [trainer.py] => perturb_var: 1
2025-01-10 19:54:28,596 [trainer.py] => EMA_beta: 0.99
2025-01-10 19:54:28,596 [trainer.py] => anchor_lambda: 0.1
2025-01-10 19:54:28,596 [trainer.py] => kl_weight: 0.001
2025-01-10 19:54:28,596 [trainer.py] => TIP_init: zero
2025-01-10 19:54:28,596 [trainer.py] => tuned_epoch: 10
2025-01-10 19:54:28,596 [trainer.py] => fs_epoch: 0
2025-01-10 19:54:28,596 [trainer.py] => init_lr: 0.01
2025-01-10 19:54:28,596 [trainer.py] => fs_lr: 0.001
2025-01-10 19:54:28,596 [trainer.py] => batch_size: 48
2025-01-10 19:54:28,596 [trainer.py] => fs_batch_size: 16
2025-01-10 19:54:28,596 [trainer.py] => weight_decay: 0.0005
2025-01-10 19:54:28,596 [trainer.py] => min_lr: 0
2025-01-10 19:54:28,596 [trainer.py] => optimizer: sgd
2025-01-10 19:54:28,596 [trainer.py] => memory_size: 0
2025-01-10 19:54:28,596 [trainer.py] => memory_per_class: 0
2025-01-10 19:54:28,597 [trainer.py] => fixed_memory: False
2025-01-10 19:54:28,597 [trainer.py] => shuffle: False
2025-01-10 19:54:28,597 [trainer.py] => top_k: 5
2025-01-10 19:54:28,597 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 19:54:28,597 [trainer.py] => prefix: asp
2025-01-10 19:54:28,597 [trainer.py] => model_prefix: asp
2025-01-10 19:54:30,221 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 19:54:40,127 [trainer.py] => All params: 173596160
2025-01-10 19:54:40,128 [trainer.py] => Trainable params: 1998848
2025-01-10 19:54:56,415 [asp.py] => Learning on 0-60
2025-01-10 19:54:56,500 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-10 19:56:28,671 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 19:56:28,671 [trainer.py] => model_name: asp
2025-01-10 19:56:28,671 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 19:56:28,671 [trainer.py] => device: ['cuda']
2025-01-10 19:56:28,671 [trainer.py] => seed: 2024
2025-01-10 19:56:28,672 [trainer.py] => dataset: cifar224
2025-01-10 19:56:28,672 [trainer.py] => init_cls: 60
2025-01-10 19:56:28,672 [trainer.py] => increment: 5
2025-01-10 19:56:28,672 [trainer.py] => kshot: 5
2025-01-10 19:56:28,672 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 19:56:28,672 [trainer.py] => z_dim: 1000
2025-01-10 19:56:28,672 [trainer.py] => conv_dim: 64
2025-01-10 19:56:28,672 [trainer.py] => img_size: 224
2025-01-10 19:56:28,672 [trainer.py] => generator_lr: 0.005
2025-01-10 19:56:28,672 [trainer.py] => pi: 100
2025-01-10 19:56:28,672 [trainer.py] => w_bn: 50.0
2025-01-10 19:56:28,672 [trainer.py] => w_noise: 0.001
2025-01-10 19:56:28,672 [trainer.py] => server_ss: 32
2025-01-10 19:56:28,672 [trainer.py] => bn_loss: 1
2025-01-10 19:56:28,672 [trainer.py] => noise: 1
2025-01-10 19:56:28,672 [trainer.py] => ie_loss: 1
2025-01-10 19:56:28,672 [trainer.py] => act_loss: 0
2025-01-10 19:56:28,672 [trainer.py] => w_ie: 1.0
2025-01-10 19:56:28,672 [trainer.py] => w_act: 0.1
2025-01-10 19:56:28,672 [trainer.py] => syn_size: 32
2025-01-10 19:56:28,672 [trainer.py] => need_syn_imgs: True
2025-01-10 19:56:28,672 [trainer.py] => g_local_bs: 5
2025-01-10 19:56:28,672 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 19:56:28,672 [trainer.py] => g_local_train_steps: 5
2025-01-10 19:56:28,672 [trainer.py] => dataset_syn: cifar100
2025-01-10 19:56:28,672 [trainer.py] => com_round_gen: 10
2025-01-10 19:56:28,672 [trainer.py] => g_sigma: 0
2025-01-10 19:56:28,672 [trainer.py] => save_cls_embeds: False
2025-01-10 19:56:28,673 [trainer.py] => syn_image_path: outputs/syn_image_60_5
2025-01-10 19:56:28,673 [trainer.py] => save_dir: outputs
2025-01-10 19:56:28,673 [trainer.py] => n_iter: 5
2025-01-10 19:56:28,673 [trainer.py] => num_users: 1
2025-01-10 19:56:28,673 [trainer.py] => cur_size: 50
2025-01-10 19:56:28,673 [trainer.py] => local_bs: 5
2025-01-10 19:56:28,673 [trainer.py] => pre_size: 48
2025-01-10 19:56:28,673 [trainer.py] => w_ce_pre: 0.3
2025-01-10 19:56:28,673 [trainer.py] => vpt_type: Deep
2025-01-10 19:56:28,673 [trainer.py] => prompt_token_num: 6
2025-01-10 19:56:28,673 [trainer.py] => avg_alpha: 0.8
2025-01-10 19:56:28,673 [trainer.py] => perturb_var: 1
2025-01-10 19:56:28,673 [trainer.py] => EMA_beta: 0.99
2025-01-10 19:56:28,673 [trainer.py] => anchor_lambda: 0.1
2025-01-10 19:56:28,673 [trainer.py] => kl_weight: 0.001
2025-01-10 19:56:28,673 [trainer.py] => TIP_init: zero
2025-01-10 19:56:28,673 [trainer.py] => tuned_epoch: 10
2025-01-10 19:56:28,673 [trainer.py] => fs_epoch: 0
2025-01-10 19:56:28,673 [trainer.py] => init_lr: 0.01
2025-01-10 19:56:28,673 [trainer.py] => fs_lr: 0.001
2025-01-10 19:56:28,673 [trainer.py] => batch_size: 48
2025-01-10 19:56:28,673 [trainer.py] => fs_batch_size: 16
2025-01-10 19:56:28,673 [trainer.py] => weight_decay: 0.0005
2025-01-10 19:56:28,673 [trainer.py] => min_lr: 0
2025-01-10 19:56:28,673 [trainer.py] => optimizer: sgd
2025-01-10 19:56:28,673 [trainer.py] => memory_size: 0
2025-01-10 19:56:28,674 [trainer.py] => memory_per_class: 0
2025-01-10 19:56:28,674 [trainer.py] => fixed_memory: False
2025-01-10 19:56:28,674 [trainer.py] => shuffle: False
2025-01-10 19:56:28,674 [trainer.py] => top_k: 5
2025-01-10 19:56:28,674 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 19:56:28,674 [trainer.py] => prefix: asp
2025-01-10 19:56:28,674 [trainer.py] => model_prefix: asp
2025-01-10 19:56:30,305 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 19:56:39,161 [trainer.py] => All params: 173596160
2025-01-10 19:56:39,162 [trainer.py] => Trainable params: 1998848
2025-01-10 19:56:54,990 [asp.py] => Learning on 0-60
2025-01-10 19:56:55,043 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-10 21:27:03,451 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 21:27:03,451 [trainer.py] => model_name: asp
2025-01-10 21:27:03,451 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 21:27:03,451 [trainer.py] => device: ['cuda']
2025-01-10 21:27:03,451 [trainer.py] => seed: 2024
2025-01-10 21:27:03,451 [trainer.py] => dataset: cifar224
2025-01-10 21:27:03,451 [trainer.py] => init_cls: 60
2025-01-10 21:27:03,451 [trainer.py] => increment: 5
2025-01-10 21:27:03,451 [trainer.py] => kshot: 5
2025-01-10 21:27:03,452 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 21:27:03,452 [trainer.py] => z_dim: 1000
2025-01-10 21:27:03,452 [trainer.py] => conv_dim: 64
2025-01-10 21:27:03,452 [trainer.py] => img_size: 224
2025-01-10 21:27:03,452 [trainer.py] => generator_lr: 0.005
2025-01-10 21:27:03,452 [trainer.py] => pi: 100
2025-01-10 21:27:03,452 [trainer.py] => w_bn: 50.0
2025-01-10 21:27:03,452 [trainer.py] => w_noise: 0.001
2025-01-10 21:27:03,452 [trainer.py] => server_ss: 32
2025-01-10 21:27:03,452 [trainer.py] => bn_loss: 1
2025-01-10 21:27:03,452 [trainer.py] => noise: 1
2025-01-10 21:27:03,452 [trainer.py] => ie_loss: 1
2025-01-10 21:27:03,452 [trainer.py] => act_loss: 0
2025-01-10 21:27:03,452 [trainer.py] => w_ie: 1.0
2025-01-10 21:27:03,452 [trainer.py] => w_act: 0.1
2025-01-10 21:27:03,452 [trainer.py] => syn_size: 32
2025-01-10 21:27:03,452 [trainer.py] => need_syn_imgs: True
2025-01-10 21:27:03,452 [trainer.py] => g_local_bs: 5
2025-01-10 21:27:03,452 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 21:27:03,452 [trainer.py] => g_local_train_steps: 5
2025-01-10 21:27:03,452 [trainer.py] => dataset_syn: cifar100
2025-01-10 21:27:03,452 [trainer.py] => com_round_gen: 10
2025-01-10 21:27:03,452 [trainer.py] => g_sigma: 0
2025-01-10 21:27:03,452 [trainer.py] => save_cls_embeds: False
2025-01-10 21:27:03,452 [trainer.py] => syn_image_path: outputs/syn_image_5_5_local_bs_50
2025-01-10 21:27:03,452 [trainer.py] => save_dir: outputs
2025-01-10 21:27:03,452 [trainer.py] => n_iter: 5
2025-01-10 21:27:03,452 [trainer.py] => num_users: 1
2025-01-10 21:27:03,452 [trainer.py] => cur_size: 50
2025-01-10 21:27:03,452 [trainer.py] => local_bs: 50
2025-01-10 21:27:03,452 [trainer.py] => pre_size: 48
2025-01-10 21:27:03,452 [trainer.py] => w_ce_pre: 0.3
2025-01-10 21:27:03,453 [trainer.py] => vpt_type: Deep
2025-01-10 21:27:03,453 [trainer.py] => prompt_token_num: 6
2025-01-10 21:27:03,453 [trainer.py] => avg_alpha: 0.8
2025-01-10 21:27:03,453 [trainer.py] => perturb_var: 1
2025-01-10 21:27:03,453 [trainer.py] => EMA_beta: 0.99
2025-01-10 21:27:03,453 [trainer.py] => anchor_lambda: 0.1
2025-01-10 21:27:03,453 [trainer.py] => kl_weight: 0.001
2025-01-10 21:27:03,453 [trainer.py] => TIP_init: zero
2025-01-10 21:27:03,453 [trainer.py] => tuned_epoch: 10
2025-01-10 21:27:03,453 [trainer.py] => fs_epoch: 0
2025-01-10 21:27:03,453 [trainer.py] => init_lr: 0.01
2025-01-10 21:27:03,453 [trainer.py] => fs_lr: 0.001
2025-01-10 21:27:03,453 [trainer.py] => batch_size: 48
2025-01-10 21:27:03,453 [trainer.py] => fs_batch_size: 16
2025-01-10 21:27:03,453 [trainer.py] => weight_decay: 0.0005
2025-01-10 21:27:03,453 [trainer.py] => min_lr: 0
2025-01-10 21:27:03,453 [trainer.py] => optimizer: sgd
2025-01-10 21:27:03,453 [trainer.py] => memory_size: 0
2025-01-10 21:27:03,453 [trainer.py] => memory_per_class: 0
2025-01-10 21:27:03,453 [trainer.py] => fixed_memory: False
2025-01-10 21:27:03,453 [trainer.py] => shuffle: False
2025-01-10 21:27:03,453 [trainer.py] => top_k: 5
2025-01-10 21:27:03,453 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 21:27:03,453 [trainer.py] => prefix: asp
2025-01-10 21:27:03,453 [trainer.py] => model_prefix: asp
2025-01-10 21:27:05,575 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 21:27:15,964 [trainer.py] => All params: 173596160
2025-01-10 21:27:15,965 [trainer.py] => Trainable params: 1998848
2025-01-10 21:27:40,478 [asp.py] => Learning on 0-60
2025-01-10 21:27:40,539 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-10 23:31:59,481 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 23:31:59,481 [trainer.py] => model_name: asp
2025-01-10 23:31:59,482 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 23:31:59,482 [trainer.py] => device: ['cuda']
2025-01-10 23:31:59,482 [trainer.py] => seed: 2024
2025-01-10 23:31:59,482 [trainer.py] => dataset: cifar224
2025-01-10 23:31:59,482 [trainer.py] => init_cls: 60
2025-01-10 23:31:59,482 [trainer.py] => increment: 5
2025-01-10 23:31:59,482 [trainer.py] => kshot: 5
2025-01-10 23:31:59,482 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 23:31:59,482 [trainer.py] => z_dim: 1000
2025-01-10 23:31:59,482 [trainer.py] => conv_dim: 64
2025-01-10 23:31:59,482 [trainer.py] => img_size: 224
2025-01-10 23:31:59,482 [trainer.py] => generator_lr: 0.005
2025-01-10 23:31:59,482 [trainer.py] => pi: 100
2025-01-10 23:31:59,482 [trainer.py] => w_bn: 50.0
2025-01-10 23:31:59,482 [trainer.py] => w_noise: 0.001
2025-01-10 23:31:59,482 [trainer.py] => server_ss: 32
2025-01-10 23:31:59,482 [trainer.py] => bn_loss: 1
2025-01-10 23:31:59,482 [trainer.py] => noise: 1
2025-01-10 23:31:59,482 [trainer.py] => ie_loss: 1
2025-01-10 23:31:59,482 [trainer.py] => act_loss: 0
2025-01-10 23:31:59,482 [trainer.py] => w_ie: 1.0
2025-01-10 23:31:59,482 [trainer.py] => w_act: 0.1
2025-01-10 23:31:59,482 [trainer.py] => syn_size: 32
2025-01-10 23:31:59,482 [trainer.py] => need_syn_imgs: True
2025-01-10 23:31:59,482 [trainer.py] => g_local_bs: 5
2025-01-10 23:31:59,482 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 23:31:59,482 [trainer.py] => g_local_train_steps: 5
2025-01-10 23:31:59,482 [trainer.py] => dataset_syn: cifar100
2025-01-10 23:31:59,482 [trainer.py] => com_round_gen: 10
2025-01-10 23:31:59,482 [trainer.py] => g_sigma: 0
2025-01-10 23:31:59,483 [trainer.py] => save_cls_embeds: False
2025-01-10 23:31:59,483 [trainer.py] => syn_image_path: outputs/syn_image_60_5_pre0.5_local_bs5
2025-01-10 23:31:59,483 [trainer.py] => save_dir: outputs
2025-01-10 23:31:59,483 [trainer.py] => n_iter: 5
2025-01-10 23:31:59,483 [trainer.py] => num_users: 1
2025-01-10 23:31:59,483 [trainer.py] => cur_size: 50
2025-01-10 23:31:59,483 [trainer.py] => local_bs: 5
2025-01-10 23:31:59,483 [trainer.py] => pre_size: 48
2025-01-10 23:31:59,483 [trainer.py] => w_ce_pre: 0.5
2025-01-10 23:31:59,483 [trainer.py] => vpt_type: Deep
2025-01-10 23:31:59,483 [trainer.py] => prompt_token_num: 6
2025-01-10 23:31:59,483 [trainer.py] => avg_alpha: 0.8
2025-01-10 23:31:59,483 [trainer.py] => perturb_var: 1
2025-01-10 23:31:59,483 [trainer.py] => EMA_beta: 0.99
2025-01-10 23:31:59,483 [trainer.py] => anchor_lambda: 0.1
2025-01-10 23:31:59,483 [trainer.py] => kl_weight: 0.001
2025-01-10 23:31:59,483 [trainer.py] => TIP_init: zero
2025-01-10 23:31:59,483 [trainer.py] => tuned_epoch: 10
2025-01-10 23:31:59,483 [trainer.py] => fs_epoch: 0
2025-01-10 23:31:59,483 [trainer.py] => init_lr: 0.01
2025-01-10 23:31:59,483 [trainer.py] => fs_lr: 0.001
2025-01-10 23:31:59,483 [trainer.py] => batch_size: 48
2025-01-10 23:31:59,483 [trainer.py] => fs_batch_size: 16
2025-01-10 23:31:59,483 [trainer.py] => weight_decay: 0.0005
2025-01-10 23:31:59,483 [trainer.py] => min_lr: 0
2025-01-10 23:31:59,483 [trainer.py] => optimizer: sgd
2025-01-10 23:31:59,483 [trainer.py] => memory_size: 0
2025-01-10 23:31:59,483 [trainer.py] => memory_per_class: 0
2025-01-10 23:31:59,483 [trainer.py] => fixed_memory: False
2025-01-10 23:31:59,483 [trainer.py] => shuffle: False
2025-01-10 23:31:59,483 [trainer.py] => top_k: 5
2025-01-10 23:31:59,483 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 23:31:59,483 [trainer.py] => prefix: asp
2025-01-10 23:31:59,484 [trainer.py] => model_prefix: asp
2025-01-10 23:32:00,959 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 23:32:10,313 [trainer.py] => All params: 173596160
2025-01-10 23:32:10,314 [trainer.py] => Trainable params: 1998848
2025-01-10 23:32:26,719 [asp.py] => Learning on 0-60
2025-01-10 23:32:26,832 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-10 23:33:13,820 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 23:33:13,820 [trainer.py] => model_name: asp
2025-01-10 23:33:13,820 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 23:33:13,820 [trainer.py] => device: ['cuda']
2025-01-10 23:33:13,820 [trainer.py] => seed: 2024
2025-01-10 23:33:13,820 [trainer.py] => dataset: cifar224
2025-01-10 23:33:13,820 [trainer.py] => init_cls: 60
2025-01-10 23:33:13,820 [trainer.py] => increment: 5
2025-01-10 23:33:13,820 [trainer.py] => kshot: 5
2025-01-10 23:33:13,820 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 23:33:13,820 [trainer.py] => z_dim: 1000
2025-01-10 23:33:13,820 [trainer.py] => conv_dim: 64
2025-01-10 23:33:13,820 [trainer.py] => img_size: 224
2025-01-10 23:33:13,820 [trainer.py] => generator_lr: 0.005
2025-01-10 23:33:13,820 [trainer.py] => pi: 100
2025-01-10 23:33:13,820 [trainer.py] => w_bn: 50.0
2025-01-10 23:33:13,821 [trainer.py] => w_noise: 0.001
2025-01-10 23:33:13,821 [trainer.py] => server_ss: 32
2025-01-10 23:33:13,821 [trainer.py] => bn_loss: 1
2025-01-10 23:33:13,821 [trainer.py] => noise: 1
2025-01-10 23:33:13,821 [trainer.py] => ie_loss: 1
2025-01-10 23:33:13,821 [trainer.py] => act_loss: 0
2025-01-10 23:33:13,821 [trainer.py] => w_ie: 1.0
2025-01-10 23:33:13,821 [trainer.py] => w_act: 0.1
2025-01-10 23:33:13,821 [trainer.py] => syn_size: 32
2025-01-10 23:33:13,821 [trainer.py] => need_syn_imgs: True
2025-01-10 23:33:13,821 [trainer.py] => g_local_bs: 5
2025-01-10 23:33:13,821 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 23:33:13,821 [trainer.py] => g_local_train_steps: 5
2025-01-10 23:33:13,821 [trainer.py] => dataset_syn: cifar100
2025-01-10 23:33:13,821 [trainer.py] => com_round_gen: 10
2025-01-10 23:33:13,821 [trainer.py] => g_sigma: 0
2025-01-10 23:33:13,821 [trainer.py] => save_cls_embeds: False
2025-01-10 23:33:13,821 [trainer.py] => syn_image_path: outputs/syn_image_60_5_pre0.0_local_bs5
2025-01-10 23:33:13,821 [trainer.py] => save_dir: outputs
2025-01-10 23:33:13,821 [trainer.py] => n_iter: 5
2025-01-10 23:33:13,821 [trainer.py] => num_users: 1
2025-01-10 23:33:13,821 [trainer.py] => cur_size: 50
2025-01-10 23:33:13,821 [trainer.py] => local_bs: 5
2025-01-10 23:33:13,821 [trainer.py] => pre_size: 48
2025-01-10 23:33:13,821 [trainer.py] => w_ce_pre: 0.0
2025-01-10 23:33:13,821 [trainer.py] => vpt_type: Deep
2025-01-10 23:33:13,821 [trainer.py] => prompt_token_num: 6
2025-01-10 23:33:13,821 [trainer.py] => avg_alpha: 0.8
2025-01-10 23:33:13,821 [trainer.py] => perturb_var: 1
2025-01-10 23:33:13,821 [trainer.py] => EMA_beta: 0.99
2025-01-10 23:33:13,822 [trainer.py] => anchor_lambda: 0.1
2025-01-10 23:33:13,822 [trainer.py] => kl_weight: 0.001
2025-01-10 23:33:13,822 [trainer.py] => TIP_init: zero
2025-01-10 23:33:13,822 [trainer.py] => tuned_epoch: 10
2025-01-10 23:33:13,822 [trainer.py] => fs_epoch: 0
2025-01-10 23:33:13,822 [trainer.py] => init_lr: 0.01
2025-01-10 23:33:13,822 [trainer.py] => fs_lr: 0.001
2025-01-10 23:33:13,822 [trainer.py] => batch_size: 48
2025-01-10 23:33:13,822 [trainer.py] => fs_batch_size: 16
2025-01-10 23:33:13,822 [trainer.py] => weight_decay: 0.0005
2025-01-10 23:33:13,822 [trainer.py] => min_lr: 0
2025-01-10 23:33:13,822 [trainer.py] => optimizer: sgd
2025-01-10 23:33:13,822 [trainer.py] => memory_size: 0
2025-01-10 23:33:13,822 [trainer.py] => memory_per_class: 0
2025-01-10 23:33:13,822 [trainer.py] => fixed_memory: False
2025-01-10 23:33:13,822 [trainer.py] => shuffle: False
2025-01-10 23:33:13,822 [trainer.py] => top_k: 5
2025-01-10 23:33:13,822 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 23:33:13,822 [trainer.py] => prefix: asp
2025-01-10 23:33:13,822 [trainer.py] => model_prefix: asp
2025-01-10 23:33:15,229 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-10 23:33:23,974 [trainer.py] => All params: 173596160
2025-01-10 23:33:23,974 [trainer.py] => Trainable params: 1998848
2025-01-10 23:33:40,361 [asp.py] => Learning on 0-60
2025-01-10 23:33:40,433 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-11 02:35:53,437 [asp.py] => total parameters: 173642241
2025-01-11 02:35:53,439 [asp.py] => trainable parameters: 2044929
2025-01-11 02:39:57,547 [asp.py] => total parameters: 173642241
2025-01-11 02:39:57,548 [asp.py] => trainable parameters: 2044929
2025-01-11 02:48:03,619 [asp.py] => Task 0, Epoch 1 => Loss 4.214, Train_accy 1.66, Test_curr_accy 1.77, Test_accy 1.77
2025-01-11 02:52:18,749 [asp.py] => Task 0, Epoch 1 => Loss 4.214, Train_accy 1.61, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 03:00:15,164 [asp.py] => Task 0, Epoch 2 => Loss 4.154, Train_accy 1.59, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 03:04:45,495 [asp.py] => Task 0, Epoch 2 => Loss 4.153, Train_accy 1.57, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 03:12:22,479 [asp.py] => Task 0, Epoch 3 => Loss 4.152, Train_accy 1.61, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 03:17:09,680 [asp.py] => Task 0, Epoch 3 => Loss 4.150, Train_accy 1.61, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 03:24:31,048 [asp.py] => Task 0, Epoch 4 => Loss 4.149, Train_accy 1.60, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 03:29:31,184 [asp.py] => Task 0, Epoch 4 => Loss 4.150, Train_accy 1.64, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 03:36:38,079 [asp.py] => Task 0, Epoch 5 => Loss 4.147, Train_accy 1.75, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 03:41:57,811 [asp.py] => Task 0, Epoch 5 => Loss 4.148, Train_accy 1.68, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 03:48:44,036 [asp.py] => Task 0, Epoch 6 => Loss 4.147, Train_accy 1.65, Test_curr_accy 2.00, Test_accy 2.00
2025-01-11 03:54:25,448 [asp.py] => Task 0, Epoch 6 => Loss 4.144, Train_accy 1.63, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 04:00:54,761 [asp.py] => Task 0, Epoch 7 => Loss 4.143, Train_accy 1.60, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 04:06:51,467 [asp.py] => Task 0, Epoch 7 => Loss 4.142, Train_accy 1.65, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 04:13:01,136 [asp.py] => Task 0, Epoch 8 => Loss 4.144, Train_accy 1.70, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 04:19:13,634 [asp.py] => Task 0, Epoch 8 => Loss 4.143, Train_accy 1.75, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 04:25:10,981 [asp.py] => Task 0, Epoch 9 => Loss 4.145, Train_accy 1.72, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 04:31:38,754 [asp.py] => Task 0, Epoch 9 => Loss 4.145, Train_accy 1.71, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 04:37:23,337 [asp.py] => Task 0, Epoch 10 => Loss 4.144, Train_accy 1.68, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 04:41:14,148 [trainer.py] => Top1 curve: [13.48]
2025-01-11 04:41:14,149 [trainer.py] => Average Accuracy (Top1): 13.48   (Harmonic Accuracy): None (Old Acc): 13.483333333333333 (New Acc): [] 

2025-01-11 04:41:14,150 [trainer.py] => All params: 173642241
2025-01-11 04:41:14,151 [trainer.py] => Trainable params: 2044929
2025-01-11 04:41:35,999 [asp.py] => Learning on 60-65
2025-01-11 04:41:36,019 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:44:06,285 [asp.py] => Task 0, Epoch 10 => Loss 4.140, Train_accy 1.65, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 04:48:04,543 [trainer.py] => Top1 curve: [0.03]
2025-01-11 04:48:04,543 [trainer.py] => Average Accuracy (Top1): 0.03   (Harmonic Accuracy): None (Old Acc): 0.03333333333333333 (New Acc): [] 

2025-01-11 04:48:04,544 [trainer.py] => All params: 173642241
2025-01-11 04:48:04,545 [trainer.py] => Trainable params: 2044929
2025-01-11 04:48:23,326 [asp.py] => Learning on 60-65
2025-01-11 04:48:23,344 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 04:57:03,703 [asp.py] => total parameters: 173646081
2025-01-11 04:57:03,704 [asp.py] => trainable parameters: 2048769
2025-01-11 04:57:35,758 [trainer.py] => Top1 curve: [13.48, 12.85]
2025-01-11 04:57:35,759 [trainer.py] => Average Accuracy (Top1): 13.165   (Harmonic Accuracy): 11.08613352898019 (Old Acc): 13.116666666666667 (New Acc): 9.6 

2025-01-11 04:57:35,760 [trainer.py] => All params: 173646081
2025-01-11 04:57:35,760 [trainer.py] => Trainable params: 2048769
2025-01-11 04:57:54,173 [asp.py] => Learning on 65-70
2025-01-11 04:57:54,191 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 05:04:00,751 [asp.py] => total parameters: 173646081
2025-01-11 05:04:00,752 [asp.py] => trainable parameters: 2048769
2025-01-11 05:04:34,474 [trainer.py] => Top1 curve: [0.03, 0.03]
2025-01-11 05:04:34,474 [trainer.py] => Average Accuracy (Top1): 0.03   (Harmonic Accuracy): 0.03076923076923077 (Old Acc): 0.016666666666666666 (New Acc): 0.2 

2025-01-11 05:04:34,475 [trainer.py] => All params: 173646081
2025-01-11 05:04:34,475 [trainer.py] => Trainable params: 2048769
2025-01-11 05:05:31,133 [asp.py] => Learning on 65-70
2025-01-11 05:05:31,180 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 05:13:19,520 [asp.py] => total parameters: 173649921
2025-01-11 05:13:19,521 [asp.py] => trainable parameters: 2052609
2025-01-11 05:13:56,563 [trainer.py] => Top1 curve: [13.48, 12.85, 12.24]
2025-01-11 05:13:56,563 [trainer.py] => Average Accuracy (Top1): 12.856666666666667   (Harmonic Accuracy): 11.4788752703677 (Old Acc): 12.516666666666667 (New Acc): 10.6 

2025-01-11 05:13:56,565 [trainer.py] => All params: 173649921
2025-01-11 05:13:56,566 [trainer.py] => Trainable params: 2052609
2025-01-11 05:14:18,699 [asp.py] => Learning on 70-75
2025-01-11 05:14:18,723 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 05:21:11,187 [asp.py] => total parameters: 173649921
2025-01-11 05:21:11,188 [asp.py] => trainable parameters: 2052609
2025-01-11 05:21:45,451 [trainer.py] => Top1 curve: [0.03, 0.03, 0.27]
2025-01-11 05:21:45,451 [trainer.py] => Average Accuracy (Top1): 0.11   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 1.9000000000000001 

2025-01-11 05:21:45,453 [trainer.py] => All params: 173649921
2025-01-11 05:21:45,454 [trainer.py] => Trainable params: 2052609
2025-01-11 05:22:04,580 [asp.py] => Learning on 70-75
2025-01-11 05:22:04,619 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 05:29:44,875 [asp.py] => total parameters: 173653761
2025-01-11 05:29:44,876 [asp.py] => trainable parameters: 2056449
2025-01-11 05:30:20,456 [trainer.py] => Top1 curve: [13.48, 12.85, 12.24, 11.6]
2025-01-11 05:30:20,457 [trainer.py] => Average Accuracy (Top1): 12.5425   (Harmonic Accuracy): 10.670875032075957 (Old Acc): 12.116666666666667 (New Acc): 9.533333333333333 

2025-01-11 05:30:20,458 [trainer.py] => All params: 173653761
2025-01-11 05:30:20,458 [trainer.py] => Trainable params: 2056449
2025-01-11 05:30:41,101 [asp.py] => Learning on 75-80
2025-01-11 05:30:41,124 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 05:37:54,864 [asp.py] => total parameters: 173653761
2025-01-11 05:37:54,865 [asp.py] => trainable parameters: 2056449
2025-01-11 05:38:32,905 [trainer.py] => Top1 curve: [0.03, 0.03, 0.27, 0.25]
2025-01-11 05:38:32,906 [trainer.py] => Average Accuracy (Top1): 0.14500000000000002   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 1.2666666666666668 

2025-01-11 05:38:32,907 [trainer.py] => All params: 173653761
2025-01-11 05:38:32,908 [trainer.py] => Trainable params: 2056449
2025-01-11 05:38:55,316 [asp.py] => Learning on 75-80
2025-01-11 05:38:55,337 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 05:46:25,856 [asp.py] => total parameters: 173657601
2025-01-11 05:46:25,857 [asp.py] => trainable parameters: 2060289
2025-01-11 05:47:04,339 [trainer.py] => Top1 curve: [13.48, 12.85, 12.24, 11.6, 10.85]
2025-01-11 05:47:04,339 [trainer.py] => Average Accuracy (Top1): 12.204   (Harmonic Accuracy): 9.904036243822077 (Old Acc): 11.583333333333334 (New Acc): 8.65 

2025-01-11 05:47:04,340 [trainer.py] => All params: 173657601
2025-01-11 05:47:04,341 [trainer.py] => Trainable params: 2060289
2025-01-11 05:47:26,784 [asp.py] => Learning on 80-85
2025-01-11 05:47:26,820 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 05:55:02,022 [asp.py] => total parameters: 173657601
2025-01-11 05:55:02,023 [asp.py] => trainable parameters: 2060289
2025-01-11 05:55:41,303 [trainer.py] => Top1 curve: [0.03, 0.03, 0.27, 0.25, 0.24]
2025-01-11 05:55:41,303 [trainer.py] => Average Accuracy (Top1): 0.164   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 0.9500000000000001 

2025-01-11 05:55:41,304 [trainer.py] => All params: 173657601
2025-01-11 05:55:41,304 [trainer.py] => Trainable params: 2060289
2025-01-11 05:56:05,497 [asp.py] => Learning on 80-85
2025-01-11 05:56:05,530 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 06:03:13,170 [asp.py] => total parameters: 173661441
2025-01-11 06:03:13,170 [asp.py] => trainable parameters: 2064129
2025-01-11 06:03:53,776 [trainer.py] => Top1 curve: [13.48, 12.85, 12.24, 11.6, 10.85, 10.34]
2025-01-11 06:03:53,777 [trainer.py] => Average Accuracy (Top1): 11.893333333333333   (Harmonic Accuracy): 9.678644067796611 (Old Acc): 11.066666666666668 (New Acc): 8.6 

2025-01-11 06:03:53,778 [trainer.py] => All params: 173661441
2025-01-11 06:03:53,779 [trainer.py] => Trainable params: 2064129
2025-01-11 06:04:13,342 [asp.py] => Learning on 85-90
2025-01-11 06:04:13,362 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 06:12:10,846 [asp.py] => total parameters: 173661441
2025-01-11 06:12:10,847 [asp.py] => trainable parameters: 2064129
2025-01-11 06:12:52,734 [trainer.py] => Top1 curve: [0.03, 0.03, 0.27, 0.25, 0.24, 0.22]
2025-01-11 06:12:52,734 [trainer.py] => Average Accuracy (Top1): 0.17333333333333334   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 0.76 

2025-01-11 06:12:52,735 [trainer.py] => All params: 173661441
2025-01-11 06:12:52,736 [trainer.py] => Trainable params: 2064129
2025-01-11 06:13:19,143 [asp.py] => Learning on 85-90
2025-01-11 06:13:19,187 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 06:20:01,813 [asp.py] => total parameters: 173665281
2025-01-11 06:20:01,814 [asp.py] => trainable parameters: 2067969
2025-01-11 06:20:45,032 [trainer.py] => Top1 curve: [13.48, 12.85, 12.24, 11.6, 10.85, 10.34, 9.96]
2025-01-11 06:20:45,033 [trainer.py] => Average Accuracy (Top1): 11.617142857142856   (Harmonic Accuracy): 9.614457831325302 (Old Acc): 10.5 (New Acc): 8.866666666666667 

2025-01-11 06:20:45,034 [trainer.py] => All params: 173665281
2025-01-11 06:20:45,034 [trainer.py] => Trainable params: 2067969
2025-01-11 06:21:07,020 [asp.py] => Learning on 90-95
2025-01-11 06:21:07,062 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 06:29:23,172 [asp.py] => total parameters: 173665281
2025-01-11 06:29:23,173 [asp.py] => trainable parameters: 2067969
2025-01-11 06:30:08,513 [trainer.py] => Top1 curve: [0.03, 0.03, 0.27, 0.25, 0.24, 0.22, 0.21]
2025-01-11 06:30:08,513 [trainer.py] => Average Accuracy (Top1): 0.17857142857142858   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 0.6333333333333334 

2025-01-11 06:30:08,514 [trainer.py] => All params: 173665281
2025-01-11 06:30:08,515 [trainer.py] => Trainable params: 2067969
2025-01-11 06:30:33,211 [asp.py] => Learning on 90-95
2025-01-11 06:30:33,258 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 06:36:54,665 [asp.py] => total parameters: 173669121
2025-01-11 06:36:54,666 [asp.py] => trainable parameters: 2071809
2025-01-11 06:37:39,537 [trainer.py] => Top1 curve: [13.48, 12.85, 12.24, 11.6, 10.85, 10.34, 9.96, 9.62]
2025-01-11 06:37:39,537 [trainer.py] => Average Accuracy (Top1): 11.3675   (Harmonic Accuracy): 9.386881937436932 (Old Acc): 10.133333333333335 (New Acc): 8.742857142857144 

2025-01-11 06:37:39,539 [trainer.py] => All params: 173669121
2025-01-11 06:37:39,539 [trainer.py] => Trainable params: 2071809
2025-01-11 06:38:01,854 [asp.py] => Learning on 95-100
2025-01-11 06:38:01,875 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 06:46:37,650 [asp.py] => total parameters: 173669121
2025-01-11 06:46:37,652 [asp.py] => trainable parameters: 2071809
2025-01-11 06:47:24,273 [trainer.py] => Top1 curve: [0.03, 0.03, 0.27, 0.25, 0.24, 0.22, 0.21, 0.2]
2025-01-11 06:47:24,274 [trainer.py] => Average Accuracy (Top1): 0.18125   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 0.5428571428571429 

2025-01-11 06:47:24,275 [trainer.py] => All params: 173669121
2025-01-11 06:47:24,276 [trainer.py] => Trainable params: 2071809
2025-01-11 06:47:48,058 [asp.py] => Learning on 95-100
2025-01-11 06:47:48,090 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 06:53:49,795 [asp.py] => total parameters: 173672961
2025-01-11 06:53:49,796 [asp.py] => trainable parameters: 2075649
2025-01-11 06:54:36,945 [trainer.py] => Top1 curve: [13.48, 12.85, 12.24, 11.6, 10.85, 10.34, 9.96, 9.62, 8.92]
2025-01-11 06:54:36,946 [trainer.py] => Average Accuracy (Top1): 11.095555555555556   (Harmonic Accuracy): 8.869295774647888 (Old Acc): 9.1 (New Acc): 8.65 

2025-01-11 06:54:36,946 [trainer.py] => 

2025-01-11 07:03:57,344 [asp.py] => total parameters: 173672961
2025-01-11 07:03:57,346 [asp.py] => trainable parameters: 2075649
2025-01-11 07:04:46,577 [trainer.py] => Top1 curve: [0.03, 0.03, 0.27, 0.25, 0.24, 0.22, 0.21, 0.2, 0.19]
2025-01-11 07:04:46,578 [trainer.py] => Average Accuracy (Top1): 0.1822222222222222   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 0.47500000000000003 

2025-01-11 07:04:46,578 [trainer.py] => 

2025-01-11 11:42:32,292 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-11 11:42:32,292 [trainer.py] => model_name: asp
2025-01-11 11:42:32,292 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-11 11:42:32,292 [trainer.py] => device: ['cuda']
2025-01-11 11:42:32,292 [trainer.py] => seed: 2024
2025-01-11 11:42:32,293 [trainer.py] => dataset: cifar224
2025-01-11 11:42:32,293 [trainer.py] => init_cls: 60
2025-01-11 11:42:32,293 [trainer.py] => increment: 5
2025-01-11 11:42:32,293 [trainer.py] => kshot: 5
2025-01-11 11:42:32,293 [trainer.py] => generator_model: CIFAR_GEN
2025-01-11 11:42:32,293 [trainer.py] => z_dim: 1000
2025-01-11 11:42:32,293 [trainer.py] => conv_dim: 64
2025-01-11 11:42:32,293 [trainer.py] => img_size: 224
2025-01-11 11:42:32,293 [trainer.py] => generator_lr: 0.005
2025-01-11 11:42:32,293 [trainer.py] => pi: 100
2025-01-11 11:42:32,293 [trainer.py] => w_bn: 50.0
2025-01-11 11:42:32,293 [trainer.py] => w_noise: 0.001
2025-01-11 11:42:32,293 [trainer.py] => server_ss: 32
2025-01-11 11:42:32,294 [trainer.py] => bn_loss: 1
2025-01-11 11:42:32,294 [trainer.py] => noise: 1
2025-01-11 11:42:32,294 [trainer.py] => ie_loss: 1
2025-01-11 11:42:32,294 [trainer.py] => act_loss: 0
2025-01-11 11:42:32,294 [trainer.py] => w_ie: 1.0
2025-01-11 11:42:32,294 [trainer.py] => w_act: 0.1
2025-01-11 11:42:32,294 [trainer.py] => syn_size: 32
2025-01-11 11:42:32,294 [trainer.py] => need_syn_imgs: True
2025-01-11 11:42:32,294 [trainer.py] => g_local_bs: 5
2025-01-11 11:42:32,294 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-11 11:42:32,294 [trainer.py] => g_local_train_steps: 5
2025-01-11 11:42:32,294 [trainer.py] => dataset_syn: cifar100
2025-01-11 11:42:32,295 [trainer.py] => com_round_gen: 10
2025-01-11 11:42:32,295 [trainer.py] => g_sigma: 0
2025-01-11 11:42:32,295 [trainer.py] => save_cls_embeds: False
2025-01-11 11:42:32,295 [trainer.py] => syn_image_path: outputs/syn_image_60_5_pre0.0_local_bs5
2025-01-11 11:42:32,295 [trainer.py] => save_dir: outputs
2025-01-11 11:42:32,295 [trainer.py] => n_iter: 5
2025-01-11 11:42:32,295 [trainer.py] => num_users: 1
2025-01-11 11:42:32,295 [trainer.py] => cur_size: 50
2025-01-11 11:42:32,295 [trainer.py] => local_bs: 5
2025-01-11 11:42:32,295 [trainer.py] => pre_size: 48
2025-01-11 11:42:32,295 [trainer.py] => w_ce_pre: 0.0
2025-01-11 11:42:32,295 [trainer.py] => vpt_type: Deep
2025-01-11 11:42:32,295 [trainer.py] => prompt_token_num: 6
2025-01-11 11:42:32,296 [trainer.py] => avg_alpha: 0.8
2025-01-11 11:42:32,296 [trainer.py] => perturb_var: 1
2025-01-11 11:42:32,296 [trainer.py] => EMA_beta: 0.99
2025-01-11 11:42:32,296 [trainer.py] => anchor_lambda: 0.1
2025-01-11 11:42:32,296 [trainer.py] => kl_weight: 0.001
2025-01-11 11:42:32,296 [trainer.py] => TIP_init: zero
2025-01-11 11:42:32,296 [trainer.py] => tuned_epoch: 10
2025-01-11 11:42:32,296 [trainer.py] => fs_epoch: 0
2025-01-11 11:42:32,296 [trainer.py] => init_lr: 0.01
2025-01-11 11:42:32,296 [trainer.py] => fs_lr: 0.001
2025-01-11 11:42:32,296 [trainer.py] => batch_size: 48
2025-01-11 11:42:32,296 [trainer.py] => fs_batch_size: 16
2025-01-11 11:42:32,296 [trainer.py] => weight_decay: 0.0005
2025-01-11 11:42:32,296 [trainer.py] => min_lr: 0
2025-01-11 11:42:32,297 [trainer.py] => optimizer: sgd
2025-01-11 11:42:32,297 [trainer.py] => memory_size: 0
2025-01-11 11:42:32,297 [trainer.py] => memory_per_class: 0
2025-01-11 11:42:32,297 [trainer.py] => fixed_memory: False
2025-01-11 11:42:32,297 [trainer.py] => shuffle: False
2025-01-11 11:42:32,297 [trainer.py] => top_k: 5
2025-01-11 11:42:32,297 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-11 11:42:32,297 [trainer.py] => prefix: asp
2025-01-11 11:42:32,297 [trainer.py] => model_prefix: asp
2025-01-11 11:42:34,485 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-11 11:43:10,557 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-11 11:43:10,557 [trainer.py] => model_name: asp
2025-01-11 11:43:10,557 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-11 11:43:10,557 [trainer.py] => device: ['cuda']
2025-01-11 11:43:10,557 [trainer.py] => seed: 2024
2025-01-11 11:43:10,557 [trainer.py] => dataset: cifar224
2025-01-11 11:43:10,557 [trainer.py] => init_cls: 60
2025-01-11 11:43:10,557 [trainer.py] => increment: 5
2025-01-11 11:43:10,557 [trainer.py] => kshot: 5
2025-01-11 11:43:10,557 [trainer.py] => generator_model: CIFAR_GEN
2025-01-11 11:43:10,557 [trainer.py] => z_dim: 1000
2025-01-11 11:43:10,557 [trainer.py] => conv_dim: 64
2025-01-11 11:43:10,557 [trainer.py] => img_size: 224
2025-01-11 11:43:10,557 [trainer.py] => generator_lr: 0.005
2025-01-11 11:43:10,557 [trainer.py] => pi: 100
2025-01-11 11:43:10,557 [trainer.py] => w_bn: 50.0
2025-01-11 11:43:10,557 [trainer.py] => w_noise: 0.001
2025-01-11 11:43:10,558 [trainer.py] => server_ss: 32
2025-01-11 11:43:10,558 [trainer.py] => bn_loss: 1
2025-01-11 11:43:10,558 [trainer.py] => noise: 1
2025-01-11 11:43:10,558 [trainer.py] => ie_loss: 1
2025-01-11 11:43:10,558 [trainer.py] => act_loss: 0
2025-01-11 11:43:10,558 [trainer.py] => w_ie: 1.0
2025-01-11 11:43:10,558 [trainer.py] => w_act: 0.1
2025-01-11 11:43:10,558 [trainer.py] => syn_size: 32
2025-01-11 11:43:10,558 [trainer.py] => need_syn_imgs: True
2025-01-11 11:43:10,558 [trainer.py] => g_local_bs: 5
2025-01-11 11:43:10,558 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-11 11:43:10,558 [trainer.py] => g_local_train_steps: 5
2025-01-11 11:43:10,558 [trainer.py] => dataset_syn: cifar100
2025-01-11 11:43:10,558 [trainer.py] => com_round_gen: 10
2025-01-11 11:43:10,558 [trainer.py] => g_sigma: 0
2025-01-11 11:43:10,558 [trainer.py] => save_cls_embeds: False
2025-01-11 11:43:10,558 [trainer.py] => syn_image_path: outputs/syn_image_60_5_pre0.0_local_bs5
2025-01-11 11:43:10,558 [trainer.py] => save_dir: outputs
2025-01-11 11:43:10,558 [trainer.py] => n_iter: 5
2025-01-11 11:43:10,558 [trainer.py] => num_users: 1
2025-01-11 11:43:10,558 [trainer.py] => cur_size: 50
2025-01-11 11:43:10,558 [trainer.py] => local_bs: 5
2025-01-11 11:43:10,558 [trainer.py] => pre_size: 48
2025-01-11 11:43:10,558 [trainer.py] => w_ce_pre: 0.0
2025-01-11 11:43:10,558 [trainer.py] => vpt_type: Deep
2025-01-11 11:43:10,558 [trainer.py] => prompt_token_num: 6
2025-01-11 11:43:10,558 [trainer.py] => avg_alpha: 0.8
2025-01-11 11:43:10,558 [trainer.py] => perturb_var: 1
2025-01-11 11:43:10,558 [trainer.py] => EMA_beta: 0.99
2025-01-11 11:43:10,558 [trainer.py] => anchor_lambda: 0.1
2025-01-11 11:43:10,558 [trainer.py] => kl_weight: 0.001
2025-01-11 11:43:10,558 [trainer.py] => TIP_init: zero
2025-01-11 11:43:10,559 [trainer.py] => tuned_epoch: 10
2025-01-11 11:43:10,559 [trainer.py] => fs_epoch: 0
2025-01-11 11:43:10,559 [trainer.py] => init_lr: 0.01
2025-01-11 11:43:10,559 [trainer.py] => fs_lr: 0.001
2025-01-11 11:43:10,559 [trainer.py] => batch_size: 48
2025-01-11 11:43:10,559 [trainer.py] => fs_batch_size: 16
2025-01-11 11:43:10,559 [trainer.py] => weight_decay: 0.0005
2025-01-11 11:43:10,559 [trainer.py] => min_lr: 0
2025-01-11 11:43:10,559 [trainer.py] => optimizer: sgd
2025-01-11 11:43:10,559 [trainer.py] => memory_size: 0
2025-01-11 11:43:10,559 [trainer.py] => memory_per_class: 0
2025-01-11 11:43:10,559 [trainer.py] => fixed_memory: False
2025-01-11 11:43:10,559 [trainer.py] => shuffle: False
2025-01-11 11:43:10,559 [trainer.py] => top_k: 5
2025-01-11 11:43:10,559 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-11 11:43:10,559 [trainer.py] => prefix: asp
2025-01-11 11:43:10,559 [trainer.py] => model_prefix: asp
2025-01-11 11:43:12,132 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-11 11:44:10,983 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-11 11:44:10,983 [trainer.py] => model_name: asp
2025-01-11 11:44:10,983 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-11 11:44:10,983 [trainer.py] => device: ['cuda']
2025-01-11 11:44:10,983 [trainer.py] => seed: 2024
2025-01-11 11:44:10,983 [trainer.py] => dataset: cifar224
2025-01-11 11:44:10,983 [trainer.py] => init_cls: 60
2025-01-11 11:44:10,984 [trainer.py] => increment: 5
2025-01-11 11:44:10,984 [trainer.py] => kshot: 5
2025-01-11 11:44:10,984 [trainer.py] => generator_model: CIFAR_GEN
2025-01-11 11:44:10,984 [trainer.py] => z_dim: 1000
2025-01-11 11:44:10,984 [trainer.py] => conv_dim: 64
2025-01-11 11:44:10,984 [trainer.py] => img_size: 224
2025-01-11 11:44:10,984 [trainer.py] => generator_lr: 0.005
2025-01-11 11:44:10,984 [trainer.py] => pi: 100
2025-01-11 11:44:10,984 [trainer.py] => w_bn: 50.0
2025-01-11 11:44:10,984 [trainer.py] => w_noise: 0.001
2025-01-11 11:44:10,984 [trainer.py] => server_ss: 32
2025-01-11 11:44:10,984 [trainer.py] => bn_loss: 1
2025-01-11 11:44:10,984 [trainer.py] => noise: 1
2025-01-11 11:44:10,984 [trainer.py] => ie_loss: 1
2025-01-11 11:44:10,984 [trainer.py] => act_loss: 0
2025-01-11 11:44:10,984 [trainer.py] => w_ie: 1.0
2025-01-11 11:44:10,984 [trainer.py] => w_act: 0.1
2025-01-11 11:44:10,984 [trainer.py] => syn_size: 32
2025-01-11 11:44:10,984 [trainer.py] => need_syn_imgs: True
2025-01-11 11:44:10,984 [trainer.py] => g_local_bs: 5
2025-01-11 11:44:10,984 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-11 11:44:10,984 [trainer.py] => g_local_train_steps: 5
2025-01-11 11:44:10,984 [trainer.py] => dataset_syn: cifar100
2025-01-11 11:44:10,984 [trainer.py] => com_round_gen: 10
2025-01-11 11:44:10,984 [trainer.py] => g_sigma: 0
2025-01-11 11:44:10,984 [trainer.py] => save_cls_embeds: False
2025-01-11 11:44:10,984 [trainer.py] => syn_image_path: outputs/syn_image_60_5_pre0.0_local_bs5
2025-01-11 11:44:10,984 [trainer.py] => save_dir: outputs
2025-01-11 11:44:10,984 [trainer.py] => n_iter: 5
2025-01-11 11:44:10,984 [trainer.py] => num_users: 1
2025-01-11 11:44:10,984 [trainer.py] => cur_size: 50
2025-01-11 11:44:10,984 [trainer.py] => local_bs: 5
2025-01-11 11:44:10,984 [trainer.py] => pre_size: 48
2025-01-11 11:44:10,984 [trainer.py] => w_ce_pre: 0
2025-01-11 11:44:10,985 [trainer.py] => vpt_type: Deep
2025-01-11 11:44:10,985 [trainer.py] => prompt_token_num: 6
2025-01-11 11:44:10,985 [trainer.py] => avg_alpha: 0.8
2025-01-11 11:44:10,985 [trainer.py] => perturb_var: 1
2025-01-11 11:44:10,985 [trainer.py] => EMA_beta: 0.99
2025-01-11 11:44:10,985 [trainer.py] => anchor_lambda: 0.1
2025-01-11 11:44:10,985 [trainer.py] => kl_weight: 0.001
2025-01-11 11:44:10,985 [trainer.py] => TIP_init: zero
2025-01-11 11:44:10,985 [trainer.py] => tuned_epoch: 10
2025-01-11 11:44:10,985 [trainer.py] => fs_epoch: 0
2025-01-11 11:44:10,985 [trainer.py] => init_lr: 0.01
2025-01-11 11:44:10,985 [trainer.py] => fs_lr: 0.001
2025-01-11 11:44:10,985 [trainer.py] => batch_size: 48
2025-01-11 11:44:10,985 [trainer.py] => fs_batch_size: 16
2025-01-11 11:44:10,985 [trainer.py] => weight_decay: 0.0005
2025-01-11 11:44:10,985 [trainer.py] => min_lr: 0
2025-01-11 11:44:10,985 [trainer.py] => optimizer: sgd
2025-01-11 11:44:10,985 [trainer.py] => memory_size: 0
2025-01-11 11:44:10,985 [trainer.py] => memory_per_class: 0
2025-01-11 11:44:10,985 [trainer.py] => fixed_memory: False
2025-01-11 11:44:10,985 [trainer.py] => shuffle: False
2025-01-11 11:44:10,985 [trainer.py] => top_k: 5
2025-01-11 11:44:10,985 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-11 11:44:10,985 [trainer.py] => prefix: asp
2025-01-11 11:44:10,985 [trainer.py] => model_prefix: asp
2025-01-11 11:44:12,617 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-11 11:44:30,622 [trainer.py] => All params: 173596160
2025-01-11 11:44:30,623 [trainer.py] => Trainable params: 1998848
2025-01-11 11:44:50,001 [asp.py] => Learning on 0-60
2025-01-11 11:44:50,056 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-11 11:44:53,742 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-11 11:44:53,742 [trainer.py] => model_name: asp
2025-01-11 11:44:53,742 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-11 11:44:53,742 [trainer.py] => device: ['cuda']
2025-01-11 11:44:53,742 [trainer.py] => seed: 2024
2025-01-11 11:44:53,742 [trainer.py] => dataset: cifar224
2025-01-11 11:44:53,743 [trainer.py] => init_cls: 60
2025-01-11 11:44:53,743 [trainer.py] => increment: 5
2025-01-11 11:44:53,743 [trainer.py] => kshot: 5
2025-01-11 11:44:53,743 [trainer.py] => generator_model: CIFAR_GEN
2025-01-11 11:44:53,743 [trainer.py] => z_dim: 1000
2025-01-11 11:44:53,743 [trainer.py] => conv_dim: 64
2025-01-11 11:44:53,743 [trainer.py] => img_size: 224
2025-01-11 11:44:53,743 [trainer.py] => generator_lr: 0.005
2025-01-11 11:44:53,743 [trainer.py] => pi: 100
2025-01-11 11:44:53,743 [trainer.py] => w_bn: 50.0
2025-01-11 11:44:53,743 [trainer.py] => w_noise: 0.001
2025-01-11 11:44:53,743 [trainer.py] => server_ss: 32
2025-01-11 11:44:53,743 [trainer.py] => bn_loss: 1
2025-01-11 11:44:53,743 [trainer.py] => noise: 1
2025-01-11 11:44:53,743 [trainer.py] => ie_loss: 1
2025-01-11 11:44:53,743 [trainer.py] => act_loss: 0
2025-01-11 11:44:53,743 [trainer.py] => w_ie: 1.0
2025-01-11 11:44:53,743 [trainer.py] => w_act: 0.1
2025-01-11 11:44:53,743 [trainer.py] => syn_size: 32
2025-01-11 11:44:53,743 [trainer.py] => need_syn_imgs: True
2025-01-11 11:44:53,743 [trainer.py] => g_local_bs: 5
2025-01-11 11:44:53,743 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-11 11:44:53,743 [trainer.py] => g_local_train_steps: 5
2025-01-11 11:44:53,743 [trainer.py] => dataset_syn: cifar100
2025-01-11 11:44:53,743 [trainer.py] => com_round_gen: 10
2025-01-11 11:44:53,743 [trainer.py] => g_sigma: 0
2025-01-11 11:44:53,743 [trainer.py] => save_cls_embeds: False
2025-01-11 11:44:53,743 [trainer.py] => syn_image_path: outputs/syn_image_60_5_pre0.0_local_bs5
2025-01-11 11:44:53,743 [trainer.py] => save_dir: outputs
2025-01-11 11:44:53,743 [trainer.py] => n_iter: 5
2025-01-11 11:44:53,743 [trainer.py] => num_users: 1
2025-01-11 11:44:53,743 [trainer.py] => cur_size: 50
2025-01-11 11:44:53,743 [trainer.py] => local_bs: 5
2025-01-11 11:44:53,744 [trainer.py] => pre_size: 48
2025-01-11 11:44:53,744 [trainer.py] => w_ce_pre: 0
2025-01-11 11:44:53,744 [trainer.py] => vpt_type: Deep
2025-01-11 11:44:53,744 [trainer.py] => prompt_token_num: 6
2025-01-11 11:44:53,744 [trainer.py] => avg_alpha: 0.8
2025-01-11 11:44:53,744 [trainer.py] => perturb_var: 1
2025-01-11 11:44:53,744 [trainer.py] => EMA_beta: 0.99
2025-01-11 11:44:53,744 [trainer.py] => anchor_lambda: 0.1
2025-01-11 11:44:53,744 [trainer.py] => kl_weight: 0.001
2025-01-11 11:44:53,744 [trainer.py] => TIP_init: zero
2025-01-11 11:44:53,744 [trainer.py] => tuned_epoch: 10
2025-01-11 11:44:53,744 [trainer.py] => fs_epoch: 0
2025-01-11 11:44:53,744 [trainer.py] => init_lr: 0.01
2025-01-11 11:44:53,744 [trainer.py] => fs_lr: 0.001
2025-01-11 11:44:53,744 [trainer.py] => batch_size: 5
2025-01-11 11:44:53,744 [trainer.py] => fs_batch_size: 5
2025-01-11 11:44:53,744 [trainer.py] => weight_decay: 0.0005
2025-01-11 11:44:53,744 [trainer.py] => min_lr: 0
2025-01-11 11:44:53,744 [trainer.py] => optimizer: sgd
2025-01-11 11:44:53,744 [trainer.py] => memory_size: 0
2025-01-11 11:44:53,744 [trainer.py] => memory_per_class: 0
2025-01-11 11:44:53,744 [trainer.py] => fixed_memory: False
2025-01-11 11:44:53,744 [trainer.py] => shuffle: False
2025-01-11 11:44:53,744 [trainer.py] => top_k: 5
2025-01-11 11:44:53,744 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-11 11:44:53,744 [trainer.py] => prefix: asp
2025-01-11 11:44:53,744 [trainer.py] => model_prefix: asp
2025-01-11 11:44:55,369 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-11 11:45:04,184 [trainer.py] => All params: 173596160
2025-01-11 11:45:04,185 [trainer.py] => Trainable params: 1998848
2025-01-11 11:45:20,620 [asp.py] => Learning on 0-60
2025-01-11 11:45:20,682 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-11 11:59:23,082 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-11 11:59:23,083 [trainer.py] => model_name: asp
2025-01-11 11:59:23,083 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-11 11:59:23,083 [trainer.py] => device: ['cuda']
2025-01-11 11:59:23,083 [trainer.py] => seed: 2024
2025-01-11 11:59:23,083 [trainer.py] => dataset: cifar224
2025-01-11 11:59:23,083 [trainer.py] => init_cls: 60
2025-01-11 11:59:23,083 [trainer.py] => increment: 5
2025-01-11 11:59:23,083 [trainer.py] => kshot: 5
2025-01-11 11:59:23,083 [trainer.py] => generator_model: CIFAR_GEN
2025-01-11 11:59:23,083 [trainer.py] => z_dim: 1000
2025-01-11 11:59:23,083 [trainer.py] => conv_dim: 64
2025-01-11 11:59:23,083 [trainer.py] => img_size: 224
2025-01-11 11:59:23,083 [trainer.py] => generator_lr: 0.005
2025-01-11 11:59:23,083 [trainer.py] => pi: 100
2025-01-11 11:59:23,083 [trainer.py] => w_bn: 50.0
2025-01-11 11:59:23,083 [trainer.py] => w_noise: 0.001
2025-01-11 11:59:23,083 [trainer.py] => server_ss: 32
2025-01-11 11:59:23,083 [trainer.py] => bn_loss: 1
2025-01-11 11:59:23,083 [trainer.py] => noise: 1
2025-01-11 11:59:23,083 [trainer.py] => ie_loss: 1
2025-01-11 11:59:23,083 [trainer.py] => act_loss: 0
2025-01-11 11:59:23,083 [trainer.py] => w_ie: 1.0
2025-01-11 11:59:23,083 [trainer.py] => w_act: 0.1
2025-01-11 11:59:23,083 [trainer.py] => syn_size: 32
2025-01-11 11:59:23,083 [trainer.py] => need_syn_imgs: True
2025-01-11 11:59:23,083 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-11 11:59:23,083 [trainer.py] => g_local_train_steps: 5
2025-01-11 11:59:23,084 [trainer.py] => dataset_syn: cifar100
2025-01-11 11:59:23,084 [trainer.py] => com_round_gen: 10
2025-01-11 11:59:23,084 [trainer.py] => g_sigma: 0
2025-01-11 11:59:23,084 [trainer.py] => save_cls_embeds: False
2025-01-11 11:59:23,084 [trainer.py] => syn_image_path: outputs/syn_image_60_5_pre0.0_local_bs48_5
2025-01-11 11:59:23,084 [trainer.py] => save_dir: outputs
2025-01-11 11:59:23,084 [trainer.py] => n_iter: 5
2025-01-11 11:59:23,084 [trainer.py] => num_users: 1
2025-01-11 11:59:23,084 [trainer.py] => cur_size: 50
2025-01-11 11:59:23,084 [trainer.py] => g_local_bs: 5
2025-01-11 11:59:23,084 [trainer.py] => local_bs0: 48
2025-01-11 11:59:23,084 [trainer.py] => local_bs1: 5
2025-01-11 11:59:23,084 [trainer.py] => pre_size: 48
2025-01-11 11:59:23,084 [trainer.py] => w_ce_pre: 0
2025-01-11 11:59:23,084 [trainer.py] => vpt_type: Deep
2025-01-11 11:59:23,084 [trainer.py] => prompt_token_num: 6
2025-01-11 11:59:23,084 [trainer.py] => avg_alpha: 0.8
2025-01-11 11:59:23,084 [trainer.py] => perturb_var: 1
2025-01-11 11:59:23,084 [trainer.py] => EMA_beta: 0.99
2025-01-11 11:59:23,084 [trainer.py] => anchor_lambda: 0.1
2025-01-11 11:59:23,084 [trainer.py] => kl_weight: 0.001
2025-01-11 11:59:23,084 [trainer.py] => TIP_init: zero
2025-01-11 11:59:23,084 [trainer.py] => tuned_epoch: 10
2025-01-11 11:59:23,084 [trainer.py] => fs_epoch: 0
2025-01-11 11:59:23,084 [trainer.py] => init_lr: 0.01
2025-01-11 11:59:23,084 [trainer.py] => fs_lr: 0.001
2025-01-11 11:59:23,084 [trainer.py] => batch_size: 48
2025-01-11 11:59:23,084 [trainer.py] => fs_batch_size: 16
2025-01-11 11:59:23,084 [trainer.py] => weight_decay: 0.0005
2025-01-11 11:59:23,084 [trainer.py] => min_lr: 0
2025-01-11 11:59:23,084 [trainer.py] => optimizer: sgd
2025-01-11 11:59:23,084 [trainer.py] => memory_size: 0
2025-01-11 11:59:23,084 [trainer.py] => memory_per_class: 0
2025-01-11 11:59:23,085 [trainer.py] => fixed_memory: False
2025-01-11 11:59:23,085 [trainer.py] => shuffle: False
2025-01-11 11:59:23,085 [trainer.py] => top_k: 5
2025-01-11 11:59:23,085 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-11 11:59:23,085 [trainer.py] => prefix: asp
2025-01-11 11:59:23,085 [trainer.py] => model_prefix: asp
2025-01-11 11:59:24,539 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-11 11:59:33,595 [trainer.py] => All params: 173596160
2025-01-11 11:59:33,596 [trainer.py] => Trainable params: 1998848
2025-01-11 11:59:49,170 [asp.py] => Learning on 0-60
2025-01-11 11:59:49,237 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-11 12:03:02,211 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-11 12:03:02,211 [trainer.py] => model_name: asp
2025-01-11 12:03:02,211 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-11 12:03:02,211 [trainer.py] => device: ['cuda']
2025-01-11 12:03:02,211 [trainer.py] => seed: 2024
2025-01-11 12:03:02,211 [trainer.py] => dataset: cifar224
2025-01-11 12:03:02,211 [trainer.py] => init_cls: 60
2025-01-11 12:03:02,211 [trainer.py] => increment: 5
2025-01-11 12:03:02,211 [trainer.py] => kshot: 5
2025-01-11 12:03:02,211 [trainer.py] => generator_model: CIFAR_GEN
2025-01-11 12:03:02,211 [trainer.py] => z_dim: 1000
2025-01-11 12:03:02,211 [trainer.py] => conv_dim: 64
2025-01-11 12:03:02,211 [trainer.py] => img_size: 224
2025-01-11 12:03:02,211 [trainer.py] => generator_lr: 0.005
2025-01-11 12:03:02,211 [trainer.py] => pi: 100
2025-01-11 12:03:02,211 [trainer.py] => w_bn: 50.0
2025-01-11 12:03:02,211 [trainer.py] => w_noise: 0.001
2025-01-11 12:03:02,211 [trainer.py] => server_ss: 32
2025-01-11 12:03:02,211 [trainer.py] => bn_loss: 1
2025-01-11 12:03:02,212 [trainer.py] => noise: 1
2025-01-11 12:03:02,212 [trainer.py] => ie_loss: 1
2025-01-11 12:03:02,212 [trainer.py] => act_loss: 0
2025-01-11 12:03:02,212 [trainer.py] => w_ie: 1.0
2025-01-11 12:03:02,212 [trainer.py] => w_act: 0.1
2025-01-11 12:03:02,212 [trainer.py] => syn_size: 32
2025-01-11 12:03:02,212 [trainer.py] => need_syn_imgs: True
2025-01-11 12:03:02,212 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-11 12:03:02,212 [trainer.py] => g_local_train_steps: 5
2025-01-11 12:03:02,212 [trainer.py] => dataset_syn: cifar100
2025-01-11 12:03:02,212 [trainer.py] => com_round_gen: 10
2025-01-11 12:03:02,212 [trainer.py] => g_sigma: 0
2025-01-11 12:03:02,212 [trainer.py] => save_cls_embeds: False
2025-01-11 12:03:02,212 [trainer.py] => syn_image_path: outputs/syn_image_60_5_pre0.0_local_bs48_5
2025-01-11 12:03:02,212 [trainer.py] => save_dir: outputs
2025-01-11 12:03:02,212 [trainer.py] => n_iter: 5
2025-01-11 12:03:02,212 [trainer.py] => num_users: 1
2025-01-11 12:03:02,212 [trainer.py] => cur_size: 50
2025-01-11 12:03:02,212 [trainer.py] => g_local_bs: 5
2025-01-11 12:03:02,212 [trainer.py] => local_bs0: 48
2025-01-11 12:03:02,212 [trainer.py] => local_bs1: 5
2025-01-11 12:03:02,212 [trainer.py] => pre_size: 48
2025-01-11 12:03:02,212 [trainer.py] => w_ce_pre: 0
2025-01-11 12:03:02,212 [trainer.py] => vpt_type: Deep
2025-01-11 12:03:02,212 [trainer.py] => prompt_token_num: 6
2025-01-11 12:03:02,212 [trainer.py] => avg_alpha: 0.8
2025-01-11 12:03:02,212 [trainer.py] => perturb_var: 1
2025-01-11 12:03:02,212 [trainer.py] => EMA_beta: 0.99
2025-01-11 12:03:02,212 [trainer.py] => anchor_lambda: 0.1
2025-01-11 12:03:02,212 [trainer.py] => kl_weight: 0.001
2025-01-11 12:03:02,212 [trainer.py] => TIP_init: zero
2025-01-11 12:03:02,212 [trainer.py] => tuned_epoch: 10
2025-01-11 12:03:02,213 [trainer.py] => fs_epoch: 0
2025-01-11 12:03:02,213 [trainer.py] => init_lr: 0.01
2025-01-11 12:03:02,213 [trainer.py] => fs_lr: 0.001
2025-01-11 12:03:02,213 [trainer.py] => batch_size: 48
2025-01-11 12:03:02,213 [trainer.py] => fs_batch_size: 16
2025-01-11 12:03:02,213 [trainer.py] => weight_decay: 0.0005
2025-01-11 12:03:02,213 [trainer.py] => min_lr: 0
2025-01-11 12:03:02,213 [trainer.py] => optimizer: sgd
2025-01-11 12:03:02,213 [trainer.py] => memory_size: 0
2025-01-11 12:03:02,213 [trainer.py] => memory_per_class: 0
2025-01-11 12:03:02,213 [trainer.py] => fixed_memory: False
2025-01-11 12:03:02,213 [trainer.py] => shuffle: False
2025-01-11 12:03:02,213 [trainer.py] => top_k: 5
2025-01-11 12:03:02,213 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-11 12:03:02,213 [trainer.py] => prefix: asp
2025-01-11 12:03:02,213 [trainer.py] => model_prefix: asp
2025-01-11 12:03:04,027 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-11 12:03:13,572 [trainer.py] => All params: 173596160
2025-01-11 12:03:13,573 [trainer.py] => Trainable params: 1998848
2025-01-11 12:03:31,399 [asp.py] => Learning on 0-60
2025-01-11 12:03:31,501 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-11 14:50:14,710 [asp.py] => total parameters: 173642241
2025-01-11 14:50:14,711 [asp.py] => trainable parameters: 2044929
2025-01-11 15:01:51,576 [asp.py] => Task 0, Epoch 1 => Loss 4.207, Train_accy 1.62, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 15:08:15,385 [asp.py] => total parameters: 173642241
2025-01-11 15:08:15,386 [asp.py] => trainable parameters: 2044929
2025-01-11 15:13:31,972 [asp.py] => Task 0, Epoch 2 => Loss 4.141, Train_accy 1.62, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 15:17:14,143 [asp.py] => total parameters: 173642241
2025-01-11 15:17:14,144 [asp.py] => trainable parameters: 2044929
2025-01-11 15:20:04,161 [asp.py] => Task 0, Epoch 1 => Loss 4.090, Train_accy 17.14, Test_curr_accy 77.03, Test_accy 77.03
2025-01-11 15:24:37,881 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-11 15:24:37,881 [trainer.py] => model_name: asp
2025-01-11 15:24:37,881 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-11 15:24:37,881 [trainer.py] => device: ['cuda']
2025-01-11 15:24:37,882 [trainer.py] => seed: 2024
2025-01-11 15:24:37,882 [trainer.py] => dataset: cifar224
2025-01-11 15:24:37,882 [trainer.py] => init_cls: 60
2025-01-11 15:24:37,882 [trainer.py] => increment: 5
2025-01-11 15:24:37,882 [trainer.py] => kshot: 5
2025-01-11 15:24:37,882 [trainer.py] => generator_model: CIFAR_GEN
2025-01-11 15:24:37,882 [trainer.py] => z_dim: 1000
2025-01-11 15:24:37,882 [trainer.py] => conv_dim: 64
2025-01-11 15:24:37,882 [trainer.py] => img_size: 224
2025-01-11 15:24:37,882 [trainer.py] => generator_lr: 0.005
2025-01-11 15:24:37,882 [trainer.py] => pi: 100
2025-01-11 15:24:37,882 [trainer.py] => w_bn: 50.0
2025-01-11 15:24:37,882 [trainer.py] => w_noise: 0.001
2025-01-11 15:24:37,882 [trainer.py] => server_ss: 32
2025-01-11 15:24:37,882 [trainer.py] => bn_loss: 1
2025-01-11 15:24:37,882 [trainer.py] => noise: 1
2025-01-11 15:24:37,882 [trainer.py] => ie_loss: 1
2025-01-11 15:24:37,882 [trainer.py] => act_loss: 0
2025-01-11 15:24:37,882 [trainer.py] => w_ie: 1.0
2025-01-11 15:24:37,882 [trainer.py] => w_act: 0.1
2025-01-11 15:24:37,882 [trainer.py] => syn_size: 32
2025-01-11 15:24:37,882 [trainer.py] => need_syn_imgs: True
2025-01-11 15:24:37,883 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-11 15:24:37,883 [trainer.py] => g_local_train_steps: 5
2025-01-11 15:24:37,883 [trainer.py] => dataset_syn: cifar100
2025-01-11 15:24:37,883 [trainer.py] => com_round_gen: 10
2025-01-11 15:24:37,883 [trainer.py] => g_sigma: 0
2025-01-11 15:24:37,883 [trainer.py] => save_cls_embeds: False
2025-01-11 15:24:37,883 [trainer.py] => syn_image_path: outputs/syn_image_60_5_pre0.0_local_bs48_5
2025-01-11 15:24:37,883 [trainer.py] => save_dir: outputs
2025-01-11 15:24:37,883 [trainer.py] => n_iter: 5
2025-01-11 15:24:37,883 [trainer.py] => num_users: 1
2025-01-11 15:24:37,883 [trainer.py] => cur_size: 50
2025-01-11 15:24:37,883 [trainer.py] => g_local_bs: 5
2025-01-11 15:24:37,883 [trainer.py] => local_bs0: 48
2025-01-11 15:24:37,883 [trainer.py] => local_bs1: 16
2025-01-11 15:24:37,883 [trainer.py] => pre_size: 48
2025-01-11 15:24:37,883 [trainer.py] => w_ce_pre: 0
2025-01-11 15:24:37,883 [trainer.py] => vpt_type: Deep
2025-01-11 15:24:37,883 [trainer.py] => prompt_token_num: 6
2025-01-11 15:24:37,883 [trainer.py] => avg_alpha: 0.8
2025-01-11 15:24:37,883 [trainer.py] => perturb_var: 1
2025-01-11 15:24:37,883 [trainer.py] => EMA_beta: 0.99
2025-01-11 15:24:37,883 [trainer.py] => anchor_lambda: 0.1
2025-01-11 15:24:37,883 [trainer.py] => kl_weight: 0.001
2025-01-11 15:24:37,883 [trainer.py] => TIP_init: zero
2025-01-11 15:24:37,883 [trainer.py] => tuned_epoch: 10
2025-01-11 15:24:37,884 [trainer.py] => fs_epoch: 0
2025-01-11 15:24:37,884 [trainer.py] => init_lr: 0.01
2025-01-11 15:24:37,884 [trainer.py] => fs_lr: 0.001
2025-01-11 15:24:37,884 [trainer.py] => batch_size: 48
2025-01-11 15:24:37,884 [trainer.py] => fs_batch_size: 16
2025-01-11 15:24:37,884 [trainer.py] => weight_decay: 0.0005
2025-01-11 15:24:37,884 [trainer.py] => min_lr: 0
2025-01-11 15:24:37,884 [trainer.py] => optimizer: sgd
2025-01-11 15:24:37,884 [trainer.py] => memory_size: 0
2025-01-11 15:24:37,884 [trainer.py] => memory_per_class: 0
2025-01-11 15:24:37,884 [trainer.py] => fixed_memory: False
2025-01-11 15:24:37,884 [trainer.py] => shuffle: False
2025-01-11 15:24:37,884 [trainer.py] => top_k: 5
2025-01-11 15:24:37,884 [trainer.py] => base_model_path: saved_model/asp/cifar224/60_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-11 15:24:37,884 [trainer.py] => prefix: asp
2025-01-11 15:24:37,884 [trainer.py] => model_prefix: asp
2025-01-11 15:24:39,665 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
2025-01-11 15:24:49,613 [trainer.py] => All params: 173596160
2025-01-11 15:24:49,614 [trainer.py] => Trainable params: 1998848
2025-01-11 15:25:09,085 [asp.py] => Learning on 0-60
2025-01-11 15:25:09,160 [asp.py] => training set size: 30000, fc construct set size: 30000
2025-01-11 15:25:09,542 [asp.py] => Task 0, Epoch 3 => Loss 4.142, Train_accy 1.57, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 15:29:16,967 [asp.py] => Task 0, Epoch 1 => Loss 4.576, Train_accy 1.66, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 15:31:52,091 [asp.py] => Task 0, Epoch 2 => Loss 1.268, Train_accy 74.40, Test_curr_accy 90.95, Test_accy 90.95
2025-01-11 15:36:50,496 [asp.py] => Task 0, Epoch 4 => Loss 4.139, Train_accy 1.64, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 15:41:16,234 [asp.py] => Task 0, Epoch 2 => Loss 4.185, Train_accy 2.33, Test_curr_accy 4.43, Test_accy 4.43
2025-01-11 15:43:35,022 [asp.py] => Task 0, Epoch 3 => Loss 0.903, Train_accy 79.52, Test_curr_accy 91.78, Test_accy 91.78
2025-01-11 15:48:26,689 [asp.py] => Task 0, Epoch 5 => Loss 4.137, Train_accy 1.65, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 15:53:12,775 [asp.py] => Task 0, Epoch 3 => Loss 4.003, Train_accy 5.89, Test_curr_accy 13.87, Test_accy 13.87
2025-01-11 15:55:20,189 [asp.py] => Task 0, Epoch 4 => Loss 0.823, Train_accy 80.59, Test_curr_accy 92.33, Test_accy 92.33
2025-01-11 16:00:09,477 [asp.py] => Task 0, Epoch 6 => Loss 4.137, Train_accy 1.60, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 16:05:10,015 [asp.py] => Task 0, Epoch 4 => Loss 3.017, Train_accy 32.76, Test_curr_accy 69.95, Test_accy 69.95
2025-01-11 16:07:02,841 [asp.py] => Task 0, Epoch 5 => Loss 0.799, Train_accy 81.27, Test_curr_accy 92.53, Test_accy 92.53
2025-01-11 16:11:48,935 [asp.py] => Task 0, Epoch 7 => Loss 4.136, Train_accy 1.58, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 16:17:09,372 [asp.py] => Task 0, Epoch 5 => Loss 2.194, Train_accy 55.52, Test_curr_accy 77.00, Test_accy 77.00
2025-01-11 16:18:46,270 [asp.py] => Task 0, Epoch 6 => Loss 0.770, Train_accy 81.53, Test_curr_accy 92.53, Test_accy 92.53
2025-01-11 16:23:27,873 [asp.py] => Task 0, Epoch 8 => Loss 4.135, Train_accy 1.76, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 16:29:08,645 [asp.py] => Task 0, Epoch 6 => Loss 1.889, Train_accy 61.64, Test_curr_accy 79.37, Test_accy 79.37
2025-01-11 16:30:33,599 [asp.py] => Task 0, Epoch 7 => Loss 0.733, Train_accy 82.09, Test_curr_accy 92.70, Test_accy 92.70
2025-01-11 16:35:10,033 [asp.py] => Task 0, Epoch 9 => Loss 4.133, Train_accy 1.62, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 16:41:03,308 [asp.py] => Task 0, Epoch 7 => Loss 1.757, Train_accy 64.14, Test_curr_accy 81.93, Test_accy 81.93
2025-01-11 16:42:16,499 [asp.py] => Task 0, Epoch 8 => Loss 0.723, Train_accy 82.65, Test_curr_accy 92.98, Test_accy 92.98
2025-01-11 16:46:51,201 [asp.py] => Task 0, Epoch 10 => Loss 4.131, Train_accy 1.62, Test_curr_accy 1.67, Test_accy 1.67
2025-01-11 16:51:02,984 [trainer.py] => Top1 curve: [0.02]
2025-01-11 16:51:02,984 [trainer.py] => Average Accuracy (Top1): 0.02   (Harmonic Accuracy): None (Old Acc): 0.016666666666666666 (New Acc): [] 

2025-01-11 16:51:02,985 [trainer.py] => All params: 173642241
2025-01-11 16:51:02,986 [trainer.py] => Trainable params: 2044929
2025-01-11 16:51:33,917 [asp.py] => Learning on 60-65
2025-01-11 16:51:33,936 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 16:53:03,160 [asp.py] => Task 0, Epoch 8 => Loss 1.642, Train_accy 65.70, Test_curr_accy 81.13, Test_accy 81.13
2025-01-11 16:54:04,893 [asp.py] => Task 0, Epoch 9 => Loss 0.711, Train_accy 83.07, Test_curr_accy 92.95, Test_accy 92.95
2025-01-11 17:05:06,075 [asp.py] => Task 0, Epoch 9 => Loss 1.584, Train_accy 66.88, Test_curr_accy 83.82, Test_accy 83.82
2025-01-11 17:05:48,648 [asp.py] => Task 0, Epoch 10 => Loss 0.701, Train_accy 82.95, Test_curr_accy 92.98, Test_accy 92.98
2025-01-11 17:07:13,169 [asp.py] => total parameters: 173646081
2025-01-11 17:07:13,170 [asp.py] => trainable parameters: 2048769
2025-01-11 17:07:46,878 [trainer.py] => Top1 curve: [0.02, 0.0]
2025-01-11 17:07:46,879 [trainer.py] => Average Accuracy (Top1): 0.01   (Harmonic Accuracy): nan (Old Acc): 0.0 (New Acc): 0.0 

2025-01-11 17:07:46,880 [trainer.py] => All params: 173646081
2025-01-11 17:07:46,880 [trainer.py] => Trainable params: 2048769
2025-01-11 17:08:35,372 [asp.py] => Learning on 65-70
2025-01-11 17:08:35,405 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 17:11:27,001 [trainer.py] => Top1 curve: [91.5]
2025-01-11 17:11:27,002 [trainer.py] => Average Accuracy (Top1): 91.5   (Harmonic Accuracy): None (Old Acc): 91.5 (New Acc): [] 

2025-01-11 17:11:27,003 [trainer.py] => All params: 173642241
2025-01-11 17:11:27,004 [trainer.py] => Trainable params: 2044929
2025-01-11 17:11:49,584 [asp.py] => Learning on 60-65
2025-01-11 17:11:49,599 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 17:17:10,724 [asp.py] => Task 0, Epoch 10 => Loss 1.667, Train_accy 65.22, Test_curr_accy 76.85, Test_accy 76.85
2025-01-11 17:21:07,665 [trainer.py] => Top1 curve: [50.62]
2025-01-11 17:21:07,665 [trainer.py] => Average Accuracy (Top1): 50.62   (Harmonic Accuracy): None (Old Acc): 50.616666666666674 (New Acc): [] 

2025-01-11 17:21:07,666 [trainer.py] => All params: 173642241
2025-01-11 17:21:07,667 [trainer.py] => Trainable params: 2044929
2025-01-11 17:21:26,008 [asp.py] => Learning on 60-65
2025-01-11 17:21:26,034 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 17:25:52,603 [asp.py] => total parameters: 173649921
2025-01-11 17:25:52,604 [asp.py] => trainable parameters: 2052609
2025-01-11 17:28:38,051 [trainer.py] => Top1 curve: [0.02, 0.0, 0.4]
2025-01-11 17:28:38,051 [trainer.py] => Average Accuracy (Top1): 0.14   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 2.8 

2025-01-11 17:28:38,052 [trainer.py] => All params: 173649921
2025-01-11 17:28:38,053 [trainer.py] => Trainable params: 2052609
2025-01-11 17:29:28,538 [asp.py] => Learning on 70-75
2025-01-11 17:29:28,562 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 17:36:53,083 [asp.py] => total parameters: 173646081
2025-01-11 17:36:53,084 [asp.py] => trainable parameters: 2048769
2025-01-11 17:37:24,766 [trainer.py] => Top1 curve: [50.62, 47.68]
2025-01-11 17:37:24,767 [trainer.py] => Average Accuracy (Top1): 49.15   (Harmonic Accuracy): 29.947988774555657 (Old Acc): 49.86666666666667 (New Acc): 21.4 

2025-01-11 17:37:24,768 [trainer.py] => All params: 173646081
2025-01-11 17:37:24,768 [trainer.py] => Trainable params: 2048769
2025-01-11 17:38:37,438 [asp.py] => Learning on 65-70
2025-01-11 17:38:37,465 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 17:47:59,653 [asp.py] => total parameters: 173646081
2025-01-11 17:47:59,654 [asp.py] => trainable parameters: 2048769
2025-01-11 17:48:59,871 [trainer.py] => Top1 curve: [91.5, 90.03]
2025-01-11 17:48:59,873 [trainer.py] => Average Accuracy (Top1): 90.765   (Harmonic Accuracy): 81.77141705301351 (Old Acc): 91.36666666666667 (New Acc): 74.0 

2025-01-11 17:48:59,875 [trainer.py] => All params: 173646081
2025-01-11 17:48:59,876 [trainer.py] => Trainable params: 2048769
2025-01-11 17:49:24,717 [asp.py] => Learning on 65-70
2025-01-11 17:49:24,746 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 18:04:45,229 [asp.py] => total parameters: 173653761
2025-01-11 18:04:45,229 [asp.py] => trainable parameters: 2056449
2025-01-11 18:06:17,928 [trainer.py] => Top1 curve: [0.02, 0.0, 0.4, 0.37]
2025-01-11 18:06:17,928 [trainer.py] => Average Accuracy (Top1): 0.1975   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 1.8666666666666665 

2025-01-11 18:06:17,929 [trainer.py] => All params: 173653761
2025-01-11 18:06:17,930 [trainer.py] => Trainable params: 2056449
2025-01-11 18:06:49,552 [asp.py] => Learning on 75-80
2025-01-11 18:06:49,579 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 18:10:34,997 [asp.py] => total parameters: 173649921
2025-01-11 18:10:34,998 [asp.py] => trainable parameters: 2052609
2025-01-11 18:11:45,195 [trainer.py] => Top1 curve: [50.62, 47.68, 46.03]
2025-01-11 18:11:45,196 [trainer.py] => Average Accuracy (Top1): 48.10999999999999   (Harmonic Accuracy): 34.386261558784675 (Old Acc): 49.29999999999999 (New Acc): 26.4 

2025-01-11 18:11:45,197 [trainer.py] => All params: 173649921
2025-01-11 18:11:45,198 [trainer.py] => Trainable params: 2052609
2025-01-11 18:12:12,655 [asp.py] => Learning on 70-75
2025-01-11 18:12:12,695 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 18:24:34,921 [asp.py] => total parameters: 173649921
2025-01-11 18:24:34,923 [asp.py] => trainable parameters: 2052609
2025-01-11 18:25:54,832 [trainer.py] => Top1 curve: [91.5, 90.03, 89.59]
2025-01-11 18:25:54,833 [trainer.py] => Average Accuracy (Top1): 90.37333333333333   (Harmonic Accuracy): 84.82783696608348 (Old Acc): 91.31666666666668 (New Acc): 79.19999999999999 

2025-01-11 18:25:54,834 [trainer.py] => All params: 173649921
2025-01-11 18:25:54,834 [trainer.py] => Trainable params: 2052609
2025-01-11 18:26:15,537 [asp.py] => Learning on 70-75
2025-01-11 18:26:15,564 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 18:39:59,252 [asp.py] => total parameters: 173657601
2025-01-11 18:39:59,253 [asp.py] => trainable parameters: 2060289
2025-01-11 18:41:56,866 [trainer.py] => Top1 curve: [0.02, 0.0, 0.4, 0.37, 0.35]
2025-01-11 18:41:56,867 [trainer.py] => Average Accuracy (Top1): 0.22800000000000004   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 1.4 

2025-01-11 18:41:56,868 [trainer.py] => All params: 173657601
2025-01-11 18:41:56,868 [trainer.py] => Trainable params: 2060289
2025-01-11 18:42:15,427 [asp.py] => Learning on 80-85
2025-01-11 18:42:15,448 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 18:44:53,409 [asp.py] => total parameters: 173653761
2025-01-11 18:44:53,410 [asp.py] => trainable parameters: 2056449
2025-01-11 18:46:01,477 [trainer.py] => Top1 curve: [50.62, 47.68, 46.03, 43.77]
2025-01-11 18:46:01,477 [trainer.py] => Average Accuracy (Top1): 47.025   (Harmonic Accuracy): 31.817905638665128 (Old Acc): 48.81666666666667 (New Acc): 23.599999999999998 

2025-01-11 18:46:01,478 [trainer.py] => All params: 173653761
2025-01-11 18:46:01,479 [trainer.py] => Trainable params: 2056449
2025-01-11 18:46:27,997 [asp.py] => Learning on 75-80
2025-01-11 18:46:28,025 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 19:00:08,353 [asp.py] => total parameters: 173653761
2025-01-11 19:00:08,354 [asp.py] => trainable parameters: 2056449
2025-01-11 19:01:17,711 [trainer.py] => Top1 curve: [91.5, 90.03, 89.59, 88.19]
2025-01-11 19:01:17,711 [trainer.py] => Average Accuracy (Top1): 89.8275   (Harmonic Accuracy): 83.34535226182204 (Old Acc): 91.0166666666667 (New Acc): 76.86666666666666 

2025-01-11 19:01:17,712 [trainer.py] => All params: 173653761
2025-01-11 19:01:17,713 [trainer.py] => Trainable params: 2056449
2025-01-11 19:01:44,523 [asp.py] => Learning on 75-80
2025-01-11 19:01:44,555 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 19:15:54,184 [asp.py] => total parameters: 173661441
2025-01-11 19:15:54,185 [asp.py] => trainable parameters: 2064129
2025-01-11 19:17:38,318 [trainer.py] => Top1 curve: [0.02, 0.0, 0.4, 0.37, 0.35, 0.33]
2025-01-11 19:17:38,319 [trainer.py] => Average Accuracy (Top1): 0.24500000000000002   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 1.1199999999999999 

2025-01-11 19:17:38,320 [trainer.py] => All params: 173661441
2025-01-11 19:17:38,320 [trainer.py] => Trainable params: 2064129
2025-01-11 19:18:17,106 [asp.py] => Learning on 85-90
2025-01-11 19:18:17,146 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 19:20:09,311 [asp.py] => total parameters: 173657601
2025-01-11 19:20:09,312 [asp.py] => trainable parameters: 2060289
2025-01-11 19:21:35,798 [trainer.py] => Top1 curve: [50.62, 47.68, 46.03, 43.77, 42.2]
2025-01-11 19:21:35,799 [trainer.py] => Average Accuracy (Top1): 46.06   (Harmonic Accuracy): 31.052238805970145 (Old Acc): 48.666666666666664 (New Acc): 22.8 

2025-01-11 19:21:35,800 [trainer.py] => All params: 173657601
2025-01-11 19:21:35,801 [trainer.py] => Trainable params: 2060289
2025-01-11 19:21:57,744 [asp.py] => Learning on 80-85
2025-01-11 19:21:57,772 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 19:32:29,050 [asp.py] => total parameters: 173642241
2025-01-11 19:32:29,051 [asp.py] => trainable parameters: 2044929
2025-01-11 19:36:13,547 [asp.py] => total parameters: 173657601
2025-01-11 19:36:13,548 [asp.py] => trainable parameters: 2060289
2025-01-11 19:37:41,849 [trainer.py] => Top1 curve: [91.5, 90.03, 89.59, 88.19, 88.22]
2025-01-11 19:37:41,849 [trainer.py] => Average Accuracy (Top1): 89.506   (Harmonic Accuracy): 85.17357240304035 (Old Acc): 90.93333333333334 (New Acc): 80.1 

2025-01-11 19:37:41,851 [trainer.py] => All params: 173657601
2025-01-11 19:37:41,851 [trainer.py] => Trainable params: 2060289
2025-01-11 19:38:01,396 [asp.py] => Learning on 80-85
2025-01-11 19:38:01,423 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 19:51:25,848 [asp.py] => total parameters: 173665281
2025-01-11 19:51:25,849 [asp.py] => trainable parameters: 2067969
2025-01-11 19:53:31,701 [trainer.py] => Top1 curve: [0.02, 0.0, 0.4, 0.37, 0.35, 0.33, 0.31]
2025-01-11 19:53:31,701 [trainer.py] => Average Accuracy (Top1): 0.25428571428571434   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 0.9333333333333332 

2025-01-11 19:53:31,702 [trainer.py] => All params: 173665281
2025-01-11 19:53:31,703 [trainer.py] => Trainable params: 2067969
2025-01-11 19:53:59,671 [asp.py] => Learning on 90-95
2025-01-11 19:53:59,700 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 19:54:44,540 [asp.py] => total parameters: 173661441
2025-01-11 19:54:44,541 [asp.py] => trainable parameters: 2064129
2025-01-11 19:56:01,715 [trainer.py] => Top1 curve: [50.62, 47.68, 46.03, 43.77, 42.2, 40.41]
2025-01-11 19:56:01,715 [trainer.py] => Average Accuracy (Top1): 45.11833333333334   (Harmonic Accuracy): 29.876042362369997 (Old Acc): 48.23333333333333 (New Acc): 21.64 

2025-01-11 19:56:01,716 [trainer.py] => All params: 173661441
2025-01-11 19:56:01,717 [trainer.py] => Trainable params: 2064129
2025-01-11 19:56:20,005 [asp.py] => Learning on 85-90
2025-01-11 19:56:20,035 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 19:59:24,012 [asp.py] => Task 0, Epoch 1 => Loss 4.577, Train_accy 1.60, Test_curr_accy 1.73, Test_accy 1.73
2025-01-11 20:11:51,840 [asp.py] => total parameters: 173661441
2025-01-11 20:11:51,841 [asp.py] => trainable parameters: 2064129
2025-01-11 20:13:09,723 [trainer.py] => Top1 curve: [91.5, 90.03, 89.59, 88.19, 88.22, 87.49]
2025-01-11 20:13:09,724 [trainer.py] => Average Accuracy (Top1): 89.17   (Harmonic Accuracy): 84.80920403850668 (Old Acc): 90.80000000000001 (New Acc): 79.55999999999999 

2025-01-11 20:13:09,725 [trainer.py] => All params: 173661441
2025-01-11 20:13:09,726 [trainer.py] => Trainable params: 2064129
2025-01-11 20:13:32,152 [asp.py] => Learning on 85-90
2025-01-11 20:13:32,179 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 20:26:26,594 [asp.py] => Task 0, Epoch 2 => Loss 4.192, Train_accy 2.48, Test_curr_accy 4.03, Test_accy 4.03
2025-01-11 20:26:33,723 [asp.py] => total parameters: 173669121
2025-01-11 20:26:33,724 [asp.py] => trainable parameters: 2071809
2025-01-11 20:28:24,860 [trainer.py] => Top1 curve: [0.02, 0.0, 0.4, 0.37, 0.35, 0.33, 0.31, 0.29]
2025-01-11 20:28:24,861 [trainer.py] => Average Accuracy (Top1): 0.25875000000000004   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 0.7999999999999999 

2025-01-11 20:28:24,862 [trainer.py] => All params: 173669121
2025-01-11 20:28:24,863 [trainer.py] => Trainable params: 2071809
2025-01-11 20:28:53,811 [asp.py] => Learning on 95-100
2025-01-11 20:28:53,835 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 20:30:17,129 [asp.py] => total parameters: 173665281
2025-01-11 20:30:17,129 [asp.py] => trainable parameters: 2067969
2025-01-11 20:31:56,932 [trainer.py] => Top1 curve: [50.62, 47.68, 46.03, 43.77, 42.2, 40.41, 39.16]
2025-01-11 20:31:56,933 [trainer.py] => Average Accuracy (Top1): 44.26714285714286   (Harmonic Accuracy): 31.763918982571827 (Old Acc): 46.699999999999996 (New Acc): 24.066666666666666 

2025-01-11 20:31:56,934 [trainer.py] => All params: 173665281
2025-01-11 20:31:56,935 [trainer.py] => Trainable params: 2067969
2025-01-11 20:32:23,555 [asp.py] => Learning on 90-95
2025-01-11 20:32:23,596 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 20:46:35,202 [asp.py] => total parameters: 173665281
2025-01-11 20:46:35,203 [asp.py] => trainable parameters: 2067969
2025-01-11 20:48:12,094 [trainer.py] => Top1 curve: [91.5, 90.03, 89.59, 88.19, 88.22, 87.49, 87.5]
2025-01-11 20:48:12,094 [trainer.py] => Average Accuracy (Top1): 88.93142857142857   (Harmonic Accuracy): 85.67627359710369 (Old Acc): 90.63333333333333 (New Acc): 81.23333333333333 

2025-01-11 20:48:12,095 [trainer.py] => All params: 173665281
2025-01-11 20:48:12,096 [trainer.py] => Trainable params: 2067969
2025-01-11 20:48:31,337 [asp.py] => Learning on 90-95
2025-01-11 20:48:31,370 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 20:53:28,008 [asp.py] => Task 0, Epoch 3 => Loss 3.768, Train_accy 11.91, Test_curr_accy 39.28, Test_accy 39.28
2025-01-11 21:00:35,980 [asp.py] => total parameters: 173672961
2025-01-11 21:00:35,981 [asp.py] => trainable parameters: 2075649
2025-01-11 21:02:50,462 [trainer.py] => Top1 curve: [0.02, 0.0, 0.4, 0.37, 0.35, 0.33, 0.31, 0.29, 0.28]
2025-01-11 21:02:50,463 [trainer.py] => Average Accuracy (Top1): 0.2611111111111112   (Harmonic Accuracy): 0.0 (Old Acc): 0.0 (New Acc): 0.7 

2025-01-11 21:02:50,463 [trainer.py] => 

2025-01-11 21:06:31,596 [asp.py] => total parameters: 173669121
2025-01-11 21:06:31,597 [asp.py] => trainable parameters: 2071809
2025-01-11 21:07:56,589 [trainer.py] => Top1 curve: [50.62, 47.68, 46.03, 43.77, 42.2, 40.41, 39.16, 37.59]
2025-01-11 21:07:56,590 [trainer.py] => Average Accuracy (Top1): 43.432500000000005   (Harmonic Accuracy): 30.447585183139434 (Old Acc): 46.28333333333333 (New Acc): 22.685714285714287 

2025-01-11 21:07:56,591 [trainer.py] => All params: 173669121
2025-01-11 21:07:56,591 [trainer.py] => Trainable params: 2071809
2025-01-11 21:08:19,634 [asp.py] => Learning on 95-100
2025-01-11 21:08:19,668 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 21:20:40,879 [asp.py] => Task 0, Epoch 4 => Loss 2.564, Train_accy 46.01, Test_curr_accy 72.20, Test_accy 72.20
2025-01-11 21:22:48,955 [asp.py] => total parameters: 173669121
2025-01-11 21:22:48,956 [asp.py] => trainable parameters: 2071809
2025-01-11 21:24:19,030 [trainer.py] => Top1 curve: [91.5, 90.03, 89.59, 88.19, 88.22, 87.49, 87.5, 87.24]
2025-01-11 21:24:19,030 [trainer.py] => Average Accuracy (Top1): 88.72   (Harmonic Accuracy): 85.8181999280635 (Old Acc): 90.56666666666666 (New Acc): 81.54285714285713 

2025-01-11 21:24:19,031 [trainer.py] => All params: 173669121
2025-01-11 21:24:19,032 [trainer.py] => Trainable params: 2071809
2025-01-11 21:24:39,377 [asp.py] => Learning on 95-100
2025-01-11 21:24:39,403 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 21:41:27,711 [asp.py] => total parameters: 173672961
2025-01-11 21:41:27,712 [asp.py] => trainable parameters: 2075649
2025-01-11 21:43:14,415 [trainer.py] => Top1 curve: [50.62, 47.68, 46.03, 43.77, 42.2, 40.41, 39.16, 37.59, 35.92]
2025-01-11 21:43:14,416 [trainer.py] => Average Accuracy (Top1): 42.597777777777786   (Harmonic Accuracy): 29.576175120922738 (Old Acc): 45.21666666666667 (New Acc): 21.975 

2025-01-11 21:43:14,416 [trainer.py] => 

2025-01-11 21:47:58,440 [asp.py] => Task 0, Epoch 5 => Loss 2.124, Train_accy 57.70, Test_curr_accy 75.93, Test_accy 75.93
2025-01-11 21:57:16,012 [asp.py] => total parameters: 173672961
2025-01-11 21:57:16,013 [asp.py] => trainable parameters: 2075649
2025-01-11 21:58:04,506 [trainer.py] => Top1 curve: [91.5, 90.03, 89.59, 88.19, 88.22, 87.49, 87.5, 87.24, 86.11]
2025-01-11 21:58:04,506 [trainer.py] => Average Accuracy (Top1): 88.43   (Harmonic Accuracy): 84.7129391014649 (Old Acc): 90.36666666666667 (New Acc): 79.725 

2025-01-11 21:58:04,506 [trainer.py] => 

2025-01-11 22:10:17,429 [asp.py] => Task 0, Epoch 6 => Loss 1.858, Train_accy 62.39, Test_curr_accy 81.27, Test_accy 81.27
2025-01-11 22:23:04,898 [asp.py] => Task 0, Epoch 7 => Loss 1.723, Train_accy 64.51, Test_curr_accy 82.95, Test_accy 82.95
2025-01-11 22:36:03,409 [asp.py] => Task 0, Epoch 8 => Loss 1.647, Train_accy 66.01, Test_curr_accy 82.98, Test_accy 82.98
2025-01-11 22:49:06,162 [asp.py] => Task 0, Epoch 9 => Loss 1.566, Train_accy 66.97, Test_curr_accy 83.27, Test_accy 83.27
2025-01-11 23:01:59,710 [asp.py] => Task 0, Epoch 10 => Loss 1.632, Train_accy 66.40, Test_curr_accy 81.75, Test_accy 81.75
2025-01-11 23:06:10,880 [trainer.py] => Top1 curve: [78.75]
2025-01-11 23:06:10,880 [trainer.py] => Average Accuracy (Top1): 78.75   (Harmonic Accuracy): None (Old Acc): 78.75 (New Acc): [] 

2025-01-11 23:06:10,881 [trainer.py] => All params: 173642241
2025-01-11 23:06:10,882 [trainer.py] => Trainable params: 2044929
2025-01-11 23:06:31,005 [asp.py] => Learning on 60-65
2025-01-11 23:06:31,026 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 23:22:52,004 [asp.py] => total parameters: 173646081
2025-01-11 23:22:52,008 [asp.py] => trainable parameters: 2048769
2025-01-11 23:23:26,013 [trainer.py] => Top1 curve: [78.75, 74.95]
2025-01-11 23:23:26,013 [trainer.py] => Average Accuracy (Top1): 76.85   (Harmonic Accuracy): 50.75458213256485 (Old Acc): 78.06666666666666 (New Acc): 37.6 

2025-01-11 23:23:26,014 [trainer.py] => All params: 173646081
2025-01-11 23:23:26,015 [trainer.py] => Trainable params: 2048769
2025-01-11 23:23:46,799 [asp.py] => Learning on 65-70
2025-01-11 23:23:46,821 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 23:40:06,967 [asp.py] => total parameters: 173649921
2025-01-11 23:40:06,969 [asp.py] => trainable parameters: 2052609
2025-01-11 23:40:42,642 [trainer.py] => Top1 curve: [78.75, 74.95, 72.63]
2025-01-11 23:40:42,642 [trainer.py] => Average Accuracy (Top1): 75.44333333333333   (Harmonic Accuracy): 54.53452115812918 (Old Acc): 77.73333333333333 (New Acc): 42.0 

2025-01-11 23:40:42,643 [trainer.py] => All params: 173649921
2025-01-11 23:40:42,645 [trainer.py] => Trainable params: 2052609
2025-01-11 23:41:02,872 [asp.py] => Learning on 70-75
2025-01-11 23:41:02,898 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-11 23:57:23,407 [asp.py] => total parameters: 173653761
2025-01-11 23:57:23,409 [asp.py] => trainable parameters: 2056449
2025-01-11 23:58:01,429 [trainer.py] => Top1 curve: [78.75, 74.95, 72.63, 69.41]
2025-01-11 23:58:01,430 [trainer.py] => Average Accuracy (Top1): 73.935   (Harmonic Accuracy): 51.22541239840331 (Old Acc): 77.18333333333334 (New Acc): 38.33333333333333 

2025-01-11 23:58:01,431 [trainer.py] => All params: 173653761
2025-01-11 23:58:01,431 [trainer.py] => Trainable params: 2056449
2025-01-11 23:58:21,136 [asp.py] => Learning on 75-80
2025-01-11 23:58:21,164 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-12 00:14:41,420 [asp.py] => total parameters: 173657601
2025-01-12 00:14:41,421 [asp.py] => trainable parameters: 2060289
2025-01-12 00:15:21,605 [trainer.py] => Top1 curve: [78.75, 74.95, 72.63, 69.41, 67.5]
2025-01-12 00:15:21,605 [trainer.py] => Average Accuracy (Top1): 72.648   (Harmonic Accuracy): 51.81613042229244 (Old Acc): 76.98333333333333 (New Acc): 39.05 

2025-01-12 00:15:21,606 [trainer.py] => All params: 173657601
2025-01-12 00:15:21,607 [trainer.py] => Trainable params: 2060289
2025-01-12 00:15:42,110 [asp.py] => Learning on 80-85
2025-01-12 00:15:42,136 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-12 00:32:02,809 [asp.py] => total parameters: 173661441
2025-01-12 00:32:02,810 [asp.py] => trainable parameters: 2064129
2025-01-12 00:32:45,663 [trainer.py] => Top1 curve: [78.75, 74.95, 72.63, 69.41, 67.5, 64.92]
2025-01-12 00:32:45,663 [trainer.py] => Average Accuracy (Top1): 71.36   (Harmonic Accuracy): 50.148647460508194 (Old Acc): 76.41666666666666 (New Acc): 37.32 

2025-01-12 00:32:45,664 [trainer.py] => All params: 173661441
2025-01-12 00:32:45,665 [trainer.py] => Trainable params: 2064129
2025-01-12 00:33:05,817 [asp.py] => Learning on 85-90
2025-01-12 00:33:05,848 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-12 00:49:23,556 [asp.py] => total parameters: 173665281
2025-01-12 00:49:23,557 [asp.py] => trainable parameters: 2067969
2025-01-12 00:50:08,756 [trainer.py] => Top1 curve: [78.75, 74.95, 72.63, 69.41, 67.5, 64.92, 63.12]
2025-01-12 00:50:08,757 [trainer.py] => Average Accuracy (Top1): 70.18285714285715   (Harmonic Accuracy): 50.17945628214549 (Old Acc): 75.95 (New Acc): 37.46666666666667 

2025-01-12 00:50:08,758 [trainer.py] => All params: 173665281
2025-01-12 00:50:08,759 [trainer.py] => Trainable params: 2067969
2025-01-12 00:50:28,744 [asp.py] => Learning on 90-95
2025-01-12 00:50:28,776 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-12 01:06:46,827 [asp.py] => total parameters: 173669121
2025-01-12 01:06:46,828 [asp.py] => trainable parameters: 2071809
2025-01-12 01:07:34,980 [trainer.py] => Top1 curve: [78.75, 74.95, 72.63, 69.41, 67.5, 64.92, 63.12, 61.63]
2025-01-12 01:07:34,980 [trainer.py] => Average Accuracy (Top1): 69.11375000000001   (Harmonic Accuracy): 50.493278740157486 (Old Acc): 75.45 (New Acc): 37.94285714285714 

2025-01-12 01:07:34,982 [trainer.py] => All params: 173669121
2025-01-12 01:07:34,983 [trainer.py] => Trainable params: 2071809
2025-01-12 01:07:56,642 [asp.py] => Learning on 95-100
2025-01-12 01:07:56,686 [asp.py] => training set size: 25, fc construct set size: 25
2025-01-12 01:24:16,520 [asp.py] => total parameters: 173672961
2025-01-12 01:24:16,522 [asp.py] => trainable parameters: 2075649
2025-01-12 01:25:06,355 [trainer.py] => Top1 curve: [78.75, 74.95, 72.63, 69.41, 67.5, 64.92, 63.12, 61.63, 59.97]
2025-01-12 01:25:06,355 [trainer.py] => Average Accuracy (Top1): 68.0977777777778   (Harmonic Accuracy): 49.98888394842152 (Old Acc): 74.95 (New Acc): 37.5 

2025-01-12 01:25:06,355 [trainer.py] => 

