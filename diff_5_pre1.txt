nohup: ignoring input
2025-01-10 18:27:58,321 [trainer.py] => config: ldm/ldm_dddr.yaml
2025-01-10 18:27:58,321 [trainer.py] => model_name: asp
2025-01-10 18:27:58,321 [trainer.py] => backbone_type: pretrained_vit_b16_224_vpt
2025-01-10 18:27:58,321 [trainer.py] => device: ['cuda']
2025-01-10 18:27:58,321 [trainer.py] => seed: 2024
2025-01-10 18:27:58,321 [trainer.py] => dataset: cifar224
2025-01-10 18:27:58,321 [trainer.py] => init_cls: 5
2025-01-10 18:27:58,321 [trainer.py] => increment: 5
2025-01-10 18:27:58,321 [trainer.py] => kshot: 5
2025-01-10 18:27:58,322 [trainer.py] => generator_model: CIFAR_GEN
2025-01-10 18:27:58,322 [trainer.py] => z_dim: 1000
2025-01-10 18:27:58,322 [trainer.py] => conv_dim: 64
2025-01-10 18:27:58,322 [trainer.py] => img_size: 224
2025-01-10 18:27:58,322 [trainer.py] => generator_lr: 0.005
2025-01-10 18:27:58,322 [trainer.py] => pi: 100
2025-01-10 18:27:58,322 [trainer.py] => w_bn: 50.0
2025-01-10 18:27:58,322 [trainer.py] => w_noise: 0.001
2025-01-10 18:27:58,322 [trainer.py] => server_ss: 32
2025-01-10 18:27:58,322 [trainer.py] => bn_loss: 1
2025-01-10 18:27:58,322 [trainer.py] => noise: 1
2025-01-10 18:27:58,322 [trainer.py] => ie_loss: 1
2025-01-10 18:27:58,322 [trainer.py] => act_loss: 0
2025-01-10 18:27:58,322 [trainer.py] => w_ie: 1.0
2025-01-10 18:27:58,322 [trainer.py] => w_act: 0.1
2025-01-10 18:27:58,322 [trainer.py] => syn_size: 32
2025-01-10 18:27:58,322 [trainer.py] => need_syn_imgs: True
2025-01-10 18:27:58,322 [trainer.py] => g_local_bs: 5
2025-01-10 18:27:58,322 [trainer.py] => ldm_ckpt: models/ldm/text2img-large/model.ckpt
2025-01-10 18:27:58,322 [trainer.py] => g_local_train_steps: 5
2025-01-10 18:27:58,322 [trainer.py] => dataset_syn: cifar100
2025-01-10 18:27:58,322 [trainer.py] => com_round_gen: 10
2025-01-10 18:27:58,322 [trainer.py] => g_sigma: 0
2025-01-10 18:27:58,322 [trainer.py] => save_cls_embeds: False
2025-01-10 18:27:58,322 [trainer.py] => syn_image_path: outputs/syn_image_5_pre1
2025-01-10 18:27:58,322 [trainer.py] => save_dir: outputs
2025-01-10 18:27:58,322 [trainer.py] => n_iter: 5
2025-01-10 18:27:58,322 [trainer.py] => num_users: 1
2025-01-10 18:27:58,323 [trainer.py] => cur_size: 50
2025-01-10 18:27:58,323 [trainer.py] => local_bs: 5
2025-01-10 18:27:58,323 [trainer.py] => pre_size: 48
2025-01-10 18:27:58,323 [trainer.py] => w_ce_pre: 0.3
2025-01-10 18:27:58,323 [trainer.py] => vpt_type: Deep
2025-01-10 18:27:58,323 [trainer.py] => prompt_token_num: 6
2025-01-10 18:27:58,323 [trainer.py] => avg_alpha: 0.8
2025-01-10 18:27:58,323 [trainer.py] => perturb_var: 1
2025-01-10 18:27:58,323 [trainer.py] => EMA_beta: 0.99
2025-01-10 18:27:58,323 [trainer.py] => anchor_lambda: 0.1
2025-01-10 18:27:58,323 [trainer.py] => kl_weight: 0.001
2025-01-10 18:27:58,323 [trainer.py] => TIP_init: zero
2025-01-10 18:27:58,323 [trainer.py] => tuned_epoch: 10
2025-01-10 18:27:58,323 [trainer.py] => fs_epoch: 0
2025-01-10 18:27:58,323 [trainer.py] => init_lr: 0.01
2025-01-10 18:27:58,323 [trainer.py] => fs_lr: 0.001
2025-01-10 18:27:58,323 [trainer.py] => batch_size: 48
2025-01-10 18:27:58,323 [trainer.py] => fs_batch_size: 16
2025-01-10 18:27:58,323 [trainer.py] => weight_decay: 0.0005
2025-01-10 18:27:58,323 [trainer.py] => min_lr: 0
2025-01-10 18:27:58,323 [trainer.py] => optimizer: sgd
2025-01-10 18:27:58,323 [trainer.py] => memory_size: 0
2025-01-10 18:27:58,323 [trainer.py] => memory_per_class: 0
2025-01-10 18:27:58,323 [trainer.py] => fixed_memory: False
2025-01-10 18:27:58,323 [trainer.py] => shuffle: False
2025-01-10 18:27:58,323 [trainer.py] => top_k: 5
2025-01-10 18:27:58,323 [trainer.py] => base_model_path: saved_model/asp/cifar224/5_5/asp_10_2024_pretrained_vit_b16_224_vpt.pth
2025-01-10 18:27:58,323 [trainer.py] => prefix: asp
2025-01-10 18:27:58,323 [trainer.py] => model_prefix: asp
Files already downloaded and verified
Files already downloaded and verified
2025-01-10 18:27:59,881 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
/mnt/share/yinjunhui/anaconda3/envs/cl/lib/python3.9/site-packages/fairscale/experimental/nn/offload.py:19: FutureWarning: `torch.cuda.amp.custom_fwd(args...)` is deprecated. Please use `torch.amp.custom_fwd(args..., device_type='cuda')` instead.
  return torch.cuda.amp.custom_fwd(orig_func)  # type: ignore
/mnt/share/yinjunhui/anaconda3/envs/cl/lib/python3.9/site-packages/fairscale/experimental/nn/offload.py:30: FutureWarning: `torch.cuda.amp.custom_bwd(args...)` is deprecated. Please use `torch.amp.custom_bwd(args..., device_type='cuda')` instead.
  return torch.cuda.amp.custom_bwd(orig_func)  # type: ignore
/mnt/share/yinjunhui/anaconda3/envs/cl/lib/python3.9/site-packages/pytorch_lightning/metrics/__init__.py:43: LightningDeprecationWarning: `pytorch_lightning.metrics.*` module has been renamed to `torchmetrics.*` and split off to its own package (https://github.com/PyTorchLightning/metrics) since v1.3 and will be removed in v1.5
  rank_zero_deprecation(
2025-01-10 18:28:01.281620: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:485] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-01-10 18:28:01.297121: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:8454] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-01-10 18:28:01.301935: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1452] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-01-10 18:28:01.314341: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-01-10 18:28:02.141916: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
/mnt/share/yinjunhui/cl/FSCIL-Diff/ldm/models/diffusion/ddpm.py:197: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  sd = torch.load(path, map_location="cpu")
/mnt/share/yinjunhui/cl/FSCIL-Diff/models/asp.py:499: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  torch.load(self.args['ldm_ckpt'], map_location="cpu")["state_dict"],
This is for the BaseNet initialization.
modelname, pretrained_vit_b16_224_vpt basicmodelname vit_base_patch16_224
Using VPT model
Using Deep Prompt
After BaseNet initialization.
LatentDiffusion: Running in eps-prediction mode
DiffusionWrapper has 872.30 M params.
making attention of type 'vanilla' with 512 in_channels
Working with z of shape (1, 4, 16, 16) = 1024 dimensions.
making attention of type 'vanilla' with 512 in_channels
Restored from models/ldm/text2img-large/model.ckpt with 0 missing and 2 unexpected keys
Unexpected Keys: ['model_ema.decay', 'model_ema.num_updates']
Setting learning rate to 2.00e-02 =  4 (batchsize) * 5.00e-03 (base_lr)
2025-01-10 18:28:26,619 [trainer.py] => All params: 173596160
2025-01-10 18:28:26,621 [trainer.py] => Trainable params: 1998848
2025-01-10 18:28:26,621 [asp.py] => Learning on 0-5
2025-01-10 18:28:26,658 [asp.py] => training set size: 2500, fc construct set size: 2500
Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:34<02:16, 34.06s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:09<01:44, 34.83s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:46<01:11, 35.71s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:23<00:36, 36.53s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:02<00:00, 37.29s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:02<00:00, 36.52s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:36, 39.23s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.27s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.36s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.41s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.40s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:16<00:00, 39.37s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.64s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.57s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.53s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.53s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.53s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.54s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.62s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.54s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.54s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.54s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.51s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.53s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.69s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.56s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.55s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.52s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.51s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.53s/it]
2025-01-10 18:44:43,925 [asp.py] => total parameters: 173600001
2025-01-10 18:44:43,926 [asp.py] => trainable parameters: 2002689
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 3840
fc.sigma 1
anchor samples found
2025-01-10 18:45:53,356 [asp.py] => Task 0, Epoch 1 => Loss 1.603, Train_accy 61.60, Test_curr_accy 97.00, Test_accy 97.00
anchor samples found
2025-01-10 18:47:01,917 [asp.py] => Task 0, Epoch 2 => Loss 0.667, Train_accy 89.93, Test_curr_accy 97.20, Test_accy 97.20
anchor samples found
2025-01-10 18:48:10,620 [asp.py] => Task 0, Epoch 3 => Loss 0.583, Train_accy 91.45, Test_curr_accy 98.00, Test_accy 98.00
anchor samples found
2025-01-10 18:49:19,307 [asp.py] => Task 0, Epoch 4 => Loss 0.465, Train_accy 92.15, Test_curr_accy 99.00, Test_accy 99.00
anchor samples found
2025-01-10 18:50:27,771 [asp.py] => Task 0, Epoch 5 => Loss 0.388, Train_accy 92.95, Test_curr_accy 99.00, Test_accy 99.00
anchor samples found
2025-01-10 18:51:36,331 [asp.py] => Task 0, Epoch 6 => Loss 0.375, Train_accy 93.09, Test_curr_accy 95.40, Test_accy 95.40
anchor samples found
2025-01-10 18:52:44,597 [asp.py] => Task 0, Epoch 7 => Loss 0.282, Train_accy 94.55, Test_curr_accy 98.40, Test_accy 98.40
anchor samples found
2025-01-10 18:53:52,892 [asp.py] => Task 0, Epoch 8 => Loss 0.274, Train_accy 94.36, Test_curr_accy 91.40, Test_accy 91.40
anchor samples found
2025-01-10 18:55:01,679 [asp.py] => Task 0, Epoch 9 => Loss 0.239, Train_accy 94.87, Test_curr_accy 98.00, Test_accy 98.00
anchor samples found
2025-01-10 18:56:10,595 [asp.py] => Task 0, Epoch 10 => Loss 0.229, Train_accy 95.24, Test_curr_accy 87.80, Test_accy 87.80
2025-01-10 18:56:38,012 [trainer.py] => Top1 curve: [99.2]
2025-01-10 18:56:38,012 [trainer.py] => Average Accuracy (Top1): 99.2   (Harmonic Accuracy): None (Old Acc): 99.2 (New Acc): [] 

2025-01-10 18:56:38,014 [trainer.py] => All params: 173600001
2025-01-10 18:56:38,014 [trainer.py] => Trainable params: 2002689
2025-01-10 18:56:38,016 [asp.py] => Learning on 5-10
2025-01-10 18:56:38,038 [asp.py] => training set size: 25, fc construct set size: 25

Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][AClass Inversion:   0%|          | 0/10 [28:11<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.58s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.67s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.78s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.83s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.88s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.82s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.06s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.92s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.89s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.87s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.84s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.87s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.03s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.90s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.90s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.89s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.88s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.89s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.95s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.93s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.90s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.90s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.89s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.90s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.04s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.94s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.87s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.88s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.87s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.89s/it]
2025-01-10 19:13:19,522 [asp.py] => total parameters: 173603841
2025-01-10 19:13:19,523 [asp.py] => trainable parameters: 2006529
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 7680
fc.sigma 1
2025-01-10 19:13:26,410 [trainer.py] => Top1 curve: [99.2, 97.6]
2025-01-10 19:13:26,410 [trainer.py] => Average Accuracy (Top1): 98.4   (Harmonic Accuracy): 97.58524590163935 (Old Acc): 98.8 (New Acc): 96.4 

2025-01-10 19:13:26,411 [trainer.py] => All params: 173603841
2025-01-10 19:13:26,412 [trainer.py] => Trainable params: 2006529
2025-01-10 19:13:26,413 [asp.py] => Learning on 10-15
2025-01-10 19:13:26,423 [asp.py] => training set size: 25, fc construct set size: 25
Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.94s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.86s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.90s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.90s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.90s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.90s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.07s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.97s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.94s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.93s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.93s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.94s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.99s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.95s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.91s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.88s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.84s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.88s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.01s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.96s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.94s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.93s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.91s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.93s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.11s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.98s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.95s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.94s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.93s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.95s/it]
2025-01-10 19:30:08,883 [asp.py] => total parameters: 173607681
2025-01-10 19:30:08,884 [asp.py] => trainable parameters: 2010369
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 11520
fc.sigma 1
2025-01-10 19:30:18,151 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73]
2025-01-10 19:30:18,151 [trainer.py] => Average Accuracy (Top1): 95.84333333333335   (Harmonic Accuracy): 92.16311519740401 (Old Acc): 97.6 (New Acc): 87.30000000000001 

2025-01-10 19:30:18,152 [trainer.py] => All params: 173607681
2025-01-10 19:30:18,153 [trainer.py] => Trainable params: 2010369
2025-01-10 19:30:18,154 [asp.py] => Learning on 15-20
2025-01-10 19:30:18,166 [asp.py] => training set size: 25, fc construct set size: 25


Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A[A


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.78s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.80s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.79s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.83s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.82s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.81s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.98s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.92s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.93s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.93s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.93s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.93s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.03s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.92s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.92s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.93s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.93s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.94s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.01s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.90s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.89s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.89s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.87s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.88s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.06s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.95s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.87s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.89s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.89s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.90s/it]
2025-01-10 19:47:00,270 [asp.py] => total parameters: 173611521
2025-01-10 19:47:00,271 [asp.py] => trainable parameters: 2014209
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 15360
fc.sigma 1
2025-01-10 19:47:12,065 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1]
2025-01-10 19:47:12,065 [trainer.py] => Average Accuracy (Top1): 93.9075   (Harmonic Accuracy): 90.77850877192982 (Old Acc): 97.4 (New Acc): 85.0 

2025-01-10 19:47:12,067 [trainer.py] => All params: 173611521
2025-01-10 19:47:12,067 [trainer.py] => Trainable params: 2014209
2025-01-10 19:47:12,069 [asp.py] => Learning on 20-25
2025-01-10 19:47:12,085 [asp.py] => training set size: 25, fc construct set size: 25



Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A[A[A



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A



Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.03s/it][A[A[A[A



Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.02s/it][A[A[A[A



Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:00<01:20, 40.01s/it][A[A[A[A



Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:40<00:40, 40.01s/it][A[A[A[A



Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.01s/it][A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.01s/it]




Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A



Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.22s/it][A[A[A[A



Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.10s/it][A[A[A[A



Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:00<01:20, 40.02s/it][A[A[A[A



Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:40<00:39, 39.99s/it][A[A[A[A



Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 39.98s/it][A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.01s/it]




Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A



Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.13s/it][A[A[A[A



Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.02s/it][A[A[A[A



Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.96s/it][A[A[A[A



Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.93s/it][A[A[A[A



Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.92s/it][A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.95s/it]




Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A



Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.24s/it][A[A[A[A



Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.12s/it][A[A[A[A



Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:00<01:20, 40.06s/it][A[A[A[A



Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:40<00:40, 40.01s/it][A[A[A[A



Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 39.99s/it][A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.03s/it]




Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A



Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.09s/it][A[A[A[A



Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.95s/it][A[A[A[A



Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.90s/it][A[A[A[A



Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.88s/it][A[A[A[A



Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.87s/it][A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.89s/it]
2025-01-10 20:03:56,268 [asp.py] => total parameters: 173615361
2025-01-10 20:03:56,269 [asp.py] => trainable parameters: 2018049
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 19200
fc.sigma 1
2025-01-10 20:04:10,589 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32]
2025-01-10 20:04:10,589 [trainer.py] => Average Accuracy (Top1): 92.59   (Harmonic Accuracy): 90.54755360087961 (Old Acc): 97.0 (New Acc): 84.9 

2025-01-10 20:04:10,591 [trainer.py] => All params: 173615361
2025-01-10 20:04:10,592 [trainer.py] => Trainable params: 2018049
2025-01-10 20:04:10,593 [asp.py] => Learning on 25-30
2025-01-10 20:04:10,608 [asp.py] => training set size: 25, fc construct set size: 25




Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A[A[A[A




Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A




Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.74s/it][A[A[A[A[A




Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.76s/it][A[A[A[A[A




Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.81s/it][A[A[A[A[A




Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.83s/it][A[A[A[A[A




Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.86s/it][A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.83s/it]





Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A




Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.09s/it][A[A[A[A[A




Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.97s/it][A[A[A[A[A




Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.94s/it][A[A[A[A[A




Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.95s/it][A[A[A[A[A




Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.94s/it][A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.95s/it]





Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A




Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.06s/it][A[A[A[A[A




Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.97s/it][A[A[A[A[A




Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.97s/it][A[A[A[A[A




Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.93s/it][A[A[A[A[A




Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.95s/it][A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.96s/it]





Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A




Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.02s/it][A[A[A[A[A




Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.98s/it][A[A[A[A[A




Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.93s/it][A[A[A[A[A




Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.92s/it][A[A[A[A[A




Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.93s/it][A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.94s/it]





Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A




Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.04s/it][A[A[A[A[A




Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.95s/it][A[A[A[A[A




Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.97s/it][A[A[A[A[A




Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.94s/it][A[A[A[A[A




Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.94s/it][A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.95s/it]
2025-01-10 20:20:54,002 [asp.py] => total parameters: 173619201
2025-01-10 20:20:54,003 [asp.py] => trainable parameters: 2021889
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 23040
fc.sigma 1
2025-01-10 20:21:10,651 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33]
2025-01-10 20:21:10,651 [trainer.py] => Average Accuracy (Top1): 91.04666666666667   (Harmonic Accuracy): 87.86594399277327 (Old Acc): 96.4 (New Acc): 80.72 

2025-01-10 20:21:10,652 [trainer.py] => All params: 173619201
2025-01-10 20:21:10,652 [trainer.py] => Trainable params: 2021889
2025-01-10 20:21:10,654 [asp.py] => Learning on 30-35
2025-01-10 20:21:10,676 [asp.py] => training set size: 25, fc construct set size: 25





Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A[A[A[A[A





Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A[A





Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.83s/it][A[A[A[A[A[A





Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.77s/it][A[A[A[A[A[A





Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.81s/it][A[A[A[A[A[A





Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.83s/it][A[A[A[A[A[A





Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.83s/it][A[A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.82s/it]






Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A[A





Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.11s/it][A[A[A[A[A[A





Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<01:59, 39.99s/it][A[A[A[A[A[A





Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.92s/it][A[A[A[A[A[A





Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.91s/it][A[A[A[A[A[A





Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.92s/it][A[A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.94s/it]






Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A[A





Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.15s/it][A[A[A[A[A[A





Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.07s/it][A[A[A[A[A[A





Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:00<01:20, 40.06s/it][A[A[A[A[A[A





Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:40<00:40, 40.02s/it][A[A[A[A[A[A





Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.02s/it][A[A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.04s/it]






Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A[A





Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.16s/it][A[A[A[A[A[A





Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.00s/it][A[A[A[A[A[A





Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.98s/it][A[A[A[A[A[A





Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.94s/it][A[A[A[A[A[A





Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.90s/it][A[A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.94s/it]






Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A[A





Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.07s/it][A[A[A[A[A[A





Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.97s/it][A[A[A[A[A[A





Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.92s/it][A[A[A[A[A[A





Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.93s/it][A[A[A[A[A[A





Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.95s/it][A[A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.95s/it]
2025-01-10 20:37:55,435 [asp.py] => total parameters: 173623041
2025-01-10 20:37:55,436 [asp.py] => trainable parameters: 2025729
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 26880
fc.sigma 1
2025-01-10 20:38:14,904 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8]
2025-01-10 20:38:14,904 [trainer.py] => Average Accuracy (Top1): 89.72571428571428   (Harmonic Accuracy): 87.05799355205765 (Old Acc): 96.4 (New Acc): 79.36666666666667 

2025-01-10 20:38:14,906 [trainer.py] => All params: 173623041
2025-01-10 20:38:14,907 [trainer.py] => Trainable params: 2025729
2025-01-10 20:38:14,908 [asp.py] => Learning on 35-40
2025-01-10 20:38:14,921 [asp.py] => training set size: 25, fc construct set size: 25






Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A[A[A[A[A[AClass Inversion:   0%|          | 0/10 [1:41:37<?, ?it/s]
Class Inversion:   0%|          | 0/10 [1:24:48<?, ?it/s]
Class Inversion:   0%|          | 0/10 [1:07:57<?, ?it/s]
Class Inversion:   0%|          | 0/10 [51:03<?, ?it/s]
Class Inversion:   0%|          | 0/10 [34:04<?, ?it/s]
Class Inversion:   0%|          | 0/10 [17:04<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.78s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.81s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.85s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.89s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.88s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.87s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.06s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.96s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.91s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.86s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.85s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.89s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.95s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.87s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.86s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.82s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.84s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.85s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.97s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.93s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.91s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.88s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.84s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.87s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.06s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.93s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.91s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.85s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.83s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.87s/it]
2025-01-10 20:54:57,550 [asp.py] => total parameters: 173626881
2025-01-10 20:54:57,552 [asp.py] => trainable parameters: 2029569
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 30720
fc.sigma 1
2025-01-10 20:55:19,709 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18]
2025-01-10 20:55:19,710 [trainer.py] => Average Accuracy (Top1): 88.5325   (Harmonic Accuracy): 85.57035566583953 (Old Acc): 94.6 (New Acc): 78.11428571428571 

2025-01-10 20:55:19,711 [trainer.py] => All params: 173626881
2025-01-10 20:55:19,711 [trainer.py] => Trainable params: 2029569
2025-01-10 20:55:19,713 [asp.py] => Learning on 40-45
2025-01-10 20:55:19,745 [asp.py] => training set size: 25, fc construct set size: 25
Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.38s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.45s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.55s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.53s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.53s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.52s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.63s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.55s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.52s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.50s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.50s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.51s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.68s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.58s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.57s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.56s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.54s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.56s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.66s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.57s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.55s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.53s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.51s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.54s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.64s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.55s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.53s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.54s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.50s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.53s/it]
2025-01-10 21:11:54,024 [asp.py] => total parameters: 173630721
2025-01-10 21:11:54,025 [asp.py] => trainable parameters: 2033409
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 34560
fc.sigma 1
2025-01-10 21:12:18,394 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8]
2025-01-10 21:12:18,394 [trainer.py] => Average Accuracy (Top1): 87.4511111111111   (Harmonic Accuracy): 84.66023673827269 (Old Acc): 94.2 (New Acc): 76.875 

2025-01-10 21:12:18,395 [trainer.py] => All params: 173630721
2025-01-10 21:12:18,396 [trainer.py] => Trainable params: 2033409
2025-01-10 21:12:18,397 [asp.py] => Learning on 45-50
2025-01-10 21:12:18,427 [asp.py] => training set size: 25, fc construct set size: 25

Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.51s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.42s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.47s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.46s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.47s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.46s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.62s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.56s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.53s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.52s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.53s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.54s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.63s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.53s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.54s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.52s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.51s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.53s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.66s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.55s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.53s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.51s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.55s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.55s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.70s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.59s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.55s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.55s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.55s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.56s/it]
2025-01-10 21:28:51,904 [asp.py] => total parameters: 173634561
2025-01-10 21:28:51,905 [asp.py] => trainable parameters: 2037249
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 38400
fc.sigma 1
2025-01-10 21:29:22,165 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04]
2025-01-10 21:29:22,165 [trainer.py] => Average Accuracy (Top1): 86.41   (Harmonic Accuracy): 83.5932283464567 (Old Acc): 94.2 (New Acc): 75.13333333333334 

2025-01-10 21:29:22,167 [trainer.py] => All params: 173634561
2025-01-10 21:29:22,167 [trainer.py] => Trainable params: 2037249
2025-01-10 21:29:22,169 [asp.py] => Learning on 50-55
2025-01-10 21:29:22,181 [asp.py] => training set size: 25, fc construct set size: 25


Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A[A


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.38s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:58, 39.43s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.45s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.43s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.45s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.44s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.62s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.55s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:18, 39.47s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.47s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.47s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.49s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.60s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.52s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.50s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.48s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.47s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.49s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.59s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.49s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.52s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.51s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.50s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.51s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.70s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.56s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.52s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.50s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.51s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.53s/it]
2025-01-10 21:45:55,747 [asp.py] => total parameters: 173638401
2025-01-10 21:45:55,748 [asp.py] => trainable parameters: 2041089
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 42240
fc.sigma 1
2025-01-10 21:46:24,936 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84]
2025-01-10 21:46:24,937 [trainer.py] => Average Accuracy (Top1): 85.53999999999999   (Harmonic Accuracy): 83.37255273761555 (Old Acc): 93.6 (New Acc): 75.16 

2025-01-10 21:46:24,938 [trainer.py] => All params: 173638401
2025-01-10 21:46:24,939 [trainer.py] => Trainable params: 2041089
2025-01-10 21:46:24,940 [asp.py] => Learning on 55-60
2025-01-10 21:46:24,953 [asp.py] => training set size: 25, fc construct set size: 25



Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A[A[A



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A



Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.81s/it][A[A[A[A



Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.80s/it][A[A[A[A



Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.78s/it][A[A[A[A



Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.79s/it][A[A[A[A



Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.81s/it][A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.80s/it]




Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A



Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.02s/it][A[A[A[A



Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.95s/it][A[A[A[A



Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.95s/it][A[A[A[A



Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.93s/it][A[A[A[A



Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.94s/it][A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.94s/it]




Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A



Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.03s/it][A[A[A[A



Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.95s/it][A[A[A[A



Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.87s/it][A[A[A[A



Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.88s/it][A[A[A[A



Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.87s/it][A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.89s/it]




Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A



Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.86s/it][A[A[A[A



Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.83s/it][A[A[A[A



Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.82s/it][A[A[A[A



Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.81s/it][A[A[A[A



Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.86s/it][A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.85s/it]




Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A



Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.93s/it][A[A[A[A



Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.85s/it][A[A[A[A



Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.82s/it][A[A[A[A



Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.81s/it][A[A[A[A



Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.80s/it][A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.82s/it]
2025-01-10 22:03:07,608 [asp.py] => total parameters: 173642241
2025-01-10 22:03:07,609 [asp.py] => trainable parameters: 2044929
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 46080
fc.sigma 1
2025-01-10 22:03:38,877 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84, 75.6]
2025-01-10 22:03:38,878 [trainer.py] => Average Accuracy (Top1): 84.71166666666666   (Harmonic Accuracy): 82.5645448620465 (Old Acc): 93.4 (New Acc): 73.98181818181818 

2025-01-10 22:03:38,879 [trainer.py] => All params: 173642241
2025-01-10 22:03:38,880 [trainer.py] => Trainable params: 2044929
2025-01-10 22:03:38,881 [asp.py] => Learning on 60-65
2025-01-10 22:03:38,897 [asp.py] => training set size: 25, fc construct set size: 25




Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A[A[A[A




Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A




Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.67s/it][A[A[A[A[A




Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.67s/it][A[A[A[A[A




Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.72s/it][A[A[A[A[A




Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.74s/it][A[A[A[A[A




Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.78s/it][A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.75s/it]





Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A




Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.95s/it][A[A[A[A[A




Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.90s/it][A[A[A[A[A




Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.84s/it][A[A[A[A[A




Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.87s/it][A[A[A[A[A




Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.91s/it][A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.90s/it]





Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A




Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.06s/it][A[A[A[A[A




Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.09s/it][A[A[A[A[A




Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:00<01:20, 40.13s/it][A[A[A[A[A




Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:40<00:40, 40.13s/it][A[A[A[A[A




Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.12s/it][A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.12s/it]





Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A




Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:41, 40.32s/it][A[A[A[A[A




Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.25s/it][A[A[A[A[A




Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:00<01:20, 40.23s/it][A[A[A[A[A




Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:40<00:40, 40.21s/it][A[A[A[A[A




Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:21<00:00, 40.19s/it][A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:21<00:00, 40.21s/it]





Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A[A[A




Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.23s/it][A[A[A[A[A




Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.06s/it][A[A[A[A[A




Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:00<01:20, 40.01s/it][A[A[A[A[A




Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.83s/it][A[A[A[A[A




Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.73s/it][A[A[A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.85s/it]
2025-01-10 22:20:25,007 [asp.py] => total parameters: 173646081
2025-01-10 22:20:25,007 [asp.py] => trainable parameters: 2048769
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 49920
fc.sigma 1
2025-01-10 22:20:58,892 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84, 75.6, 74.35]
2025-01-10 22:20:58,892 [trainer.py] => Average Accuracy (Top1): 83.91461538461537   (Harmonic Accuracy): 81.73599759011948 (Old Acc): 93.2 (New Acc): 72.78333333333332 

2025-01-10 22:20:58,893 [trainer.py] => All params: 173646081
2025-01-10 22:20:58,894 [trainer.py] => Trainable params: 2048769
2025-01-10 22:20:58,896 [asp.py] => Learning on 65-70
2025-01-10 22:20:58,938 [asp.py] => training set size: 25, fc construct set size: 25





Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A[A[A[A[AClass Inversion:   0%|          | 0/10 [1:42:44<?, ?it/s]
Class Inversion:   0%|          | 0/10 [1:25:39<?, ?it/s]
Class Inversion:   0%|          | 0/10 [1:08:41<?, ?it/s]
Class Inversion:   0%|          | 0/10 [51:37<?, ?it/s]
Class Inversion:   0%|          | 0/10 [34:34<?, ?it/s]
Class Inversion:   0%|          | 0/10 [17:20<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.44s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:58, 39.57s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.68s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.72s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.75s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:18<00:00, 39.70s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.09s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.85s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.83s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.82s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.82s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.84s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.99s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.92s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.87s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.86s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.82s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.86s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.89s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.90s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.86s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.86s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.85s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.86s/it]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s]Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.12s/it]Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.09s/it]Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:00<01:20, 40.02s/it]Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.94s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.92s/it]Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.96s/it]
2025-01-10 22:37:42,154 [asp.py] => total parameters: 173649921
2025-01-10 22:37:42,155 [asp.py] => trainable parameters: 2052609
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 53760
fc.sigma 1
2025-01-10 22:38:19,076 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84, 75.6, 74.35, 73.79]
2025-01-10 22:38:19,076 [trainer.py] => Average Accuracy (Top1): 83.19142857142856   (Harmonic Accuracy): 81.42545319326949 (Old Acc): 93.2 (New Acc): 72.29230769230767 

2025-01-10 22:38:19,078 [trainer.py] => All params: 173649921
2025-01-10 22:38:19,079 [trainer.py] => Trainable params: 2052609
2025-01-10 22:38:19,081 [asp.py] => Learning on 70-75
2025-01-10 22:38:19,115 [asp.py] => training set size: 25, fc construct set size: 25
Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s]
Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.71s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.84s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.85s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.87s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.88s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.86s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.03s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.96s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.98s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:40<00:40, 40.06s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.10s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:20<00:00, 40.06s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.14s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:20<02:00, 40.06s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [02:00<01:20, 40.03s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.93s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.90s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.95s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.06s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.92s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.85s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.86s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.83s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.86s/it]

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A
Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.96s/it][A
Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.87s/it][A
Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.83s/it][A
Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.84s/it][A
Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.81s/it][ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.83s/it]
2025-01-10 22:55:04,534 [asp.py] => total parameters: 173653761
2025-01-10 22:55:04,535 [asp.py] => trainable parameters: 2056449
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 57600
fc.sigma 1
2025-01-10 22:55:43,355 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84, 75.6, 74.35, 73.79, 71.67]
2025-01-10 22:55:43,356 [trainer.py] => Average Accuracy (Top1): 82.42333333333333   (Harmonic Accuracy): 79.7752745804411 (Old Acc): 92.4 (New Acc): 70.1857142857143 

2025-01-10 22:55:43,357 [trainer.py] => All params: 173653761
2025-01-10 22:55:43,358 [trainer.py] => Trainable params: 2056449
2025-01-10 22:55:43,360 [asp.py] => Learning on 75-80
2025-01-10 22:55:43,384 [asp.py] => training set size: 25, fc construct set size: 25

Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A

Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:38, 39.59s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.67s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:58<01:19, 39.65s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:38<00:39, 39.58s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.38s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.49s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.99s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.92s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.90s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.90s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.89s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.90s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.95s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.90s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.85s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.81s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.83s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.84s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.97s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.85s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.85s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.85s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.83s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.85s/it]


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A

Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.97s/it][A[A

Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.84s/it][A[A

Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.83s/it][A[A

Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.83s/it][A[A

Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.86s/it][A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.85s/it]
2025-01-10 23:12:26,093 [asp.py] => total parameters: 173657601
2025-01-10 23:12:26,094 [asp.py] => trainable parameters: 2060289
backbone.TIP 27648
backbone.Prompt_Encoder.fc_mu.0.weight 393216
backbone.Prompt_Encoder.fc_mu.0.bias 256
backbone.Prompt_Encoder.fc_mu.1.weight 589824
backbone.Prompt_Encoder.fc_mu.1.bias 2304
backbone.Prompt_Encoder.fc_std.0.weight 393216
backbone.Prompt_Encoder.fc_std.0.bias 256
backbone.Prompt_Encoder.fc_std.1.weight 589824
backbone.Prompt_Encoder.fc_std.1.bias 2304
fc.weight 61440
fc.sigma 1
2025-01-10 23:13:07,564 [trainer.py] => Top1 curve: [99.2, 97.6, 90.73, 88.1, 87.32, 83.33, 81.8, 80.18, 78.8, 77.04, 76.84, 75.6, 74.35, 73.79, 71.67, 71.9]
2025-01-10 23:13:07,565 [trainer.py] => Average Accuracy (Top1): 81.765625   (Harmonic Accuracy): 79.99934533551556 (Old Acc): 92.4 (New Acc): 70.53333333333333 

2025-01-10 23:13:07,567 [trainer.py] => All params: 173657601
2025-01-10 23:13:07,568 [trainer.py] => Trainable params: 2060289
2025-01-10 23:13:07,570 [asp.py] => Learning on 80-85
2025-01-10 23:13:07,590 [asp.py] => training set size: 25, fc construct set size: 25


Class Inversion:   0%|          | 0/10 [00:00<?, ?it/s][A[A


Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:37, 39.27s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:18<01:57, 39.28s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:57<01:18, 39.33s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:37<00:39, 39.38s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.47s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:17<00:00, 39.41s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:39<02:39, 39.95s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.84s/it][A[A[A


Sampling:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 3/5 [01:59<01:19, 39.78s/it][A[A[A


Sampling:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 4/5 [02:39<00:39, 39.78s/it][A[A[A


Sampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.82s/it][A[A[ASampling: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5/5 [03:19<00:00, 39.82s/it]



Sampling:   0%|          | 0/5 [00:00<?, ?it/s][A[A[A


Sampling:  20%|â–ˆâ–ˆ        | 1/5 [00:40<02:40, 40.02s/it][A[A[A


Sampling:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 2/5 [01:19<01:59, 39.91s/it][A[A[A